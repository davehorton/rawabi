<?xml version="1.0"?>
<xtml version="1.0" xmlns="urn:www.pactolus.com:xtml" >
  <version sce-version="6016" prev-sce-version="6016" last-mod-time="Monday, September 22, 2008 16:56:28"/>
  <global-handlers/>
  <functions >
    <function name="OutdialPartyToMS" start="12" event="OutdialPartyToMS" returns="i4" >
      <parameters >
        <parameter name="oCallLegB" type="object" pass="byref"/>
        <parameter name="oMS" type="object" pass="byref"/>
        <parameter name="lTimeStart" type="i8" pass="byref"/>
        <parameter name="lTimeAnswered" type="i8" pass="byref"/>
        <parameter name="strSIPStatus" type="string" pass="byref"/>
        <parameter name="strCallingNumber" type="string"/>
        <parameter name="strContact" type="string"/>
      </parameters>
      <local-vars >
        <var name="f_nSUCCESS" type="i4" >0</var>
        <var name="f_nFAILURE" type="i4" >-1</var>
        <var name="f_nBUSY" type="i4" >2</var>
        <var name="f_nRINGNOANSWER" type="i4" >1</var>
        <var name="f_nDTMFINTERRUPTED" type="i4" >3</var>
        <var name="f_nCALLEDPARTYERROR" type="i4" >-2</var>
        <var name="f_nCALLINGPARTYERROR" type="i4" >-3</var>
        <var name="f_nOTHERERROR" type="i4" >-4</var>
        <var name="f_nRESOURCEUNAVAIL" type="i4" >-5</var>
        <var name="f_nReturnCode" type="i4" >0</var>
        <var name="f_longStartTime" type="i8" >0</var>
        <var name="f_longStopTime" type="i8" >0</var>
        <var name="f_strCodec" type="string" ></var>
        <var name="f_bGotCSRCancelOutdial" type="boolean" >0</var>
      </local-vars>
      <actions >
        <action id="12" plug-in="Pactolus.Branch.1" ><?xtml-editor x=93 y=685 ?>
          <!--NSM mediaserver?-->
          <results >
            <result name="Default" link="14" stubbed="0"/>
            <result name="NSM mediaserver?" link="14" stubbed="1" >oMS.strType match "NMS"</result>
            <result name="CONV mediaserver?" link="15" stubbed="0" >oMS.strType match "CONV"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("**** BEFORE OUTDIAL PARTY TO MS ****");
Server.logInfo("oCallLeg.strFrom: " + Session.oCallLegB.strFrom);
Server.logInfo("oCallLeg.strTo: " + Session.oCallLegB.strTo);
Server.logInfo("oCallLeg.strContent: " + Session.oCallLegB.strContent);
Server.logInfo("oCallLeg.strCSeq: " + Session.oCallLegB.strCSeq);
Server.logInfo("oCallLeg.strCallId: " + Session.oCallLegB.strCallId);
Server.logInfo("oCallLeg.strRequestUri: " + Session.oCallLegB.strRequestUri);
Server.logInfo("oCallLeg.strCalledNumber: " + Session.oCallLegB.strCalledNumber);
Server.logInfo("oCallLeg.nSessionTimer: " + Session.oCallLegB.nSessionTimer);
Server.logInfo("oCallLeg.strRecordRoute: " + Session.oCallLegB.strRecordRoute);
Server.logInfo("oCallLeg.strRoute: " + Session.oCallLegB.strRoute);
Server.logInfo("oCallLeg.strContact: " + Session.oCallLegB.strContact);
Server.logInfo("strCallingNumber: " + Session.strCallingNumber);
Server.logInfo("oMS.strEndPoint: " + Session.oMS.strEndPoint);
Server.logInfo("oMS.strContent: " + Session.oMS.strContent);
Server.logInfo("oMS.strConnectionId: " + Session.oMS.strConnectionId);
Server.logInfo("oMS.strCallId: " + Session.oMS.strCallId);
Server.logInfo("oMS.strType: " + Session.oMS.strType);
Server.logInfo("oCallLeg.strRoute: " + Session.oCallLegB.strRoute);
Server.logInfo("oCallLeg.strRecordRoute: " + Session.oCallLegB.strRecordRoute);
Server.logInfo("oMS.strCodec is: " + Session.oMS.strCodec);
if (0 == Session.oMS.strCodec.length ||  undefined == Session.oMS.strCodec)
{
	Session.f_strCodec = "PCMU";
}
else
{
	Session.f_strCodec = Session.oMS.strCodec;	
}
Server.logInfo("f_strCodec is: " + Session.f_strCodec);

if ( 0 == Session.oCallLegB.nRingNoAnswerTime ) {
	Session.oCallLegB.nRingNoAnswerTime = 30;
}]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Pactolus.Outdial.1" ><?xtml-editor x=937 y=817 ?>
          <!--outdial to party no session timer-->
          <Outdial xmlns="urn:www.pactolus.com:xtml:sip-cc" calling-number="strCallingNumber" called-number="oCallLegB.strCalledNumber" preferred-carrier="" codec="f_strCodec" reliable-provisional-responses="1" timeout="oCallLegB.nRingNoAnswerTime" returns="f_nReturnCode" ms-type="oMS.strType" calling-connect-type="1" calling-capability="2" from="" via="" ingress-gateway="" session-timer-a="0" hold-a-first="0" interrupt-on-long-pound="0" session-timer-value-a="" telephone-events="0" rtp-request-a="0" rtp-endpoint-a="" route-callingparty="" record-route-callingparty="" contact-callingparty="strContact" egress-gateway="oCallLegB.strRequestUri" sdp-b="oCallLegB.strContent" callid-b="oCallLegB.strCallId" cseq-b="oCallLegB.strCSeq" sip-status="strSIPStatus" to-b="oCallLegB.strTo" from-b="oCallLegB.strFrom" session-timer-b="1" session-timer-value-b="oCallLegB.nSessionTimer" backup-ss="oCallLegB.strBackupRequestUri" route="oCallLegB.strRoute" record-route="oCallLegB.strRecordRoute" contact="oCallLegB.strContact" rtp-request-b="0" rtp-endpoint-b="" refresher="" remote-party-id="" play-ringback="0" language="" ringback-prompt="" capability="1" ringback-codec="-1" packetization-period="" calling-packetization="oMS.nPacketizationPeriod" connection-id="oMS.strConnectionId" mgcp-call-id="oMS.strCallId" ms-sdp="oMS.strContent" endpoint="oMS.strEndPoint" to="" callid-a="" cseq-a="" sdp-a=""/>
          <results >
            <result name="Default" link="3" stubbed="0"/>
            <result name="Success" link="4" stubbed="0"/>
            <result name="Ring no answer" link="5" stubbed="0"/>
            <result name="Busy" link="6" stubbed="0"/>
            <result name="Caller DTMF interrupt" link="7" stubbed="0"/>
            <result name="Called party error" link="8" stubbed="0"/>
            <result name="Calling party error" link="9" stubbed="0"/>
            <result name="Other error" link="10" stubbed="0"/>
            <result name="Resource unavailable" link="11" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.lTimeStart = Server.getUTCTime();
Session.oCallLegB.bCurrentlyDialing = true;
Session.oCallLegB.bAttemptedToOutdial = true;
var curTime = new Date();
Session.f_longStartTime = curTime.getTime();]]></script>
            <script language="javascript" timing="last" ><![CDATA[Session.oCallLegB.bCurrentlyDialing = false;
var curTime = new Date();
Session.f_longStopTime = curTime.getTime();
Server.logInfo("RETURN CODE: " + Session.f_nReturnCode);
Server.logInfo("SIP STATUS: " + Session.strSIPStatus);]]></script>
          </scripts>
        </action>
        <action id="3" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1183 y=561 ?>
          <!--f_nFAILURE-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nFAILURE"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logError("ERROR: FAIL TO OUTDIAL PARTY TO MEDIASERVER. RETURN CODE IS: " + Session.f_nReturnCode);
Server.logInfo("**** AFTER OUTDIAL PARTY TO CONFERENCE ****");
Server.logInfo("oCallLeg.strFrom: " + Session.oCallLegB.strFrom);
Server.logInfo("oCallLeg.strTo: " + Session.oCallLegB.strTo);
Server.logInfo("oCallLeg.strContent: " + Session.oCallLegB.strContent);
Server.logInfo("oCallLeg.strCSeq: " + Session.oCallLegB.strCSeq);
Server.logInfo("oCallLeg.strCallId: " + Session.oCallLegB.strCallId);
Server.logInfo("oCallLeg.strRequestUri: " + Session.oCallLegB.strRequestUri);
Server.logInfo("oCallLeg.strCalledNumber: " + Session.oCallLegB.strCalledNumber);
Server.logInfo("oCallLeg.nSessionTimer: " + Session.oCallLegB.nSessionTimer);
Server.logInfo("oCallLeg.strRecordRoute: " + Session.oCallLegB.strRecordRoute);
Server.logInfo("oCallLeg.strRoute: " + Session.oCallLegB.strRoute);
Server.logInfo("oCallLeg.strContact: " + Session.oCallLegB.strContact);
Server.logInfo("strCallingNumber: " + Session.strCallingNumber);
Server.logInfo("oMS.strEndPoint: " + Session.oMS.strEndPoint);
Server.logInfo("oMS.strContent: " + Session.oMS.strContent);
Server.logInfo("oMS.strConnectionId: " + Session.oMS.strConnectionId);
Server.logInfo("oMS.strCallId: " + Session.oMS.strCallId);
Server.logInfo("oMS.strType: " + Session.oMS.strType);
Server.logInfo("oMS.bMuteFlag: " + Session.oMS.bMuteFlag);
Server.logInfo("oMS.bDeafFlag: " + Session.oMS.bDeafFlag);
Server.logInfo("oMS.bCurrentlyInConf: " + Session.oMS.bCurrentlyInConf);
Server.logInfo("oMS.bCurrentlyConnected: " + Session.oMS.bCurrentlyConnected);
Server.logInfo("oMS.bRetry: " + Session.oMS.bRetry);]]></script>
          </scripts>
        </action>
        <action id="4" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1216 y=637 ?>
          <!--f_nSUCCESS-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nSUCCESS"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.lTimeAnswered = Server.getUTCTime();
Session.oMS.bCurrentlyConnected = true;
Session.oCallLegB.nSetUpTime = Session.f_longStopTime - Session.f_longStartTime;
Server.logInfo("SUCCESS OUTDIAL PARTY TO MS");
Server.logInfo("**** AFTER OUTDIAL PARTY TO CONFERENCE ****");
Server.logInfo("oCallLeg.strFrom: " + Session.oCallLegB.strFrom);
Server.logInfo("oCallLeg.strTo: " + Session.oCallLegB.strTo);
Server.logInfo("oCallLeg.strContent: " + Session.oCallLegB.strContent);
Server.logInfo("oCallLeg.strCSeq: " + Session.oCallLegB.strCSeq);
Server.logInfo("oCallLeg.strCallId: " + Session.oCallLegB.strCallId);
Server.logInfo("oCallLeg.strRequestUri: " + Session.oCallLegB.strRequestUri);
Server.logInfo("oCallLeg.strCalledNumber: " + Session.oCallLegB.strCalledNumber);
Server.logInfo("oCallLeg.nSessionTimer: " + Session.oCallLegB.nSessionTimer);
Server.logInfo("oCallLeg.strRecordRoute: " + Session.oCallLegB.strRecordRoute);
Server.logInfo("oCallLeg.strRoute: " + Session.oCallLegB.strRoute);
Server.logInfo("oCallLeg.strContact: " + Session.oCallLegB.strContact);
Server.logInfo("strCallingNumber: " + Session.strCallingNumber);
Server.logInfo("oMS.strEndPoint: " + Session.oMS.strEndPoint);
Server.logInfo("oMS.strContent: " + Session.oMS.strContent);
Server.logInfo("oMS.strConnectionId: " + Session.oMS.strConnectionId);
Server.logInfo("oMS.strCallId: " + Session.oMS.strCallId);
Server.logInfo("oMS.strType: " + Session.oMS.strType);
Server.logInfo("oMS.bMuteFlag: " + Session.oMS.bMuteFlag);
Server.logInfo("oMS.bDeafFlag: " + Session.oMS.bDeafFlag);
Server.logInfo("oMS.bCurrentlyInConf: " + Session.oMS.bCurrentlyInConf);
Server.logInfo("oMS.bCurrentlyConnected: " + Session.oMS.bCurrentlyConnected);
Server.logInfo("oMS.bRetry: " + Session.oMS.bRetry);]]></script>
          </scripts>
        </action>
        <action id="5" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1251 y=709 ?>
          <!--f_nRINGNOANSWER-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nRINGNOANSWER"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("NO ANSWER OUTDIAL PARTY TO MS");
Server.logInfo("**** AFTER OUTDIAL PARTY TO CONFERENCE ****");
Server.logInfo("oCallLeg.strFrom: " + Session.oCallLegB.strFrom);
Server.logInfo("oCallLeg.strTo: " + Session.oCallLegB.strTo);
Server.logInfo("oCallLeg.strContent: " + Session.oCallLegB.strContent);
Server.logInfo("oCallLeg.strCSeq: " + Session.oCallLegB.strCSeq);
Server.logInfo("oCallLeg.strCallId: " + Session.oCallLegB.strCallId);
Server.logInfo("oCallLeg.strRequestUri: " + Session.oCallLegB.strRequestUri);
Server.logInfo("oCallLeg.strCalledNumber: " + Session.oCallLegB.strCalledNumber);
Server.logInfo("oCallLeg.nSessionTimer: " + Session.oCallLegB.nSessionTimer);
Server.logInfo("oCallLeg.strRecordRoute: " + Session.oCallLegB.strRecordRoute);
Server.logInfo("oCallLeg.strRoute: " + Session.oCallLegB.strRoute);
Server.logInfo("oCallLeg.strContact: " + Session.oCallLegB.strContact);
Server.logInfo("strCallingNumber: " + Session.strCallingNumber);
Server.logInfo("oMS.strEndPoint: " + Session.oMS.strEndPoint);
Server.logInfo("oMS.strContent: " + Session.oMS.strContent);
Server.logInfo("oMS.strConnectionId: " + Session.oMS.strConnectionId);
Server.logInfo("oMS.strCallId: " + Session.oMS.strCallId);
Server.logInfo("oMS.strType: " + Session.oMS.strType);
Server.logInfo("oMS.bMuteFlag: " + Session.oMS.bMuteFlag);
Server.logInfo("oMS.bDeafFlag: " + Session.oMS.bDeafFlag);
Server.logInfo("oMS.bCurrentlyInConf: " + Session.oMS.bCurrentlyInConf);
Server.logInfo("oMS.bCurrentlyConnected: " + Session.oMS.bCurrentlyConnected);
Server.logInfo("oMS.bRetry: " + Session.oMS.bRetry);]]></script>
          </scripts>
        </action>
        <action id="6" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1292 y=777 ?>
          <!--f_nBUSY-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nBUSY"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("BUSY OUTDIAL PARTY TO MS");
Server.logInfo("**** AFTER OUTDIAL PARTY TO CONFERENCE ****");
Server.logInfo("oCallLeg.strFrom: " + Session.oCallLegB.strFrom);
Server.logInfo("oCallLeg.strTo: " + Session.oCallLegB.strTo);
Server.logInfo("oCallLeg.strContent: " + Session.oCallLegB.strContent);
Server.logInfo("oCallLeg.strCSeq: " + Session.oCallLegB.strCSeq);
Server.logInfo("oCallLeg.strCallId: " + Session.oCallLegB.strCallId);
Server.logInfo("oCallLeg.strRequestUri: " + Session.oCallLegB.strRequestUri);
Server.logInfo("oCallLeg.strCalledNumber: " + Session.oCallLegB.strCalledNumber);
Server.logInfo("oCallLeg.nSessionTimer: " + Session.oCallLegB.nSessionTimer);
Server.logInfo("oCallLeg.strRecordRoute: " + Session.oCallLegB.strRecordRoute);
Server.logInfo("oCallLeg.strRoute: " + Session.oCallLegB.strRoute);
Server.logInfo("oCallLeg.strContact: " + Session.oCallLegB.strContact);
Server.logInfo("strCallingNumber: " + Session.strCallingNumber);
Server.logInfo("oMS.strEndPoint: " + Session.oMS.strEndPoint);
Server.logInfo("oMS.strContent: " + Session.oMS.strContent);
Server.logInfo("oMS.strConnectionId: " + Session.oMS.strConnectionId);
Server.logInfo("oMS.strCallId: " + Session.oMS.strCallId);
Server.logInfo("oMS.strType: " + Session.oMS.strType);
Server.logInfo("oMS.bMuteFlag: " + Session.oMS.bMuteFlag);
Server.logInfo("oMS.bDeafFlag: " + Session.oMS.bDeafFlag);
Server.logInfo("oMS.bCurrentlyInConf: " + Session.oMS.bCurrentlyInConf);
Server.logInfo("oMS.bCurrentlyConnected: " + Session.oMS.bCurrentlyConnected);
Server.logInfo("oMS.bRetry: " + Session.oMS.bRetry);]]></script>
          </scripts>
        </action>
        <action id="7" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1362 y=850 ?>
          <!--f_nDTMFINTERRUPTED-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nDTMFINTERRUPTED"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("DTMF INTERRUPTED OUTDIAL PARTY TO MS");
Server.logInfo("**** AFTER OUTDIAL PARTY TO CONFERENCE ****");
Server.logInfo("oCallLeg.strFrom: " + Session.oCallLegB.strFrom);
Server.logInfo("oCallLeg.strTo: " + Session.oCallLegB.strTo);
Server.logInfo("oCallLeg.strContent: " + Session.oCallLegB.strContent);
Server.logInfo("oCallLeg.strCSeq: " + Session.oCallLegB.strCSeq);
Server.logInfo("oCallLeg.strCallId: " + Session.oCallLegB.strCallId);
Server.logInfo("oCallLeg.strRequestUri: " + Session.oCallLegB.strRequestUri);
Server.logInfo("oCallLeg.strCalledNumber: " + Session.oCallLegB.strCalledNumber);
Server.logInfo("oCallLeg.nSessionTimer: " + Session.oCallLegB.nSessionTimer);
Server.logInfo("oCallLeg.strRecordRoute: " + Session.oCallLegB.strRecordRoute);
Server.logInfo("oCallLeg.strRoute: " + Session.oCallLegB.strRoute);
Server.logInfo("oCallLeg.strContact: " + Session.oCallLegB.strContact);
Server.logInfo("strCallingNumber: " + Session.strCallingNumber);
Server.logInfo("oMS.strEndPoint: " + Session.oMS.strEndPoint);
Server.logInfo("oMS.strContent: " + Session.oMS.strContent);
Server.logInfo("oMS.strConnectionId: " + Session.oMS.strConnectionId);
Server.logInfo("oMS.strCallId: " + Session.oMS.strCallId);
Server.logInfo("oMS.strType: " + Session.oMS.strType);
Server.logInfo("oMS.bMuteFlag: " + Session.oMS.bMuteFlag);
Server.logInfo("oMS.bDeafFlag: " + Session.oMS.bDeafFlag);
Server.logInfo("oMS.bCurrentlyInConf: " + Session.oMS.bCurrentlyInConf);
Server.logInfo("oMS.bCurrentlyConnected: " + Session.oMS.bCurrentlyConnected);
Server.logInfo("oMS.bRetry: " + Session.oMS.bRetry);]]></script>
          </scripts>
        </action>
        <action id="8" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1372 y=950 ?>
          <!--f_nCALLEDPARTYERROR-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nCALLEDPARTYERROR"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("CALLED PARTY ERROR OUTDIAL PARTY TO MS");
Server.logInfo("**** AFTER OUTDIAL PARTY TO CONFERENCE ****");
Server.logInfo("oCallLeg.strFrom: " + Session.oCallLegB.strFrom);
Server.logInfo("oCallLeg.strTo: " + Session.oCallLegB.strTo);
Server.logInfo("oCallLeg.strContent: " + Session.oCallLegB.strContent);
Server.logInfo("oCallLeg.strCSeq: " + Session.oCallLegB.strCSeq);
Server.logInfo("oCallLeg.strCallId: " + Session.oCallLegB.strCallId);
Server.logInfo("oCallLeg.strRequestUri: " + Session.oCallLegB.strRequestUri);
Server.logInfo("oCallLeg.strCalledNumber: " + Session.oCallLegB.strCalledNumber);
Server.logInfo("oCallLeg.nSessionTimer: " + Session.oCallLegB.nSessionTimer);
Server.logInfo("oCallLeg.strRecordRoute: " + Session.oCallLegB.strRecordRoute);
Server.logInfo("oCallLeg.strRoute: " + Session.oCallLegB.strRoute);
Server.logInfo("oCallLeg.strContact: " + Session.oCallLegB.strContact);
Server.logInfo("strCallingNumber: " + Session.strCallingNumber);
Server.logInfo("oMS.strEndPoint: " + Session.oMS.strEndPoint);
Server.logInfo("oMS.strContent: " + Session.oMS.strContent);
Server.logInfo("oMS.strConnectionId: " + Session.oMS.strConnectionId);
Server.logInfo("oMS.strCallId: " + Session.oMS.strCallId);
Server.logInfo("oMS.strType: " + Session.oMS.strType);
Server.logInfo("oMS.bMuteFlag: " + Session.oMS.bMuteFlag);
Server.logInfo("oMS.bDeafFlag: " + Session.oMS.bDeafFlag);
Server.logInfo("oMS.bCurrentlyInConf: " + Session.oMS.bCurrentlyInConf);
Server.logInfo("oMS.bCurrentlyConnected: " + Session.oMS.bCurrentlyConnected);
Server.logInfo("oMS.bRetry: " + Session.oMS.bRetry);]]></script>
          </scripts>
        </action>
        <action id="9" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1365 y=1026 ?>
          <!--f_nCALLINGPARTYERROR-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nCALLINGPARTYERROR"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("CALLING PARTY ERROR OUTDIAL PARTY TO MS");
Server.logInfo("**** AFTER OUTDIAL PARTY TO CONFERENCE ****");
Server.logInfo("oCallLeg.strFrom: " + Session.oCallLegB.strFrom);
Server.logInfo("oCallLeg.strTo: " + Session.oCallLegB.strTo);
Server.logInfo("oCallLeg.strContent: " + Session.oCallLegB.strContent);
Server.logInfo("oCallLeg.strCSeq: " + Session.oCallLegB.strCSeq);
Server.logInfo("oCallLeg.strCallId: " + Session.oCallLegB.strCallId);
Server.logInfo("oCallLeg.strRequestUri: " + Session.oCallLegB.strRequestUri);
Server.logInfo("oCallLeg.strCalledNumber: " + Session.oCallLegB.strCalledNumber);
Server.logInfo("oCallLeg.nSessionTimer: " + Session.oCallLegB.nSessionTimer);
Server.logInfo("oCallLeg.strRecordRoute: " + Session.oCallLegB.strRecordRoute);
Server.logInfo("oCallLeg.strRoute: " + Session.oCallLegB.strRoute);
Server.logInfo("oCallLeg.strContact: " + Session.oCallLegB.strContact);
Server.logInfo("strCallingNumber: " + Session.strCallingNumber);
Server.logInfo("oMS.strEndPoint: " + Session.oMS.strEndPoint);
Server.logInfo("oMS.strContent: " + Session.oMS.strContent);
Server.logInfo("oMS.strConnectionId: " + Session.oMS.strConnectionId);
Server.logInfo("oMS.strCallId: " + Session.oMS.strCallId);
Server.logInfo("oMS.strType: " + Session.oMS.strType);
Server.logInfo("oMS.bMuteFlag: " + Session.oMS.bMuteFlag);
Server.logInfo("oMS.bDeafFlag: " + Session.oMS.bDeafFlag);
Server.logInfo("oMS.bCurrentlyInConf: " + Session.oMS.bCurrentlyInConf);
Server.logInfo("oMS.bCurrentlyConnected: " + Session.oMS.bCurrentlyConnected);
Server.logInfo("oMS.bRetry: " + Session.oMS.bRetry);]]></script>
          </scripts>
        </action>
        <action id="10" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1352 y=1097 ?>
          <!--f_nOTHERERROR-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nOTHERERROR"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("OTHER ERROR OUTDIAL PARTY TO MS");
Server.logInfo("**** AFTER OUTDIAL PARTY TO CONFERENCE ****");
Server.logInfo("oCallLeg.strFrom: " + Session.oCallLegB.strFrom);
Server.logInfo("oCallLeg.strTo: " + Session.oCallLegB.strTo);
Server.logInfo("oCallLeg.strContent: " + Session.oCallLegB.strContent);
Server.logInfo("oCallLeg.strCSeq: " + Session.oCallLegB.strCSeq);
Server.logInfo("oCallLeg.strCallId: " + Session.oCallLegB.strCallId);
Server.logInfo("oCallLeg.strRequestUri: " + Session.oCallLegB.strRequestUri);
Server.logInfo("oCallLeg.strCalledNumber: " + Session.oCallLegB.strCalledNumber);
Server.logInfo("oCallLeg.nSessionTimer: " + Session.oCallLegB.nSessionTimer);
Server.logInfo("oCallLeg.strRecordRoute: " + Session.oCallLegB.strRecordRoute);
Server.logInfo("oCallLeg.strRoute: " + Session.oCallLegB.strRoute);
Server.logInfo("oCallLeg.strContact: " + Session.oCallLegB.strContact);
Server.logInfo("strCallingNumber: " + Session.strCallingNumber);
Server.logInfo("oMS.strEndPoint: " + Session.oMS.strEndPoint);
Server.logInfo("oMS.strContent: " + Session.oMS.strContent);
Server.logInfo("oMS.strConnectionId: " + Session.oMS.strConnectionId);
Server.logInfo("oMS.strCallId: " + Session.oMS.strCallId);
Server.logInfo("oMS.strType: " + Session.oMS.strType);
Server.logInfo("oMS.bMuteFlag: " + Session.oMS.bMuteFlag);
Server.logInfo("oMS.bDeafFlag: " + Session.oMS.bDeafFlag);
Server.logInfo("oMS.bCurrentlyInConf: " + Session.oMS.bCurrentlyInConf);
Server.logInfo("oMS.bCurrentlyConnected: " + Session.oMS.bCurrentlyConnected);
Server.logInfo("oMS.bRetry: " + Session.oMS.bRetry);]]></script>
          </scripts>
        </action>
        <action id="11" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1330 y=1169 ?>
          <!--f_nRESOURCEUNAVAIL-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nRESOURCEUNAVAIL"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("RESOURCE OUTDIAL PARTY TO MS");
Server.logInfo("**** AFTER OUTDIAL PARTY TO CONFERENCE ****");
Server.logInfo("oCallLeg.strFrom: " + Session.oCallLegB.strFrom);
Server.logInfo("oCallLeg.strTo: " + Session.oCallLegB.strTo);
Server.logInfo("oCallLeg.strContent: " + Session.oCallLegB.strContent);
Server.logInfo("oCallLeg.strCSeq: " + Session.oCallLegB.strCSeq);
Server.logInfo("oCallLeg.strCallId: " + Session.oCallLegB.strCallId);
Server.logInfo("oCallLeg.strRequestUri: " + Session.oCallLegB.strRequestUri);
Server.logInfo("oCallLeg.strCalledNumber: " + Session.oCallLegB.strCalledNumber);
Server.logInfo("oCallLeg.nSessionTimer: " + Session.oCallLegB.nSessionTimer);
Server.logInfo("oCallLeg.strRecordRoute: " + Session.oCallLegB.strRecordRoute);
Server.logInfo("oCallLeg.strRoute: " + Session.oCallLegB.strRoute);
Server.logInfo("oCallLeg.strContact: " + Session.oCallLegB.strContact);
Server.logInfo("strCallingNumber: " + Session.strCallingNumber);
Server.logInfo("oMS.strEndPoint: " + Session.oMS.strEndPoint);
Server.logInfo("oMS.strContent: " + Session.oMS.strContent);
Server.logInfo("oMS.strConnectionId: " + Session.oMS.strConnectionId);
Server.logInfo("oMS.strCallId: " + Session.oMS.strCallId);
Server.logInfo("oMS.strType: " + Session.oMS.strType);
Server.logInfo("oMS.bMuteFlag: " + Session.oMS.bMuteFlag);
Server.logInfo("oMS.bDeafFlag: " + Session.oMS.bDeafFlag);
Server.logInfo("oMS.bCurrentlyInConf: " + Session.oMS.bCurrentlyInConf);
Server.logInfo("oMS.bCurrentlyConnected: " + Session.oMS.bCurrentlyConnected);
Server.logInfo("oMS.bRetry: " + Session.oMS.bRetry);]]></script>
          </scripts>
        </action>
        <action id="13" plug-in="Pactolus.Outdial.1" ><?xtml-editor x=942 y=601 ?>
          <!--outdial to party session timer-->
          <Outdial xmlns="urn:www.pactolus.com:xtml:sip-cc" calling-number="strCallingNumber" called-number="oCallLegB.strCalledNumber" preferred-carrier="" codec="f_strCodec" reliable-provisional-responses="1" timeout="oCallLegB.nRingNoAnswerTime" returns="f_nReturnCode" ms-type="oMS.strType" calling-connect-type="1" calling-capability="0" from="" via="" ingress-gateway="" session-timer-a="0" hold-a-first="0" interrupt-on-long-pound="0" session-timer-value-a="" telephone-events="0" rtp-request-a="0" rtp-endpoint-a="" route-callingparty="" record-route-callingparty="" contact-callingparty="strContact" egress-gateway="oCallLegB.strRequestUri" sdp-b="oCallLegB.strContent" callid-b="oCallLegB.strCallId" cseq-b="oCallLegB.strCSeq" sip-status="strSIPStatus" to-b="oCallLegB.strTo" from-b="oCallLegB.strFrom" session-timer-b="1" session-timer-value-b="oCallLegB.nSessionTimer" backup-ss="oCallLegB.strBackupRequestUri" route="oCallLegB.strRoute" record-route="oCallLegB.strRecordRoute" contact="oCallLegB.strContact" rtp-request-b="0" rtp-endpoint-b="" refresher="" remote-party-id="" play-ringback="0" language="" ringback-prompt="" capability="1" ringback-codec="-1" packetization-period="" calling-packetization="oMS.nPacketizationPeriod" connection-id="oMS.strConnectionId" mgcp-call-id="oMS.strCallId" ms-sdp="oMS.strContent" endpoint="oMS.strEndPoint" to="" callid-a="" cseq-a="" sdp-a=""/>
          <results >
            <result name="Default" link="3" stubbed="1"/>
            <result name="Success" link="4" stubbed="1"/>
            <result name="Ring no answer" link="5" stubbed="1"/>
            <result name="Busy" link="6" stubbed="1"/>
            <result name="Caller DTMF interrupt" link="7" stubbed="1"/>
            <result name="Called party error" link="8" stubbed="1"/>
            <result name="Calling party error" link="9" stubbed="1"/>
            <result name="Other error" link="10" stubbed="1"/>
            <result name="Resource unavailable" link="11" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.lTimeStart = Server.getUTCTime();
Session.oCallLegB.bCurrentlyDialing = true;
Session.oCallLegB.bAttemptedToOutdial = true;
var curTime = new Date();
Session.f_longStartTime = curTime.getTime();]]></script>
            <script language="javascript" timing="last" ><![CDATA[Session.oCallLegB.bCurrentlyDialing = false;
var curTime = new Date();
Session.f_longStopTime = curTime.getTime();
Server.logInfo("RETURN CODE: " + Session.f_nReturnCode);
Server.logInfo("SIP STATUS: " + Session.strSIPStatus);]]></script>
          </scripts>
        </action>
        <action id="14" plug-in="Pactolus.Branch.1" ><?xtml-editor x=358 y=538 ?>
          <!--session timer enable?-->
          <results >
            <result name="Default" link="18" stubbed="0"/>
            <result name="oCallLegB.strSessionTimerFlag == &quot;T&quot;" link="19" stubbed="0" >oCallLegB.strSessionTimerFlag == "T"</result>
          </results>
        </action>
        <action id="15" plug-in="Pactolus.Branch.1" ><?xtml-editor x=376 y=828 ?>
          <!--session timer enable?-->
          <results >
            <result name="Default" link="20" stubbed="0"/>
            <result name="oCallLegB.strSessionTimerFlag == &quot;T&quot;" link="21" stubbed="0" >oCallLegB.strSessionTimerFlag == "T"</result>
          </results>
        </action>
        <action id="16" plug-in="Pactolus.Outdial.1" ><?xtml-editor x=907 y=319 ?>
          <!--outdial to party no session timer-->
          <Outdial xmlns="urn:www.pactolus.com:xtml:sip-cc" calling-number="strCallingNumber" called-number="oCallLegB.strCalledNumber" preferred-carrier="" codec="f_strCodec" reliable-provisional-responses="1" timeout="oCallLegB.nRingNoAnswerTime" returns="f_nReturnCode" ms-type="oMS.strType" calling-connect-type="1" calling-capability="0" from="" via="" ingress-gateway="" session-timer-a="0" hold-a-first="0" interrupt-on-long-pound="0" session-timer-value-a="" telephone-events="0" rtp-request-a="0" rtp-endpoint-a="" route-callingparty="" record-route-callingparty="" contact-callingparty="strContact" egress-gateway="oCallLegB.strRequestUri" sdp-b="oCallLegB.strContent" callid-b="oCallLegB.strCallId" cseq-b="oCallLegB.strCSeq" sip-status="strSIPStatus" to-b="oCallLegB.strTo" from-b="oCallLegB.strFrom" session-timer-b="1" session-timer-value-b="oCallLegB.nSessionTimer" backup-ss="oCallLegB.strBackupRequestUri" route="oCallLegB.strRoute" record-route="oCallLegB.strRecordRoute" contact="oCallLegB.strContact" rtp-request-b="0" rtp-endpoint-b="" refresher="" remote-party-id="" play-ringback="0" language="" ringback-prompt="" capability="1" ringback-codec="-1" packetization-period="" calling-packetization="oMS.nPacketizationPeriod" connection-id="oMS.strConnectionId" mgcp-call-id="oMS.strCallId" ms-sdp="oMS.strContent" endpoint="oMS.strEndPoint" to="" callid-a="" cseq-a="" sdp-a=""/>
          <results >
            <result name="Default" link="3" stubbed="1"/>
            <result name="Success" link="4" stubbed="1"/>
            <result name="Ring no answer" link="5" stubbed="1"/>
            <result name="Busy" link="6" stubbed="1"/>
            <result name="Caller DTMF interrupt" link="7" stubbed="1"/>
            <result name="Called party error" link="8" stubbed="1"/>
            <result name="Calling party error" link="9" stubbed="1"/>
            <result name="Other error" link="10" stubbed="1"/>
            <result name="Resource unavailable" link="11" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.lTimeStart = Server.getUTCTime();
Session.oCallLegB.bCurrentlyDialing = true;
Session.oCallLegB.bAttemptedToOutdial = true;
var curTime = new Date();
Session.f_longStartTime = curTime.getTime();]]></script>
            <script language="javascript" timing="last" ><![CDATA[Session.oCallLegB.bCurrentlyDialing = false;
var curTime = new Date();
Session.f_longStopTime = curTime.getTime();
Server.logInfo("RETURN CODE: " + Session.f_nReturnCode);
Server.logInfo("SIP STATUS: " + Session.strSIPStatus);]]></script>
          </scripts>
        </action>
        <action id="17" plug-in="Pactolus.Outdial.1" ><?xtml-editor x=920 y=1135 ?>
          <!--outdial to party-->
          <Outdial xmlns="urn:www.pactolus.com:xtml:sip-cc" calling-number="strCallingNumber" called-number="oCallLegB.strCalledNumber" preferred-carrier="" codec="f_strCodec" reliable-provisional-responses="1" timeout="oCallLegB.nRingNoAnswerTime" returns="f_nReturnCode" ms-type="oMS.strType" calling-connect-type="1" calling-capability="2" from="" via="" ingress-gateway="" session-timer-a="0" hold-a-first="0" interrupt-on-long-pound="0" session-timer-value-a="" telephone-events="0" rtp-request-a="0" rtp-endpoint-a="" route-callingparty="" record-route-callingparty="" contact-callingparty="strContact" egress-gateway="oCallLegB.strRequestUri" sdp-b="oCallLegB.strContent" callid-b="oCallLegB.strCallId" cseq-b="oCallLegB.strCSeq" sip-status="strSIPStatus" to-b="oCallLegB.strTo" from-b="oCallLegB.strFrom" session-timer-b="1" session-timer-value-b="oCallLegB.nSessionTimer" backup-ss="oCallLegB.strBackupRequestUri" route="oCallLegB.strRoute" record-route="oCallLegB.strRecordRoute" contact="oCallLegB.strContact" rtp-request-b="0" rtp-endpoint-b="" refresher="" remote-party-id="" play-ringback="0" language="" ringback-prompt="" capability="1" ringback-codec="-1" packetization-period="" calling-packetization="oMS.nPacketizationPeriod" connection-id="oMS.strConnectionId" mgcp-call-id="oMS.strCallId" ms-sdp="oMS.strContent" endpoint="oMS.strEndPoint" to="" callid-a="" cseq-a="" sdp-a=""/>
          <results >
            <result name="Default" link="3" stubbed="1"/>
            <result name="Success" link="4" stubbed="1"/>
            <result name="Ring no answer" link="5" stubbed="1"/>
            <result name="Busy" link="6" stubbed="1"/>
            <result name="Caller DTMF interrupt" link="7" stubbed="1"/>
            <result name="Called party error" link="8" stubbed="1"/>
            <result name="Calling party error" link="9" stubbed="1"/>
            <result name="Other error" link="10" stubbed="1"/>
            <result name="Resource unavailable" link="11" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.lTimeStart = Server.getUTCTime();
Session.oCallLegB.bCurrentlyDialing = true;
Session.oCallLegB.bAttemptedToOutdial = true;
var curTime = new Date();
Session.f_longStartTime = curTime.getTime();]]></script>
            <script language="javascript" timing="last" ><![CDATA[Session.oCallLegB.bCurrentlyDialing = false;
var curTime = new Date();
Session.f_longStopTime = curTime.getTime();
Server.logInfo("RETURN CODE: " + Session.f_nReturnCode);
Server.logInfo("SIP STATUS: " + Session.strSIPStatus);]]></script>
          </scripts>
        </action>
        <action id="18" plug-in="Pactolus.Branch.1" ><?xtml-editor x=622 y=331 ?>
          <!--got cancel?-->
          <results >
            <result name="Default" link="16" stubbed="0"/>
            <result name="bGotCSRCancelOutdial" link="3" stubbed="1" >f_bGotCSRCancelOutdial == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (true == Session.g_bGotCSRCancelOutdial)
{
	Session.f_bGotCSRCancelOutdial = true;
}]]></script>
          </scripts>
        </action>
        <action id="19" plug-in="Pactolus.Branch.1" ><?xtml-editor x=639 y=625 ?>
          <!--got cancel?-->
          <results >
            <result name="Default" link="13" stubbed="0"/>
            <result name="bGotCSRCancelOutdial" link="3" stubbed="1" >f_bGotCSRCancelOutdial == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (true == Session.g_bGotCSRCancelOutdial)
{
	Session.f_bGotCSRCancelOutdial = true;
}]]></script>
          </scripts>
        </action>
        <action id="20" plug-in="Pactolus.Branch.1" ><?xtml-editor x=630 y=821 ?>
          <!--got cancel?-->
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="bGotCSRCancelOutdial" link="3" stubbed="1" >f_bGotCSRCancelOutdial == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (true == Session.g_bGotCSRCancelOutdial)
{
	Session.f_bGotCSRCancelOutdial = true;
}]]></script>
          </scripts>
        </action>
        <action id="21" plug-in="Pactolus.Branch.1" ><?xtml-editor x=645 y=1146 ?>
          <!--got cancel?-->
          <results >
            <result name="Default" link="17" stubbed="0"/>
            <result name="bGotCSRCancelOutdial" link="3" stubbed="1" >f_bGotCSRCancelOutdial == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (true == Session.g_bGotCSRCancelOutdial)
{
	Session.f_bGotCSRCancelOutdial = true;
}]]></script>
          </scripts>
        </action>
      </actions>
      <text-objects >
        <text-object x-coord="47" y-coord="23" width="455" height="417" text="Conference app, will outdial party to a ms endpoint.
and invite party to join a conference.  Party can accept or decline
by pressing a number
Using by the applet add party
INPUT:
oCallLeg        object type, A leg info
oMS            object type, media server info
longTimeStart        long type, the time when try to outdial
longTimeAnswered    long type, the time when called party answer
strSIPStatus        string type, SIP status of outdial
OUTPUT:
returns    
    0    success
    1    ring no answer
    2    busy
    3    DTMF interrupted
    -1    fail
    -2    called party error
    -3    calling party error
    -4    other error
    -5    resource unavailable

AT THE LATER TIME, SHOULD USE ADD PARTY TO CONF PAC
ONCE THE PAC IS WORKING" font-name="Times New Roman" size="-16" red="0" green="0" blue="0" weight="0" underline="0" strikeout="0" point-size="12" italic="0"/>
      </text-objects>
    </function>
    <function name="DirectCallerToMS" start="10" event="DirectCallerToMS" returns="i4" >
      <parameters >
        <parameter name="oCallLeg" type="object" pass="byref"/>
        <parameter name="oMS" type="object" pass="byref"/>
      </parameters>
      <local-vars >
        <var name="f_nSUCCESS" type="i4" >0</var>
        <var name="f_nFAILURE" type="i4" >-1</var>
        <var name="f_nCALLERHUNGUP" type="i4" >-2</var>
        <var name="f_nTIMEOUT" type="i4" >40</var>
        <var name="f_nReturnCode" type="i4" >0</var>
        <var name="f_strCodec" type="string" ></var>
        <var name="f_nRESOURCE_UNAVAILABLE" type="i4" >-7</var>
        <var name="bRemoteCSeq" type="boolean" >0</var>
      </local-vars>
      <actions >
        <action id="10" plug-in="Pactolus.Branch.1" ><?xtml-editor x=99 y=687 ?>
          <!--NSM mediaserver?-->
          <results >
            <result name="Default" link="1" stubbed="0"/>
            <result name="NSM mediaserver?" link="1" stubbed="1" >oMS.strType match "NMS"</result>
            <result name="CONV mediaserver?" link="11" stubbed="0" >oMS.strType match "CONV"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("**** BEFORE DIRECT CALLER TO MS ****");
Server.logInfo("oCallLeg.strFrom: " + Session.oCallLeg.strFrom);
Server.logInfo("oCallLeg.strTo: " + Session.oCallLeg.strTo);
Server.logInfo("oCallLeg.strContent: " + Session.oCallLeg.strContent);
Server.logInfo("oCallLeg.strVia: " + Session.oCallLeg.strVia);

if ( 0 == Session.oCallLeg.strRemoteCSeq.length 
	|| "[object SessionClass]" == Session.oCallLeg.strRemoteCSeq
	|| undefined == Session.oCallLeg.strRemoteCSeq) {
	Session.oCallLeg.strRemoteCSeq = Session.oCallLeg.strCSeq;
}
else {
	Session.bRemoteCSeq = true;
}
Server.logInfo("oCallLeg.strRemoteCSeq: " + Session.oCallLeg.strRemoteCSeq);
Server.logInfo("oCallLeg.strCallId: " + Session.oCallLeg.strCallId);
Server.logInfo("oMS.strEndPoint: " + Session.oMS.strEndPoint);
Server.logInfo("oMS.strContent: " + Session.oMS.strContent);
Server.logInfo("oMS.strConnectionId: " + Session.oMS.strConnectionId);
Server.logInfo("oMS.strCallId: " + Session.oMS.strCallId);
Server.logInfo("oMS.strType: " + Session.oMS.strType);
Server.logInfo("oCallLeg.strRecordRoute: " + Session.oCallLeg.strRecordRoute);
Server.logInfo("oMS.strCodec is: " + Session.oMS.strCodec);
if (0 == Session.oMS.strCodec.length ||  undefined == Session.oMS.strCodec)
{
	Session.f_strCodec = "PCMU";
}
else
{
	Session.f_strCodec = Session.oMS.strCodec;	
}
Server.logInfo("f_strCodec is: " + Session.f_strCodec);]]></script>
          </scripts>
        </action>
        <action id="1" plug-in="Pactolus.MSConnect.1" ><?xtml-editor x=379 y=582 ?>
          <!--Connect to media server-->
          <cc-connect xmlns="urn:www.pactolus.com:xtml:sip-cc" call-id="oCallLeg.strCallId" caller-sdp="oCallLeg.strContent" capability="0" inbound="1" returns="f_nReturnCode" timeout="f_nTIMEOUT" endpoint="oMS.strEndPoint" connection-id="oMS.strConnectionId" ms-sdp="oMS.strContent" to="oCallLeg.strTo" from="oCallLeg.strFrom" cseq="oCallLeg.strRemoteCSeq" via="oCallLeg.strVia" mgcp-call-id="oMS.strCallId" ingress-gateway="" packetization-period="oMS.nPacketizationPeriod" early-media="1" early-media-only="0" codec="f_strCodec" ms-type="oMS.strType" telephone-events="0" route="" record-route="oCallLeg.strRecordRoute" contact="" session-expires="" min-se="" supported="" use-session-timer="0" min-supported-session-timer="" refresher=""/>
          <results >
            <result name="Default" link="4" stubbed="0"/>
            <result name="Success" link="3" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
            <result name="Resource Unavailable" link="17" stubbed="0"/>
            <result name="Caller Hung up" link="2" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.oMS.strEndPoint = "";
Session.oMS.strCallId = "";
Session.oMS.strConnectionId = "";
Session.oMS.strContent = "";
Session.oMS.bCurrentlyConnected = false;]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2 && Result.id !=6)
{
	Server.logError("ERROR: FAIL TO CONNECT CALLER TO MS. RETURN CODE IS: " + Session.f_nReturnCode);
	Server.logError("ERROR: FAIL TO CONNECT CALLER TO MS. EXIT ON BRANCH: " + Result.name);
}

if ( !Session.bRemoteCSeq ) {
	Session.oCallLeg.strCSeq = Session.oCallLeg.strRemoteCSeq;
}]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=740 y=852 ?>
          <!--f_nCALLERHUNGUP-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nCALLERHUNGUP"/>
        </action>
        <action id="3" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=738 y=671 ?>
          <!--f_nSUCCESS-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nSUCCESS"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("SUCCESS CREATE CONNECTION");
Session.oMS.bCurrentlyConnected = true;
Server.logInfo("**** AFTER DIRECT CALLER TO MS ****");
Server.logInfo("oCallLeg.strFrom: " + Session.oCallLeg.strFrom);
Server.logInfo("oCallLeg.strTo: " + Session.oCallLeg.strTo);
Server.logInfo("oCallLeg.strContent: " + Session.oCallLeg.strContent);
Server.logInfo("oCallLeg.strVia: " + Session.oCallLeg.strVia);
Server.logInfo("oCallLeg.strCSeq: " + Session.oCallLeg.strCSeq);
Server.logInfo("oCallLeg.strCallId: " + Session.oCallLeg.strCallId);
Server.logInfo("oMS.strEndPoint: " + Session.oMS.strEndPoint);
Server.logInfo("oMS.strContent: " + Session.oMS.strContent);
Server.logInfo("oMS.strConnectionId: " + Session.oMS.strConnectionId);
Server.logInfo("oMS.strCallId: " + Session.oMS.strCallId);
Server.logInfo("oMS.strType: " + Session.oMS.strType);]]></script>
          </scripts>
        </action>
        <action id="4" plug-in="Pactolus.Branch.1" ><?xtml-editor x=722 y=543 ?>
          <!--retry?-->
          <results >
            <result name="Default" link="5" stubbed="0"/>
            <result name="retry==true" link="6" stubbed="0" >oMS.bRetry == true</result>
          </results>
        </action>
        <action id="5" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=964 y=538 ?>
          <!--f_nFAILURE-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nFAILURE"/>
        </action>
        <action id="6" plug-in="Pactolus.MSConnect.1" ><?xtml-editor x=983 y=664 ?>
          <!--Connect to media server-->
          <cc-connect xmlns="urn:www.pactolus.com:xtml:sip-cc" call-id="oCallLeg.strCallId" caller-sdp="oCallLeg.strContent" capability="0" inbound="1" returns="f_nReturnCode" timeout="f_nTIMEOUT" endpoint="oMS.strEndPoint" connection-id="oMS.strConnectionId" ms-sdp="oMS.strContent" to="oCallLeg.strTo" from="oCallLeg.strFrom" cseq="oCallLeg.strRemoteCSeq" via="oCallLeg.strVia" mgcp-call-id="oMS.strCallId" ingress-gateway="" packetization-period="oMS.nPacketizationPeriod" early-media="1" early-media-only="0" codec="f_strCodec" ms-type="oMS.strType" telephone-events="0" route="" record-route="oCallLeg.strRecordRoute" contact="" session-expires="" min-se="" supported="" use-session-timer="0" min-supported-session-timer="" refresher=""/>
          <results >
            <result name="Default" link="5" stubbed="1"/>
            <result name="Success" link="3" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout"/>
            <result name="Resource Unavailable"/>
            <result name="Caller Hung up" link="2" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.oMS.strEndPoint = "";
Session.oMS.strCallId = "";
Session.oMS.strConnectionId = "";
Session.oMS.strContent = "";
Session.oMS.bCurrentlyConnected = false;]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2 && Result.id !=6)
{
	Server.logError("ERROR: FAIL TO CONNECT CALLER TO MS. RETURN CODE IS: " + Session.f_nReturnCode);
	Server.logError("ERROR: FAIL TO CONNECT CALLER TO MS. EXIT ON BRANCH: " + Result.name);
}

if ( !Session.bRemoteCSeq ) {
	Session.oCallLeg.strCSeq = Session.oCallLeg.strRemoteCSeq;
}]]></script>
          </scripts>
        </action>
        <action id="11" plug-in="Pactolus.MSConnect.1" ><?xtml-editor x=411 y=958 ?>
          <!--Connect to media server-->
          <cc-connect xmlns="urn:www.pactolus.com:xtml:sip-cc" call-id="oCallLeg.strCallId" caller-sdp="oCallLeg.strContent" capability="2" inbound="1" returns="f_nReturnCode" timeout="f_nTIMEOUT" endpoint="oMS.strEndPoint" connection-id="oMS.strConnectionId" ms-sdp="oMS.strContent" to="oCallLeg.strTo" from="oCallLeg.strFrom" cseq="oCallLeg.strRemoteCSeq" via="oCallLeg.strVia" mgcp-call-id="oMS.strCallId" ingress-gateway="" packetization-period="oMS.nPacketizationPeriod" early-media="1" early-media-only="0" codec="f_strCodec" ms-type="oMS.strType" telephone-events="0" route="" record-route="oCallLeg.strRecordRoute" contact="" session-expires="" min-se="" supported="" use-session-timer="0" min-supported-session-timer="" refresher=""/>
          <results >
            <result name="Default" link="12" stubbed="0"/>
            <result name="Success" link="3" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout"/>
            <result name="Resource Unavailable" link="17" stubbed="1"/>
            <result name="Caller Hung up" link="2" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.oMS.strEndPoint = "";
Session.oMS.strCallId = "";
Session.oMS.strConnectionId = "";
Session.oMS.strContent = "";
Session.oMS.bCurrentlyConnected = false;]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2 && Result.id !=6)
{
	Server.logError("ERROR: FAIL TO CONNECT CALLER TO MS. RETURN CODE IS: " + Session.f_nReturnCode);
	Server.logError("ERROR: FAIL TO CONNECT CALLER TO MS. EXIT ON BRANCH: " + Result.name);
}

if ( !Session.bRemoteCSeq ) {
	Session.oCallLeg.strCSeq = Session.oCallLeg.strRemoteCSeq;
}]]></script>
          </scripts>
        </action>
        <action id="12" plug-in="Pactolus.Branch.1" ><?xtml-editor x=675 y=957 ?>
          <!--retry?-->
          <results >
            <result name="Default" link="5" stubbed="1"/>
            <result name="retry==true" link="14" stubbed="0" >oMS.bRetry == true</result>
          </results>
        </action>
        <action id="14" plug-in="Pactolus.MSConnect.1" ><?xtml-editor x=950 y=962 ?>
          <!--Connect to media server-->
          <cc-connect xmlns="urn:www.pactolus.com:xtml:sip-cc" call-id="oCallLeg.strCallId" caller-sdp="oCallLeg.strContent" capability="2" inbound="1" returns="f_nReturnCode" timeout="f_nTIMEOUT" endpoint="oMS.strEndPoint" connection-id="oMS.strConnectionId" ms-sdp="oMS.strContent" to="oCallLeg.strTo" from="oCallLeg.strFrom" cseq="oCallLeg.strRemoteCSeq" via="oCallLeg.strVia" mgcp-call-id="oMS.strCallId" ingress-gateway="" packetization-period="oMS.nPacketizationPeriod" early-media="1" early-media-only="0" codec="f_strCodec" ms-type="oMS.strType" telephone-events="0" route="" record-route="oCallLeg.strRecordRoute" contact="" session-expires="" min-se="" supported="" use-session-timer="0" min-supported-session-timer="" refresher=""/>
          <results >
            <result name="Default" link="5" stubbed="1"/>
            <result name="Success" link="3" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout"/>
            <result name="Resource Unavailable" link="16" stubbed="0"/>
            <result name="Caller Hung up" link="2" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.oMS.strEndPoint = "";
Session.oMS.strCallId = "";
Session.oMS.strConnectionId = "";
Session.oMS.strContent = "";
Session.oMS.bCurrentlyConnected = false;]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2 && Result.id !=6)
{
	Server.logError("ERROR: FAIL TO CONNECT CALLER TO MS. RETURN CODE IS: " + Session.f_nReturnCode);
	Server.logError("ERROR: FAIL TO CONNECT CALLER TO MS. EXIT ON BRANCH: " + Result.name);
}

if ( !Session.bRemoteCSeq ) {
	Session.oCallLeg.strCSeq = Session.oCallLeg.strRemoteCSeq;
}]]></script>
          </scripts>
        </action>
        <action id="16" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1180 y=1057 ?>
          <!--f_nRESOURCE_UNAVAILABLE-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nRESOURCE_UNAVAILABLE"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("**** RESOURCES ARE UNAVAILABLE ****");
Server.logInfo("oMS.strEndPoint: " + Session.oMS.strEndPoint);
Server.logInfo("oMS.strContent: " + Session.oMS.strContent);
Server.logInfo("oMS.strConnectionId: " + Session.oMS.strConnectionId);
Server.logInfo("oMS.strCallId: " + Session.oMS.strCallId);
Server.logInfo("oMS.strType: " + Session.oMS.strType);]]></script>
          </scripts>
        </action>
        <action id="17" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=739 y=767 ?>
          <!--f_nRESOURCE_UNAVAILABLE-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nRESOURCE_UNAVAILABLE"/>
        </action>
      </actions>
      <text-objects >
        <text-object x-coord="86" y-coord="42" width="401" height="186" text="INPUT:
oCallLeg    object type, A leg info
oMS        object type, media server info
OUTPUT:
return
    0    success
    -1    fail
    -2    caller hung up" font-name="Times New Roman" size="-16" red="0" green="0" blue="0" weight="0" underline="0" strikeout="0" point-size="12" italic="0"/>
      </text-objects>
    </function>
    <function name="MSOutdialParty" start="8" event="MSOutdialParty" returns="i4" >
      <parameters >
        <parameter name="oCallLeg" type="object" pass="byref"/>
        <parameter name="oMS" type="object" pass="byref"/>
        <parameter name="strContact" type="string"/>
      </parameters>
      <local-vars >
        <var name="f_nCALLERHUNGUP" type="i4" >-2</var>
        <var name="f_nFAILURE" type="i4" >-1</var>
        <var name="f_nSUCCESS" type="i4" >0</var>
        <var name="f_nTIMEOUT" type="i4" >40</var>
        <var name="f_nReturnCode" type="i4" >0</var>
        <var name="f_strCodec" type="string" ></var>
        <var name="f_strMSType" type="string" ></var>
      </local-vars>
      <actions >
        <action id="8" plug-in="Pactolus.Branch.1" ><?xtml-editor x=174 y=582 ?>
          <!--dial in or dial out?
dial in reverse to and from-->
          <results >
            <result name="Default" link="11" stubbed="0"/>
            <result name="oCallLeg.bReverseFromTo = true;" link="5" stubbed="0" >oCallLeg.bReverseFromTo == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("**** BEFORE MS OUTDIAL PARTY ****");
Server.logInfo("oCallLeg.strFrom: " + Session.oCallLeg.strFrom);
Server.logInfo("oCallLeg.strTo: " + Session.oCallLeg.strTo);
Server.logInfo("oCallLeg.strContent: " + Session.oCallLeg.strContent);
Server.logInfo("oCallLeg.strCSeq: " + Session.oCallLeg.strCSeq);
Server.logInfo("oCallLeg.strCallId: " + Session.oCallLeg.strCallId);
Server.logInfo("oCallLeg.strRequestUri: " + Session.oCallLeg.strRequestUri);
Server.logInfo("oMS.strEndPoint: " + Session.oMS.strEndPoint);
Server.logInfo("oMS.strContent: " + Session.oMS.strContent);
Server.logInfo("oMS.strConnectionId: " + Session.oMS.strConnectionId);
Server.logInfo("oMS.strCallId: " + Session.oMS.strCallId);
Server.logInfo("oMS.bUseForACD: " + Session.oMS.bUseForACD);
Server.logInfo("oMS.bUseForMOH: " + Session.oMS.bUseForMOH);
Server.logInfo("oMS.strType: " + Session.oMS.strType);
Server.logInfo("oMS.strACDType: " + Session.oMS.strACDType);
Server.logInfo("oMS.strMOHType: " + Session.oMS.strMOHType);

Server.logInfo("oCallLeg.strRoute: " + Session.oCallLeg.strRoute);
Server.logInfo("oCallLeg.strRecordRoute: " + Session.oCallLeg.strRecordRoute);
Server.logInfo("oMS.strCodec is: " + Session.oMS.strCodec);
if (0 == Session.oMS.strCodec.length ||  undefined == Session.oMS.strCodec)
{
	Session.f_strCodec = "PCMU";
}
else
{
	Session.f_strCodec = Session.oMS.strCodec;	
}
Server.logInfo("f_strCodec is: " + Session.f_strCodec);

if (Session.oMS.bUseForMOH)
{
	Session.f_strMSType = Session.oMS.strMOHType;
}
else if (Session.oMS.bUseForACD)
{
	Session.f_strMSType = Session.oMS.strACDType;
}
else
{
	Session.f_strMSType = Session.oMS.strType;
}
Server.logInfo("f_strMSType is: " + Session.f_strMSType);]]></script>
          </scripts>
        </action>
        <action id="1" plug-in="Pactolus.MSConnect.1" ><?xtml-editor x=763 y=778 ?>
          <!--Connect to media server-->
          <cc-connect xmlns="urn:www.pactolus.com:xtml:sip-cc" call-id="oCallLeg.strCallId" caller-sdp="oCallLeg.strContent" capability="0" inbound="0" returns="f_nReturnCode" timeout="f_nTIMEOUT" endpoint="oMS.strEndPoint" connection-id="oMS.strConnectionId" ms-sdp="oMS.strContent" to="oCallLeg.strFrom" from="oCallLeg.strTo" cseq="oCallLeg.strCSeq" via="" mgcp-call-id="oMS.strCallId" ingress-gateway="oCallLeg.strRequestUri" packetization-period="oMS.nPacketizationPeriod" early-media="0" early-media-only="0" codec="f_strCodec" ms-type="f_strMSType" telephone-events="0" route="oCallLeg.strRoute" record-route="oCallLeg.strRecordRoute" contact="strContact" session-expires="" min-se="" supported="" use-session-timer="0" min-supported-session-timer="" refresher=""/>
          <results >
            <result name="Default" link="4" stubbed="0"/>
            <result name="Success" link="3" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
            <result name="Resource Unavailable" link="7" stubbed="0"/>
            <result name="Caller Hung up" link="2" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.oMS.strEndPoint = "";
Session.oMS.strCallId = "";
Session.oMS.strConnectionId = "";
Session.oMS.strContent = "";
Session.oMS.bCurrentlyConnected = false;]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2 && Result.id !=6)
{
	Server.logError("ERROR: MS OUTDIAL FROM MEDIA SERVER TO CALLER FAILS. RETURN CODE IS: " + Session.f_nReturnCode);
	Server.logError("ERROR: MS OUTDIAL FROM MEDIA SERVER TO CALLER FAILS. EXIT ON BRANCH: " + Result.name);
}]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1070 y=1035 ?>
          <!--f_nCALLERHUNGUP-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nCALLERHUNGUP"/>
        </action>
        <action id="3" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1056 y=844 ?>
          <!--f_nSUCCESS-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nSUCCESS"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("SUCCESS CREATE MS CONNECTION");
Session.oMS.bCurrentlyConnected = true;
Server.logInfo("**** AFTER MS OUTDIAL PARTY ****");
Server.logInfo("oCallLeg.strFrom: " + Session.oCallLeg.strFrom);
Server.logInfo("oCallLeg.strTo: " + Session.oCallLeg.strTo);
Server.logInfo("oCallLeg.strContent: " + Session.oCallLeg.strContent);
Server.logInfo("oCallLeg.strCSeq: " + Session.oCallLeg.strCSeq);
Server.logInfo("oCallLeg.strCallId: " + Session.oCallLeg.strCallId);
Server.logInfo("oCallLeg.strRequestUri: " + Session.oCallLeg.strRequestUri);
Server.logInfo("oMS.strEndPoint: " + Session.oMS.strEndPoint);
Server.logInfo("oMS.strContent: " + Session.oMS.strContent);
Server.logInfo("oMS.strConnectionId: " + Session.oMS.strConnectionId);
Server.logInfo("oMS.strCallId: " + Session.oMS.strCallId);
Server.logInfo("oMS.strType: " + Session.oMS.strType);]]></script>
          </scripts>
        </action>
        <action id="4" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1051 y=741 ?>
          <!--f_nFAILURE-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nFAILURE"/>
        </action>
        <action id="5" plug-in="Pactolus.Branch.1" ><?xtml-editor x=469 y=858 ?>
          <!--NSM mediaserver?-->
          <results >
            <result name="Default" link="1" stubbed="0"/>
            <result name="NSM mediaserver?" link="1" stubbed="1" >f_strMSType match "NMS"</result>
            <result name="CONV mediaserver?" link="6" stubbed="0" >f_strMSType match "CONV"</result>
          </results>
        </action>
        <action id="6" plug-in="Pactolus.MSConnect.1" ><?xtml-editor x=763 y=1025 ?>
          <!--Connect to media server-->
          <cc-connect xmlns="urn:www.pactolus.com:xtml:sip-cc" call-id="oCallLeg.strCallId" caller-sdp="oCallLeg.strContent" capability="2" inbound="0" returns="f_nReturnCode" timeout="f_nTIMEOUT" endpoint="oMS.strEndPoint" connection-id="oMS.strConnectionId" ms-sdp="oMS.strContent" to="oCallLeg.strFrom" from="oCallLeg.strTo" cseq="oCallLeg.strCSeq" via="" mgcp-call-id="oMS.strCallId" ingress-gateway="oCallLeg.strRequestUri" packetization-period="oMS.nPacketizationPeriod" early-media="0" early-media-only="0" codec="f_strCodec" ms-type="f_strMSType" telephone-events="0" route="oCallLeg.strRoute" record-route="oCallLeg.strRecordRoute" contact="strContact" session-expires="" min-se="" supported="" use-session-timer="0" min-supported-session-timer="" refresher=""/>
          <results >
            <result name="Default" link="4" stubbed="1"/>
            <result name="Success" link="3" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout"/>
            <result name="Resource Unavailable" link="7" stubbed="1"/>
            <result name="Caller Hung up" link="2" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.oMS.strEndPoint = "";
Session.oMS.strCallId = "";
Session.oMS.strConnectionId = "";
Session.oMS.strContent = "";
Session.oMS.bCurrentlyConnected = false;]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2 && Result.id !=6)
{
	Server.logError("ERROR: MS OUTDIAL FROM MEDIA SERVER TO CALLER FAILS. RETURN CODE IS: " + Session.f_nReturnCode);
	Server.logError("ERROR: MS OUTDIAL FROM MEDIA SERVER TO CALLER FAILS. EXIT ON BRANCH: " + Result.name);
}]]></script>
          </scripts>
        </action>
        <action id="7" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1066 y=941 ?>
          <!--f_nFAILURE-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nFAILURE"/>
        </action>
        <action id="9" plug-in="Pactolus.MSConnect.1" ><?xtml-editor x=769 y=531 ?>
          <!--Connect to media server-->
          <cc-connect xmlns="urn:www.pactolus.com:xtml:sip-cc" call-id="oCallLeg.strCallId" caller-sdp="oCallLeg.strContent" capability="2" inbound="0" returns="f_nReturnCode" timeout="f_nTIMEOUT" endpoint="oMS.strEndPoint" connection-id="oMS.strConnectionId" ms-sdp="oMS.strContent" to="oCallLeg.strTo" from="oCallLeg.strFrom" cseq="oCallLeg.strCSeq" via="" mgcp-call-id="oMS.strCallId" ingress-gateway="oCallLeg.strRequestUri" packetization-period="oMS.nPacketizationPeriod" early-media="0" early-media-only="0" codec="f_strCodec" ms-type="f_strMSType" telephone-events="0" route="oCallLeg.strRoute" record-route="oCallLeg.strRecordRoute" contact="strContact" session-expires="" min-se="" supported="" use-session-timer="0" min-supported-session-timer="" refresher=""/>
          <results >
            <result name="Default" link="4" stubbed="1"/>
            <result name="Success" link="3" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout"/>
            <result name="Resource Unavailable" link="7" stubbed="1"/>
            <result name="Caller Hung up" link="2" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.oMS.strEndPoint = "";
Session.oMS.strCallId = "";
Session.oMS.strConnectionId = "";
Session.oMS.strContent = "";
Session.oMS.bCurrentlyConnected = false;]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2 && Result.id !=6)
{
	Server.logError("ERROR: MS OUTDIAL FROM MEDIA SERVER TO CALLER FAILS. RETURN CODE IS: " + Session.f_nReturnCode);
	Server.logError("ERROR: MS OUTDIAL FROM MEDIA SERVER TO CALLER FAILS. EXIT ON BRANCH: " + Result.name);
}]]></script>
          </scripts>
        </action>
        <action id="10" plug-in="Pactolus.MSConnect.1" ><?xtml-editor x=732 y=272 ?>
          <!--Connect to media server-->
          <cc-connect xmlns="urn:www.pactolus.com:xtml:sip-cc" call-id="oCallLeg.strCallId" caller-sdp="oCallLeg.strContent" capability="0" inbound="0" returns="f_nReturnCode" timeout="f_nTIMEOUT" endpoint="oMS.strEndPoint" connection-id="oMS.strConnectionId" ms-sdp="oMS.strContent" to="oCallLeg.strTo" from="oCallLeg.strFrom" cseq="oCallLeg.strCSeq" via="" mgcp-call-id="oMS.strCallId" ingress-gateway="oCallLeg.strRequestUri" packetization-period="oMS.nPacketizationPeriod" early-media="0" early-media-only="0" codec="f_strCodec" ms-type="f_strMSType" telephone-events="0" route="oCallLeg.strRoute" record-route="oCallLeg.strRecordRoute" contact="strContact" session-expires="" min-se="" supported="" use-session-timer="0" min-supported-session-timer="" refresher=""/>
          <results >
            <result name="Default" link="4" stubbed="1"/>
            <result name="Success" link="3" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout"/>
            <result name="Resource Unavailable" link="7" stubbed="1"/>
            <result name="Caller Hung up" link="2" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.oMS.strEndPoint = "";
Session.oMS.strCallId = "";
Session.oMS.strConnectionId = "";
Session.oMS.strContent = "";
Session.oMS.bCurrentlyConnected = false;]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2 && Result.id !=6)
{
	Server.logError("ERROR: MS OUTDIAL FROM MEDIA SERVER TO CALLER FAILS. RETURN CODE IS: " + Session.f_nReturnCode);
	Server.logError("ERROR: MS OUTDIAL FROM MEDIA SERVER TO CALLER FAILS. EXIT ON BRANCH: " + Result.name);
}]]></script>
          </scripts>
        </action>
        <action id="11" plug-in="Pactolus.Branch.1" ><?xtml-editor x=475 y=364 ?>
          <!--NSM mediaserver?-->
          <results >
            <result name="Default" link="10" stubbed="0"/>
            <result name="NSM mediaserver?" link="10" stubbed="1" >f_strMSType match "NMS"</result>
            <result name="CONV mediaserver?" link="9" stubbed="0" >f_strMSType match "CONV"</result>
          </results>
        </action>
      </actions>
      <text-objects >
        <text-object x-coord="57" y-coord="46" width="320" height="181" text="Caller is on hold at this time
INPUT:
oCallLeg        object type, A leg info
oMS            object type, media server info
OUTPUT:
return
    0    success
    -1    fail
    -2    caller hung up" font-name="Times New Roman" size="-16" red="0" green="0" blue="0" weight="0" underline="0" strikeout="0" point-size="12" italic="0"/>
      </text-objects>
    </function>
    <function name="DeleteMSConnection" start="5" event="DeleteMSConnection" returns="i4" >
      <parameters >
        <parameter name="oMS" type="object" pass="byref"/>
      </parameters>
      <local-vars >
        <var name="f_nTIMEOUT" type="i4" >40</var>
        <var name="f_nSUCCESS" type="i4" >0</var>
        <var name="f_nFAILURE" type="i4" >-1</var>
        <var name="f_nReturnCode" type="i4" >-50</var>
        <var name="f_strMSType" type="string" ></var>
      </local-vars>
      <actions >
        <action id="5" plug-in="Pactolus.Branch.1" ><?xtml-editor x=106 y=503 ?>
          <!--Connected to MS?-->
          <results >
            <result name="Default" link="4" stubbed="0"/>
            <result name="connected to MS?" link="1" stubbed="0" >oMS.bCurrentlyConnected == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("**** BEFORE DELETE MS CONNECTION ****");
Server.logInfo("oMS.strEndPoint: " + Session.oMS.strEndPoint);
Server.logInfo("oMS.strConnectionId: " + Session.oMS.strConnectionId);
Server.logInfo("oMS.strCallId: " + Session.oMS.strCallId);]]></script>
          </scripts>
        </action>
        <action id="1" plug-in="Pactolus.MGCPDelete.1" ><?xtml-editor x=397 y=628 ?>
          <dlcx xmlns="urn:www.pactolus.com:xtml:media" connection-id="oMS.strConnectionId" endpoint="oMS.strEndPoint" callid="oMS.strCallId" timeout="f_nTIMEOUT" returns="f_nReturnCode" ms-type="f_strMSType" >
            <parameters >
              <quarantine step="0" loop="0" process="0" discard="0"/>
              <events ><![CDATA[]]></events>
              <signals ><![CDATA[]]></signals>
              <digit-map ><![CDATA[]]></digit-map>
            </parameters>
          </dlcx>
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="Success" link="3" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("oMS.bUseForACD: " + Session.oMS.bUseForACD);
Server.logInfo("oMS.bUseForMOH: " + Session.oMS.bUseForMOH);
Server.logInfo("oMS.strType: " + Session.oMS.strType);
Server.logInfo("oMS.strACDType: " + Session.oMS.strACDType);
Server.logInfo("oMS.strMOHType: " + Session.oMS.strMOHType);


if (Session.oMS.bUseForMOH)
{
	Session.f_strMSType = Session.oMS.strMOHType;
}
else if (Session.oMS.bUseForACD)
{
	Session.f_strMSType = Session.oMS.strACDType;
}
else
{
	Session.f_strMSType = Session.oMS.strType;
}
Server.logInfo("f_strMSType is: " + Session.f_strMSType);]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=633 y=624 ?>
          <!--f_nFAILURE-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nFAILURE"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("FAIL TO DELETE MS CONNECTION, CONNECTION Id: " + Session.oMS.strConnectionId + " END POINT: " + Session.oMS.strEndPoint + " RETURN CODE IS: " + Session.f_nReturnCode);]]></script>
          </scripts>
        </action>
        <action id="3" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=632 y=694 ?>
          <!--f_nSUCCESS-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nSUCCESS"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.oMS.strCallId = "";
Session.oMS.strConnectionId = "";
Session.oMS.strEndPoint = "";
Session.oMS.strContent = "";
Session.oMS.bCurrentlyConnected = false;
Server.logInfo("SUCCESS DELETE MS CONNECTION");]]></script>
          </scripts>
        </action>
        <action id="4" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=388 y=497 ?>
          <!--f_nSUCCESS-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nSUCCESS"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: NOT CONNECTED TO MS, NO NEED TO DELETE CONNECTION.");]]></script>
          </scripts>
        </action>
      </actions>
      <text-objects >
        <text-object x-coord="142" y-coord="55" width="268" height="151" text="Delete mediaserver connection
INPUT
    oMS    object type    mediaserver info
OUTPUT
returns
0    SUCCESS
-1    FAILURE" font-name="Times New Roman" size="-16" red="0" green="0" blue="0" weight="0" underline="0" strikeout="0" point-size="12" italic="0"/>
      </text-objects>
    </function>
    <function name="PlayOnePrompt" start="1" event="PlayOnePrompt" returns="i4" >
      <parameters >
        <parameter name="oMS" type="object"/>
        <parameter name="strLanguage" type="string"/>
        <parameter name="nPromptNumber" type="i4"/>
      </parameters>
      <local-vars >
        <var name="f_nSUCCESS" type="i4" >0</var>
        <var name="f_nFAILURE" type="i4" >-1</var>
        <var name="f_nTIMEOUT" type="i4" >30</var>
        <var name="f_nReturnCode" type="i4" >0</var>
        <var name="f_strLanguage" type="string" >eng</var>
        <var name="f_bValid" type="boolean" >0</var>
      </local-vars>
      <actions >
        <action id="1" plug-in="Pactolus.Branch.1" ><?xtml-editor x=114 y=360 ?>
          <!--promt > 0?-->
          <results >
            <result name="Default" link="3" stubbed="0"/>
            <result name="nPromptNumber &gt; 0?" link="2" stubbed="0" >nPromptNumber &gt; 0
AND f_bValid == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("**** BEFORE PLAY ONE PROMPT ****");
Server.logInfo("oMS.strEndPoint: " + Session.oMS.strEndPoint);
Server.logInfo("oMS.strConnectionId: " + Session.oMS.strConnectionId);
Server.logInfo("oMS.strCallId: " + Session.oMS.strCallId);
Server.logInfo("oMS.strType: " + Session.oMS.strType);
Server.logInfo("strLanguage: " + Session.strLanguage);
Server.logInfo("nPromptNumber: " + Session.nPromptNumber);

if (Session.oMS.strEndPoint.length > 0 && 
   (Session.oMS.strCallId.length > 0 || Session.oMS.strType == "PCS") && 
   Session.oMS.strConnectionId.length > 0)
{
	Session.f_bValid = true;
}
else
{
	Session.f_bValid = false;
}]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=414 y=463 ?>
          <!--play what ever prompt number passed in this sibb-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="oMS.strConnectionId" endpoint="oMS.strEndPoint" callid="oMS.strCallId" repeat="1" timeout="f_nTIMEOUT" ms-type="oMS.strType" returns="f_nReturnCode" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="f_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >nPromptNumber</audio>
          </play>
          <results >
            <result name="Default" link="3" stubbed="0"/>
            <result name="Success" link="4" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (Session.strLanguage.length > 0)
{
	Session.f_strLanguage = Session.strLanguage;
}]]></script>
            <script language="javascript" timing="last" ><![CDATA[if(Result.id != 2) {
	Server.logError("lib_mediaserver.xml: Play Pac exited on: " + Result.name);
}]]></script>
          </scripts>
        </action>
        <action id="3" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=762 y=425 ?>
          <!--FAILURE-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nFAILURE"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logError("lib_mediaserver.xml: Failure playing prompt number: " + Session.nPromptNumber);
Server.logError("lib_mediaserver.xml: oMS.strEndPoint: " + Session.oMS.strEndPoint);
Server.logError("lib_mediaserver.xml: oMS.strConnectionId: " + Session.oMS.strConnectionId);
Server.logError("lib_mediaserver.xml: oMS.strCallId: " + Session.oMS.strCallId);
Server.logError("lib_mediaserver.xml: oMS.strType: " + Session.oMS.strType);
Server.logError("lib_mediaserver.xml: strLanguage: " + Session.strLanguage);]]></script>
          </scripts>
        </action>
        <action id="4" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=764 y=551 ?>
          <!--SUCCESS-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nSUCCESS"/>
        </action>
      </actions>
      <text-objects >
        <text-object x-coord="132" y-coord="58" width="458" height="184" text="play any prompt number
INPUT:
    oMS            object type    media server info
    strLanguage        string type    language
    intPromptNumber    int type        prompt number to play
OUTPUT:
returns:
    0    SUCCESS
    -1    FAILURE" font-name="Times New Roman" size="-16" red="0" green="0" blue="0" weight="0" underline="0" strikeout="0" point-size="12" italic="0"/>
      </text-objects>
    </function>
    <function name="PlayCallCSR" start="6" event="PlayCallCSR" returns="i4" >
      <parameters >
        <parameter name="oMS" type="object"/>
        <parameter name="strLanguage" type="string"/>
        <parameter name="strCSRPhone" type="string"/>
      </parameters>
      <local-vars >
        <var name="f_nReturnCode" type="i4" >0</var>
        <var name="f_nTIMEOUT" type="i4" >30</var>
        <var name="f_nSUCCESS" type="i4" >0</var>
        <var name="f_nFAILURE" type="i4" >-1</var>
        <var name="f_bNullString" type="boolean" >0</var>
        <var name="f_strLanguage" type="string" >eng</var>
        <var name="f_bValid" type="boolean" >0</var>
      </local-vars>
      <actions >
        <action id="6" plug-in="Pactolus.Branch.1" ><?xtml-editor x=141 y=321 ?>
          <!--valid ms?-->
          <results >
            <result name="Default" link="4" stubbed="0"/>
            <result name="f_bValid == true" link="1" stubbed="0" >f_bValid == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if(Session.oMS.strType == "PCS" && Session.oMS.strEndPoint.length > 0) {
	Session.f_bValid = true;
} else if (Session.oMS.strEndPoint.length > 0 && Session.oMS.strCallId.length > 0 && Session.oMS.strConnectionId.length > 0) {
	Session.f_bValid = true;
} else {
	Session.f_bValid = false;
}]]></script>
          </scripts>
        </action>
        <action id="1" plug-in="Pactolus.Branch.1" ><?xtml-editor x=416 y=442 ?>
          <!--no CSR number?-->
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="no csr number" link="3" stubbed="0" >f_bNullString == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (Session.strCSRPhone.length < 10)
{
	Session.f_bNullString = true;
}
Server.logInfo("**** BEFORE PLAY CALL CSR ****");
Server.logInfo("oMS.strEndPoint: " + Session.oMS.strEndPoint);
Server.logInfo("oMS.strConnectionId: " + Session.oMS.strConnectionId);
Server.logInfo("oMS.strCallId: " + Session.oMS.strCallId);
Server.logInfo("oMS.strType: " + Session.oMS.strType);
Server.logInfo("strLanguage: " + Session.strLanguage);
Server.logInfo("strCSRPhone: " + Session.strCSRPhone);]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=702 y=395 ?>
          <!--play call csr number-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="oMS.strConnectionId" endpoint="oMS.strEndPoint" callid="oMS.strCallId" repeat="1" timeout="f_nTIMEOUT" ms-type="oMS.strType" returns="f_nReturnCode" start-play="1" interrupt="0" return-immediate="0" digit-map="" language="strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >306</audio>
            <audio type="digits" >strCSRPhone</audio>
            <audio type="index" >3846</audio>
          </play>
          <results >
            <result name="Default" link="4" stubbed="0"/>
            <result name="Success" link="5" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (Session.strLanguage.length > 0)
{
	Session.f_strLanguage = Session.strLanguage;
}]]></script>
            <script language="javascript" timing="last" ><![CDATA[if(Result.id != 2) {
	Server.logError("lib_mediaserver.xml: Play Pac exited on: " + Result.name);
}]]></script>
          </scripts>
        </action>
        <action id="3" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=720 y=576 ?>
          <!--play call csr-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="oMS.strConnectionId" endpoint="oMS.strEndPoint" callid="oMS.strCallId" repeat="1" timeout="f_nTIMEOUT" ms-type="oMS.strType" returns="f_nReturnCode" start-play="1" interrupt="0" return-immediate="0" digit-map="" language="strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >307</audio>
          </play>
          <results >
            <result name="Default" link="4" stubbed="1"/>
            <result name="Success" link="5" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (Session.strLanguage.length > 0)
{
	Session.f_strLanguage = Session.strLanguage;
}]]></script>
            <script language="javascript" timing="last" ><![CDATA[if(Result.id != 2) {
	Server.logError("lib_mediaserver.xml: Play Pac exited on: " + Result.name);
}]]></script>
          </scripts>
        </action>
        <action id="4" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=964 y=393 ?>
          <!--FAILURE-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nFAILURE"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logError("lib_mediaserver.xml: Failure playing Call CS number: " + Session.strCSRPhone);
Server.logError("lib_mediaserver.xml: oMS.strEndPoint: " + Session.oMS.strEndPoint);
Server.logError("lib_mediaserver.xml: oMS.strConnectionId: " + Session.oMS.strConnectionId);
Server.logError("lib_mediaserver.xml: oMS.strCallId: " + Session.oMS.strCallId);
Server.logError("lib_mediaserver.xml: oMS.strType: " + Session.oMS.strType);
Server.logError("lib_mediaserver.xml: strLanguage: " + Session.strLanguage);
]]></script>
          </scripts>
        </action>
        <action id="5" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=963 y=492 ?>
          <!--SUCCESS-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nSUCCESS"/>
        </action>
      </actions>
      <text-objects >
        <text-object x-coord="193" y-coord="46" width="524" height="213" text="Call CSR, if CSR number is null, play general prompt, else play with phone number

INPUT:
    oMS        object type    mediaserver info
    strLanguage    string type    language
    strCSRPhone    string type    CSR phone number
OUTPUT:
returns:
    0    SUCCESS
    -1    FAILURE" font-name="Times New Roman" size="-16" red="0" green="0" blue="0" weight="0" underline="0" strikeout="0" point-size="12" italic="0"/>
      </text-objects>
    </function>
    <function name="CreateConference" start="4" event="CreateConference" returns="i4" >
      <parameters >
        <parameter name="oMS" type="object" pass="byref"/>
      </parameters>
      <local-vars >
        <var name="f_nReturnCode" type="i4" >0</var>
        <var name="f_nTIMEOUT" type="i4" >15</var>
        <var name="f_nSUCCESS" type="i4" >0</var>
        <var name="f_nFAILURE" type="i4" >-1</var>
        <var name="f_nConferenceMaxParties" type="i4" >0</var>
        <var name="f_nConferenceMaxTalkers" type="i4" >0</var>
        <var name="f_nReportingInterval" type="i4" >0</var>
        <var name="f_nDBThreshold" type="i4" >0</var>
        <var name="f_nNbrActiveSpeakers" type="i4" >0</var>
        <var name="f_strMSType" type="string" ></var>
      </local-vars>
      <actions >
        <action id="4" plug-in="Pactolus.Branch.1" ><?xtml-editor x=358 y=572 ?>
          <!--Persistent?-->
          <results >
            <result name="Default" link="1" stubbed="0"/>
            <result name="oMS.bPersistentFlag == false" link="5" stubbed="0" >oMS.bPersistentFlag == false</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("**** BEFORE CREATE TO CONFERENCE ****");
Server.logInfo("oMS.strConferenceId: " + Session.oMS.strConferenceId);
Server.logInfo("oMS.strType: " + Session.oMS.strType);
Server.logInfo("oMS.bPersistentFlag: " + Session.oMS.bPersistentFlag);
Server.logInfo("oMS.nConferenceMaxParties: " + Session.oMS.nConferenceMaxParties);
Server.logInfo("oMS.nConferenceMaxTalkers: " + Session.oMS.nConferenceMaxTalkers);
Server.logInfo("oMS.nNbrActiveSpeakers: " + Session.oMS.nNbrActiveSpeakers);
Server.logInfo("oMS.nReportingInterval: " + Session.oMS.nReportingInterval);
Server.logInfo("oMS.nDBThreshold: " + Session.oMS.nDBThreshold);
Server.logInfo("oMS.bUseForACD: " + Session.oMS.bUseForACD);
Server.logInfo("oMS.bUseForMOH: " + Session.oMS.bUseForMOH);
Server.logInfo("oMS.strType: " + Session.oMS.strType);
Server.logInfo("oMS.strACDType: " + Session.oMS.strACDType);
Server.logInfo("oMS.strMOHType: " + Session.oMS.strMOHType);


//ASN 
if (undefined == Session.oMS.nNbrActiveSpeakers) {
	Session.f_nNbrActiveSpeakers = 3;
} else {
	Session.f_nNbrActiveSpeakers = Session.oMS.nNbrActiveSpeakers;
}

if (undefined == Session.oMS.nReportingInterval) {
	Session.f_nReportingInterval = 5;
} else {
	Session.f_nReportingInterval  = Session.oMS.nReportingInterval;
}

if (undefined == Session.oMS.nDBThreshold) {
	Session.f_nDBThreshold = -96;
} else {
	Session.f_nDBThreshold = Session.oMS.nDBThreshold;
}


if (undefined == Session.oMS.nConferenceMaxParties || Session.oMS.nConferenceMaxParties <= 0)
{
	Session.f_nConferenceMaxParties = 125;
}
else
{
	Session.f_nConferenceMaxParties = Session.oMS.nConferenceMaxParties;
}
if (undefined == Session.oMS.nConferenceMaxTalkers || Session.oMS.nConferenceMaxTalkers <= 0)
{
	Session.f_nConferenceMaxTalkers = 3;
}
else
{
	Session.f_nConferenceMaxTalkers = Session.oMS.nConferenceMaxTalkers;
}
Server.logInfo("f_nConferenceMaxParties: " + Session.f_nConferenceMaxParties);
Server.logInfo("f_nConferenceMaxTalkers: " + Session.f_nConferenceMaxTalkers);

if (Session.oMS.bUseForMOH)
{
	Session.f_strMSType = Session.oMS.strMOHType;
}
else if (Session.oMS.bUseForACD)
{
	Session.f_strMSType = Session.oMS.strACDType;
}
else
{
	Session.f_strMSType = Session.oMS.strType;
}
Server.logInfo("f_strMSType is: " + Session.f_strMSType);]]></script>
          </scripts>
        </action>
        <action id="1" plug-in="Pactolus.CNFCreateConf.1" ><?xtml-editor x=601 y=487 ?>
          <!--Create a conference-->
          <create-conference xmlns="urn:www.pactolus.com:xtml:conference" ci="oMS.strConferenceId" persist="1" ms-type="f_strMSType" timeout="f_nTIMEOUT" returns="f_nReturnCode" mp="f_nConferenceMaxParties" mt="f_nConferenceMaxTalkers" hysteresis="" time-constant="" active-speakers="f_nNbrActiveSpeakers" reporting-interval="f_nReportingInterval" active-speaker-threshold="f_nDBThreshold" >
            <attributes mp="f_nConferenceMaxParties" mt="f_nConferenceMaxTalkers" ig="0" og="0" iat="-10" ias="-40" oat="-10" oas="-40" atn="f_nNbrActiveSpeakers" att="f_nReportingInterval" ia="1" oa="1" te="1" le="1" tp="0" dc="1" tc="1" ate="0" se="0"/>
          </create-conference>
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="Success" link="3" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Result.id !=2)
{
	Server.logError("ERROR: FAIL TO CREATE A CONFERENCE, EXIT ON: " + Result.name);
	Server.logError("ERROR: MS CONFERENCE Id = " + Session.oMS.strConferenceId + " RETURN CODE IS: " + Session.f_nReturnCode);
}]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=847 y=470 ?>
          <!--f_nFAILURE-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nFAILURE"/>
        </action>
        <action id="3" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=856 y=592 ?>
          <!--f_nSUCCESS-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nSUCCESS"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("SUCCESS CREATE CONFERENCE");
Server.logInfo("**** AFTER CREATE CONFERENCE ****");
Server.logInfo("oMS.strConferenceId: " + Session.oMS.strConferenceId);
Server.logInfo("oMS.strType: " + Session.oMS.strType);]]></script>
          </scripts>
        </action>
        <action id="5" plug-in="Pactolus.CNFCreateConf.1" ><?xtml-editor x=618 y=716 ?>
          <!--Create a conference-->
          <create-conference xmlns="urn:www.pactolus.com:xtml:conference" ci="oMS.strConferenceId" persist="0" ms-type="f_strMSType" timeout="f_nTIMEOUT" returns="f_nReturnCode" mp="f_nConferenceMaxParties" mt="f_nConferenceMaxTalkers" hysteresis="" time-constant="" active-speakers="f_nNbrActiveSpeakers" reporting-interval="f_nReportingInterval" active-speaker-threshold="f_nDBThreshold" >
            <attributes mp="f_nConferenceMaxParties" mt="f_nConferenceMaxTalkers" ig="0" og="0" iat="-10" ias="-40" oat="-10" oas="-40" atn="f_nNbrActiveSpeakers" att="f_nReportingInterval" ia="1" oa="1" te="1" le="1" tp="0" dc="1" tc="1" ate="0" se="0"/>
          </create-conference>
          <results >
            <result name="Default" link="2" stubbed="1"/>
            <result name="Success" link="3" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Result.id !=2)
{
	Server.logError("ERROR: FAIL TO CREATE A CONFERENCE, EXIT ON: " + Result.name);
	Server.logError("ERROR: MS CONFERENCE Id = " + Session.oMS.strConferenceId + " RETURN CODE IS: " + Session.f_nReturnCode);
}]]></script>
          </scripts>
        </action>
      </actions>
      <text-objects >
        <text-object x-coord="118" y-coord="70" width="393" height="181" text="Create a conference,  strConferenceId use through out the app same as conference resource
INPUT:
    oMS        object type    media server object
OUTPUT:
returns
    0    SUCCESS
    -1    FAILURE" font-name="Times New Roman" size="-16" red="0" green="0" blue="0" weight="0" underline="0" strikeout="0" point-size="12" italic="0"/>
      </text-objects>
    </function>
    <function name="AddMemberToConference" start="25" event="AddMemberToConference" returns="i4" >
      <parameters >
        <parameter name="oMS" type="object" pass="byref"/>
        <parameter name="oCallLeg" type="object" pass="byref"/>
        <parameter name="strContact" type="string"/>
      </parameters>
      <local-vars >
        <var name="f_nReturnCode" type="i4" >0</var>
        <var name="f_nTIMEOUT" type="i4" >40</var>
        <var name="f_nSUCCESS" type="i4" >0</var>
        <var name="f_nFAILURE" type="i4" >-1</var>
        <var name="f_nCALLERHUNGUP" type="i4" >-2</var>
        <var name="f_bDTMFClampFlag" type="boolean" >0</var>
        <var name="f_strCodec" type="string" ></var>
        <var name="f_strMSType" type="string" ></var>
        <var name="nExceedMaxFullDuplex" type="i4" >-3</var>
        <var name="nAGCTargetLevelIn" type="i4" >-9</var>
        <var name="nAGCMaxLevelIn" type="i4" >0</var>
        <var name="nAGCTargetLevelOut" type="i4" >-9</var>
        <var name="nAGCMaxLevelOut" type="i4" >0</var>
      </local-vars>
      <actions >
        <action id="25" plug-in="Pactolus.Branch.1" ><?xtml-editor x=309 y=741 ?>
          <!--CONV-->
          <results >
            <result name="Default" link="10" stubbed="0"/>
            <result name="f_strMSType == &quot;CONV&quot;" link="48" stubbed="0" >f_strMSType match "CONV"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("**** BEFORE ADD MEMBER TO CONFERENCE ****");
Server.logInfo("oCallLeg.strFrom: " + Session.oCallLeg.strFrom);
Server.logInfo("oCallLeg.strTo: " + Session.oCallLeg.strTo);
Server.logInfo("oCallLeg.strContent: " + Session.oCallLeg.strContent);
Server.logInfo("oCallLeg.strCSeq: " + Session.oCallLeg.strCSeq);
Server.logInfo("oCallLeg.strCallId: " + Session.oCallLeg.strCallId);
Server.logInfo("oCallLeg.strRequestUri: " + Session.oCallLeg.strRequestUri);
Server.logInfo("oMS.strConferenceId: " + Session.oMS.strConferenceId);
Server.logInfo("oMS.strEndPoint: " + Session.oMS.strEndPoint);
Server.logInfo("oMS.strContent: " + Session.oMS.strContent);
Server.logInfo("oMS.strConnectionId: " + Session.oMS.strConnectionId);
Server.logInfo("oMS.strCallId: " + Session.oMS.strCallId);
Server.logInfo("oMS.strType: " + Session.oMS.strType);
Server.logInfo("oMS.bMuteFlag: " + Session.oMS.bMuteFlag);
Server.logInfo("oMS.bDeafFlag: " + Session.oMS.bDeafFlag);
Server.logInfo("oMS.bCurrentlyInConf: " + Session.oMS.bCurrentlyInConf);
Server.logInfo("oMS.bCurrentlyConnected: " + Session.oMS.bCurrentlyConnected);
Server.logInfo("oMS.bRetry: " + Session.oMS.bRetry);
Server.logInfo("oMS.bDTMFClampFlag: " + Session.oMS.bDTMFClampFlag);
Server.logInfo("oMS.bUseForACD: " + Session.oMS.bUseForACD);
Server.logInfo("oMS.bUseForMOH: " + Session.oMS.bUseForMOH);
Server.logInfo("oMS.bUseForConf: " + Session.oMS.bUseForConf);
Server.logInfo("oMS.strType: " + Session.oMS.strType);
Server.logInfo("oMS.strACDType: " + Session.oMS.strACDType);
Server.logInfo("oMS.strMOHType: " + Session.oMS.strMOHType);
Server.logInfo("oMS.strConfType: " + Session.oMS.strConfType);
Server.logInfo("oMS.nAGCTargetLevelIn: " + Session.oMS.nAGCTargetLevelIn);
Server.logInfo("oMS.nAGCMaxLevelIn: " + Session.oMS.nAGCMaxLevelIn);
Server.logInfo("oMS.nAGCTargetLevelOut: " + Session.oMS.nAGCTargetLevelOut);
Server.logInfo("oMS.nAGCMaxLevelOut: " + Session.oMS.nAGCMaxLevelOut);

Server.logInfo("oCallLeg.strRoute: " + Session.oCallLeg.strRoute);
Server.logInfo("oCallLeg.strRecordRoute: " + Session.oCallLeg.strRecordRoute);

if (Session.oMS.bDTMFClampFlag == false)
{
	Session.f_bDTMFClampFlag = false;
}
else
{
	Session.f_bDTMFClampFlag = true;
}
Server.logInfo("oMS.strCodec is: " + Session.oMS.strCodec);
if (0 == Session.oMS.strCodec.length ||  undefined == Session.oMS.strCodec)
{
	Session.f_strCodec = "PCMU";
}
else
{
	Session.f_strCodec = Session.oMS.strCodec;	
}
Server.logInfo("f_strCodec is: " + Session.f_strCodec);

if (Session.oMS.bUseForMOH)
{
	Session.f_strMSType = Session.oMS.strMOHType;
}
else if (Session.oMS.bUseForACD)
{
	Session.f_strMSType = Session.oMS.strACDType;
}
else if (Session.oMS.bUseForConf)
{
	Session.f_strMSType = Session.oMS.strConfType;
}
else
{
	Session.f_strMSType = Session.oMS.strType;
}
Server.logInfo("f_strMSType is: " + Session.f_strMSType);
if (undefined == Session.oMS.nAGCTargetLevelIn)
{
	Session.nAGCTargetLevelIn = -9;
	Server.logInfo("use default AGC Target level in");
}
else
{
	Session.nAGCTargetLevelIn = Session.oMS.nAGCTargetLevelIn;	
}
Server.logInfo("nAGCTargetLevel in is: " + Session.nAGCTargetLevelIn);
if (undefined == Session.oMS.nAGCMaxLevelIn)
{
	Session.nAGCMaxLevelIn = 0;
	Server.logInfo("use default AGC Max level in");
}
else
{
	Session.nAGCMaxLevelIn = Session.oMS.nAGCMaxLevelIn;
}
Server.logInfo("nAGCMaxLevel in is: " + Session.nAGCMaxLevelIn);
if (undefined == Session.oMS.nAGCTargetLevelOut)
{
	Session.nAGCTargetLevelOut = -9;
	Server.logInfo("use default AGC Target level out");
}
else
{
	Session.nAGCTargetLevelOut = Session.oMS.nAGCTargetLevelOut;	
}
Server.logInfo("nAGCTargetLevel out is: " + Session.nAGCTargetLevelOut);
if (undefined == Session.oMS.nAGCMaxLevelOut)
{
	Session.nAGCMaxLevelOut = 0;
	Server.logInfo("use default AGC Max level out");
}
else
{
	Session.nAGCMaxLevelOut = Session.oMS.nAGCMaxLevelOut;
}
Server.logInfo("nAGCMaxLevel out is: " + Session.nAGCMaxLevelOut);]]></script>
          </scripts>
        </action>
        <action id="1" plug-in="Pactolus.CNFAddMember.1" ><?xtml-editor x=1120 y=836 ?>
          <!--talkable and listenable-->
          <add-member xmlns="urn:www.pactolus.com:xtml:conference" endpoint="oMS.strEndPoint" ms-type="f_strMSType" ci="oMS.strConferenceId" inbound="0" returns="f_nReturnCode" timeout="f_nTIMEOUT" connection-id="oMS.strConnectionId" ms-sdp="oMS.strContent" mgcp-call-id="oMS.strCallId" ingress-gateway="oCallLeg.strRequestUri" early-media="0" local="0" party-on-hold="0" packetization-period="oMS.nPacketizationPeriod" codec="f_strCodec" telephone-events="0" route="oCallLeg.strRoute" record-route="oCallLeg.strRecordRoute" contact="strContact" te="1" dc="f_bDTMFClampFlag" le="1" ig="" og="" ia="" oa="" iat="" oat="" ias="" oas="" tf="" lf="" session-expires="" min-se="" supported="" min-supported-session-timer="" refresher="" use-session-timer="0" conn-mode="send/receive" to="oCallLeg.strFrom" call-id="oCallLeg.strCallId" cseq="oCallLeg.strCSeq" caller-sdp="oCallLeg.strContent" from="oCallLeg.strTo" via="" >
            <attributes mp="16" mt="3" ig="0" og="0" iat="-10" ias="-40" oat="-10" oas="-40" atn="3" att="2" ia="1" oa="1" te="1" le="1" tp="0" dc="f_bDTMFClampFlag" tc="1" ate="0" se="0"/>
          </add-member>
          <results >
            <result name="Default" link="5" stubbed="0"/>
            <result name="Success" link="6" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
            <result name="Resource Unavailable" link="20" stubbed="0"/>
            <result name="Caller Hung up" link="7" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2 && Result.id !=6)
{
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. CONFERENCE Id: " + Session.oMS.strConferenceId);
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. RETURN CODE IS: " + Session.f_nReturnCode);
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. EXIT ON BRANCH: " + Result.name);
	if (502 == Session.f_nReturnCode)
		Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE: EXCEED MAX FULL DUPLEX");
}]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Pactolus.Branch.1" ><?xtml-editor x=828 y=979 ?>
          <!--oMS.bMuteFlag == true?-->
          <results >
            <result name="Default" link="1" stubbed="0"/>
            <result name="mute only" link="4" stubbed="0" >oMS.bMuteFlag == true
AND oMS.bDeafFlag == false</result>
            <result name="deaf only" link="8" stubbed="0" >oMS.bMuteFlag == false
AND oMS.bDeafFlag == true</result>
            <result name="mute and deaf" link="9" stubbed="0" >oMS.bMuteFlag == true
AND oMS.bDeafFlag == true</result>
          </results>
        </action>
        <action id="4" plug-in="Pactolus.CNFAddMember.1" ><?xtml-editor x=1126 y=1038 ?>
          <!--mute only-->
          <add-member xmlns="urn:www.pactolus.com:xtml:conference" endpoint="oMS.strEndPoint" ms-type="f_strMSType" ci="oMS.strConferenceId" inbound="0" returns="f_nReturnCode" timeout="f_nTIMEOUT" connection-id="oMS.strConnectionId" ms-sdp="oMS.strContent" mgcp-call-id="oMS.strCallId" ingress-gateway="oCallLeg.strRequestUri" early-media="0" local="0" party-on-hold="0" packetization-period="oMS.nPacketizationPeriod" codec="f_strCodec" telephone-events="0" route="oCallLeg.strRoute" record-route="oCallLeg.strRecordRoute" contact="strContact" te="0" dc="f_bDTMFClampFlag" le="1" ig="" og="" ia="" oa="" iat="" oat="" ias="" oas="" tf="" lf="" session-expires="" min-se="" supported="" min-supported-session-timer="" refresher="" use-session-timer="0" conn-mode="send/receive" to="oCallLeg.strFrom" call-id="oCallLeg.strCallId" cseq="oCallLeg.strCSeq" caller-sdp="oCallLeg.strContent" from="oCallLeg.strTo" via="" >
            <attributes mp="16" mt="3" ig="0" og="0" iat="-10" ias="-40" oat="-10" oas="-40" atn="3" att="2" ia="1" oa="1" te="0" le="1" tp="0" dc="f_bDTMFClampFlag" tc="1" ate="0" se="0"/>
          </add-member>
          <results >
            <result name="Default" link="5" stubbed="1"/>
            <result name="Success" link="21" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
            <result name="Resource Unavailable" link="20" stubbed="1"/>
            <result name="Caller Hung up" link="7" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2 && Result.id !=6)
{
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. CONFERENCE Id: " + Session.oMS.strConferenceId);
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. RETURN CODE IS: " + Session.f_nReturnCode);
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. EXIT ON BRANCH: " + Result.name);
	if (502 == Session.f_nReturnCode)
		Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE: EXCEED MAX FULL DUPLEX");
}]]></script>
          </scripts>
        </action>
        <action id="5" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1456 y=823 ?>
          <!--f_nReturnCode-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nReturnCode"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (502 == Session.f_nReturnCode)
	Session.f_nReturnCode = Session.nExceedMaxFullDuplex;
else
	Session.f_nReturnCode = Session.f_nFAILURE;]]></script>
          </scripts>
        </action>
        <action id="6" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1690 y=896 ?>
          <!--f_nSUCCESS-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nSUCCESS"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("SUCCESS ADD MEMBER");
Session.oMS.bCurrentlyInConf = true;

if(Session.oMS.strType == "PCS") {
	Session.oMS.bCurrentlyConnected = true;
}

Server.logInfo("**** AFTER ADD MEMBER TO CONFERENCE ****");
Server.logInfo("oCallLeg.strFrom: " + Session.oCallLeg.strFrom);
Server.logInfo("oCallLeg.strTo: " + Session.oCallLeg.strTo);
Server.logInfo("oCallLeg.strContent: " + Session.oCallLeg.strContent);
Server.logInfo("oCallLeg.strCSeq: " + Session.oCallLeg.strCSeq);
Server.logInfo("oCallLeg.strCallId: " + Session.oCallLeg.strCallId);
Server.logInfo("oCallLeg.strRequestUri: " + Session.oCallLeg.strRequestUri);
Server.logInfo("oMS.strConferenceId: " + Session.oMS.strConferenceId);
Server.logInfo("oMS.strEndPoint: " + Session.oMS.strEndPoint);
Server.logInfo("oMS.strContent: " + Session.oMS.strContent);
Server.logInfo("oMS.strConnectionId: " + Session.oMS.strConnectionId);
Server.logInfo("oMS.strCallId: " + Session.oMS.strCallId);
Server.logInfo("oMS.strType: " + Session.oMS.strType);
Server.logInfo("oMS.bMuteFlag: " + Session.oMS.bMuteFlag);
Server.logInfo("oMS.bDeafFlag: " + Session.oMS.bDeafFlag);
Server.logInfo("oMS.bCurrentlyInConf: " + Session.oMS.bCurrentlyInConf);
Server.logInfo("oMS.bCurrentlyConnected: " + Session.oMS.bCurrentlyConnected);
Server.logInfo("oMS.bRetry: " + Session.oMS.bRetry);]]></script>
          </scripts>
        </action>
        <action id="7" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1471 y=1062 ?>
          <!--f_nCALLERHUNGUP-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nCALLERHUNGUP"/>
        </action>
        <action id="8" plug-in="Pactolus.CNFAddMember.1" ><?xtml-editor x=1132 y=1249 ?>
          <!--deaf only-->
          <add-member xmlns="urn:www.pactolus.com:xtml:conference" endpoint="oMS.strEndPoint" ms-type="f_strMSType" ci="oMS.strConferenceId" inbound="0" returns="f_nReturnCode" timeout="f_nTIMEOUT" connection-id="oMS.strConnectionId" ms-sdp="oMS.strContent" mgcp-call-id="oMS.strCallId" ingress-gateway="oCallLeg.strRequestUri" early-media="0" local="0" party-on-hold="0" packetization-period="oMS.nPacketizationPeriod" codec="f_strCodec" telephone-events="0" route="oCallLeg.strRoute" record-route="oCallLeg.strRecordRoute" contact="strContact" te="1" dc="f_bDTMFClampFlag" le="0" ig="" og="" ia="" oa="" iat="" oat="" ias="" oas="" tf="" lf="" session-expires="" min-se="" supported="" min-supported-session-timer="" refresher="" use-session-timer="0" conn-mode="send/receive" to="oCallLeg.strFrom" call-id="oCallLeg.strCallId" cseq="oCallLeg.strCSeq" caller-sdp="oCallLeg.strContent" from="oCallLeg.strTo" via="" >
            <attributes mp="16" mt="3" ig="0" og="0" iat="-10" ias="-40" oat="-10" oas="-40" atn="3" att="2" ia="1" oa="1" te="1" le="0" tp="0" dc="f_bDTMFClampFlag" tc="1" ate="0" se="0"/>
          </add-member>
          <results >
            <result name="Default" link="5" stubbed="1"/>
            <result name="Success" link="21" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
            <result name="Resource Unavailable" link="20" stubbed="1"/>
            <result name="Caller Hung up" link="7" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2 && Result.id !=6)
{
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. CONFERENCE Id: " + Session.oMS.strConferenceId);
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. RETURN CODE IS: " + Session.f_nReturnCode);
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. EXIT ON BRANCH: " + Result.name);
	if (502 == Session.f_nReturnCode)
		Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE: EXCEED MAX FULL DUPLEX");
}]]></script>
          </scripts>
        </action>
        <action id="9" plug-in="Pactolus.CNFAddMember.1" ><?xtml-editor x=1120 y=1435 ?>
          <!--mute and deaf-->
          <add-member xmlns="urn:www.pactolus.com:xtml:conference" endpoint="oMS.strEndPoint" ms-type="f_strMSType" ci="oMS.strConferenceId" inbound="0" returns="f_nReturnCode" timeout="f_nTIMEOUT" connection-id="oMS.strConnectionId" ms-sdp="oMS.strContent" mgcp-call-id="oMS.strCallId" ingress-gateway="oCallLeg.strRequestUri" early-media="0" local="0" party-on-hold="0" packetization-period="oMS.nPacketizationPeriod" codec="f_strCodec" telephone-events="0" route="oCallLeg.strRoute" record-route="oCallLeg.strRecordRoute" contact="strContact" te="0" dc="f_bDTMFClampFlag" le="0" ig="" og="" ia="" oa="" iat="" oat="" ias="" oas="" tf="" lf="" session-expires="" min-se="" supported="" min-supported-session-timer="" refresher="" use-session-timer="0" conn-mode="send/receive" to="oCallLeg.strFrom" call-id="oCallLeg.strCallId" cseq="oCallLeg.strCSeq" caller-sdp="oCallLeg.strContent" from="oCallLeg.strTo" via="" >
            <attributes mp="16" mt="3" ig="0" og="0" iat="-10" ias="-40" oat="-10" oas="-40" atn="3" att="2" ia="1" oa="1" te="0" le="0" tp="0" dc="f_bDTMFClampFlag" tc="1" ate="0" se="0"/>
          </add-member>
          <results >
            <result name="Default" link="5" stubbed="1"/>
            <result name="Success" link="21" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout"/>
            <result name="Resource Unavailable" link="20" stubbed="1"/>
            <result name="Caller Hung up" link="7" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2 && Result.id !=6)
{
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. CONFERENCE Id: " + Session.oMS.strConferenceId);
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. RETURN CODE IS: " + Session.f_nReturnCode);
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. EXIT ON BRANCH: " + Result.name);
	if (502 == Session.f_nReturnCode)
		Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE: EXCEED MAX FULL DUPLEX");
}]]></script>
          </scripts>
        </action>
        <action id="10" plug-in="Pactolus.Branch.1" ><?xtml-editor x=608 y=523 ?>
          <!--dial in or dial out?
dial in reverse to and from-->
          <results >
            <result name="Default" link="18" stubbed="0"/>
            <result name="oCallLeg.bReverseFromTo = true;" link="2" stubbed="0" >oCallLeg.bReverseFromTo == true</result>
          </results>
        </action>
        <action id="11" plug-in="Pactolus.CNFAddMember.1" ><?xtml-editor x=1121 y=231 ?>
          <!--mute only-->
          <add-member xmlns="urn:www.pactolus.com:xtml:conference" endpoint="oMS.strEndPoint" ms-type="f_strMSType" ci="oMS.strConferenceId" inbound="0" returns="f_nReturnCode" timeout="f_nTIMEOUT" connection-id="oMS.strConnectionId" ms-sdp="oMS.strContent" mgcp-call-id="oMS.strCallId" ingress-gateway="oCallLeg.strRequestUri" early-media="0" local="0" party-on-hold="0" packetization-period="oMS.nPacketizationPeriod" codec="f_strCodec" telephone-events="0" route="oCallLeg.strRoute" record-route="oCallLeg.strRecordRoute" contact="strContact" te="0" dc="f_bDTMFClampFlag" le="1" ig="" og="" ia="" oa="" iat="" oat="" ias="" oas="" tf="" lf="" session-expires="" min-se="" supported="" min-supported-session-timer="" refresher="" use-session-timer="0" conn-mode="send/receive" to="oCallLeg.strTo" call-id="oCallLeg.strCallId" cseq="oCallLeg.strCSeq" caller-sdp="oCallLeg.strContent" from="oCallLeg.strFrom" via="" >
            <attributes mp="16" mt="3" ig="0" og="0" iat="-10" ias="-40" oat="-10" oas="-40" atn="3" att="2" ia="1" oa="1" te="0" le="1" tp="0" dc="f_bDTMFClampFlag" tc="1" ate="0" se="0"/>
          </add-member>
          <results >
            <result name="Default" link="12" stubbed="1"/>
            <result name="Success" link="23" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout"/>
            <result name="Resource Unavailable" link="19" stubbed="1"/>
            <result name="Caller Hung up" link="14" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2 && Result.id !=6)
{
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. CONFERENCE Id: " + Session.oMS.strConferenceId);
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. RETURN CODE IS: " + Session.f_nReturnCode);
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. EXIT ON BRANCH: " + Result.name);
	if (502 == Session.f_nReturnCode)
		Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE: EXCEED MAX FULL DUPLEX");
}]]></script>
          </scripts>
        </action>
        <action id="12" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1746 y=91 ?>
          <!--f_nReturnCode-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nReturnCode"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (502 == Session.f_nReturnCode)
	Session.f_nReturnCode = Session.nExceedMaxFullDuplex;
else
	Session.f_nReturnCode = Session.f_nFAILURE;]]></script>
          </scripts>
        </action>
        <action id="13" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1742 y=239 ?>
          <!--f_nSUCCESS-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nSUCCESS"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("SUCCESS ADD MEMEMBER");
Session.oMS.bCurrentlyInConf = true;

if(Session.oMS.strType == "PCS") {
	Session.oMS.bCurrentlyConnected = true;
}

Server.logInfo("**** AFTER ADD MEMBER TO CONFERENCE ****");
Server.logInfo("oCallLeg.strFrom: " + Session.oCallLeg.strFrom);
Server.logInfo("oCallLeg.strTo: " + Session.oCallLeg.strTo);
Server.logInfo("oCallLeg.strContent: " + Session.oCallLeg.strContent);
Server.logInfo("oCallLeg.strCSeq: " + Session.oCallLeg.strCSeq);
Server.logInfo("oCallLeg.strCallId: " + Session.oCallLeg.strCallId);
Server.logInfo("oCallLeg.strRequestUri: " + Session.oCallLeg.strRequestUri);
Server.logInfo("oMS.strConferenceId: " + Session.oMS.strConferenceId);
Server.logInfo("oMS.strEndPoint: " + Session.oMS.strEndPoint);
Server.logInfo("oMS.strContent: " + Session.oMS.strContent);
Server.logInfo("oMS.strConnectionId: " + Session.oMS.strConnectionId);
Server.logInfo("oMS.strCallId: " + Session.oMS.strCallId);
Server.logInfo("oMS.strType: " + Session.oMS.strType);
Server.logInfo("oMS.bMuteFlag: " + Session.oMS.bMuteFlag);
Server.logInfo("oMS.bDeafFlag: " + Session.oMS.bDeafFlag);
Server.logInfo("oMS.bCurrentlyInConf: " + Session.oMS.bCurrentlyInConf);
Server.logInfo("oMS.bCurrentlyConnected: " + Session.oMS.bCurrentlyConnected);
Server.logInfo("oMS.bRetry: " + Session.oMS.bRetry);]]></script>
          </scripts>
        </action>
        <action id="14" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1394 y=408 ?>
          <!--f_nCALLERHUNGUP-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nCALLERHUNGUP"/>
        </action>
        <action id="15" plug-in="Pactolus.CNFAddMember.1" ><?xtml-editor x=1127 y=442 ?>
          <!--deaf only-->
          <add-member xmlns="urn:www.pactolus.com:xtml:conference" endpoint="oMS.strEndPoint" ms-type="f_strMSType" ci="oMS.strConferenceId" inbound="0" returns="f_nReturnCode" timeout="f_nTIMEOUT" connection-id="oMS.strConnectionId" ms-sdp="oMS.strContent" mgcp-call-id="oMS.strCallId" ingress-gateway="oCallLeg.strRequestUri" early-media="0" local="0" party-on-hold="0" packetization-period="oMS.nPacketizationPeriod" codec="f_strCodec" telephone-events="0" route="oCallLeg.strRoute" record-route="oCallLeg.strRecordRoute" contact="strContact" te="1" dc="f_bDTMFClampFlag" le="0" ig="" og="" ia="" oa="" iat="" oat="" ias="" oas="" tf="" lf="" session-expires="" min-se="" supported="" min-supported-session-timer="" refresher="" use-session-timer="0" conn-mode="send/receive" to="oCallLeg.strTo" call-id="oCallLeg.strCallId" cseq="oCallLeg.strCSeq" caller-sdp="oCallLeg.strContent" from="oCallLeg.strFrom" via="" >
            <attributes mp="16" mt="3" ig="0" og="0" iat="-10" ias="-40" oat="-10" oas="-40" atn="3" att="2" ia="1" oa="1" te="1" le="0" tp="0" dc="f_bDTMFClampFlag" tc="1" ate="0" se="0"/>
          </add-member>
          <results >
            <result name="Default" link="12" stubbed="1"/>
            <result name="Success" link="23" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
            <result name="Resource Unavailable" link="19" stubbed="1"/>
            <result name="Caller Hung up" link="14" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2 && Result.id !=6)
{
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. CONFERENCE Id: " + Session.oMS.strConferenceId);
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. RETURN CODE IS: " + Session.f_nReturnCode);
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. EXIT ON BRANCH: " + Result.name);
	if (502 == Session.f_nReturnCode)
		Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE: EXCEED MAX FULL DUPLEX");
}]]></script>
          </scripts>
        </action>
        <action id="16" plug-in="Pactolus.CNFAddMember.1" ><?xtml-editor x=1115 y=628 ?>
          <!--mute and deaf-->
          <add-member xmlns="urn:www.pactolus.com:xtml:conference" endpoint="oMS.strEndPoint" ms-type="f_strMSType" ci="oMS.strConferenceId" inbound="0" returns="f_nReturnCode" timeout="f_nTIMEOUT" connection-id="oMS.strConnectionId" ms-sdp="oMS.strContent" mgcp-call-id="oMS.strCallId" ingress-gateway="oCallLeg.strRequestUri" early-media="0" local="0" party-on-hold="0" packetization-period="oMS.nPacketizationPeriod" codec="f_strCodec" telephone-events="0" route="oCallLeg.strRoute" record-route="oCallLeg.strRecordRoute" contact="strContact" te="0" dc="f_bDTMFClampFlag" le="0" ig="" og="" ia="" oa="" iat="" oat="" ias="" oas="" tf="" lf="" session-expires="" min-se="" supported="" min-supported-session-timer="" refresher="" use-session-timer="0" conn-mode="send/receive" to="oCallLeg.strTo" call-id="oCallLeg.strCallId" cseq="oCallLeg.strCSeq" caller-sdp="oCallLeg.strContent" from="oCallLeg.strFrom" via="" >
            <attributes mp="16" mt="3" ig="0" og="0" iat="-10" ias="-40" oat="-10" oas="-40" atn="3" att="2" ia="1" oa="1" te="0" le="0" tp="0" dc="f_bDTMFClampFlag" tc="1" ate="0" se="0"/>
          </add-member>
          <results >
            <result name="Default" link="12" stubbed="1"/>
            <result name="Success" link="23" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout"/>
            <result name="Resource Unavailable" link="19" stubbed="1"/>
            <result name="Caller Hung up" link="14" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2 && Result.id !=6)
{
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. CONFERENCE Id: " + Session.oMS.strConferenceId);
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. RETURN CODE IS: " + Session.f_nReturnCode);
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. EXIT ON BRANCH: " + Result.name);
	if (502 == Session.f_nReturnCode)
		Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE: EXCEED MAX FULL DUPLEX");
}]]></script>
          </scripts>
        </action>
        <action id="17" plug-in="Pactolus.CNFAddMember.1" ><?xtml-editor x=1115 y=29 ?>
          <!--talkable and listenable-->
          <add-member xmlns="urn:www.pactolus.com:xtml:conference" endpoint="oMS.strEndPoint" ms-type="f_strMSType" ci="oMS.strConferenceId" inbound="0" returns="f_nReturnCode" timeout="f_nTIMEOUT" connection-id="oMS.strConnectionId" ms-sdp="oMS.strContent" mgcp-call-id="oMS.strCallId" ingress-gateway="oCallLeg.strRequestUri" early-media="0" local="0" party-on-hold="0" packetization-period="oMS.nPacketizationPeriod" codec="f_strCodec" telephone-events="0" route="oCallLeg.strRoute" record-route="oCallLeg.strRecordRoute" contact="strContact" te="1" dc="f_bDTMFClampFlag" le="1" ig="" og="" ia="" oa="" iat="" oat="" ias="" oas="" tf="" lf="" session-expires="" min-se="" supported="" min-supported-session-timer="" refresher="" use-session-timer="0" conn-mode="send/receive" to="oCallLeg.strTo" call-id="oCallLeg.strCallId" cseq="oCallLeg.strCSeq" caller-sdp="oCallLeg.strContent" from="oCallLeg.strFrom" via="" >
            <attributes mp="16" mt="3" ig="0" og="0" iat="-10" ias="-40" oat="-10" oas="-40" atn="3" att="2" ia="1" oa="1" te="1" le="1" tp="0" dc="f_bDTMFClampFlag" tc="1" ate="0" se="0"/>
          </add-member>
          <results >
            <result name="Default" link="12" stubbed="0"/>
            <result name="Success" link="13" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
            <result name="Resource Unavailable" link="19" stubbed="0"/>
            <result name="Caller Hung up" link="14" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2 && Result.id !=6)
{
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. CONFERENCE Id: " + Session.oMS.strConferenceId);
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. RETURN CODE IS: " + Session.f_nReturnCode);
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. EXIT ON BRANCH: " + Result.name);
	if (502 == Session.f_nReturnCode)
		Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE: EXCEED MAX FULL DUPLEX");
}]]></script>
          </scripts>
        </action>
        <action id="18" plug-in="Pactolus.Branch.1" ><?xtml-editor x=811 y=172 ?>
          <!--oMS.bMuteFlag == true?-->
          <results >
            <result name="Default" link="17" stubbed="0"/>
            <result name="mute only" link="11" stubbed="0" >oMS.bMuteFlag == true
AND oMS.bDeafFlag == false</result>
            <result name="deaf only" link="15" stubbed="0" >oMS.bMuteFlag == false
AND oMS.bDeafFlag == true</result>
            <result name="mute and deaf" link="16" stubbed="0" >oMS.bMuteFlag == true
AND oMS.bDeafFlag == true</result>
          </results>
        </action>
        <action id="19" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1531 y=324 ?>
          <!--f_nReturnCode-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nReturnCode"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (502 == Session.f_nReturnCode)
	Session.f_nReturnCode = Session.nExceedMaxFullDuplex;
else
	Session.f_nReturnCode = Session.f_nFAILURE;]]></script>
          </scripts>
        </action>
        <action id="20" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1468 y=969 ?>
          <!--f_nReturnCode-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nReturnCode"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (502 == Session.f_nReturnCode)
	Session.f_nReturnCode = Session.nExceedMaxFullDuplex;
else
	Session.f_nReturnCode = Session.f_nFAILURE;]]></script>
          </scripts>
        </action>
        <action id="21" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1399 y=1250 ?>
          <results >
            <result name="Default" link="6" stubbed="1"/>
            <result name="f_strMSType = PCS" link="22" stubbed="0" >f_strMSType match "PCS"</result>
          </results>
        </action>
        <action id="22" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1640 y=1246 ?>
          <!--ModifyConferenceMember-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ModifyConferenceMember&quot;" return="f_nReturnCode" external-function="0" library="" >
            <parameter >oMS</parameter>
          </function>
          <results >
            <result name="Default" link="6" stubbed="1"/>
            <result name="f_nReturnCode !=0" >f_nReturnCode != 0</result>
          </results>
        </action>
        <action id="23" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1405 y=517 ?>
          <results >
            <result name="Default" link="13" stubbed="1"/>
            <result name="f_strMSType = PCS" link="24" stubbed="0" >f_strMSType match "PCS"</result>
          </results>
        </action>
        <action id="24" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1661 y=509 ?>
          <!--ModifyConferenceMember-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ModifyConferenceMember&quot;" return="f_nReturnCode" external-function="0" library="" >
            <parameter >oMS</parameter>
          </function>
          <results >
            <result name="Default" link="13" stubbed="1"/>
            <result name="f_nReturnCode !=0" >f_nReturnCode != 0</result>
          </results>
        </action>
        <action id="26" plug-in="Pactolus.CNFAddMember.1" ><?xtml-editor x=1132 y=2440 ?>
          <!--talkable and listenable-->
          <add-member xmlns="urn:www.pactolus.com:xtml:conference" endpoint="oMS.strEndPoint" ms-type="f_strMSType" ci="oMS.strConferenceId" inbound="0" returns="f_nReturnCode" timeout="f_nTIMEOUT" connection-id="oMS.strConnectionId" ms-sdp="oMS.strContent" mgcp-call-id="oMS.strCallId" ingress-gateway="oCallLeg.strRequestUri" early-media="0" local="0" party-on-hold="1" packetization-period="oMS.nPacketizationPeriod" codec="f_strCodec" telephone-events="0" route="oCallLeg.strRoute" record-route="oCallLeg.strRecordRoute" contact="strContact" te="1" dc="f_bDTMFClampFlag" le="1" ig="" og="" ia="1" oa="1" iat="nAGCTargetLevelIn" oat="nAGCTargetLevelOut" ias="nAGCMaxLevelIn" oas="nAGCMaxLevelOut" tf="2" lf="2" session-expires="" min-se="" supported="" min-supported-session-timer="" refresher="" use-session-timer="0" conn-mode="conference" to="oCallLeg.strFrom" call-id="oCallLeg.strCallId" cseq="oCallLeg.strCSeq" caller-sdp="oCallLeg.strContent" from="oCallLeg.strTo" via="" >
            <attributes mp="16" mt="3" ig="0" og="0" iat="nAGCTargetLevelIn" ias="nAGCMaxLevelIn" oat="nAGCTargetLevelOut" oas="nAGCMaxLevelOut" atn="3" att="2" ia="1" oa="1" te="1" le="1" tp="0" dc="f_bDTMFClampFlag" tc="1" ate="0" se="0"/>
          </add-member>
          <results >
            <result name="Default" link="29" stubbed="0"/>
            <result name="Success" link="30" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
            <result name="Resource Unavailable" link="42" stubbed="0"/>
            <result name="Caller Hung up" link="31" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2 && Result.id !=6)
{
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. CONFERENCE Id: " + Session.oMS.strConferenceId);
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. RETURN CODE IS: " + Session.f_nReturnCode);
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. EXIT ON BRANCH: " + Result.name);
	if (502 == Session.f_nReturnCode)
		Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE: EXCEED MAX FULL DUPLEX");
}]]></script>
          </scripts>
        </action>
        <action id="27" plug-in="Pactolus.Branch.1" ><?xtml-editor x=840 y=2583 ?>
          <!--oMS.bMuteFlag == true?-->
          <results >
            <result name="Default" link="26" stubbed="0"/>
            <result name="mute only" link="28" stubbed="0" >oMS.bMuteFlag == true
AND oMS.bDeafFlag == false</result>
            <result name="deaf only" link="32" stubbed="0" >oMS.bMuteFlag == false
AND oMS.bDeafFlag == true</result>
            <result name="mute and deaf" link="33" stubbed="0" >oMS.bMuteFlag == true
AND oMS.bDeafFlag == true</result>
          </results>
        </action>
        <action id="28" plug-in="Pactolus.CNFAddMember.1" ><?xtml-editor x=1138 y=2642 ?>
          <!--mute only-->
          <add-member xmlns="urn:www.pactolus.com:xtml:conference" endpoint="oMS.strEndPoint" ms-type="f_strMSType" ci="oMS.strConferenceId" inbound="0" returns="f_nReturnCode" timeout="f_nTIMEOUT" connection-id="oMS.strConnectionId" ms-sdp="oMS.strContent" mgcp-call-id="oMS.strCallId" ingress-gateway="oCallLeg.strRequestUri" early-media="0" local="0" party-on-hold="1" packetization-period="oMS.nPacketizationPeriod" codec="f_strCodec" telephone-events="0" route="oCallLeg.strRoute" record-route="oCallLeg.strRecordRoute" contact="strContact" te="1" dc="f_bDTMFClampFlag" le="1" ig="" og="" ia="1" oa="1" iat="nAGCTargetLevelIn" oat="nAGCTargetLevelOut" ias="nAGCMaxLevelIn" oas="nAGCMaxLevelOut" tf="2" lf="2" session-expires="" min-se="" supported="" min-supported-session-timer="" refresher="" use-session-timer="0" conn-mode="convedia listen only" to="oCallLeg.strFrom" call-id="oCallLeg.strCallId" cseq="oCallLeg.strCSeq" caller-sdp="oCallLeg.strContent" from="oCallLeg.strTo" via="" >
            <attributes mp="16" mt="3" ig="0" og="0" iat="nAGCTargetLevelIn" ias="nAGCMaxLevelIn" oat="nAGCTargetLevelOut" oas="nAGCMaxLevelOut" atn="3" att="2" ia="1" oa="1" te="1" le="1" tp="0" dc="f_bDTMFClampFlag" tc="1" ate="0" se="0"/>
          </add-member>
          <results >
            <result name="Default" link="29" stubbed="1"/>
            <result name="Success" link="43" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
            <result name="Resource Unavailable" link="42" stubbed="1"/>
            <result name="Caller Hung up" link="31" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2 && Result.id !=6)
{
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. CONFERENCE Id: " + Session.oMS.strConferenceId);
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. RETURN CODE IS: " + Session.f_nReturnCode);
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. EXIT ON BRANCH: " + Result.name);
	if (502 == Session.f_nReturnCode)
		Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE: EXCEED MAX FULL DUPLEX");
}]]></script>
          </scripts>
        </action>
        <action id="29" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1468 y=2427 ?>
          <!--f_nReturnCode-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nReturnCode"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (502 == Session.f_nReturnCode)
	Session.f_nReturnCode = Session.nExceedMaxFullDuplex;
else
	Session.f_nReturnCode = Session.f_nFAILURE;]]></script>
          </scripts>
        </action>
        <action id="30" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1702 y=2500 ?>
          <!--f_nSUCCESS-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nSUCCESS"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("SUCCESS ADD MEMBER");
Session.oMS.bCurrentlyInConf = true;

if(Session.oMS.strType == "PCS") {
	Session.oMS.bCurrentlyConnected = true;
}

Server.logInfo("**** AFTER ADD MEMBER TO CONFERENCE ****");
Server.logInfo("oCallLeg.strFrom: " + Session.oCallLeg.strFrom);
Server.logInfo("oCallLeg.strTo: " + Session.oCallLeg.strTo);
Server.logInfo("oCallLeg.strContent: " + Session.oCallLeg.strContent);
Server.logInfo("oCallLeg.strCSeq: " + Session.oCallLeg.strCSeq);
Server.logInfo("oCallLeg.strCallId: " + Session.oCallLeg.strCallId);
Server.logInfo("oCallLeg.strRequestUri: " + Session.oCallLeg.strRequestUri);
Server.logInfo("oMS.strConferenceId: " + Session.oMS.strConferenceId);
Server.logInfo("oMS.strEndPoint: " + Session.oMS.strEndPoint);
Server.logInfo("oMS.strContent: " + Session.oMS.strContent);
Server.logInfo("oMS.strConnectionId: " + Session.oMS.strConnectionId);
Server.logInfo("oMS.strCallId: " + Session.oMS.strCallId);
Server.logInfo("oMS.strType: " + Session.oMS.strType);
Server.logInfo("oMS.bMuteFlag: " + Session.oMS.bMuteFlag);
Server.logInfo("oMS.bDeafFlag: " + Session.oMS.bDeafFlag);
Server.logInfo("oMS.bCurrentlyInConf: " + Session.oMS.bCurrentlyInConf);
Server.logInfo("oMS.bCurrentlyConnected: " + Session.oMS.bCurrentlyConnected);
Server.logInfo("oMS.bRetry: " + Session.oMS.bRetry);]]></script>
          </scripts>
        </action>
        <action id="31" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1483 y=2666 ?>
          <!--f_nCALLERHUNGUP-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nCALLERHUNGUP"/>
        </action>
        <action id="32" plug-in="Pactolus.CNFAddMember.1" ><?xtml-editor x=1144 y=2853 ?>
          <!--deaf only-->
          <add-member xmlns="urn:www.pactolus.com:xtml:conference" endpoint="oMS.strEndPoint" ms-type="f_strMSType" ci="oMS.strConferenceId" inbound="0" returns="f_nReturnCode" timeout="f_nTIMEOUT" connection-id="oMS.strConnectionId" ms-sdp="oMS.strContent" mgcp-call-id="oMS.strCallId" ingress-gateway="oCallLeg.strRequestUri" early-media="0" local="0" party-on-hold="1" packetization-period="oMS.nPacketizationPeriod" codec="f_strCodec" telephone-events="0" route="oCallLeg.strRoute" record-route="oCallLeg.strRecordRoute" contact="strContact" te="1" dc="f_bDTMFClampFlag" le="1" ig="" og="" ia="1" oa="1" iat="nAGCTargetLevelIn" oat="nAGCTargetLevelOut" ias="nAGCMaxLevelIn" oas="nAGCMaxLevelOut" tf="2" lf="2" session-expires="" min-se="" supported="" min-supported-session-timer="" refresher="" use-session-timer="0" conn-mode="send" to="oCallLeg.strFrom" call-id="oCallLeg.strCallId" cseq="oCallLeg.strCSeq" caller-sdp="oCallLeg.strContent" from="oCallLeg.strTo" via="" >
            <attributes mp="16" mt="3" ig="0" og="0" iat="nAGCTargetLevelIn" ias="nAGCMaxLevelIn" oat="nAGCTargetLevelOut" oas="nAGCMaxLevelOut" atn="3" att="2" ia="1" oa="1" te="1" le="1" tp="0" dc="f_bDTMFClampFlag" tc="1" ate="0" se="0"/>
          </add-member>
          <results >
            <result name="Default" link="29" stubbed="1"/>
            <result name="Success" link="43" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
            <result name="Resource Unavailable" link="42" stubbed="1"/>
            <result name="Caller Hung up" link="31" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2 && Result.id !=6)
{
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. CONFERENCE Id: " + Session.oMS.strConferenceId);
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. RETURN CODE IS: " + Session.f_nReturnCode);
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. EXIT ON BRANCH: " + Result.name);
	if (502 == Session.f_nReturnCode)
		Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE: EXCEED MAX FULL DUPLEX");
}]]></script>
          </scripts>
        </action>
        <action id="33" plug-in="Pactolus.CNFAddMember.1" ><?xtml-editor x=1132 y=3039 ?>
          <!--mute and deaf-->
          <add-member xmlns="urn:www.pactolus.com:xtml:conference" endpoint="oMS.strEndPoint" ms-type="f_strMSType" ci="oMS.strConferenceId" inbound="0" returns="f_nReturnCode" timeout="f_nTIMEOUT" connection-id="oMS.strConnectionId" ms-sdp="oMS.strContent" mgcp-call-id="oMS.strCallId" ingress-gateway="oCallLeg.strRequestUri" early-media="0" local="0" party-on-hold="1" packetization-period="oMS.nPacketizationPeriod" codec="f_strCodec" telephone-events="0" route="oCallLeg.strRoute" record-route="oCallLeg.strRecordRoute" contact="strContact" te="1" dc="f_bDTMFClampFlag" le="1" ig="" og="" ia="1" oa="1" iat="nAGCTargetLevelIn" oat="nAGCTargetLevelOut" ias="nAGCMaxLevelIn" oas="nAGCMaxLevelOut" tf="2" lf="2" session-expires="" min-se="" supported="" min-supported-session-timer="" refresher="" use-session-timer="0" conn-mode="send/receive" to="oCallLeg.strFrom" call-id="oCallLeg.strCallId" cseq="oCallLeg.strCSeq" caller-sdp="oCallLeg.strContent" from="oCallLeg.strTo" via="" >
            <attributes mp="16" mt="3" ig="0" og="0" iat="nAGCTargetLevelIn" ias="nAGCMaxLevelIn" oat="nAGCTargetLevelOut" oas="nAGCMaxLevelOut" atn="3" att="2" ia="1" oa="1" te="1" le="1" tp="0" dc="f_bDTMFClampFlag" tc="1" ate="0" se="0"/>
          </add-member>
          <results >
            <result name="Default" link="29" stubbed="1"/>
            <result name="Success" link="43" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout"/>
            <result name="Resource Unavailable" link="42" stubbed="1"/>
            <result name="Caller Hung up" link="31" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2 && Result.id !=6)
{
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. CONFERENCE Id: " + Session.oMS.strConferenceId);
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. RETURN CODE IS: " + Session.f_nReturnCode);
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. EXIT ON BRANCH: " + Result.name);
	if (502 == Session.f_nReturnCode)
		Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE: EXCEED MAX FULL DUPLEX");
}]]></script>
          </scripts>
        </action>
        <action id="34" plug-in="Pactolus.CNFAddMember.1" ><?xtml-editor x=1129 y=1835 ?>
          <!--mute only-->
          <add-member xmlns="urn:www.pactolus.com:xtml:conference" endpoint="oMS.strEndPoint" ms-type="f_strMSType" ci="oMS.strConferenceId" inbound="0" returns="f_nReturnCode" timeout="f_nTIMEOUT" connection-id="oMS.strConnectionId" ms-sdp="oMS.strContent" mgcp-call-id="oMS.strCallId" ingress-gateway="oCallLeg.strRequestUri" early-media="0" local="0" party-on-hold="1" packetization-period="oMS.nPacketizationPeriod" codec="f_strCodec" telephone-events="0" route="oCallLeg.strRoute" record-route="oCallLeg.strRecordRoute" contact="strContact" te="1" dc="f_bDTMFClampFlag" le="1" ig="" og="" ia="1" oa="1" iat="nAGCTargetLevelIn" oat="nAGCTargetLevelOut" ias="nAGCMaxLevelIn" oas="nAGCMaxLevelOut" tf="2" lf="2" session-expires="" min-se="" supported="" min-supported-session-timer="" refresher="" use-session-timer="0" conn-mode="convedia listen only" to="oCallLeg.strTo" call-id="oCallLeg.strCallId" cseq="oCallLeg.strCSeq" caller-sdp="oCallLeg.strContent" from="oCallLeg.strFrom" via="" >
            <attributes mp="16" mt="3" ig="0" og="0" iat="nAGCTargetLevelIn" ias="nAGCMaxLevelIn" oat="nAGCTargetLevelOut" oas="nAGCMaxLevelOut" atn="3" att="2" ia="1" oa="1" te="1" le="1" tp="0" dc="f_bDTMFClampFlag" tc="1" ate="0" se="0"/>
          </add-member>
          <results >
            <result name="Default" link="35" stubbed="1"/>
            <result name="Success" link="45" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout"/>
            <result name="Resource Unavailable" link="41" stubbed="1"/>
            <result name="Caller Hung up" link="37" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2 && Result.id !=6)
{
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. CONFERENCE Id: " + Session.oMS.strConferenceId);
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. RETURN CODE IS: " + Session.f_nReturnCode);
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. EXIT ON BRANCH: " + Result.name);
}]]></script>
          </scripts>
        </action>
        <action id="35" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1758 y=1695 ?>
          <!--f_nReturnCode-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nReturnCode"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (502 == Session.f_nReturnCode)
	Session.f_nReturnCode = Session.nExceedMaxFullDuplex;
else
	Session.f_nReturnCode = Session.f_nFAILURE;]]></script>
          </scripts>
        </action>
        <action id="36" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1754 y=1843 ?>
          <!--f_nSUCCESS-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nSUCCESS"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("SUCCESS ADD MEMEMBER");
Session.oMS.bCurrentlyInConf = true;

if(Session.oMS.strType == "PCS") {
	Session.oMS.bCurrentlyConnected = true;
}

Server.logInfo("**** AFTER ADD MEMBER TO CONFERENCE ****");
Server.logInfo("oCallLeg.strFrom: " + Session.oCallLeg.strFrom);
Server.logInfo("oCallLeg.strTo: " + Session.oCallLeg.strTo);
Server.logInfo("oCallLeg.strContent: " + Session.oCallLeg.strContent);
Server.logInfo("oCallLeg.strCSeq: " + Session.oCallLeg.strCSeq);
Server.logInfo("oCallLeg.strCallId: " + Session.oCallLeg.strCallId);
Server.logInfo("oCallLeg.strRequestUri: " + Session.oCallLeg.strRequestUri);
Server.logInfo("oMS.strConferenceId: " + Session.oMS.strConferenceId);
Server.logInfo("oMS.strEndPoint: " + Session.oMS.strEndPoint);
Server.logInfo("oMS.strContent: " + Session.oMS.strContent);
Server.logInfo("oMS.strConnectionId: " + Session.oMS.strConnectionId);
Server.logInfo("oMS.strCallId: " + Session.oMS.strCallId);
Server.logInfo("oMS.strType: " + Session.oMS.strType);
Server.logInfo("oMS.bMuteFlag: " + Session.oMS.bMuteFlag);
Server.logInfo("oMS.bDeafFlag: " + Session.oMS.bDeafFlag);
Server.logInfo("oMS.bCurrentlyInConf: " + Session.oMS.bCurrentlyInConf);
Server.logInfo("oMS.bCurrentlyConnected: " + Session.oMS.bCurrentlyConnected);
Server.logInfo("oMS.bRetry: " + Session.oMS.bRetry);]]></script>
          </scripts>
        </action>
        <action id="37" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1406 y=2012 ?>
          <!--f_nCALLERHUNGUP-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nCALLERHUNGUP"/>
        </action>
        <action id="38" plug-in="Pactolus.CNFAddMember.1" ><?xtml-editor x=1135 y=2043 ?>
          <!--deaf only-->
          <add-member xmlns="urn:www.pactolus.com:xtml:conference" endpoint="oMS.strEndPoint" ms-type="f_strMSType" ci="oMS.strConferenceId" inbound="0" returns="f_nReturnCode" timeout="f_nTIMEOUT" connection-id="oMS.strConnectionId" ms-sdp="oMS.strContent" mgcp-call-id="oMS.strCallId" ingress-gateway="oCallLeg.strRequestUri" early-media="0" local="0" party-on-hold="1" packetization-period="oMS.nPacketizationPeriod" codec="f_strCodec" telephone-events="0" route="oCallLeg.strRoute" record-route="oCallLeg.strRecordRoute" contact="strContact" te="1" dc="f_bDTMFClampFlag" le="1" ig="" og="" ia="1" oa="1" iat="nAGCTargetLevelIn" oat="nAGCTargetLevelOut" ias="nAGCMaxLevelIn" oas="nAGCMaxLevelOut" tf="2" lf="2" session-expires="" min-se="" supported="" min-supported-session-timer="" refresher="" use-session-timer="0" conn-mode="send" to="oCallLeg.strTo" call-id="oCallLeg.strCallId" cseq="oCallLeg.strCSeq" caller-sdp="oCallLeg.strContent" from="oCallLeg.strFrom" via="" >
            <attributes mp="16" mt="3" ig="0" og="0" iat="nAGCTargetLevelIn" ias="nAGCMaxLevelIn" oat="nAGCTargetLevelOut" oas="nAGCMaxLevelOut" atn="3" att="2" ia="1" oa="1" te="1" le="1" tp="0" dc="f_bDTMFClampFlag" tc="1" ate="0" se="0"/>
          </add-member>
          <results >
            <result name="Default" link="35" stubbed="1"/>
            <result name="Success" link="45" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
            <result name="Resource Unavailable" link="41" stubbed="1"/>
            <result name="Caller Hung up" link="37" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2 && Result.id !=6)
{
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. CONFERENCE Id: " + Session.oMS.strConferenceId);
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. RETURN CODE IS: " + Session.f_nReturnCode);
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. EXIT ON BRANCH: " + Result.name);
	if (502 == Session.f_nReturnCode)
		Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE: EXCEED MAX FULL DUPLEX");
}]]></script>
          </scripts>
        </action>
        <action id="39" plug-in="Pactolus.CNFAddMember.1" ><?xtml-editor x=1127 y=2232 ?>
          <!--mute and deaf-->
          <add-member xmlns="urn:www.pactolus.com:xtml:conference" endpoint="oMS.strEndPoint" ms-type="f_strMSType" ci="oMS.strConferenceId" inbound="0" returns="f_nReturnCode" timeout="f_nTIMEOUT" connection-id="oMS.strConnectionId" ms-sdp="oMS.strContent" mgcp-call-id="oMS.strCallId" ingress-gateway="oCallLeg.strRequestUri" early-media="0" local="0" party-on-hold="1" packetization-period="oMS.nPacketizationPeriod" codec="f_strCodec" telephone-events="0" route="oCallLeg.strRoute" record-route="oCallLeg.strRecordRoute" contact="strContact" te="1" dc="f_bDTMFClampFlag" le="1" ig="" og="" ia="1" oa="1" iat="nAGCTargetLevelIn" oat="nAGCTargetLevelIn" ias="nAGCMaxLevelOut" oas="nAGCMaxLevelOut" tf="2" lf="2" session-expires="" min-se="" supported="" min-supported-session-timer="" refresher="" use-session-timer="0" conn-mode="send/receive" to="oCallLeg.strTo" call-id="oCallLeg.strCallId" cseq="oCallLeg.strCSeq" caller-sdp="oCallLeg.strContent" from="oCallLeg.strFrom" via="" >
            <attributes mp="16" mt="3" ig="0" og="0" iat="nAGCTargetLevelIn" ias="nAGCMaxLevelOut" oat="nAGCTargetLevelIn" oas="nAGCMaxLevelOut" atn="3" att="2" ia="1" oa="1" te="1" le="1" tp="0" dc="f_bDTMFClampFlag" tc="1" ate="0" se="0"/>
          </add-member>
          <results >
            <result name="Default" link="35" stubbed="1"/>
            <result name="Success" link="45" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout"/>
            <result name="Resource Unavailable" link="41" stubbed="1"/>
            <result name="Caller Hung up" link="37" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2 && Result.id !=6)
{
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. CONFERENCE Id: " + Session.oMS.strConferenceId);
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. RETURN CODE IS: " + Session.f_nReturnCode);
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. EXIT ON BRANCH: " + Result.name);
	if (502 == Session.f_nReturnCode)
		Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE: EXCEED MAX FULL DUPLEX");
}]]></script>
          </scripts>
        </action>
        <action id="40" plug-in="Pactolus.Branch.1" ><?xtml-editor x=823 y=1776 ?>
          <!--oMS.bMuteFlag == true?-->
          <results >
            <result name="Default" link="47" stubbed="0"/>
            <result name="mute only" link="34" stubbed="0" >oMS.bMuteFlag == true
AND oMS.bDeafFlag == false</result>
            <result name="deaf only" link="38" stubbed="0" >oMS.bMuteFlag == false
AND oMS.bDeafFlag == true</result>
            <result name="mute and deaf" link="39" stubbed="0" >oMS.bMuteFlag == true
AND oMS.bDeafFlag == true</result>
          </results>
        </action>
        <action id="41" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1543 y=1928 ?>
          <!--f_nReturnCode-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nReturnCode"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (502 == Session.f_nReturnCode)
	Session.f_nReturnCode = Session.nExceedMaxFullDuplex;
else
	Session.f_nReturnCode = Session.f_nFAILURE;]]></script>
          </scripts>
        </action>
        <action id="42" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1480 y=2573 ?>
          <!--f_nReturnCode-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nReturnCode"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (502 == Session.f_nReturnCode)
	Session.f_nReturnCode = Session.nExceedMaxFullDuplex;
else
	Session.f_nReturnCode = Session.f_nFAILURE;]]></script>
          </scripts>
        </action>
        <action id="43" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1411 y=2854 ?>
          <results >
            <result name="Default" link="30" stubbed="1"/>
            <result name="f_strMSType = PCS" link="44" stubbed="0" >f_strMSType match "PCS"</result>
          </results>
        </action>
        <action id="44" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1652 y=2850 ?>
          <!--ModifyConferenceMember-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ModifyConferenceMember&quot;" return="f_nReturnCode" external-function="0" library="" >
            <parameter >oMS</parameter>
          </function>
          <results >
            <result name="Default" link="30" stubbed="1"/>
            <result name="f_nReturnCode !=0" link="29" stubbed="1" >f_nReturnCode != 0</result>
          </results>
        </action>
        <action id="45" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1417 y=2121 ?>
          <results >
            <result name="Default" link="36" stubbed="1"/>
            <result name="f_strMSType = PCS" link="46" stubbed="0" >f_strMSType match "PCS"</result>
          </results>
        </action>
        <action id="46" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1673 y=2113 ?>
          <!--ModifyConferenceMember-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ModifyConferenceMember&quot;" return="f_nReturnCode" external-function="0" library="" >
            <parameter >oMS</parameter>
          </function>
          <results >
            <result name="Default" link="36" stubbed="1"/>
            <result name="f_nReturnCode !=0" >f_nReturnCode != 0</result>
          </results>
        </action>
        <action id="47" plug-in="Pactolus.CNFAddMember.1" ><?xtml-editor x=1127 y=1633 ?>
          <!--talkable and listenable-->
          <add-member xmlns="urn:www.pactolus.com:xtml:conference" endpoint="oMS.strEndPoint" ms-type="f_strMSType" ci="oMS.strConferenceId" inbound="0" returns="f_nReturnCode" timeout="f_nTIMEOUT" connection-id="oMS.strConnectionId" ms-sdp="oMS.strContent" mgcp-call-id="oMS.strCallId" ingress-gateway="oCallLeg.strRequestUri" early-media="0" local="0" party-on-hold="1" packetization-period="oMS.nPacketizationPeriod" codec="f_strCodec" telephone-events="0" route="oCallLeg.strRoute" record-route="oCallLeg.strRecordRoute" contact="strContact" te="1" dc="f_bDTMFClampFlag" le="1" ig="" og="" ia="1" oa="1" iat="nAGCTargetLevelIn" oat="nAGCTargetLevelOut" ias="nAGCMaxLevelIn" oas="nAGCMaxLevelOut" tf="2" lf="2" session-expires="" min-se="" supported="" min-supported-session-timer="" refresher="" use-session-timer="0" conn-mode="conference" to="oCallLeg.strTo" call-id="oCallLeg.strCallId" cseq="oCallLeg.strCSeq" caller-sdp="oCallLeg.strContent" from="oCallLeg.strFrom" via="" >
            <attributes mp="16" mt="3" ig="0" og="0" iat="nAGCTargetLevelIn" ias="nAGCMaxLevelIn" oat="nAGCTargetLevelOut" oas="nAGCMaxLevelOut" atn="3" att="2" ia="1" oa="1" te="1" le="1" tp="0" dc="f_bDTMFClampFlag" tc="1" ate="0" se="0"/>
          </add-member>
          <results >
            <result name="Default" link="35" stubbed="0"/>
            <result name="Success" link="36" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
            <result name="Resource Unavailable" link="41" stubbed="0"/>
            <result name="Caller Hung up" link="37" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2 && Result.id !=6)
{
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. CONFERENCE Id: " + Session.oMS.strConferenceId);
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. RETURN CODE IS: " + Session.f_nReturnCode);
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. EXIT ON BRANCH: " + Result.name);
	if (502 == Session.f_nReturnCode)
		Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE: EXCEED MAX FULL DUPLEX");
}]]></script>
          </scripts>
        </action>
        <action id="48" plug-in="Pactolus.Branch.1" ><?xtml-editor x=620 y=2127 ?>
          <!--dial in or dial out?
dial in reverse to and from-->
          <results >
            <result name="Default" link="40" stubbed="0"/>
            <result name="oCallLeg.bReverseFromTo = true;" link="27" stubbed="0" >oCallLeg.bReverseFromTo == true</result>
          </results>
        </action>
      </actions>
      <text-objects >
        <text-object x-coord="108" y-coord="49" width="443" height="202" text="Add a member to a conference either mute or unmute this member
INPUT:
    oMS        object type        media server info
    oCallLeg    object type        call party info
OUTPUT:
returns:
    0    SUCCESS
    -1    FAILURE
    -2    CALLER HUNG UP
" font-name="Times New Roman" size="-16" red="0" green="0" blue="0" weight="0" underline="0" strikeout="0" point-size="12" italic="0"/>
      </text-objects>
    </function>
    <function name="ModifyConferenceMember" start="10" event="ModifyConferenceMember" returns="i4" >
      <parameters >
        <parameter name="oMS" type="object"/>
      </parameters>
      <local-vars >
        <var name="f_nReturnCode" type="i4" >0</var>
        <var name="f_nTIMEOUT" type="i4" >10</var>
        <var name="f_nSUCCESS" type="i4" >0</var>
        <var name="f_nFAILURE" type="i4" >-1</var>
        <var name="f_bDTMFClampFlag" type="boolean" >0</var>
        <var name="f_strMSType" type="string" ></var>
      </local-vars>
      <actions >
        <action id="10" plug-in="Pactolus.Branch.1" ><?xtml-editor x=27 y=865 ?>
          <results >
            <result name="Default" link="1" stubbed="0"/>
            <result name="oMS.strCoachingFlag == &quot;T&quot;" link="9" stubbed="0" >oMS.strCoachingFlag == "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("oMS.bUseForACD: " + Session.oMS.bUseForACD);
Server.logInfo("oMS.bUseForMOH: " + Session.oMS.bUseForMOH);
Server.logInfo("oMS.strType: " + Session.oMS.strType);
Server.logInfo("oMS.strACDType: " + Session.oMS.strACDType);
Server.logInfo("oMS.strMOHType: " + Session.oMS.strMOHType);


if (Session.oMS.bUseForMOH)
{
	Session.f_strMSType = Session.oMS.strMOHType;
}
else if (Session.oMS.bUseForACD)
{
	Session.f_strMSType = Session.oMS.strACDType;
}
else
{
	Session.f_strMSType = Session.oMS.strType;
}
Server.logInfo("f_strMSType is: " + Session.f_strMSType);]]></script>
          </scripts>
        </action>
        <action id="1" plug-in="Pactolus.Branch.1" ><?xtml-editor x=208 y=438 ?>
          <!--oMS.bMuteFlag == true?-->
          <results >
            <result name="Default" link="15" stubbed="0"/>
            <result name="mute only" link="16" stubbed="0" >oMS.bMuteFlag == true
AND oMS.bDeafFlag == false</result>
            <result name="deaf only" link="17" stubbed="0" >oMS.bMuteFlag == false
AND oMS.bDeafFlag == true</result>
            <result name="mute and deaf" link="18" stubbed="0" >oMS.bMuteFlag == true
AND oMS.bDeafFlag == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("**** BEFORE MODIFY CONFERENCE MEMBER ****");
Server.logInfo("oMS.strConferenceId: " + Session.oMS.strConferenceId);
Server.logInfo("oMS.strEndPoint: " + Session.oMS.strEndPoint);
Server.logInfo("oMS.strConnectionId: " + Session.oMS.strConnectionId);
Server.logInfo("oMS.strType: " + Session.oMS.strType);
Server.logInfo("oMS.bMuteFlag: " + Session.oMS.bMuteFlag);
Server.logInfo("oMS.bDeafFlag: " + Session.oMS.bDeafFlag);
Server.logInfo("oMS.bCurrentlyInConf: " + Session.oMS.bCurrentlyInConf);
Server.logInfo("oMS.bCurrentlyConnected: " + Session.oMS.bCurrentlyConnected);
Server.logInfo("oMS.bRetry: " + Session.oMS.bRetry);
Server.logInfo("oMS.bDTMFClampFlag: " + Session.oMS.bDTMFClampFlag);

if (Session.oMS.bDTMFClampFlag == false)
{
	Session.f_bDTMFClampFlag = false;
}
else
{
	Session.f_bDTMFClampFlag = true;
}]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Pactolus.CNFModifyMember.1" ><?xtml-editor x=868 y=245 ?>
          <!--talkable and listenable-->
          <modify-member xmlns="urn:www.pactolus.com:xtml:conference" ci="oMS.strConferenceId" endpoint="oMS.strEndPoint" connection-id="oMS.strConnectionId" ms-type="f_strMSType" timeout="f_nTIMEOUT" returns="f_nReturnCode" mode="-1" co-ep="" te="1" dc="f_bDTMFClampFlag" le="1" ig="" og="" ia="" oa="" iat="" oat="" ias="" oas="" tf="" lf="" conn-mode="conference" >
            <attributes mp="16" mt="3" ig="0" og="0" iat="-10" ias="-40" oat="-10" oas="-40" atn="3" att="2" ia="1" oa="1" te="1" le="1" tp="0" dc="f_bDTMFClampFlag" tc="1" ate="0" se="0"/>
          </modify-member>
          <results >
            <result name="Default" link="3" stubbed="0"/>
            <result name="Success" link="4" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)
{
	Server.logError("ERROR: FAIL TO MODIFY MEMBER TO CONFERENCE. CONFERENCE Id: " + Session.oMS.strConferenceId + " END POINT IS: " + Session.oMS.strEndPoint + " CONNECTION Id: " + Session.oMS.strConnectionId);
	Server.logError("ERROR: FAIL TO MODIFY MEMBER TO CONFERENCE. RETURN CODE IS: " + Session.f_nReturnCode);
	Server.logError("ERROR: FAIL TO MODIFY MEMBER TO CONFERENCE. EXIT ON BRANCH: " + Result.name);
}]]></script>
          </scripts>
        </action>
        <action id="3" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1123 y=246 ?>
          <!--f_nFAILURE-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nFAILURE"/>
        </action>
        <action id="4" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1133 y=370 ?>
          <!--f_nSUCCESS-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nSUCCESS"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("SUCCESS MODIFY MEMBER CONFERENCE");
Server.logInfo("**** AFTER MODIFY CONFERENCE MEMBER ****");
Server.logInfo("oMS.strConferenceId: " + Session.oMS.strConferenceId);
Server.logInfo("oMS.strEndPoint: " + Session.oMS.strEndPoint);
Server.logInfo("oMS.strConnectionId: " + Session.oMS.strConnectionId);
Server.logInfo("oMS.strType: " + Session.oMS.strType);
Server.logInfo("oMS.bMuteFlag: " + Session.oMS.bMuteFlag);
Server.logInfo("oMS.bDeafFlag: " + Session.oMS.bDeafFlag);
Server.logInfo("oMS.bCurrentlyInConf: " + Session.oMS.bCurrentlyInConf);
Server.logInfo("oMS.bCurrentlyConnected: " + Session.oMS.bCurrentlyConnected);
Server.logInfo("oMS.bRetry: " + Session.oMS.bRetry);]]></script>
          </scripts>
        </action>
        <action id="6" plug-in="Pactolus.CNFModifyMember.1" ><?xtml-editor x=876 y=406 ?>
          <!--mute only-->
          <modify-member xmlns="urn:www.pactolus.com:xtml:conference" ci="oMS.strConferenceId" endpoint="oMS.strEndPoint" connection-id="oMS.strConnectionId" ms-type="f_strMSType" timeout="f_nTIMEOUT" returns="f_nReturnCode" mode="-1" co-ep="" te="1" dc="f_bDTMFClampFlag" le="1" ig="" og="" ia="" oa="" iat="" oat="" ias="" oas="" tf="1" lf="1" conn-mode="convedia listen only" >
            <attributes mp="16" mt="3" ig="0" og="0" iat="-10" ias="-40" oat="-10" oas="-40" atn="3" att="2" ia="1" oa="1" te="1" le="1" tp="0" dc="f_bDTMFClampFlag" tc="1" ate="0" se="0"/>
          </modify-member>
          <results >
            <result name="Default" link="3" stubbed="1"/>
            <result name="Success" link="4" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)
{
	Server.logError("ERROR: FAIL TO MODIFY MEMBER TO CONFERENCE. CONFERENCE Id: " + Session.oMS.strConferenceId + " END POINT IS: " + Session.oMS.strEndPoint + " CONNECTION Id: " + Session.oMS.strConnectionId);
	Server.logError("ERROR: FAIL TO MODIFY MEMBER TO CONFERENCE. RETURN CODE IS: " + Session.f_nReturnCode);
	Server.logError("ERROR: FAIL TO MODIFY MEMBER TO CONFERENCE. EXIT ON BRANCH: " + Result.name);
}]]></script>
          </scripts>
        </action>
        <action id="7" plug-in="Pactolus.CNFModifyMember.1" ><?xtml-editor x=885 y=573 ?>
          <!--deaf only-->
          <modify-member xmlns="urn:www.pactolus.com:xtml:conference" ci="oMS.strConferenceId" endpoint="oMS.strEndPoint" connection-id="oMS.strConnectionId" ms-type="f_strMSType" timeout="f_nTIMEOUT" returns="f_nReturnCode" mode="-1" co-ep="" te="1" dc="f_bDTMFClampFlag" le="1" ig="" og="" ia="" oa="" iat="" oat="" ias="" oas="" tf="1" lf="1" conn-mode="send" >
            <attributes mp="16" mt="3" ig="0" og="0" iat="-10" ias="-40" oat="-10" oas="-40" atn="3" att="2" ia="1" oa="1" te="1" le="1" tp="0" dc="f_bDTMFClampFlag" tc="1" ate="0" se="0"/>
          </modify-member>
          <results >
            <result name="Default" link="3" stubbed="1"/>
            <result name="Success" link="4" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)
{
	Server.logError("ERROR: FAIL TO MODIFY MEMBER TO CONFERENCE. CONFERENCE Id: " + Session.oMS.strConferenceId + " END POINT IS: " + Session.oMS.strEndPoint + " CONNECTION Id: " + Session.oMS.strConnectionId);
	Server.logError("ERROR: FAIL TO MODIFY MEMBER TO CONFERENCE. RETURN CODE IS: " + Session.f_nReturnCode);
	Server.logError("ERROR: FAIL TO MODIFY MEMBER TO CONFERENCE. EXIT ON BRANCH: " + Result.name);
}]]></script>
          </scripts>
        </action>
        <action id="8" plug-in="Pactolus.CNFModifyMember.1" ><?xtml-editor x=896 y=743 ?>
          <!--mute and deaf-->
          <modify-member xmlns="urn:www.pactolus.com:xtml:conference" ci="oMS.strConferenceId" endpoint="oMS.strEndPoint" connection-id="oMS.strConnectionId" ms-type="f_strMSType" timeout="f_nTIMEOUT" returns="f_nReturnCode" mode="-1" co-ep="" te="1" dc="f_bDTMFClampFlag" le="1" ig="" og="" ia="" oa="" iat="" oat="" ias="" oas="" tf="1" lf="1" conn-mode="send/receive" >
            <attributes mp="16" mt="3" ig="0" og="0" iat="-10" ias="-40" oat="-10" oas="-40" atn="3" att="2" ia="1" oa="1" te="1" le="1" tp="0" dc="f_bDTMFClampFlag" tc="1" ate="0" se="0"/>
          </modify-member>
          <results >
            <result name="Default" link="3" stubbed="1"/>
            <result name="Success" link="4" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)
{
	Server.logError("ERROR: FAIL TO MODIFY MEMBER TO CONFERENCE. CONFERENCE Id: " + Session.oMS.strConferenceId + " END POINT IS: " + Session.oMS.strEndPoint + " CONNECTION Id: " + Session.oMS.strConnectionId);
	Server.logError("ERROR: FAIL TO MODIFY MEMBER TO CONFERENCE. RETURN CODE IS: " + Session.f_nReturnCode);
	Server.logError("ERROR: FAIL TO MODIFY MEMBER TO CONFERENCE. EXIT ON BRANCH: " + Result.name);
}]]></script>
          </scripts>
        </action>
        <action id="9" plug-in="Pactolus.Branch.1" ><?xtml-editor x=207 y=1001 ?>
          <results >
            <result name="Default" link="3" stubbed="1"/>
            <result name="oMS.strCoachingMode == &quot;M&quot;" link="11" stubbed="0" >oMS.strCoachingMode == "M"</result>
            <result name="oMS.strCoachingMode == &quot;C&quot;" link="12" stubbed="0" >oMS.strCoachingMode == "C"</result>
            <result name="oMS.strCoachingMode == &quot;SR&quot;" link="13" stubbed="0" >oMS.strCoachingMode == "SR"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("**** BEFORE MODIFY CONFERENCE MEMBER FOR COACHING MODE****");
Server.logInfo("oMS.strConferenceId: " + Session.oMS.strConferenceId);
Server.logInfo("oMS.strEndPoint: " + Session.oMS.strEndPoint);
Server.logInfo("oMS.strConnectionId: " + Session.oMS.strConnectionId);
Server.logInfo("oMS.strType: " + Session.oMS.strType);
Server.logInfo("oMS.strCoachingMode: " + Session.oMS.strCoachingMode);
Server.logInfo("oMS.bCoachingFlag: " + Session.oMS.strCoachingFlag);
Server.logInfo("oMS.strCoacheeConnection: " + Session.oMS.strCoacheeConnection);
Server.logInfo("oMS.bMuteFlag: " + Session.oMS.bMuteFlag);
Server.logInfo("oMS.bDeafFlag: " + Session.oMS.bDeafFlag);
Server.logInfo("oMS.bCurrentlyInConf: " + Session.oMS.bCurrentlyInConf);
Server.logInfo("oMS.bCurrentlyConnected: " + Session.oMS.bCurrentlyConnected);
Server.logInfo("oMS.bRetry: " + Session.oMS.bRetry);
Server.logInfo("oMS.bDTMFClampFlag: " + Session.oMS.bDTMFClampFlag);
]]></script>
          </scripts>
        </action>
        <action id="11" plug-in="Pactolus.CNFModifyMember.1" ><?xtml-editor x=494 y=941 ?>
          <!--Mute Coaching Mode-->
          <modify-member xmlns="urn:www.pactolus.com:xtml:conference" ci="oMS.strConferenceId" endpoint="oMS.strEndPoint" connection-id="oMS.strConnectionId" ms-type="f_strMSType" timeout="f_nTIMEOUT" returns="f_nReturnCode" mode="2" co-ep="" te="0" dc="f_bDTMFClampFlag" le="1" ig="" og="" ia="" oa="" iat="" oat="" ias="" oas="" tf="1" lf="1" conn-mode="conference" >
            <attributes mp="16" mt="3" ig="0" og="0" iat="-10" ias="-40" oat="-10" oas="-40" atn="3" att="2" ia="1" oa="1" te="0" le="1" tp="0" dc="f_bDTMFClampFlag" tc="1" ate="0" se="0"/>
          </modify-member>
          <results >
            <result name="Default" link="3" stubbed="1"/>
            <result name="Success" link="4" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)
{
	Server.logError("ERROR: FAIL TO MODIFY MEMBER TO CONFERENCE. CONFERENCE Id: " + Session.oMS.strConferenceId + " END POINT IS: " + Session.oMS.strEndPoint + " CONNECTION Id: " + Session.oMS.strConnectionId);
	Server.logError("ERROR: FAIL TO MODIFY MEMBER TO CONFERENCE. RETURN CODE IS: " + Session.f_nReturnCode);
	Server.logError("ERROR: FAIL TO MODIFY MEMBER TO CONFERENCE. EXIT ON BRANCH: " + Result.name);
}]]></script>
          </scripts>
        </action>
        <action id="12" plug-in="Pactolus.CNFModifyMember.1" ><?xtml-editor x=496 y=1079 ?>
          <!--Coaching coaching mode-->
          <modify-member xmlns="urn:www.pactolus.com:xtml:conference" ci="oMS.strConferenceId" endpoint="oMS.strEndPoint" connection-id="oMS.strConnectionId" ms-type="f_strMSType" timeout="f_nTIMEOUT" returns="f_nReturnCode" mode="3" co-ep="oMS.strCoacheeConnection" te="1" dc="f_bDTMFClampFlag" le="1" ig="" og="" ia="" oa="" iat="" oat="" ias="" oas="" tf="" lf="" conn-mode="conference" >
            <attributes mp="16" mt="3" ig="0" og="0" iat="-10" ias="-40" oat="-10" oas="-40" atn="3" att="2" ia="1" oa="1" te="1" le="1" tp="0" dc="f_bDTMFClampFlag" tc="1" ate="0" se="0"/>
          </modify-member>
          <results >
            <result name="Default" link="3" stubbed="1"/>
            <result name="Success" link="4" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)
{
	Server.logError("ERROR: FAIL TO MODIFY MEMBER TO CONFERENCE. CONFERENCE Id: " + Session.oMS.strConferenceId + " END POINT IS: " + Session.oMS.strEndPoint + " CONNECTION Id: " + Session.oMS.strConnectionId);
	Server.logError("ERROR: FAIL TO MODIFY MEMBER TO CONFERENCE. RETURN CODE IS: " + Session.f_nReturnCode);
	Server.logError("ERROR: FAIL TO MODIFY MEMBER TO CONFERENCE. EXIT ON BRANCH: " + Result.name);
}]]></script>
          </scripts>
        </action>
        <action id="13" plug-in="Pactolus.CNFModifyMember.1" ><?xtml-editor x=499 y=1247 ?>
          <!--Send/Receive Coaching mode-->
          <modify-member xmlns="urn:www.pactolus.com:xtml:conference" ci="oMS.strConferenceId" endpoint="oMS.strEndPoint" connection-id="oMS.strConnectionId" ms-type="f_strMSType" timeout="f_nTIMEOUT" returns="f_nReturnCode" mode="1" co-ep="" te="1" dc="f_bDTMFClampFlag" le="1" ig="" og="" ia="" oa="" iat="" oat="" ias="" oas="" tf="" lf="" conn-mode="conference" >
            <attributes mp="16" mt="3" ig="0" og="0" iat="-10" ias="-40" oat="-10" oas="-40" atn="3" att="2" ia="1" oa="1" te="1" le="1" tp="0" dc="f_bDTMFClampFlag" tc="1" ate="0" se="0"/>
          </modify-member>
          <results >
            <result name="Default" link="3" stubbed="1"/>
            <result name="Success" link="4" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)
{
	Server.logError("ERROR: FAIL TO MODIFY MEMBER TO CONFERENCE. CONFERENCE Id: " + Session.oMS.strConferenceId + " END POINT IS: " + Session.oMS.strEndPoint + " CONNECTION Id: " + Session.oMS.strConnectionId);
	Server.logError("ERROR: FAIL TO MODIFY MEMBER TO CONFERENCE. RETURN CODE IS: " + Session.f_nReturnCode);
	Server.logError("ERROR: FAIL TO MODIFY MEMBER TO CONFERENCE. EXIT ON BRANCH: " + Result.name);
}]]></script>
          </scripts>
        </action>
        <action id="14" plug-in="Pactolus.MGCPModify.1" ><?xtml-editor x=857 y=95 ?>
          <mdcx xmlns="urn:www.pactolus.com:xtml:media" connection-id="oMS.strConnectionId" endpoint="oMS.strEndPoint" callid="oMS.strCallId" returns="f_nReturnCode" remote-sdp="" mode="conference" packetization-period="oMS.nPacketizationPeriod" codec="oMS.strCodec" timeout="f_nTIMEOUT" local-connection-options="" second-endpoint-id="" ms-type="oMS.strType" >
            <parameters >
              <quarantine step="0" loop="0" process="0" discard="0"/>
              <events ><![CDATA[]]></events>
              <signals ><![CDATA[]]></signals>
              <digit-map ><![CDATA[]]></digit-map>
            </parameters>
          </mdcx>
          <results >
            <result name="Default" link="3" stubbed="1"/>
            <result name="Success" link="1" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("CHANGE TO CONFERENCE MODE");
Server.logInfo("CONNECTION Id: " + Session.oMS.strConnectionId);
Server.logInfo("CALL Id: " + Session.oMS.strCallId);
Server.logInfo("END POINT: " + Session.oMS.strEndPoint);]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)
{
	Server.logError("ERROR: FAIL TO MDCX. CONNECTION Id: " + Session.oMS.strConnectionId);
	Server.logError("ERROR: FAIL TO MDCX. CALL Id: " + Session.oMS.strCallId);
	Server.logError("ERROR: FAIL TO MDCX. ENDPOINT: " + Session.oMS.strEndPoint);
	Server.logError("ERROR: FAIL TO MDCX. RETURN CODE IS: " + Session.f_nReturnCode);
	Server.logError("ERROR: FAIL TO MDCX. EXIT ON BRANCH: " + Result.name);
}]]></script>
          </scripts>
        </action>
        <action id="15" plug-in="Pactolus.MGCPModify.1" ><?xtml-editor x=454 y=290 ?>
          <mdcx xmlns="urn:www.pactolus.com:xtml:media" connection-id="oMS.strConnectionId" endpoint="oMS.strEndPoint" callid="oMS.strCallId" returns="f_nReturnCode" remote-sdp="" mode="conference" packetization-period="oMS.nPacketizationPeriod" codec="-1" timeout="f_nTIMEOUT" local-connection-options="" second-endpoint-id="" ms-type="f_strMSType" >
            <parameters >
              <quarantine step="0" loop="0" process="0" discard="0"/>
              <events ><![CDATA[]]></events>
              <signals ><![CDATA[]]></signals>
              <digit-map ><![CDATA[]]></digit-map>
            </parameters>
          </mdcx>
          <results >
            <result name="Default" link="3" stubbed="1"/>
            <result name="Success" link="4" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("MODIFY MEMBER TO CONFERENCE MODE");
Server.logInfo("CONNECTION Id: " + Session.oMS.strConnectionId);
Server.logInfo("CALL Id: " + Session.oMS.strCallId);
Server.logInfo("END POINT: " + Session.oMS.strEndPoint);
Server.logInfo("PACKETIZATION PERIOD: " + Session.oMS.nPacketizationPeriod);
Server.logInfo("MS TYPE: " + Session.f_strMSType);]]></script>
            <script language="javascript" timing="last" ><![CDATA[Server.logInfo("MODIFY MEMBER TO CONFERENCE MODE RETURNS: " + Session.f_nReturnCode);
if (Result.id != 2)
{
	Server.logError("ERROR: FAIL TO MDCX. CONNECTION Id: " + Session.oMS.strConnectionId);
	Server.logError("ERROR: FAIL TO MDCX. CALL Id: " + Session.oMS.strCallId);
	Server.logError("ERROR: FAIL TO MDCX. ENDPOINT: " + Session.oMS.strEndPoint);
	Server.logError("ERROR: FAIL TO MDCX. RETURN CODE IS: " + Session.f_nReturnCode);
	Server.logError("ERROR: FAIL TO MDCX. EXIT ON BRANCH: " + Result.name);
}]]></script>
          </scripts>
        </action>
        <action id="16" plug-in="Pactolus.MGCPModify.1" ><?xtml-editor x=502 y=426 ?>
          <mdcx xmlns="urn:www.pactolus.com:xtml:media" connection-id="oMS.strConnectionId" endpoint="oMS.strEndPoint" callid="oMS.strCallId" returns="f_nReturnCode" remote-sdp="" mode="convedia listen only" packetization-period="oMS.nPacketizationPeriod" codec="-1" timeout="f_nTIMEOUT" local-connection-options="" second-endpoint-id="" ms-type="f_strMSType" >
            <parameters >
              <quarantine step="0" loop="0" process="0" discard="0"/>
              <events ><![CDATA[]]></events>
              <signals ><![CDATA[]]></signals>
              <digit-map ><![CDATA[]]></digit-map>
            </parameters>
          </mdcx>
          <results >
            <result name="Default" link="3" stubbed="1"/>
            <result name="Success" link="4" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("MODIFY MEMBER TO MUTE MODE");
Server.logInfo("CONNECTION Id: " + Session.oMS.strConnectionId);
Server.logInfo("CALL Id: " + Session.oMS.strCallId);
Server.logInfo("END POINT: " + Session.oMS.strEndPoint);
Server.logInfo("PACKETIZATION PERIOD: " + Session.oMS.nPacketizationPeriod);
Server.logInfo("MS TYPE: " + Session.f_strMSType);]]></script>
            <script language="javascript" timing="last" ><![CDATA[Server.logInfo("MODIFY MEMBER TO MUTE MODE RETURNS: " + Session.f_nReturnCode);
if (Result.id != 2)
{
	Server.logError("ERROR: FAIL TO MDCX. CONNECTION Id: " + Session.oMS.strConnectionId);
	Server.logError("ERROR: FAIL TO MDCX. CALL Id: " + Session.oMS.strCallId);
	Server.logError("ERROR: FAIL TO MDCX. ENDPOINT: " + Session.oMS.strEndPoint);
	Server.logError("ERROR: FAIL TO MDCX. RETURN CODE IS: " + Session.f_nReturnCode);
	Server.logError("ERROR: FAIL TO MDCX. EXIT ON BRANCH: " + Result.name);
}]]></script>
          </scripts>
        </action>
        <action id="17" plug-in="Pactolus.MGCPModify.1" ><?xtml-editor x=517 y=577 ?>
          <mdcx xmlns="urn:www.pactolus.com:xtml:media" connection-id="oMS.strConnectionId" endpoint="oMS.strEndPoint" callid="oMS.strCallId" returns="f_nReturnCode" remote-sdp="" mode="send" packetization-period="oMS.nPacketizationPeriod" codec="-1" timeout="f_nTIMEOUT" local-connection-options="" second-endpoint-id="" ms-type="f_strMSType" >
            <parameters >
              <quarantine step="0" loop="0" process="0" discard="0"/>
              <events ><![CDATA[]]></events>
              <signals ><![CDATA[]]></signals>
              <digit-map ><![CDATA[]]></digit-map>
            </parameters>
          </mdcx>
          <results >
            <result name="Default" link="3" stubbed="1"/>
            <result name="Success" link="4" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("MODIFY MEMBER TO DEAF MODE");
Server.logInfo("CONNECTION Id: " + Session.oMS.strConnectionId);
Server.logInfo("CALL Id: " + Session.oMS.strCallId);
Server.logInfo("END POINT: " + Session.oMS.strEndPoint);
Server.logInfo("PACKETIZATION PERIOD: " + Session.oMS.nPacketizationPeriod);
Server.logInfo("MS TYPE: " + Session.f_strMSType);]]></script>
            <script language="javascript" timing="last" ><![CDATA[Server.logInfo("MODIFY MEMBER TO DEAF MODE RETURNS: " + Session.f_nReturnCode);
if (Result.id != 2)
{
	Server.logError("ERROR: FAIL TO MDCX. CONNECTION Id: " + Session.oMS.strConnectionId);
	Server.logError("ERROR: FAIL TO MDCX. CALL Id: " + Session.oMS.strCallId);
	Server.logError("ERROR: FAIL TO MDCX. ENDPOINT: " + Session.oMS.strEndPoint);
	Server.logError("ERROR: FAIL TO MDCX. RETURN CODE IS: " + Session.f_nReturnCode);
	Server.logError("ERROR: FAIL TO MDCX. EXIT ON BRANCH: " + Result.name);
}]]></script>
          </scripts>
        </action>
        <action id="18" plug-in="Pactolus.MGCPModify.1" ><?xtml-editor x=504 y=759 ?>
          <mdcx xmlns="urn:www.pactolus.com:xtml:media" connection-id="oMS.strConnectionId" endpoint="oMS.strEndPoint" callid="oMS.strCallId" returns="f_nReturnCode" remote-sdp="" mode="send/receive" packetization-period="oMS.nPacketizationPeriod" codec="-1" timeout="f_nTIMEOUT" local-connection-options="" second-endpoint-id="" ms-type="f_strMSType" >
            <parameters >
              <quarantine step="0" loop="0" process="0" discard="0"/>
              <events ><![CDATA[]]></events>
              <signals ><![CDATA[]]></signals>
              <digit-map ><![CDATA[]]></digit-map>
            </parameters>
          </mdcx>
          <results >
            <result name="Default" link="3" stubbed="1"/>
            <result name="Success" link="4" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("MODIFY MEMBER TO MUTE AND DEAF MODE");
Server.logInfo("CONNECTION Id: " + Session.oMS.strConnectionId);
Server.logInfo("CALL Id: " + Session.oMS.strCallId);
Server.logInfo("END POINT: " + Session.oMS.strEndPoint);
Server.logInfo("PACKETIZATION PERIOD: " + Session.oMS.nPacketizationPeriod);
Server.logInfo("MS TYPE: " + Session.f_strMSType);]]></script>
            <script language="javascript" timing="last" ><![CDATA[Server.logInfo("MODIFY MEMBER TO MUTE AND DEAF MODE RETURNS: " + Session.f_nReturnCode);
if (Result.id != 2)
{
	Server.logError("ERROR: FAIL TO MDCX. CONNECTION Id: " + Session.oMS.strConnectionId);
	Server.logError("ERROR: FAIL TO MDCX. CALL Id: " + Session.oMS.strCallId);
	Server.logError("ERROR: FAIL TO MDCX. ENDPOINT: " + Session.oMS.strEndPoint);
	Server.logError("ERROR: FAIL TO MDCX. RETURN CODE IS: " + Session.f_nReturnCode);
	Server.logError("ERROR: FAIL TO MDCX. EXIT ON BRANCH: " + Result.name);
}]]></script>
          </scripts>
        </action>
      </actions>
      <text-objects >
        <text-object x-coord="74" y-coord="50" width="524" height="169" text="Modify conference member, talk and listen, talk only, listen only, not talk or listen
INPUT:
    oMS        object type        media server info
OUTPUT:
returns:
    0    SUCCESS
    -1    FAILURE" font-name="Times New Roman" size="-16" red="0" green="0" blue="0" weight="0" underline="0" strikeout="0" point-size="12" italic="0"/>
      </text-objects>
    </function>
    <function name="RemoveMemberFromConference" start="1" event="RemoveMemberFromConference" returns="i4" >
      <parameters >
        <parameter name="oMS" type="object" pass="byref"/>
      </parameters>
      <local-vars >
        <var name="f_nReturnCode" type="i4" >0</var>
        <var name="f_nTIMEOUT" type="i4" >10</var>
        <var name="f_nSUCCESS" type="i4" >0</var>
        <var name="f_nFAILURE" type="i4" >-1</var>
        <var name="f_nMEMBER_NOT_EXISTS" type="i4" >800858</var>
        <var name="f_strMSType" type="string" ></var>
      </local-vars>
      <actions >
        <action id="1" plug-in="Pactolus.Branch.1" ><?xtml-editor x=73 y=545 ?>
          <!--in the conference?-->
          <results >
            <result name="Default" link="5" stubbed="0"/>
            <result name="inconference==true" link="6" stubbed="0" >oMS.bCurrentlyInConf == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("**** BEFORE REMOVE MEMBER FROM CONFERENCE ****");
Server.logInfo("oMS.strConferenceId: " + Session.oMS.strConferenceId);
Server.logInfo("oMS.strEndPoint: " + Session.oMS.strEndPoint);
Server.logInfo("oMS.strConnectionId: " + Session.oMS.strConnectionId);
Server.logInfo("oMS.bUseForACD: " + Session.oMS.bUseForACD);
Server.logInfo("oMS.bUseForMOH: " + Session.oMS.bUseForMOH);
Server.logInfo("oMS.strType: " + Session.oMS.strType);
Server.logInfo("oMS.strACDType: " + Session.oMS.strACDType);
Server.logInfo("oMS.strMOHType: " + Session.oMS.strMOHType);


if (Session.oMS.bUseForMOH)
{
	Session.f_strMSType = Session.oMS.strMOHType;
}
else if (Session.oMS.bUseForACD)
{
	Session.f_strMSType = Session.oMS.strACDType;
}
else
{
	Session.f_strMSType = Session.oMS.strType;
}
Server.logInfo("f_strMSType is: " + Session.f_strMSType);]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Pactolus.CNFRemoveMember.1" ><?xtml-editor x=509 y=601 ?>
          <remove-member xmlns="urn:www.pactolus.com:xtml:conference" ci="oMS.strConferenceId" endpoint="oMS.strEndPoint" connection-id="oMS.strConnectionId" ms-type="f_strMSType" timeout="f_nTIMEOUT" returns="f_nReturnCode"/>
          <results >
            <result name="Default" link="4" stubbed="1"/>
            <result name="Success" link="4" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("**** REMOVE MEMBER FROM CONFERENCE PAC ****");
Server.logInfo("oMS.strConferenceId: " + Session.oMS.strConferenceId);
Server.logInfo("oMS.strEndPoint: " + Session.oMS.strEndPoint);
Server.logInfo("oMS.strConnectionId: " + Session.oMS.strConnectionId);
Server.logInfo("oMS.strType: " + Session.oMS.strType);]]></script>
            <script language="javascript" timing="last" ><![CDATA[Server.logInfo("REMOVE MEMBER FROM CONFERENCE EXIT ON BRANCH: " + Result.name);
if (Result.id != 2)
{
	Server.logError("FAIL TO REMOVE FROM CONFERENCE, CONFERENCE MAY ALREADY GOT DELETED");
}]]></script>
          </scripts>
        </action>
        <action id="3" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=790 y=604 ?>
          <!--f_nSUCCESS-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nSUCCESS"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.oMS.bCurrentlyInConf = false;
Session.oMS.bCurrentlyConnected = false;
Session.oMS.strEndPoint = "";
Session.oMS.strConnectionId = "";]]></script>
          </scripts>
        </action>
        <action id="4" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=787 y=743 ?>
          <!--f_nSUCCESS-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nSUCCESS"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.oMS.bCurrentlyInConf = false;
Session.oMS.bCurrentlyConnected = false;
Session.oMS.strEndPoint = "";
Session.oMS.strConnectionId = "";
Server.logInfo("SUCCESS REMOVE MEMBER FROM CONFERENCE");]]></script>
          </scripts>
        </action>
        <action id="5" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=279 y=531 ?>
          <!--f_nSUCCESS-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nSUCCESS"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: NOT CURRENTLY IN CONFERENCE, NO NEED TO REMOVE FROM CONFERENCE.");]]></script>
          </scripts>
        </action>
        <action id="6" plug-in="Pactolus.Branch.1" ><?xtml-editor x=293 y=659 ?>
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="strType = PCS" link="8" stubbed="0" >f_strMSType match "PCS"</result>
          </results>
        </action>
        <action id="8" plug-in="Pactolus.MGCPDelete.1" ><?xtml-editor x=528 y=739 ?>
          <dlcx xmlns="urn:www.pactolus.com:xtml:media" connection-id="oMS.strConnectionId" endpoint="oMS.strEndPoint" callid="oMS.strCallId" timeout="f_nTIMEOUT" returns="f_nReturnCode" ms-type="f_strMSType" >
            <parameters >
              <quarantine step="0" loop="0" process="0" discard="0"/>
              <events ><![CDATA[]]></events>
              <signals ><![CDATA[]]></signals>
              <digit-map ><![CDATA[]]></digit-map>
            </parameters>
          </dlcx>
          <results >
            <result name="Default" link="3" stubbed="1"/>
            <result name="Success" link="4" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("**** DLCX PAC ****");
Server.logInfo("oMS.strConferenceId: " + Session.oMS.strConferenceId);
Server.logInfo("oMS.strEndPoint: " + Session.oMS.strEndPoint);
Server.logInfo("oMS.strConnectionId: " + Session.oMS.strConnectionId);
Server.logInfo("oMS.strType: " + Session.oMS.strType);]]></script>
            <script language="javascript" timing="last" ><![CDATA[Server.logInfo("REMOVE MEMBER FROM CONFERENCE EXIT ON BRANCH: " + Result.name);]]></script>
          </scripts>
        </action>
      </actions>
      <text-objects >
        <text-object x-coord="790" y-coord="497" width="221" height="75" text="SUCCESS instead of FAILURE and no ERROR because the conference may already get deleted" font-name="Times New Roman" size="-16" red="0" green="0" blue="0" weight="0" underline="0" strikeout="0" point-size="12" italic="0"/>
      </text-objects>
    </function>
    <function name="DeleteConference" start="6" event="DeleteConference" returns="i4" >
      <parameters >
        <parameter name="oMS" type="object" pass="byref"/>
      </parameters>
      <local-vars >
        <var name="f_nReturnCode" type="i4" >0</var>
        <var name="f_nTIMEOUT" type="i4" >40</var>
        <var name="f_nSUCCESS" type="i4" >0</var>
        <var name="f_nFAILURE" type="i4" >-1</var>
        <var name="f_nCONF_NOT_EXISTS" type="i4" >800860</var>
        <var name="f_bValidConference" type="boolean" >0</var>
        <var name="f_strMSType" type="string" ></var>
        <var name="f_bUsedACDMS" type="boolean" >0</var>
        <var name="f_bUsedMOHMS" type="boolean" >0</var>
      </local-vars>
      <actions >
        <action id="6" plug-in="Pactolus.Branch.1" ><?xtml-editor x=121 y=323 ?>
          <results >
            <result name="Default" link="4" stubbed="0"/>
            <result name="valid conference?" link="2" stubbed="0" >f_bValidConference == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("**** BEFORE DELETE CONFERENCE ****");
Server.logInfo("oMS.strConferenceId: " + Session.oMS.strConferenceId);
Server.logInfo("oMS.strType: " + Session.oMS.strType);
if (Session.oMS.strConferenceId.length > 0)
{
	Session.f_bValidConference = true;
}
else
{
	Session.f_bValidConference = false;
	Server.logInfo("WARNINGS:  NULL CONFERENCE Id, CONFERENCE WON'T BE DELETED.");
}]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Pactolus.CNFDeleteConf.1" ><?xtml-editor x=359 y=416 ?>
          <delete-conference xmlns="urn:www.pactolus.com:xtml:conference" ci="oMS.strConferenceId" ms-type="f_strMSType" timeout="f_nTIMEOUT" returns="f_nReturnCode"/>
          <results >
            <result name="Default" link="7" stubbed="0"/>
            <result name="Success" link="5" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("oMS.bUseForACD: " + Session.oMS.bUseForACD);
Server.logInfo("oMS.bUseForMOH: " + Session.oMS.bUseForMOH);
Server.logInfo("oMS.strType: " + Session.oMS.strType);
Server.logInfo("oMS.strACDType: " + Session.oMS.strACDType);
Server.logInfo("oMS.strMOHType: " + Session.oMS.strMOHType);


if (Session.oMS.bUseForMOH)
{
	Session.f_strMSType = Session.oMS.strMOHType;
	Session.f_bUsedMOHMS = true;
}
else if (Session.oMS.bUseForACD)
{
	Session.f_strMSType = Session.oMS.strACDType;
	Session.f_bUsedACDMS = true;
}
else
{
	Session.f_strMSType = Session.oMS.strType;
}
Server.logInfo("f_strMSType is: " + Session.f_strMSType);]]></script>
          </scripts>
        </action>
        <action id="4" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=341 y=290 ?>
          <!--f_nFAILURE-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nFAILURE"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("NOT DELETE CONFERENCE");]]></script>
          </scripts>
        </action>
        <action id="5" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=615 y=475 ?>
          <!--f_nSUCCESS-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nSUCCESS"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.oMS.strConferenceId = "";
Server.logInfo("SUCCESS DELETE CONFERENCE");
if (Session.f_bUsedACDMS)
{
	Session.oMS.bUseForACD = false;
	Server.logInfo("DELETE ACD CONFERENCE, RESET oMS.bUseForACD TO FALSE");
}
else if (Session.f_bUsedMOHMS)
{
	Session.oMS.bUseForMOH = false;
	Server.logInfo("DELETE MOH CONFERENCE, RESET oMS.bUseForMOH TO FALSE");
}]]></script>
          </scripts>
        </action>
        <action id="7" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=597 y=390 ?>
          <!--f_nFAILURE-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nFAILURE"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[//delete conference but it already got deleted
Server.logInfo("FAIL TO DELETE CONFERENCE");
if (Session.f_nReturnCode != Session.f_nCONF_NOT_EXISTS)
{
	Server.logError("ERROR: FAIL TO DELETE CONFERENCE. CONFERENCE Id: " + Session.oMS.strConferenceId + " RETURN CODE IS: " + Session.f_nReturnCode);
}]]></script>
          </scripts>
        </action>
      </actions>
    </function>
    <function name="PlayPromptToConference" start="1" event="PlayPromptToConference" returns="i4" >
      <parameters >
        <parameter name="oMS" type="object"/>
        <parameter name="strLanguage" type="string"/>
        <parameter name="nPromptNumber" type="i4"/>
      </parameters>
      <local-vars >
        <var name="f_nReturnCode" type="i4" >0</var>
        <var name="f_nTIMEOUT" type="i4" >1</var>
        <var name="f_nSUCCESS" type="i4" >0</var>
        <var name="f_nFAILURE" type="i4" >-1</var>
        <var name="f_strLanguage" type="string" >eng</var>
        <var name="f_bValid" type="boolean" >0</var>
        <var name="f_strMSType" type="string" ></var>
      </local-vars>
      <actions >
        <action id="1" plug-in="Pactolus.Branch.1" ><?xtml-editor x=265 y=216 ?>
          <!--promt > 0?-->
          <results >
            <result name="Default" link="3" stubbed="0"/>
            <result name="nPromptNumber &gt; 0?" link="2" stubbed="0" >nPromptNumber &gt; 0
AND f_bValid == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (Session.oMS.strConferenceId.length > 0 && (Session.oMS.strCallId.length > 0 || Session.oMS.strType == "PCS"))
{
	Session.f_bValid = true;
}
else
{
	Session.f_bValid = false;
}
Server.logInfo("**** BEFORE PLAY ONE PROMTP TO CONFERENCE ****");
Server.logInfo("oMS.strEndPoint: " + Session.oMS.strEndPoint);
Server.logInfo("oMS.strConferenceId: " + Session.oMS.strConferenceId);
Server.logInfo("oMS.strConnectionId: " + Session.oMS.strConnectionId);
Server.logInfo("oMS.strCallId: " + Session.oMS.strCallId);
Server.logInfo("oMS.strType: " + Session.oMS.strType);
Server.logInfo("strLanguage: " + Session.strLanguage);
Server.logInfo("nPromptNumber: " + Session.nPromptNumber);]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=500 y=324 ?>
          <!--play what ever prompt number passed in this sibb to the whole conference-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="&quot;*&quot;" endpoint="oMS.strConferenceId" callid="oMS.strCallId" repeat="1" timeout="f_nTIMEOUT" ms-type="f_strMSType" returns="f_nReturnCode" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="f_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >nPromptNumber</audio>
          </play>
          <results >
            <result name="Default" link="3" stubbed="0"/>
            <result name="Success" link="4" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout" link="4" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (Session.strLanguage.length > 0)
{
	Session.f_strLanguage = Session.strLanguage;
}
Server.logInfo("oMS.bUseForACD: " + Session.oMS.bUseForACD);
Server.logInfo("oMS.bUseForMOH: " + Session.oMS.bUseForMOH);
Server.logInfo("oMS.strType: " + Session.oMS.strType);
Server.logInfo("oMS.strACDType: " + Session.oMS.strACDType);
Server.logInfo("oMS.strMOHType: " + Session.oMS.strMOHType);


if (Session.oMS.bUseForMOH)
{
	Session.f_strMSType = Session.oMS.strMOHType;
}
else if (Session.oMS.bUseForACD)
{
	Session.f_strMSType = Session.oMS.strACDType;
}
else
{
	Session.f_strMSType = Session.oMS.strType;
}
Server.logInfo("f_strMSType is: " + Session.f_strMSType);]]></script>
            <script language="javascript" timing="last" ><![CDATA[if(Result.id != 2 && Result.id !=4) {
	Server.logError("lib_mediaserver.xml: Play Pac exited on: " + Result.name);
}]]></script>
          </scripts>
        </action>
        <action id="3" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=738 y=260 ?>
          <!--FAILURE-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nFAILURE"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logError("lib_mediaserver.xml: Failure playing prompt number: " + Session.nPromptNumber);
Server.logError("lib_mediaserver.xml: oMS.strEndPoint: " + Session.oMS.strEndPoint);
Server.logError("lib_mediaserver.xml: oMS.strConnectionId: " + Session.oMS.strConnectionId);
Server.logError("lib_mediaserver.xml: oMS.strCallId: " + Session.oMS.strCallId);
Server.logError("lib_mediaserver.xml: oMS.strType: " + Session.oMS.strType);
Server.logError("lib_mediaserver.xml: strLanguage: " + Session.strLanguage);]]></script>
          </scripts>
        </action>
        <action id="4" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=743 y=411 ?>
          <!--SUCCESS-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nSUCCESS"/>
        </action>
      </actions>
    </function>
    <function name="PlayErrorMsgPrompt" start="4" event="PlayErrorMsgPrompt" returns="i4" >
      <parameters >
        <parameter name="oMS" type="object"/>
        <parameter name="strLanguage" type="string"/>
        <parameter name="nErrorMsgNumber" type="i4"/>
      </parameters>
      <local-vars >
        <var name="f_nFAILURE" type="i4" >-1</var>
        <var name="f_nReturnCode" type="i4" >0</var>
        <var name="f_nSUCCESS" type="i4" >0</var>
        <var name="f_nTIMEOUT" type="i4" >30</var>
        <var name="f_nMESSAGE_NUMBER_PROMPT" type="i4" >365</var>
        <var name="f_strLanguage" type="string" >eng</var>
        <var name="f_bValid" type="boolean" >0</var>
      </local-vars>
      <actions >
        <action id="4" plug-in="Pactolus.Branch.1" ><?xtml-editor x=20 y=199 ?>
          <!--errorMsgNbr > 0?-->
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="nErrorMsgNumber &gt; 0?" link="1" stubbed="0" >nErrorMsgNumber &gt; 0</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("**** PLAY ERROR MSG PROMPT ****");
Server.logInfo("oMS.strEndPoint: " + Session.oMS.strEndPoint);
Server.logInfo("oMS.strConnectionId: " + Session.oMS.strConnectionId);
Server.logInfo("oMS.strCallId: " + Session.oMS.strCallId);
Server.logInfo("oMS.strType: " + Session.oMS.strType);
Server.logInfo("strLanguage: " + Session.strLanguage);
Server.logInfo("nErrorMsgNumber: " + Session.nErrorMsgNumber);

if (Session.oMS.strEndPoint.length > 0 && 
   (Session.oMS.strCallId.length > 0 || Session.oMS.strType == "PCS") && 
   Session.oMS.strConnectionId.length > 0)
{
	Session.f_bValid = true;
}
else
{
	Session.f_bValid = false;
}]]></script>
          </scripts>
        </action>
        <action id="1" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=401 y=316 ?>
          <!--play prompt as number passed in this sibb-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="oMS.strConnectionId" endpoint="oMS.strEndPoint" callid="oMS.strCallId" repeat="1" timeout="f_nTIMEOUT" ms-type="oMS.strType" returns="f_nReturnCode" start-play="1" interrupt="0" return-immediate="0" digit-map="" language="strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >f_nMESSAGE_NUMBER_PROMPT</audio>
            <audio type="number" >nErrorMsgNumber</audio>
          </play>
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="Success" link="3" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (Session.strLanguage.length > 0)
{
	Session.f_strLanguage = Session.strLanguage;
}]]></script>
            <script language="javascript" timing="last" ><![CDATA[if(Result.id != 2) {
	Server.logError("lib_mediaserver.xml: Play Pac exited on: " + Result.name);
}]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=705 y=255 ?>
          <!--FAILURE-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nFAILURE"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logError("lib_mediaserver.xml: Failure playing prompt number: " + Session.nErrorMsgNumber);
Server.logError("lib_mediaserver.xml: oMS.strEndPoint: " + Session.oMS.strEndPoint);
Server.logError("lib_mediaserver.xml: oMS.strConnectionId: " + Session.oMS.strConnectionId);
Server.logError("lib_mediaserver.xml: oMS.strCallId: " + Session.oMS.strCallId);
Server.logError("lib_mediaserver.xml: oMS.strType: " + Session.oMS.strType);
Server.logError("lib_mediaserver.xml: strLanguage: " + Session.strLanguage);]]></script>
          </scripts>
        </action>
        <action id="3" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=715 y=404 ?>
          <!--SUCCESS-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nSUCCESS"/>
        </action>
      </actions>
    </function>
    <function name="OutdialPartyToConference" start="15" event="OutdialPartyToConference" returns="i4" >
      <parameters >
        <parameter name="oCallLegB" type="object" pass="byref"/>
        <parameter name="oMS" type="object" pass="byref"/>
        <parameter name="lTimeStart" type="i8" pass="byref"/>
        <parameter name="lTimeAnswered" type="i8" pass="byref"/>
        <parameter name="strSIPStatus" type="string" pass="byref"/>
        <parameter name="strCallingNumber" type="string" pass="byref"/>
        <parameter name="strContact" type="string"/>
      </parameters>
      <local-vars >
        <var name="f_nSUCCESS" type="i4" >0</var>
        <var name="f_nFAILURE" type="i4" >-1</var>
        <var name="f_nBUSY" type="i4" >2</var>
        <var name="f_nRINGNOANSWER" type="i4" >1</var>
        <var name="f_nDTMFINTERRUPTED" type="i4" >3</var>
        <var name="f_nCALLEDPARTYERROR" type="i4" >-2</var>
        <var name="f_nCALLINGPARTYERROR" type="i4" >-3</var>
        <var name="f_nOTHERERROR" type="i4" >-4</var>
        <var name="f_nRESOURCEUNAVAIL" type="i4" >-5</var>
        <var name="f_nReturnCode" type="i4" >0</var>
        <var name="f_longStartTime" type="i8" >0</var>
        <var name="f_longStopTime" type="i8" >0</var>
        <var name="f_strCodec" type="string" ></var>
        <var name="f_bGotCSRCancelOutdial" type="boolean" >0</var>
        <var name="f_strMSType" type="string" ></var>
        <var name="nAGCTargetLevelIn" type="i4" >-9</var>
        <var name="nAGCMaxLevelIn" type="i4" >0</var>
        <var name="nAGCMaxLevelOut" type="i4" >0</var>
        <var name="nAGCTargetLevelOut" type="i4" >-9</var>
      </local-vars>
      <actions >
        <action id="15" plug-in="Pactolus.Branch.1" ><?xtml-editor x=57 y=818 ?>
          <!--NSM mediaserver?-->
          <results >
            <result name="Default" link="17" stubbed="0"/>
            <result name="NSM mediaserver?" link="17" stubbed="1" >f_strMSType match "NMS"</result>
            <result name="CONV mediaserver?" link="19" stubbed="0" >f_strMSType match "CONV"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("**** BEFORE OUTDIAL PARTY TO CONFERENCE ****");
Server.logInfo("oCallLeg.strFrom: " + Session.oCallLegB.strFrom);
Server.logInfo("oCallLeg.strTo: " + Session.oCallLegB.strTo);
Server.logInfo("oCallLeg.strContent: " + Session.oCallLegB.strContent);
Server.logInfo("oCallLeg.strCSeq: " + Session.oCallLegB.strCSeq);
Server.logInfo("oCallLeg.strCallId: " + Session.oCallLegB.strCallId);
Server.logInfo("oCallLeg.strRequestUri: " + Session.oCallLegB.strRequestUri);
Server.logInfo("oCallLeg.strCalledNumber: " + Session.oCallLegB.strCalledNumber);
Server.logInfo("oCallLeg.nSessionTimer: " + Session.oCallLegB.nSessionTimer);
Server.logInfo("oCallLeg.strRecordRoute: " + Session.oCallLegB.strRecordRoute);
Server.logInfo("oCallLeg.strRoute: " + Session.oCallLegB.strRoute);
Server.logInfo("oCallLeg.strContact: " + Session.oCallLegB.strContact);
Server.logInfo("strCallingNumber: " + Session.strCallingNumber);
Server.logInfo("oMS.strConferenceId: " + Session.oMS.strConferenceId);
Server.logInfo("oMS.strEndPoint: " + Session.oMS.strEndPoint);
Server.logInfo("oMS.strContent: " + Session.oMS.strContent);
Server.logInfo("oMS.strConnectionId: " + Session.oMS.strConnectionId);
Server.logInfo("oMS.strCallId: " + Session.oMS.strCallId);
Server.logInfo("oMS.bUseForACD: " + Session.oMS.bUseForACD);
Server.logInfo("oMS.bUseForMOH: " + Session.oMS.bUseForMOH);
Server.logInfo("oMS.strType: " + Session.oMS.strType);
Server.logInfo("oMS.strACDType: " + Session.oMS.strACDType);
Server.logInfo("oMS.strMOHType: " + Session.oMS.strMOHType);
Server.logInfo("oMS.nAGCTargetLevelIn: " + Session.oMS.nAGCTargetLevelIn);
Server.logInfo("oMS.nAGCMaxLevelIn: " + Session.oMS.nAGCMaxLevelIn);
Server.logInfo("oMS.nAGCTargetLevelOut: " + Session.oMS.nAGCTargetLevelOut);
Server.logInfo("oMS.nAGCMaxLevelOut: " + Session.oMS.nAGCMaxLevelOut);

Server.logInfo("oCallLeg.strRoute: " + Session.oCallLegB.strRoute);
Server.logInfo("oCallLeg.strRecordRoute: " + Session.oCallLegB.strRecordRoute);
Server.logInfo("oMS.strCodec is: " + Session.oMS.strCodec);
if (0 == Session.oMS.strCodec.length ||  undefined == Session.oMS.strCodec)
{
	Session.f_strCodec = "PCMU";
}
else
{
	Session.f_strCodec = Session.oMS.strCodec;	
}
Server.logInfo("f_strCodec is: " + Session.f_strCodec);

if (Session.oMS.bUseForMOH)
{
	Session.f_strMSType = Session.oMS.strMOHType;
}
else if (Session.oMS.bUseForACD)
{
	Session.f_strMSType = Session.oMS.strACDType;
}
else
{
	Session.f_strMSType = Session.oMS.strType;
}
Server.logInfo("f_strMSType is: " + Session.f_strMSType);
if (undefined == Session.oMS.nAGCTargetLevelIn)
{
	Session.nAGCTargetLevelIn = -9;
	Server.logInfo("use default AGC Target level in");
}
else
{
	Session.nAGCTargetLevelIn = Session.oMS.nAGCTargetLevelIn;	
}
Server.logInfo("nAGCTargetLevel in is: " + Session.nAGCTargetLevelIn);
if (undefined == Session.oMS.nAGCMaxLevelIn)
{
	Session.nAGCMaxLevelIn = 0;
	Server.logInfo("use default AGC Max level in");
}
else
{
	Session.nAGCMaxLevelIn = Session.oMS.nAGCMaxLevelIn;
}
Server.logInfo("nAGCMaxLevel in is: " + Session.nAGCMaxLevelIn);
if (undefined == Session.oMS.nAGCTargetLevelOut)
{
	Session.nAGCTargetLevelOut = -9;
	Server.logInfo("use default AGC Target level out");
}
else
{
	Session.nAGCTargetLevelOut = Session.oMS.nAGCTargetLevelOut;	
}
Server.logInfo("nAGCTargetLevel out is: " + Session.nAGCTargetLevelOut);
if (undefined == Session.oMS.nAGCMaxLevelOut)
{
	Session.nAGCMaxLevelOut = 0;
	Server.logInfo("use default AGC Max level out");
}
else
{
	Session.nAGCMaxLevelOut = Session.oMS.nAGCMaxLevelOut;
}
Server.logInfo("nAGCMaxLevel out is: " + Session.nAGCMaxLevelOut);]]></script>
          </scripts>
        </action>
        <action id="3" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1139 y=734 ?>
          <!--f_nFAILURE-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nFAILURE"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logError("ERROR: FAIL TO OUTDIAL PARTY TO CONFERENCE. CONFERENCE Id: " + Session.oMS.strConferenceId + " RETURN CODE IS: " + Session.f_nReturnCode);
Server.logInfo("**** AFTER OUTDIAL PARTY TO CONFERENCE ****");
Server.logInfo("oCallLeg.strFrom: " + Session.oCallLegB.strFrom);
Server.logInfo("oCallLeg.strTo: " + Session.oCallLegB.strTo);
Server.logInfo("oCallLeg.strContent: " + Session.oCallLegB.strContent);
Server.logInfo("oCallLeg.strCSeq: " + Session.oCallLegB.strCSeq);
Server.logInfo("oCallLeg.strCallId: " + Session.oCallLegB.strCallId);
Server.logInfo("oCallLeg.strRequestUri: " + Session.oCallLegB.strRequestUri);
Server.logInfo("oCallLeg.strCalledNumber: " + Session.oCallLegB.strCalledNumber);
Server.logInfo("oCallLeg.nSessionTimer: " + Session.oCallLegB.nSessionTimer);
Server.logInfo("oCallLeg.strRecordRoute: " + Session.oCallLegB.strRecordRoute);
Server.logInfo("oCallLeg.strRoute: " + Session.oCallLegB.strRoute);
Server.logInfo("oCallLeg.strContact: " + Session.oCallLegB.strContact);
Server.logInfo("strCallingNumber: " + Session.strCallingNumber);
Server.logInfo("oMS.strConferenceId: " + Session.oMS.strConferenceId);
Server.logInfo("oMS.strEndPoint: " + Session.oMS.strEndPoint);
Server.logInfo("oMS.strContent: " + Session.oMS.strContent);
Server.logInfo("oMS.strConnectionId: " + Session.oMS.strConnectionId);
Server.logInfo("oMS.strCallId: " + Session.oMS.strCallId);
Server.logInfo("oMS.strType: " + Session.oMS.strType);
Server.logInfo("oMS.bMuteFlag: " + Session.oMS.bMuteFlag);
Server.logInfo("oMS.bDeafFlag: " + Session.oMS.bDeafFlag);
Server.logInfo("oMS.bCurrentlyInConf: " + Session.oMS.bCurrentlyInConf);
Server.logInfo("oMS.bCurrentlyConnected: " + Session.oMS.bCurrentlyConnected);
Server.logInfo("oMS.bRetry: " + Session.oMS.bRetry);]]></script>
          </scripts>
        </action>
        <action id="4" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1172 y=810 ?>
          <!--f_nSUCCESS-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nSUCCESS"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.lTimeAnswered = Server.getUTCTime();
Session.oMS.bCurrentlyInConf = true;
Session.oCallLegB.nSetUpTime = Session.f_longStopTime - Session.f_longStartTime;
Server.logInfo("SUCCESS ADD MEMBER OUTDIAL PARTY TO CONFERENCE");
Server.logInfo("**** AFTER OUTDIAL PARTY TO CONFERENCE ****");
Server.logInfo("oCallLeg.strFrom: " + Session.oCallLegB.strFrom);
Server.logInfo("oCallLeg.strTo: " + Session.oCallLegB.strTo);
Server.logInfo("oCallLeg.strContent: " + Session.oCallLegB.strContent);
Server.logInfo("oCallLeg.strCSeq: " + Session.oCallLegB.strCSeq);
Server.logInfo("oCallLeg.strCallId: " + Session.oCallLegB.strCallId);
Server.logInfo("oCallLeg.strRequestUri: " + Session.oCallLegB.strRequestUri);
Server.logInfo("oCallLeg.strCalledNumber: " + Session.oCallLegB.strCalledNumber);
Server.logInfo("oCallLeg.nSessionTimer: " + Session.oCallLegB.nSessionTimer);
Server.logInfo("oCallLeg.strRecordRoute: " + Session.oCallLegB.strRecordRoute);
Server.logInfo("oCallLeg.strRoute: " + Session.oCallLegB.strRoute);
Server.logInfo("oCallLeg.strContact: " + Session.oCallLegB.strContact);
Server.logInfo("strCallingNumber: " + Session.strCallingNumber);
Server.logInfo("oMS.strConferenceId: " + Session.oMS.strConferenceId);
Server.logInfo("oMS.strEndPoint: " + Session.oMS.strEndPoint);
Server.logInfo("oMS.strContent: " + Session.oMS.strContent);
Server.logInfo("oMS.strConnectionId: " + Session.oMS.strConnectionId);
Server.logInfo("oMS.strCallId: " + Session.oMS.strCallId);
Server.logInfo("oMS.strType: " + Session.oMS.strType);
Server.logInfo("oMS.bMuteFlag: " + Session.oMS.bMuteFlag);
Server.logInfo("oMS.bDeafFlag: " + Session.oMS.bDeafFlag);
Server.logInfo("oMS.bCurrentlyInConf: " + Session.oMS.bCurrentlyInConf);
Server.logInfo("oMS.bCurrentlyConnected: " + Session.oMS.bCurrentlyConnected);
Server.logInfo("oMS.bRetry: " + Session.oMS.bRetry);]]></script>
          </scripts>
        </action>
        <action id="5" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1207 y=882 ?>
          <!--f_nRINGNOANSWER-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nRINGNOANSWER"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("NO ANSWER ADD MEMBER OUTDIAL PARTY TO CONFERENCE");
Server.logInfo("**** AFTER OUTDIAL PARTY TO CONFERENCE ****");
Server.logInfo("oCallLeg.strFrom: " + Session.oCallLegB.strFrom);
Server.logInfo("oCallLeg.strTo: " + Session.oCallLegB.strTo);
Server.logInfo("oCallLeg.strContent: " + Session.oCallLegB.strContent);
Server.logInfo("oCallLeg.strCSeq: " + Session.oCallLegB.strCSeq);
Server.logInfo("oCallLeg.strCallId: " + Session.oCallLegB.strCallId);
Server.logInfo("oCallLeg.strRequestUri: " + Session.oCallLegB.strRequestUri);
Server.logInfo("oCallLeg.strCalledNumber: " + Session.oCallLegB.strCalledNumber);
Server.logInfo("oCallLeg.nSessionTimer: " + Session.oCallLegB.nSessionTimer);
Server.logInfo("oCallLeg.strRecordRoute: " + Session.oCallLegB.strRecordRoute);
Server.logInfo("oCallLeg.strRoute: " + Session.oCallLegB.strRoute);
Server.logInfo("oCallLeg.strContact: " + Session.oCallLegB.strContact);
Server.logInfo("strCallingNumber: " + Session.strCallingNumber);
Server.logInfo("oMS.strConferenceId: " + Session.oMS.strConferenceId);
Server.logInfo("oMS.strEndPoint: " + Session.oMS.strEndPoint);
Server.logInfo("oMS.strContent: " + Session.oMS.strContent);
Server.logInfo("oMS.strConnectionId: " + Session.oMS.strConnectionId);
Server.logInfo("oMS.strCallId: " + Session.oMS.strCallId);
Server.logInfo("oMS.strType: " + Session.oMS.strType);
Server.logInfo("oMS.bMuteFlag: " + Session.oMS.bMuteFlag);
Server.logInfo("oMS.bDeafFlag: " + Session.oMS.bDeafFlag);
Server.logInfo("oMS.bCurrentlyInConf: " + Session.oMS.bCurrentlyInConf);
Server.logInfo("oMS.bCurrentlyConnected: " + Session.oMS.bCurrentlyConnected);
Server.logInfo("oMS.bRetry: " + Session.oMS.bRetry);]]></script>
          </scripts>
        </action>
        <action id="6" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1248 y=950 ?>
          <!--f_nBUSY-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nBUSY"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("BUSY ADD MEMBER OUTDIAL PARTY TO CONFERENCE");
Server.logInfo("**** AFTER OUTDIAL PARTY TO CONFERENCE ****");
Server.logInfo("oCallLeg.strFrom: " + Session.oCallLegB.strFrom);
Server.logInfo("oCallLeg.strTo: " + Session.oCallLegB.strTo);
Server.logInfo("oCallLeg.strContent: " + Session.oCallLegB.strContent);
Server.logInfo("oCallLeg.strCSeq: " + Session.oCallLegB.strCSeq);
Server.logInfo("oCallLeg.strCallId: " + Session.oCallLegB.strCallId);
Server.logInfo("oCallLeg.strRequestUri: " + Session.oCallLegB.strRequestUri);
Server.logInfo("oCallLeg.strCalledNumber: " + Session.oCallLegB.strCalledNumber);
Server.logInfo("oCallLeg.nSessionTimer: " + Session.oCallLegB.nSessionTimer);
Server.logInfo("oCallLeg.strRecordRoute: " + Session.oCallLegB.strRecordRoute);
Server.logInfo("oCallLeg.strRoute: " + Session.oCallLegB.strRoute);
Server.logInfo("oCallLeg.strContact: " + Session.oCallLegB.strContact);
Server.logInfo("strCallingNumber: " + Session.strCallingNumber);
Server.logInfo("oMS.strConferenceId: " + Session.oMS.strConferenceId);
Server.logInfo("oMS.strEndPoint: " + Session.oMS.strEndPoint);
Server.logInfo("oMS.strContent: " + Session.oMS.strContent);
Server.logInfo("oMS.strConnectionId: " + Session.oMS.strConnectionId);
Server.logInfo("oMS.strCallId: " + Session.oMS.strCallId);
Server.logInfo("oMS.strType: " + Session.oMS.strType);
Server.logInfo("oMS.bMuteFlag: " + Session.oMS.bMuteFlag);
Server.logInfo("oMS.bDeafFlag: " + Session.oMS.bDeafFlag);
Server.logInfo("oMS.bCurrentlyInConf: " + Session.oMS.bCurrentlyInConf);
Server.logInfo("oMS.bCurrentlyConnected: " + Session.oMS.bCurrentlyConnected);
Server.logInfo("oMS.bRetry: " + Session.oMS.bRetry);]]></script>
          </scripts>
        </action>
        <action id="7" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1318 y=1023 ?>
          <!--f_nDTMFINTERRUPTED-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nDTMFINTERRUPTED"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("DTFM INTERRUPTED ADD MEMBER OUTDIAL PARTY TO CONFERENCE");
Server.logInfo("**** AFTER OUTDIAL PARTY TO CONFERENCE ****");
Server.logInfo("oCallLeg.strFrom: " + Session.oCallLegB.strFrom);
Server.logInfo("oCallLeg.strTo: " + Session.oCallLegB.strTo);
Server.logInfo("oCallLeg.strContent: " + Session.oCallLegB.strContent);
Server.logInfo("oCallLeg.strCSeq: " + Session.oCallLegB.strCSeq);
Server.logInfo("oCallLeg.strCallId: " + Session.oCallLegB.strCallId);
Server.logInfo("oCallLeg.strRequestUri: " + Session.oCallLegB.strRequestUri);
Server.logInfo("oCallLeg.strCalledNumber: " + Session.oCallLegB.strCalledNumber);
Server.logInfo("oCallLeg.nSessionTimer: " + Session.oCallLegB.nSessionTimer);
Server.logInfo("oCallLeg.strRecordRoute: " + Session.oCallLegB.strRecordRoute);
Server.logInfo("oCallLeg.strRoute: " + Session.oCallLegB.strRoute);
Server.logInfo("oCallLeg.strContact: " + Session.oCallLegB.strContact);
Server.logInfo("strCallingNumber: " + Session.strCallingNumber);
Server.logInfo("oMS.strConferenceId: " + Session.oMS.strConferenceId);
Server.logInfo("oMS.strEndPoint: " + Session.oMS.strEndPoint);
Server.logInfo("oMS.strContent: " + Session.oMS.strContent);
Server.logInfo("oMS.strConnectionId: " + Session.oMS.strConnectionId);
Server.logInfo("oMS.strCallId: " + Session.oMS.strCallId);
Server.logInfo("oMS.strType: " + Session.oMS.strType);
Server.logInfo("oMS.bMuteFlag: " + Session.oMS.bMuteFlag);
Server.logInfo("oMS.bDeafFlag: " + Session.oMS.bDeafFlag);
Server.logInfo("oMS.bCurrentlyInConf: " + Session.oMS.bCurrentlyInConf);
Server.logInfo("oMS.bCurrentlyConnected: " + Session.oMS.bCurrentlyConnected);
Server.logInfo("oMS.bRetry: " + Session.oMS.bRetry);]]></script>
          </scripts>
        </action>
        <action id="8" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1325 y=1109 ?>
          <!--f_nCALLEDPARTYERROR-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nCALLEDPARTYERROR"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("CALLED PARTY ERROR ADD MEMBER OUTDIAL PARTY TO CONFERENCE");
Server.logInfo("**** AFTER OUTDIAL PARTY TO CONFERENCE ****");
Server.logInfo("oCallLeg.strFrom: " + Session.oCallLegB.strFrom);
Server.logInfo("oCallLeg.strTo: " + Session.oCallLegB.strTo);
Server.logInfo("oCallLeg.strContent: " + Session.oCallLegB.strContent);
Server.logInfo("oCallLeg.strCSeq: " + Session.oCallLegB.strCSeq);
Server.logInfo("oCallLeg.strCallId: " + Session.oCallLegB.strCallId);
Server.logInfo("oCallLeg.strRequestUri: " + Session.oCallLegB.strRequestUri);
Server.logInfo("oCallLeg.strCalledNumber: " + Session.oCallLegB.strCalledNumber);
Server.logInfo("oCallLeg.nSessionTimer: " + Session.oCallLegB.nSessionTimer);
Server.logInfo("oCallLeg.strRecordRoute: " + Session.oCallLegB.strRecordRoute);
Server.logInfo("oCallLeg.strRoute: " + Session.oCallLegB.strRoute);
Server.logInfo("oCallLeg.strContact: " + Session.oCallLegB.strContact);
Server.logInfo("strCallingNumber: " + Session.strCallingNumber);
Server.logInfo("oMS.strConferenceId: " + Session.oMS.strConferenceId);
Server.logInfo("oMS.strEndPoint: " + Session.oMS.strEndPoint);
Server.logInfo("oMS.strContent: " + Session.oMS.strContent);
Server.logInfo("oMS.strConnectionId: " + Session.oMS.strConnectionId);
Server.logInfo("oMS.strCallId: " + Session.oMS.strCallId);
Server.logInfo("oMS.strType: " + Session.oMS.strType);
Server.logInfo("oMS.bMuteFlag: " + Session.oMS.bMuteFlag);
Server.logInfo("oMS.bDeafFlag: " + Session.oMS.bDeafFlag);
Server.logInfo("oMS.bCurrentlyInConf: " + Session.oMS.bCurrentlyInConf);
Server.logInfo("oMS.bCurrentlyConnected: " + Session.oMS.bCurrentlyConnected);
Server.logInfo("oMS.bRetry: " + Session.oMS.bRetry);]]></script>
          </scripts>
        </action>
        <action id="9" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1313 y=1178 ?>
          <!--f_nCALLINGPARTYERROR-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nCALLINGPARTYERROR"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("CALLING PARTY ERROR ADD MEMBER OUTDIAL PARTY TO CONFERENCE");
Server.logInfo("**** AFTER OUTDIAL PARTY TO CONFERENCE ****");
Server.logInfo("oCallLeg.strFrom: " + Session.oCallLegB.strFrom);
Server.logInfo("oCallLeg.strTo: " + Session.oCallLegB.strTo);
Server.logInfo("oCallLeg.strContent: " + Session.oCallLegB.strContent);
Server.logInfo("oCallLeg.strCSeq: " + Session.oCallLegB.strCSeq);
Server.logInfo("oCallLeg.strCallId: " + Session.oCallLegB.strCallId);
Server.logInfo("oCallLeg.strRequestUri: " + Session.oCallLegB.strRequestUri);
Server.logInfo("oCallLeg.strCalledNumber: " + Session.oCallLegB.strCalledNumber);
Server.logInfo("oCallLeg.nSessionTimer: " + Session.oCallLegB.nSessionTimer);
Server.logInfo("oCallLeg.strRecordRoute: " + Session.oCallLegB.strRecordRoute);
Server.logInfo("oCallLeg.strRoute: " + Session.oCallLegB.strRoute);
Server.logInfo("oCallLeg.strContact: " + Session.oCallLegB.strContact);
Server.logInfo("strCallingNumber: " + Session.strCallingNumber);
Server.logInfo("oMS.strConferenceId: " + Session.oMS.strConferenceId);
Server.logInfo("oMS.strEndPoint: " + Session.oMS.strEndPoint);
Server.logInfo("oMS.strContent: " + Session.oMS.strContent);
Server.logInfo("oMS.strConnectionId: " + Session.oMS.strConnectionId);
Server.logInfo("oMS.strCallId: " + Session.oMS.strCallId);
Server.logInfo("oMS.strType: " + Session.oMS.strType);
Server.logInfo("oMS.bMuteFlag: " + Session.oMS.bMuteFlag);
Server.logInfo("oMS.bDeafFlag: " + Session.oMS.bDeafFlag);
Server.logInfo("oMS.bCurrentlyInConf: " + Session.oMS.bCurrentlyInConf);
Server.logInfo("oMS.bCurrentlyConnected: " + Session.oMS.bCurrentlyConnected);
Server.logInfo("oMS.bRetry: " + Session.oMS.bRetry);]]></script>
          </scripts>
        </action>
        <action id="10" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1300 y=1249 ?>
          <!--f_nOTHERERROR-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nOTHERERROR"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("OTHER ERROR ADD MEMBER OUTDIAL PARTY TO CONFERENCE");
Server.logInfo("**** AFTER OUTDIAL PARTY TO CONFERENCE ****");
Server.logInfo("oCallLeg.strFrom: " + Session.oCallLegB.strFrom);
Server.logInfo("oCallLeg.strTo: " + Session.oCallLegB.strTo);
Server.logInfo("oCallLeg.strContent: " + Session.oCallLegB.strContent);
Server.logInfo("oCallLeg.strCSeq: " + Session.oCallLegB.strCSeq);
Server.logInfo("oCallLeg.strCallId: " + Session.oCallLegB.strCallId);
Server.logInfo("oCallLeg.strRequestUri: " + Session.oCallLegB.strRequestUri);
Server.logInfo("oCallLeg.strCalledNumber: " + Session.oCallLegB.strCalledNumber);
Server.logInfo("oCallLeg.nSessionTimer: " + Session.oCallLegB.nSessionTimer);
Server.logInfo("oCallLeg.strRecordRoute: " + Session.oCallLegB.strRecordRoute);
Server.logInfo("oCallLeg.strRoute: " + Session.oCallLegB.strRoute);
Server.logInfo("oCallLeg.strContact: " + Session.oCallLegB.strContact);
Server.logInfo("strCallingNumber: " + Session.strCallingNumber);
Server.logInfo("oMS.strConferenceId: " + Session.oMS.strConferenceId);
Server.logInfo("oMS.strEndPoint: " + Session.oMS.strEndPoint);
Server.logInfo("oMS.strContent: " + Session.oMS.strContent);
Server.logInfo("oMS.strConnectionId: " + Session.oMS.strConnectionId);
Server.logInfo("oMS.strCallId: " + Session.oMS.strCallId);
Server.logInfo("oMS.strType: " + Session.oMS.strType);
Server.logInfo("oMS.bMuteFlag: " + Session.oMS.bMuteFlag);
Server.logInfo("oMS.bDeafFlag: " + Session.oMS.bDeafFlag);
Server.logInfo("oMS.bCurrentlyInConf: " + Session.oMS.bCurrentlyInConf);
Server.logInfo("oMS.bCurrentlyConnected: " + Session.oMS.bCurrentlyConnected);
Server.logInfo("oMS.bRetry: " + Session.oMS.bRetry);]]></script>
          </scripts>
        </action>
        <action id="11" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1278 y=1321 ?>
          <!--f_nRESOURCEUNAVAIL-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nRESOURCEUNAVAIL"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("RESOURCE UNAVAILABLE ADD MEMBER OUTDIAL PARTY TO CONFERENCE");
Server.logInfo("**** AFTER OUTDIAL PARTY TO CONFERENCE ****");
Server.logInfo("oCallLeg.strFrom: " + Session.oCallLegB.strFrom);
Server.logInfo("oCallLeg.strTo: " + Session.oCallLegB.strTo);
Server.logInfo("oCallLeg.strContent: " + Session.oCallLegB.strContent);
Server.logInfo("oCallLeg.strCSeq: " + Session.oCallLegB.strCSeq);
Server.logInfo("oCallLeg.strCallId: " + Session.oCallLegB.strCallId);
Server.logInfo("oCallLeg.strRequestUri: " + Session.oCallLegB.strRequestUri);
Server.logInfo("oCallLeg.strCalledNumber: " + Session.oCallLegB.strCalledNumber);
Server.logInfo("oCallLeg.nSessionTimer: " + Session.oCallLegB.nSessionTimer);
Server.logInfo("oCallLeg.strRecordRoute: " + Session.oCallLegB.strRecordRoute);
Server.logInfo("oCallLeg.strRoute: " + Session.oCallLegB.strRoute);
Server.logInfo("oCallLeg.strContact: " + Session.oCallLegB.strContact);
Server.logInfo("strCallingNumber: " + Session.strCallingNumber);
Server.logInfo("oMS.strConferenceId: " + Session.oMS.strConferenceId);
Server.logInfo("oMS.strEndPoint: " + Session.oMS.strEndPoint);
Server.logInfo("oMS.strContent: " + Session.oMS.strContent);
Server.logInfo("oMS.strConnectionId: " + Session.oMS.strConnectionId);
Server.logInfo("oMS.strCallId: " + Session.oMS.strCallId);
Server.logInfo("oMS.strType: " + Session.oMS.strType);
Server.logInfo("oMS.bMuteFlag: " + Session.oMS.bMuteFlag);
Server.logInfo("oMS.bDeafFlag: " + Session.oMS.bDeafFlag);
Server.logInfo("oMS.bCurrentlyInConf: " + Session.oMS.bCurrentlyInConf);
Server.logInfo("oMS.bCurrentlyConnected: " + Session.oMS.bCurrentlyConnected);
Server.logInfo("oMS.bRetry: " + Session.oMS.bRetry);]]></script>
          </scripts>
        </action>
        <action id="14" plug-in="Pactolus.CNFAddMemberOutdial.1" ><?xtml-editor x=881 y=973 ?>
          <!--No session timer-->
          <add-member-outdial xmlns="urn:www.pactolus.com:xtml:conference" calling-number="strCallingNumber" called-number="oCallLegB.strCalledNumber" preferred-carrier="" codec="f_strCodec" reliable-provisional-responses="1" timeout="oCallLegB.nRingNoAnswerTime" returns="f_nReturnCode" ms-type="f_strMSType" ci="oMS.strConferenceId" calling-packetization="oMS.nPacketizationPeriod" connection-id="oMS.strConnectionId" callingparty-contact="strContact" mgcp-call-id="oMS.strCallId" ms-sdp="oMS.strContent" endpoint="oMS.strEndPoint" calling-capability="2" telephone-events="0" rtp-request-a="0" rtp-endpoint-a="" egress-gateway="oCallLegB.strRequestUri" sdp="oCallLegB.strContent" call-id="oCallLegB.strCallId" cseq="oCallLegB.strCSeq" sip-status="strSIPStatus" to="oCallLegB.strTo" from="oCallLegB.strFrom" session-timer="0" session-timer-value="oCallLegB.nSessionTimer" backup-ss="oCallLegB.strBackupRequestUri" route="oCallLegB.strRoute" record-route="oCallLegB.strRecordRoute" contact="oCallLegB.strContact" rtp-request-b="0" rtp-endpoint-b="" refresher="" play-ringback="0" language="" ringback-prompt="" capability="1" ringback-codec="-1" packetization-period="" te="" dc="0" le="" ig="" og="" ia="1" oa="1" iat="nAGCTargetLevelIn" oat="nAGCTargetLevelOut" ias="nAGCMaxLevelIn" oas="nAGCMaxLevelOut"/>
          <results >
            <result name="Default" link="3" stubbed="0"/>
            <result name="Success" link="4" stubbed="0"/>
            <result name="Ring no answer" link="5" stubbed="0"/>
            <result name="Busy" link="6" stubbed="0"/>
            <result name="Caller DTMF interrupt" link="7" stubbed="0"/>
            <result name="Called party error" link="8" stubbed="0"/>
            <result name="Calling party error" link="9" stubbed="0"/>
            <result name="Other error" link="10" stubbed="0"/>
            <result name="Resource unavailable" link="11" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.lTimeStart = Server.getUTCTime();
Session.oCallLegB.bCurrentlyDialing = true;
Session.oCallLegB.bAttemptedToOutdial = true;
var curTime = new Date();
Session.f_longStartTime = curTime.getTime();]]></script>
            <script language="javascript" timing="last" ><![CDATA[Session.oCallLegB.bCurrentlyDialing = false;
var curTime = new Date();
Session.f_longStopTime = curTime.getTime();
Server.logInfo("RETURN CODE: " + Session.f_nReturnCode);
Server.logInfo("SIP STATUS: " + Session.strSIPStatus);]]></script>
          </scripts>
        </action>
        <action id="16" plug-in="Pactolus.CNFAddMemberOutdial.1" ><?xtml-editor x=866 y=706 ?>
          <!--session timer-->
          <add-member-outdial xmlns="urn:www.pactolus.com:xtml:conference" calling-number="strCallingNumber" called-number="oCallLegB.strCalledNumber" preferred-carrier="" codec="f_strCodec" reliable-provisional-responses="1" timeout="oCallLegB.nRingNoAnswerTime" returns="f_nReturnCode" ms-type="f_strMSType" ci="oMS.strConferenceId" calling-packetization="oMS.nPacketizationPeriod" connection-id="oMS.strConnectionId" callingparty-contact="strContact" mgcp-call-id="oMS.strCallId" ms-sdp="oMS.strContent" endpoint="oMS.strEndPoint" calling-capability="0" telephone-events="0" rtp-request-a="0" rtp-endpoint-a="" egress-gateway="oCallLegB.strRequestUri" sdp="oCallLegB.strContent" call-id="oCallLegB.strCallId" cseq="oCallLegB.strCSeq" sip-status="strSIPStatus" to="oCallLegB.strTo" from="oCallLegB.strFrom" session-timer="1" session-timer-value="oCallLegB.nSessionTimer" backup-ss="oCallLegB.strBackupRequestUri" route="oCallLegB.strRoute" record-route="oCallLegB.strRecordRoute" contact="oCallLegB.strContact" rtp-request-b="0" rtp-endpoint-b="" refresher="" play-ringback="0" language="" ringback-prompt="" capability="1" ringback-codec="-1" packetization-period="" te="" dc="0" le="" ig="" og="" ia="" oa="" iat="" oat="" ias="" oas=""/>
          <results >
            <result name="Default" link="3" stubbed="1"/>
            <result name="Success" link="4" stubbed="1"/>
            <result name="Ring no answer" link="5" stubbed="1"/>
            <result name="Busy" link="6" stubbed="1"/>
            <result name="Caller DTMF interrupt" link="7" stubbed="1"/>
            <result name="Called party error" link="8" stubbed="1"/>
            <result name="Calling party error" link="9" stubbed="1"/>
            <result name="Other error" link="10" stubbed="1"/>
            <result name="Resource unavailable" link="11" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.lTimeStart = Server.getUTCTime();
Session.oCallLegB.bCurrentlyDialing = true;
Session.oCallLegB.bAttemptedToOutdial = true;
var curTime = new Date();
Session.f_longStartTime = curTime.getTime();]]></script>
            <script language="javascript" timing="last" ><![CDATA[Session.oCallLegB.bCurrentlyDialing = false;
var curTime = new Date();
Session.f_longStopTime = curTime.getTime();
Server.logInfo("RETURN CODE: " + Session.f_nReturnCode);
Server.logInfo("SIP STATUS: " + Session.strSIPStatus);]]></script>
          </scripts>
        </action>
        <action id="17" plug-in="Pactolus.Branch.1" ><?xtml-editor x=342 y=601 ?>
          <!--session timer enable?-->
          <results >
            <result name="Default" link="21" stubbed="0"/>
            <result name="oCallLegB.strSessionTimerFlag == &quot;T&quot;" link="22" stubbed="0" >oCallLegB.strSessionTimerFlag == "T"</result>
          </results>
        </action>
        <action id="18" plug-in="Pactolus.CNFAddMemberOutdial.1" ><?xtml-editor x=852 y=432 ?>
          <!--No session timer-->
          <add-member-outdial xmlns="urn:www.pactolus.com:xtml:conference" calling-number="strCallingNumber" called-number="oCallLegB.strCalledNumber" preferred-carrier="" codec="f_strCodec" reliable-provisional-responses="1" timeout="oCallLegB.nRingNoAnswerTime" returns="f_nReturnCode" ms-type="f_strMSType" ci="oMS.strConferenceId" calling-packetization="oMS.nPacketizationPeriod" connection-id="oMS.strConnectionId" callingparty-contact="strContact" mgcp-call-id="oMS.strCallId" ms-sdp="oMS.strContent" endpoint="oMS.strEndPoint" calling-capability="0" telephone-events="0" rtp-request-a="0" rtp-endpoint-a="" egress-gateway="oCallLegB.strRequestUri" sdp="oCallLegB.strContent" call-id="oCallLegB.strCallId" cseq="oCallLegB.strCSeq" sip-status="strSIPStatus" to="oCallLegB.strTo" from="oCallLegB.strFrom" session-timer="0" session-timer-value="oCallLegB.nSessionTimer" backup-ss="oCallLegB.strBackupRequestUri" route="oCallLegB.strRoute" record-route="oCallLegB.strRecordRoute" contact="oCallLegB.strContact" rtp-request-b="0" rtp-endpoint-b="" refresher="" play-ringback="0" language="" ringback-prompt="" capability="1" ringback-codec="-1" packetization-period="" te="" dc="0" le="" ig="" og="" ia="" oa="" iat="" oat="" ias="" oas=""/>
          <results >
            <result name="Default" link="3" stubbed="1"/>
            <result name="Success" link="4" stubbed="1"/>
            <result name="Ring no answer" link="5" stubbed="1"/>
            <result name="Busy" link="6" stubbed="1"/>
            <result name="Caller DTMF interrupt" link="7" stubbed="1"/>
            <result name="Called party error" link="8" stubbed="1"/>
            <result name="Calling party error" link="9" stubbed="1"/>
            <result name="Other error" link="10" stubbed="1"/>
            <result name="Resource unavailable" link="11" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.lTimeStart = Server.getUTCTime();
Session.oCallLegB.bCurrentlyDialing = true;
Session.oCallLegB.bAttemptedToOutdial = true;
var curTime = new Date();
Session.f_longStartTime = curTime.getTime();]]></script>
            <script language="javascript" timing="last" ><![CDATA[Session.oCallLegB.bCurrentlyDialing = false;
var curTime = new Date();
Session.f_longStopTime = curTime.getTime();
Server.logInfo("RETURN CODE: " + Session.f_nReturnCode);
Server.logInfo("SIP STATUS: " + Session.strSIPStatus);]]></script>
          </scripts>
        </action>
        <action id="19" plug-in="Pactolus.Branch.1" ><?xtml-editor x=368 y=1016 ?>
          <!--session timer enable?-->
          <results >
            <result name="Default" link="23" stubbed="0"/>
            <result name="oCallLegB.strSessionTimerFlag == &quot;T&quot;" link="24" stubbed="0" >oCallLegB.strSessionTimerFlag == "T"</result>
          </results>
        </action>
        <action id="20" plug-in="Pactolus.CNFAddMemberOutdial.1" ><?xtml-editor x=895 y=1227 ?>
          <!--session timer-->
          <add-member-outdial xmlns="urn:www.pactolus.com:xtml:conference" calling-number="strCallingNumber" called-number="oCallLegB.strCalledNumber" preferred-carrier="" codec="f_strCodec" reliable-provisional-responses="1" timeout="oCallLegB.nRingNoAnswerTime" returns="f_nReturnCode" ms-type="f_strMSType" ci="oMS.strConferenceId" calling-packetization="oMS.nPacketizationPeriod" connection-id="oMS.strConnectionId" callingparty-contact="strContact" mgcp-call-id="oMS.strCallId" ms-sdp="oMS.strContent" endpoint="oMS.strEndPoint" calling-capability="2" telephone-events="0" rtp-request-a="0" rtp-endpoint-a="" egress-gateway="oCallLegB.strRequestUri" sdp="oCallLegB.strContent" call-id="oCallLegB.strCallId" cseq="oCallLegB.strCSeq" sip-status="strSIPStatus" to="oCallLegB.strTo" from="oCallLegB.strFrom" session-timer="1" session-timer-value="oCallLegB.nSessionTimer" backup-ss="oCallLegB.strBackupRequestUri" route="oCallLegB.strRoute" record-route="oCallLegB.strRecordRoute" contact="oCallLegB.strContact" rtp-request-b="0" rtp-endpoint-b="" refresher="" play-ringback="0" language="" ringback-prompt="" capability="1" ringback-codec="-1" packetization-period="" te="" dc="0" le="" ig="" og="" ia="1" oa="1" iat="nAGCTargetLevelIn" oat="nAGCTargetLevelOut" ias="nAGCMaxLevelIn" oas="nAGCMaxLevelOut"/>
          <results >
            <result name="Default" link="3" stubbed="1"/>
            <result name="Success" link="4" stubbed="1"/>
            <result name="Ring no answer" link="5" stubbed="1"/>
            <result name="Busy" link="6" stubbed="1"/>
            <result name="Caller DTMF interrupt" link="7" stubbed="1"/>
            <result name="Called party error" link="8" stubbed="1"/>
            <result name="Calling party error" link="9" stubbed="1"/>
            <result name="Other error" link="10" stubbed="1"/>
            <result name="Resource unavailable" link="11" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.lTimeStart = Server.getUTCTime();
Session.oCallLegB.bCurrentlyDialing = true;
Session.oCallLegB.bAttemptedToOutdial = true;
var curTime = new Date();
Session.f_longStartTime = curTime.getTime();]]></script>
            <script language="javascript" timing="last" ><![CDATA[Session.oCallLegB.bCurrentlyDialing = false;
var curTime = new Date();
Session.f_longStopTime = curTime.getTime();
Server.logInfo("RETURN CODE: " + Session.f_nReturnCode);
Server.logInfo("SIP STATUS: " + Session.strSIPStatus);]]></script>
          </scripts>
        </action>
        <action id="21" plug-in="Pactolus.Branch.1" ><?xtml-editor x=623 y=443 ?>
          <!--got cancel?-->
          <results >
            <result name="Default" link="18" stubbed="0"/>
            <result name="bGotCSRCancelOutdial" link="3" stubbed="1" >f_bGotCSRCancelOutdial == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (true == Session.g_bGotCSRCancelOutdial)
{
	Session.f_bGotCSRCancelOutdial = true;
}]]></script>
          </scripts>
        </action>
        <action id="22" plug-in="Pactolus.Branch.1" ><?xtml-editor x=641 y=707 ?>
          <!--got cancel?-->
          <results >
            <result name="Default" link="16" stubbed="0"/>
            <result name="bGotCSRCancelOutdial" link="3" stubbed="1" >f_bGotCSRCancelOutdial == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (true == Session.g_bGotCSRCancelOutdial)
{
	Session.f_bGotCSRCancelOutdial = true;
}]]></script>
          </scripts>
        </action>
        <action id="23" plug-in="Pactolus.Branch.1" ><?xtml-editor x=656 y=970 ?>
          <!--got cancel?-->
          <results >
            <result name="Default" link="14" stubbed="0"/>
            <result name="bGotCSRCancelOutdial" link="3" stubbed="1" >f_bGotCSRCancelOutdial == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (true == Session.g_bGotCSRCancelOutdial)
{
	Session.f_bGotCSRCancelOutdial = true;
}]]></script>
          </scripts>
        </action>
        <action id="24" plug-in="Pactolus.Branch.1" ><?xtml-editor x=672 y=1230 ?>
          <!--got cancel?-->
          <results >
            <result name="Default" link="20" stubbed="0"/>
            <result name="bGotCSRCancelOutdial" link="3" stubbed="1" >f_bGotCSRCancelOutdial == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (true == Session.g_bGotCSRCancelOutdial)
{
	Session.f_bGotCSRCancelOutdial = true;
}]]></script>
          </scripts>
        </action>
      </actions>
      <text-objects >
        <text-object x-coord="47" y-coord="23" width="494" height="417" text="Conference app, will outdial party to a conference endpoint
bring party into a temp conference with moderator
Used by the moderator through IVR
INPUT:
oCallLegB        object type, B leg info
oMS            object type, media server info
longTimeStart        long type, the time when try to outdial
longTimeAnswered    long type, the time when called party answer
strSIPStatus        string type, SIP status of outdial
OUTPUT:
returns    
    0    success
    1    ring no answer
    2    busy
    3    DTMF interrupted
    -1    fail
    -2    called party error
    -3    calling party error
    -4    other error
    -5    resource unavailable

AT THE LATER TIME, SHOULD USE ADD PARTY TO CONF PAC
ONCE THE PAC IS WORKING" font-name="Times New Roman" size="-16" red="0" green="0" blue="0" weight="0" underline="0" strikeout="0" point-size="12" italic="0"/>
      </text-objects>
    </function>
    <function name="PlayArrayOfPrompts" start="7" event="PlayArrayOfPrompts" returns="i4" >
      <parameters >
        <parameter name="oMS" type="object"/>
        <parameter name="strLanguage" type="string"/>
        <parameter name="oPrompts" type="object"/>
        <parameter name="strPromptType" type="string"/>
      </parameters>
      <local-vars >
        <var name="f_nTIMEOUT" type="i4" >0</var>
        <var name="f_nReturnCode" type="i4" >0</var>
        <var name="f_strLanguage" type="string" >eng</var>
        <var name="f_nCounter" type="i4" >0</var>
        <var name="f_nSUCCESS" type="i4" >0</var>
        <var name="f_nFAILURE" type="i4" >-1</var>
        <var name="f_nIndex" type="i4" >0</var>
        <var name="f_bValid" type="boolean" >0</var>
      </local-vars>
      <actions >
        <action id="7" plug-in="Pactolus.Branch.1" ><?xtml-editor x=152 y=169 ?>
          <!--valid ms?-->
          <results >
            <result name="Default" link="4" stubbed="0"/>
            <result name="f_bValid == true" link="1" stubbed="0" >f_bValid == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[
if (Session.oMS.strEndPoint.length > 0 && 
   (Session.oMS.strCallId.length > 0 || Session.oMS.strType == "PCS") && 
   Session.oMS.strConnectionId.length > 0)
{
	Session.f_bValid = true;
}
else
{
	Session.f_bValid = false;
}]]></script>
          </scripts>
        </action>
        <action id="1" plug-in="Pactolus.Branch.1" ><?xtml-editor x=413 y=343 ?>
          <!--Index or URL-->
          <results >
            <result name="Default" link="4" stubbed="0"/>
            <result name="strPromptType == &quot;U&quot;" link="3" stubbed="0" >strPromptType match "U"
AND f_nCounter &gt; 0</result>
            <result name="strPromptType == &quot;I&quot;" link="2" stubbed="0" >strPromptType match "I"
AND f_nCounter &gt; 0</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_nCounter = Session.oPrompts.length;
if (Session.strLanguage.length > 0)
{
	Session.f_strLanguage = Session.strLanguage;
}]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=739 y=520 ?>
          <!--oPrompts[f_nIndex]-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="oMS.strConnectionId" endpoint="oMS.strEndPoint" callid="oMS.strCallId" repeat="1" timeout="f_nTIMEOUT" ms-type="oMS.strType" returns="f_nReturnCode" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="f_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >oPrompts[f_nIndex]</audio>
          </play>
          <results >
            <result name="Default" link="6" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if(Result.id != 2) {
	Server.logError("lib_mediaserver.xml: Play Pac exited on: " + Result.name);
}]]></script>
          </scripts>
        </action>
        <action id="3" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=722 y=324 ?>
          <!--oPrompts[f_nIndex]-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="oMS.strConnectionId" endpoint="oMS.strEndPoint" callid="oMS.strCallId" repeat="1" timeout="f_nTIMEOUT" ms-type="oMS.strType" returns="f_nReturnCode" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="f_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="url" >oPrompts[f_nIndex]</audio>
          </play>
          <results >
            <result name="Default" link="5" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if(Result.id != 2) {
	Server.logError("lib_mediaserver.xml: Play Pac exited on: " + Result.name);
}]]></script>
          </scripts>
        </action>
        <action id="4" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=676 y=213 ?>
          <!--f_nSUCCESS-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nSUCCESS"/>
        </action>
        <action id="5" plug-in="Pactolus.Branch.1" ><?xtml-editor x=969 y=319 ?>
          <!--more to play?-->
          <results >
            <result name="Default" link="3" stubbed="0"/>
            <result name="index &gt;= counter?" link="4" stubbed="1" >f_nIndex &gt;= f_nCounter</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_nIndex++;]]></script>
          </scripts>
        </action>
        <action id="6" plug-in="Pactolus.Branch.1" ><?xtml-editor x=989 y=513 ?>
          <!--more to play?-->
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="index &gt;= counter?" link="4" stubbed="1" >f_nIndex &gt;= f_nCounter</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_nIndex++;]]></script>
          </scripts>
        </action>
      </actions>
    </function>
    <function name="SetDTMFOn" start="1" event="SetDTMFOn" returns="i4" >
      <parameters >
        <parameter name="p_oMS" type="object"/>
        <parameter name="p_strDigitMap" type="string"/>
      </parameters>
      <local-vars >
        <var name="f_nSUCCESS" type="i4" >0</var>
        <var name="f_nFAILURE" type="i4" >-1</var>
        <var name="f_strRequestNotify" type="string" ></var>
      </local-vars>
      <actions >
        <action id="1" plug-in="Pactolus.MGCPNotifyRequest.1" ><?xtml-editor x=224 y=241 ?>
          <!--set DTMF ON-->
          <rqnt xmlns="urn:www.pactolus.com:xtml:media" connection-id="p_oMS.strConnectionId" endpoint="p_oMS.strEndPoint" callid="p_oMS.strCallId" timeout="10" returns="" ms-type="p_oMS.strType" >
            <parameters >
              <quarantine step="1" loop="0" process="0" discard="1"/>
              <events ><![CDATA[f_strRequestNotify]]></events>
              <signals ><![CDATA[]]></signals>
              <digit-map ><![CDATA[p_strDigitMap]]></digit-map>
            </parameters>
          </rqnt>
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="Success" link="3" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: RQNT MS call id = " + Session.p_oMS.strCallId);
Server.logInfo("INFO: RQNT MS connection id = " + Session.p_oMS.strConnectionId);
Server.logInfo("INFO: RQNT MS end point = " + Session.p_oMS.strEndPoint);
Session.f_strRequestNotify = "D/[0-9#*T]@" + Session.p_oMS.strConnectionId + "(D)";]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=478 y=235 ?>
          <!--f_nFAILURE-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nFAILURE"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logError("ERROR: FAIL TO SET DTMF COLLECTION ON");
Server.logError("ERROR: RQNT MS call id = " + Session.p_oMS.strCallId);
Server.logError("ERROR: RQNT MS connection id = " + Session.p_oMS.strConnectionId);
Server.logError("ERROR: RQNT MS end point = " + Session.p_oMS.strEndPoint);
Server.logError("ERROR: DIGIT MAP = " + Session.p_strDigitMap);]]></script>
          </scripts>
        </action>
        <action id="3" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=494 y=327 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
        </action>
      </actions>
    </function>
    <function name="SetDFTMOff" start="1" event="SetDFTMOff" returns="i4" >
      <parameters >
        <parameter name="p_oMS" type="object"/>
      </parameters>
      <local-vars >
        <var name="f_strRequestNotify" type="string" ></var>
        <var name="f_nSUCCESS" type="i4" >0</var>
        <var name="f_nFAILURE" type="i4" >-1</var>
      </local-vars>
      <actions >
        <action id="1" plug-in="Pactolus.MGCPNotifyRequest.1" ><?xtml-editor x=258 y=299 ?>
          <!--set DTMF OFF-->
          <rqnt xmlns="urn:www.pactolus.com:xtml:media" connection-id="p_oMS.strConnectionId" endpoint="p_oMS.strEndPoint" callid="p_oMS.strCallId" timeout="10" returns="" ms-type="p_oMS.strType" >
            <parameters >
              <quarantine step="0" loop="0" process="0" discard="0"/>
              <events ><![CDATA[f_strRequestNotify]]></events>
              <signals ><![CDATA[]]></signals>
              <digit-map ><![CDATA[]]></digit-map>
            </parameters>
          </rqnt>
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="Success" link="3" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: RQNT MS call id = " + Session.p_oMS.strCallId);
Server.logInfo("INFO: RQNT MS connection id = " + Session.p_oMS.strConnectionId);
Server.logInfo("INFO: RQNT MS end point = " + Session.p_oMS.strEndPoint);
Session.f_strRequestNotify = "A/null@" + Session.p_oMS.strConnectionId;]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=512 y=293 ?>
          <!--f_nFAILURE-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nFAILURE"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logError("ERROR: FAIL TO SET DTMF COLLECTION ON");
Server.logError("ERROR: RQNT MS call id = " + Session.p_oMS.strCallId);
Server.logError("ERROR: RQNT MS connection id = " + Session.p_oMS.strConnectionId);
Server.logError("ERROR: RQNT MS end point = " + Session.p_oMS.strEndPoint);
Server.logError("ERROR: DIGIT MAP = " + Session.p_strDigitMap);]]></script>
          </scripts>
        </action>
        <action id="3" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=528 y=385 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
        </action>
      </actions>
    </function>
    <function name="PlayBrandingPrompt" start="2" event="PlayBrandingPrompt" returns="i4" >
      <parameters >
        <parameter name="oMS" type="object" pass="byref"/>
        <parameter name="strLanguage" type="string" pass="byref"/>
        <parameter name="strPromptType" type="string" pass="byref"/>
        <parameter name="nPromptIndex" type="i4" pass="byref"/>
        <parameter name="strPromptUrl" type="string" pass="byref"/>
      </parameters>
      <local-vars >
        <var name="bHaveIndexPrompt" type="boolean" >0</var>
        <var name="bHaveUrlPrompt" type="boolean" >0</var>
        <var name="nReturnValue" type="i4" >0</var>
      </local-vars>
      <actions >
        <action id="2" plug-in="Pactolus.Branch.1" ><?xtml-editor x=40 y=102 ?>
          <results >
            <result name="Default" link="3" stubbed="0"/>
            <result name="index prompt" link="1" stubbed="0" >bHaveIndexPrompt == true</result>
            <result name="url prompt" link="4" stubbed="0" >bHaveUrlPrompt == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("*****PLAYING BRANDING PROMPT*****") ;
Server.logInfo("Language: " + Session.strLanguage) ;
Server.logInfo("Prompt Type: " + Session.strPromptType) ;

if ( 0 != Session.nPromptIndex ) {
	Session.bHaveIndexPrompt = true ;
	Server.logInfo("Prompt Index:" + Session.nPromptIndex) ;
}
else if ( 0 != Session.strPromptUrl.length ) {
		Session.bHaveUrlPrompt = true ;
		Server.logInfo("Prompt URL: " + Session.strPromptUrl) ;
}
else {
	Server.logInfo("NO PROMPT RECEIVED") ;
	Session.nReturnValue = -1
}

]]></script>
          </scripts>
        </action>
        <action id="1" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=317 y=176 ?>
          <!--play index prompt-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="oMS.strConnectionId" endpoint="oMS.strEndPoint" callid="oMS.strCallId" repeat="1" timeout="120" ms-type="oMS.strType" returns="nReturnValue" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >nPromptIndex</audio>
          </play>
          <results >
            <result name="Default" link="3" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="3" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=524 y=71 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value="0"/>
        </action>
        <action id="4" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=324 y=334 ?>
          <!--play url prompt-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="oMS.strConnectionId" endpoint="oMS.strEndPoint" callid="oMS.strCallId" repeat="1" timeout="120" ms-type="oMS.strType" returns="nReturnValue" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="url" >strPromptUrl</audio>
          </play>
          <results >
            <result name="Default" link="3" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
      </actions>
    </function>
    <function name="ChangeToConferenceMode" start="1" event="ChangeToConferenceMode" returns="i4" >
      <parameters >
        <parameter name="p_oMS" type="object" pass="byref"/>
      </parameters>
      <local-vars >
        <var name="f_nFAILURE" type="i4" >-1</var>
        <var name="f_nReturnCode" type="i4" >-1</var>
        <var name="f_nSUCCESS" type="i4" >0</var>
        <var name="f_nTIMEOUT" type="i4" >20</var>
      </local-vars>
      <actions >
        <action id="1" plug-in="Pactolus.MGCPModify.1" ><?xtml-editor x=246 y=154 ?>
          <mdcx xmlns="urn:www.pactolus.com:xtml:media" connection-id="p_oMS.strConnectionId" endpoint="p_oMS.strEndPoint" callid="p_oMS.strCallId" returns="f_nReturnCode" remote-sdp="" mode="conference" packetization-period="" codec="-1" timeout="f_nTIMEOUT" local-connection-options="" second-endpoint-id="" ms-type="p_oMS.strType" >
            <parameters >
              <quarantine step="0" loop="0" process="0" discard="0"/>
              <events ><![CDATA[]]></events>
              <signals ><![CDATA[]]></signals>
              <digit-map ><![CDATA[]]></digit-map>
            </parameters>
          </mdcx>
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="Success" link="3" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("CHANGE TO CONFERENCE MODE");
Server.logInfo("CONNECTION Id: " + Session.p_oMS.strConnectionId);
Server.logInfo("CALL Id: " + Session.p_oMS.strCallId);
Server.logInfo("END POINT: " + Session.p_oMS.strEndPoint);]]></script>
            <script language="javascript" timing="last" ><![CDATA[Server.logInfo("CHANGE TO CONFERENCE MODE RETURNS: " + Session.f_nReturnCode);
if (Result.id != 2)
{
	Server.logError("ERROR: FAIL TO MDCX. CONNECTION Id: " + Session.p_oMS.strConnectionId);
	Server.logError("ERROR: FAIL TO MDCX. CALL Id: " + Session.p_oMS.strCallId);
	Server.logError("ERROR: FAIL TO MDCX. ENDPOINT: " + Session.p_oMS.strEndPoint);
	Server.logError("ERROR: FAIL TO MDCX. RETURN CODE IS: " + Session.f_nReturnCode);
	Server.logError("ERROR: FAIL TO MDCX. EXIT ON BRANCH: " + Result.name);
}]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=482 y=129 ?>
          <!--f_nFAILURE-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nFAILURE"/>
        </action>
        <action id="3" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=500 y=205 ?>
          <!--f_nSUCCESS-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nSUCCESS"/>
        </action>
        <action id="4" plug-in="Pactolus.CNFModifyMember.1" ><?xtml-editor x=247 y=272 ?>
          <!--mute only-->
          <modify-member xmlns="urn:www.pactolus.com:xtml:conference" ci="p_oMS.strConferenceId" endpoint="p_oMS.strEndPoint" connection-id="p_oMS.strConnectionId" ms-type="p_oMS.strType" timeout="f_nFAILURE" returns="f_nReturnCode" mode="-1" co-ep="" te="1" dc="1" le="1" ig="" og="" ia="" oa="" iat="" oat="" ias="" oas="" tf="1" lf="1" conn-mode="conference" >
            <attributes mp="16" mt="3" ig="0" og="0" iat="-10" ias="-40" oat="-10" oas="-40" atn="3" att="2" ia="1" oa="1" te="1" le="1" tp="0" dc="1" tc="1" ate="0" se="0"/>
          </modify-member>
          <results >
            <result name="Default" link="2" stubbed="1"/>
            <result name="Success" link="3" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("CHANGE TO CONFERENCE MODE");
Server.logInfo("CONNECTION Id: " + Session.p_oMS.strConnectionId);
Server.logInfo("CALL Id: " + Session.p_oMS.strCallId);
Server.logInfo("END POINT: " + Session.p_oMS.strEndPoint);]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)
{
	Server.logError("ERROR: FAIL TO MDCX. CONNECTION Id: " + Session.p_oMS.strConnectionId);
	Server.logError("ERROR: FAIL TO MDCX. CALL Id: " + Session.p_oMS.strCallId);
	Server.logError("ERROR: FAIL TO MDCX. ENDPOINT: " + Session.p_oMS.strEndPoint);
	Server.logError("ERROR: FAIL TO MDCX. RETURN CODE IS: " + Session.f_nReturnCode);
	Server.logError("ERROR: FAIL TO MDCX. EXIT ON BRANCH: " + Result.name);
}]]></script>
          </scripts>
        </action>
      </actions>
      <text-objects >
        <text-object x-coord="276" y-coord="416" width="366" height="105" text="set codec: no preference
packetizationPeriod: blank

work around problem with G.729 with no telephone-event" font-name="Times New Roman" size="-16" red="0" green="0" blue="0" weight="0" underline="0" strikeout="0" point-size="12" italic="0"/>
      </text-objects>
    </function>
    <function name="ChangeToDataMode" start="1" event="ChangeToDataMode" returns="i4" >
      <parameters >
        <parameter name="p_oMS" type="object" pass="byref"/>
      </parameters>
      <local-vars >
        <var name="f_nFAILURE" type="i4" >-1</var>
        <var name="f_nReturnCode" type="i4" >-1</var>
        <var name="f_nSUCCESS" type="i4" >0</var>
        <var name="f_nTIMEOUT" type="i4" >20</var>
      </local-vars>
      <actions >
        <action id="1" plug-in="Pactolus.MGCPModify.1" ><?xtml-editor x=273 y=176 ?>
          <mdcx xmlns="urn:www.pactolus.com:xtml:media" connection-id="p_oMS.strConnectionId" endpoint="p_oMS.strEndPoint" callid="p_oMS.strCallId" returns="f_nReturnCode" remote-sdp="" mode="send/receive" packetization-period="" codec="-1" timeout="f_nTIMEOUT" local-connection-options="" second-endpoint-id="" ms-type="p_oMS.strType" >
            <parameters >
              <quarantine step="0" loop="0" process="0" discard="0"/>
              <events ><![CDATA[]]></events>
              <signals ><![CDATA[]]></signals>
              <digit-map ><![CDATA[]]></digit-map>
            </parameters>
          </mdcx>
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="Success" link="3" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("CHANGE TO DATA MODE");
Server.logInfo("CONNECTION Id: " + Session.p_oMS.strConnectionId);
Server.logInfo("CALL Id: " + Session.p_oMS.strCallId);
Server.logInfo("END POINT: " + Session.p_oMS.strEndPoint);]]></script>
            <script language="javascript" timing="last" ><![CDATA[Server.logInfo("CHANGE TO DATA MODE RETURNS: " + Session.f_nReturnCode);
if (Result.id != 2)
{
	Server.logError("ERROR: FAIL TO MDCX. CONNECTION Id: " + Session.p_oMS.strConnectionId);
	Server.logError("ERROR: FAIL TO MDCX. CALL Id: " + Session.p_oMS.strCallId);
	Server.logError("ERROR: FAIL TO MDCX. ENDPOINT: " + Session.p_oMS.strEndPoint);
	Server.logError("ERROR: FAIL TO MDCX. RETURN CODE IS: " + Session.f_nReturnCode);
	Server.logError("ERROR: FAIL TO MDCX. EXIT ON BRANCH: " + Result.name);
}]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=499 y=157 ?>
          <!--f_nFAILURE-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nFAILURE"/>
        </action>
        <action id="3" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=517 y=233 ?>
          <!--f_nSUCCESS-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nSUCCESS"/>
        </action>
        <action id="4" plug-in="Pactolus.CNFModifyMember.1" ><?xtml-editor x=272 y=311 ?>
          <!--can hear private prompt and collect dtmf-->
          <modify-member xmlns="urn:www.pactolus.com:xtml:conference" ci="p_oMS.strConferenceId" endpoint="p_oMS.strEndPoint" connection-id="p_oMS.strConnectionId" ms-type="p_oMS.strType" timeout="f_nTIMEOUT" returns="f_nReturnCode" mode="-1" co-ep="" te="1" dc="1" le="1" ig="" og="" ia="" oa="" iat="" oat="" ias="" oas="" tf="1" lf="1" conn-mode="send/receive" >
            <attributes mp="16" mt="3" ig="0" og="0" iat="-10" ias="-40" oat="-10" oas="-40" atn="3" att="2" ia="1" oa="1" te="1" le="1" tp="0" dc="1" tc="1" ate="0" se="0"/>
          </modify-member>
          <results >
            <result name="Default" link="2" stubbed="1"/>
            <result name="Success" link="3" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("CHANGE TO DATA MODE");
Server.logInfo("CONNECTION Id: " + Session.p_oMS.strConnectionId);
Server.logInfo("CALL Id: " + Session.p_oMS.strCallId);
Server.logInfo("END POINT: " + Session.p_oMS.strEndPoint);]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)
{
	Server.logError("ERROR: FAIL TO MDCX. CONNECTION Id: " + Session.p_oMS.strConnectionId);
	Server.logError("ERROR: FAIL TO MDCX. CALL Id: " + Session.p_oMS.strCallId);
	Server.logError("ERROR: FAIL TO MDCX. ENDPOINT: " + Session.p_oMS.strEndPoint);
	Server.logError("ERROR: FAIL TO MDCX. RETURN CODE IS: " + Session.f_nReturnCode);
	Server.logError("ERROR: FAIL TO MDCX. EXIT ON BRANCH: " + Result.name);
}]]></script>
          </scripts>
        </action>
      </actions>
    </function>
    <function name="ChangeToMutedMode" start="1" event="ChangeToMutedMode" returns="i4" >
      <parameters >
        <parameter name="p_oMS" type="object" pass="byref"/>
      </parameters>
      <local-vars >
        <var name="f_nFAILURE" type="i4" >-1</var>
        <var name="f_nReturnCode" type="i4" >-1</var>
        <var name="f_nSUCCESS" type="i4" >0</var>
        <var name="f_nTIMEOUT" type="i4" >20</var>
      </local-vars>
      <actions >
        <action id="1" plug-in="Pactolus.MGCPModify.1" ><?xtml-editor x=60 y=114 ?>
          <mdcx xmlns="urn:www.pactolus.com:xtml:media" connection-id="p_oMS.strConnectionId" endpoint="p_oMS.strEndPoint" callid="p_oMS.strCallId" returns="f_nReturnCode" remote-sdp="" mode="convedia listen only" packetization-period="p_oMS.nPacketizationPeriod" codec="p_oMS.strCodec" timeout="f_nTIMEOUT" local-connection-options="" second-endpoint-id="" ms-type="p_oMS.strType" >
            <parameters >
              <quarantine step="0" loop="0" process="0" discard="0"/>
              <events ><![CDATA[]]></events>
              <signals ><![CDATA[]]></signals>
              <digit-map ><![CDATA[]]></digit-map>
            </parameters>
          </mdcx>
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="Success" link="3" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("CHANGE TO MUTED MODE");
Server.logInfo("CONNECTION Id: " + Session.p_oMS.strConnectionId);
Server.logInfo("CALL Id: " + Session.p_oMS.strCallId);
Server.logInfo("END POINT: " + Session.p_oMS.strEndPoint);]]></script>
            <script language="javascript" timing="last" ><![CDATA[Server.logInfo("CHANGE TO MUTE MODE RETURNS: " + Session.f_nReturnCode);
if (Result.id != 2)
{
	Server.logError("ERROR: FAIL TO MDCX. CONNECTION Id: " + Session.p_oMS.strConnectionId);
	Server.logError("ERROR: FAIL TO MDCX. CALL Id: " + Session.p_oMS.strCallId);
	Server.logError("ERROR: FAIL TO MDCX. ENDPOINT: " + Session.p_oMS.strEndPoint);
	Server.logError("ERROR: FAIL TO MDCX. RETURN CODE IS: " + Session.f_nReturnCode);
	Server.logError("ERROR: FAIL TO MDCX. EXIT ON BRANCH: " + Result.name);
}]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=370 y=94 ?>
          <!--f_nFAILURE-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nFAILURE"/>
        </action>
        <action id="3" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=384 y=235 ?>
          <!--f_nSUCCESS-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nSUCCESS"/>
        </action>
        <action id="4" plug-in="Pactolus.CNFModifyMember.1" ><?xtml-editor x=63 y=244 ?>
          <modify-member xmlns="urn:www.pactolus.com:xtml:conference" ci="p_oMS.strEndPoint" endpoint="p_oMS.strEndPoint" connection-id="p_oMS.strConnectionId" ms-type="p_oMS.strType" timeout="f_nTIMEOUT" returns="f_nReturnCode" mode="-1" co-ep="" te="1" dc="1" le="1" ig="" og="" ia="0" oa="" iat="" oat="" ias="" oas="" tf="2" lf="2" conn-mode="receive" >
            <attributes mp="16" mt="3" ig="0" og="0" iat="-10" ias="-40" oat="-10" oas="-40" atn="3" att="2" ia="0" oa="1" te="1" le="1" tp="0" dc="1" tc="1" ate="0" se="0"/>
          </modify-member>
          <results >
            <result name="Default" link="2" stubbed="1"/>
            <result name="Success" link="3" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("CHANGE TO MUTED MODE");
Server.logInfo("CONNECTION Id: " + Session.p_oMS.strConnectionId);
Server.logInfo("CALL Id: " + Session.p_oMS.strCallId);
Server.logInfo("END POINT: " + Session.p_oMS.strEndPoint);]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)
{
	Server.logError("ERROR: FAIL TO MDCX. CONNECTION Id: " + Session.p_oMS.strConnectionId);
	Server.logError("ERROR: FAIL TO MDCX. CALL Id: " + Session.p_oMS.strCallId);
	Server.logError("ERROR: FAIL TO MDCX. ENDPOINT: " + Session.p_oMS.strEndPoint);
	Server.logError("ERROR: FAIL TO MDCX. RETURN CODE IS: " + Session.f_nReturnCode);
	Server.logError("ERROR: FAIL TO MDCX. EXIT ON BRANCH: " + Result.name);
}]]></script>
          </scripts>
        </action>
        <action id="5" plug-in="Pactolus.CNFModifyMember.1" ><?xtml-editor x=58 y=378 ?>
          <!--mute only-->
          <modify-member xmlns="urn:www.pactolus.com:xtml:conference" ci="p_oMS.strConferenceId" endpoint="p_oMS.strEndPoint" connection-id="p_oMS.strConnectionId" ms-type="p_oMS.strType" timeout="f_nTIMEOUT" returns="f_nReturnCode" mode="-1" co-ep="" te="1" dc="1" le="1" ig="" og="" ia="" oa="" iat="" oat="" ias="" oas="" tf="1" lf="1" conn-mode="convedia listen only" >
            <attributes mp="16" mt="3" ig="0" og="0" iat="-10" ias="-40" oat="-10" oas="-40" atn="3" att="2" ia="1" oa="1" te="1" le="1" tp="0" dc="1" tc="1" ate="0" se="0"/>
          </modify-member>
          <results >
            <result name="Default" link="2" stubbed="1"/>
            <result name="Success" link="3" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("CHANGE TO MUTED MODE");
Server.logInfo("CONNECTION Id: " + Session.p_oMS.strConnectionId);
Server.logInfo("CALL Id: " + Session.p_oMS.strCallId);
Server.logInfo("END POINT: " + Session.p_oMS.strEndPoint);]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)
{
	Server.logError("ERROR: FAIL TO MDCX. CONNECTION Id: " + Session.p_oMS.strConnectionId);
	Server.logError("ERROR: FAIL TO MDCX. CALL Id: " + Session.p_oMS.strCallId);
	Server.logError("ERROR: FAIL TO MDCX. ENDPOINT: " + Session.p_oMS.strEndPoint);
	Server.logError("ERROR: FAIL TO MDCX. RETURN CODE IS: " + Session.f_nReturnCode);
	Server.logError("ERROR: FAIL TO MDCX. EXIT ON BRANCH: " + Result.name);
}]]></script>
          </scripts>
        </action>
      </actions>
    </function>
    <function name="NewAddMemberToConference" start="24" event="NewAddMemberToConference" returns="i4" >
      <parameters >
        <parameter name="oMS" type="object" pass="byref"/>
        <parameter name="oCallLeg" type="object" pass="byref"/>
        <parameter name="strContact" type="string"/>
      </parameters>
      <local-vars >
        <var name="f_bDTMFClampFlag" type="boolean" >0</var>
        <var name="f_nCALLERHUNGUP" type="i4" >-2</var>
        <var name="f_nFAILURE" type="i4" >-1</var>
        <var name="f_nReturnCode" type="i4" >0</var>
        <var name="f_nSUCCESS" type="i4" >0</var>
        <var name="f_nTIMEOUT" type="i4" >40</var>
        <var name="f_strCodec" type="string" ></var>
        <var name="f_strMSType" type="string" ></var>
        <var name="nExceedMaxFullDuplex" type="i4" >-3</var>
        <var name="nAGCTargetLevelIn" type="i4" >-9</var>
        <var name="nAGCMaxLevelIn" type="i4" >0</var>
        <var name="nAGCTargetLevelOut" type="i4" >-9</var>
        <var name="nAGCMaxLevelOut" type="i4" >0</var>
      </local-vars>
      <actions >
        <action id="24" plug-in="Pactolus.Branch.1" ><?xtml-editor x=163 y=873 ?>
          <!--CONV-->
          <results >
            <result name="Default" link="1" stubbed="0"/>
            <result name="f_strMSType == &quot;CONV&quot;" link="47" stubbed="0" >f_strMSType match "CONV"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("**** BEFORE ADD MEMBER TO CONFERENCE ****");
Server.logInfo("oCallLeg.strFrom: " + Session.oCallLeg.strFrom);
Server.logInfo("oCallLeg.strTo: " + Session.oCallLeg.strTo);
Server.logInfo("oCallLeg.strContent: " + Session.oCallLeg.strContent);
Server.logInfo("oCallLeg.strCSeq: " + Session.oCallLeg.strCSeq);
Server.logInfo("oCallLeg.strCallId: " + Session.oCallLeg.strCallId);
Server.logInfo("oCallLeg.strRequestUri: " + Session.oCallLeg.strRequestUri);
Server.logInfo("oMS.strConferenceId: " + Session.oMS.strConferenceId);
Server.logInfo("oMS.strEndPoint: " + Session.oMS.strEndPoint);
Server.logInfo("oMS.strContent: " + Session.oMS.strContent);
Server.logInfo("oMS.strConnectionId: " + Session.oMS.strConnectionId);
Server.logInfo("oMS.strCallId: " + Session.oMS.strCallId);
Server.logInfo("oMS.strType: " + Session.oMS.strType);
Server.logInfo("oMS.bMuteFlag: " + Session.oMS.bMuteFlag);
Server.logInfo("oMS.bDeafFlag: " + Session.oMS.bDeafFlag);
Server.logInfo("oMS.bCurrentlyInConf: " + Session.oMS.bCurrentlyInConf);
Server.logInfo("oMS.bCurrentlyConnected: " + Session.oMS.bCurrentlyConnected);
Server.logInfo("oMS.bRetry: " + Session.oMS.bRetry);
Server.logInfo("oMS.bDTMFClampFlag: " + Session.oMS.bDTMFClampFlag);
Server.logInfo("oMS.bUseForACD: " + Session.oMS.bUseForACD);
Server.logInfo("oMS.bUseForMOH: " + Session.oMS.bUseForMOH);
Server.logInfo("oMS.strType: " + Session.oMS.strType);
Server.logInfo("oMS.strACDType: " + Session.oMS.strACDType);
Server.logInfo("oMS.strMOHType: " + Session.oMS.strMOHType);
Server.logInfo("oMS.nAGCTargetLevelIn: " + Session.oMS.nAGCTargetLevelIn);
Server.logInfo("oMS.nAGCMaxLevelIn: " + Session.oMS.nAGCMaxLevelIn);
Server.logInfo("oMS.nAGCTargetLevelOut: " + Session.oMS.nAGCTargetLevelOut);
Server.logInfo("oMS.nAGCMaxLevelOut: " + Session.oMS.nAGCMaxLevelOut);

Server.logInfo("oCallLeg.strRoute: " + Session.oCallLeg.strRoute);
Server.logInfo("oCallLeg.strRecordRoute: " + Session.oCallLeg.strRecordRoute);

if (Session.oMS.bDTMFClampFlag == false)
{
	Session.f_bDTMFClampFlag = false;
}
else
{
	Session.f_bDTMFClampFlag = true;
}
Server.logInfo("oMS.strCodec is: " + Session.oMS.strCodec);
if (0 == Session.oMS.strCodec.length ||  undefined == Session.oMS.strCodec)
{
	Session.f_strCodec = "PCMU";
}
else
{
	Session.f_strCodec = Session.oMS.strCodec;	
}
Server.logInfo("f_strCodec is: " + Session.f_strCodec);

if (Session.oMS.bUseForMOH)
{
	Session.f_strMSType = Session.oMS.strMOHType;
}
else if (Session.oMS.bUseForACD)
{
	Session.f_strMSType = Session.oMS.strACDType;
}
else
{
	Session.f_strMSType = Session.oMS.strType;
}
Server.logInfo("f_strMSType is: " + Session.f_strMSType);
if (undefined == Session.oMS.nAGCTargetLevelIn)
{
	Session.nAGCTargetLevelIn = -9;
	Server.logInfo("use default AGC Target level in");
}
else
{
	Session.nAGCTargetLevelIn = Session.oMS.nAGCTargetLevelIn;	
}
Server.logInfo("nAGCTargetLevel in is: " + Session.nAGCTargetLevelIn);
if (undefined == Session.oMS.nAGCMaxLevelIn)
{
	Session.nAGCMaxLevelIn = 0;
	Server.logInfo("use default AGC Max level in");
}
else
{
	Session.nAGCMaxLevelIn = Session.oMS.nAGCMaxLevelIn;
}
Server.logInfo("nAGCMaxLevel in is: " + Session.nAGCMaxLevelIn);
if (undefined == Session.oMS.nAGCTargetLevelOut)
{
	Session.nAGCTargetLevelOut = -9;
	Server.logInfo("use default AGC Target level out");
}
else
{
	Session.nAGCTargetLevelOut = Session.oMS.nAGCTargetLevelOut;	
}
Server.logInfo("nAGCTargetLevel out is: " + Session.nAGCTargetLevelOut);
if (undefined == Session.oMS.nAGCMaxLevelOut)
{
	Session.nAGCMaxLevelOut = 0;
	Server.logInfo("use default AGC Max level out");
}
else
{
	Session.nAGCMaxLevelOut = Session.oMS.nAGCMaxLevelOut;
}
Server.logInfo("nAGCMaxLevel out is: " + Session.nAGCMaxLevelOut);
]]></script>
          </scripts>
        </action>
        <action id="1" plug-in="Pactolus.Branch.1" ><?xtml-editor x=628 y=719 ?>
          <!--dial in or dial out?
dial in reverse to and from-->
          <results >
            <result name="Default" link="15" stubbed="0"/>
            <result name="oCallLeg.bReverseFromTo = true;" link="3" stubbed="0" >oCallLeg.bReverseFromTo == true</result>
          </results>
        </action>
        <action id="2" plug-in="Pactolus.CNFAddMember.1" ><?xtml-editor x=1145 y=1030 ?>
          <!--talkable and listenable-->
          <add-member xmlns="urn:www.pactolus.com:xtml:conference" endpoint="oMS.strEndPoint" ms-type="f_strMSType" ci="oMS.strConferenceId" inbound="0" returns="f_nReturnCode" timeout="f_nTIMEOUT" connection-id="oMS.strConnectionId" ms-sdp="oMS.strContent" mgcp-call-id="oMS.strCallId" ingress-gateway="oCallLeg.strRequestUri" early-media="0" local="0" party-on-hold="0" packetization-period="oMS.nPacketizationPeriod" codec="f_strCodec" telephone-events="0" route="oCallLeg.strRoute" record-route="oCallLeg.strRecordRoute" contact="strContact" te="1" dc="f_bDTMFClampFlag" le="1" ig="" og="" ia="" oa="" iat="" oat="" ias="" oas="" tf="" lf="" session-expires="" min-se="" supported="" min-supported-session-timer="" refresher="" use-session-timer="0" conn-mode="conference" to="oCallLeg.strFrom" call-id="oCallLeg.strCallId" cseq="oCallLeg.strCSeq" caller-sdp="oCallLeg.strContent" from="oCallLeg.strTo" via="" >
            <attributes mp="16" mt="3" ig="0" og="0" iat="-10" ias="-40" oat="-10" oas="-40" atn="3" att="2" ia="1" oa="1" te="1" le="1" tp="0" dc="f_bDTMFClampFlag" tc="1" ate="0" se="0"/>
          </add-member>
          <results >
            <result name="Default" link="5" stubbed="0"/>
            <result name="Success" link="6" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
            <result name="Resource Unavailable" link="17" stubbed="0"/>
            <result name="Caller Hung up" link="7" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2 && Result.id !=6)
{
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. CONFERENCE Id: " + Session.oMS.strConferenceId);
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. RETURN CODE IS: " + Session.f_nReturnCode);
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. EXIT ON BRANCH: " + Result.name);
	if (502 == Session.f_nReturnCode)
		Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE: EXCEED MAX FULL DUPLEX");
}]]></script>
          </scripts>
        </action>
        <action id="3" plug-in="Pactolus.Branch.1" ><?xtml-editor x=853 y=1173 ?>
          <!--oMS.bMuteFlag == true?-->
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="mute only" link="4" stubbed="0" >oMS.bMuteFlag == true
AND oMS.bDeafFlag == false</result>
            <result name="deaf only" link="8" stubbed="0" >oMS.bMuteFlag == false
AND oMS.bDeafFlag == true</result>
            <result name="mute and deaf" link="23" stubbed="0" >oMS.bMuteFlag == true
AND oMS.bDeafFlag == true</result>
          </results>
        </action>
        <action id="4" plug-in="Pactolus.CNFAddMember.1" ><?xtml-editor x=1151 y=1232 ?>
          <!--mute only-->
          <add-member xmlns="urn:www.pactolus.com:xtml:conference" endpoint="oMS.strEndPoint" ms-type="f_strMSType" ci="oMS.strConferenceId" inbound="0" returns="f_nReturnCode" timeout="f_nTIMEOUT" connection-id="oMS.strConnectionId" ms-sdp="oMS.strContent" mgcp-call-id="oMS.strCallId" ingress-gateway="oCallLeg.strRequestUri" early-media="0" local="0" party-on-hold="0" packetization-period="oMS.nPacketizationPeriod" codec="f_strCodec" telephone-events="0" route="oCallLeg.strRoute" record-route="oCallLeg.strRecordRoute" contact="strContact" te="1" dc="f_bDTMFClampFlag" le="1" ig="" og="" ia="" oa="" iat="" oat="" ias="" oas="" tf="1" lf="1" session-expires="" min-se="" supported="" min-supported-session-timer="" refresher="" use-session-timer="0" conn-mode="receive" to="oCallLeg.strFrom" call-id="oCallLeg.strCallId" cseq="oCallLeg.strCSeq" caller-sdp="oCallLeg.strContent" from="oCallLeg.strTo" via="" >
            <attributes mp="16" mt="3" ig="0" og="0" iat="-10" ias="-40" oat="-10" oas="-40" atn="3" att="2" ia="1" oa="1" te="1" le="1" tp="0" dc="f_bDTMFClampFlag" tc="1" ate="0" se="0"/>
          </add-member>
          <results >
            <result name="Default" link="5" stubbed="1"/>
            <result name="Success" link="18" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
            <result name="Resource Unavailable" link="17" stubbed="1"/>
            <result name="Caller Hung up" link="7" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2 && Result.id !=6)
{
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. CONFERENCE Id: " + Session.oMS.strConferenceId);
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. RETURN CODE IS: " + Session.f_nReturnCode);
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. EXIT ON BRANCH: " + Result.name);
	if (502 == Session.f_nReturnCode)
		Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE: EXCEED MAX FULL DUPLEX");
}]]></script>
          </scripts>
        </action>
        <action id="5" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1481 y=1017 ?>
          <!--f_nReturnCode-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nReturnCode"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (502 == Session.f_nReturnCode)
	Session.f_nReturnCode = Session.nExceedMaxFullDuplex;
else
	Session.f_nReturnCode = Session.f_nFAILURE;]]></script>
          </scripts>
        </action>
        <action id="6" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1715 y=1090 ?>
          <!--f_nSUCCESS-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nSUCCESS"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("SUCCESS ADD MEMBER");
Session.oMS.bCurrentlyInConf = true;

if(Session.oMS.strType == "PCS") {
	Session.oMS.bCurrentlyConnected = true;
}

Server.logInfo("**** AFTER ADD MEMBER TO CONFERENCE ****");
Server.logInfo("oCallLeg.strFrom: " + Session.oCallLeg.strFrom);
Server.logInfo("oCallLeg.strTo: " + Session.oCallLeg.strTo);
Server.logInfo("oCallLeg.strContent: " + Session.oCallLeg.strContent);
Server.logInfo("oCallLeg.strCSeq: " + Session.oCallLeg.strCSeq);
Server.logInfo("oCallLeg.strCallId: " + Session.oCallLeg.strCallId);
Server.logInfo("oCallLeg.strRequestUri: " + Session.oCallLeg.strRequestUri);
Server.logInfo("oMS.strConferenceId: " + Session.oMS.strConferenceId);
Server.logInfo("oMS.strEndPoint: " + Session.oMS.strEndPoint);
Server.logInfo("oMS.strContent: " + Session.oMS.strContent);
Server.logInfo("oMS.strConnectionId: " + Session.oMS.strConnectionId);
Server.logInfo("oMS.strCallId: " + Session.oMS.strCallId);
Server.logInfo("oMS.strType: " + Session.oMS.strType);
Server.logInfo("oMS.bMuteFlag: " + Session.oMS.bMuteFlag);
Server.logInfo("oMS.bDeafFlag: " + Session.oMS.bDeafFlag);
Server.logInfo("oMS.bCurrentlyInConf: " + Session.oMS.bCurrentlyInConf);
Server.logInfo("oMS.bCurrentlyConnected: " + Session.oMS.bCurrentlyConnected);
Server.logInfo("oMS.bRetry: " + Session.oMS.bRetry);]]></script>
          </scripts>
        </action>
        <action id="7" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1496 y=1256 ?>
          <!--f_nCALLERHUNGUP-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nCALLERHUNGUP"/>
        </action>
        <action id="8" plug-in="Pactolus.CNFAddMember.1" ><?xtml-editor x=1157 y=1443 ?>
          <!--deaf only-->
          <add-member xmlns="urn:www.pactolus.com:xtml:conference" endpoint="oMS.strEndPoint" ms-type="f_strMSType" ci="oMS.strConferenceId" inbound="0" returns="f_nReturnCode" timeout="f_nTIMEOUT" connection-id="oMS.strConnectionId" ms-sdp="oMS.strContent" mgcp-call-id="oMS.strCallId" ingress-gateway="oCallLeg.strRequestUri" early-media="0" local="0" party-on-hold="0" packetization-period="oMS.nPacketizationPeriod" codec="f_strCodec" telephone-events="0" route="oCallLeg.strRoute" record-route="oCallLeg.strRecordRoute" contact="strContact" te="1" dc="f_bDTMFClampFlag" le="1" ig="" og="" ia="" oa="" iat="" oat="" ias="" oas="" tf="1" lf="1" session-expires="" min-se="" supported="" min-supported-session-timer="" refresher="" use-session-timer="0" conn-mode="send" to="oCallLeg.strFrom" call-id="oCallLeg.strCallId" cseq="oCallLeg.strCSeq" caller-sdp="oCallLeg.strContent" from="oCallLeg.strTo" via="" >
            <attributes mp="16" mt="3" ig="0" og="0" iat="-10" ias="-40" oat="-10" oas="-40" atn="3" att="2" ia="1" oa="1" te="1" le="1" tp="0" dc="f_bDTMFClampFlag" tc="1" ate="0" se="0"/>
          </add-member>
          <results >
            <result name="Default" link="5" stubbed="1"/>
            <result name="Success" link="18" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
            <result name="Resource Unavailable" link="17" stubbed="1"/>
            <result name="Caller Hung up" link="7" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2 && Result.id !=6)
{
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. CONFERENCE Id: " + Session.oMS.strConferenceId);
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. RETURN CODE IS: " + Session.f_nReturnCode);
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. EXIT ON BRANCH: " + Result.name);
	if (502 == Session.f_nReturnCode)
		Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE: EXCEED MAX FULL DUPLEX");
}]]></script>
          </scripts>
        </action>
        <action id="9" plug-in="Pactolus.CNFAddMember.1" ><?xtml-editor x=1146 y=425 ?>
          <!--mute only-->
          <add-member xmlns="urn:www.pactolus.com:xtml:conference" endpoint="oMS.strEndPoint" ms-type="f_strMSType" ci="oMS.strConferenceId" inbound="0" returns="f_nReturnCode" timeout="f_nTIMEOUT" connection-id="oMS.strConnectionId" ms-sdp="oMS.strContent" mgcp-call-id="oMS.strCallId" ingress-gateway="oCallLeg.strRequestUri" early-media="0" local="0" party-on-hold="0" packetization-period="oMS.nPacketizationPeriod" codec="f_strCodec" telephone-events="0" route="oCallLeg.strRoute" record-route="oCallLeg.strRecordRoute" contact="strContact" te="1" dc="f_bDTMFClampFlag" le="1" ig="" og="" ia="" oa="" iat="" oat="" ias="" oas="" tf="1" lf="1" session-expires="" min-se="" supported="" min-supported-session-timer="" refresher="" use-session-timer="0" conn-mode="receive" to="oCallLeg.strTo" call-id="oCallLeg.strCallId" cseq="oCallLeg.strCSeq" caller-sdp="oCallLeg.strContent" from="oCallLeg.strFrom" via="" >
            <attributes mp="16" mt="3" ig="0" og="0" iat="-10" ias="-40" oat="-10" oas="-40" atn="3" att="2" ia="1" oa="1" te="1" le="1" tp="0" dc="f_bDTMFClampFlag" tc="1" ate="0" se="0"/>
          </add-member>
          <results >
            <result name="Default" link="10" stubbed="1"/>
            <result name="Success" link="20" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout"/>
            <result name="Resource Unavailable" link="16" stubbed="1"/>
            <result name="Caller Hung up" link="12" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2 && Result.id !=6)
{
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. CONFERENCE Id: " + Session.oMS.strConferenceId);
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. RETURN CODE IS: " + Session.f_nReturnCode);
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. EXIT ON BRANCH: " + Result.name);
	if (502 == Session.f_nReturnCode)
		Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE: EXCEED MAX FULL DUPLEX");
}]]></script>
          </scripts>
        </action>
        <action id="10" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1771 y=285 ?>
          <!--f_nReturnCode-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nReturnCode"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (502 == Session.f_nReturnCode)
	Session.f_nReturnCode = Session.nExceedMaxFullDuplex;
else
	Session.f_nReturnCode = Session.f_nFAILURE;]]></script>
          </scripts>
        </action>
        <action id="11" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1767 y=433 ?>
          <!--f_nSUCCESS-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nSUCCESS"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("SUCCESS ADD MEMEMBER");
Session.oMS.bCurrentlyInConf = true;

if(Session.oMS.strType == "PCS") {
	Session.oMS.bCurrentlyConnected = true;
}

Server.logInfo("**** AFTER ADD MEMBER TO CONFERENCE ****");
Server.logInfo("oCallLeg.strFrom: " + Session.oCallLeg.strFrom);
Server.logInfo("oCallLeg.strTo: " + Session.oCallLeg.strTo);
Server.logInfo("oCallLeg.strContent: " + Session.oCallLeg.strContent);
Server.logInfo("oCallLeg.strCSeq: " + Session.oCallLeg.strCSeq);
Server.logInfo("oCallLeg.strCallId: " + Session.oCallLeg.strCallId);
Server.logInfo("oCallLeg.strRequestUri: " + Session.oCallLeg.strRequestUri);
Server.logInfo("oMS.strConferenceId: " + Session.oMS.strConferenceId);
Server.logInfo("oMS.strEndPoint: " + Session.oMS.strEndPoint);
Server.logInfo("oMS.strContent: " + Session.oMS.strContent);
Server.logInfo("oMS.strConnectionId: " + Session.oMS.strConnectionId);
Server.logInfo("oMS.strCallId: " + Session.oMS.strCallId);
Server.logInfo("oMS.strType: " + Session.oMS.strType);
Server.logInfo("oMS.bMuteFlag: " + Session.oMS.bMuteFlag);
Server.logInfo("oMS.bDeafFlag: " + Session.oMS.bDeafFlag);
Server.logInfo("oMS.bCurrentlyInConf: " + Session.oMS.bCurrentlyInConf);
Server.logInfo("oMS.bCurrentlyConnected: " + Session.oMS.bCurrentlyConnected);
Server.logInfo("oMS.bRetry: " + Session.oMS.bRetry);]]></script>
          </scripts>
        </action>
        <action id="12" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1419 y=602 ?>
          <!--f_nCALLERHUNGUP-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nCALLERHUNGUP"/>
        </action>
        <action id="13" plug-in="Pactolus.CNFAddMember.1" ><?xtml-editor x=1152 y=636 ?>
          <!--deaf only-->
          <add-member xmlns="urn:www.pactolus.com:xtml:conference" endpoint="oMS.strEndPoint" ms-type="f_strMSType" ci="oMS.strConferenceId" inbound="0" returns="f_nReturnCode" timeout="f_nTIMEOUT" connection-id="oMS.strConnectionId" ms-sdp="oMS.strContent" mgcp-call-id="oMS.strCallId" ingress-gateway="oCallLeg.strRequestUri" early-media="0" local="0" party-on-hold="0" packetization-period="oMS.nPacketizationPeriod" codec="f_strCodec" telephone-events="0" route="oCallLeg.strRoute" record-route="oCallLeg.strRecordRoute" contact="strContact" te="1" dc="f_bDTMFClampFlag" le="1" ig="" og="" ia="" oa="" iat="" oat="" ias="" oas="" tf="1" lf="1" session-expires="" min-se="" supported="" min-supported-session-timer="" refresher="" use-session-timer="0" conn-mode="send" to="oCallLeg.strTo" call-id="oCallLeg.strCallId" cseq="oCallLeg.strCSeq" caller-sdp="oCallLeg.strContent" from="oCallLeg.strFrom" via="" >
            <attributes mp="16" mt="3" ig="0" og="0" iat="-10" ias="-40" oat="-10" oas="-40" atn="3" att="2" ia="1" oa="1" te="1" le="1" tp="0" dc="f_bDTMFClampFlag" tc="1" ate="0" se="0"/>
          </add-member>
          <results >
            <result name="Default" link="10" stubbed="1"/>
            <result name="Success" link="20" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
            <result name="Resource Unavailable" link="16" stubbed="1"/>
            <result name="Caller Hung up" link="12" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2 && Result.id !=6)
{
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. CONFERENCE Id: " + Session.oMS.strConferenceId);
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. RETURN CODE IS: " + Session.f_nReturnCode);
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. EXIT ON BRANCH: " + Result.name);
	if (502 == Session.f_nReturnCode)
		Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE: EXCEED MAX FULL DUPLEX");
}]]></script>
          </scripts>
        </action>
        <action id="14" plug-in="Pactolus.CNFAddMember.1" ><?xtml-editor x=1140 y=223 ?>
          <!--talkable and listenable-->
          <add-member xmlns="urn:www.pactolus.com:xtml:conference" endpoint="oMS.strEndPoint" ms-type="f_strMSType" ci="oMS.strConferenceId" inbound="0" returns="f_nReturnCode" timeout="f_nTIMEOUT" connection-id="oMS.strConnectionId" ms-sdp="oMS.strContent" mgcp-call-id="oMS.strCallId" ingress-gateway="oCallLeg.strRequestUri" early-media="0" local="0" party-on-hold="0" packetization-period="oMS.nPacketizationPeriod" codec="f_strCodec" telephone-events="0" route="oCallLeg.strRoute" record-route="oCallLeg.strRecordRoute" contact="strContact" te="1" dc="f_bDTMFClampFlag" le="1" ig="" og="" ia="" oa="" iat="" oat="" ias="" oas="" tf="" lf="" session-expires="" min-se="" supported="" min-supported-session-timer="" refresher="" use-session-timer="0" conn-mode="conference" to="oCallLeg.strTo" call-id="oCallLeg.strCallId" cseq="oCallLeg.strCSeq" caller-sdp="oCallLeg.strContent" from="oCallLeg.strFrom" via="" >
            <attributes mp="16" mt="3" ig="0" og="0" iat="-10" ias="-40" oat="-10" oas="-40" atn="3" att="2" ia="1" oa="1" te="1" le="1" tp="0" dc="f_bDTMFClampFlag" tc="1" ate="0" se="0"/>
          </add-member>
          <results >
            <result name="Default" link="10" stubbed="1"/>
            <result name="Success" link="11" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
            <result name="Resource Unavailable" link="16" stubbed="0"/>
            <result name="Caller Hung up" link="12" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2 && Result.id !=6)
{
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. CONFERENCE Id: " + Session.oMS.strConferenceId);
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. RETURN CODE IS: " + Session.f_nReturnCode);
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. EXIT ON BRANCH: " + Result.name);
	if (502 == Session.f_nReturnCode)
		Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE: EXCEED MAX FULL DUPLEX");
}]]></script>
          </scripts>
        </action>
        <action id="15" plug-in="Pactolus.Branch.1" ><?xtml-editor x=836 y=366 ?>
          <!--oMS.bMuteFlag == true?-->
          <results >
            <result name="Default" link="14" stubbed="0"/>
            <result name="mute only" link="9" stubbed="0" >oMS.bMuteFlag == true
AND oMS.bDeafFlag == false</result>
            <result name="deaf only" link="13" stubbed="0" >oMS.bMuteFlag == false
AND oMS.bDeafFlag == true</result>
            <result name="mute and deaf" link="22" stubbed="0" >oMS.bMuteFlag == true
AND oMS.bDeafFlag == true</result>
          </results>
        </action>
        <action id="16" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1556 y=518 ?>
          <!--f_nReturnCode-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nReturnCode"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (502 == Session.f_nReturnCode)
	Session.f_nReturnCode = Session.nExceedMaxFullDuplex;
else
	Session.f_nReturnCode = Session.f_nFAILURE;]]></script>
          </scripts>
        </action>
        <action id="17" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1493 y=1163 ?>
          <!--f_nReturnCode-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nReturnCode"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (502 == Session.f_nReturnCode)
	Session.f_nReturnCode = Session.nExceedMaxFullDuplex;
else
	Session.f_nReturnCode = Session.f_nFAILURE;]]></script>
          </scripts>
        </action>
        <action id="18" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1424 y=1444 ?>
          <results >
            <result name="Default" link="6" stubbed="1"/>
            <result name="f_strMSType = PCS" link="19" stubbed="0" >f_strMSType match "PCS"</result>
          </results>
        </action>
        <action id="19" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1678 y=1441 ?>
          <!--ModifyConferenceMember-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ModifyConferenceMember&quot;" return="f_nReturnCode" external-function="0" library="" >
            <parameter >oMS</parameter>
          </function>
          <results >
            <result name="Default" link="6" stubbed="1"/>
            <result name="f_nReturnCode !=0" >f_nReturnCode != 0</result>
          </results>
        </action>
        <action id="20" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1430 y=711 ?>
          <results >
            <result name="Default" link="11" stubbed="1"/>
            <result name="f_strMSType = PCS" link="21" stubbed="0" >f_strMSType match "PCS"</result>
          </results>
        </action>
        <action id="21" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1667 y=705 ?>
          <!--ModifyConferenceMember-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ModifyConferenceMember&quot;" return="f_nReturnCode" external-function="0" library="" >
            <parameter >oMS</parameter>
          </function>
          <results >
            <result name="Default" link="11" stubbed="1"/>
            <result name="f_nReturnCode !=0" >f_nReturnCode != 0</result>
          </results>
        </action>
        <action id="22" plug-in="Pactolus.CNFAddMember.1" ><?xtml-editor x=1140 y=822 ?>
          <!--mute and deaf-->
          <add-member xmlns="urn:www.pactolus.com:xtml:conference" endpoint="oMS.strEndPoint" ms-type="f_strMSType" ci="oMS.strConferenceId" inbound="0" returns="f_nReturnCode" timeout="f_nTIMEOUT" connection-id="oMS.strConnectionId" ms-sdp="oMS.strContent" mgcp-call-id="oMS.strCallId" ingress-gateway="oCallLeg.strRequestUri" early-media="0" local="0" party-on-hold="0" packetization-period="oMS.nPacketizationPeriod" codec="f_strCodec" telephone-events="0" route="oCallLeg.strRoute" record-route="oCallLeg.strRecordRoute" contact="strContact" te="1" dc="f_bDTMFClampFlag" le="1" ig="" og="" ia="" oa="" iat="" oat="" ias="" oas="" tf="1" lf="1" session-expires="" min-se="" supported="" min-supported-session-timer="" refresher="" use-session-timer="0" conn-mode="send/receive" to="oCallLeg.strTo" call-id="oCallLeg.strCallId" cseq="oCallLeg.strCSeq" caller-sdp="oCallLeg.strContent" from="oCallLeg.strFrom" via="" >
            <attributes mp="16" mt="3" ig="0" og="0" iat="-10" ias="-40" oat="-10" oas="-40" atn="3" att="2" ia="1" oa="1" te="1" le="1" tp="0" dc="f_bDTMFClampFlag" tc="1" ate="0" se="0"/>
          </add-member>
          <results >
            <result name="Default" link="10" stubbed="1"/>
            <result name="Success" link="20" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout"/>
            <result name="Resource Unavailable" link="16" stubbed="1"/>
            <result name="Caller Hung up" link="12" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2 && Result.id !=6)
{
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. CONFERENCE Id: " + Session.oMS.strConferenceId);
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. RETURN CODE IS: " + Session.f_nReturnCode);
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. EXIT ON BRANCH: " + Result.name);
	if (502 == Session.f_nReturnCode)
		Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE: EXCEED MAX FULL DUPLEX");
}]]></script>
          </scripts>
        </action>
        <action id="23" plug-in="Pactolus.CNFAddMember.1" ><?xtml-editor x=1145 y=1629 ?>
          <!--mute and deaf-->
          <add-member xmlns="urn:www.pactolus.com:xtml:conference" endpoint="oMS.strEndPoint" ms-type="f_strMSType" ci="oMS.strConferenceId" inbound="0" returns="f_nReturnCode" timeout="f_nTIMEOUT" connection-id="oMS.strConnectionId" ms-sdp="oMS.strContent" mgcp-call-id="oMS.strCallId" ingress-gateway="oCallLeg.strRequestUri" early-media="0" local="0" party-on-hold="0" packetization-period="oMS.nPacketizationPeriod" codec="f_strCodec" telephone-events="0" route="oCallLeg.strRoute" record-route="oCallLeg.strRecordRoute" contact="strContact" te="1" dc="f_bDTMFClampFlag" le="1" ig="" og="" ia="" oa="" iat="" oat="" ias="" oas="" tf="1" lf="1" session-expires="" min-se="" supported="" min-supported-session-timer="" refresher="" use-session-timer="0" conn-mode="send/receive" to="oCallLeg.strFrom" call-id="oCallLeg.strCallId" cseq="oCallLeg.strCSeq" caller-sdp="oCallLeg.strContent" from="oCallLeg.strTo" via="" >
            <attributes mp="16" mt="3" ig="0" og="0" iat="-10" ias="-40" oat="-10" oas="-40" atn="3" att="2" ia="1" oa="1" te="1" le="1" tp="0" dc="f_bDTMFClampFlag" tc="1" ate="0" se="0"/>
          </add-member>
          <results >
            <result name="Default" link="5" stubbed="1"/>
            <result name="Success" link="18" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout"/>
            <result name="Resource Unavailable" link="17" stubbed="1"/>
            <result name="Caller Hung up" link="7" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2 && Result.id !=6)
{
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. CONFERENCE Id: " + Session.oMS.strConferenceId);
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. RETURN CODE IS: " + Session.f_nReturnCode);
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. EXIT ON BRANCH: " + Result.name);
	if (502 == Session.f_nReturnCode)
		Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE: EXCEED MAX FULL DUPLEX");
}]]></script>
          </scripts>
        </action>
        <action id="25" plug-in="Pactolus.CNFAddMember.1" ><?xtml-editor x=1148 y=2639 ?>
          <!--talkable and listenable-->
          <add-member xmlns="urn:www.pactolus.com:xtml:conference" endpoint="oMS.strEndPoint" ms-type="f_strMSType" ci="oMS.strConferenceId" inbound="0" returns="f_nReturnCode" timeout="f_nTIMEOUT" connection-id="oMS.strConnectionId" ms-sdp="oMS.strContent" mgcp-call-id="oMS.strCallId" ingress-gateway="oCallLeg.strRequestUri" early-media="0" local="0" party-on-hold="1" packetization-period="oMS.nPacketizationPeriod" codec="f_strCodec" telephone-events="0" route="oCallLeg.strRoute" record-route="oCallLeg.strRecordRoute" contact="strContact" te="1" dc="f_bDTMFClampFlag" le="1" ig="" og="" ia="1" oa="1" iat="nAGCTargetLevelIn" oat="nAGCTargetLevelOut" ias="nAGCMaxLevelIn" oas="nAGCMaxLevelOut" tf="2" lf="2" session-expires="" min-se="" supported="" min-supported-session-timer="" refresher="" use-session-timer="0" conn-mode="conference" to="oCallLeg.strFrom" call-id="oCallLeg.strCallId" cseq="oCallLeg.strCSeq" caller-sdp="oCallLeg.strContent" from="oCallLeg.strTo" via="" >
            <attributes mp="16" mt="3" ig="0" og="0" iat="nAGCTargetLevelIn" ias="nAGCMaxLevelIn" oat="nAGCTargetLevelOut" oas="nAGCMaxLevelOut" atn="3" att="2" ia="1" oa="1" te="1" le="1" tp="0" dc="f_bDTMFClampFlag" tc="1" ate="0" se="0"/>
          </add-member>
          <results >
            <result name="Default" link="28" stubbed="0"/>
            <result name="Success" link="29" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
            <result name="Resource Unavailable" link="41" stubbed="0"/>
            <result name="Caller Hung up" link="30" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2 && Result.id !=6)
{
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. CONFERENCE Id: " + Session.oMS.strConferenceId);
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. RETURN CODE IS: " + Session.f_nReturnCode);
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. EXIT ON BRANCH: " + Result.name);
	if (502 == Session.f_nReturnCode)
		Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE: EXCEED MAX FULL DUPLEX");
}]]></script>
          </scripts>
        </action>
        <action id="26" plug-in="Pactolus.Branch.1" ><?xtml-editor x=856 y=2782 ?>
          <!--oMS.bMuteFlag == true?-->
          <results >
            <result name="Default" link="25" stubbed="0"/>
            <result name="mute only" link="27" stubbed="0" >oMS.bMuteFlag == true
AND oMS.bDeafFlag == false</result>
            <result name="deaf only" link="31" stubbed="0" >oMS.bMuteFlag == false
AND oMS.bDeafFlag == true</result>
            <result name="mute and deaf" link="32" stubbed="0" >oMS.bMuteFlag == true
AND oMS.bDeafFlag == true</result>
          </results>
        </action>
        <action id="27" plug-in="Pactolus.CNFAddMember.1" ><?xtml-editor x=1154 y=2841 ?>
          <!--mute only-->
          <add-member xmlns="urn:www.pactolus.com:xtml:conference" endpoint="oMS.strEndPoint" ms-type="f_strMSType" ci="oMS.strConferenceId" inbound="0" returns="f_nReturnCode" timeout="f_nTIMEOUT" connection-id="oMS.strConnectionId" ms-sdp="oMS.strContent" mgcp-call-id="oMS.strCallId" ingress-gateway="oCallLeg.strRequestUri" early-media="0" local="0" party-on-hold="1" packetization-period="oMS.nPacketizationPeriod" codec="f_strCodec" telephone-events="0" route="oCallLeg.strRoute" record-route="oCallLeg.strRecordRoute" contact="strContact" te="1" dc="f_bDTMFClampFlag" le="1" ig="" og="" ia="1" oa="1" iat="nAGCTargetLevelIn" oat="nAGCTargetLevelOut" ias="nAGCMaxLevelIn" oas="nAGCMaxLevelOut" tf="2" lf="2" session-expires="" min-se="" supported="" min-supported-session-timer="" refresher="" use-session-timer="0" conn-mode="convedia listen only" to="oCallLeg.strFrom" call-id="oCallLeg.strCallId" cseq="oCallLeg.strCSeq" caller-sdp="oCallLeg.strContent" from="oCallLeg.strTo" via="" >
            <attributes mp="16" mt="3" ig="0" og="0" iat="nAGCTargetLevelIn" ias="nAGCMaxLevelIn" oat="nAGCTargetLevelOut" oas="nAGCMaxLevelOut" atn="3" att="2" ia="1" oa="1" te="1" le="1" tp="0" dc="f_bDTMFClampFlag" tc="1" ate="0" se="0"/>
          </add-member>
          <results >
            <result name="Default" link="28" stubbed="1"/>
            <result name="Success" link="42" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
            <result name="Resource Unavailable" link="41" stubbed="1"/>
            <result name="Caller Hung up" link="30" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2 && Result.id !=6)
{
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. CONFERENCE Id: " + Session.oMS.strConferenceId);
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. RETURN CODE IS: " + Session.f_nReturnCode);
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. EXIT ON BRANCH: " + Result.name);
	if (502 == Session.f_nReturnCode)
		Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE: EXCEED MAX FULL DUPLEX");
}]]></script>
          </scripts>
        </action>
        <action id="28" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1484 y=2626 ?>
          <!--f_nReturnCode-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nReturnCode"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (502 == Session.f_nReturnCode)
	Session.f_nReturnCode = Session.nExceedMaxFullDuplex;
else
	Session.f_nReturnCode = Session.f_nFAILURE;]]></script>
          </scripts>
        </action>
        <action id="29" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1718 y=2699 ?>
          <!--f_nSUCCESS-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nSUCCESS"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("SUCCESS ADD MEMBER");
Session.oMS.bCurrentlyInConf = true;

if(Session.oMS.strType == "PCS") {
	Session.oMS.bCurrentlyConnected = true;
}

Server.logInfo("**** AFTER ADD MEMBER TO CONFERENCE ****");
Server.logInfo("oCallLeg.strFrom: " + Session.oCallLeg.strFrom);
Server.logInfo("oCallLeg.strTo: " + Session.oCallLeg.strTo);
Server.logInfo("oCallLeg.strContent: " + Session.oCallLeg.strContent);
Server.logInfo("oCallLeg.strCSeq: " + Session.oCallLeg.strCSeq);
Server.logInfo("oCallLeg.strCallId: " + Session.oCallLeg.strCallId);
Server.logInfo("oCallLeg.strRequestUri: " + Session.oCallLeg.strRequestUri);
Server.logInfo("oMS.strConferenceId: " + Session.oMS.strConferenceId);
Server.logInfo("oMS.strEndPoint: " + Session.oMS.strEndPoint);
Server.logInfo("oMS.strContent: " + Session.oMS.strContent);
Server.logInfo("oMS.strConnectionId: " + Session.oMS.strConnectionId);
Server.logInfo("oMS.strCallId: " + Session.oMS.strCallId);
Server.logInfo("oMS.strType: " + Session.oMS.strType);
Server.logInfo("oMS.bMuteFlag: " + Session.oMS.bMuteFlag);
Server.logInfo("oMS.bDeafFlag: " + Session.oMS.bDeafFlag);
Server.logInfo("oMS.bCurrentlyInConf: " + Session.oMS.bCurrentlyInConf);
Server.logInfo("oMS.bCurrentlyConnected: " + Session.oMS.bCurrentlyConnected);
Server.logInfo("oMS.bRetry: " + Session.oMS.bRetry);]]></script>
          </scripts>
        </action>
        <action id="30" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1499 y=2865 ?>
          <!--f_nCALLERHUNGUP-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nCALLERHUNGUP"/>
        </action>
        <action id="31" plug-in="Pactolus.CNFAddMember.1" ><?xtml-editor x=1160 y=3052 ?>
          <!--deaf only-->
          <add-member xmlns="urn:www.pactolus.com:xtml:conference" endpoint="oMS.strEndPoint" ms-type="f_strMSType" ci="oMS.strConferenceId" inbound="0" returns="f_nReturnCode" timeout="f_nTIMEOUT" connection-id="oMS.strConnectionId" ms-sdp="oMS.strContent" mgcp-call-id="oMS.strCallId" ingress-gateway="oCallLeg.strRequestUri" early-media="0" local="0" party-on-hold="1" packetization-period="oMS.nPacketizationPeriod" codec="f_strCodec" telephone-events="0" route="oCallLeg.strRoute" record-route="oCallLeg.strRecordRoute" contact="strContact" te="1" dc="f_bDTMFClampFlag" le="1" ig="" og="" ia="1" oa="1" iat="nAGCTargetLevelIn" oat="nAGCTargetLevelOut" ias="nAGCMaxLevelIn" oas="nAGCMaxLevelOut" tf="2" lf="2" session-expires="" min-se="" supported="" min-supported-session-timer="" refresher="" use-session-timer="0" conn-mode="send" to="oCallLeg.strFrom" call-id="oCallLeg.strCallId" cseq="oCallLeg.strCSeq" caller-sdp="oCallLeg.strContent" from="oCallLeg.strTo" via="" >
            <attributes mp="16" mt="3" ig="0" og="0" iat="nAGCTargetLevelIn" ias="nAGCMaxLevelIn" oat="nAGCTargetLevelOut" oas="nAGCMaxLevelOut" atn="3" att="2" ia="1" oa="1" te="1" le="1" tp="0" dc="f_bDTMFClampFlag" tc="1" ate="0" se="0"/>
          </add-member>
          <results >
            <result name="Default" link="28" stubbed="1"/>
            <result name="Success" link="42" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
            <result name="Resource Unavailable" link="41" stubbed="1"/>
            <result name="Caller Hung up" link="30" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2 && Result.id !=6)
{
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. CONFERENCE Id: " + Session.oMS.strConferenceId);
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. RETURN CODE IS: " + Session.f_nReturnCode);
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. EXIT ON BRANCH: " + Result.name);
	if (502 == Session.f_nReturnCode)
		Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE: EXCEED MAX FULL DUPLEX");
}]]></script>
          </scripts>
        </action>
        <action id="32" plug-in="Pactolus.CNFAddMember.1" ><?xtml-editor x=1148 y=3238 ?>
          <!--mute and deaf-->
          <add-member xmlns="urn:www.pactolus.com:xtml:conference" endpoint="oMS.strEndPoint" ms-type="f_strMSType" ci="oMS.strConferenceId" inbound="0" returns="f_nReturnCode" timeout="f_nTIMEOUT" connection-id="oMS.strConnectionId" ms-sdp="oMS.strContent" mgcp-call-id="oMS.strCallId" ingress-gateway="oCallLeg.strRequestUri" early-media="0" local="0" party-on-hold="1" packetization-period="oMS.nPacketizationPeriod" codec="f_strCodec" telephone-events="0" route="oCallLeg.strRoute" record-route="oCallLeg.strRecordRoute" contact="strContact" te="1" dc="f_bDTMFClampFlag" le="1" ig="" og="" ia="1" oa="1" iat="nAGCTargetLevelIn" oat="nAGCTargetLevelOut" ias="nAGCMaxLevelIn" oas="nAGCMaxLevelOut" tf="2" lf="2" session-expires="" min-se="" supported="" min-supported-session-timer="" refresher="" use-session-timer="0" conn-mode="send/receive" to="oCallLeg.strFrom" call-id="oCallLeg.strCallId" cseq="oCallLeg.strCSeq" caller-sdp="oCallLeg.strContent" from="oCallLeg.strTo" via="" >
            <attributes mp="16" mt="3" ig="0" og="0" iat="nAGCTargetLevelIn" ias="nAGCMaxLevelIn" oat="nAGCTargetLevelOut" oas="nAGCMaxLevelOut" atn="3" att="2" ia="1" oa="1" te="1" le="1" tp="0" dc="f_bDTMFClampFlag" tc="1" ate="0" se="0"/>
          </add-member>
          <results >
            <result name="Default" link="28" stubbed="1"/>
            <result name="Success" link="42" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout"/>
            <result name="Resource Unavailable" link="41" stubbed="1"/>
            <result name="Caller Hung up" link="30" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2 && Result.id !=6)
{
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. CONFERENCE Id: " + Session.oMS.strConferenceId);
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. RETURN CODE IS: " + Session.f_nReturnCode);
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. EXIT ON BRANCH: " + Result.name);
	if (502 == Session.f_nReturnCode)
		Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE: EXCEED MAX FULL DUPLEX");
}]]></script>
          </scripts>
        </action>
        <action id="33" plug-in="Pactolus.CNFAddMember.1" ><?xtml-editor x=1145 y=2031 ?>
          <!--mute only-->
          <add-member xmlns="urn:www.pactolus.com:xtml:conference" endpoint="oMS.strEndPoint" ms-type="f_strMSType" ci="oMS.strConferenceId" inbound="0" returns="f_nReturnCode" timeout="f_nTIMEOUT" connection-id="oMS.strConnectionId" ms-sdp="oMS.strContent" mgcp-call-id="oMS.strCallId" ingress-gateway="oCallLeg.strRequestUri" early-media="0" local="0" party-on-hold="1" packetization-period="oMS.nPacketizationPeriod" codec="f_strCodec" telephone-events="0" route="oCallLeg.strRoute" record-route="oCallLeg.strRecordRoute" contact="strContact" te="1" dc="f_bDTMFClampFlag" le="1" ig="" og="" ia="1" oa="1" iat="nAGCTargetLevelIn" oat="nAGCTargetLevelOut" ias="nAGCMaxLevelIn" oas="nAGCMaxLevelOut" tf="2" lf="2" session-expires="" min-se="" supported="" min-supported-session-timer="" refresher="" use-session-timer="0" conn-mode="convedia listen only" to="oCallLeg.strTo" call-id="oCallLeg.strCallId" cseq="oCallLeg.strCSeq" caller-sdp="oCallLeg.strContent" from="oCallLeg.strFrom" via="" >
            <attributes mp="16" mt="3" ig="0" og="0" iat="nAGCTargetLevelIn" ias="nAGCMaxLevelIn" oat="nAGCTargetLevelOut" oas="nAGCMaxLevelOut" atn="3" att="2" ia="1" oa="1" te="1" le="1" tp="0" dc="f_bDTMFClampFlag" tc="1" ate="0" se="0"/>
          </add-member>
          <results >
            <result name="Default" link="34" stubbed="1"/>
            <result name="Success" link="44" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout"/>
            <result name="Resource Unavailable" link="40" stubbed="1"/>
            <result name="Caller Hung up" link="36" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2 && Result.id !=6)
{
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. CONFERENCE Id: " + Session.oMS.strConferenceId);
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. RETURN CODE IS: " + Session.f_nReturnCode);
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. EXIT ON BRANCH: " + Result.name);
	if (502 == Session.f_nReturnCode)
		Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE: EXCEED MAX FULL DUPLEX");
}]]></script>
          </scripts>
        </action>
        <action id="34" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1774 y=1894 ?>
          <!--f_nReturnCode-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nReturnCode"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (502 == Session.f_nReturnCode)
	Session.f_nReturnCode = Session.nExceedMaxFullDuplex;
else
	Session.f_nReturnCode = Session.f_nFAILURE;]]></script>
          </scripts>
        </action>
        <action id="35" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1770 y=2042 ?>
          <!--f_nSUCCESS-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nSUCCESS"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("SUCCESS ADD MEMEMBER");
Session.oMS.bCurrentlyInConf = true;

if(Session.oMS.strType == "PCS") {
	Session.oMS.bCurrentlyConnected = true;
}

Server.logInfo("**** AFTER ADD MEMBER TO CONFERENCE ****");
Server.logInfo("oCallLeg.strFrom: " + Session.oCallLeg.strFrom);
Server.logInfo("oCallLeg.strTo: " + Session.oCallLeg.strTo);
Server.logInfo("oCallLeg.strContent: " + Session.oCallLeg.strContent);
Server.logInfo("oCallLeg.strCSeq: " + Session.oCallLeg.strCSeq);
Server.logInfo("oCallLeg.strCallId: " + Session.oCallLeg.strCallId);
Server.logInfo("oCallLeg.strRequestUri: " + Session.oCallLeg.strRequestUri);
Server.logInfo("oMS.strConferenceId: " + Session.oMS.strConferenceId);
Server.logInfo("oMS.strEndPoint: " + Session.oMS.strEndPoint);
Server.logInfo("oMS.strContent: " + Session.oMS.strContent);
Server.logInfo("oMS.strConnectionId: " + Session.oMS.strConnectionId);
Server.logInfo("oMS.strCallId: " + Session.oMS.strCallId);
Server.logInfo("oMS.strType: " + Session.oMS.strType);
Server.logInfo("oMS.bMuteFlag: " + Session.oMS.bMuteFlag);
Server.logInfo("oMS.bDeafFlag: " + Session.oMS.bDeafFlag);
Server.logInfo("oMS.bCurrentlyInConf: " + Session.oMS.bCurrentlyInConf);
Server.logInfo("oMS.bCurrentlyConnected: " + Session.oMS.bCurrentlyConnected);
Server.logInfo("oMS.bRetry: " + Session.oMS.bRetry);]]></script>
          </scripts>
        </action>
        <action id="36" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1422 y=2211 ?>
          <!--f_nCALLERHUNGUP-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nCALLERHUNGUP"/>
        </action>
        <action id="37" plug-in="Pactolus.CNFAddMember.1" ><?xtml-editor x=1151 y=2242 ?>
          <!--deaf only-->
          <add-member xmlns="urn:www.pactolus.com:xtml:conference" endpoint="oMS.strEndPoint" ms-type="f_strMSType" ci="oMS.strConferenceId" inbound="0" returns="f_nReturnCode" timeout="f_nTIMEOUT" connection-id="oMS.strConnectionId" ms-sdp="oMS.strContent" mgcp-call-id="oMS.strCallId" ingress-gateway="oCallLeg.strRequestUri" early-media="0" local="0" party-on-hold="1" packetization-period="oMS.nPacketizationPeriod" codec="f_strCodec" telephone-events="0" route="oCallLeg.strRoute" record-route="oCallLeg.strRecordRoute" contact="strContact" te="1" dc="f_bDTMFClampFlag" le="1" ig="" og="" ia="1" oa="1" iat="nAGCTargetLevelIn" oat="nAGCTargetLevelOut" ias="nAGCMaxLevelIn" oas="nAGCMaxLevelOut" tf="2" lf="2" session-expires="" min-se="" supported="" min-supported-session-timer="" refresher="" use-session-timer="0" conn-mode="send" to="oCallLeg.strTo" call-id="oCallLeg.strCallId" cseq="oCallLeg.strCSeq" caller-sdp="oCallLeg.strContent" from="oCallLeg.strFrom" via="" >
            <attributes mp="16" mt="3" ig="0" og="0" iat="nAGCTargetLevelIn" ias="nAGCMaxLevelIn" oat="nAGCTargetLevelOut" oas="nAGCMaxLevelOut" atn="3" att="2" ia="1" oa="1" te="1" le="1" tp="0" dc="f_bDTMFClampFlag" tc="1" ate="0" se="0"/>
          </add-member>
          <results >
            <result name="Default" link="34" stubbed="1"/>
            <result name="Success" link="44" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
            <result name="Resource Unavailable" link="40" stubbed="1"/>
            <result name="Caller Hung up" link="36" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2 && Result.id !=6)
{
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. CONFERENCE Id: " + Session.oMS.strConferenceId);
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. RETURN CODE IS: " + Session.f_nReturnCode);
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. EXIT ON BRANCH: " + Result.name);
	if (502 == Session.f_nReturnCode)
		Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE: EXCEED MAX FULL DUPLEX");
}]]></script>
          </scripts>
        </action>
        <action id="38" plug-in="Pactolus.CNFAddMember.1" ><?xtml-editor x=1143 y=2431 ?>
          <!--mute and deaf-->
          <add-member xmlns="urn:www.pactolus.com:xtml:conference" endpoint="oMS.strEndPoint" ms-type="f_strMSType" ci="oMS.strConferenceId" inbound="0" returns="f_nReturnCode" timeout="f_nTIMEOUT" connection-id="oMS.strConnectionId" ms-sdp="oMS.strContent" mgcp-call-id="oMS.strCallId" ingress-gateway="oCallLeg.strRequestUri" early-media="0" local="0" party-on-hold="1" packetization-period="oMS.nPacketizationPeriod" codec="f_strCodec" telephone-events="0" route="oCallLeg.strRoute" record-route="oCallLeg.strRecordRoute" contact="strContact" te="1" dc="f_bDTMFClampFlag" le="1" ig="" og="" ia="1" oa="1" iat="nAGCTargetLevelIn" oat="nAGCTargetLevelOut" ias="nAGCMaxLevelIn" oas="nAGCMaxLevelOut" tf="2" lf="2" session-expires="" min-se="" supported="" min-supported-session-timer="" refresher="" use-session-timer="0" conn-mode="send/receive" to="oCallLeg.strTo" call-id="oCallLeg.strCallId" cseq="oCallLeg.strCSeq" caller-sdp="oCallLeg.strContent" from="oCallLeg.strFrom" via="" >
            <attributes mp="16" mt="3" ig="0" og="0" iat="nAGCTargetLevelIn" ias="nAGCMaxLevelIn" oat="nAGCTargetLevelOut" oas="nAGCMaxLevelOut" atn="3" att="2" ia="1" oa="1" te="1" le="1" tp="0" dc="f_bDTMFClampFlag" tc="1" ate="0" se="0"/>
          </add-member>
          <results >
            <result name="Default" link="34" stubbed="1"/>
            <result name="Success" link="44" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout"/>
            <result name="Resource Unavailable" link="40" stubbed="1"/>
            <result name="Caller Hung up" link="36" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2 && Result.id !=6)
{
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. CONFERENCE Id: " + Session.oMS.strConferenceId);
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. RETURN CODE IS: " + Session.f_nReturnCode);
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. EXIT ON BRANCH: " + Result.name);
	if (502 == Session.f_nReturnCode)
		Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE: EXCEED MAX FULL DUPLEX");
}]]></script>
          </scripts>
        </action>
        <action id="39" plug-in="Pactolus.Branch.1" ><?xtml-editor x=839 y=1975 ?>
          <!--oMS.bMuteFlag == true?-->
          <results >
            <result name="Default" link="46" stubbed="0"/>
            <result name="mute only" link="33" stubbed="0" >oMS.bMuteFlag == true
AND oMS.bDeafFlag == false</result>
            <result name="deaf only" link="37" stubbed="0" >oMS.bMuteFlag == false
AND oMS.bDeafFlag == true</result>
            <result name="mute and deaf" link="38" stubbed="0" >oMS.bMuteFlag == true
AND oMS.bDeafFlag == true</result>
          </results>
        </action>
        <action id="40" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1559 y=2127 ?>
          <!--f_nReturnCode-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nReturnCode"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (502 == Session.f_nReturnCode)
	Session.f_nReturnCode = Session.nExceedMaxFullDuplex;
else
	Session.f_nReturnCode = Session.f_nFAILURE;]]></script>
          </scripts>
        </action>
        <action id="41" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1496 y=2772 ?>
          <!--f_nReturnCode-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nReturnCode"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (502 == Session.f_nReturnCode)
	Session.f_nReturnCode = Session.nExceedMaxFullDuplex;
else
	Session.f_nReturnCode = Session.f_nFAILURE;]]></script>
          </scripts>
        </action>
        <action id="42" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1427 y=3053 ?>
          <results >
            <result name="Default" link="29" stubbed="1"/>
            <result name="f_strMSType = PCS" link="43" stubbed="0" >f_strMSType match "PCS"</result>
          </results>
        </action>
        <action id="43" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1668 y=3049 ?>
          <!--ModifyConferenceMember-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ModifyConferenceMember&quot;" return="f_nReturnCode" external-function="0" library="" >
            <parameter >oMS</parameter>
          </function>
          <results >
            <result name="Default" link="29" stubbed="1"/>
            <result name="f_nReturnCode !=0" >f_nReturnCode != 0</result>
          </results>
        </action>
        <action id="44" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1433 y=2320 ?>
          <results >
            <result name="Default" link="35" stubbed="1"/>
            <result name="f_strMSType = PCS" link="45" stubbed="0" >f_strMSType match "PCS"</result>
          </results>
        </action>
        <action id="45" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1689 y=2312 ?>
          <!--ModifyConferenceMember-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ModifyConferenceMember&quot;" return="f_nReturnCode" external-function="0" library="" >
            <parameter >oMS</parameter>
          </function>
          <results >
            <result name="Default" link="35" stubbed="1"/>
            <result name="f_nReturnCode !=0" >f_nReturnCode != 0</result>
          </results>
        </action>
        <action id="46" plug-in="Pactolus.CNFAddMember.1" ><?xtml-editor x=1143 y=1832 ?>
          <!--talkable and listenable-->
          <add-member xmlns="urn:www.pactolus.com:xtml:conference" endpoint="oMS.strEndPoint" ms-type="f_strMSType" ci="oMS.strConferenceId" inbound="0" returns="f_nReturnCode" timeout="f_nTIMEOUT" connection-id="oMS.strConnectionId" ms-sdp="oMS.strContent" mgcp-call-id="oMS.strCallId" ingress-gateway="oCallLeg.strRequestUri" early-media="0" local="0" party-on-hold="1" packetization-period="oMS.nPacketizationPeriod" codec="f_strCodec" telephone-events="0" route="oCallLeg.strRoute" record-route="oCallLeg.strRecordRoute" contact="strContact" te="1" dc="f_bDTMFClampFlag" le="1" ig="" og="" ia="1" oa="1" iat="nAGCTargetLevelIn" oat="nAGCTargetLevelOut" ias="nAGCMaxLevelIn" oas="nAGCMaxLevelOut" tf="2" lf="2" session-expires="" min-se="" supported="" min-supported-session-timer="" refresher="" use-session-timer="0" conn-mode="conference" to="oCallLeg.strTo" call-id="oCallLeg.strCallId" cseq="oCallLeg.strCSeq" caller-sdp="oCallLeg.strContent" from="oCallLeg.strFrom" via="" >
            <attributes mp="16" mt="3" ig="0" og="0" iat="nAGCTargetLevelIn" ias="nAGCMaxLevelIn" oat="nAGCTargetLevelOut" oas="nAGCMaxLevelOut" atn="3" att="2" ia="1" oa="1" te="1" le="1" tp="0" dc="f_bDTMFClampFlag" tc="1" ate="0" se="0"/>
          </add-member>
          <results >
            <result name="Default" link="34" stubbed="0"/>
            <result name="Success" link="35" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
            <result name="Resource Unavailable" link="40" stubbed="0"/>
            <result name="Caller Hung up" link="36" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2 && Result.id !=6)
{
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. CONFERENCE Id: " + Session.oMS.strConferenceId);
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. RETURN CODE IS: " + Session.f_nReturnCode);
	Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE. EXIT ON BRANCH: " + Result.name);
	if (502 == Session.f_nReturnCode)
		Server.logError("ERROR: FAIL TO ADD MEMBER TO CONFERENCE: EXCEED MAX FULL DUPLEX");
}]]></script>
          </scripts>
        </action>
        <action id="47" plug-in="Pactolus.Branch.1" ><?xtml-editor x=636 y=2326 ?>
          <!--dial in or dial out?
dial in reverse to and from-->
          <results >
            <result name="Default" link="39" stubbed="0"/>
            <result name="oCallLeg.bReverseFromTo = true;" link="26" stubbed="0" >oCallLeg.bReverseFromTo == true</result>
          </results>
        </action>
      </actions>
    </function>
    <function name="RecordToMS" start="1" event="" returns="i4" >
      <parameters >
        <parameter name="oMS" type="object" pass="byref"/>
        <parameter name="strLanguage" type="string" pass="byref"/>
        <parameter name="strNameUrl" type="string" pass="byref"/>
        <parameter name="strConfResource" type="string" pass="byref"/>
      </parameters>
      <local-vars >
        <var name="oMSConf" type="object" ></var>
        <var name="oMSSub" type="object" ></var>
        <var name="nReturnValue" type="i4" >0</var>
        <var name="nTimeout" type="i4" >10</var>
        <var name="nRecordLength" type="i4" >0</var>
        <var name="strCodec" type="string" ></var>
      </local-vars>
      <actions >
        <action id="1" plug-in="Pactolus.MGCPCreate.1" ><?xtml-editor x=20 y=131 ?>
          <!--CRCX inactive on c1-->
          <crcx xmlns="urn:www.pactolus.com:xtml:media" callid="oMSSub.strCallId" remote-sdp="" mode="inactive" capability="2" returns="nReturnValue" endpoint="oMSSub.strEndPoint" connection-id="oMSSub.strConnectionId" local-sdp="oMSSub.strContent" packetization-period="oMS.nPacketizationPeriod" codec="strCodec" timeout="nTimeout" local-connection-options="" second-endpoint-id="" telephone-events="0" ms-type="oMS.strType" >
            <parameters >
              <quarantine step="0" loop="0" process="0" discard="0"/>
              <events ><![CDATA[]]></events>
              <signals ><![CDATA[]]></signals>
              <digit-map ><![CDATA[]]></digit-map>
            </parameters>
          </crcx>
          <results >
            <result name="Default" link="6" stubbed="1"/>
            <result name="Success" link="2" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (0 == Session.oMS.strCodec.length ||  undefined == Session.oMS.strCodec)
{
	Session.strCodec = "PCMU";
}
else
{
	Session.strCodec = Session.oMS.strCodec;	
}
Server.logInfo("f_strCodec is: " + Session.strCodec);

//Need to build the endpoint name with the correct media server, and a wild card endpoint.
// ms/cnf/?@cms1000b.pactolus.com; ms/cnf/934@wx-dnms-04.pactolus.com
var i = Session.oMS.strEndPoint.toString().indexOf("cnf/");
var j = Session.oMS.strEndPoint.toString().indexOf("@");
var start = Session.oMS.strEndPoint.toString().substring(0, (i + 4));
var end = Session.oMS.strEndPoint.toString().substr(j);
Session.oMSSub.strEndPoint = start + "$" + end;
Server.logInfo("Attempting the create connection for C1 with wild card endpoint: " + Session.oMSSub.strEndPoint);]]></script>
            <script language="javascript" timing="last" ><![CDATA[if ( 2 == Result.id ) {
	Server.logInfo("CREATED CONNECTION 1");
	Server.logInfo("C1 Call Id: " + Session.oMSSub.strCallId);
	Server.logInfo("C1 Connection Id: " + Session.oMSSub.strConnectionId);
	Server.logInfo("C1 Endpoint Id: " + Session.oMSSub.strEndPoint);
	Server.logInfo("C1 Content: " + Session.oMSSub.strContent);
}
else {
	Server.logError("Failed to Create C1 Connection. Return Value: " + Session.nReturnValue);
}]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Pactolus.MGCPCreate.1" ><?xtml-editor x=321 y=126 ?>
          <!--CRCX conf on c2 with sdp of c1-->
          <crcx xmlns="urn:www.pactolus.com:xtml:media" callid="oMSConf.strCallId" remote-sdp="oMSSub.strContent" mode="conference" capability="2" returns="nReturnValue" endpoint="oMSConf.strEndPoint" connection-id="oMSConf.strConnectionId" local-sdp="oMSConf.strContent" packetization-period="oMS.nPacketizationPeriod" codec="strCodec" timeout="nTimeout" local-connection-options="" second-endpoint-id="" telephone-events="0" ms-type="oMS.strType" >
            <parameters >
              <quarantine step="0" loop="0" process="0" discard="0"/>
              <events ><![CDATA[]]></events>
              <signals ><![CDATA[]]></signals>
              <digit-map ><![CDATA[]]></digit-map>
            </parameters>
          </crcx>
          <results >
            <result name="Default" link="7" stubbed="1"/>
            <result name="Success" link="3" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[//Need to build the endpoint name with the correct media server, and a wild card endpoint.
// ms/cnf/?@cms1000b.pactolus.com; ms/cnf/934@wx-dnms-04.pactolus.com
var i = Session.strConfResource.indexOf("cnf/");
var j = Session.strConfResource.indexOf("@");
var start = Session.strConfResource.substring(0, (i + 4));
var end = Session.strConfResource.substr(j);
Session.oMSConf.strEndPoint = start + "$" + end;
Server.logInfo("Attempting the create connection for C2 with wild card endpoint: " + Session.oMSConf.strEndPoint);]]></script>
            <script language="javascript" timing="last" ><![CDATA[if ( 2 == Result.id ) {
	Server.logInfo("CREATED CONNECTION 2");
	Server.logInfo("C2 Call Id: " + Session.oMSConf.strCallId);
	Server.logInfo("C2 Connection Id: " + Session.oMSConf.strConnectionId);
	Server.logInfo("C2 Endpoint Id: " + Session.oMSConf.strEndPoint);
	Server.logInfo("C2 Content: " + Session.oMSConf.strContent);
}
else {
	Server.logError("Failed to Create C2 Connection. Return Value: " + Session.nReturnValue);
}]]></script>
          </scripts>
        </action>
        <action id="3" plug-in="Pactolus.MGCPModify.1" ><?xtml-editor x=645 y=123 ?>
          <!--mdcx c1 and c2 together-->
          <mdcx xmlns="urn:www.pactolus.com:xtml:media" connection-id="oMSSub.strConnectionId" endpoint="oMSSub.strEndPoint" callid="oMSSub.strCallId" returns="nReturnValue" remote-sdp="oMSConf.strContent" mode="conference" packetization-period="oMS.nPacketizationPeriod" codec="strCodec" timeout="nTimeout" local-connection-options="" second-endpoint-id="" ms-type="oMS.strType" >
            <parameters >
              <quarantine step="0" loop="0" process="0" discard="0"/>
              <events ><![CDATA[]]></events>
              <signals ><![CDATA[]]></signals>
              <digit-map ><![CDATA[]]></digit-map>
            </parameters>
          </mdcx>
          <results >
            <result name="Default" link="8" stubbed="0"/>
            <result name="Success" link="5" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if ( 2 != Result.id ) { 
	Server.logError("Failed to MDCX C1 to C2. Return Value: " + Session.nReturnValue);
}]]></script>
          </scripts>
        </action>
        <action id="4" plug-in="Pactolus.MGCPRecord.1" ><?xtml-editor x=541 y=373 ?>
          <!--record on c2-->
          <record xmlns="urn:www.pactolus.com:xtml:media" op-mode="0" connection-id="oMSConf.strConnectionId" endpoint="oMSConf.strEndPoint" callid="oMSConf.strCallId" timeout="nTimeout" returns="nReturnValue" return-immediate="0" ms-type="oMS.strType" rid="strNameUrl" eik="" rlt="600" prt="50" pst="40" rl="nRecordLength" dc="" rc="nReturnValue" id-cleanup="1" play-beep="0" ef="&quot;PCM8M16&quot;" agc="0" agcta="" ga="" sla="" bpf="" bpa="" bpd=""/>
          <results >
            <result name="Default" link="8" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
            <result name="No Speech Detected"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("Starting record of caller name on endpoint: " + Session.oMSConf.strEndPoint);

Session.strNameUrl = "";]]></script>
            <script language="javascript" timing="last" ><![CDATA[if ( 2 == Result.id ) {
	Session.nReturnValue = 0;
	Server.logInfo("Recording of name succeeded. New recording id: " + Session.strNameUrl);
}
else {
	Server.logError("Failed to record prompt to conference ms. Return Value: " + Session.nReturnValue);
}]]></script>
          </scripts>
        </action>
        <action id="5" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=247 y=381 ?>
          <!--play on c1-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="oMSSub.strConnectionId" endpoint="oMSSub.strEndPoint" callid="oMSSub.strCallId" repeat="1" timeout="nTimeout" ms-type="oMS.strType" returns="nReturnValue" start-play="1" interrupt="0" return-immediate="1" digit-map="" language="strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="silence" >.5</audio>
            <audio type="url" >strNameUrl</audio>
            <audio type="silence" >.5</audio>
          </play>
          <results >
            <result name="Default" link="8" stubbed="1"/>
            <result name="Success" link="4" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("Starting Play of Name Recording on EndPoint: " + Session.oMSSub.strEndPoint);]]></script>
          </scripts>
        </action>
        <action id="6" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1181 y=99 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value="nReturnValue"/>
        </action>
        <action id="7" plug-in="Pactolus.MGCPDelete.1" ><?xtml-editor x=939 y=20 ?>
          <!--delete C1-->
          <dlcx xmlns="urn:www.pactolus.com:xtml:media" connection-id="oMSSub.strConnectionId" endpoint="oMSSub.strEndPoint" callid="oMSSub.strCallId" timeout="4" returns="nReturnValue" ms-type="oMS.strType" >
            <parameters >
              <quarantine step="0" loop="0" process="0" discard="0"/>
              <events ><![CDATA[]]></events>
              <signals ><![CDATA[]]></signals>
              <digit-map ><![CDATA[]]></digit-map>
            </parameters>
          </dlcx>
          <results >
            <result name="Default" link="6" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="8" plug-in="Pactolus.MGCPDelete.1" ><?xtml-editor x=941 y=199 ?>
          <!--delete C2-->
          <dlcx xmlns="urn:www.pactolus.com:xtml:media" connection-id="oMSConf.strConnectionId" endpoint="oMSConf.strEndPoint" callid="oMSConf.strCallId" timeout="4" returns="nReturnValue" ms-type="oMS.strType" >
            <parameters >
              <quarantine step="0" loop="0" process="0" discard="0"/>
              <events ><![CDATA[]]></events>
              <signals ><![CDATA[]]></signals>
              <digit-map ><![CDATA[]]></digit-map>
            </parameters>
          </dlcx>
          <results >
            <result name="Default" link="7" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
      </actions>
    </function>
    <function name="ConnectWithOneWayMedia" start="1" event="" returns="i4" >
      <parameters >
        <parameter name="oCallLeg" type="object" pass="byref"/>
        <parameter name="oMS" type="object" pass="byref"/>
        <parameter name="nPromptId" type="i4" pass="byref"/>
        <parameter name="strContact" type="string" pass="byref"/>
        <parameter name="strLanguage" type="string" pass="byref"/>
      </parameters>
      <local-vars >
        <var name="f_nReturnCode" type="i4" >0</var>
        <var name="f_nFAILURE" type="i4" >-1</var>
        <var name="f_nSUCCESS" type="i4" >0</var>
        <var name="f_nTimeout" type="float" >20</var>
      </local-vars>
      <actions >
        <action id="1" plug-in="Pactolus.MGCPCreate.1" ><?xtml-editor x=55 y=48 ?>
          <!--create endpoint-->
          <crcx xmlns="urn:www.pactolus.com:xtml:media" callid="oMS.strCallId" remote-sdp="oCallLeg.strRemoteSdp" mode="send/receive" capability="2" returns="f_nReturnCode" endpoint="oMS.strEndPoint" connection-id="oMS.strConnectionId" local-sdp="oMS.strContent" packetization-period="oMS.nPacketizationPeriod" codec="-1" timeout="f_nTimeout" local-connection-options="" second-endpoint-id="" telephone-events="1" ms-type="oMS.strType" >
            <parameters >
              <quarantine step="0" loop="0" process="0" discard="0"/>
              <events ><![CDATA[]]></events>
              <signals ><![CDATA[]]></signals>
              <digit-map ><![CDATA[]]></digit-map>
            </parameters>
          </crcx>
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="Success" link="3" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("SET UP ONE WAY MEDIA");]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)
	Server.logError("FAIL TO CREATE MS CONNECTION");
else
{
	Server.logInfo("SUCCESS CREATE MS CONNECTION");
}]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=373 y=20 ?>
          <!--nFAILURE-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nFAILURE"/>
        </action>
        <action id="3" plug-in="Pactolus.SipResponse.1" ><?xtml-editor x=384 y=208 ?>
          <!--183 session in progress-->
          <sip-response xmlns="urn:www.pactolus.com:xtml:sip" remove-via="0" reliable="0" increment-cseq-first="0" increment-cseq-last="0" >
            <call-id >oCallLeg.strCallId</call-id>
            <contact >strContact</contact>
            <content >oMS.strContent</content>
            <content-type >"application/sdp"</content-type>
            <cseq >oCallLeg.strCSeq</cseq>
            <from >oCallLeg.strFrom</from>
            <status >"SIP/2.0 183 Session Progress"</status>
            <to >oCallLeg.strTo</to>
            <via >oCallLeg.strVia</via>
          </sip-response>
          <results >
            <result name="Default" link="4" stubbed="0"/>
            <result name="Success" link="5" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)
	Server.logError("FAIL TO RESPONSE 183");]]></script>
          </scripts>
        </action>
        <action id="4" plug-in="Pactolus.MGCPDelete.1" ><?xtml-editor x=663 y=147 ?>
          <dlcx xmlns="urn:www.pactolus.com:xtml:media" connection-id="oMS.strConnectionId" endpoint="oMS.strEndPoint" callid="oMS.strCallId" timeout="f_nTimeout" returns="" ms-type="oMS.strType" >
            <parameters >
              <quarantine step="0" loop="0" process="0" discard="0"/>
              <events ><![CDATA[]]></events>
              <signals ><![CDATA[]]></signals>
              <digit-map ><![CDATA[]]></digit-map>
            </parameters>
          </dlcx>
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)
	Server.logError("FAIL TO DLCX MS CONNECTION");
]]></script>
          </scripts>
        </action>
        <action id="5" plug-in="Pactolus.Sleep.1" ><?xtml-editor x=682 y=329 ?>
          <!--2 secs-->
          <sleep xmlns="urn:www.pactolus.com:xtml:application" duration="2"/>
          <results >
            <result name="Default" link="11" stubbed="0"/>
          </results>
        </action>
        <action id="6" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=836 y=670 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nSUCCESS"/>
        </action>
        <action id="7" plug-in="Pactolus.Sleep.1" ><?xtml-editor x=692 y=484 ?>
          <!--4 secs-->
          <sleep xmlns="urn:www.pactolus.com:xtml:application" duration="4"/>
          <results >
            <result name="Default" link="6" stubbed="0"/>
          </results>
        </action>
        <action id="8" plug-in="Pactolus.SipResponse.1" ><?xtml-editor x=310 y=435 ?>
          <!--500 Server Internal Error-->
          <sip-response xmlns="urn:www.pactolus.com:xtml:sip" remove-via="0" reliable="0" increment-cseq-first="0" increment-cseq-last="0" >
            <call-id >oCallLeg.strCallId</call-id>
            <contact >strContact</contact>
            <cseq >oCallLeg.strCSeq</cseq>
            <from >oCallLeg.strFrom</from>
            <status >"SIP/2.0 500 Server Internal Error"</status>
            <to >oCallLeg.strTo</to>
            <via >oCallLeg.strVia</via>
          </sip-response>
          <results >
            <result name="Default" link="4" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="9" plug-in="Pactolus.SipResponse.1" ><?xtml-editor x=310 y=601 ?>
          <!--488 Not Acceptable-->
          <sip-response xmlns="urn:www.pactolus.com:xtml:sip" remove-via="0" reliable="0" increment-cseq-first="0" increment-cseq-last="0" >
            <call-id >oCallLeg.strCallId</call-id>
            <contact >strContact</contact>
            <cseq >oCallLeg.strCSeq</cseq>
            <from >oCallLeg.strFrom</from>
            <status >"SIP/2.0 488 Not Acceptable"</status>
            <to >oCallLeg.strTo</to>
            <via >oCallLeg.strVia</via>
          </sip-response>
          <results >
            <result name="Default" link="4" stubbed="1"/>
            <result name="Success" link="10" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="10" plug-in="Pactolus.MGCPDelete.1" ><?xtml-editor x=546 y=615 ?>
          <dlcx xmlns="urn:www.pactolus.com:xtml:media" connection-id="oMS.strConnectionId" endpoint="oMS.strEndPoint" callid="oMS.strCallId" timeout="f_nTimeout" returns="" ms-type="oMS.strType" >
            <parameters >
              <quarantine step="0" loop="0" process="0" discard="0"/>
              <events ><![CDATA[]]></events>
              <signals ><![CDATA[]]></signals>
              <digit-map ><![CDATA[]]></digit-map>
            </parameters>
          </dlcx>
          <results >
            <result name="Default" link="7" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)
	Server.logError("FAIL TO DLCX MS CONNECTION");
]]></script>
          </scripts>
        </action>
        <action id="11" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=20 y=455 ?>
          <!--PlayOnePrompt-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;PlayOnePrompt&quot;" return="f_nReturnCode" external-function="0" library="" >
            <parameter >oMS</parameter>
            <parameter >strLanguage</parameter>
            <parameter >nPromptId</parameter>
          </function>
          <results >
            <result name="Default" link="9" stubbed="0"/>
            <result name="-1" link="8" stubbed="0" >f_nReturnCode == -1</result>
          </results>
        </action>
      </actions>
    </function>
    <function name="ConnectWithAnswer" start="1" event="" returns="i4" >
      <parameters >
        <parameter name="oCallLeg" type="object" pass="byref"/>
        <parameter name="oMS" type="object" pass="byref"/>
        <parameter name="nPromptId" type="i4" pass="byref"/>
        <parameter name="strContact" type="string" pass="byref"/>
        <parameter name="strLanguage" type="string" pass="byref"/>
      </parameters>
      <local-vars >
        <var name="f_nTimeout" type="float" >20</var>
        <var name="f_nFAILURE" type="i4" >-1</var>
        <var name="f_nReturnCode" type="float" >0</var>
        <var name="f_nSUCCESS" type="i4" >0</var>
      </local-vars>
      <actions >
        <action id="1" plug-in="Pactolus.MGCPCreate.1" ><?xtml-editor x=55 y=48 ?>
          <!--create endpoint-->
          <crcx xmlns="urn:www.pactolus.com:xtml:media" callid="oMS.strCallId" remote-sdp="oCallLeg.strRemoteSdp" mode="send/receive" capability="2" returns="f_nReturnCode" endpoint="oMS.strEndPoint" connection-id="oMS.strConnectionId" local-sdp="oMS.strContent" packetization-period="oMS.nPacketizationPeriod" codec="-1" timeout="f_nTimeout" local-connection-options="" second-endpoint-id="" telephone-events="1" ms-type="oMS.strType" >
            <parameters >
              <quarantine step="0" loop="0" process="0" discard="0"/>
              <events ><![CDATA[]]></events>
              <signals ><![CDATA[]]></signals>
              <digit-map ><![CDATA[]]></digit-map>
            </parameters>
          </crcx>
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="Success" link="3" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("SET UP ONE WAY MEDIA");]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)
	Server.logError("FAIL TO CREATE MS CONNECTION");
else
{
	Server.logInfo("SUCCESS CREATE MS CONNECTION");
}]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=373 y=20 ?>
          <!--nFAILURE-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nFAILURE"/>
        </action>
        <action id="3" plug-in="Pactolus.SipResponse.1" ><?xtml-editor x=384 y=208 ?>
          <!--200 ok Answer-->
          <sip-response xmlns="urn:www.pactolus.com:xtml:sip" remove-via="0" reliable="0" increment-cseq-first="0" increment-cseq-last="0" >
            <call-id >oCallLeg.strCallId</call-id>
            <contact >strContact</contact>
            <content >oMS.strContent</content>
            <content-type >"application/sdp"</content-type>
            <cseq >oCallLeg.strCSeq</cseq>
            <from >oCallLeg.strFrom</from>
            <status >"SIP/2.0 200 OK"</status>
            <to >oCallLeg.strTo</to>
            <via >oCallLeg.strVia</via>
          </sip-response>
          <results >
            <result name="Default" link="4" stubbed="0"/>
            <result name="Success" link="5" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)
	Server.logError("FAIL TO RESPONSE 183");]]></script>
          </scripts>
        </action>
        <action id="4" plug-in="Pactolus.MGCPDelete.1" ><?xtml-editor x=663 y=147 ?>
          <dlcx xmlns="urn:www.pactolus.com:xtml:media" connection-id="oMS.strConnectionId" endpoint="oMS.strEndPoint" callid="oMS.strCallId" timeout="f_nTimeout" returns="" ms-type="oMS.strType" >
            <parameters >
              <quarantine step="0" loop="0" process="0" discard="0"/>
              <events ><![CDATA[]]></events>
              <signals ><![CDATA[]]></signals>
              <digit-map ><![CDATA[]]></digit-map>
            </parameters>
          </dlcx>
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)
	Server.logError("FAIL TO DLCX MS CONNECTION");
]]></script>
          </scripts>
        </action>
        <action id="5" plug-in="Pactolus.Sleep.1" ><?xtml-editor x=682 y=329 ?>
          <!--2 secs-->
          <sleep xmlns="urn:www.pactolus.com:xtml:application" duration="2"/>
          <results >
            <result name="Default" link="11" stubbed="0"/>
          </results>
        </action>
        <action id="6" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=836 y=670 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nSUCCESS"/>
        </action>
        <action id="7" plug-in="Pactolus.Sleep.1" ><?xtml-editor x=692 y=484 ?>
          <!--4 secs-->
          <sleep xmlns="urn:www.pactolus.com:xtml:application" duration="4"/>
          <results >
            <result name="Default" link="6" stubbed="0"/>
          </results>
        </action>
        <action id="10" plug-in="Pactolus.MGCPDelete.1" ><?xtml-editor x=546 y=615 ?>
          <dlcx xmlns="urn:www.pactolus.com:xtml:media" connection-id="oMS.strConnectionId" endpoint="oMS.strEndPoint" callid="oMS.strCallId" timeout="f_nTimeout" returns="" ms-type="oMS.strType" >
            <parameters >
              <quarantine step="0" loop="0" process="0" discard="0"/>
              <events ><![CDATA[]]></events>
              <signals ><![CDATA[]]></signals>
              <digit-map ><![CDATA[]]></digit-map>
            </parameters>
          </dlcx>
          <results >
            <result name="Default" link="7" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)
	Server.logError("FAIL TO DLCX MS CONNECTION");
]]></script>
          </scripts>
        </action>
        <action id="11" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=20 y=455 ?>
          <!--PlayOnePrompt-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;PlayOnePrompt&quot;" return="f_nReturnCode" external-function="0" library="" >
            <parameter >oMS</parameter>
            <parameter >strLanguage</parameter>
            <parameter >nPromptId</parameter>
          </function>
          <results >
            <result name="Default" link="12" stubbed="0"/>
            <result name="-1" link="12" stubbed="0" >f_nReturnCode == -1</result>
          </results>
        </action>
        <action id="12" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=174 y=672 ?>
          <!--Hangup the Call-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpParty&quot;" return="" external-function="1" library="lib_callcontrol.xml" >
            <parameter >oCallLeg</parameter>
            <parameter >strContact</parameter>
          </function>
          <results >
            <result name="Default" link="10" stubbed="0"/>
            <result name="-1" link="2" stubbed="0"/>
          </results>
        </action>
      </actions>
    </function>
    <function name="PlayBrandingPromptNoBarge" start="1" event="PlayBrandingPrompt" returns="i4" >
      <parameters >
        <parameter name="oMS" type="object" pass="byref"/>
        <parameter name="strLanguage" type="string" pass="byref"/>
        <parameter name="strPromptType" type="string" pass="byref"/>
        <parameter name="nPromptIndex" type="i4" pass="byref"/>
        <parameter name="strPromptUrl" type="string" pass="byref"/>
      </parameters>
      <local-vars >
        <var name="bHaveIndexPrompt" type="boolean" >0</var>
        <var name="bHaveUrlPrompt" type="boolean" >0</var>
        <var name="nReturnValue" type="i4" >0</var>
      </local-vars>
      <actions >
        <action id="1" plug-in="Pactolus.Branch.1" ><?xtml-editor x=40 y=102 ?>
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="index prompt" link="3" stubbed="0" >bHaveIndexPrompt == true</result>
            <result name="url prompt" link="4" stubbed="0" >bHaveUrlPrompt == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("*****PLAYING BRANDING PROMPT*****") ;
Server.logInfo("Language: " + Session.strLanguage) ;
Server.logInfo("Prompt Type: " + Session.strPromptType) ;

if ( 0 != Session.nPromptIndex ) {
	Session.bHaveIndexPrompt = true ;
	Server.logInfo("Prompt Index:" + Session.nPromptIndex) ;
}
else if ( 0 != Session.strPromptUrl.length ) {
		Session.bHaveUrlPrompt = true ;
		Server.logInfo("Prompt URL: " + Session.strPromptUrl) ;
}
else {
	Server.logInfo("NO PROMPT RECEIVED") ;
	Session.nReturnValue = -1
}

]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=524 y=71 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value="0"/>
        </action>
        <action id="3" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=317 y=176 ?>
          <!--play index prompt-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="oMS.strConnectionId" endpoint="oMS.strEndPoint" callid="oMS.strCallId" repeat="1" timeout="120" ms-type="oMS.strType" returns="nReturnValue" start-play="1" interrupt="0" return-immediate="0" digit-map="" language="strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >nPromptIndex</audio>
          </play>
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="4" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=324 y=334 ?>
          <!--play url prompt-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="oMS.strConnectionId" endpoint="oMS.strEndPoint" callid="oMS.strCallId" repeat="1" timeout="120" ms-type="oMS.strType" returns="nReturnValue" start-play="1" interrupt="0" return-immediate="0" digit-map="" language="strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="url" >strPromptUrl</audio>
          </play>
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
      </actions>
    </function>
  </functions>
  <properties >
    <property key="disable-logging" value="0"/>
    <property key="js-include-path" value="C:/builds/HEAD/Applications/InternalProduct/SceXMLScripts/Libs"/>
    <property key="library-modules" value="lib_callcontrol.xml"/>
    <property key="library-path" value="C:/builds/HEAD/Applications/InternalProduct/SceXMLScripts/Libs"/>
  </properties>
  <application-version >
    <revision >$Id: lib_mediaserver.xml,v 1.139 2008/09/22 21:04:28 wcasazza Exp $</revision>
    <label >$Name: PCS-A-4-1-1-1-4-c6 $</label>
  </application-version>
</xtml>
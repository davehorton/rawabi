<?xml version="1.0"?>
<xtml version="1.0" xmlns="urn:www.pactolus.com:xtml" >
  <version sce-version="500a2" prev-sce-version="500a2" last-mod-time="Tuesday, January 29, 2008 15:31:52"/>
  <events >
    <event name="IVRConfAddPartyRequest" display="IVRConfAddPartyRequest" >
      <parameter name="strCallingNumber" type="string"/>
      <parameter name="strCalledNumber" type="string"/>
      <parameter name="strEndPoint" type="string"/>
      <parameter name="strSessionId" type="string"/>
      <parameter name="lServiceProviderId" type="i8"/>
      <parameter name="strConfPassCode" type="string"/>
      <parameter name="nDialPlanId" type="i4"/>
      <parameter name="strAccessNumber" type="string"/>
      <parameter name="nDestCountryId" type="i4"/>
      <parameter name="strDestDomIntlFlag" type="string"/>
      <parameter name="strDestAreaCode" type="string"/>
      <parameter name="strDestCallingCountryCode" type="string"/>
    </event>
    <event name="IVRConfBridgePartyRequest" display="IVRConfBridgePartyRequest" >
      <parameter name="strMSEndPoint" type="string"/>
    </event>
    <event name="IVRConfRemovePartyRequest" display="IVRConfRemovePartyRequest"/>
    <event name="ConfHoldPartyRequest" display="ConfHoldPartyRequest" >
      <parameter name="strConfControllerIpAddress" type="string"/>
      <parameter name="nConfControllerPort" type="i4"/>
      <parameter name="strTransactionId" type="string"/>
    </event>
    <event name="ConfOffholdPartyRequest" display="ConfOffholdPartyRequest" >
      <parameter name="strConfControllerIpAddress" type="string"/>
      <parameter name="nConfControllerPort" type="i4"/>
      <parameter name="strTransactionId" type="string"/>
    </event>
    <event name="ConfPlayPromptRequest" display="ConfPlayPromptRequest" >
      <parameter name="strHost" type="string"/>
      <parameter name="nPort" type="i4"/>
      <parameter name="strTransactionId" type="string"/>
      <parameter name="nIndex" type="i4"/>
      <parameter name="strAllCallers" type="string"/>
    </event>
    <event name="ModeratorJoinRequest" display="ModeratorJoinRequest" >
      <parameter name="strHost" type="string"/>
      <parameter name="strPort" type="string"/>
      <parameter name="strTransactionId" type="string"/>
      <parameter name="strConferenceResource" type="string"/>
      <parameter name="lConnectTime" type="i8"/>
      <parameter name="strMutedParty" type="string"/>
    </event>
    <event name="IVRConfAddPartyResponse" display="IVRConfAddPartyResponse" >
      <parameter name="nReturnCode" type="i4"/>
      <parameter name="strReturnMsg" type="string"/>
    </event>
    <event name="ConfPlayWarningPromptRequest" display="ConfPlayWarningPromptRequest" >
      <parameter name="strConfControllerIP" type="string"/>
      <parameter name="nConfControllerPort" type="i4"/>
      <parameter name="strTransactionId" type="string"/>
      <parameter name="nTimeRemainingMinutes" type="i4"/>
      <parameter name="nTimeRemainingSeconds" type="i4"/>
    </event>
    <event name="ConfFunctionsStateChangeNotify" display="ConfFunctionsStateChangeNotify" >
      <parameter name="strConfControllerIP" type="string"/>
      <parameter name="nConfControllerPort" type="i4"/>
      <parameter name="strTransactionId" type="string"/>
      <parameter name="strThirdPartyConferenceId" type="string"/>
      <parameter name="strConferenceId" type="string"/>
      <parameter name="bLockedState" type="boolean"/>
      <parameter name="bMutedState" type="boolean"/>
      <parameter name="bContinuesState" type="boolean"/>
      <parameter name="bRecordingState" type="boolean"/>
      <parameter name="bQandAEnabledState" type="boolean"/>
      <parameter name="bEventStarted" type="boolean"/>
      <parameter name="bSpeakersSubConferenceActive" type="boolean"/>
      <parameter name="bGlobalMusicOn" type="boolean"/>
      <parameter name="bLastLegConferenceExpired" type="boolean"/>
    </event>
    <event name="IVRConfPartyDeclineResponse" display="IVRConfPartyDeclineResponse"/>
    <event name="ConnectToMusicResponse" display="ConnectToMusicResponse" >
      <parameter name="nReplyCode" type="i4"/>
      <parameter name="strReplyMsg" type="string"/>
      <parameter name="nConferenceIndex" type="i4"/>
      <parameter name="strConferenceId" type="string"/>
    </event>
    <event name="ForceDisconnectFromMusic" display="ForceDisconnectFromMusic"/>
    <event name="ConfJoinEventResponse" display="ConfJoinEventResponse" >
      <parameter name="strHostIP" type="string"/>
      <parameter name="nHostPort" type="i4"/>
      <parameter name="strTransactionId" type="string"/>
      <parameter name="strWFM" type="string"/>
      <parameter name="strMediaServerEndPoint" type="string"/>
      <parameter name="strCustomerConferenceId" type="string"/>
      <parameter name="strConfControllerCallerPassCode" type="string"/>
      <parameter name="strPlayFirstNonAnonymousPrompt" type="string"/>
    </event>
    <event name="ConferencePing" display="ConferencePing" >
      <parameter name="strPingSessionId" type="string"/>
      <parameter name="strPasscode" type="string"/>
    </event>
    <event name="ConferencePong" display="ConferencePong" >
      <parameter name="nPassCodeStatus" type="i4"/>
    </event>
    <event name="ConfGetRollCallResponse" display="ConfGetRollCallResponse" >
      <parameter name="strConfControllerIpAddress" type="string"/>
      <parameter name="nConfControllerPort" type="i4"/>
      <parameter name="strTransactionId" type="string"/>
      <parameter name="nRecordedNameCount" type="i4"/>
      <parameter name="strRecordedNameURLs" type="string"/>
    </event>
    <event name="CSRBeginAssignment" display="CSRBeginAssignment" >
      <parameter name="strACDControllerIP" type="string"/>
      <parameter name="nACDControllerPort" type="i4"/>
      <parameter name="strTransactionId" type="string"/>
      <parameter name="lAssignmentId" type="i8"/>
      <parameter name="lRequestId" type="i8"/>
      <parameter name="lACDUserId" type="i8"/>
      <parameter name="lAssignmentSkillId" type="i8"/>
      <parameter name="strAssignmentSkillName" type="string"/>
      <parameter name="lAssignmentLanguageId" type="i8"/>
      <parameter name="strAssignmentLanguageName" type="string"/>
      <parameter name="lAssignmentGroupId" type="i8"/>
      <parameter name="strAssignmentGroupName" type="string"/>
      <parameter name="nRequestType" type="i4"/>
      <parameter name="strRequestTypeName" type="string"/>
      <parameter name="lServiceProviderId" type="i8"/>
      <parameter name="strServiceProviderName" type="string"/>
      <parameter name="lOfferingId" type="i8"/>
      <parameter name="strOfferingName" type="string"/>
      <parameter name="strConfEventId" type="string"/>
      <parameter name="strModPasscode" type="string"/>
      <parameter name="strSubscriberAccount" type="string"/>
      <parameter name="strSubscriberFirstName" type="string"/>
      <parameter name="strSubscriberLastName" type="string"/>
      <parameter name="strCSRAppServerIP" type="string"/>
      <parameter name="strAssignmentType" type="string"/>
      <parameter name="lAssignmentDuration" type="i8"/>
      <parameter name="strSubscriberPin" type="string"/>
      <parameter name="strCSRAssignmentAction" type="string"/>
    </event>
    <event name="AddCallerToConf" display="AddCallerToConf" >
      <parameter name="strACDControllerIP" type="string"/>
      <parameter name="nACDControllerPort" type="i4"/>
      <parameter name="strTransactionId" type="string"/>
      <parameter name="strConfPasscode" type="string"/>
    </event>
    <event name="CSREndAssignment" display="CSREndAssignment" >
      <parameter name="strACDControllerIP" type="string"/>
      <parameter name="nACDControllerPort" type="i4"/>
      <parameter name="strTransactionId" type="string"/>
      <parameter name="strAssignmentId" type="string"/>
      <parameter name="lRequestId" type="i8"/>
      <parameter name="lACDUserId" type="i8"/>
      <parameter name="strAssignmentAction" type="string"/>
      <parameter name="strPasscode" type="string"/>
      <parameter name="strPrepaidPin" type="string"/>
      <parameter name="strPostpaidPin" type="string"/>
      <parameter name="strPostpaidAccountNumber" type="string"/>
      <parameter name="strOutdialPhoneNumber" type="string"/>
      <parameter name="nCSRAvailabilityState" type="i4"/>
      <parameter name="strBillableFlag" type="string"/>
      <parameter name="nReleaseToConfStatus" type="i4"/>
      <parameter name="lPartySchedId" type="i8"/>
      <parameter name="strPartyDetail" type="string"/>
      <parameter name="nDefaultAudioMode" type="i4"/>
      <parameter name="strSubConferenceId" type="string"/>
      <parameter name="strRequeueFlag" type="string"/>
    </event>
    <event name="CallerOnHold" display="CallerOnHold" >
      <parameter name="strACDControllerIP" type="string"/>
      <parameter name="nACDControllerPort" type="i4"/>
      <parameter name="strTransactionId" type="string"/>
    </event>
    <event name="CallerOffHold" display="CallerOffHold" >
      <parameter name="strACDControllerIP" type="string"/>
      <parameter name="nACDControllerPort" type="i4"/>
      <parameter name="strTransactionId" type="string"/>
    </event>
    <event name="HeartbeatResponse" display="HeartbeatResponse" >
      <parameter name="strACDControllerIP" type="string"/>
      <parameter name="nACDControllerPort" type="i4"/>
      <parameter name="strTransactionId" type="string"/>
    </event>
    <event name="RequestCSRResponse" display="RequestCSRResponse" >
      <parameter name="strACDControllerIP" type="string"/>
      <parameter name="nACDControllerPort" type="i4"/>
      <parameter name="strTransactionId" type="string"/>
      <parameter name="nReturnCode" type="i4"/>
      <parameter name="strReturnMsg" type="string"/>
    </event>
    <event name="ExtendConferenceResponse" display="ExtendConferenceResponse" >
      <parameter name="strConfControllerIP" type="string"/>
      <parameter name="nConfControllerPort" type="i4"/>
      <parameter name="strTransactionId" type="string"/>
      <parameter name="nResultCode" type="i4"/>
      <parameter name="strResultMsg" type="string"/>
    </event>
    <event name="ConfRemainingBalanceResponse" display="ConfRemainingBalanceResponse" >
      <parameter name="strConferenceControllerIP" type="string"/>
      <parameter name="nConferenceControllerPort" type="i4"/>
      <parameter name="strTransactionId" type="string"/>
      <parameter name="nRemainingHours" type="i4"/>
      <parameter name="nRemainingMinutes" type="i4"/>
      <parameter name="nRemainingSeconds" type="i4"/>
      <parameter name="fRemainingBalance" type="float"/>
    </event>
    <event name="Ping" display="Ping" >
      <parameter name="strACDControllerIP" type="string"/>
      <parameter name="nACDControllerPort" type="i4"/>
      <parameter name="strTransactionId" type="string"/>
      <parameter name="strHostIP" type="string"/>
      <parameter name="nHostPort" type="i4"/>
    </event>
    <event name="StartRecordResponse" display="StartRecordResponse" >
      <parameter name="nResultCode" type="i4"/>
      <parameter name="strResultMsg" type="string"/>
    </event>
    <event name="StopRecordResponse" display="StopRecordResponse" >
      <parameter name="nResultCode" type="i4"/>
      <parameter name="strResultMsg" type="string"/>
    </event>
    <event name="ConfPrivateTalkRequest" display="ConfPrivateTalkRequest" >
      <parameter name="strConferenceControllerIP" type="string"/>
      <parameter name="nConferenceControllerPort" type="i4"/>
      <parameter name="strTransactionId" type="string"/>
    </event>
    <event name="ConfEndPrivateTalkRequest" display="ConfEndPrivateTalkRequest" >
      <parameter name="strConferenceControllerIP" type="string"/>
      <parameter name="nConferenceControllerPort" type="i4"/>
      <parameter name="strTransactionId" type="string"/>
      <parameter name="nActionCode" type="i4"/>
      <parameter name="strSendResponseBackFlag" type="string"/>
    </event>
    <event name="ConfOperatorRequest" display="ConfOperatorRequest" >
      <parameter name="strConferenceControllerIP" type="string"/>
      <parameter name="nConferenceControllerPort" type="i4"/>
      <parameter name="strTransactionId" type="string"/>
      <parameter name="nRequestType" type="i4"/>
    </event>
    <event name="ConfCancelOperatorRequest" display="ConfCancelOperatorRequest" >
      <parameter name="strConferenceControllerIP" type="string"/>
      <parameter name="nConferenceControllerPort" type="i4"/>
      <parameter name="strTransactionId" type="string"/>
    </event>
    <event name="Pactolus.MediaserverDisconnected.1" display="MediaserverDisconnected" >
      <parameter name="strEndPoint" type="string"/>
      <parameter name="strConnectionId" type="string"/>
    </event>
    <event name="ConfAddPartyRequest" display="ConfAddPartyRequest" >
      <parameter name="strConfControllerIpAddress" type="string"/>
      <parameter name="nConfControllerPort" type="i4"/>
      <parameter name="strTransactionId" type="string"/>
      <parameter name="strConferenceId" type="string"/>
      <parameter name="strCalledNumber" type="string"/>
      <parameter name="strExtNumber" type="string"/>
      <parameter name="strPassCode" type="string"/>
      <parameter name="lServiceProviderId" type="i8"/>
      <parameter name="nDestCountryId" type="i4"/>
      <parameter name="strDestCallingCountryCode" type="string"/>
      <parameter name="strDestAreaCode" type="string"/>
      <parameter name="strDomIntlFlag" type="string"/>
      <parameter name="nDialPlanId" type="i4"/>
      <parameter name="strModOutdialFlag" type="string"/>
      <parameter name="strCalledFirstName" type="string"/>
      <parameter name="strCalledLastName" type="string"/>
      <parameter name="strAccessNumber" type="string"/>
      <parameter name="lDialOutRequestId" type="i8"/>
      <parameter name="strForceModeratorFlag" type="string"/>
      <parameter name="strForceMuteFlag" type="string"/>
      <parameter name="strConfirmationFlag" type="string"/>
      <parameter name="strPrivateTalkFlag" type="string"/>
      <parameter name="strAnonymousFlag" type="string"/>
      <parameter name="nPrivilege" type="i4"/>
      <parameter name="strPrivateTalkConfEndPoint" type="string"/>
      <parameter name="strModeratorKey" type="string"/>
    </event>
    <event name="psConfRemovePartyRequest" display="psConfRemovePartyRequest" >
      <parameter name="strConfControllerIpAddress" type="string"/>
      <parameter name="nConfControllerPort" type="i4"/>
      <parameter name="strTransactionId" type="string"/>
      <parameter name="nTerminationReason" type="i4"/>
      <parameter name="lDisconnectTime" type="i8"/>
      <parameter name="strSendResponseBackFlag" type="string"/>
      <parameter name="strNotifyMS" type="string"/>
    </event>
    <event name="ConfAddToSubConfRequest" display="ConfAddToSubConfRequest" >
      <parameter name="p_strConfControllerIP" type="string"/>
      <parameter name="p_nConfControllerPort" type="i4"/>
      <parameter name="p_strTransactionId" type="string"/>
      <parameter name="p_strCallerPassCode" type="string"/>
      <parameter name="p_strSubConfId" type="string"/>
      <parameter name="p_strSubConfModeratorFlag" type="string"/>
      <parameter name="p_strSubConferenceEndPoint" type="string"/>
      <parameter name="p_nAudioMode" type="i4"/>
    </event>
    <event name="ConfLeaveEventResponse" display="ConfLeaveEventResponse" >
      <parameter name="p_strConfControllerIP" type="string"/>
      <parameter name="p_nConfControllerPort" type="i4"/>
      <parameter name="p_strTransactionId" type="string"/>
      <parameter name="p_strDeleteSubConfFlag" type="string"/>
    </event>
    <event name="ConfRemoveFromSubConfRequest" display="ConfRemoveFromSubConfRequest" >
      <parameter name="p_strConfControllerIP" type="string"/>
      <parameter name="p_nConfControllerPort" type="i4"/>
      <parameter name="p_strTransactionId" type="string"/>
      <parameter name="p_strCallerPassCode" type="string"/>
      <parameter name="p_strDeleteSubConferenceFlag" type="string"/>
      <parameter name="p_nAudioMode" type="i4"/>
    </event>
    <event name="UnmutePartyResponse" display="UnmutePartyResponse" >
      <parameter name="strConfControllerIP" type="string"/>
      <parameter name="nConfControllerPort" type="i4"/>
      <parameter name="strTransactionId" type="string"/>
      <parameter name="nReturnCode" type="i4"/>
      <parameter name="strReturnMessage" type="string"/>
    </event>
    <event name="ConfAuditRequest" display="ConfAuditRequest" >
      <parameter name="strConfControllerIP" type="string"/>
      <parameter name="nConfControllerPort" type="i4"/>
      <parameter name="strTransactionId" type="string"/>
    </event>
    <event name="ConfGetCallerCountResponse" display="ConfGetCallerCountResponse" >
      <parameter name="strConfControllerIP" type="string"/>
      <parameter name="nConfControllerPort" type="i4"/>
      <parameter name="strTransactionId" type="string"/>
      <parameter name="strConfScheduleId" type="string"/>
      <parameter name="nCount" type="i4"/>
    </event>
    <event name="ConfQandAResponse" display="ConfQandAResponse" >
      <parameter name="strCCIP" type="string"/>
      <parameter name="nCCPort" type="i4"/>
      <parameter name="strTransactionId" type="string"/>
      <parameter name="nResultCode" type="i4"/>
      <parameter name="strResultMsg" type="string"/>
    </event>
    <event name="CSREndPrivateTalkRequest" display="CSREndPrivateTalkRequest" >
      <parameter name="strConferenceControllerIP" type="string"/>
      <parameter name="nConferenceControllerPort" type="i4"/>
      <parameter name="strTransactionId" type="string"/>
      <parameter name="nActionCode" type="i4"/>
      <parameter name="strSendResponseBackFlag" type="string"/>
      <parameter name="nConfStatus" type="i4"/>
      <parameter name="lPartySchedId" type="i8"/>
      <parameter name="strPartyDetail" type="string"/>
      <parameter name="p_nAudioMode" type="i4"/>
      <parameter name="strSubConferenceId" type="string"/>
    </event>
    <event name="ConfCSRSpeakWithParticipantRequest" display="ConfCSRSpeakWithParticipantRequest" >
      <parameter name="strConfControllerIP" type="string"/>
      <parameter name="nConfControllerPort" type="i4"/>
      <parameter name="strTransactionId" type="string"/>
      <parameter name="strConferenceEndPoint" type="string"/>
    </event>
    <event name="ConfCSREndSpeakWithParticipantRequest" display="ConfCSREndSpeakWithParticipantRequest" >
      <parameter name="strConfControllerIP" type="string"/>
      <parameter name="nConfControllerPort" type="i4"/>
      <parameter name="strTransactionId" type="string"/>
      <parameter name="lPartySchedId" type="i8"/>
      <parameter name="strPartyDetail" type="string"/>
      <parameter name="nAudioMode" type="i4"/>
      <parameter name="strResponseFlag" type="string"/>
    </event>
    <event name="MoveRequestToConference" display="MoveRequestToConference" >
      <parameter name="strConfControllerIP" type="string"/>
      <parameter name="nConfControllerPort" type="i4"/>
      <parameter name="strTransactionId" type="string"/>
      <parameter name="strConfScheduleId" type="string"/>
      <parameter name="strConferencePasscode" type="string"/>
      <parameter name="nConfStatus" type="i4"/>
      <parameter name="strSubConferenceId" type="string"/>
      <parameter name="nAudioMode" type="i4"/>
    </event>
    <event name="ConfAudioModeChangeRequest" display="ConfAudioModeChangeRequest" >
      <parameter name="strConferenceControllerIP" type="string"/>
      <parameter name="nConferenceControllerPort" type="i4"/>
      <parameter name="strTransactionId" type="string"/>
      <parameter name="nFromMode" type="i4"/>
      <parameter name="nToMode" type="i4"/>
      <parameter name="strNotifyMS" type="string"/>
    </event>
    <event name="ConfPlayDTMFRequest" display="ConfPlayDTMFRequest" >
      <parameter name="strConfControllerIP" type="string"/>
      <parameter name="nConfControllerPort" type="i4"/>
      <parameter name="strTransactionId" type="string"/>
      <parameter name="strDTMF" type="string"/>
      <parameter name="nToneDuration" type="i4"/>
      <parameter name="nToneAttenuation" type="i4"/>
      <parameter name="nToneDelay" type="i4"/>
    </event>
    <event name="ConfCancelQandAResponse" display="ConfCancelQandAResponse" >
      <parameter name="strConfControllerIP" type="string"/>
      <parameter name="nConfControllerPort" type="i4"/>
      <parameter name="strTransactionId" type="string"/>
      <parameter name="nResultCode" type="i4"/>
      <parameter name="strResultMsg" type="string"/>
    </event>
    <event name="ConfTransferPartyRequest" display="ConfTransferPartyRequest" >
      <parameter name="strConfControllerIP" type="string"/>
      <parameter name="nConfControllerPort" type="i4"/>
      <parameter name="strTransactionId" type="string"/>
      <parameter name="strPasscode" type="string"/>
      <parameter name="strAccessNumber" type="string"/>
      <parameter name="nAudioMode" type="i4"/>
      <parameter name="nConfStatus" type="i4"/>
      <parameter name="lFromPartyScheduleId" type="i8"/>
      <parameter name="strSubConferenceId" type="string"/>
    </event>
    <event name="ACDAuditRequest" display="ACDAuditRequest" >
      <parameter name="strACDControllerIP" type="string"/>
      <parameter name="nACDControllerPort" type="i4"/>
      <parameter name="strTransactionId" type="string"/>
    </event>
    <event name="ConfAllocateMSEndpointRequest" display="ConfAllocateMSEndpointRequest" >
      <parameter name="strConfControllerIP" type="string"/>
      <parameter name="nConfControllerPort" type="i4"/>
      <parameter name="strTransactionId" type="string"/>
    </event>
    <event name="ConfReleaseMSEndpointRequest" display="ConfReleaseMSEndpointRequest" >
      <parameter name="strConfControllerIP" type="string"/>
      <parameter name="nConfControllerPort" type="i4"/>
      <parameter name="strTransactionId" type="string"/>
      <parameter name="strConferenceEndpoint" type="string"/>
    </event>
    <event name="ConfPlacePartyOnEndpointRequest" display="ConfPlacePartyOnEndpointRequest" >
      <parameter name="strConferenceControllerIP" type="string"/>
      <parameter name="nConferenceControllerPort" type="i4"/>
      <parameter name="strTransactionId" type="string"/>
      <parameter name="strConferenceId" type="string"/>
    </event>
    <event name="ConfPartyStatusChangeRequest" display="ConfPartyStatusChangeRequest" >
      <parameter name="strConfControllerIP" type="string"/>
      <parameter name="nConfControllerPort" type="i4"/>
      <parameter name="strTransactionId" type="string"/>
      <parameter name="nStatus" type="i4"/>
    </event>
  </events>
  <global-handlers >
    <handler event="ConfMutePartyRequest" function="OnMutePartyRequest" public="0" always-on="0"/>
    <handler event="ConfAddPartyRequest" function="OnConfAddPartyRequest" public="1" always-on="0"/>
    <handler event="Pactolus.EveSipInvite.1" function="OnInvite" public="1" always-on="0"/>
    <handler event="Pactolus.EveSipBye.1" function="OnBye" public="0" always-on="0"/>
    <handler event="Pactolus.EveSipCancel.1" function="OnCancel" public="0" always-on="0"/>
    <handler event="Standard.OnServiceLoad.1" function="OnServiceLoad" public="0" always-on="0"/>
    <handler event="Standard.OnSessionEnd.1" function="OnSessionEnd" public="0" always-on="0"/>
    <handler event="Standard.OnTimer.1" function="OnTimer" public="0" always-on="0"/>
    <handler event="ConfUnmutePartyRequest" function="OnUnmutePartyRequest" public="0" always-on="0"/>
    <handler event="Pactolus.EveSipInfo.1" function="OnInfo" public="0" always-on="0"/>
    <handler event="Pactolus.EveSipOptions.1" function="OnOptions" public="0" always-on="0"/>
    <handler event="Pactolus.EveSipResponse.1" function="OnResponse" public="0" always-on="0"/>
    <handler event="Pactolus.MGCPDtmf.1" function="OnDTMF" public="0" always-on="0"/>
    <handler event="IVRConfAddPartyRequest" function="OnIVRConfAddPartyRequest" public="1" always-on="0"/>
    <handler event="IVRConfBridgePartyRequest" function="OnIVRConfBridgePartyRequest" public="0" always-on="0"/>
    <handler event="IVRConfRemovePartyRequest" function="OnIVRConfRemovePartyRequest" public="0" always-on="0"/>
    <handler event="ConfHoldPartyRequest" function="OnConfHoldPartyRequest" public="0" always-on="0"/>
    <handler event="ConfOffholdPartyRequest" function="OnConfOffholdPartyRequest" public="0" always-on="0"/>
    <handler event="ConfPlayPromptRequest" function="OnConfPlayPromptRequest" public="0" always-on="0"/>
    <handler event="ModeratorJoinRequest" function="OnModeratorJoinRequest" public="0" always-on="0"/>
    <handler event="ConfPlayWarningPromptRequest" function="OnConfPlayWarningPromptRequest" public="0" always-on="0"/>
    <handler event="ConfFunctionsStateChangeNotify" function="OnConfFunctionsStateChangeNotify" public="0" always-on="0"/>
    <handler event="ForceDisconnectFromMusic" function="OnForceDisconnectFromMusic" public="0" always-on="0"/>
    <handler event="ConferencePing" function="OnConferencePing" public="0" always-on="0"/>
    <handler event="CSRBeginAssignment" function="OnCSRBeginAssignment" public="0" always-on="0"/>
    <handler event="AddCallerToConf" function="OnCSRAddCallerToConf" public="0" always-on="0"/>
    <handler event="CSREndAssignment" function="OnCSREndAssignment" public="0" always-on="0"/>
    <handler event="CallerOnHold" function="OnCSRPutCallerOnHold" public="0" always-on="0"/>
    <handler event="CallerOffHold" function="OnCSRCallerOffHold" public="0" always-on="0"/>
    <handler event="Ping" function="OnPing" public="0" always-on="0"/>
    <handler event="ConfPrivateTalkRequest" function="OnConfPrivateTalkRequest" public="0" always-on="0"/>
    <handler event="ConfEndPrivateTalkRequest" function="OnConfEndPrivateTalkRequest" public="0" always-on="0"/>
    <handler event="ConfOperatorRequest" function="OnConfOperatorRequest" public="0" always-on="0"/>
    <handler event="ConfCancelOperatorRequest" function="OnConfCancelOperatorRequest" public="0" always-on="0"/>
    <handler event="Pactolus.MediaserverDisconnected.1" function="OnMediaserverDisconnected" public="0" always-on="0"/>
    <handler event="psConfRemovePartyRequest" function="OnpsConfRemovePartyRequest" public="0" always-on="0"/>
    <handler event="ConfAddToSubConfRequest" function="OnConfAddToSubConfRequest" public="0" always-on="0"/>
    <handler event="ConfRemoveFromSubConfRequest" function="OnConfRemoveFromSubConfRequest" public="0" always-on="0"/>
    <handler event="ConfAuditRequest" function="OnConfAuditRequest" public="0" always-on="0"/>
    <handler event="ConfQandAResponse" function="OnConfQandAResponse" public="0" always-on="0"/>
    <handler event="CSREndPrivateTalkRequest" function="OnCSREndPrivateTalkRequest" public="0" always-on="0"/>
    <handler event="ConfCSRSpeakWithParticipantRequest" function="OnConfCSRSpeakWithParticipant" public="0" always-on="0"/>
    <handler event="ConfCSREndSpeakWithParticipantRequest" function="OnConfCSREndSpeakWithParticipant" public="0" always-on="0"/>
    <handler event="MoveRequestToConference" function="OnMoveRequestToConference" public="0" always-on="0"/>
    <handler event="ConfAudioModeChangeRequest" function="OnConfAudioModeChangeRequest" public="0" always-on="0"/>
    <handler event="ConfPlayDTMFRequest" function="OnConfPlayDTMFRequest" public="0" always-on="0"/>
    <handler event="ConfTransferPartyRequest" function="OnConfTransferPartyRequest" public="0" always-on="0"/>
    <handler event="ACDAuditRequest" function="OnACDAuditRequest" public="0" always-on="0"/>
    <handler event="ConfAllocateMSEndpointRequest" function="OnConfAllocateMSEndpointRequest" public="1" always-on="0"/>
    <handler event="ConfReleaseMSEndpointRequest" function="OnConfReleaseMSEndpointRequest" public="1" always-on="0"/>
    <handler event="ConfPlacePartyOnEndpointRequest" function="OnConfAddToMainRequest" public="0" always-on="0"/>
    <handler event="ConfPartyStatusChangeRequest" function="OnConfPartyStatusChangeRequest" public="0" always-on="0"/>
  </global-handlers>
  <global-vars >
    <var name="g_lStartTime" type="i8" >0</var>
    <var name="g_lEndTime" type="i8" >0</var>
    <var name="g_lMSConnectTime" type="i8" >0</var>
    <var name="g_strOrigNbr" type="string" ></var>
    <var name="g_strInfoDigits" type="string" ></var>
    <var name="g_strConfResource" type="string" ></var>
    <var name="g_strPassCode" type="string" ></var>
    <var name="g_strAccessNumber" type="string" ></var>
    <var name="g_nScheduleDuration" type="i4" >0</var>
    <var name="g_strScheduleStartTime" type="string" ></var>
    <var name="g_lTimeAvailable" type="i8" >0</var>
    <var name="g_strConfScheduleId" type="string" ></var>
    <var name="g_strCallLegId" type="string" ></var>
    <var name="g_nAccessNumberId" type="i4" >0</var>
    <var name="g_strConfEventId" type="string" ></var>
    <var name="g_lTimerId" type="i8" >0</var>
    <var name="g_bTimerSet" type="boolean" >0</var>
    <var name="g_nCallMode" type="i4" >1</var>
    <var name="g_nTerminationReason" type="i4" >17</var>
    <var name="g_strConfControllerIP" type="string" ></var>
    <var name="g_nConfControllerPort" type="i4" >0</var>
    <var name="g_strModeratorFlag" type="string" >F</var>
    <var name="g_strCallerOrg" type="string" ></var>
    <var name="g_strCallerFirstName" type="string" ></var>
    <var name="g_strReturnMsg" type="string" ></var>
    <var name="g_nSoapPort" type="i4" >0</var>
    <var name="g_strSessionId" type="string" ></var>
    <var name="g_strSoapAddress" type="string" ></var>
    <var name="g_strSipAddress" type="string" ></var>
    <var name="g_nSipPort" type="i4" >0</var>
    <var name="g_strTranslatedDestNbr" type="string" ></var>
    <var name="g_lServiceProviderId" type="i8" >0</var>
    <var name="g_strRetryFlag" type="string" >F</var>
    <var name="g_nNbrPassCodeRetries" type="i4" >1</var>
    <var name="g_nMaxRetryAllowed" type="i4" >3</var>
    <var name="g_strOrigDomIntlFlag" type="string" >D</var>
    <var name="g_nOrigCountryId" type="i4" >0</var>
    <var name="g_strGWIPIngress" type="string" ></var>
    <var name="g_nGWPortIngress" type="i4" >0</var>
    <var name="g_strGWIPEgress" type="string" ></var>
    <var name="g_nGWPortEgress" type="i4" >0</var>
    <var name="g_nRtpClockRate" type="i4" >0</var>
    <var name="g_nRtpEncoding" type="i4" >0</var>
    <var name="g_strOutdialFlag" type="string" >F</var>
    <var name="g_nDialPlanId" type="i4" >1</var>
    <var name="g_strDBSessionId" type="string" ></var>
    <var name="g_strWelcomePromptType" type="string" ></var>
    <var name="g_strWelcomePromptUrl" type="string" ></var>
    <var name="g_nWelcomePromptIndex" type="i4" >0</var>
    <var name="g_strCustomerServicePhone" type="string" ></var>
    <var name="g_strPartyPasscodeFlag" type="string" ></var>
    <var name="g_strCallerLastName" type="string" ></var>
    <var name="g_strOrigCallingCode" type="string" ></var>
    <var name="g_strOrigAreaCode" type="string" ></var>
    <var name="g_strSIPStatus" type="string" ></var>
    <var name="g_strLanguage" type="string" >eng</var>
    <var name="g_strMuteFlag" type="string" ></var>
    <var name="g_strEventReceived" type="string" ></var>
    <var name="g_strConfPassCode" type="string" ></var>
    <var name="g_nMaxCallerHoldTime" type="i4" >120</var>
    <var name="g_bNullString" type="boolean" >0</var>
    <var name="g_bReturnToConf" type="boolean" >0</var>
    <var name="g_nCurrentNbrCallegs" type="i4" >0</var>
    <var name="g_bWaitForModerator" type="boolean" >0</var>
    <var name="g_lWFMTimerId" type="i8" >0</var>
    <var name="g_lHoldTimerId" type="i8" >0</var>
    <var name="g_bHoldTimerFlag" type="boolean" >0</var>
    <var name="g_strPostPinPromptType" type="string" ></var>
    <var name="g_strPostPinPromptUrl" type="string" ></var>
    <var name="g_nPostPinPromptIndex" type="i4" >0</var>
    <var name="g_nTempInt" type="i4" >0</var>
    <var name="g_strOutdialDestNbr" type="string" ></var>
    <var name="g_nDestCountryId" type="i4" >0</var>
    <var name="g_strDestDomIntlFlag" type="string" ></var>
    <var name="g_strDestAreaCode" type="string" ></var>
    <var name="g_strDestCallingCountryCode" type="string" ></var>
    <var name="g_nServiceId" type="i4" >0</var>
    <var name="g_strSPTimeZone" type="string" ></var>
    <var name="g_bWebDialOut" type="boolean" >0</var>
    <var name="g_bIVRDialOut" type="boolean" >0</var>
    <var name="g_strSelfMute" type="string" >F</var>
    <var name="g_nPromptMuteUnMute" type="i4" >859</var>
    <var name="g_nPromptLockUnLock" type="i4" >857</var>
    <var name="g_nPromptAllowDisallow" type="i4" >902</var>
    <var name="g_strPartyScheduleId" type="string" ></var>
    <var name="g_strStatus" type="string" ></var>
    <var name="g_nLocalGMTOffset" type="i4" >0</var>
    <var name="g_strStrippedOrigNbr" type="string" ></var>
    <var name="g_strAlarmType" type="string" ></var>
    <var name="g_strAlarmPriority" type="string" ></var>
    <var name="g_strContact" type="string" ></var>
    <var name="g_nPromptSelfMuteUnMute" type="i4" >907</var>
    <var name="g_strIVRAddPartySessionId" type="string" ></var>
    <var name="g_strLastPartySessionId" type="string" ></var>
    <var name="g_strModeratorRequiredFlag" type="string" >F</var>
    <var name="g_strDBNAME" type="string" >pactolusdb</var>
    <var name="g_bCurrentlyInMMenu" type="boolean" >0</var>
    <var name="g_bMutedState" type="boolean" >0</var>
    <var name="g_bFirstCaller" type="boolean" >0</var>
    <var name="g_bMutedByMod" type="boolean" >0</var>
    <var name="g_bHoldState" type="boolean" >0</var>
    <var name="g_oCallLegA" type="object" ></var>
    <var name="g_oMS" type="object" ></var>
    <var name="g_oTempConf" type="object" ></var>
    <var name="g_oCallLegB" type="object" ></var>
    <var name="g_bSentFinalResponse" type="boolean" >0</var>
    <var name="g_bHoldByMod" type="boolean" >0</var>
    <var name="g_bServingCaller" type="boolean" >0</var>
    <var name="g_nErrorMsgNumber" type="i4" >0</var>
    <var name="g_strACDEnable" type="string" ></var>
    <var name="g_strACDCSROnMaxLoginsEnabled" type="string" ></var>
    <var name="g_strACDGreetingEnabled" type="string" ></var>
    <var name="g_strACDControllerIP" type="string" ></var>
    <var name="g_nACDControllerPort" type="i4" >0</var>
    <var name="g_strTag" type="string" ></var>
    <var name="g_strBillingCodeFlag" type="string" ></var>
    <var name="g_strRecordNamesFlag" type="string" ></var>
    <var name="g_nArriveDepartOption" type="i4" >0</var>
    <var name="g_strMusicOnHoldFlag" type="string" ></var>
    <var name="g_bAddingParty" type="boolean" >0</var>
    <var name="g_strAddPartySessionId" type="string" ></var>
    <var name="g_nBillingType" type="i4" >0</var>
    <var name="g_nCurrencyId" type="i4" >0</var>
    <var name="g_fPrepaidBalance" type="float" >0</var>
    <var name="g_lSubscriberId" type="i8" >0</var>
    <var name="g_strModOutdialFlag" type="string" >F</var>
    <var name="g_strMusicOnHoldSessionId" type="string" ></var>
    <var name="g_nMusicOnHoldConfIndex" type="i4" >0</var>
    <var name="g_strMusicOnHoldConfId" type="string" ></var>
    <var name="g_bConnectToMOH" type="boolean" >0</var>
    <var name="g_strCallerRecordedName" type="string" ></var>
    <var name="g_bCreatedTempConf" type="boolean" >0</var>
    <var name="g_strExistingCallLegId" type="string" ></var>
    <var name="g_strExistingSessionId" type="string" ></var>
    <var name="g_nRecordedNameCount" type="i4" >0</var>
    <var name="g_strRecordedNameURLs" type="string" ></var>
    <var name="g_oRecordedNameURLs" type="object" ></var>
    <var name="g_strBillingCodeNumber" type="string" ></var>
    <var name="g_strOperatorFlag" type="string" >F</var>
    <var name="g_lWaitCSRTimerId" type="i8" >0</var>
    <var name="g_bWaitCSRTimerSet" type="boolean" >0</var>
    <var name="g_nCSRRouteReasonCode" type="i4" >0</var>
    <var name="g_lTempLong" type="i8" >0</var>
    <var name="g_strCSRRequestTypeName" type="string" ></var>
    <var name="g_lCSRRequestLanguageId" type="i8" >1001</var>
    <var name="g_lCSRRequestOfferingId" type="i8" >4</var>
    <var name="g_strCSRRequestOfferingName" type="string" ></var>
    <var name="g_lCSRRequestServiceId" type="i8" >0</var>
    <var name="g_strCSRRequestServiceName" type="string" ></var>
    <var name="g_lCSRRequestSkillId" type="i8" >2</var>
    <var name="g_lCSRRequestId" type="i8" >0</var>
    <var name="g_nCSRRequestGroupId" type="i4" >0</var>
    <var name="g_strCSRRequestSkillName" type="string" ></var>
    <var name="g_strCSRRequestLanguageName" type="string" ></var>
    <var name="g_strCSRAccessNbrName" type="string" ></var>
    <var name="g_strCSRServiceProviderName" type="string" ></var>
    <var name="g_lCSRAssignmentId" type="i8" >0</var>
    <var name="g_lCSRAssignmentUserId" type="i8" >0</var>
    <var name="g_strCSRAssignmentType" type="string" ></var>
    <var name="g_nCSRAssignmentSkillId" type="i4" >0</var>
    <var name="g_nCSRAssignmentLanguageId" type="i4" >0</var>
    <var name="g_lCSRAssignmentStartTime" type="i8" >0</var>
    <var name="g_lCSRAssignmentEndTime" type="i8" >0</var>
    <var name="g_strCSRAssignmentTimeZone" type="string" ></var>
    <var name="g_bCSRAssignmentFlag" type="boolean" >0</var>
    <var name="g_nCSRAssignmentGroupId" type="i4" >0</var>
    <var name="g_nCallerCurrentState" type="i4" >-1</var>
    <var name="g_bWaitForCSR" type="boolean" >0</var>
    <var name="g_lBeepBeepTimerId" type="i8" >0</var>
    <var name="g_bBeepBeepTimerFlag" type="boolean" >0</var>
    <var name="g_strCSRRequestEndPoint" type="string" ></var>
    <var name="g_strHoldBillingFlag" type="string" ></var>
    <var name="g_iRoundSeconds" type="i4" >0</var>
    <var name="g_strRechargeFlag" type="string" ></var>
    <var name="g_iSubExpirationType" type="i4" >0</var>
    <var name="g_iOfferingId" type="i4" >0</var>
    <var name="g_lHeartbeatRequestTimerId" type="i8" >0</var>
    <var name="g_bHeartbeatTimerFlag" type="boolean" >0</var>
    <var name="g_strSubscriberAccount" type="string" ></var>
    <var name="g_strPlayPartyCountFlag" type="string" ></var>
    <var name="g_lCSRRequestGroupId" type="i8" >0</var>
    <var name="g_strCSRRequestGroupName" type="string" ></var>
    <var name="g_strCSRAppServerIP" type="string" ></var>
    <var name="g_lRequestStartTime" type="i8" >0</var>
    <var name="g_lRequestEndTime" type="i8" >0</var>
    <var name="g_lCkReInviteTimerIdA" type="i8" >0</var>
    <var name="g_nCkReInviteTime" type="i4" >0</var>
    <var name="g_lLastReInviteTime" type="i8" >0</var>
    <var name="g_lCkReInviteTimerIdB" type="i8" >0</var>
    <var name="g_strIsSubscriberFlag" type="string" >F</var>
    <var name="g_nRemainingHours" type="i4" >0</var>
    <var name="g_nRemainingMinutes" type="i4" >0</var>
    <var name="g_nRemainingSeconds" type="i4" >0</var>
    <var name="g_fRemainingBalance" type="float" >0</var>
    <var name="g_strSetStateToGetConfRes" type="string" >F</var>
    <var name="g_lOutdialStartTime" type="i8" >0</var>
    <var name="g_lHoldWFMStartTime" type="i8" >0</var>
    <var name="g_lOutdialConnectTime" type="i8" >0</var>
    <var name="g_lPartyJoinTime" type="i8" >0</var>
    <var name="g_strConfSessionId" type="string" ></var>
    <var name="g_nPassCodeLength" type="i4" >0</var>
    <var name="g_strPassCodeDigitMap" type="string" ></var>
    <var name="g_bMOHTimerFlag" type="boolean" >0</var>
    <var name="g_lMOHTimerId" type="i8" >0</var>
    <var name="g_oMOH_MS" type="object" ></var>
    <var name="g_strCurrentConfType" type="string" >S</var>
    <var name="g_bSentPartyJoin" type="boolean" >0</var>
    <var name="g_bOnHoldFromTConf" type="boolean" >0</var>
    <var name="g_bZeroOutToCSR" type="boolean" >0</var>
    <var name="g_nPayphoneSrchgRateId" type="i4" >0</var>
    <var name="g_fPayphoneSrchgRateAmt" type="float" >0</var>
    <var name="g_nAccessNumberRateId" type="i4" >0</var>
    <var name="g_fAccessNumberRateAmt" type="float" >0</var>
    <var name="g_nAccessNumberRateType" type="i4" >0</var>
    <var name="g_nMeteredRate1Id" type="i4" >0</var>
    <var name="g_fMeteredRate1Amt" type="float" >0</var>
    <var name="g_nMeteredRate2Id" type="i4" >0</var>
    <var name="g_fMeteredRate2Amt" type="float" >0</var>
    <var name="g_nFixedRate1Id" type="i4" >0</var>
    <var name="g_fFixedRate1Amt" type="float" >0</var>
    <var name="g_nFixedRate2Id" type="i4" >0</var>
    <var name="g_fFixedRate2Amt" type="float" >0</var>
    <var name="g_fTotalMeteredRate" type="float" >0</var>
    <var name="g_fTotalFixedRate" type="float" >0</var>
    <var name="g_strPinLanguage" type="string" ></var>
    <var name="g_lDialOutRequestId" type="i8" >0</var>
    <var name="g_strDialOutExtNbr" type="string" ></var>
    <var name="g_strForceModeratorFlag" type="string" >F</var>
    <var name="g_strForceMuteFlag" type="string" >F</var>
    <var name="g_strRecordLocation" type="string" >nfs://10.10.100.98/</var>
    <var name="g_strRecordedSessionId" type="string" ></var>
    <var name="g_strRecordFileName" type="string" ></var>
    <var name="g_bCkReInviteTimerFlagA" type="boolean" >0</var>
    <var name="g_bCkReInviteTimerFlagB" type="boolean" >0</var>
    <var name="g_strPromptOnOutdialFlag" type="string" ></var>
    <var name="g_nPromptFollowByPound" type="i4" >580</var>
    <var name="g_strAutoRecordFlag" type="string" ></var>
    <var name="g_strConfRecordAllowed" type="string" ></var>
    <var name="g_nRecordNameLength" type="i4" >0</var>
    <var name="g_strHomeCallingCode" type="string" ></var>
    <var name="g_nHomeCountryId" type="i4" >0</var>
    <var name="g_strOutdialCLI" type="string" ></var>
    <var name="g_strUsedDefaultANIFlag" type="string" >F</var>
    <var name="g_strSubscriberPin" type="string" ></var>
    <var name="g_nPROMPT_CONF_RECORD" type="i4" >953</var>
    <var name="g_strTerminationDigit" type="string" ></var>
    <var name="g_oIVR_MS" type="object" ></var>
    <var name="g_strCustomerConferenceId" type="string" ></var>
    <var name="g_strAttendeeId" type="string" ></var>
    <var name="g_strAnonymousAttendeeId" type="string" >F</var>
    <var name="g_strPrivateTalkFlag" type="string" ></var>
    <var name="g_bPrivateTalkInConference" type="boolean" >0</var>
    <var name="g_strConfirmationFlag" type="string" ></var>
    <var name="g_nPrivilege" type="i4" >0</var>
    <var name="g_nAttendeeId" type="i4" >0</var>
    <var name="g_nOperatorAssistType" type="i4" >0</var>
    <var name="g_strModeratorKey" type="string" ></var>
    <var name="g_bAnonymousCaller" type="boolean" >0</var>
    <var name="g_nAnonymousAttendeeId" type="i4" >0</var>
    <var name="g_bSendMsgToCC" type="boolean" >1</var>
    <var name="g_strCSRAssignmentSkillName" type="string" ></var>
    <var name="g_strCSRAssignmentLanguageName" type="string" ></var>
    <var name="g_strCSRAssignmentGroupName" type="string" ></var>
    <var name="g_nCSRRequestType" type="i4" >0</var>
    <var name="g_bSideBarOperatorRequest" type="boolean" >0</var>
    <var name="g_bSentAPIBeginAssignment" type="boolean" >0</var>
    <var name="g_bSentAPIBeginRequest" type="boolean" >0</var>
    <var name="g_bSentACDBeginAssignment" type="boolean" >0</var>
    <var name="g_bSentACDBeginRequest" type="boolean" >0</var>
    <var name="g_bCallerBackInMainConf" type="boolean" >0</var>
    <var name="g_bThirdPartyDialOut" type="boolean" >0</var>
    <var name="g_strQuickStartFlag" type="string" ></var>
    <var name="g_strResponseTransactionId" type="string" ></var>
    <var name="g_nRequestCSRType" type="i4" >0</var>
    <var name="g_strRequestCSRPrivateTalkFlag" type="string" ></var>
    <var name="g_oSubConfMS" type="object" ></var>
    <var name="g_strSubConfModeratorFlag" type="string" ></var>
    <var name="g_bCurrentlyInSubConf" type="boolean" >0</var>
    <var name="g_bSubConfMuteFlag" type="boolean" >0</var>
    <var name="g_bSubConfHoldFlag" type="boolean" >0</var>
    <var name="g_bSubConfMuteByModFlag" type="boolean" >0</var>
    <var name="g_lPrivateTalkStartTime" type="i8" >0</var>
    <var name="g_lPrivateTalkEndTime" type="i8" >0</var>
    <var name="g_bMuteThisParty" type="boolean" >0</var>
    <var name="g_strMSResourceName" type="string" ></var>
    <var name="g_bHandOff" type="boolean" >0</var>
    <var name="g_strUnmuteDigits" type="string" ></var>
    <var name="g_strBillableFlag" type="string" ></var>
    <var name="g_bSentPartyLeave" type="boolean" >0</var>
    <var name="g_bConfControllerGeneratedPCode" type="boolean" >0</var>
    <var name="g_strCCGeneratedPassCode" type="string" ></var>
    <var name="g_lSubConferenceJoinTime" type="i8" >0</var>
    <var name="g_strConfContinueNoMod" type="string" ></var>
    <var name="g_strMutedPartyPassCode" type="string" >F</var>
    <var name="g_bHandBack" type="boolean" >0</var>
    <var name="g_nRedirectStatus" type="i4" >0</var>
    <var name="g_strAlternateSiteIP" type="string" ></var>
    <var name="g_nAlternateSitePort" type="i4" >0</var>
    <var name="g_strConfSiteMovedFlag" type="string" ></var>
    <var name="g_bWrongSiteHangOff" type="boolean" >0</var>
    <var name="g_strTollFreeAccessNumberFlag" type="string" ></var>
    <var name="g_nAlternateSiteId" type="i4" >0</var>
    <var name="g_strAlternateSitePrefix" type="string" ></var>
    <var name="g_strCCIPMovedFrom" type="string" ></var>
    <var name="g_nCCPortMovedFrom" type="i4" >0</var>
    <var name="g_strCCIPMovedTo" type="string" ></var>
    <var name="g_nCCPortMovedTo" type="i4" >0</var>
    <var name="g_bTalkingWithCSR" type="boolean" >0</var>
    <var name="g_bNeedToMoveConf" type="boolean" >0</var>
    <var name="g_nMinutesTooEarly" type="i4" >0</var>
    <var name="g_nOutdialOption" type="i4" >3</var>
    <var name="g_strModeratorMutedFlag" type="string" ></var>
    <var name="g_strThirdPartyAcdOutdialNumber" type="string" ></var>
    <var name="g_strThirdPartyAcdOutdialAvail" type="string" ></var>
    <var name="g_nThirdPartyAcdOutdialDur" type="i4" >0</var>
    <var name="g_lWaitTPCSRTimerId" type="i4" >0</var>
    <var name="g_lTimeAnswered" type="i8" >0</var>
    <var name="g_bPlayFirstNonAnonymousPrompt" type="boolean" >0</var>
    <var name="g_bPasscodeProvided" type="boolean" >0</var>
    <var name="g_strSubscriberFirstName" type="string" ></var>
    <var name="g_strSubscriberLastName" type="string" ></var>
    <var name="g_bGotCSRCancelOutdial" type="boolean" >0</var>
    <var name="g_bConfAlreadyRemoved" type="boolean" >0</var>
    <var name="g_strReservationlessFlag" type="string" ></var>
    <var name="g_bReservationlessConf" type="boolean" >0</var>
    <var name="g_bTPCSRRouteInProgress" type="boolean" >0</var>
    <var name="g_strBadANIRouteToCSR" type="string" >F</var>
    <var name="g_nDnisIdentifiedConfFlag" type="i4" >0</var>
    <var name="g_nEventDnisType" type="i4" >0</var>
    <var name="g_bEBCRequestPrivateCSR" type="boolean" >0</var>
    <var name="g_nReleaseToConfStatus" type="i4" >0</var>
    <var name="g_bEBCRequestCSR" type="boolean" >0</var>
    <var name="g_strAutoAssign" type="string" >T</var>
    <var name="g_bNonSpeaker" type="boolean" >0</var>
    <var name="g_lConfSchedStartTime" type="i8" >0</var>
    <var name="g_bFirstTimeGetPasscode" type="boolean" >1</var>
    <var name="g_nInvalidConferenceCode" type="i4" >0</var>
    <var name="g_strInvalidConferenceMsg" type="string" ></var>
    <var name="g_lPartySchedId" type="i8" >0</var>
    <var name="g_strPartyDetail" type="string" ></var>
    <var name="g_bDontPlayContinueToHold" type="boolean" >0</var>
    <var name="g_strPlayFirstCaller" type="string" ></var>
    <var name="g_nDefaultAudioMode" type="i4" >0</var>
    <var name="g_nReleaseDefaultAudioMode" type="i4" >0</var>
    <var name="g_strMediaServerIP" type="string" ></var>
    <var name="g_bTransferParty" type="boolean" >0</var>
    <var name="g_strTransferToPasscode" type="string" ></var>
    <var name="g_lTransferFromPartySchedId" type="i8" >0</var>
    <var name="g_nConfLeaveReason" type="i4" >0</var>
    <var name="g_strConfLeaveMsg" type="string" ></var>
    <var name="g_strReservationCode" type="string" ></var>
    <var name="g_strSubConferenceId" type="string" ></var>
    <var name="g_bMoveDirectlyInSubConf" type="boolean" >0</var>
    <var name="g_bSendLeaveWithTransfer" type="boolean" >0</var>
    <var name="g_lZeroLong" type="i8" >0</var>
    <var name="g_strTransferInOutFlag" type="string" ></var>
    <var name="g_strModReAuthFlag" type="string" >F</var>
    <var name="g_nPasscodeScheme" type="i4" >0</var>
    <var name="g_nCurrNbrMods" type="i4" >0</var>
    <var name="g_strCallerRecordedNameMS" type="string" ></var>
    <var name="bRecordToConfBlade" type="boolean" >0</var>
    <var name="g_cfMain" type="Conference" ></var>
    <var name="g_cfSub" type="Conference" ></var>
    <var name="g_cfTemp" type="Conference" ></var>
    <var name="g_dlgCallLeg" type="SipDialog" ></var>
    <var name="g_msgInvite" type="SipMessage" ></var>
    <var name="g_epMain" type="MediaEndpoint" ></var>
    <var name="g_epIvr" type="MediaEndpoint" ></var>
    <var name="g_epSub" type="MediaEndpoint" ></var>
    <var name="g_epMoh" type="MediaEndpoint" ></var>
    <var name="g_epTemp" type="MediaEndpoint" ></var>
    <var name="g_bPartyHandRaised" type="boolean" >0</var>
    <var name="g_bDtmfCollectionOnHold" type="boolean" >0</var>
    <var name="g_bNotifyMS" type="boolean" >1</var>
    <var name="g_bSaveOrigAccessNbrId" type="boolean" >0</var>
    <var name="g_nOrigAccessNbrId" type="i4" >0</var>
    <var name="g_strOrigAccessNbr" type="string" ></var>
    <var name="g_strGlobalMusicOnFlag" type="string" ></var>
    <var name="g_bNoCreateConfFirstCaller" type="boolean" >0</var>
    <var name="g_strSelfMuteUnmuteFlagOn" type="string" ></var>
    <var name="g_bAllowSelfMuteUnmuteFlag" type="boolean" >0</var>
    <var name="g_strDialedNumberFromDB" type="string" ></var>
    <var name="g_bSecondaryDnisNumberFlag" type="boolean" >0</var>
    <var name="g_strOrigCountryName" type="string" ></var>
  </global-vars>
  <shared-vars >
    <var name="s_nTimeout" type="i4" >30</var>
    <var name="s_nStateGetPasscode" type="i4" >2</var>
    <var name="s_nStateSetConfResource" type="i4" >4</var>
    <var name="s_nStateDirectToMS" type="i4" >0</var>
    <var name="s_nStateEndCall" type="i4" >10</var>
    <var name="s_nStateReplyUnavailable" type="i4" >9</var>
    <var name="s_nFailure" type="i4" >-1</var>
    <var name="s_nSuccess" type="i4" >0</var>
    <var name="s_nFirstCaller" type="i4" >1</var>
    <var name="s_nNonFirstCaller" type="i4" >0</var>
    <var name="s_nEndCall" type="i4" >-2</var>
    <var name="s_nStateMsOutdialToCaller" type="i4" >3</var>
    <var name="s_nStateConfPlayPrompt" type="i4" >5</var>
    <var name="s_strConfLeave" type="string" >ConfLeaveEvent</var>
    <var name="s_strConfJoin" type="string" >ConfJoinEvent</var>
    <var name="s_strConfAddResponse" type="string" >ConfAddPartyResponse</var>
    <var name="s_strConfRemoveResponse" type="string" >ConfRemovePartyResponse</var>
    <var name="s_strConfMuteResponse" type="string" >ConfMutePartyResponse</var>
    <var name="s_strConfUnmuteResponse" type="string" >ConfUnmutePartyResponse</var>
    <var name="s_nStateInitializeConf" type="i4" >1</var>
    <var name="s_nPromptDepartTone" type="i4" >230</var>
    <var name="s_nPromptArrivalTone" type="i4" >229</var>
    <var name="s_nPromptNoResponse" type="i4" >99</var>
    <var name="s_nPromptGetPasscode" type="i4" >852</var>
    <var name="s_nPromptWelcome" type="i4" >4009</var>
    <var name="s_nPromptFirstCaller" type="i4" >945</var>
    <var name="s_nPromptTooEarly" type="i4" >972</var>
    <var name="s_nStateWait" type="i4" >-1</var>
    <var name="s_nPromptTooLate" type="i4" >875</var>
    <var name="s_nPromptDisableSub" type="i4" >506</var>
    <var name="s_nPromptMaxAttendeesReach" type="i4" >924</var>
    <var name="s_nPromptDBError" type="i4" >874</var>
    <var name="s_strEmptyString" type="string" ></var>
    <var name="s_nRingNoAnswerTime" type="i4" >60</var>
    <var name="s_strConfLockRequest" type="string" >LockConferenceRequest</var>
    <var name="s_strConfUnlockRequest" type="string" >UnlockConferenceRequest</var>
    <var name="s_strConfEndRequest" type="string" >EndConferenceRequest</var>
    <var name="s_strConfRemoveLastRequest" type="string" >RemoveLastPartyRequest</var>
    <var name="s_strConfAddRequest" type="string" >ConfAddPartyRequest</var>
    <var name="s_strConfHoldResponse" type="string" >ConfHoldPartyResponse</var>
    <var name="s_strConfOffHoldResponse" type="string" >ConfOffholdPartyResponse</var>
    <var name="s_strMuteAllRequest" type="string" >MuteAllRequest</var>
    <var name="s_strUnmuteAllRequest" type="string" >UnmuteAllRequest</var>
    <var name="s_strConfExtendRequest" type="string" >ExtendConferenceRequest</var>
    <var name="s_nPromptConfLocked" type="i4" >888</var>
    <var name="s_nPromptConfEnded" type="i4" >875</var>
    <var name="s_nPromptPasscodeInUsed" type="i4" >853</var>
    <var name="s_nPromptModNotArrive" type="i4" >876</var>
    <var name="s_nPromptNoConfController" type="i4" >874</var>
    <var name="s_nStateWaitForMod" type="i4" >6</var>
    <var name="s_nSleepTime" type="i4" >50</var>
    <var name="s_nWaitForMod" type="i4" >-11</var>
    <var name="s_strConfContinueRequest" type="string" >ContinueConferenceRequest</var>
    <var name="s_strConfDiscontinueRequest" type="string" >DiscontinueConferenceRequest</var>
    <var name="s_strIvrConfAddPartyRequest" type="string" >IVRConfAddPartyRequest</var>
    <var name="s_strIvrConfRemovePartyRequest" type="string" >IVRConfRemovePartyRequest</var>
    <var name="s_strIvrConfBridgePartyRequest" type="string" >IVRConfBridgePartyRequest</var>
    <var name="s_strIvrConfAddPartyResponse" type="string" >IVRConfAddPartyResponse</var>
    <var name="s_strSendAlarmRequest" type="string" >OnAlarm</var>
    <var name="s_strIvrConfDeclineResponse" type="string" >IVRConfPartyDeclineResponse</var>
    <var name="s_strPrimaryPSX" type="string" ></var>
    <var name="s_strBackupPSX" type="string" ></var>
    <var name="s_strUseSoftswitchFlag" type="string" ></var>
    <var name="s_strLocalHost" type="string" ></var>
    <var name="s_strDefaultAni" type="string" ></var>
    <var name="s_nStateCreateConference" type="i4" >7</var>
    <var name="s_nStateAddToConference" type="i4" >8</var>
    <var name="s_nPacketizationPeriod" type="i4" >0</var>
    <var name="s_strApplicationName" type="string" ></var>
    <var name="s_strSendAlarmFlag" type="string" ></var>
    <var name="s_strContentType" type="string" >application/sdp</var>
    <var name="s_strSipVersion" type="string" >SIP/2.0</var>
    <var name="s_nCallerHungup" type="i4" >-2</var>
    <var name="s_strMSRetryFlag" type="string" ></var>
    <var name="s_strConfMutePartyEvent" type="string" >ConfMutePartyEvent</var>
    <var name="s_strConfUnmutePartyEvent" type="string" >ConfUnmutePartyEvent</var>
    <var name="s_strDigitPrependToOutdial" type="string" ></var>
    <var name="s_strOutdialDialingPlan" type="string" >1</var>
    <var name="s_strOutdialDigitMap" type="string" ></var>
    <var name="s_strConfGetRoleCall" type="string" >ConfGetRollCallEvent</var>
    <var name="s_nPromptRestrictedDest" type="i4" >513</var>
    <var name="s_nPromptInvalidDest" type="i4" >514</var>
    <var name="s_nPromptUnableCompleteCall" type="i4" >363</var>
    <var name="s_nPromptSystemUnavailable" type="i4" >370</var>
    <var name="s_nStateRouteToCsr" type="i4" >11</var>
    <var name="s_nStateEndRequest" type="i4" >12</var>
    <var name="s_nStateBeginAssignment" type="i4" >13</var>
    <var name="s_nStateEndAssignment" type="i4" >14</var>
    <var name="s_nStateAddCallerToConf" type="i4" >15</var>
    <var name="s_nStateZeroOutToCsr" type="i4" >16</var>
    <var name="s_nHeartBeatTime" type="i4" >300</var>
    <var name="s_strSessionTimerFlag" type="string" ></var>
    <var name="s_nSessionTimerInterval" type="i4" >0</var>
    <var name="s_strConfGetBalanceRequest" type="string" >ConfRemainingBalanceRequest</var>
    <var name="s_strConfGetBalanceResponse" type="string" >ConfRemainingBalanceResponse</var>
    <var name="s_nMaxRetryWaitConfRes" type="i4" >0</var>
    <var name="s_nPasscodeInUsed" type="i4" >0</var>
    <var name="s_nPasscodeNotInUsed" type="i4" >1</var>
    <var name="s_nStateRequeue" type="i4" >17</var>
    <var name="s_strEndAssignmentResponse" type="string" >CSREndAssignmentResponse</var>
    <var name="s_nPreMohTime" type="i4" >5</var>
    <var name="s_nStateCsrPutOnHold" type="i4" >18</var>
    <var name="s_nStateAppletPutOnHold" type="i4" >19</var>
    <var name="s_nStateCsrPutOffHold" type="i4" >20</var>
    <var name="s_nStateAppletPutOffHold" type="i4" >21</var>
    <var name="s_nStateBeginRequest" type="i4" >22</var>
    <var name="s_nCsrHoldTime" type="i4" >3600</var>
    <var name="s_strIgnorePinLanguage" type="string" >F</var>
    <var name="s_strCustomerCode" type="string" ></var>
    <var name="s_strIntlPrepend" type="string" ></var>
    <var name="s_strVPNPrepend" type="string" ></var>
    <var name="s_strDefaultCountryCode" type="string" ></var>
    <var name="s_fConfStartCallDelay" type="float" >0</var>
    <var name="s_strStartRecordRequest" type="string" >StartRecordRequest</var>
    <var name="s_strStopRecordRequest" type="string" >StopRecordRequest</var>
    <var name="s_strStartRecordResponse" type="string" >ConfStartRecordResponse</var>
    <var name="s_strStopRecordResponse" type="string" >ConfStopRecordResponse</var>
    <var name="s_nVPN_DestLength" type="i4" >7</var>
    <var name="s_nConferenceMaxParties" type="i4" >0</var>
    <var name="s_nConferenceMaxTalkers" type="i4" >0</var>
    <var name="s_strCodec" type="string" ></var>
    <var name="s_strIvrMsType" type="string" ></var>
    <var name="s_strMohMsType" type="string" ></var>
    <var name="s_strConfMsType" type="string" ></var>
    <var name="s_strConfPrivateTalkResponse" type="string" >ConfPrivateTalkResponse</var>
    <var name="s_strMsgEndRequestCSR" type="string" >EndRequestCSR</var>
    <var name="s_strAddCallerToConfResponse" type="string" >AddCallerToConfResponse</var>
    <var name="s_nDBThreshold" type="i4" >0</var>
    <var name="s_nReportingInterval" type="i4" >0</var>
    <var name="s_nNbrActiveSpeakers" type="i4" >0</var>
    <var name="s_strZeroTransactionId" type="string" >0</var>
    <var name="s_strGatewayType" type="string" ></var>
    <var name="s_strBeginAssignmentNotify" type="string" >ConfBeginAssignmentNotify</var>
    <var name="s_strEndAssignmentNotify" type="string" >ConfEndAssignmentNotify</var>
    <var name="s_nPromptMuted" type="i4" >917</var>
    <var name="s_nPromptUnmuted" type="i4" >920</var>
    <var name="s_strConfAddToSubConfResponse" type="string" >ConfAddToSubConfResponse</var>
    <var name="s_strConfRemoveFromSubResponse" type="string" >ConfRemoveFromSubConfResponse</var>
    <var name="s_nStateHandoff" type="i4" >23</var>
    <var name="s_strUnmutePartyRequest" type="string" >UnmutePartyRequest</var>
    <var name="s_nOutdialCanceled" type="i4" >904</var>
    <var name="s_strConfAuditResponse" type="string" >ConfAuditResponse</var>
    <var name="s_nSiteId" type="i4" >0</var>
    <var name="s_bMsOutOfService" type="boolean" >0</var>
    <var name="s_lMSOutOfServiceTime" type="i8" >0</var>
    <var name="s_nWrongSite" type="i4" >2</var>
    <var name="s_strFailoverCodec" type="string" ></var>
    <var name="s_strConfGetCallerCountRequest" type="string" >ConfGetCallerCountRequest</var>
    <var name="s_strLoadTestMode" type="string" ></var>
    <var name="s_nStateRouteToThirdPartyCsr" type="i4" >24</var>
    <var name="s_nStateDefault" type="i4" >-100</var>
    <var name="s_nResourceUnavailable" type="i4" >-7</var>
    <var name="s_nConfAlreadyRemoved" type="i4" >-7</var>
    <var name="s_nPromptSilence" type="i4" >99</var>
    <var name="s_nResourceAlreadyInUsed" type="i4" >-3</var>
    <var name="s_strSend486" type="string" ></var>
    <var name="s_strQandARequest" type="string" >ConfQandARequest</var>
    <var name="s_strCancelQandARequest" type="string" >ConfCancelQandARequest</var>
    <var name="s_strCSREndPrivateTalkResponse" type="string" >CSREndPrivateTalkResponse</var>
    <var name="s_nStateEventConfGetPasscode" type="i4" >25</var>
    <var name="s_strMutePartyRequest" type="string" >MutePartyRequest</var>
    <var name="s_strHoldPartyRequest" type="string" >HoldPartyRequest</var>
    <var name="s_strConfCsrRequestPrivateTalk" type="string" >ConfCSRSpeakWithParticipantResponse</var>
    <var name="s_strConfCsrEndSpeakWith" type="string" >ConfCSREndSpeakWithParticipantResponse</var>
    <var name="s_strPlayBridgeTone" type="string" >T</var>
    <var name="s_strConfOffHoldPartyRequest" type="string" >OffholdPartyRequest</var>
    <var name="s_nStateGetCustomPasscode" type="i4" >26</var>
    <var name="s_strConfPartyStatusChangeRs" type="string" >ConfPartyStatusChangeResponse</var>
    <var name="s_nAGCTargetLevelIn" type="i4" >-9</var>
    <var name="s_nAGCMaxLevelIn" type="i4" >0</var>
    <var name="s_nAGCTargetLevelOut" type="i4" >-9</var>
    <var name="s_nAGCMaxLevelOut" type="i4" >0</var>
  </shared-vars>
  <functions >
    <function name="OnInvite" start="40" event="OnInvite" returns="void" >
      <parameters >
        <parameter name="strAccept" type="string"/>
        <parameter name="strAcceptEncoding" type="string"/>
        <parameter name="strAcceptLanguage" type="string"/>
        <parameter name="strAlertInfo" type="string" pass="byref"/>
        <parameter name="strAllow" type="string" pass="byref"/>
        <parameter name="strAllowEvents" type="string" pass="byref"/>
        <parameter name="strAnonymity" type="string" pass="byref"/>
        <parameter name="strAuthorization" type="string"/>
        <parameter name="strCallId" type="string"/>
        <parameter name="strCallInfo" type="string" pass="byref"/>
        <parameter name="strContact" type="string"/>
        <parameter name="strContent" type="string"/>
        <parameter name="strContentDisposition" type="string"/>
        <parameter name="strContentEncoding" type="string" pass="byref"/>
        <parameter name="strContentLanguage" type="string" pass="byref"/>
        <parameter name="strContentType" type="string"/>
        <parameter name="strCSeq" type="string"/>
        <parameter name="strDate" type="string"/>
        <parameter name="strEncryption" type="string"/>
        <parameter name="strErrorInfo" type="string" pass="byref"/>
        <parameter name="strExpires" type="string"/>
        <parameter name="strFrom" type="string"/>
        <parameter name="strInReplyTo" type="string" pass="byref"/>
        <parameter name="strMaxForwards" type="string"/>
        <parameter name="strMIMEVersion" type="string" pass="byref"/>
        <parameter name="strMinSE" type="string" pass="byref"/>
        <parameter name="strOrganization" type="string" pass="byref"/>
        <parameter name="strPriority" type="string" pass="byref"/>
        <parameter name="strProxyAuthorization" type="string"/>
        <parameter name="strProxyRequire" type="string"/>
        <parameter name="strRecordRoute" type="string"/>
        <parameter name="strReferredBy" type="string" pass="byref"/>
        <parameter name="strRemotePartyID" type="string" pass="byref"/>
        <parameter name="strReplaces" type="string" pass="byref"/>
        <parameter name="strRequestUri" type="string" pass="byref"/>
        <parameter name="strRequire" type="string" pass="byref"/>
        <parameter name="strResponseKey" type="string" pass="byref"/>
        <parameter name="strRoute" type="string" pass="byref"/>
        <parameter name="strSessionExpires" type="string" pass="byref"/>
        <parameter name="strSubject" type="string" pass="byref"/>
        <parameter name="strSupported" type="string" pass="byref"/>
        <parameter name="strTimestamp" type="string" pass="byref"/>
        <parameter name="strTo" type="string" pass="byref"/>
        <parameter name="strUserAgent" type="string" pass="byref"/>
        <parameter name="strVia" type="string" pass="byref"/>
      </parameters>
      <local-vars >
        <var name="f_lSessionStartTime" type="i8" >0</var>
        <var name="g_strNoPromptToAccept" type="string" ></var>
        <var name="f_bTreatAsBYE" type="boolean" >0</var>
        <var name="f_strContent" type="string" ></var>
        <var name="f_strHandoffToApp" type="string" >conf_proxy</var>
        <var name="f_strTargetSession" type="string" ></var>
        <var name="f_nNextState" type="i4" >0</var>
        <var name="f_nHandOffNumber" type="i4" >0</var>
        <var name="f_strHandOffNumber" type="string" ></var>
        <var name="f_strServiceProviderId" type="string" ></var>
        <var name="strEvent" type="string" ></var>
      </local-vars>
      <actions >
        <action id="40" plug-in="Pactolus.Branch.1" ><?xtml-editor x=101 y=267 ?>
          <!--New Call?-->
          <results >
            <result name="Default" link="34" stubbed="0"/>
            <result name="serving caller == true?" link="41" stubbed="0" >g_bServingCaller == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: OnInvite");
Session.f_lSessionStartTime = Server.getUTCTime();]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=819 y=185 ?>
          <!--Goto MAIN function

Direct caller to MS-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;Main&quot;" return="" external-function="0" library="" >
            <parameter >f_nNextState</parameter>
          </function>
          <results >
            <result name="Default" link="53" stubbed="0"/>
            <result name="g_bPasscodeProvided" link="61" stubbed="1" >g_bPasscodeProvided == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if ( Session.g_bPasscodeProvided ) {
	Session.f_nNextState = Session.s_nStateDirectToMS;
}]]></script>
          </scripts>
        </action>
        <action id="27" plug-in="Pactolus.SipResponse.1" ><?xtml-editor x=602 y=677 ?>
          <!--200 OK @ f_strContent-->
          <sip-response xmlns="urn:www.pactolus.com:xtml:sip" remove-via="0" reliable="0" increment-cseq-first="0" increment-cseq-last="0" >
            <call-id >strCallId</call-id>
            <contact >g_strContact</contact>
            <content >f_strContent</content>
            <content-type >s_strContentType</content-type>
            <cseq >strCSeq</cseq>
            <from >strFrom</from>
            <status >"SIP/2.0 200 OK"</status>
            <to >strTo</to>
            <via >strVia</via>
          </sip-response>
          <results >
            <result name="Default" link="50" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (0 == Clib.strcmpi(Session.strCallId, Session.g_oCallLegA.strCallId))

{

	var newCSeq = new SipCSeq(Session.strCSeq);

	var oldCSeq = new SipCSeq(Session.g_oCallLegA.strCSeq);



	if(newCSeq.value >= oldCSeq.value) 

	{

		newCSeq.increment() ;

		Session.g_oCallLegA.strCSeq = newCSeq.encode() ;

	}



	if (Clib.strcmpi(Session.strContent, Session.g_oCallLegA.strContent) != 0)

	{

		Session.g_oCallLegA.strContent = Session.strContent;

		Session.g_oCallLegA.strOriginalContent = Session.strContent;

	}

}

else

{

	var newCSeq = new SipCSeq(Session.strCSeq);

	var oldCSeq = new SipCSeq(Session.g_oCallLegB.strCSeq);



	if(newCSeq.value >= oldCSeq.value) 

	{

		newCSeq.increment() ;

		Session.g_oCallLegB.strCSeq = newCSeq.encode() ;

	}



	if (Clib.strcmpi(Session.strContent, Session.g_oCallLegB.strContent) != 0)

	{

		Session.g_oCallLegB.strContent = Session.strContent;

		Session.g_oCallLegB.strOriginalContent = Session.strContent;

	}

}

if (true == Session.g_oTempConf.bCurrentlyConnected || true == Session.g_oTempConf.bCurrentlyInConf)

{

	Session.f_strContent = Session.g_oTempConf.strContent;

}

else if (true == Session.g_oSubConfMS.bCurrentlyConnected || true == Session.g_oSubConfMS.bCurrentlyInConf || true == Session.g_bCurrentlyInSubConf)

{

	Session.f_strContent = Session.g_oSubConfMS.strContent;

}

else

{

	Session.f_strContent = Session.g_oMS.strContent;

}]]></script>
          </scripts>
        </action>
        <action id="28" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=843 y=499 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
        </action>
        <action id="33" plug-in="Pactolus.Branch.1" ><?xtml-editor x=595 y=193 ?>
          <!--js_utils 

strip non digit off phoneA, ANI, Dnis

strip leading 1 off Dnis-->
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="g_bHandOff" link="58" stubbed="0" >g_bHandOff == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[/*

Server.logInfo("BEFORE strip non digit off access number: <" + Session.g_strAccessNumber + ">");

Session.g_strAccessNumber = js_strip_non_digits(Session.g_strAccessNumber);

Server.logInfo("AFTER strip non digit off access number: <" + Session.g_strAccessNumber + ">");



Server.logInfo("BEFORE strip leading one off access number: <" + Session.g_strAccessNumber + ">");

Session.g_strAccessNumber = js_strip_one(Session.g_strAccessNumber);

Server.logInfo("AFTER strip leading one off access number: <" + Session.g_strAccessNumber + ">");

*/



Session.g_strInfoDigits = js_get_info_digits(Session.g_oCallLegA.strFrom);

Server.logInfo("AFTER get info digits: <" + Session.g_strInfoDigits + ">");



Server.logInfo("BEFORE strip non digit off info digits: <" + Session.g_strInfoDigits + ">");

Session.g_strInfoDigits = js_strip_non_digits(Session.g_strInfoDigits);

Server.logInfo("AFTER strip non digit off info digits: <" + Session.g_strInfoDigits + ">");

]]></script>
          </scripts>
        </action>
        <action id="34" plug-in="Pactolus.Branch.1" ><?xtml-editor x=361 y=203 ?>
          <!--intialize oCallLegA and oMS-->
          <results >
            <result name="Default" link="33" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("CALLER CALL Id: " + Session.strCallId);
// initialize the media server object ...
js_initMS (Session.g_oMS, Session.s_strConfMsType);
js_initMS (Session.g_oSubConfMS, Session.s_strConfMsType);
js_initMS (Session.g_oTempConf, Session.s_strConfMsType);
js_initMS (Session.g_oMOH_MS, Session.s_strConfMsType);
js_initMS (Session.g_oIVR_MS, Session.s_strConfMsType);

js_initCallLeg(Session.g_oCallLegA);
js_initCallLeg(Session.g_oCallLegB);


//if (0 != Clib.strcmpi(Session.strRequestUri, "passcode"))  
if (Clib.strstri(Session.strRequestUri, "passcode") != null)  
{
	Session.g_bPasscodeProvided = true;
	js_parse_value(Session.strRequestUri, "passcode", Session.g_strPassCode);
	js_parse_value(Session.strRequestUri, "sp_id", Session.f_strServiceProviderId);
	Server.logInfo("BBCHECK: This is redirect from broadband.");
	Server.logInfo("      Passcode         : " + Session.g_strPassCode);
	Server.logInfo("      ServiceProviderId: " + Session.f_strServiceProviderId);
	
	Session.g_lServiceProviderId = Clib.atoi(Session.f_strServiceProviderId);
} else {
	Server.logInfo("BBCHECK: This is NOT a redirect from broadband.");
}
if ( Clib.strstri(Session.strSubject, "passcode=") != null )
{
	Server.logInfo("THIS IS A HAND OFF, SUBJECT IS: " + Session.strSubject);
	Session.g_bHandOff = true;
	js_parse_value(Session.strSubject, "passcode", Session.g_strPassCode);
	Server.logInfo("HAND OFF PASSCODE IS: " + Session.g_strPassCode);
	js_parse_value(Session.strSubject, "attendeeId", Session.g_strAttendeeId);
	Server.logInfo("HAND OFF ATTENDEE Id IS: " + Session.g_strAttendeeId);
	js_parse_value(Session.strSubject, "handoff", Session.f_strHandOffNumber);
	Server.logInfo("HAND OFF NUMBER IS: " + Session.f_strHandOffNumber);
	Session.f_nHandOffNumber = Clib.atoi(Session.f_strHandOffNumber);
	Session.g_nRedirectStatus = Session.f_nHandOffNumber;
	if (3 == Session.f_nHandOffNumber)
	{
		Session.g_bHandBack = true;
	}
	else
	{
		Session.g_bHandBack = false;	
	}
	Session.f_nNextState = Session.s_nStateHandoff;
}
else
{
	Session.f_nNextState = Session.s_nStateInitializeConf;
}

Session.g_bServingCaller = true;
Session.g_lStartTime = Session.f_lSessionStartTime;
Session.g_strSessionId = Session._sessionId;
Session.g_strSoapAddress = Server.soapAddress;
Server.logInfo("SERVER SOAP PORT IS: " + Server.soapPort);
Session.g_nSoapPort = Clib.atoi(Server.soapPort);
if (0 == Session.g_nSoapPort)
{
	Server.logError("ERROR: Server.soapPort IS ZERO");
	Server.logInfo("SET DEFAULT SOAP PORT TO 7581");
	Session.g_nSoapPort = 7581;
}
Session.g_strContact = "<sip:" + Session.s_strLocalHost;
if( Server.sipPort != 5060 )
{
	Session.g_strContact = Session.g_strContact + ":" + Server.sipPort + ">";
}
else
{
	Session.g_strContact += ">"
}
// Phone A object

Session.g_oCallLegA.bReverseFromTo = true;
Session.g_oCallLegA.strFrom = Session.strFrom;
Session.g_oCallLegA.strTo = Session.strTo;
Session.g_oCallLegA.strCallId = Session.strCallId;
Session.g_oCallLegA.strContact = Session.strContact;
Session.g_oCallLegA.strContent = Session.strContent;
Session.g_oCallLegA.strOriginalContent = Session.strContent;
Session.g_oCallLegA.strContentType = Session.strContentType;
Session.g_oCallLegA.strCSeq = Session.strCSeq;
Session.g_oCallLegA.strRecordRoute = Session.strRecordRoute;
Session.g_oCallLegA.strRoute = Session.strRoute;
Session.g_oCallLegA.strVia = Session.strVia;

Session.g_nCkReInviteTime = Clib.strtod(Session.strSessionExpires);
if (Session.s_strSessionTimerFlag == "T")
{
	Session.g_oCallLegA.strSessionTimerFlag = Session.s_strSessionTimerFlag;
	Session.g_oCallLegA.nSessionTimer = Session.s_nSessionTimerInterval;
}

Session.g_oCallLegA.nSessionTimer = Clib.strtod(Session.strSessionExpires);
Session.g_oCallLegA.strSupported = Session.strSupported;
Session.g_oCallLegA.strRefresher = "uac"

Session.g_oCallLegB.nSessionTimer = Clib.strtod(Session.strSessionExpires);
Session.g_oCallLegB.strSupported = Session.strSupported;
Session.g_oCallLegB.strRefresher = "uas"

Session.g_oCallLegA.nTearDownTime = 0;
//Ingress
var from_uri = new SipUrl( Session.strFrom ) ;
if (from_uri.host == undefined)
{
	Session.g_strGWIPIngress = Session.s_strPrimaryPSX;
}
else
{
	Session.g_strGWIPIngress = from_uri.host;
}
if (from_uri.port == undefined)
{
	Session.g_nGWPortIngress = 5060;
}
else
{
	Session.g_nGWPortIngress = from_uri.port;
}
if (from_uri.otg == undefined)
{
	Session.g_oCallLegA.strOrigTrunkGroup = "";
}
else
{
	Session.g_oCallLegA.strOrigTrunkGroup = from_uri.otg;
}
var contact = new SipNameAddr(Session.strContact);
/* Dial in, don't update Egress
if (contact.url.host == undefined)
{
	Session.g_strGWIPEgress = Session.s_strPrimaryPSX;
}
else
{
	Session.g_strGWIPEgress = contact.url.host;
}
if (contact.url.port == undefined)
{
	Session.g_nGWPortEgress = 5060;
}
else
{
	Session.g_nGWPortEgress = contact.url.port;
}
*/
Server.logInfo("CALLING js_calculate_uri_and_route");
Server.logInfo("BEFORE contact: " + Session.g_oCallLegA.strContact);
Server.logInfo("BEFORE record route: " + Session.g_oCallLegA.strRecordRoute);
Server.logInfo("BEFORE request Uri: " + Session.g_oCallLegA.strRequestUri);
Server.logInfo("BEFORE route: " + Session.g_oCallLegA.strRoute);
var bDialIn = true;
js_calculate_uri_and_route(bDialIn, Session.s_strSipVersion, Session.g_oCallLegA.strFrom, Session.g_oCallLegA.strContact, Session.g_oCallLegA.strRecordRoute, Session.g_oCallLegA.strRequestUri, Session.g_oCallLegA.strRoute);
Server.logInfo("AFTER contact: " + Session.g_oCallLegA.strContact);
Server.logInfo("AFTER record route: " + Session.g_oCallLegA.strRecordRoute);
Server.logInfo("AFTER request Uri: " + Session.g_oCallLegA.strRequestUri);
Server.logInfo("AFTER route: " + Session.g_oCallLegA.strRoute);
Server.logInfo("Call leg A request Uri is: " + Session.g_oCallLegA.strRequestUri);
// if no ANI, use this default
if (from_uri.user == undefined)
{
	Session.g_strOrigNbr = Session.s_strDefaultAni;
	Session.g_oCallLegA.strCallingNumber = Session.s_strDefaultAni;
	Session.g_strUsedDefaultANIFlag = "T";
}
else
{
	var myPhoneNumber = new String(from_uri.user);
	var myPhoneArray = myPhoneNumber.split(";");
	Session.g_oCallLegA.strCallingNumber = myPhoneArray[0];
	Session.g_strOrigNbr = myPhoneArray[0];
}
// get dnis
var myUri = new SipUrl(Session.strRequestUri);
var myString = new String(myUri.phoneNumber);
var myArray = myString.split(";");
Session.g_strAccessNumber = myArray[0];
Server.logInfo("ACCESS NUMBER IS: " + Session.g_strAccessNumber);
//mediaserver object
Session.g_oMS.strEndPoint = "";
Session.g_oMS.strConnectionId = "";
Session.g_oMS.strCallId = "";
Session.g_oMS.strContent = "";
Session.g_oMS.strConferenceId = "";	//use through out
Session.g_oMS.strType = Session.s_strConfMsType;
Session.g_oMS.bMuteFlag = false;
Session.g_oMS.bDeafFlag = false;
Session.g_oMS.bCurrentlyInConf = false;
Session.g_oMS.bCurrentlyConnected = false;
Session.g_oMS.nPacketizationPeriod = Session.s_nPacketizationPeriod;
// Session.g_oMS.nConferenceMaxParties = Session.s_nConferenceMaxParties;
Session.g_oMS.nConferenceMaxTalkers = Session.s_nConferenceMaxTalkers;
if (Session.g_bHandOff && !Session.g_bHandBack)
{
	Session.g_oMS.strCodec = Session.s_strFailoverCodec;
}
else
{
	Session.g_oMS.strCodec = Session.s_strCodec;
}

//ASN
Session.g_oMS.nNbrActiveSpeakers = Session.s_nNbrActiveSpeakers;
Session.g_oMS.nReportingInterval = Session.s_nReportingInterval;
Session.g_oMS.nDBThreshold = Session.s_nDBThreshold;
//AGC
Session.g_oMS.nAGCTargetLevelIn = Session.s_nAGCTargetLevelIn;
Session.g_oMS.nAGCMaxLevelIn = Session.s_nAGCMaxLevelIn;
Session.g_oMS.nAGCTargetLevelOut = Session.s_nAGCTargetLevelOut;
Session.g_oMS.nAGCMaxLevelOut = Session.s_nAGCMaxLevelOut;

//sub conference object
Session.g_oSubConfMS.strType = Session.s_strConfMsType;
if (Session.g_bHandOff && !Session.g_bHandBack)
{
	Session.g_oSubConfMS.strCodec = Session.s_strFailoverCodec;
}
else
{
	Session.g_oSubConfMS.strCodec = Session.s_strCodec;
}

//ASN
Session.g_oSubConfMS.nNbrActiveSpeakers = Session.s_nNbrActiveSpeakers;
Session.g_oSubConfMS.nReportingInterval = Session.s_nReportingInterval;
Session.g_oSubConfMS.nDBThreshold = Session.s_nDBThreshold;
//AGC
Session.g_oSubConfMS.nAGCTargetLevelIn = Session.s_nAGCTargetLevelIn;
Session.g_oSubConfMS.nAGCMaxLevelIn = Session.s_nAGCMaxLevelIn;
Session.g_oSubConfMS.nAGCTargetLevelOut = Session.s_nAGCTargetLevelOut;
Session.g_oSubConfMS.nAGCMaxLevelOut = Session.s_nAGCMaxLevelOut;

//temp conference mediaserver object
Session.g_oTempConf.strEndPoint = "";
Session.g_oTempConf.strConnectionId = "";
Session.g_oTempConf.strCallId = "";
Session.g_oTempConf.strContent = "";
Session.g_oTempConf.strConferenceId = "";	//use through out
Session.g_oTempConf.strType = Session.s_strConfMsType;
Session.g_oTempConf.bMuteFlag = false;
Session.g_oTempConf.bDeafFlag = false;
Session.g_oTempConf.bCurrentlyInConf = false;
Session.g_oTempConf.bCurrentlyConnected = false;
Session.g_oTempConf.nPacketizationPeriod = Session.s_nPacketizationPeriod;
// Session.g_oTempConf.nConferenceMaxParties = Session.s_nConferenceMaxParties;
Session.g_oTempConf.nConferenceMaxTalkers = Session.s_nConferenceMaxTalkers;
if (Session.g_bHandOff && !Session.g_bHandBack)
{
	Session.g_oTempConf.strCodec = Session.s_strFailoverCodec;
}
else
{
	Session.g_oTempConf.strCodec = Session.s_strCodec;
}
//ASN
Session.g_oTempConf.nNbrActiveSpeakers = Session.s_nNbrActiveSpeakers;
Session.g_oTempConf.nReportingInterval = Session.s_nReportingInterval;
Session.g_oTempConf.nDBThreshold = Session.s_nDBThreshold;
//AGC
Session.g_oTempConf.nAGCTargetLevelIn = Session.s_nAGCTargetLevelIn;
Session.g_oTempConf.nAGCMaxLevelIn = Session.s_nAGCMaxLevelIn;
Session.g_oTempConf.nAGCTargetLevelOut = Session.s_nAGCTargetLevelOut;
Session.g_oTempConf.nAGCMaxLevelOut = Session.s_nAGCMaxLevelOut;

//music on hold mediaserver object
Session.g_oMOH_MS.strEndPoint = "";
Session.g_oMOH_MS.strConnectionId = "";
Session.g_oMOH_MS.strCallId = "";
Session.g_oMOH_MS.strContent = "";
Session.g_oMOH_MS.strConferenceId = "";	//use through out
Session.g_oMOH_MS.strType = Session.s_strMohMsType;
Session.g_oMOH_MS.bMuteFlag = false;
Session.g_oMOH_MS.bDeafFlag = false;
Session.g_oMOH_MS.bCurrentlyInConf = false;
Session.g_oMOH_MS.bCurrentlyConnected = false;
Session.g_oMOH_MS.nPacketizationPeriod = Session.s_nPacketizationPeriod;
// Session.g_oMOH_MS.nConferenceMaxParties = Session.s_nConferenceMaxParties;
Session.g_oMOH_MS.nConferenceMaxTalkers = Session.s_nConferenceMaxTalkers;
if (Session.g_bHandOff && !Session.g_bHandBack)
{
	Session.g_oMOH_MS.strCodec = Session.s_strFailoverCodec;
}
else
{
	Session.g_oMOH_MS.strCodec = Session.s_strCodec;
}
//ASN
Session.g_oMOH_MS.nNbrActiveSpeakers = Session.s_nNbrActiveSpeakers;
Session.g_oMOH_MS.nReportingInterval = Session.s_nReportingInterval;
Session.g_oMOH_MS.nDBThreshold = Session.s_nDBThreshold;
//AGC
Session.g_oMOH_MS.nAGCTargetLevelIn = Session.s_nAGCTargetLevelIn;
Session.g_oMOH_MS.nAGCMaxLevelIn = Session.s_nAGCMaxLevelIn;
Session.g_oMOH_MS.nAGCTargetLevelOut = Session.s_nAGCTargetLevelOut;
Session.g_oMOH_MS.nAGCMaxLevelOut = Session.s_nAGCMaxLevelOut;

//music on hold mediaserver object
Session.g_oIVR_MS.strEndPoint = "";
Session.g_oIVR_MS.strConnectionId = "";
Session.g_oIVR_MS.strCallId = "";
Session.g_oIVR_MS.strContent = "";
Session.g_oIVR_MS.strConferenceId = "";	//use through out
Session.g_oIVR_MS.strType = Session.s_strIvrMsType;
Session.g_oIVR_MS.bMuteFlag = false;
Session.g_oIVR_MS.bDeafFlag = false;
Session.g_oIVR_MS.bCurrentlyInConf = false;
Session.g_oIVR_MS.bCurrentlyConnected = false;
Session.g_oIVR_MS.nPacketizationPeriod = Session.s_nPacketizationPeriod;
// Session.g_oIVR_MS.nConferenceMaxParties = Session.s_nConferenceMaxParties;
Session.g_oIVR_MS.nConferenceMaxTalkers = Session.s_nConferenceMaxTalkers;
if (Session.g_bHandOff && !Session.g_bHandBack)
{
	Session.g_oIVR_MS.strCodec = Session.s_strFailoverCodec;
}
else
{
	Session.g_oIVR_MS.strCodec = Session.s_strCodec;
}
//ASN
Session.g_oIVR_MS.nNbrActiveSpeakers = Session.s_nNbrActiveSpeakers;
Session.g_oIVR_MS.nReportingInterval = Session.s_nReportingInterval;
Session.g_oIVR_MS.nDBThreshold = Session.s_nDBThreshold;
//AGC
Session.g_oIVR_MS.nAGCTargetLevelIn = Session.s_nAGCTargetLevelIn;
Session.g_oIVR_MS.nAGCMaxLevelIn = Session.s_nAGCMaxLevelIn;
Session.g_oIVR_MS.nAGCTargetLevelOut = Session.s_nAGCTargetLevelOut;
Session.g_oIVR_MS.nAGCMaxLevelOut = Session.s_nAGCMaxLevelOut;

if (Session.s_strMSRetryFlag == "T")
{
	Session.g_oMS.bRetry = true;
	Session.g_oSubConfMS.bRetry = true;
	Session.g_oTempConf.bRetry = true;
	Session.g_oMOH_MS.bRetry = true;
	Session.g_oIVR_MS.bRetry = true;
}
else
{
	Session.g_oMS.bRetry = false;
	Session.g_oSubConfMS.bRetry = false;
	Session.g_oTempConf.bRetry = false;
	Session.g_oMOH_MS.bRetry = false;
	Session.g_oIVR_MS.bRetry = true;
}]]></script>
          </scripts>
        </action>
        <action id="41" plug-in="Pactolus.Branch.1" ><?xtml-editor x=378 y=560 ?>
          <!--re-invite from A or B?-->
          <results >
            <result name="Default" link="42" stubbed="0"/>
            <result name="re-invite from A or B" link="27" stubbed="0" >strCallId match g_oCallLegA.strCallId

OR strCallId match g_oCallLegB.strCallId</result>
          </results>
        </action>
        <action id="42" plug-in="Pactolus.SipResponse.1" ><?xtml-editor x=585 y=503 ?>
          <!--481 Transaction does not exist-->
          <sip-response xmlns="urn:www.pactolus.com:xtml:sip" remove-via="0" reliable="0" increment-cseq-first="0" increment-cseq-last="0" >
            <call-id >strCallId</call-id>
            <cseq >strCSeq</cseq>
            <from >strFrom</from>
            <status >"SIP/2.0 481 Call Leg/Transaction Does Not Exist"</status>
            <to >strTo</to>
            <via >strVia</via>
          </sip-response>
          <results >
            <result name="Default" link="28" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logError("ERROR: GOT REINVITE, BUT NEITHER FROM A OR B");

Server.logError("ERROR: FROM : " + Session.strFrom);

Server.logError("ERROR: TO: " + Session.strTo);

Server.logError("ERROR: CALL Id : " + Session.strCallId);

Server.logError("ERROR: CSEQ: " + Session.strCSeq);

Server.logError("ERROR: CONTENT: " + Session.strContent);]]></script>
          </scripts>
        </action>
        <action id="43" plug-in="Pactolus.Branch.1" ><?xtml-editor x=620 y=976 ?>
          <results >
            <result name="Default" link="45" stubbed="0"/>
            <result name="session timer == T|| Time==0" link="28" stubbed="1" >s_strSessionTimerFlag match "T"

OR g_nCkReInviteTime == 0</result>
          </results>
        </action>
        <action id="44" plug-in="Standard.Timer.1" ><?xtml-editor x=1118 y=968 ?>
          <!--ck reInvite timer-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lCkReInviteTimerIdA" duration="g_nCkReInviteTime"/>
          <results >
            <result name="Default" link="28" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[//Session.g_lLastReInviteTime = Server.getUTCTime();

Session.g_bCkReInviteTimerFlagA = true;]]></script>
          </scripts>
        </action>
        <action id="45" plug-in="Standard.Timer.1" ><?xtml-editor x=872 y=970 ?>
          <!--stop ck reInvite timer-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="0" id="g_lCkReInviteTimerIdA" duration=""/>
          <results >
            <result name="Default" link="44" stubbed="0"/>
          </results>
        </action>
        <action id="46" plug-in="Pactolus.Branch.1" ><?xtml-editor x=353 y=863 ?>
          <!--re-invite from A-->
          <results >
            <result name="Default" link="49" stubbed="0"/>
            <result name="re-invite from A" link="43" stubbed="0" >strCallId match g_oCallLegA.strCallId</result>
          </results>
        </action>
        <action id="47" plug-in="Standard.Timer.1" ><?xtml-editor x=1101 y=827 ?>
          <!--ck reInvite timer B-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lCkReInviteTimerIdB" duration="g_nCkReInviteTime"/>
          <results >
            <result name="Default" link="28" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[//Session.g_lLastReInviteTime = Server.getUTCTime();

Session.g_bCkReInviteTimerFlagB = true;]]></script>
          </scripts>
        </action>
        <action id="48" plug-in="Standard.Timer.1" ><?xtml-editor x=855 y=829 ?>
          <!--stop ck reInvite timer B-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="0" id="g_lCkReInviteTimerIdB" duration=""/>
          <results >
            <result name="Default" link="47" stubbed="0"/>
          </results>
        </action>
        <action id="49" plug-in="Pactolus.Branch.1" ><?xtml-editor x=603 y=835 ?>
          <results >
            <result name="Default" link="48" stubbed="0"/>
            <result name="session timer == T|| Time==0" link="28" stubbed="1" >s_strSessionTimerFlag match "T"

OR g_nCkReInviteTime == 0</result>
          </results>
        </action>
        <action id="50" plug-in="Pactolus.Branch.1" ><?xtml-editor x=136 y=924 ?>
          <!--from A and HOLD?-->
          <results >
            <result name="Default" link="46" stubbed="0"/>
            <result name="f_bTreatAsBYE" link="51" stubbed="0" >f_bTreatAsBYE == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[var myContent = new Sdp(Session.strContent);

Server.logInfo("strCallId: " + Session.strCallId);

Server.logInfo("Content.connection.address: " + myContent.connection.address);

Server.logInfo("Content.subject: " + myContent.subject);

if (myContent.connection.address == "0.0.0.0" && myContent.subject.indexOf("ATA186") == 0)

{

	Server.logInfo("INVITE FROM ATA PHONE , WITH NULL SDP, TREAT IT AS BYE");

	Session.f_bTreatAsBYE = true;

}

else

{

	Session.f_bTreatAsBYE = false;

}]]></script>
          </scripts>
        </action>
        <action id="51" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=367 y=1102 ?>
          <!--"TreatAsBye"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;TreatAsBye&quot;" return="" external-function="0" library="" >
            <parameter >strCallId</parameter>
          </function>
          <results >
            <result name="Default" link="52" stubbed="0"/>
          </results>
        </action>
        <action id="52" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=619 y=1096 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
        </action>
        <action id="53" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1033 y=179 ?>
          <!--HandoffToProxy-->
          <results >
            <result name="Default" link="28" stubbed="1"/>
            <result name="g_bWrongSiteHandOff" link="54" stubbed="0" >g_nRedirectStatus != 3

AND g_bWrongSiteHangOff == true</result>
          </results>
        </action>
        <action id="54" plug-in="Pactolus.Handoff.1" ><?xtml-editor x=1291 y=175 ?>
          <!--conf_proxy.xml-->
          <handoff xmlns="urn:www.pactolus.com:xtml:communication" application="f_strHandoffToApp" session="f_strTargetSession"/>
          <results >
            <result name="Default" link="56" stubbed="0"/>
            <result name="Success" link="55" stubbed="1"/>
            <result name="No Session"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.strFrom = Session.g_oCallLegA.strFrom;

Session.strTo = Session.g_oCallLegA.strTo;

Session.strCSeq = Session.g_oCallLegA.strCSeq;

Session.strRecordRoute = Session.g_oCallLegA.strRecordRoute;

Session.strRoute = Session.g_oCallLegA.strRoute;

if (Session.g_nAlternateSitePort > 0)

{

	Server.logInfo("ALTERNATE SITE PORT > 0");

// 	Session.strSubject = "handoff=\"2\";passcode=\"" + Session.g_strPassCode + "\";attendeeId=\"" + Session.g_strAttendeeId + "\";sendtoIP=\"" + Session.g_strAlternateSiteIP + ":" + Session.g_nAlternateSitePort + "\"";

	Session.strSubject = "handoff=\"2\";passcode=\"";

	Session.strSubject += Session.g_strPassCode;

	Session.strSubject += "\";attendeeId=\"";

	Session.strSubject += Session.g_strAttendeeId;

	Session.strSubject += "\";sendtoIP=\"";

	Session.strSubject += Session.g_strAlternateSiteIP;

	Session.strSubject += ":";

	Session.strSubject += Session.g_nAlternateSitePort;

	Session.strSubject += "\"";

	Server.logInfo("SUBJECT IS: " + Session.strSubject);

}

else

{

	Server.logInfo("ALTERNATE SITE PORT == 0");

	// Session.strSubject = "handoff=\"2\";passcode=\"" + Session.g_strPassCode + "\";attendeeId=\"" + Session.g_strAttendeeId + "\";sendtoIP=\"" + Session.g_strAlternateSiteIP + "\"";

	Session.strSubject = "handoff=\"2\";passcode=\"";

	Session.strSubject += Session.g_strPassCode;

	Session.strSubject += "\";attendeeId=\"";

	Session.strSubject += Session.g_strAttendeeId;

	Session.strSubject += "\";sendtoIP=\"";

	Session.strSubject += Session.g_strAlternateSiteIP;

	Session.strSubject += "\"";	

	Server.logInfo("SUBJECT IS: " + Session.strSubject);

}]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)

{

	Server.logError("ERROR: FAIL TO HAND OFF TO " + Session.f_strHandoffToApp + ", exit on : " + Result.name ) ;

}

else

{

	Server.logInfo("Recipient of handoff was: " + Session.f_strTargetSession ) ;

}

//set the termination code to successful. If not it is reset to 6
Session.g_nTerminationReason = 31;]]></script>
          </scripts>
        </action>
        <action id="55" plug-in="Standard.EndSession.1" ><?xtml-editor x=1773 y=168 ?>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nCallerCurrentState = Session.s_nStateEndCall;]]></script>
          </scripts>
        </action>
        <action id="56" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1545 y=171 ?>
          <!--"HangUpCaller"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpCaller&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="55" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 32;]]></script>
          </scripts>
        </action>
        <action id="57" plug-in="Pactolus.SipResponse.1" ><?xtml-editor x=1046 y=326 ?>
          <!--200 OK @ NO SDP-->
          <sip-response xmlns="urn:www.pactolus.com:xtml:sip" remove-via="0" reliable="0" increment-cseq-first="0" increment-cseq-last="0" >
            <call-id >strCallId</call-id>
            <contact >g_strContact</contact>
            <cseq >strCSeq</cseq>
            <from >strFrom</from>
            <status >"SIP/2.0 200 OK"</status>
            <to >strTo</to>
            <via >strVia</via>
          </sip-response>
          <results >
            <result name="Default" link="63" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="58" plug-in="Pactolus.Branch.1" ><?xtml-editor x=822 y=331 ?>
          <!--HandBack?-->
          <results >
            <result name="Default" link="57" stubbed="0"/>
            <result name="f_nHandOffNumber==3" link="2" stubbed="1" >f_nHandOffNumber == 3</result>
          </results>
        </action>
        <action id="59" plug-in="Pactolus.SipResponse.1" ><?xtml-editor x=1054 y=543 ?>
          <!--200 OK @ NO SDP-->
          <sip-response xmlns="urn:www.pactolus.com:xtml:sip" remove-via="0" reliable="0" increment-cseq-first="0" increment-cseq-last="0" >
            <call-id >strCallId</call-id>
            <contact >g_strContact</contact>
            <cseq >strCSeq</cseq>
            <from >strFrom</from>
            <status >"SIP/2.0 200 OK"</status>
            <to >strTo</to>
            <via >strVia</via>
          </sip-response>
          <results >
            <result name="Default" link="62" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="60" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1477 y=592 ?>
          <!--authenticate passcode-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;Main&quot;" return="" external-function="0" library="" >
            <parameter >f_nNextState</parameter>
          </function>
          <results >
            <result name="Default" link="61" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[
Session.f_nNextState = Session.s_nStateGetPasscode;]]></script>
          </scripts>
        </action>
        <action id="61" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1650 y=625 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
        </action>
        <action id="62" plug-in="Standard.WaitEvent.1" ><?xtml-editor x=1270 y=562 ?>
          <wait xmlns="urn:www.pactolus.com:xtml:communication" timeout="s_nTimeout" recv-name="strEvent" >
            <msg name="Pactolus.EveSipAck.1" >
              <parameter ></parameter>
              <parameter ></parameter>
              <parameter ></parameter>
              <parameter ></parameter>
              <parameter ></parameter>
              <parameter ></parameter>
              <parameter ></parameter>
              <parameter ></parameter>
              <parameter ></parameter>
              <parameter ></parameter>
              <parameter ></parameter>
              <parameter ></parameter>
              <parameter ></parameter>
              <parameter ></parameter>
              <parameter ></parameter>
              <parameter ></parameter>
              <parameter ></parameter>
              <parameter ></parameter>
              <parameter ></parameter>
              <parameter ></parameter>
              <parameter ></parameter>
              <parameter ></parameter>
              <parameter ></parameter>
              <parameter ></parameter>
              <parameter ></parameter>
              <parameter ></parameter>
            </msg>
          </wait>
          <results >
            <result name="Default" link="56" stubbed="1"/>
            <result name="Success" link="60" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="63" plug-in="Standard.WaitEvent.1" ><?xtml-editor x=1285 y=327 ?>
          <!--for ACK-->
          <wait xmlns="urn:www.pactolus.com:xtml:communication" timeout="s_nTimeout" recv-name="strEvent" >
            <msg name="Pactolus.EveSipAck.1" >
              <parameter ></parameter>
              <parameter ></parameter>
              <parameter ></parameter>
              <parameter ></parameter>
              <parameter ></parameter>
              <parameter ></parameter>
              <parameter ></parameter>
              <parameter ></parameter>
              <parameter ></parameter>
              <parameter ></parameter>
              <parameter ></parameter>
              <parameter ></parameter>
              <parameter ></parameter>
              <parameter ></parameter>
              <parameter ></parameter>
              <parameter ></parameter>
              <parameter ></parameter>
              <parameter ></parameter>
              <parameter ></parameter>
              <parameter ></parameter>
              <parameter ></parameter>
              <parameter ></parameter>
              <parameter ></parameter>
              <parameter ></parameter>
              <parameter ></parameter>
              <parameter ></parameter>
            </msg>
          </wait>
          <results >
            <result name="Default" link="56" stubbed="1"/>
            <result name="Success" link="2" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="64" plug-in="Pactolus.Sleep.1" ><?xtml-editor x=1042 y=60 ?>
          <!--2 mins-->
          <sleep xmlns="urn:www.pactolus.com:xtml:application" duration="120"/>
          <results >
            <result name="Default" link="66" stubbed="0"/>
          </results>
        </action>
        <action id="66" plug-in="Pactolus.SipRefer.1" ><?xtml-editor x=1298 y=56 ?>
          <sip-refer xmlns="urn:www.pactolus.com:xtml:sip" add-record-route="0" add-via="0" refer-to="&quot;conference&quot;" referred-by="&quot;conference&quot;" increment-cseq-first="0" increment-cseq-last="0" >
            <call-id >g_oCallLegA.strCallId</call-id>
            <contact >g_oCallLegA.strRequestUri</contact>
            <cseq >g_oCallLegA.strCSeq</cseq>
            <from >g_oCallLegA.strFrom</from>
            <request-uri >strRequestUri</request-uri>
            <to >g_oCallLegA.strTo</to>
            <via >g_oCallLegA.strVia</via>
          </sip-refer>
          <results >
            <result name="Default" link="55" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
      </actions>
    </function>
    <function name="HangUpCaller" start="29" event="HangUpCaller" returns="i4" >
      <local-vars >
        <var name="f_nReturnCode" type="i4" >-1</var>
        <var name="f_strCSeq" type="string" ></var>
        <var name="f_bSendMoreCancel" type="boolean" >0</var>
        <var name="f_oMS" type="object" ></var>
      </local-vars>
      <actions >
        <action id="29" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=163 y=158 ?>
          <!--Send party leave-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;PartyLeave&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="46" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: HangUpCaller");]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1299 y=425 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nSuccess"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nCallerCurrentState = Session.s_nStateEndCall;]]></script>
          </scripts>
        </action>
        <action id="7" plug-in="Pactolus.Branch.1" ><?xtml-editor x=25 y=685 ?>
          <!--Dial In?-->
          <results >
            <result name="Default" link="11" stubbed="0"/>
            <result name="g_strOutdialFlag = &quot;T&quot;;" link="20" stubbed="0" >g_strOutdialFlag match "T"</result>
          </results>
        </action>
        <action id="11" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=267 y=674 ?>
          <!--HangUpPartyA-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpParty&quot;" return="f_nReturnCode" external-function="1" library="lib_callcontrol.xml" >
            <parameter >g_oCallLegA</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="30" stubbed="0"/>
          </results>
        </action>
        <action id="13" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=517 y=887 ?>
          <!--HangUpPartyB-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpParty&quot;" return="f_nReturnCode" external-function="1" library="lib_callcontrol.xml" >
            <parameter >g_oCallLegB</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="30" stubbed="1"/>
          </results>
        </action>
        <action id="14" plug-in="Pactolus.Branch.1" ><?xtml-editor x=849 y=143 ?>
          <!--error msg > 0 ?-->
          <results >
            <result name="Default" link="51" stubbed="0"/>
            <result name="error msg &gt; 0 ?" link="24" stubbed="0" >g_nErrorMsgNumber &gt; 0</result>
          </results>
        </action>
        <action id="20" plug-in="Pactolus.Branch.1" ><?xtml-editor x=259 y=1099 ?>
          <!--currently dialing out?-->
          <results >
            <result name="Default" link="13" stubbed="0"/>
            <result name="oCallLegB.bCurrentlyDialing==true" link="45" stubbed="0" >g_oCallLegB.bCurrentlyDialing == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_strCSeq = Session.g_oCallLegB.strCSeq;

Server.logInfo("CSEQ BEFORE CANCEL: " + Session.f_strCSeq);]]></script>
          </scripts>
        </action>
        <action id="21" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=526 y=983 ?>
          <!--Cancel PartyB-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;CancelParty&quot;" return="f_nReturnCode" external-function="1" library="lib_callcontrol.xml" >
            <parameter >g_oCallLegB</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="30" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[//work around Cisco2, it added the tag to the To field in the non final response

if ("CISCO" == Session.s_strGatewayType)

{

	Session.g_oCallLegB.strTo = js_strip_tag(Session.g_oCallLegB.strTo);

}]]></script>
          </scripts>
        </action>
        <action id="22" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1291 y=111 ?>
          <!--goodbye-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="f_oMS.strConnectionId" endpoint="f_oMS.strEndPoint" callid="f_oMS.strCallId" repeat="1" timeout="20" ms-type="f_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >322</audio>
          </play>
          <results >
            <result name="Default" link="7" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="24" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1084 y=261 ?>
          <!--g_nErrorMsgNumber-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >365</audio>
            <audio type="number" >g_nErrorMsgNumber</audio>
          </play>
          <results >
            <result name="Default" link="51" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="30" plug-in="Pactolus.Branch.1" ><?xtml-editor x=797 y=663 ?>
          <results >
            <result name="Default" link="36" stubbed="0"/>
            <result name="g_bPrivateTalkInConference" link="48" stubbed="0" >g_bPrivateTalkInConference == true</result>
            <result name="BeginRequest" link="32" stubbed="0" >g_nCallerCurrentState == s_nStateBeginRequest

OR g_nCallerCurrentState == s_nStateRouteToCsr

OR g_nCallerCurrentState == s_nStateZeroOutToCsr</result>
            <result name="BeginAssignment" link="31" stubbed="0" >g_nCallerCurrentState == s_nStateBeginAssignment

OR g_nCallerCurrentState == s_nStateCsrPutOnHold

OR g_nCallerCurrentState == s_nStateCsrPutOffHold</result>
            <result name="Requeue" link="33" stubbed="0" >g_nCallerCurrentState == s_nStateRequeue</result>
            <result name="g_bSentACDBeginRequest" link="39" stubbed="0" >g_bSentACDBeginRequest == true</result>
          </results>
        </action>
        <action id="31" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1116 y=885 ?>
          <!--s_strMSG_END_REQUEST_CSR-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strACDControllerIP" transaction="s_strZeroTransactionId" message-name="s_strMsgEndRequestCSR" destination-port="g_nACDControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;RequestId&quot;" value="g_lCSRRequestId"/>
            <parameter tag="&quot;AssignmentId&quot;" value="g_lCSRAssignmentId"/>
          </SOAP>
          <results >
            <result name="Default" link="34" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[Session.g_bSentACDBeginRequest = false;]]></script>
          </scripts>
        </action>
        <action id="32" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1116 y=753 ?>
          <!--s_strMSG_END_REQUEST_CSR-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strACDControllerIP" transaction="s_strZeroTransactionId" message-name="s_strMsgEndRequestCSR" destination-port="g_nACDControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;RequestId&quot;" value="g_lCSRRequestId"/>
            <parameter tag="&quot;AssignmentId&quot;" value="0"/>
          </SOAP>
          <results >
            <result name="Default" link="35" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[Session.g_bSentACDBeginRequest = false;]]></script>
          </scripts>
        </action>
        <action id="33" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1110 y=1035 ?>
          <!--s_strMSG_END_REQUEST_CSR-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strACDControllerIP" transaction="s_strZeroTransactionId" message-name="s_strMsgEndRequestCSR" destination-port="g_nACDControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;RequestId&quot;" value="g_lCSRRequestId"/>
            <parameter tag="&quot;AssignmentId&quot;" value="0"/>
          </SOAP>
          <results >
            <result name="Default" link="35" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[Session.g_bSentACDBeginRequest = false;]]></script>
          </scripts>
        </action>
        <action id="34" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1357 y=886 ?>
          <!--"psAPISceEndAssignment"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceEndAssignment&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="35" stubbed="1"/>
          </results>
        </action>
        <action id="35" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1345 y=750 ?>
          <!--"psAPISceEndRequest"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceEndRequest&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="36" stubbed="1"/>
          </results>
        </action>
        <action id="36" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1075 y=430 ?>
          <!--stop timer if needed-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;StopTimer&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="2" stubbed="0"/>
          </results>
        </action>
        <action id="39" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1093 y=1174 ?>
          <!--s_strMSG_END_REQUEST_CSR-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strACDControllerIP" transaction="s_strZeroTransactionId" message-name="s_strMsgEndRequestCSR" destination-port="g_nACDControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;RequestId&quot;" value="g_lCSRRequestId"/>
            <parameter tag="&quot;AssignmentId&quot;" value="g_lCSRAssignmentId"/>
          </SOAP>
          <results >
            <result name="Default" link="40" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[Session.g_bSentACDBeginRequest = false;]]></script>
          </scripts>
        </action>
        <action id="40" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1342 y=1169 ?>
          <!--sent APIBeginAssignment?-->
          <results >
            <result name="Default" link="43" stubbed="1"/>
            <result name="g_bSentAPIBeginAssignment" link="41" stubbed="0" >g_bSentAPIBeginAssignment == true</result>
          </results>
        </action>
        <action id="41" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1604 y=1171 ?>
          <!--"psAPISceEndAssignment"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceEndAssignment&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="43" stubbed="0"/>
          </results>
        </action>
        <action id="42" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2047 y=1161 ?>
          <!--"psAPISceEndRequest"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceEndRequest&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="36" stubbed="1"/>
          </results>
        </action>
        <action id="43" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1823 y=1166 ?>
          <!--sent APIBeginRequest?-->
          <results >
            <result name="Default" link="36" stubbed="1"/>
            <result name="g_bSentAPIBeginRequest" link="42" stubbed="0" >g_bSentAPIBeginRequest == true</result>
          </results>
        </action>
        <action id="44" plug-in="Pactolus.Branch.1" ><?xtml-editor x=751 y=1092 ?>
          <!--send more cancel?-->
          <results >
            <result name="Default" link="30" stubbed="0"/>
            <result name="f_bSendMoreCancel" link="45" stubbed="1" >f_bSendMoreCancel == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[var myCSeq = new SipCSeq(Session.f_strCSeq);

if (myCSeq.value > 1100)

{

	myCSeq.value--;

	Session.f_strCSeq = myCSeq.encode();

	Session.f_bSendMoreCancel = true;

	Server.logInfo("MORE CANCEL TO SEND, CSEQ: " + Session.f_strCSeq);

}

else

{

	//don't want to try to send another CANCEL

	Session.f_bSendMoreCancel = false;

}]]></script>
          </scripts>
        </action>
        <action id="45" plug-in="Pactolus.SipCancel.1" ><?xtml-editor x=548 y=1094 ?>
          <!--B Leg-->
          <sip-bye xmlns="urn:www.pactolus.com:xtml:sip" add-record-route="0" add-via="1" timeout="30" final-response-status="g_strSIPStatus" handle-responses="1" increment-cseq-first="0" increment-cseq-last="0" >
            <call-id >g_oCallLegB.strCallId</call-id>
            <contact >g_strContact</contact>
            <cseq >f_strCSeq</cseq>
            <from >g_oCallLegB.strFrom</from>
            <record-route >g_oCallLegB.strRecordRoute</record-route>
            <request-uri >g_oCallLegB.strRequestUri</request-uri>
            <route >g_oCallLegB.strRoute</route>
            <to >g_oCallLegB.strTo</to>
          </sip-bye>
          <results >
            <result name="Default" link="44" stubbed="0"/>
            <result name="Success"/>
            <result name="Timeout"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[//work around Cisco2, it added the tag to the To field in the non final response

if ("CISCO" == Session.s_strGatewayType)

{

	Session.g_oCallLegB.strTo = js_strip_tag(Session.g_oCallLegB.strTo);

}]]></script>
            <script language="javascript" timing="last" ><![CDATA[Session.g_oCallLegB.bConnected = false;

Session.g_oCallLegB.bCurrentlyDialing = false;

if (Result.id != 2)

{

	Server.logError("CANCEL PARTY B FAILS, EXIT ON: " + Result.name);

}]]></script>
          </scripts>
        </action>
        <action id="46" plug-in="Pactolus.Branch.1" ><?xtml-editor x=389 y=151 ?>
          <!--currently dialing out?-->
          <results >
            <result name="Default" link="50" stubbed="0"/>
            <result name="oCallLegB.bCurrentlyDialing==true" link="45" stubbed="1" >g_oCallLegB.bCurrentlyDialing == true</result>
            <result name="Not connected to MS" link="7" stubbed="1" >f_oMS.bCurrentlyInConf == false

AND f_oMS.bCurrentlyConnected == false</result>
            <result name="!g_bNotifyMS" link="7" stubbed="1" >g_bNotifyMS == false</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[	if (true == Session.g_oMOH_MS.bCurrentlyConnected || true == Session.g_oMOH_MS.bCurrentlyInConf)

	{

		Session.f_oMS = Session.g_oMOH_MS;

	}

	else if (true == Session.g_oTempConf.bCurrentlyConnected || true == Session.g_oTempConf.bCurrentlyInConf)

	{

		Session.f_oMS = Session.g_oTempConf;

	}

	else

	{

		Session.f_oMS = Session.g_oMS;

	}

	Session.f_oMS.bMuteFlag = true;

	Session.f_oMS.bDeafFlag = true;

Server.logInfo("Session.f_oMS.bCurrentlyConnected is: " + Session.f_oMS.bCurrentlyConnected);

Server.logInfo("Session.f_oMS.bCurrentlyInConf is: " + Session.f_oMS.bCurrentlyInConf);]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (2 == Result.id)

{

	Session.f_strCSeq = Session.g_oCallLegB.strCSeq;

	Server.logInfo("CSEQ BEFORE CANCEL: " + Session.f_strCSeq);

}]]></script>
          </scripts>
        </action>
        <action id="47" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1370 y=589 ?>
          <!--Remove member from temp conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;RemoveMemberFromConference&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
          </function>
          <results >
            <result name="Default" link="36" stubbed="1"/>
          </results>
        </action>
        <action id="48" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1114 y=587 ?>
          <!--PrivateTalkHangup-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="&quot;PrivateTalkHangup&quot;" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;ConferenceId&quot;" value="g_strConfScheduleId"/>
            <parameter tag="&quot;moderatorKey&quot;" value="g_strModeratorKey"/>
          </SOAP>
          <results >
            <result name="Default" link="47" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "PRIVATE TALK HANGUP";

Server.logInfo("SENDING PrivateTalkHangup TO CONFERENCE CONTROLLER");]]></script>
            <script language="javascript" timing="last" ><![CDATA[Session.g_bPrivateTalkInConference = false;]]></script>
          </scripts>
        </action>
        <action id="50" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=607 y=151 ?>
          <!--Modify member-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ChangeToDataMode&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >f_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="14" stubbed="0"/>
          </results>
        </action>
        <action id="51" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1071 y=117 ?>
          <!--Event conf?-->
          <results >
            <result name="Default" link="22" stubbed="0"/>
            <result name="g_nDnisIdentifyConferenceFlag == 1" link="7" stubbed="1" >g_nDnisIdentifiedConfFlag == 1</result>
          </results>
        </action>
      </actions>
    </function>
    <function name="Main" start="76" event="Main" returns="void" >
      <parameters >
        <parameter name="nCurrentState" type="i4" pass="byref"/>
      </parameters>
      <local-vars >
        <var name="f_nReturnCode" type="i4" >-1</var>
        <var name="f_nCurrentState" type="i4" >0</var>
        <var name="f_bFirstCaller" type="boolean" >0</var>
        <var name="f_bNullString" type="boolean" >0</var>
        <var name="f_nCallLegCount" type="i4" >0</var>
        <var name="f_bInitializeFails" type="boolean" >0</var>
        <var name="f_bRouteToCSR" type="boolean" >0</var>
        <var name="f_strConfControllerIP" type="string" ></var>
        <var name="f_nConfControllerPort" type="i4" >0</var>
        <var name="f_strTransactionId" type="string" ></var>
        <var name="f_strReturnMsg" type="string" ></var>
        <var name="f_bMoreThanFiveSecs" type="boolean" >0</var>
        <var name="bSameConferenceId" type="boolean" >0</var>
        <var name="nSetConfResourceRetry" type="i4" >0</var>
        <var name="strPreviousConferenceId" type="string" ></var>
        <var name="nPromptFirstCaller" type="i4" >0</var>
        <var name="bRecordToConfBlade" type="boolean" >0</var>
      </local-vars>
      <actions >
        <action id="76" plug-in="Pactolus.Branch.1" ><?xtml-editor x=108 y=836 ?>
          <!--set current state-->
          <results >
            <result name="Default" link="1" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: Main");
Session.f_nCurrentState = Session.nCurrentState;]]></script>
          </scripts>
        </action>
        <action id="1" plug-in="Pactolus.Branch.1" ><?xtml-editor x=362 y=833 ?>
          <!--What is the current state?-->
          <results >
            <result name="Default" link="19" stubbed="0"/>
            <result name="InitializeConf" link="25" stubbed="0" >f_nCurrentState == s_nStateInitializeConf</result>
            <result name="Direct caller to MS" link="151" stubbed="0" >f_nCurrentState == s_nStateDirectToMS</result>
            <result name="Get Pass Code" link="111" stubbed="0" >f_nCurrentState == s_nStateGetPasscode</result>
            <result name="Create A Conference" link="38" stubbed="0" >f_nCurrentState == s_nStateCreateConference</result>
            <result name="Set Conference Resource" link="15" stubbed="0" >f_nCurrentState == s_nStateSetConfResource</result>
            <result name="Add To A Conference" link="201" stubbed="0" >f_nCurrentState == s_nStateAddToConference</result>
            <result name="Response Unavailable" link="20" stubbed="0" >f_nCurrentState == s_nStateReplyUnavailable</result>
            <result name="End Session" link="66" stubbed="0" >f_nCurrentState == s_nStateEndCall</result>
            <result name="Wait For Moderator" link="28" stubbed="0" >f_nCurrentState == s_nStateWaitForMod</result>
            <result name="Route to CSR" link="73" stubbed="0" >f_nCurrentState == s_nStateRouteToCsr</result>
            <result name="HandOff" link="129" stubbed="0" >f_nCurrentState == s_nStateHandoff</result>
            <result name="Route to TP CSR" link="169" stubbed="0" >f_nCurrentState == s_nStateRouteToThirdPartyCsr</result>
            <result name="EventConfGetPasscode" link="176" stubbed="1" >f_nCurrentState == s_nStateEventConfGetPasscode</result>
            <result name="GetCustomPasscode" link="210" stubbed="0" >f_nCurrentState == s_nStateGetCustomPasscode</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: IN MAIN FUNCTION");

Session.f_nReturnCode = 0;]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=888 y=227 ?>
          <!--Direct caller to MS-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DirectCallerToMS&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oCallLegA</parameter>
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="170" stubbed="0"/>
            <result name="SUCCESS" link="26" stubbed="1" >f_nReturnCode == s_nSuccess</result>
            <result name="CALLER HUNG UP" link="1" stubbed="1" >f_nReturnCode == s_nCallerHungup</result>
            <result name="RESOURCE_UNAVAILABLE" link="153" stubbed="0" >f_nReturnCode ==  s_nResourceUnavailable</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (2 == Result.id)

{

	Session.g_bSentFinalResponse = true;

	Session.g_strSIPStatus = "200";

}

else if (3 == Result.id)

{

	Session.f_nCurrentState = Session.s_nStateEndCall;

	Session.g_nTerminationReason = 10;

	Session.g_strSIPStatus = "200"

}

else

{
	
	Server.logError("An error occurred trying to direct caller to MS.  ReturnCode from DirectCallerToMS is <" + Session.f_nReturnCode + ">");

}]]></script>
          </scripts>
        </action>
        <action id="4" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1190 y=576 ?>
          <!--Get Pass Code-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;GetPassCode&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="33" stubbed="0"/>
            <result name="SUCCESS" link="6" stubbed="0" >f_nReturnCode == s_nFirstCaller

OR f_nReturnCode == s_nNonFirstCaller

OR f_nReturnCode == s_nWrongSite</result>
            <result name="WFM or CSR" link="1" stubbed="1" >f_nReturnCode == s_nWaitForMod

OR f_nReturnCode == s_nStateRouteToCsr</result>
            <result name="RouteTPCSR" link="1" stubbed="1" >f_nReturnCode == s_nStateRouteToThirdPartyCsr</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[Session.g_bTPCSRRouteInProgress = false;

Session.g_nTempInt = Session.f_nReturnCode;

if (3 == Result.id)

{

	if (Session.s_nWaitForMod == Session.f_nReturnCode)

		Session.f_nCurrentState = Session.s_nStateWaitForMod;

	else

	{

		Session.f_nCurrentState = Session.s_nStateRouteToCsr;

		Session.g_nCSRRouteReasonCode = 2;  //exceed passcode validation attemps

	}

}
if (4 == Result.id)
{
	Session.f_nCurrentState = Session.s_nStateRouteToThirdPartyCsr;
}]]></script>
          </scripts>
        </action>
        <action id="6" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1482 y=675 ?>
          <!--Delete MS Connection-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DeleteMSConnection&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="126" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Session.g_nTempInt == Session.s_nFirstCaller && !Session.g_bNoCreateConfFirstCaller)
{
	Session.f_nCurrentState = Session.s_nStateCreateConference;
}
else if (Session.g_nTempInt == Session.s_nNonFirstCaller || Session.g_bNoCreateConfFirstCaller)
{
	Session.g_oMS.strConferenceId = Session.g_strConfResource;
	Session.f_nCurrentState = Session.s_nStateAddToConference;
}
else
{
	Session.f_nCurrentState = Session.s_nStateEndCall;
}]]></script>
          </scripts>
        </action>
        <action id="15" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=988 y=1120 ?>
          <!--set conference resource-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceSetConfResource&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="62" stubbed="0"/>
            <result name="SUCCESS" link="199" stubbed="1" >f_nReturnCode == s_nSuccess</result>
            <result name="s_nResourceAlreadyInUsed" link="174" stubbed="0" >f_nReturnCode == s_nResourceAlreadyInUsed</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: SET AUDIO MODE");
if (0 == Session.g_nDefaultAudioMode)
{
	Server.logInfo("INFO: SET CONFERENCE MODE");
	Session.g_oMS.bMuteFlag = false;
	Session.g_oMS.bDeafFlag = false;
	Session.g_bMutedState = false;
	Session.g_bHoldState = false;
}
else if (2 == Session.g_nDefaultAudioMode)
{
	Server.logInfo("INFO: SET MUTE MODE");
	Session.g_oMS.bMuteFlag = true;
	Session.g_oMS.bDeafFlag = false;
	Session.g_bMutedState = true;
	Session.g_bHoldState = false;
}
else
{
	Server.logInfo("INFO: SET MOH MODE");
	Session.g_oMS.bMuteFlag = true;
	Session.g_oMS.bDeafFlag = true;
	Session.g_bMutedState = false;
	Session.g_bHoldState = true;
}]]></script>
          </scripts>
        </action>
        <action id="19" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=583 y=41 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="20" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=977 y=1843 ?>
          <!--response unavailable-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;Unavailable&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="1" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[Session.f_nCurrentState = Session.s_nStateEndCall;]]></script>
          </scripts>
        </action>
        <action id="25" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=638 y=111 ?>
          <!--Initialize Conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceInitConfSession&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="109" stubbed="0"/>
          </results>
        </action>
        <action id="26" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1618 y=175 ?>
          <!--GET PASS CODE?-->
          <results >
            <result name="Default" link="1" stubbed="1"/>
            <result name="END CALL?" link="67" stubbed="0" >f_nCurrentState == s_nStateEndCall</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (true == Session.f_bInitializeFails)
{
	Session.f_nCurrentState = Session.s_nStateEndCall;
}
else
{
	if (true == Session.f_bRouteToCSR)
	{
		Session.f_nCurrentState = Session.s_nStateRouteToCsr;
	}
	else
	{
		if (1 == Session.g_nDnisIdentifiedConfFlag)
			Session.f_nCurrentState = Session.s_nStateEventConfGetPasscode;
		else if ("GC" == Session.s_strCustomerCode)
			Session.f_nCurrentState = Session.s_nStateGetCustomPasscode;
		else
			Session.f_nCurrentState = Session.s_nStateGetPasscode;
			
	}
}]]></script>
          </scripts>
        </action>
        <action id="28" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=951 y=2049 ?>
          <!--WaitForModerator-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;WaitForModerator&quot;" return="g_nTempInt" external-function="0" library=""/>
          <results >
            <result name="Default" link="1" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Session.g_nTempInt == Session.s_nFirstCaller && !Session.g_bNoCreateConfFirstCaller)
{
	Session.f_nCurrentState = Session.s_nStateCreateConference;
}
else if (Session.g_nTempInt == Session.s_nNonFirstCaller || Session.g_bNoCreateConfFirstCaller)
{
	//already set got the conference endpoint from function WaitForModerator
	Session.f_nCurrentState = Session.s_nStateAddToConference;
}
else
{
	Session.f_nCurrentState = Session.g_nTempInt;
}]]></script>
          </scripts>
        </action>
        <action id="33" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1467 y=544 ?>
          <!--Hang up caller-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpCaller&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="1" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_nCurrentState = Session.s_nStateEndCall;]]></script>
          </scripts>
        </action>
        <action id="38" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=989 y=726 ?>
          <!--CreateAConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;CreateConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="84" stubbed="0"/>
            <result name="SUCCESS&amp;&amp;!SameOldConfId" link="202" stubbed="1" >f_nReturnCode == s_nSuccess
AND bSameConferenceId == false</result>
            <result name="SUCCESS&amp;&amp;SameOldConfId" link="175" stubbed="0" >f_nReturnCode == s_nSuccess
AND bSameConferenceId == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (Session.g_strMSResourceName.length > 1)

{

	Server.logInfo("HAS MS RESOURCE NAME: " + Session.g_strMSResourceName);

	Session.g_oMS.strConferenceId = "ms/cnf/$@" + Session.g_strMSResourceName;

}
Session.g_oMS.bPersistentFlag = true;
Session.g_oMS.nConferenceMaxParties = Session.s_nConferenceMaxParties;]]></script>
            <script language="javascript" timing="middle" ><![CDATA[if (Session.strPreviousConferenceId != Session.g_oMS.strConferenceId)
{
	Session.bSameConferenceId = false;
	Server.logInfo("GOT NEW CONFERENCE ID");
}
else
{
	Session.bSameConferenceId = true;
	Server.logInfo("GOT SAME CONFERENCE ID, GO GET ANOTHER ONE");
}
Session.strPreviousConferenceId = Session.g_oMS.strConferenceId;]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (1 == Result.id)
{
	Session.g_intTerminationReason = 6;
}]]></script>
          </scripts>
        </action>
        <action id="44" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=987 y=1532 ?>
          <!--AddMemberToConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
            <parameter >g_oCallLegA</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="117" stubbed="0"/>
            <result name="FAILURE" link="62" stubbed="1" >f_nReturnCode == s_nFailure</result>
            <result name="CALLER HUNG UP" link="87" stubbed="0" >f_nReturnCode == s_nCallerHungup</result>
          </results>
        </action>
        <action id="47" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1911 y=427 ?>
          <!--send ALARM-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="" transaction="" message-name="s_strSendAlarmRequest" destination-port="" destination-type="1" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;calling_number&quot;" value="g_strAlarmType"/>
            <parameter tag="&quot;called_number&quot;" value="g_strAlarmPriority"/>
          </SOAP>
          <results >
            <result name="Default" link="51" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strAlarmType = "MEDIASERVER: connect party to ms";

Session.g_strAlarmPriority = "MAJOR";]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id == 2)

{

	Server.logInfo("INFO: SUCCESS SEND ALERT");

}

else

{

	Server.logError("ERROR: FAIL TO SEND ALERT, EXIT ON: " + Result.name);

}]]></script>
          </scripts>
        </action>
        <action id="48" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1650 y=333 ?>
          <!--s_strSendAlarmFlag==T-->
          <results >
            <result name="Default" link="51" stubbed="0"/>
            <result name="s_strSendAlarmFlag==T" link="47" stubbed="0" >s_strSendAlarmFlag match "T"</result>
          </results>
        </action>
        <action id="50" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1406 y=336 ?>
          <!--response unavailable-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;Unavailable&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="48" stubbed="0"/>
          </results>
        </action>
        <action id="51" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1897 y=316 ?>
          <!--End Call-->
          <results >
            <result name="Default" link="1" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_nCurrentState = Session.s_nStateEndCall;

Session.g_nTerminationReason = 33;]]></script>
          </scripts>
        </action>
        <action id="55" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1249 y=1129 ?>
          <!--AddMemberToConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
            <parameter >g_oCallLegA</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="117" stubbed="1"/>
            <result name="FAILURE" link="59" stubbed="0" >f_nReturnCode == s_nFailure</result>
            <result name="CALLER HUNG UP" link="60" stubbed="0" >f_nReturnCode == s_nCallerHungup</result>
          </results>
        </action>
        <action id="56" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1465 y=804 ?>
          <!--End Call-->
          <results >
            <result name="Default" link="1" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_nCurrentState = Session.s_nStateEndCall;

Session.g_nTerminationReason = 37;]]></script>
          </scripts>
        </action>
        <action id="57" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=3288 y=2267 ?>
          <!--Play Join Tone to conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;PlayPromptToConference&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
            <parameter >g_strLanguage</parameter>
            <parameter >s_nPromptArrivalTone</parameter>
          </function>
          <results >
            <result name="Default" link="131" stubbed="1"/>
          </results>
        </action>
        <action id="59" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1518 y=1188 ?>
          <!--Hang up caller-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpCaller&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="1" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_nCurrentState = Session.s_nStateEndCall;

Session.g_nTerminationReason = 35;]]></script>
          </scripts>
        </action>
        <action id="60" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1520 y=1287 ?>
          <!--END THE CALL-->
          <results >
            <result name="Default" link="1" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_nCurrentState = Session.s_nStateEndCall;

Session.g_nTerminationReason = 1;]]></script>
          </scripts>
        </action>
        <action id="62" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1235 y=1037 ?>
          <!--Hang up caller-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpCaller&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="1" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_nCurrentState = Session.s_nStateEndCall;]]></script>
          </scripts>
        </action>
        <action id="66" plug-in="Standard.EndSession.1" ><?xtml-editor x=969 y=1966 ?></action>
        <action id="67" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1847 y=172 ?>
          <!--Hang up caller-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpCaller&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="1" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_nCurrentState = Session.s_nStateEndCall;]]></script>
          </scripts>
        </action>
        <action id="68" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2660 y=2164 ?>
          <!--play tone or name?-->
          <results >
            <result name="Default" link="131" stubbed="1"/>
            <result name="play tone - 1" link="217" stubbed="0" >g_nArriveDepartOption == 1</result>
            <result name="play name - 3" link="83" stubbed="0" >g_nArriveDepartOption == 3</result>
          </results>
        </action>
        <action id="70" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=3296 y=2509 ?>
          <!--xxx has joined-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="&quot;*&quot;" endpoint="g_oMS.strConferenceId" callid="g_oMS.strCallId" repeat="1" timeout="8" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="url" >g_strCallerRecordedName</audio>
            <audio type="index" >938</audio>
          </play>
          <results >
            <result name="Default" link="131" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="73" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=926 y=2187 ?>
          <!--RouteToCSR-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;RouteToCSR&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="1" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[Session.f_nCurrentState = Session.f_nReturnCode;]]></script>
          </scripts>
        </action>
        <action id="79" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2742 y=1242 ?>
          <!--party join to conf controller-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;PartyJoin&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="200" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[js_disable_event();]]></script>
          </scripts>
        </action>
        <action id="80" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=3798 y=1665 ?>
          <!--set DTMF Detection ON-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;SetDTMFOn&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="86" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_nCurrentState = Session.s_nStateWait;
Server.logInfo("nCurrentState : " + Session.f_nCurrentState);
Server.logInfo("g_oMS.strConferenceId : " + Session.g_oMS.strConferenceId);
Server.logInfo("g_oMS.strEndPoint : " + Session.g_oMS.strEndPoint);
Server.logInfo("g_oMS.strConnectionId : " + Session.g_oMS.strConnectionId);
Server.logInfo("g_oMS.strContent : " + Session.g_oMS.strContent);

var myContent = new Sdp(Session.g_oMS.strContent);
Session.g_strMediaServerIP = myContent.connection.address;
Server.logInfo("ADD PARTY TO MEDIASERVER IP: " + Session.g_strMediaServerIP);
]]></script>
          </scripts>
        </action>
        <action id="83" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2682 y=2468 ?>
          <!--null string-->
          <results >
            <result name="Default" link="216" stubbed="0"/>
            <result name="f_bNullString == true" link="217" stubbed="0" >f_bNullString == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("RECORDED NAME IS:  " + Session.g_strCallerRecordedName);

Server.logInfo("RECORDED NAME LENGTH IS:  " + Session.g_nRecordNameLength);

if (Session.g_nRecordNameLength <= 0)

{

	Session.f_bNullString = true;

}

else

{

	Session.f_bNullString = false;

}]]></script>
          </scripts>
        </action>
        <action id="84" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1219 y=809 ?>
          <!--Hang up caller-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpCaller&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="56" stubbed="0"/>
          </results>
        </action>
        <action id="85" plug-in="Standard.Timer.1" ><?xtml-editor x=2905 y=1695 ?>
          <!--ck reInvite timer-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lCkReInviteTimerIdA" duration="g_nCkReInviteTime"/>
          <results >
            <result name="Default" link="1" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[//Session.g_lLastReInviteTime = Server.getUTCTime();

Session.g_bCkReInviteTimerFlagA = true;]]></script>
            <script language="javascript" timing="last" ><![CDATA[js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="86" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2666 y=1699 ?>
          <results >
            <result name="Default" link="85" stubbed="0"/>
            <result name="session timer == T|| Time==0" link="1" stubbed="1" >s_strSessionTimerFlag match "T"

OR g_nCkReInviteTime == 0</result>
          </results>
        </action>
        <action id="87" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1246 y=1637 ?>
          <!--END THE CALL-->
          <results >
            <result name="Default" link="1" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_nCurrentState = Session.s_nStateEndCall;

Session.g_nTerminationReason = 1;]]></script>
          </scripts>
        </action>
        <action id="94" plug-in="Pactolus.Branch.1" ><?xtml-editor x=3189 y=1238 ?>
          <!--subscriber?-->
          <results >
            <result name="Default" link="112" stubbed="1"/>
            <result name="subscriber and non first caller" link="95" stubbed="0" >g_strIsSubscriberFlag match "T"

AND g_bFirstCaller == false</result>
            <result name="subscriber and first caller" link="107" stubbed="0" >g_strIsSubscriberFlag match "T"

AND g_bFirstCaller == true</result>
          </results>
        </action>
        <action id="95" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=3440 y=1169 ?>
          <!--GetAndPlayBalance-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;GetAndPlayBalance&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="112" stubbed="1"/>
          </results>
        </action>
        <action id="96" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1465 y=1385 ?>
          <!--play join as prompt-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;PlayJoinAsPrompt&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="198" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_disable_event();]]></script>
          </scripts>
        </action>
        <action id="97" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1750 y=1381 ?>
          <!--play current number of participant?-->
          <results >
            <result name="Default" link="79" stubbed="1"/>
            <result name="g_strPlayPartyCountFlag == &quot;T&quot;" link="100" stubbed="0" >g_strPlayPartyCountFlag match "T"</result>
          </results>
        </action>
        <action id="98" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2223 y=1434 ?>
          <!--there is-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >925</audio>
            <audio type="number" >1</audio>
            <audio type="index" >927</audio>
            <audio type="index" >929</audio>
          </play>
          <results >
            <result name="Default" link="79" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="99" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2237 y=1583 ?>
          <!--there are-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >926</audio>
            <audio type="number" >f_nCallLegCount</audio>
            <audio type="index" >928</audio>
            <audio type="index" >929</audio>
          </play>
          <results >
            <result name="Default" link="79" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_nCallLegCount = Session.g_nCurrentNbrCallegs - 1;]]></script>
          </scripts>
        </action>
        <action id="100" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1978 y=1375 ?>
          <!--participants > 1-->
          <results >
            <result name="Default" link="101" stubbed="0"/>
            <result name="currentNbrCallLeg == 2" link="98" stubbed="0" >g_nCurrentNbrCallegs == 2</result>
            <result name="currentNbrCallLeg &gt; 2" link="99" stubbed="0" >g_nCurrentNbrCallegs &gt; 2</result>
          </results>
        </action>
        <action id="101" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2212 y=1286 ?>
          <!--you are the first one-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >nPromptFirstCaller</audio>
          </play>
          <results >
            <result name="Default" link="79" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="102" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2426 y=1416 ?>
          <!--silence-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="1" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >s_nPromptSilence</audio>
          </play>
          <results >
            <result name="Default" link="79" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="107" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=3460 y=1312 ?>
          <!--502: Your account balance is ...-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >503</audio>
            <audio type="currency" unit="" >g_fPrepaidBalance</audio>
          </play>
          <results >
            <result name="Default" link="112" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="108" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2957 y=1244 ?>
          <!--prepaid conference-->
          <results >
            <result name="Default" link="112" stubbed="1"/>
            <result name="billing type == 1?" link="94" stubbed="0" >g_nBillingType == 1</result>
          </results>
        </action>
        <action id="109" plug-in="Pactolus.Branch.1" ><?xtml-editor x=857 y=112 ?>
          <results >
            <result name="Default" link="1" stubbed="1"/>
            <result name="EndCall" link="67" stubbed="1" >f_nCurrentState == s_nStateEndCall</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (Session.f_nReturnCode == Session.s_nSuccess)

{

	Session.f_bInitializeFails = false;

	if (Session.g_strACDGreetingEnabled == "T")

	{

		Session.f_bRouteToCSR = true;

		Session.g_nCSRRouteReasonCode = 1;  //conference greeting

		Session.g_strCurrentConfType = "T";

	}
	else if (1 == Session.g_nDnisIdentifiedConfFlag && (4 == Session.g_nEventDnisType || 5 == Session.g_nEventDnisType || 6 == Session.g_nEventDnisType || 0 == Session.g_nEventDnisType) )
	{
		Session.f_bRouteToCSR = true;
		Session.g_nCSRRouteReasonCode = 1;  //conference greeting, even for event type conf, EventDnisType will tell
		Session.g_strCurrentConfType = "T";	//temporary conference
	}
	else
	{
		Session.f_bRouteToCSR = false;
	}

}
else if (Session.g_bTransferParty)
{
	Session.f_nCurrentState = Session.s_nStateEndCall;
}
// else if (-2 == Session.f_nReturnCode || -3 == Session.f_nReturnCode || -4 == Session.f_nReturnCode || -5 == Session.f_nReturnCode)
else
{
	// Session.f_bInitializeFails = true;
	// for now route to CSR if init fail, presume event conference type
	Session.f_bInitializeFails = false;	
	Session.f_bRouteToCSR = true;
	Session.g_nCSRRouteReasonCode = 1;  //conference greeting, even for event type conf, EventDnisType will tell
	Session.g_strCurrentConfType = "T";	//temporary conference
	Session.g_nDnisIdentifiedConfFlag = 1;
	Session.g_nEventDnisType = 5;
	Session.g_strAutoAssign = "F";
	Server.logInfo("INITIALIZE SESSION FAIL, ROUTE TO CSR AS EVENT BASE CONFERENCE");
}

if (Session.g_bTransferParty)
{
	Session.f_nCurrentState = Session.s_nStateEventConfGetPasscode;
}
else
{
	Session.f_nCurrentState = Session.s_nStateDirectToMS;
}]]></script>
          </scripts>
        </action>
        <action id="110" plug-in="Pactolus.Sleep.1" ><?xtml-editor x=958 y=586 ?>
          <!--s_fConfStartCallDelay secs-->
          <sleep xmlns="urn:www.pactolus.com:xtml:application" duration="s_fConfStartCallDelay"/>
          <results >
            <result name="Default" link="4" stubbed="0"/>
          </results>
        </action>
        <action id="111" plug-in="Pactolus.Branch.1" ><?xtml-editor x=716 y=590 ?>
          <!--delay?-->
          <results >
            <result name="Default" link="4" stubbed="1"/>
            <result name="s_fConfStartCallDelay &gt; 0 ?" link="110" stubbed="0" >s_fConfStartCallDelay &gt; 0</result>
          </results>
        </action>
        <action id="112" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2472 y=1554 ?>
          <!--record conf-->
          <results >
            <result name="Default" link="172" stubbed="0"/>
            <result name="record allow and auto record" link="113" stubbed="0" >g_strConfRecordAllowed match "T"

AND g_strAutoRecordFlag match "T"</result>
          </results>
        </action>
        <action id="113" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=2478 y=1837 ?>
          <!--START_RECORD_REQUEST-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="s_strStartRecordRequest" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace=""/>
          <results >
            <result name="Default" link="114" stubbed="0"/>
            <result name="Success" link="115" stubbed="0"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)

{

	Server.logError("ERROR: FAIL TO SEND START RECORD REQUEST TO CONF CONTROLLER.");

	Server.logError("ERROR: CONF CONTROLLER IP: " + Session.g_strConfControllerIP);

	Server.logError("ERROR: CONF CONTROLLER PORT: " + Session.g_nConfControllerPort);

}]]></script>
          </scripts>
        </action>
        <action id="114" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2643 y=1807 ?>
          <!--fail to record-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >957</audio>
          </play>
          <results >
            <result name="Default" link="62" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nConfLeaveReason = 7;
Session.g_strConfLeaveMsg = "FAIL TO SEND START/STOP RECORD CONFERENCE TO CC";]]></script>
          </scripts>
        </action>
        <action id="115" plug-in="Standard.WaitEvent.1" ><?xtml-editor x=2647 y=1964 ?>
          <wait xmlns="urn:www.pactolus.com:xtml:communication" timeout="10" recv-name="g_strEventReceived" >
            <msg name="StartRecordResponse" >
              <parameter >f_nReturnCode</parameter>
              <parameter >g_strReturnMsg</parameter>
            </msg>
          </wait>
          <results >
            <result name="Default" link="114" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
            <result name="SUCCESS" link="116" stubbed="0" >'Result'  == 'Success'

AND f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_nReturnCode = -50;

Session.g_strReturnMsg = "";]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 5)

{

	Server.logError("ERROR: FAIL TO WAIT FOR START RECORD RESPONSE");

	Server.logError("ERROR: EXIT ON: " + Result.name);

	Server.logError("ERROR: RETURN CODE: " + Session.f_nReturnCode);

	Server.logError("ERROR: RETURN MESSAGE: " + Session.g_strReturnMsg);

}]]></script>
          </scripts>
        </action>
        <action id="116" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2902 y=1957 ?>
          <!--record started-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >955</audio>
          </play>
          <results >
            <result name="Default" link="80" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="117" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1236 y=1479 ?>
          <!--anonymous caller?-->
          <results >
            <result name="Default" link="96" stubbed="0"/>
            <result name="g_bAnonymousCaller" link="123" stubbed="0" >g_bAnonymousCaller == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (!Session.g_bTransferParty)
{
	Session.g_lMSConnectTime = Server.getUTCTime();
	Server.logInfo("PARTY NOT TRANSFER, MUST SET MS CONNECT TIME.  ELSE, KEEP OLD CONNECT TIME");	
}]]></script>
          </scripts>
        </action>
        <action id="120" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1693 y=1632 ?>
          <!--party join to conf controller-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;PartyJoin&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="1" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[Session.g_oMS.bMuteFlag = true;
Session.g_oMS.bDeafFlag = false;
Session.g_bMutedState = true;
Session.g_bMutedByMod = true;
Session.g_nPromptSelfMuteUnMute = 908;
Server.logInfo("INFO: MODIFY MEMBER TO ANONYMOUS.");
Session.f_nCurrentState = Session.s_nStateWait;
js_disable_event();]]></script>
          </scripts>
        </action>
        <action id="121" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2427 y=1105 ?>
          <!--Press ** Main Menu-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >359</audio>
            <audio type="index" >946</audio>
          </play>
          <results >
            <result name="Default" link="79" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="123" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1473 y=1634 ?>
          <!--will now place you into conf-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;PlayJoinAsPrompt&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="120" stubbed="0"/>
          </results>
        </action>
        <action id="124" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2005 y=1169 ?>
          <!--you are the first one-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >nPromptFirstCaller</audio>
          </play>
          <results >
            <result name="Default" link="79" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="126" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1718 y=668 ?>
          <!--HandoffToProxy-->
          <results >
            <result name="Default" link="1" stubbed="1"/>
            <result name="g_bWrongSiteHandOff" link="19" stubbed="1" >g_nRedirectStatus != 3

AND g_bWrongSiteHangOff == true</result>
          </results>
        </action>
        <action id="127" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1361 y=2302 ?>
          <!--"MSOutdialParty"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;MSOutdialParty&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oCallLegA</parameter>
            <parameter >g_oMS</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="160" stubbed="0"/>
            <result name="SUCCESS" link="1" stubbed="1" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Session.f_nReturnCode == Session.s_nSuccess)

{

	Session.f_nCurrentState = Session.s_nStateGetPasscode;

}

else

{

	Session.f_nCurrentState = Session.s_nStateEndCall;

}]]></script>
          </scripts>
        </action>
        <action id="129" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=886 y=2306 ?>
          <!--Initialize Conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceInitConfSession&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="155" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Session.f_nReturnCode == Session.s_nSuccess)

{

	Session.f_bInitializeFails = false;

	if (Session.g_strACDGreetingEnabled == "T")

	{

		Session.f_bRouteToCSR = true;

		Session.g_nCSRRouteReasonCode = 1;  //conference greeting

		Session.g_strCurrentConfType = "T";

	}

	else

	{

		Session.f_bRouteToCSR = false;

	}

}

else

{

	Session.f_bInitializeFails = true;

}]]></script>
          </scripts>
        </action>
        <action id="130" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=3565 y=1668 ?>
          <!--your line has been muted, press *6 to unmute your line-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="6" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;(*1)&quot;" language="g_strLanguage" digits="g_strUnmuteDigits" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >900</audio>
            <audio type="index" >355</audio>
            <audio type="index" >908</audio>
          </play>
          <results >
            <result name="Default" link="80" stubbed="1"/>
            <result name="Success" link="134" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="131" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2871 y=1553 ?>
          <!--muted?-->
          <results >
            <result name="Default" link="80" stubbed="1"/>
            <result name="MOH" link="186" stubbed="0" >g_nDefaultAudioMode == 1</result>
            <result name="g_bMuteThisParty" link="183" stubbed="0" >g_bMuteThisParty == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[// if (true == Session.g_bMuteThisParty || Session.g_strMuteFlag == "T")
/*
	Server.logInfo("INFO: SET AUDIO MODE");
	if (0 == Session.g_nDefaultAudioMode)
	{
		Server.logInfo("INFO: SET CONFERENCE MODE");
		Session.g_oMS.bMuteFlag = false;
		Session.g_oMS.bDeafFlag = false;
		Session.g_bMutedState = false;
		Session.g_bHoldState = false;
	}
	else if (2 == Session.g_nDefaultAudioMode)
	{
		Server.logInfo("INFO: SET MUTE MODE");
		Session.g_oMS.bMuteFlag = true;
		Session.g_oMS.bDeafFlag = false;
		Session.g_bMutedState = true;
		Session.g_bHoldState = false;
	}
	else
	{
		Server.logInfo("INFO: SET MOH MODE");
		Session.g_oMS.bMuteFlag = true;
		Session.g_oMS.bDeafFlag = true;
		Session.g_bMutedState = false;
		Session.g_bHoldState = true;
	}
*/
if (true == Session.g_bMuteThisParty)
{
	if ("T" == Session.g_strMuteFlag)
	{
		Session.g_bMutedByMod = true;
	}
	else
	{
		Session.g_bMutedByMod = false;
	}
	Session.g_nPromptSelfMuteUnMute = 908;
}]]></script>
          </scripts>
        </action>
        <action id="134" plug-in="Pactolus.Branch.1" ><?xtml-editor x=3805 y=1765 ?>
          <!--what digit?-->
          <results >
            <result name="Default" link="172" stubbed="1"/>
            <result name="*6" link="140" stubbed="1" >g_strUnmuteDigits match "^\*{1}6{1}$"</result>
          </results>
        </action>
        <action id="136" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=2396 y=657 ?>
          <!--UnmutePartyRequest-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="s_strUnmutePartyRequest" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;callerPassCode&quot;" value="g_strCCGeneratedPassCode"/>
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="139" stubbed="0"/>
            <result name="Success" link="137" stubbed="0"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_disable_event();

Server.logInfo("INFO: **** UNMUTE PARTY REQUEST ****");]]></script>
          </scripts>
        </action>
        <action id="137" plug-in="Standard.WaitEvent.1" ><?xtml-editor x=2629 y=795 ?>
          <!--UnmutePartyResponse-->
          <wait xmlns="urn:www.pactolus.com:xtml:communication" timeout="5" recv-name="g_strEventReceived" >
            <msg name="UnmutePartyResponse" >
              <parameter >f_strConfControllerIP</parameter>
              <parameter >f_nConfControllerPort</parameter>
              <parameter >f_strTransactionId</parameter>
              <parameter >f_nReturnCode</parameter>
              <parameter >f_strReturnMsg</parameter>
            </msg>
          </wait>
          <results >
            <result name="Default" link="139" stubbed="1"/>
            <result name="Success" link="138" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_nReturnCode = -1;]]></script>
            <script language="javascript" timing="last" ><![CDATA[js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="138" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2862 y=793 ?>
          <!--success?-->
          <results >
            <result name="Default" link="139" stubbed="1"/>
            <result name="f_nReturnCode == 0" link="142" stubbed="0" >f_nReturnCode == 0</result>
          </results>
        </action>
        <action id="139" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2617 y=526 ?>
          <!--can't unmute-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >933</audio>
          </play>
          <results >
            <result name="Default" link="172" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="140" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2176 y=550 ?>
          <!--CallPartyFlag==T?-->
          <results >
            <result name="Default" link="146" stubbed="0"/>
            <result name="g_strPartyPasscodeFlag==T" link="136" stubbed="0" >g_strPartyPasscodeFlag match "T"</result>
          </results>
        </action>
        <action id="141" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=3337 y=917 ?>
          <!--SELF UNMUTE PARTY-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="g_strResponseTransactionId" message-name="s_strConfUnmutePartyEvent" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;callerPassCode&quot;" value="g_strCCGeneratedPassCode"/>
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="143" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: **** SELF UNMUTE ****");]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)

{

	Server.logError("ERROR: FAIL TO SEND SOAP MESSAGE UNMUTE YOUR OWN LINE.");

}]]></script>
          </scripts>
        </action>
        <action id="142" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=3095 y=789 ?>
          <!--"ChangeToConferenceMode"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ChangeToConferenceMode&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="139" stubbed="1"/>
            <result name="SUCCESS" link="144" stubbed="0" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: MODIFY MEMBER TO UNMUTE.");

Session.g_oMS.bMuteFlag = false;]]></script>
          </scripts>
        </action>
        <action id="143" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=3580 y=912 ?>
          <!--your line unmuted-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >s_nPromptUnmuted</audio>
          </play>
          <results >
            <result name="Default" link="172" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nPromptSelfMuteUnMute = 907;
Session.g_bMutedState = false;]]></script>
          </scripts>
        </action>
        <action id="144" plug-in="Pactolus.Branch.1" ><?xtml-editor x=3334 y=786 ?>
          <!--CallPartyFlag==T?-->
          <results >
            <result name="Default" link="145" stubbed="0"/>
            <result name="g_strPartyPasscodeFlag==T" link="141" stubbed="0" >g_strPartyPasscodeFlag match "T"</result>
          </results>
        </action>
        <action id="145" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=3577 y=776 ?>
          <!--SELF UNMUTE PARTY-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="g_strResponseTransactionId" message-name="s_strConfUnmutePartyEvent" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;callerPassCode&quot;" value="g_strCCGeneratedPassCode"/>
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="143" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: **** SELF UNMUTE ****");]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)

{

	Server.logError("ERROR: FAIL TO SEND SOAP MESSAGE UNMUTE YOUR OWN LINE.");

}]]></script>
          </scripts>
        </action>
        <action id="146" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=2380 y=506 ?>
          <!--UnmutePartyRequest-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="s_strUnmutePartyRequest" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;callerPassCode&quot;" value="g_strCCGeneratedPassCode"/>
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="139" stubbed="0"/>
            <result name="Success" link="137" stubbed="0"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_disable_event();

Server.logInfo("INFO: **** UNMUTE PARTY REQUEST ****");]]></script>
          </scripts>
        </action>
        <action id="150" plug-in="Pactolus.SipInvite.1" ><?xtml-editor x=2076 y=2246 ?>
          <sip-invite xmlns="urn:www.pactolus.com:xtml:sip" add-record-route="0" add-via="1" handle-responses="1" follow-redirection="0" final-response-status="" response-content="" response-content-type="" final-request-uri="" timeout-for-final-response="8" timeout-for-provisional-response="4" record-route="" contact="" response-to="" use-session-timer="0" session-expires="" min-supported-session-timer="" refresher="" remote-party-id="" increment-cseq-first="0" increment-cseq-last="0" >
            <call-id >g_oCallLegA.strCallId</call-id>
            <cseq >g_oCallLegA.strCSeq</cseq>
            <from >g_oCallLegA.strTo</from>
            <request-uri >g_oCallLegA.strRequestUri</request-uri>
            <subject >g_oCallLegA.strSubject</subject>
            <to >g_oCallLegA.strFrom</to>
          </sip-invite>
          <results >
            <result name="Default" link="66" stubbed="1"/>
            <result name="Success"/>
            <result name="Redirect (3xx)"/>
            <result name="Client error (4xx)"/>
            <result name="Server error (5xx)"/>
            <result name="Global error (6xx)"/>
            <result name="Provisional Timeout"/>
            <result name="Final Timeout"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[var myCSeq = new SipCSeq(Session.g_oCallLegA.strCSeq);

myCSeq.method = "INVITE";

myCSeq.increment();

Session.g_oCallLegA.strCSeq = myCSeq.encode();





if (Session.g_nAlternateSitePort > 0)

{

	Server.logInfo("ALTERNATE SITE PORT > 0");

//	Session.g_oCallLegA.strSubject = "handoff=\"3\";passcode=\"" + Session.g_strPassCode + "\";attendeeId=\"" + Session.g_strAttendeeId + "\";sendtoIP=\"" + Session.g_strAlternateSiteIP + ":" Session.g_nAlternateSitePort + "\"";

	Session.g_oCallLegA.strSubject = "handoff=\"3\";passcode=\"";

	Session.g_oCallLegA.strSubject += Session.g_strPassCode;

	Session.g_oCallLegA.strSubject += "\";attendeeId=\"";

	Session.g_oCallLegA.strSubject += Session.g_strAttendeeId;

	Session.g_oCallLegA.strSubject += "\";sendtoIP=\"";

	Session.g_oCallLegA.strSubject += Session.g_strAlternateSiteIP;

	Session.g_oCallLegA.strSubject += ":";

	Session.g_oCallLegA.strSubject += Session.g_nAlternateSitePort;

	Session.g_oCallLegA.strSubject += "\"";

	Server.logInfo("SUBJECT IS: " + Session.g_oCallLegA.strSubject);

}

else

{

	Server.logInfo("ALTERNATE SITE PORT == 0");

//	Session.g_oCallLegA.strSubject = "handoff=\"3\";passcode=\"" + Session.g_strPassCode + "\";attendeeId=\"" + Session.g_strAttendeeId + "\";sendtoIP=\"" + Session.g_strAlternateSiteIP + "\"";

	Session.g_oCallLegA.strSubject = "handoff=\"3\";passcode=\"";

	Session.g_oCallLegA.strSubject += Session.g_strPassCode;

	Session.g_oCallLegA.strSubject += "\";attendeeId=\"";

	Session.g_oCallLegA.strSubject += Session.g_strAttendeeId;

	Session.g_oCallLegA.strSubject += "\";sendtoIP=\"";

	Session.g_oCallLegA.strSubject += Session.g_strAlternateSiteIP;

	Session.g_oCallLegA.strSubject += ":";

	Session.g_oCallLegA.strSubject += Session.g_nAlternateSitePort;

	Session.g_oCallLegA.strSubject += "\"";

	Server.logInfo("SUBJECT IS: " + Session.g_oCallLegA.strSubject);

}]]></script>
          </scripts>
        </action>
        <action id="151" plug-in="Pactolus.Branch.1" ><?xtml-editor x=679 y=234 ?>
          <!--ms in service-->
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="!s_bMsOutOfService" link="2" stubbed="1" >s_bMsOutOfService == false</result>
            <result name="s_bMsOutOfService &gt; 5 secs" link="152" stubbed="0" >s_bMsOutOfService == true

AND f_bMoreThanFiveSecs == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if ( (Server.getUTCTime() - Session.s_lMSOutOfServiceTime) > 5 )

	Session.f_bMoreThanFiveSecs = true;]]></script>
          </scripts>
        </action>
        <action id="152" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=696 y=473 ?>
          <!--Direct caller to MS-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DirectCallerToMS&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oCallLegA</parameter>
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="50" stubbed="1"/>
            <result name="SUCCESS" link="154" stubbed="0" >f_nReturnCode == s_nSuccess</result>
            <result name="CALLER HUNG UP" link="1" stubbed="1" >f_nReturnCode == s_nCallerHungup</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (2 == Result.id)

{

	Session.g_bSentFinalResponse = true;

	Session.g_strSIPStatus = "200";

	Server.lockSharedVariables();

	Session.s_bMsOutOfService = false;

	Session.s_lMSOutOfServiceTime = 0;

	Server.unlockSharedVariables();

}

else if (3 == Result.id)

{

	Session.f_nCurrentState = Session.s_nStateEndCall;

	Session.g_nTerminationReason = 10;

	Session.g_strSIPStatus = "200"

}

else

{

	Session.g_strSIPStatus = "503";

	Server.lockSharedVariables();

	Session.s_bMsOutOfService = true;

	Session.s_lMSOutOfServiceTime = Server.getUTCTime();

	Server.unlockSharedVariables();

}]]></script>
          </scripts>
        </action>
        <action id="153" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1180 y=342 ?>
          <!--"psAPISceDisableMS"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceDisableMS&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="50" stubbed="0"/>
          </results>
        </action>
        <action id="154" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=935 y=471 ?>
          <!--"psAPISceEnableMS"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceEnableMS&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="26" stubbed="1"/>
          </results>
        </action>
        <action id="155" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1120 y=2307 ?>
          <!--ms in service-->
          <results >
            <result name="Default" link="150" stubbed="1"/>
            <result name="!s_bMsOutOfService" link="127" stubbed="0" >s_bMsOutOfService == false</result>
            <result name="s_bMsOutOfService &gt; 5 secs" link="161" stubbed="0" >s_bMsOutOfService == true

AND f_bMoreThanFiveSecs == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if ( (Server.getUTCTime() - Session.s_lMSOutOfServiceTime) > 5 )

	Session.f_bMoreThanFiveSecs = true;]]></script>
          </scripts>
        </action>
        <action id="156" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1858 y=2266 ?>
          <!--"psAPISceDisableMS"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceDisableMS&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="150" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.lockSharedVariables();

Session.s_bMsOutOfService = true;

Session.s_lMSOutOfServiceTime = Server.getUTCTime();

Server.unlockSharedVariables();]]></script>
          </scripts>
        </action>
        <action id="157" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1628 y=2622 ?>
          <!--"psAPISceEnableMS"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceEnableMS&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="1" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.lockSharedVariables();

Session.s_bMsOutOfService = false;

Session.s_lMSOutOfServiceTime = 0;

Server.unlockSharedVariables();]]></script>
          </scripts>
        </action>
        <action id="159" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1864 y=2360 ?>
          <!--"MSOutdialParty"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;MSOutdialParty&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oCallLegA</parameter>
            <parameter >g_oMS</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="156" stubbed="1"/>
            <result name="SUCCESS" link="1" stubbed="1" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Session.f_nReturnCode == Session.s_nSuccess)

{

	Session.f_nCurrentState = Session.s_nStateGetPasscode;

}

else

{

	Session.f_nCurrentState = Session.s_nStateEndCall;

}]]></script>
          </scripts>
        </action>
        <action id="160" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1589 y=2302 ?>
          <results >
            <result name="Default" link="150" stubbed="0"/>
            <result name="g_oMS.bRetry" link="159" stubbed="0" >g_oMS.bRetry == true</result>
          </results>
        </action>
        <action id="161" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1389 y=2516 ?>
          <!--"MSOutdialParty"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;MSOutdialParty&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oCallLegA</parameter>
            <parameter >g_oMS</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="162" stubbed="0"/>
            <result name="SUCCESS" link="157" stubbed="0" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Session.f_nReturnCode == Session.s_nSuccess)

{

	Session.f_nCurrentState = Session.s_nStateGetPasscode;

}

else

{

	Session.f_nCurrentState = Session.s_nStateEndCall;

	Server.lockSharedVariables();

	Session.s_bMsOutOfService = true;

	Session.s_lMSOutOfServiceTime = Server.getUTCTime();

	Server.unlockSharedVariables();

}]]></script>
          </scripts>
        </action>
        <action id="162" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1612 y=2511 ?>
          <results >
            <result name="Default" link="150" stubbed="1"/>
            <result name="g_oMS.bRetry" link="163" stubbed="0" >g_oMS.bRetry == true</result>
          </results>
        </action>
        <action id="163" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1868 y=2508 ?>
          <!--"MSOutdialParty"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;MSOutdialParty&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oCallLegA</parameter>
            <parameter >g_oMS</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="150" stubbed="1"/>
            <result name="SUCCESS" link="1" stubbed="1" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Session.f_nReturnCode == Session.s_nSuccess)

{

	Session.f_nCurrentState = Session.s_nStateGetPasscode;

}

else

{

	Session.f_nCurrentState = Session.s_nStateEndCall;

	Server.lockSharedVariables();

	Session.s_bMsOutOfService = true;

	Session.s_lMSOutOfServiceTime = Server.getUTCTime();

	Server.unlockSharedVariables();

}]]></script>
          </scripts>
        </action>
        <action id="167" plug-in="Pactolus.Branch.1" ><?xtml-editor x=3337 y=1701 ?>
          <!--ModMutedThisParty?-->
          <results >
            <result name="Default" link="130" stubbed="0"/>
            <result name="g_strModeratorMutedFlag" link="168" stubbed="0" >g_strModeratorMutedFlag match "T"
OR g_strMuteFlag match "T"</result>
          </results>
        </action>
        <action id="168" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=3577 y=1818 ?>
          <!--your line has been muted-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="6" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;(*1)&quot;" language="g_strLanguage" digits="g_strUnmuteDigits" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >900</audio>
          </play>
          <results >
            <result name="Default" link="172" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="169" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=888 y=2433 ?>
          <!--RouteToTPCSR-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;RouteToTPCSR&quot;" return="f_nCurrentState" external-function="0" library=""/>
          <results >
            <result name="Default" link="1" stubbed="1"/>
          </results>
        </action>
        <action id="170" plug-in="Pactolus.Sleep.1" ><?xtml-editor x=1155 y=174 ?>
          <!--Sleep 2 seconds and try again.-->
          <sleep xmlns="urn:www.pactolus.com:xtml:application" duration="2"/>
          <results >
            <result name="Default" link="171" stubbed="0"/>
          </results>
        </action>
        <action id="171" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1381 y=168 ?>
          <!--Direct caller to MS 2nd attempt.-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DirectCallerToMS&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oCallLegA</parameter>
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="50" stubbed="1"/>
            <result name="SUCCESS" link="26" stubbed="1" >f_nReturnCode == s_nSuccess</result>
            <result name="CALLER HUNG UP" link="1" stubbed="1" >f_nReturnCode == s_nCallerHungup</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (2 == Result.id)

{

	Session.g_bSentFinalResponse = true;

	Session.g_strSIPStatus = "200";

}

else if (3 == Result.id)

{

	Session.f_nCurrentState = Session.s_nStateEndCall;

	Session.g_nTerminationReason = 10;

	Session.g_strSIPStatus = "200"

}

else

{
	
	Server.logError("An error occurred trying to direct caller to MS.  ReturnCode from DirectCallerToMS is <" + Session.f_nReturnCode + ">");

}]]></script>
          </scripts>
        </action>
        <action id="172" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2417 y=2195 ?>
          <!--non first caller-->
          <results >
            <result name="Default" link="68" stubbed="0"/>
            <result name="g_bFirstCaller == false" link="68" stubbed="0" >g_bFirstCaller == false</result>
            <result name="moderator w/part's in conf" link="68" stubbed="0" >g_strModeratorFlag match "T"
AND g_nCurrentNbrCallegs &gt;= 2</result>
          </results>
        </action>
        <action id="174" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1249 y=1255 ?>
          <results >
            <result name="Default" link="84" stubbed="1"/>
            <result name="nSetConfResourceRetry&lt;3?" link="38" stubbed="1" >nSetConfResourceRetry &lt; 3</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.nSetConfResourceRetry++;
Session.g_oMS.strConferenceId = "";
Server.logInfo("CONF RESOURCE INUSED, GET ANOTHER CONFERENCE ID");]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (1 == Result.id)
{
	Session.g_intTerminationReason = 47;
}]]></script>
          </scripts>
        </action>
        <action id="175" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1245 y=899 ?>
          <!--get a different conference-->
          <results >
            <result name="Default" link="84" stubbed="1"/>
            <result name="nSetConfResourceRetry&lt;3?" link="38" stubbed="1" >nSetConfResourceRetry &lt; 3</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("GET ANOTHER CONFERENCE ID");
Session.g_oMS.strConferenceId = "";
Session.nSetConfResourceRetry++;]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (1 == Result.id)
{
	Session.g_intTerminationReason = 47;
}]]></script>
          </scripts>
        </action>
        <action id="176" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1165 y=2761 ?>
          <!--"EventConfGetPasscode"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;EventConfGetPasscode&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="178" stubbed="0"/>
            <result name="FAILS" link="178" stubbed="1" >f_nReturnCode == s_nFailure</result>
            <result name="SUCCESS" link="193" stubbed="0" >f_nReturnCode == s_nFirstCaller

OR f_nReturnCode == s_nNonFirstCaller

OR f_nReturnCode == s_nWrongSite</result>
            <result name="WFM or CSR" link="1" stubbed="1" >f_nReturnCode == s_nWaitForMod

OR f_nReturnCode == s_nStateRouteToCsr</result>
            <result name="RouteTPCSR" link="1" stubbed="1" >f_nReturnCode == s_nStateRouteToThirdPartyCsr</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("Calling EventConfGetPasscode with return code: " + Session.f_nReturnCode);]]></script>
            <script language="javascript" timing="last" ><![CDATA[Server.logInfo("EventConfGetPasscode returns: " + Session.f_nReturnCode);
Session.g_bTPCSRRouteInProgress = false;

Session.g_nTempInt = Session.f_nReturnCode;

if (4 == Result.id)

{

	if (Session.s_nWaitForMod == Session.f_nReturnCode)

		Session.f_nCurrentState = Session.s_nStateWaitForMod;

	else

	{

		Session.f_nCurrentState = Session.s_nStateRouteToCsr;

		Session.g_nCSRRouteReasonCode = 2;  //exceed passcode validation attemps

	}

}
if (5 == Result.id)
{
	Session.f_nCurrentState = Session.s_nStateRouteToThirdPartyCsr;
}]]></script>
          </scripts>
        </action>
        <action id="177" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1645 y=2832 ?>
          <!--Delete MS Connection-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DeleteMSConnection&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="182" stubbed="0"/>
          </results>
        </action>
        <action id="178" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1403 y=2740 ?>
          <!--Hang up caller-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpCaller&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="1" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_nCurrentState = Session.s_nStateEndCall;]]></script>
          </scripts>
        </action>
        <action id="182" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1883 y=2831 ?>
          <!--HandoffToProxy-->
          <results >
            <result name="Default" link="1" stubbed="1"/>
            <result name="g_bWrongSiteHandOff" link="19" stubbed="1" >g_nRedirectStatus != 3

AND g_bWrongSiteHangOff == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (Session.g_nTempInt == Session.s_nFirstCaller && !Session.g_bNoCreateConfFirstCaller)
{
	Session.f_nCurrentState = Session.s_nStateCreateConference;
}
else if (Session.g_nTempInt == Session.s_nNonFirstCaller || Session.g_bNoCreateConfFirstCaller)
{
	Session.g_oMS.strConferenceId = Session.g_strConfResource;
	Session.f_nCurrentState = Session.s_nStateAddToConference;
}
else
{
	Session.f_nCurrentState = Session.s_nStateEndCall;
}]]></script>
          </scripts>
        </action>
        <action id="183" plug-in="Pactolus.Branch.1" ><?xtml-editor x=3121 y=1711 ?>
          <!--event base conf?-->
          <results >
            <result name="Default" link="167" stubbed="0"/>
            <result name="g_nDnisIdentifiedConfFlag == 1" link="80" stubbed="1" >g_nDnisIdentifiedConfFlag == 1</result>
          </results>
        </action>
        <action id="185" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=3123 y=1598 ?>
          <!--HoldPartyRequest-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="s_strHoldPartyRequest" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;callerPassCode&quot;" value="g_strCCGeneratedPassCode"/>
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="86" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_disable_event();
Server.logInfo("INFO: **** MUTE PARTY REQUEST ****");
Session.f_nCurrentState = Session.s_nStateWait;]]></script>
          </scripts>
        </action>
        <action id="186" plug-in="Pactolus.Branch.1" ><?xtml-editor x=3129 y=1971 ?>
          <!--MOH?-->
          <results >
            <result name="Default" link="188" stubbed="0"/>
            <result name="g_strMusicOnHoldFlag==&quot;T&quot;" link="190" stubbed="0" >g_strMusicOnHoldFlag match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: **** MUTE PARTY REQUEST ****");
Session.f_nCurrentState = Session.s_nStateWait;
Session.g_bDontPlayContinueToHold = true;]]></script>
          </scripts>
        </action>
        <action id="187" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=3589 y=1949 ?>
          <!--please hold-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >898</audio>
          </play>
          <results >
            <result name="Default" link="214" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="188" plug-in="Standard.Timer.1" ><?xtml-editor x=3359 y=1957 ?>
          <!--play please hold every 10 secs-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lHoldTimerId" duration="s_nSleepTime"/>
          <results >
            <result name="Default" link="187" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bHoldTimerFlag = true;]]></script>
          </scripts>
        </action>
        <action id="190" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=3627 y=2107 ?>
          <!--Remove member from conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;RemoveMemberFromConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="191" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: CONF HOLD PARTY REQUEST, REMOVE MEMBER FROM CONFERENCE.");]]></script>
          </scripts>
        </action>
        <action id="191" plug-in="Standard.Timer.1" ><?xtml-editor x=3833 y=2105 ?>
          <!--5 secs to connect MOH-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lMOHTimerId" duration="s_nPreMohTime"/>
          <results >
            <result name="Default" link="19" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bMOHTimerFlag = true;
Session.g_bDtmfCollectionOnHold = true;]]></script>
          </scripts>
        </action>
        <action id="192" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1755 y=1187 ?>
          <!--1st caller &&
speaker &&
play 1st caller-->
          <results >
            <result name="Default" link="97" stubbed="1"/>
            <result name="play first caller" link="124" stubbed="0" >g_nCurrentNbrCallegs == 1
AND g_strPlayFirstCaller match "T"
AND g_nDefaultAudioMode == 0</result>
            <result name="first caller , don't play" link="79" stubbed="1" >g_nCurrentNbrCallegs == 1
AND (g_nDefaultAudioMode != 0
OR g_strPlayFirstCaller match "F")</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (1 == Session.g_nDnisIdentifiedConfFlag)
{
	Session.nPromptFirstCaller = 4140;
}
else
{
	Session.nPromptFirstCaller = Session.s_nPromptFirstCaller;
}]]></script>
          </scripts>
        </action>
        <action id="193" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1423 y=2835 ?>
          <results >
            <result name="Default" link="177" stubbed="0"/>
            <result name="g_bTransferParty" link="182" stubbed="1" >g_bTransferParty == true</result>
          </results>
        </action>
        <action id="194" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1497 y=939 ?>
          <!--Dial In?-->
          <results >
            <result name="Default" link="55" stubbed="1"/>
            <result name="g_strOutdialFlag = &quot;T&quot;;" link="195" stubbed="0" >g_strOutdialFlag match "T"
AND g_bTransferParty == true</result>
          </results>
        </action>
        <action id="195" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1728 y=936 ?>
          <!--AddMemberToConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
            <parameter >g_oCallLegB</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="117" stubbed="1"/>
            <result name="FAILURE" link="59" stubbed="1" >f_nReturnCode == s_nFailure</result>
            <result name="CALLER HUNG UP" link="60" stubbed="1" >f_nReturnCode == s_nCallerHungup</result>
          </results>
        </action>
        <action id="196" plug-in="Pactolus.Branch.1" ><?xtml-editor x=992 y=1403 ?>
          <!--Dial In?-->
          <results >
            <result name="Default" link="44" stubbed="1"/>
            <result name="g_strOutdialFlag = &quot;T&quot;;" link="197" stubbed="1" >g_strOutdialFlag match "T"
AND g_bTransferParty == true</result>
          </results>
        </action>
        <action id="197" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=989 y=1666 ?>
          <!--AddMemberToConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
            <parameter >g_oCallLegB</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="117" stubbed="1"/>
            <result name="FAILURE" link="62" stubbed="1" >f_nReturnCode == s_nFailure</result>
            <result name="CALLER HUNG UP" link="87" stubbed="1" >f_nReturnCode == s_nCallerHungup</result>
          </results>
        </action>
        <action id="198" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1461 y=1477 ?>
          <!--Transfered?-->
          <results >
            <result name="Default" link="192" stubbed="1"/>
            <result name="g_bTransferParty" link="79" stubbed="1" >g_bTransferParty == true</result>
          </results>
        </action>
        <action id="199" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1500 y=1046 ?>
          <!--MoveDirectlyInToSub?-->
          <results >
            <result name="Default" link="194" stubbed="1"/>
            <result name="g_bMoveDirectlyInSub" link="79" stubbed="1" >g_bMoveDirectlyInSubConf == true</result>
          </results>
        </action>
        <action id="200" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2959 y=1109 ?>
          <!--MoveDirectlyInToSub?-->
          <results >
            <result name="Default" link="108" stubbed="0"/>
            <result name="g_bMoveDirectlyInSub" link="213" stubbed="0" >g_bMoveDirectlyInSubConf == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[/*
if (2 == Result.id)
{
	Server.logInfo("INFO: MODIFY MEMBER TO BACK TO CONFERENCE.");
	if (0 == Session.g_nDefaultAudioMode)
	{
		Session.g_oMS.bMuteFlag = false;
		Session.g_oMS.bDeafFlag = false;
		Session.g_bMutedState = false;
		Session.g_bHoldState = false;
	}
	else if (2 == Session.g_nDefaultAudioMode)
	{
		Session.g_oMS.bMuteFlag = true;
		Session.g_oMS.bDeafFlag = false;
		Session.g_bMutedState = true;
		Session.g_bHoldState = false;
	}
	else
	{
		Session.g_oMS.bMuteFlag = true;
		Session.g_oMS.bDeafFlag = true;
		Session.g_bMutedState = false;
		Session.g_bHoldState = true;
	}

	if (true == Session.g_bMuteThisParty)
	{
		if ("T" == Session.g_strMuteFlag)
		{
			Session.g_bMutedByMod = true;
		}
		else
		{
			Session.g_bMutedByMod = false;
		}
		Session.g_nPromptSelfMuteUnMute = 908;
	}
}
*/]]></script>
          </scripts>
        </action>
        <action id="201" plug-in="Pactolus.Branch.1" ><?xtml-editor x=982 y=1269 ?>
          <!--MoveDirectlyInToSub?-->
          <results >
            <result name="Default" link="196" stubbed="0"/>
            <result name="g_bMoveDirectlyInSub" link="79" stubbed="1" >g_bMoveDirectlyInSubConf == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: SET AUDIO MODE");
if (0 == Session.g_nDefaultAudioMode)
{
	Server.logInfo("INFO: SET CONFERENCE MODE");
	Session.g_oMS.bMuteFlag = false;
	Session.g_oMS.bDeafFlag = false;
	Session.g_bMutedState = false;
	Session.g_bHoldState = false;
}
else if (2 == Session.g_nDefaultAudioMode)
{
	Server.logInfo("INFO: SET MUTE MODE");
	Session.g_oMS.bMuteFlag = true;
	Session.g_oMS.bDeafFlag = false;
	Session.g_bMutedState = true;
	Session.g_bHoldState = false;
}
else
{
	Server.logInfo("INFO: SET MOH MODE");
	Session.g_oMS.bMuteFlag = true;
	Session.g_oMS.bDeafFlag = true;
	Session.g_bMutedState = false;
	Session.g_bHoldState = true;
}]]></script>
          </scripts>
        </action>
        <action id="202" plug-in="Pactolus.Branch.1" ><?xtml-editor x=985 y=890 ?>
          <results >
            <result name="Default" link="15" stubbed="1"/>
            <result name="bRecordToConfBlade" link="203" stubbed="1" >bRecordToConfBlade == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[var myString = new String(Session.g_oMS.strConferenceId);
var myArray = myString.split("@");
Session.g_strMSResourceName = myArray[1];

	
if ( "T" == Session.g_strRecordNamesFlag && Session.g_strCallerRecordedNameMS != Session.g_strMSResourceName ) {
	Session.bRecordToConfBlade = true;
	Server.logInfo("Caller's name recording is on media server: " + Session.g_strCallerRecordedNameMS);
	Server.logInfo("Conference is on media server: " + Session.g_strMSResourceName);
	Server.logInfo("Caller's name is on a different ms blade than the conference.");
}



]]></script>
          </scripts>
        </action>
        <action id="203" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=984 y=1012 ?>
          <!--RecordToMS-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;RecordToMS&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
            <parameter >g_strLanguage</parameter>
            <parameter >g_strCallerRecordedName</parameter>
            <parameter >g_strConfResource</parameter>
          </function>
          <results >
            <result name="Default" link="15" stubbed="1"/>
          </results>
        </action>
        <action id="204" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1366 y=3125 ?>
          <!--"GetCustomPasscode"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;GetCustomPasscode&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="212" stubbed="0"/>
            <result name="SUCCESS" link="205" stubbed="0" >f_nReturnCode == s_nFirstCaller

OR f_nReturnCode == s_nNonFirstCaller

OR f_nReturnCode == s_nWrongSite</result>
            <result name="WFM or CSR" >f_nReturnCode == s_nWaitForMod

OR f_nReturnCode == s_nStateRouteToCsr</result>
            <result name="RouteTPCSR" >f_nReturnCode == s_nStateRouteToThirdPartyCsr</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[Session.g_bTPCSRRouteInProgress = false;

Session.g_nTempInt = Session.f_nReturnCode;

if (3 == Result.id)

{

	if (Session.s_nWaitForMod == Session.f_nReturnCode)

		Session.f_nCurrentState = Session.s_nStateWaitForMod;

	else

	{

		Session.f_nCurrentState = Session.s_nStateRouteToCsr;

		Session.g_nCSRRouteReasonCode = 2;  //exceed passcode validation attemps

	}

}
if (4 == Result.id)
{
	Session.f_nCurrentState = Session.s_nStateRouteToThirdPartyCsr;
}]]></script>
          </scripts>
        </action>
        <action id="205" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1631 y=3269 ?>
          <!--Delete MS Connection-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DeleteMSConnection&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="211" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Session.g_nTempInt == Session.s_nFirstCaller && !Session.g_bNoCreateConfFirstCaller)
{
	Session.f_nCurrentState = Session.s_nStateCreateConference;
}
else if (Session.g_nTempInt == Session.s_nNonFirstCaller || Session.g_bNoCreateConfFirstCaller)
{
	Session.g_oMS.strConferenceId = Session.g_strConfResource;
	Session.f_nCurrentState = Session.s_nStateAddToConference;
}
else
{
	Session.f_nCurrentState = Session.s_nStateEndCall;
}]]></script>
          </scripts>
        </action>
        <action id="209" plug-in="Pactolus.Sleep.1" ><?xtml-editor x=1134 y=3135 ?>
          <!--s_fConfStartCallDelay secs-->
          <sleep xmlns="urn:www.pactolus.com:xtml:application" duration="s_fConfStartCallDelay"/>
          <results >
            <result name="Default" link="204" stubbed="0"/>
          </results>
        </action>
        <action id="210" plug-in="Pactolus.Branch.1" ><?xtml-editor x=892 y=3139 ?>
          <!--delay?-->
          <results >
            <result name="Default" link="204" stubbed="1"/>
            <result name="s_fConfStartCallDelay &gt; 0 ?" link="209" stubbed="0" >s_fConfStartCallDelay &gt; 0</result>
          </results>
        </action>
        <action id="211" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1869 y=3268 ?>
          <!--HandoffToProxy-->
          <results >
            <result name="Default" link="1" stubbed="1"/>
            <result name="g_bWrongSiteHandOff" link="19" stubbed="1" >g_nRedirectStatus != 3

AND g_bWrongSiteHangOff == true</result>
          </results>
        </action>
        <action id="212" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1618 y=3085 ?>
          <!--Hang up caller-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpCaller&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="1" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_nCurrentState = Session.s_nStateEndCall;]]></script>
          </scripts>
        </action>
        <action id="213" plug-in="Pactolus.Branch.1" ><?xtml-editor x=3205 y=1104 ?>
          <results >
            <result name="Default" link="86" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_nCurrentState = Session.s_nStateWait;
Server.logInfo("nCurrentState : " + Session.f_nCurrentState);
]]></script>
          </scripts>
        </action>
        <action id="214" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=3808 y=1948 ?>
          <!--set DTMF Detection ON-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;SetDTMFOn&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="19" stubbed="1"/>
          </results>
        </action>
        <action id="215" plug-in="Pactolus.SipResponse.1" ><?xtml-editor x=2165 y=312 ?>
          <!--"480 Temporary Unavailable"-->
          <sip-response xmlns="urn:www.pactolus.com:xtml:sip" remove-via="0" reliable="0" increment-cseq-first="0" increment-cseq-last="0" >
            <call-id >g_oCallLegA.strCallId</call-id>
            <contact >g_strContact</contact>
            <cseq >g_oCallLegA.strCSeq</cseq>
            <from >g_oCallLegA.strFrom</from>
            <status >"SIP/2.0 480 Temporarily Unavailable"</status>
            <to >g_oCallLegA.strTo</to>
            <via >g_oCallLegA.strVia</via>
          </sip-response>
          <results >
            <result name="Default" link="51" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[var myTo = new SipTo(Session.g_oCallLegA.strTo);
if (undefined == myTo.tag)
{
	Session.g_oCallLegA.strTo = Session.g_oCallLegA.strTo + ";tag=" + Server.getUTCTime();
}]]></script>
          </scripts>
        </action>
        <action id="216" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2926 y=2597 ?>
          <!--Is Global Music On?-->
          <results >
            <result name="Default" link="70" stubbed="0"/>
            <result name="globaMusicFlag==&quot;T&quot;" link="131" stubbed="1" >g_strGlobalMusicOnFlag match "T"</result>
          </results>
        </action>
        <action id="217" plug-in="Pactolus.Branch.1" ><?xtml-editor x=3045 y=2334 ?>
          <!--Is Global Music On?-->
          <results >
            <result name="Default" link="57" stubbed="0"/>
            <result name="globaMusicFlag==&quot;T&quot;" link="131" stubbed="1" >g_strGlobalMusicOnFlag match "T"</result>
          </results>
        </action>
      </actions>
    </function>
    <function name="Unavailable" start="6" event="Unavailable" returns="void" >
      <local-vars >
        <var name="f_nReturnCode" type="i4" >-50</var>
        <var name="f_strContact" type="string" ></var>
      </local-vars>
      <actions >
        <action id="6" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=143 y=195 ?>
          <!--"getAccessNumberType"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceGetAccessNumberType&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="7" stubbed="0"/>
            <result name="g_strTollFreeAccessNumber" link="9" stubbed="0" >g_strTollFreeAccessNumberFlag match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: Unavailable");]]></script>
          </scripts>
        </action>
        <action id="1" plug-in="Pactolus.SipResponse.1" ><?xtml-editor x=594 y=281 ?>
          <!--"486 Busy Here"-->
          <sip-response xmlns="urn:www.pactolus.com:xtml:sip" remove-via="0" reliable="0" increment-cseq-first="0" increment-cseq-last="0" >
            <call-id >g_oCallLegA.strCallId</call-id>
            <contact >g_strContact</contact>
            <cseq >g_oCallLegA.strCSeq</cseq>
            <from >g_oCallLegA.strFrom</from>
            <status >"SIP/2.0 486 Busy Here"</status>
            <to >g_oCallLegA.strTo</to>
            <via >g_oCallLegA.strVia</via>
          </sip-response>
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="Success" link="10" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[var myTo = new SipTo(Session.g_oCallLegA.strTo);

if (undefined == myTo.tag)

{

	Session.g_oCallLegA.strTo = Session.g_oCallLegA.strTo + ";tag=" + Server.getUTCTime();

}]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=888 y=270 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logError("ERROR: RESPONSE 486 BUSY HERE FAILURE");]]></script>
          </scripts>
        </action>
        <action id="3" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=889 y=207 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: SUCCESS RESPONSE 300 MULTIPLE CHOICE ****");]]></script>
          </scripts>
        </action>
        <action id="5" plug-in="Pactolus.SipResponse.1" ><?xtml-editor x=591 y=134 ?>
          <!--"300 Multiple Choices"-->
          <sip-response xmlns="urn:www.pactolus.com:xtml:sip" remove-via="0" reliable="0" increment-cseq-first="0" increment-cseq-last="0" >
            <call-id >g_oCallLegA.strCallId</call-id>
            <contact >f_strContact</contact>
            <cseq >g_oCallLegA.strCSeq</cseq>
            <from >g_oCallLegA.strFrom</from>
            <status >"SIP/2.0 300 Multiple Choices"</status>
            <to >g_oCallLegA.strTo</to>
            <via >g_oCallLegA.strVia</via>
          </sip-response>
          <results >
            <result name="Default" link="8" stubbed="0"/>
            <result name="Success" link="3" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[var myTo = new SipTo(Session.g_oCallLegA.strTo);
if (undefined == myTo.tag)
{
	Session.g_oCallLegA.strTo = Session.g_oCallLegA.strTo + ";tag=" + Server.getUTCTime();
}
var myContact = new SipUrl(Session.g_oCallLegA.strRequestUri);
if (Session.g_strAlternateSitePrefix.length > 0)
{
	if (myContact.port > 0)
		Session.f_strContact = "sip:" + Session.g_strAlternateSitePrefix +  "@" + myContact.host + ":" + myContact.port;
	else
		Session.f_strContact = "sip:" + Session.g_strAlternateSitePrefix +  "@" + myContact.host;
}
else
{
	Server.logInfo("WARNING: NO ALTERNATE SITE PREFIX FROM THE DB");
	if (myContact.port > 0)
		Session.f_strContact = "sip:" + myContact.host + ":" + myContact.port;
	else
		Session.f_strContact = "sip:" + myContact.host;
}

]]></script>
          </scripts>
        </action>
        <action id="7" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=348 y=139 ?>
          <!--"psAPISceGetBackupSite"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceGetBackupSite&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="5" stubbed="0"/>
          </results>
        </action>
        <action id="8" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=866 y=100 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logError("ERROR: RESPONSE 300 MULTIPLE CHOICES");]]></script>
          </scripts>
        </action>
        <action id="9" plug-in="Pactolus.Branch.1" ><?xtml-editor x=365 y=287 ?>
          <!--send 486-->
          <results >
            <result name="Default" link="7" stubbed="1"/>
            <result name="send 486" link="1" stubbed="0" >s_strSend486 match "T"</result>
          </results>
        </action>
        <action id="10" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=909 y=373 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: SUCCESS RESPONSE 486 BUSY HERE ****");]]></script>
          </scripts>
        </action>
      </actions>
    </function>
    <function name="GetPassCode" start="159" event="GetPassCode" returns="i4" >
      <local-vars >
        <var name="f_sCounter" type="i2" >0</var>
        <var name="f_nReturnCode" type="i4" >-1</var>
        <var name="f_sMaxRetry" type="i2" >0</var>
        <var name="f_nTempInt" type="i4" >0</var>
        <var name="f_lCurrentTime" type="i8" >0</var>
        <var name="f_strPongSessionId" type="string" ></var>
        <var name="f_nPromptToPlay" type="i4" >99</var>
        <var name="f_bRouteToCSR" type="boolean" >0</var>
        <var name="f_strTerminationDigit" type="string" ></var>
        <var name="f_nCallLegCount" type="i4" >0</var>
        <var name="f_nWaitForResCounter" type="i4" >0</var>
        <var name="f_bPlayPleaseHold" type="boolean" >1</var>
        <var name="f_nPassCodeStatus" type="i4" >0</var>
        <var name="f_strTempString" type="string" ></var>
        <var name="f_bEmptyString" type="boolean" >0</var>
        <var name="s_nPromptTooEarly" type="i4" >972</var>
      </local-vars>
      <actions >
        <action id="159" plug-in="Pactolus.Branch.1" ><?xtml-editor x=39 y=534 ?>
          <!--Event conf?-->
          <results >
            <result name="Default" link="149" stubbed="0"/>
            <result name="g_nDnisIdentifyConferenceFlag == 1" link="160" stubbed="0" >g_nDnisIdentifiedConfFlag == 1</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: GetPassCode");]]></script>
          </scripts>
        </action>
        <action id="1" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=930 y=534 ?>
          <!--Collect pass code-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="g_strPassCodeDigitMap" language="g_strLanguage" digits="g_strPassCode" retry-count="" clear-digits="0" terminating-digit="f_strTerminationDigit" quick-collect="0" digit-timer="" >
            <audio type="index" >s_nPromptGetPasscode</audio>
          </play>
          <results >
            <result name="Default" link="85" stubbed="1"/>
            <result name="Success" link="109" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout" link="157" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strPassCode = "";
Session.f_strTerminationDigit = "";]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=215 y=1216 ?>
          <!--authenticate pass code-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceAuthConfPassCode&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="113" stubbed="0"/>
            <result name="0 or 1 or 3 - SUCCESS" link="151" stubbed="0" >f_nReturnCode == 0
OR f_nReturnCode == 1
OR f_nReturnCode == 3</result>
            <result name="2 - WAIT FOR RESOURCE" link="84" stubbed="0" >f_nReturnCode == 2</result>
            <result name="-2 - TOO EARLY" link="154" stubbed="0" >f_nReturnCode == -2</result>
            <result name="-8 - PASSCODE INUSED" link="132" stubbed="0" >f_nReturnCode == -8</result>
            <result name="-11 - WAIT FOR MOD" link="136" stubbed="0" >f_nReturnCode == s_nWaitForMod</result>
            <result name="-1 INVALID" link="4" stubbed="0" >f_nReturnCode == -1</result>
            <result name="-15 INSUFFICIENT BALANCE" link="120" stubbed="0" >f_nReturnCode == -15</result>
            <result name="-16 PIN LOCKED" link="123" stubbed="0" >f_nReturnCode == -16</result>
            <result name="-14 WRONG DAY" link="129" stubbed="0" >f_nReturnCode == -14</result>
            <result name="-18 CANCELLED" link="130" stubbed="0" >f_nReturnCode == -18</result>
            <result name="-21- WRONG SITE" link="151" stubbed="1" >f_nReturnCode == -21</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_nReturnCode = -50;

js_disable_event();]]></script>
            <script language="javascript" timing="last" ><![CDATA[switch (Session.f_nReturnCode)

{
	case -3:

		Server.logInfo("INFO: TOO LATE PASSCODE");

		Session.g_nTerminationReason = 20;

		Session.f_nPromptToPlay = Session.s_nPromptTooLate;

		break;

	case -4:

		Server.logInfo("INFO: DISABLE SUBSCRIBER");

		Session.g_nTerminationReason = 4;

		Session.f_nPromptToPlay = Session.s_nPromptDisableSub;

		break;

	case -5:

		Server.logInfo("INFO: MAX ATTENDEES");

		Session.g_nTerminationReason = 15;

		Session.f_nPromptToPlay = Session.s_nPromptMaxAttendeesReach;

		break;

	case -6:

		Server.logInfo("INFO: CONF LOCKED");

		Session.g_nTerminationReason = 16;

		Session.f_nPromptToPlay = Session.s_nPromptConfLocked;

		break;

	case -7:

		Server.logInfo("INFO: CONF ALREADY ENDED");

		Session.g_nTerminationReason = 2;

		Session.f_nPromptToPlay = Session.s_nPromptConfEnded;

		break;

	case -9:

		Server.logInfo("INFO: MOD NOT IN");

		Session.g_nTerminationReason = 22;

		Session.f_nPromptToPlay = Session.s_nPromptModNotArrive;

		break;

	case -10:

		Server.logError("ERROR: NO CONF CONTROLLER");

		Session.g_nTerminationReason = 39;

		Session.f_nPromptToPlay = Session.s_nPromptNoConfController;

		break;

	case -13:

		Server.logInfo("INFO: CONFERENCE DISABLED");

		Session.g_nTerminationReason = 29;

		Session.f_nPromptToPlay = 853;

		break;

	case -19:

		Server.logInfo("INFO: INVALID ACCESS NUMBER");

		Session.g_nTerminationReason = 28;

		Session.f_nPromptToPlay = 99;

		break;

	case -20:

		Server.logInfo("INFO: INVALID SUBSCRIBER ACCESS NUMBER");

		Session.g_nErrorMsgNumber = 4016; //conf invalid subscriber access number

		Session.g_nTerminationReason = 28;

		Session.f_nPromptToPlay = 99;

		break;

	case -22:

		Server.logError("ERROR: INSUFFICIENT MS RESOURCE");
		
		Session.g_nErrorMsgNumber = 4018; //insufficient ms resource

		Session.g_nTerminationReason = 30;
		
		Session.f_nPromptToPlay = 99;

		break;
		
	case -98:

		Server.logError("ERROR: DB RESTARTED:" + Session.g_strPassCode);

		Session.g_nTerminationReason = 39;

		Session.f_nPromptToPlay = Session.s_nPromptSystemUnavailable;

		break;

	case -99:

		Server.logError("ERROR: DB ERROR PASSCODE:" + Session.g_strPassCode);

		Session.g_nTerminationReason = 39;

		Session.f_nPromptToPlay = Session.s_nPromptDBError;

		break;

	default:

		Session.g_nTerminationReason = 39;

		Session.f_nPromptToPlay = 305;

		break;

}

js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="4" plug-in="Pactolus.Branch.1" ><?xtml-editor x=838 y=1955 ?>
          <!--exceed max retry?-->
          <results >
            <result name="Default" link="144" stubbed="0"/>
            <result name="Counter &gt;= MaxRetry?" link="103" stubbed="0" >f_sCounter &gt;= g_nMaxRetryAllowed</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_sCounter++;
Server.logInfo("Session.f_strTempString is: " + Session.f_strTempString);
Server.logInfo("Session.g_strPassCode is: " + Session.g_strPassCode);
Session.f_strTempString = Session.g_strPassCode;]]></script>
          </scripts>
        </action>
        <action id="12" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=917 y=351 ?>
          <!--Welcome prompt Index-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="50" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="g_strPassCodeDigitMap" language="g_strLanguage" digits="g_strPassCode" retry-count="" clear-digits="1" terminating-digit="f_strTerminationDigit" quick-collect="0" digit-timer="" >
            <audio type="index" >g_nWelcomePromptIndex</audio>
            <audio type="index" >s_nPromptGetPasscode</audio>
          </play>
          <results >
            <result name="Default" link="85" stubbed="1"/>
            <result name="Success" link="109" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout" link="157" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[// Session.f_sMaxRetry = Session.g_nMaxRetryAllowed;

// Session.g_strPassCode = "";]]></script>
          </scripts>
        </action>
        <action id="13" plug-in="Pactolus.Branch.1" ><?xtml-editor x=661 y=361 ?>
          <!--Welcome prompt?-->
          <results >
            <result name="Default" link="12" stubbed="0"/>
            <result name="IWelcomePromptIndex &lt;= 0" link="1" stubbed="0" >g_nWelcomePromptIndex &lt;= 0</result>
          </results>
        </action>
        <action id="14" plug-in="Pactolus.Branch.1" ><?xtml-editor x=388 y=241 ?>
          <!--strWelcomePromptType = U or I-->
          <results >
            <result name="Default" link="1" stubbed="1"/>
            <result name="strWelcomePromptType==U" link="15" stubbed="0" >g_strWelcomePromptType match "U"</result>
            <result name="strWelcomePromptType==I" link="13" stubbed="0" >g_strWelcomePromptType match "I"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_sMaxRetry = Session.g_nMaxRetryAllowed;
Session.g_strPassCode = "";
Server.logInfo("Session ID is: " + Session._sessionId);
Server.logInfo("Welcome Prompt Type is: " + Session.g_strWelcomePromptType);]]></script>
            <script language="javascript" timing="last" ><![CDATA[Server.logInfo("EXIT ON RESULT ID: " + Result.id + "  RESULT NAME: " + Result.name);]]></script>
          </scripts>
        </action>
        <action id="15" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=643 y=165 ?>
          <!--Welcome prompt URL-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="40" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="g_strPassCodeDigitMap" language="g_strLanguage" digits="g_strPassCode" retry-count="" clear-digits="1" terminating-digit="f_strTerminationDigit" quick-collect="0" digit-timer="" >
            <audio type="url" >g_strWelcomePromptUrl</audio>
            <audio type="index" >s_nPromptGetPasscode</audio>
          </play>
          <results >
            <result name="Default" link="85" stubbed="0"/>
            <result name="Success" link="109" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout" link="147" stubbed="1"/>
          </results>
        </action>
        <action id="16" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1168 y=100 ?>
          <!--FAILURE-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nFailure"/>
        </action>
        <action id="27" plug-in="Pactolus.Sleep.1" ><?xtml-editor x=1427 y=1124 ?>
          <!--2 secs-->
          <sleep xmlns="urn:www.pactolus.com:xtml:application" duration="2"/>
          <results >
            <result name="Default" link="2" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (Session.f_bPlayPleaseHold == true)

{

	Session.f_bPlayPleaseHold = false;

}

else if(Session.f_bPlayPleaseHold == false)

{

	Session.f_bPlayPleaseHold = true;

}]]></script>
          </scripts>
        </action>
        <action id="28" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1109 y=1306 ?>
          <!--TOO EARLY-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >s_nPromptTooEarly</audio>
            <audio type="time" >g_strScheduleStartTime</audio>
            <audio type="index" >873</audio>
          </play>
          <results >
            <result name="Default" link="16" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: TOO EARLY PASSCODE:" + Session.g_strPassCode);

Session.g_nTerminationReason = 19;]]></script>
          </scripts>
        </action>
        <action id="53" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=2058 y=1709 ?>
          <!--s_nWaitForMod-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nWaitForMod"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bWaitForModerator = true;]]></script>
          </scripts>
        </action>
        <action id="56" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1446 y=972 ?>
          <!--PostPin prompt?-->
          <results >
            <result name="Default" link="114" stubbed="0"/>
            <result name="PostPinPromptIndex &lt;= 0" link="78" stubbed="1" >g_nPostPinPromptIndex &lt;= 0</result>
          </results>
        </action>
        <action id="57" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1107 y=884 ?>
          <!--strPostPinPromptType = U or I-->
          <results >
            <result name="Default" link="78" stubbed="1"/>
            <result name="strPostPinPromptType==U" link="58" stubbed="0" >g_strPostPinPromptType match "U"</result>
            <result name="strPostPinPromptType==I" link="56" stubbed="0" >g_strPostPinPromptType match "I"</result>
          </results>
        </action>
        <action id="58" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1371 y=806 ?>
          <!--PostPin prompt URL-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="url" >g_strPostPinPromptUrl</audio>
          </play>
          <results >
            <result name="Default" link="78" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="59" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2953 y=934 ?>
          <!--first caller?-->
          <results >
            <result name="Default" link="63" stubbed="0"/>
            <result name="g_bFirstCaller==true" link="62" stubbed="0" >g_bFirstCaller == true</result>
          </results>
        </action>
        <action id="62" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=3184 y=993 ?>
          <!--FIRST CALLER-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nFirstCaller"/>
        </action>
        <action id="63" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=3174 y=881 ?>
          <!--NOT FIRST CALLER-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nNonFirstCaller"/>
        </action>
        <action id="78" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1952 y=985 ?>
          <!--conferenceResource == null?-->
          <results >
            <result name="Default" link="140" stubbed="0"/>
            <result name="conferenceResource == null" link="16" stubbed="1" >g_bNullString == true
AND (g_bFirstCaller == false
OR g_bNoCreateConfFirstCaller == true)</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (!Session.g_bFirstCaller || (Session.g_bFirstCaller && Session.g_bNoCreateConfFirstCaller))
{
	if (Session.g_strConfResource.length <= 0)
	{
		Session.g_bNullString = true;
		Session.g_nErrorMsgNumber = 4014;
		Session.g_nTerminationReason = 39;
		Session.g_strReturnMsg = "NULL CONFERENCE RESOURCE, UNABLE TO ADD PARTY TO THE CONFERENCE";
		if (3 == Session.f_nReturnCode)
			Server.logError("ERROR: THE FIRST CALLER and NO NEED TO GET CONFERENCE ENDPOINT, BUT CONF RESOURCE IS NULL: " + Session.g_strConfResource);
		else
			Server.logError("ERROR: NOT THE FIRST CALLER, BUT CONF RESOURCE IS NULL: " + Session.g_strConfResource);
	}
	else
	{
		Session.g_bNullString = false;
		Session.g_oMS.strConferenceId = Session.g_strConfResource;
	}
}]]></script>
          </scripts>
        </action>
        <action id="82" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1192 y=194 ?>
          <!--send ALARM-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="" transaction="" message-name="s_strSendAlarmRequest" destination-port="" destination-type="1" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;calling_number&quot;" value="g_strAlarmType"/>
            <parameter tag="&quot;called_number&quot;" value="g_strAlarmPriority"/>
          </SOAP>
          <results >
            <result name="Default" link="16" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strAlarmType = "MEDIASERVER: play get passcode";

Session.g_strAlarmPriority = "MAJOR";]]></script>
          </scripts>
        </action>
        <action id="84" plug-in="Pactolus.Branch.1" ><?xtml-editor x=900 y=1198 ?>
          <!--exceed max retry?-->
          <results >
            <result name="Default" link="27" stubbed="1"/>
            <result name="WaitForResCounter &gt; s_nMax?" link="16" stubbed="1" >f_nWaitForResCounter &gt; s_nMaxRetryWaitConfRes</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_nWaitForResCounter++;

Session.g_strRetryFlag = "T";]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (2 == Result.id)

{

	Session.g_nTerminationReason = 2;

	Session.g_nErrorMsgNumber = 4012;  //exceed max wait for conf resource

	Server.logError("ERROR: EXCEED MAX WAIT FOR CONFERENCE RESOURCE.");

}]]></script>
          </scripts>
        </action>
        <action id="85" plug-in="Pactolus.Branch.1" ><?xtml-editor x=894 y=120 ?>
          <!--s_strSendAlarmFlag==T-->
          <results >
            <result name="Default" link="16" stubbed="0"/>
            <result name="s_strSendAlarmFlag==T" link="82" stubbed="0" >s_strSendAlarmFlag match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 40;]]></script>
          </scripts>
        </action>
        <action id="89" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1834 y=1707 ?>
          <!--"RecordCallerName"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;RecordCallerName&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="53" stubbed="0"/>
          </results>
        </action>
        <action id="90" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2717 y=938 ?>
          <!--"RecordCallerName"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;RecordCallerName&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="59" stubbed="0"/>
          </results>
        </action>
        <action id="91" plug-in="Pactolus.JavaStaticMethod.1" ><?xtml-editor x=1934 y=1298 ?>
          <!--"psAPISceConfCleanup"-->
          <java xmlns="urn:www.pactolus.com:xtml:application" class="&quot;com.pactolus.conferencing.psAPISceConfCleanup&quot;" method="&quot;cleanupCallLeg&quot;" timeout="s_nTimeout" return="" method-return-var="f_nReturnCode" method-return-type="0" >
            <parameter type="in" var-type="unknown" >g_strDBNAME</parameter>
            <parameter type="in" var-type="unknown" >g_strExistingCallLegId</parameter>
            <parameter type="in" var-type="unknown" >f_lCurrentTime</parameter>
          </java>
          <results >
            <result name="Default" link="128" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: ********JAVA CALLING psAPISceConfCleanupCallLeg *********");

Session.f_lCurrentTime = Server.getUTCTime();]]></script>
            <script language="javascript" timing="last" ><![CDATA[Server.logInfo("INFO: ********** iJavaReturnCode " + Session.f_nReturnCode);

if (Result.id == 2)

{

	Server.logInfo("INFO: SUCCESS CALL psAPISceConfCleanupCallLeg.");

}

else

{

	Server.logError("ERROR: FAIL TO CALL psAPISceConfCleanupCallLeg, EXIT ON: " + Result.name);

}]]></script>
          </scripts>
        </action>
        <action id="92" plug-in="Standard.WaitEvent.1" ><?xtml-editor x=1406 y=1490 ?>
          <!--for PONG-->
          <wait xmlns="urn:www.pactolus.com:xtml:communication" timeout="5" recv-name="g_strEventReceived" >
            <msg name="ConferencePong" >
              <parameter >f_nPassCodeStatus</parameter>
            </msg>
          </wait>
          <results >
            <result name="Default" link="91" stubbed="1"/>
            <result name="Success" link="133" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="93" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1169 y=1496 ?>
          <!--PING to session-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="" transaction="" message-name="&quot;ConferencePing&quot;" destination-port="" destination-type="3" destination-session="g_strExistingSessionId" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;PingSessionId&quot;" value="g_strSessionId"/>
            <parameter tag="&quot;PassCode&quot;" value="g_strPassCode"/>
          </SOAP>
          <results >
            <result name="Default" link="91" stubbed="1"/>
            <result name="Success" link="92" stubbed="0"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_disable_event();]]></script>
          </scripts>
        </action>
        <action id="94" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2735 y=1070 ?>
          <!--Collect billing code-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;(xxxxxxxxxx|x.T|x.#)&quot;" language="g_strLanguage" digits="g_strBillingCodeNumber" retry-count="g_nMaxRetryAllowed" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >943</audio>
            <audio type="index" >580</audio>
            <timeout-prompt type="index" >552</timeout-prompt>
          </play>
          <results >
            <result name="Default" link="96" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="95" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2472 y=979 ?>
          <!--get billing code?-->
          <results >
            <result name="Default" link="90" stubbed="0"/>
            <result name="g_strBillingCodeFlag==T" link="94" stubbed="0" >g_strBillingCodeFlag match "T"</result>
          </results>
        </action>
        <action id="96" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2941 y=1069 ?>
          <!--set billing code-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceSetBillingCode&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="90" stubbed="1"/>
          </results>
        </action>
        <action id="103" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1060 y=2199 ?>
          <!--ACD enable?-->
          <results >
            <result name="Default" link="116" stubbed="0"/>
            <result name="routeTPCSR== &quot;T&quot;" link="155" stubbed="0" >g_strThirdPartyAcdOutdialAvail match "T"
AND f_bEmptyString == false</result>
            <result name="routeCSR=&quot;T&quot;" link="119" stubbed="0" >g_strACDCSROnMaxLoginsEnabled match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (Session.g_strThirdPartyAcdOutdialNumber.length <= 0)
	Session.f_bEmptyString = true;
else
	Session.f_bEmptyString = false;
if ("T" == Session.g_strThirdPartyAcdOutdialAvail && Session.f_bEmptyString)
{
	Server.logError("ERROR: ROUTE TO THIRD PARTY CSR IS TRUE, BUT THERE IS NO NUMBER TO OUTDIAL")
	Server.logError("ERROR: EXCEED MAX RETRIES TO ENTER PASSCODE, HANGUP")
}]]></script>
          </scripts>
        </action>
        <action id="104" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1539 y=2298 ?>
          <!--route to CSR-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nStateRouteToCsr"/>
        </action>
        <action id="109" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1175 y=529 ?>
          <!--call CSR?-->
          <results >
            <result name="Default" link="2" stubbed="1"/>
            <result name="f_bRouteToCSR==true" link="4" stubbed="1" >f_bRouteToCSR == true</result>
            <result name="f_strTerminationDigit = &quot;*&quot;" link="1" stubbed="1" >f_strTerminationDigit match "\*"</result>
            <result name="f_bEmptyString" link="158" stubbed="0" >f_bEmptyString == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (Session.g_strPassCode.length == 1 && Session.g_strPassCode == "0")

{

	Session.f_bRouteToCSR = true;

}

else if (0 == Session.g_strPassCode.length)

{

	Session.f_bEmptyString = true;

}

else

{

	Session.f_bEmptyString = false;

}]]></script>
          </scripts>
        </action>
        <action id="110" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1417 y=526 ?>
          <!--s_nStateRouteToCsr-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nStateRouteToCsr"/>
        </action>
        <action id="112" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1771 y=348 ?>
          <!--no response-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >552</audio>
          </play>
          <results >
            <result name="Default" link="147" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="113" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=360 y=775 ?>
          <!--play prompt-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >f_nPromptToPlay</audio>
          </play>
          <results >
            <result name="Default" link="16" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="114" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1702 y=971 ?>
          <!--post pin prompt-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >g_nPostPinPromptIndex</audio>
          </play>
          <results >
            <result name="Default" link="78" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="115" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1554 y=2140 ?>
          <!--invalid passcode-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >853</audio>
            <audio type="index" >s_nPromptGetPasscode</audio>
          </play>
          <results >
            <result name="Default" link="16" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="116" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1282 y=2146 ?>
          <!--invalid passcode-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >853</audio>
          </play>
          <results >
            <result name="Default" link="16" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO:  MAX RETRY GETTING PASSCODE.");

Session.g_nTerminationReason = 2;]]></script>
          </scripts>
        </action>
        <action id="119" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1292 y=2303 ?>
          <!--invalid passcode-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >853</audio>
          </play>
          <results >
            <result name="Default" link="104" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO:  MAX RETRY GETTING PASSCODE.");]]></script>
          </scripts>
        </action>
        <action id="120" plug-in="Pactolus.Branch.1" ><?xtml-editor x=826 y=2442 ?>
          <!--subscriber?-->
          <results >
            <result name="Default" link="121" stubbed="0"/>
            <result name="g_strIsSubscriberFlag== &quot;T&quot;" link="122" stubbed="0" >g_strIsSubscriberFlag match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 23;  //out of money]]></script>
          </scripts>
        </action>
        <action id="121" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1072 y=2352 ?>
          <!--not enough $, call moderator-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >874</audio>
            <audio type="index" >878</audio>
          </play>
          <results >
            <result name="Default" link="16" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="122" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1078 y=2514 ?>
          <!--not enought $, call CSR-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >507</audio>
            <audio type="index" >307</audio>
          </play>
          <results >
            <result name="Default" link="16" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="123" plug-in="Pactolus.Branch.1" ><?xtml-editor x=818 y=2799 ?>
          <!--subscriber?-->
          <results >
            <result name="Default" link="124" stubbed="0"/>
            <result name="g_strIsSubscriberFlag== &quot;T&quot;" link="125" stubbed="0" >g_strIsSubscriberFlag match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 24;  //conf pin locked]]></script>
          </scripts>
        </action>
        <action id="124" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1064 y=2709 ?>
          <!--pin locked, call moderator-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >874</audio>
            <audio type="index" >878</audio>
          </play>
          <results >
            <result name="Default" link="16" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="125" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1070 y=2871 ?>
          <!--pin locked, call CSR-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >338</audio>
            <audio type="index" >307</audio>
          </play>
          <results >
            <result name="Default" link="16" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="126" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1163 y=1133 ?>
          <!--play hold?-->
          <results >
            <result name="Default" link="27" stubbed="0"/>
            <result name="f_bPlayPleaseHold == true" link="127" stubbed="0" >f_bPlayPleaseHold == true</result>
          </results>
        </action>
        <action id="127" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1440 y=1243 ?>
          <!--please hold-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >898</audio>
          </play>
          <results >
            <result name="Default" link="27" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_bPlayPleaseHold = false;]]></script>
          </scripts>
        </action>
        <action id="128" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2156 y=1302 ?>
          <!--exceed max retry?-->
          <results >
            <result name="Default" link="2" stubbed="1"/>
            <result name="Counter &gt;= MaxRetry?" link="131" stubbed="0" >f_sCounter &gt;= g_nMaxRetryAllowed</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_sCounter++;

Session.g_strRetryFlag = "T";]]></script>
          </scripts>
        </action>
        <action id="129" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=780 y=2979 ?>
          <!--WRONG DAY-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >948</audio>
          </play>
          <results >
            <result name="Default" link="16" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 26; //wrong day]]></script>
          </scripts>
        </action>
        <action id="130" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=762 y=3137 ?>
          <!--CONF CANCEL-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >949</audio>
          </play>
          <results >
            <result name="Default" link="16" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 25; //conf cancelled]]></script>
          </scripts>
        </action>
        <action id="131" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2427 y=1296 ?>
          <!--could not be added-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >301</audio>
            <audio type="index" >874</audio>
          </play>
          <results >
            <result name="Default" link="16" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 21;

Session.g_nErrorMsgNumber = 4012;  //max retry]]></script>
          </scripts>
        </action>
        <action id="132" plug-in="Pactolus.Branch.1" ><?xtml-editor x=897 y=1504 ?>
          <!--same session-->
          <results >
            <result name="Default" link="93" stubbed="0"/>
            <result name="same session" link="91" stubbed="1" >g_strExistingSessionId match g_strSessionId</result>
          </results>
        </action>
        <action id="133" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1673 y=1483 ?>
          <!--passcode inused?-->
          <results >
            <result name="Default" link="91" stubbed="0"/>
            <result name="passcode inused" link="143" stubbed="0" >f_nPassCodeStatus == s_nPasscodeInUsed</result>
          </results>
        </action>
        <action id="135" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1361 y=1717 ?>
          <!--Collect billing code-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;(xxxxxxxxxx|x.T|x.#)&quot;" language="g_strLanguage" digits="g_strBillingCodeNumber" retry-count="g_nMaxRetryAllowed" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >943</audio>
            <audio type="index" >580</audio>
            <timeout-prompt type="index" >552</timeout-prompt>
          </play>
          <results >
            <result name="Default" link="137" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="136" plug-in="Pactolus.Branch.1" ><?xtml-editor x=863 y=1728 ?>
          <!--get billing code?-->
          <results >
            <result name="Default" link="89" stubbed="1"/>
            <result name="g_strBillingCodeFlag==T" link="135" stubbed="0" >g_strBillingCodeFlag match "T"</result>
          </results>
        </action>
        <action id="137" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1600 y=1714 ?>
          <!--set billing code-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceSetBillingCode&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="89" stubbed="0"/>
          </results>
        </action>
        <action id="139" plug-in="Pactolus.Branch.1" ><?xtml-editor x=866 y=942 ?>
          <!--call CSR?-->
          <results >
            <result name="Default" link="57" stubbed="0"/>
            <result name="f_bRouteToCSR==true" link="57" stubbed="1" >f_bRouteToCSR == true</result>
            <result name="f_strTerminationDigit = &quot;*&quot;" link="57" stubbed="1" >f_strTerminationDigit match "\*"</result>
            <result name="wrong site" link="152" stubbed="0" >g_bWrongSiteHangOff == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (Session.g_strAttendeeId.length == 1 && Session.g_strAttendeeId == "0")

{

	Session.f_bRouteToCSR = true;

}

else if (Session.g_strAttendeeId == Session.g_strAnonymousAttendeeId)

{

	Session.g_bAnonymousCaller = true;

}

else

{

	Session.g_bAnonymousCaller = false;

}]]></script>
          </scripts>
        </action>
        <action id="140" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2208 y=982 ?>
          <!--anonymous caller?-->
          <results >
            <result name="Default" link="95" stubbed="0"/>
            <result name="g_bAnonymousCaller" link="59" stubbed="1" >g_bAnonymousCaller == true</result>
          </results>
        </action>
        <action id="141" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1284 y=1857 ?>
          <!--invalid, get passcode again-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="g_strPassCodeDigitMap" language="g_strLanguage" digits="g_strPassCode" retry-count="" clear-digits="0" terminating-digit="f_strTerminationDigit" quick-collect="0" digit-timer="" >
            <audio type="index" >853</audio>
            <audio type="index" >s_nPromptGetPasscode</audio>
          </play>
          <results >
            <result name="Default" link="85" stubbed="1"/>
            <result name="Success" link="109" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout" link="4" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strPassCode = "";
Session.f_strTerminationDigit = "";]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (4 == Result.id)

{

	Session.g_nTerminationReason = 2;

}]]></script>
          </scripts>
        </action>
        <action id="142" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1574 y=1848 ?>
          <!--Collect pass code-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="g_strPassCodeDigitMap" language="g_strLanguage" digits="g_strPassCode" retry-count="" clear-digits="0" terminating-digit="f_strTerminationDigit" quick-collect="0" digit-timer="" >
            <audio type="index" >s_nPromptGetPasscode</audio>
          </play>
          <results >
            <result name="Default" link="85" stubbed="1"/>
            <result name="Success" link="109" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strPassCode = "";
Session.f_strTerminationDigit = "";
Session.g_nErrorMsgNumber = 0;]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (4 == Result.id)

{

	Session.g_nTerminationReason = 2;

}]]></script>
          </scripts>
        </action>
        <action id="143" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2014 y=1542 ?>
          <!--could not be added-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >301</audio>
            <audio type="index" >874</audio>
          </play>
          <results >
            <result name="Default" link="16" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 21;]]></script>
          </scripts>
        </action>
        <action id="144" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1053 y=1864 ?>
          <!--empty string-->
          <results >
            <result name="Default" link="141" stubbed="0"/>
            <result name="f_bEmptyString" link="145" stubbed="0" >f_bEmptyString == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (0 == Session.f_strTempString.length || 0 == Session.g_strPassCode.length)
{
	Server.logError("PASSCODE LENGTH IS ZERO");
	Server.logError("Session.f_strTempString is: " + Session.f_strTempString);
	Server.logError("Session.g_strPassCode is: " + Session.g_strPassCode);
	Session.f_bEmptyString = true;
}
else
{
	Session.f_bEmptyString = false;
}]]></script>
          </scripts>
        </action>
        <action id="145" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1290 y=2009 ?>
          <!--invalid, get passcode again-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="g_strPassCodeDigitMap" language="g_strLanguage" digits="g_strPassCode" retry-count="" clear-digits="0" terminating-digit="f_strTerminationDigit" quick-collect="0" digit-timer="" >
            <audio type="index" >853</audio>
            <audio type="index" >s_nPromptGetPasscode</audio>
          </play>
          <results >
            <result name="Default" link="85" stubbed="1"/>
            <result name="Success" link="109" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout" link="142" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strPassCode = "";
Session.f_strTerminationDigit = "";]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (4 == Result.id)

{

	Session.g_nTerminationReason = 2;

}]]></script>
          </scripts>
        </action>
        <action id="146" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1524 y=348 ?>
          <!--invalid, get passcode again-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="g_strPassCodeDigitMap" language="g_strLanguage" digits="g_strPassCode" retry-count="" clear-digits="0" terminating-digit="f_strTerminationDigit" quick-collect="0" digit-timer="" >
            <audio type="index" >s_nPromptGetPasscode</audio>
          </play>
          <results >
            <result name="Default" link="85" stubbed="1"/>
            <result name="Success" link="109" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout" link="112" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strPassCode = "";]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (4 == Result.id)

{

	Session.g_nTerminationReason = 2;

}]]></script>
          </scripts>
        </action>
        <action id="147" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1265 y=350 ?>
          <!--exceed max retry?-->
          <results >
            <result name="Default" link="146" stubbed="0"/>
            <result name="Counter &gt;= MaxRetry?" link="16" stubbed="1" >f_sCounter &gt;= g_nMaxRetryAllowed</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_sCounter++;

Session.f_strTempString = Session.g_strPassCode;]]></script>
          </scripts>
        </action>
        <action id="149" plug-in="Pactolus.Branch.1" ><?xtml-editor x=323 y=423 ?>
          <!--HandOff from Proxy or Passcode Provided?-->
          <results >
            <result name="Default" link="14" stubbed="1"/>
            <result name="g_bHandOff" link="2" stubbed="1" >g_bHandOff == true</result>
            <result name="g_bPasscodeProvided" link="2" stubbed="1" >g_bPasscodeProvided == true</result>
          </results>
        </action>
        <action id="151" plug-in="Pactolus.Branch.1" ><?xtml-editor x=449 y=960 ?>
          <!--Come from HandOff?-->
          <results >
            <result name="Default" link="139" stubbed="1"/>
            <result name="g_bHandOff" link="153" stubbed="0" >g_bHandOff == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_sMaxRetry = Session.g_nMaxRetryAllowed;]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (2 == Result.id)

{

	if (Session.g_strAttendeeId == Session.g_strAnonymousAttendeeId)

	{

		Session.g_bAnonymousCaller = true;

	}

	else

	{

		Session.g_bAnonymousCaller = false;

	}

}]]></script>
          </scripts>
        </action>
        <action id="152" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1118 y=1031 ?>
          <!--s_nWrongSite-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nWrongSite"/>
        </action>
        <action id="153" plug-in="Pactolus.Branch.1" ><?xtml-editor x=679 y=949 ?>
          <!--handback and still get wrong site-->
          <results >
            <result name="Default" link="57" stubbed="1"/>
            <result name="redirect=3&amp;&amp;returncode=-21" link="16" stubbed="1" >g_nRedirectStatus == 3
AND f_nReturnCode == -21</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (2 == Result.id)
{
	Session.g_nErrorMsgNumber = 4017;
}]]></script>
          </scripts>
        </action>
        <action id="154" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=899 y=1305 ?>
          <!--"PlayTooEarly"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;PlayTooEarly&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="16" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: TOO EARLY PASSCODE:" + Session.g_strPassCode);
Session.g_nTerminationReason = 19;
Session.g_nErrorMsgNumber = 0;]]></script>
          </scripts>
        </action>
        <action id="155" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1291 y=2427 ?>
          <!--invalid passcode-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >853</audio>
          </play>
          <results >
            <result name="Default" link="156" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO:  MAX RETRY GETTING PASSCODE.");]]></script>
          </scripts>
        </action>
        <action id="156" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1544 y=2413 ?>
          <!--route to ThirdParty CSR-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nStateRouteToThirdPartyCsr"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_nCurrentState = Session.s_nStateRouteToThirdPartyCsr;]]></script>
          </scripts>
        </action>
        <action id="157" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1185 y=659 ?>
          <!--no response-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >552</audio>
          </play>
          <results >
            <result name="Default" link="147" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="158" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1419 y=662 ?>
          <!--invalid-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >853</audio>
          </play>
          <results >
            <result name="Default" link="147" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="160" plug-in="Pactolus.Branch.1" ><?xtml-editor x=336 y=625 ?>
          <!--1. Get passcode
2. no passcode, non speaker
3. no passcode, speaker-->
          <results >
            <result name="Default" link="14" stubbed="1"/>
            <result name="2 == g_nEventDnisType" link="2" stubbed="1" >g_nEventDnisType == 2</result>
            <result name="3 == g_nEventDnisType" link="2" stubbed="1" >g_nEventDnisType == 3</result>
          </results>
        </action>
      </actions>
    </function>
    <function name="psAPISceAuthConfPassCode" start="6" event="psAPISceAuthConfPassCode" returns="i4" >
      <local-vars >
        <var name="f_nReturnCode" type="i4" >-50</var>
        <var name="f_strLanguage" type="string" ></var>
        <var name="f_strBlankString" type="string" ></var>
        <var name="f_strConfControllerIP" type="string" ></var>
        <var name="f_nConfControllerPort" type="i4" >0</var>
        <var name="f_bValidInfo" type="boolean" >0</var>
        <var name="strUnUsedDefaultAudioMode" type="string" ></var>
        <var name="strSubConfType" type="string" ></var>
      </local-vars>
      <actions >
        <action id="6" plug-in="Pactolus.Branch.1" ><?xtml-editor x=116 y=426 ?>
          <!--dial out?-->
          <results >
            <result name="Default" link="1" stubbed="0"/>
            <result name="dial out?" link="7" stubbed="0" >g_strOutdialFlag match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: psAPISceAuthConfPassCode");
Session.g_nErrorMsgNumber = 0;
if (0 == Session.g_nReleaseToConfStatus)
	Session.strSubConfType = "NS";
else if (1 == Session.g_nReleaseToConfStatus)
	Session.strSubConfType = "SP";
else if (2 == Session.g_nReleaseToConfStatus)
	Session.strSubConfType = "CO";
else if (3 == Session.g_nReleaseToConfStatus)
	Session.strSubConfType = "CL";
else
	Session.strSubConfType = "";
Server.logInfo("Conf Status IS: " + Session.g_nReleaseToConfStatus);
Server.logInfo("Sub Conference Type IS: " + Session.strSubConfType);]]></script>
          </scripts>
        </action>
        <action id="1" plug-in="Pactolus.JavaStaticMethod.1" ><?xtml-editor x=426 y=270 ?>
          <!--validatePassCode()-->
          <java xmlns="urn:www.pactolus.com:xtml:application" class="&quot;com.pactolus.conferencing.psAPISceAuthConfPasscodeB&quot;" method="&quot;validateConfPassCode&quot;" timeout="90" return="" method-return-var="f_nReturnCode" method-return-type="0" >
            <parameter type="in" var-type="string" >g_strDBNAME</parameter>
            <parameter type="in" var-type="string" >g_strSessionId</parameter>
            <parameter type="in" var-type="string" >s_strApplicationName</parameter>
            <parameter type="in" var-type="string" >g_strPassCode</parameter>
            <parameter type="in" var-type="string" >g_strStrippedOrigNbr</parameter>
            <parameter type="in" var-type="string" >f_strBlankString</parameter>
            <parameter type="in" var-type="i4" >g_nAccessNumberId</parameter>
            <parameter type="in" var-type="i8" >g_lServiceProviderId</parameter>
            <parameter type="in" var-type="string" >g_strRetryFlag</parameter>
            <parameter type="in" var-type="string" >g_strSoapAddress</parameter>
            <parameter type="in" var-type="i4" >g_nSoapPort</parameter>
            <parameter type="in" var-type="i4" >g_nMaxRetryAllowed</parameter>
            <parameter type="in" var-type="i4" >g_nNbrPassCodeRetries</parameter>
            <parameter type="in" var-type="string" >g_strOrigDomIntlFlag</parameter>
            <parameter type="in" var-type="i4" >g_nOrigCountryId</parameter>
            <parameter type="in" var-type="string" >g_strInfoDigits</parameter>
            <parameter type="in" var-type="string" >g_oCallLegA.strFrom</parameter>
            <parameter type="in" var-type="string" >g_oCallLegA.strTo</parameter>
            <parameter type="in" var-type="string" >g_oCallLegA.strCallId</parameter>
            <parameter type="in" var-type="string" >g_strSIPStatus</parameter>
            <parameter type="in" var-type="i8" >g_lStartTime</parameter>
            <parameter type="in" var-type="string" >g_strGWIPIngress</parameter>
            <parameter type="in" var-type="i4" >g_nGWPortIngress</parameter>
            <parameter type="in" var-type="string" >g_strGWIPEgress</parameter>
            <parameter type="in" var-type="i4" >g_nGWPortEgress</parameter>
            <parameter type="in" var-type="i4" >g_nRtpEncoding</parameter>
            <parameter type="in" var-type="i4" >g_nRtpClockRate</parameter>
            <parameter type="in" var-type="i4" >g_nCallMode</parameter>
            <parameter type="in" var-type="string" >g_strOutdialFlag</parameter>
            <parameter type="in" var-type="string" >g_strOrigCallingCode</parameter>
            <parameter type="in" var-type="string" >g_strOrigAreaCode</parameter>
            <parameter type="in" var-type="string" >g_strDestDomIntlFlag</parameter>
            <parameter type="in" var-type="i4" >g_nDestCountryId</parameter>
            <parameter type="in" var-type="string" >g_strDestCallingCountryCode</parameter>
            <parameter type="in" var-type="string" >g_strDestAreaCode</parameter>
            <parameter type="in" var-type="string" >g_strSPTimeZone</parameter>
            <parameter type="in" var-type="string" >g_strModOutdialFlag</parameter>
            <parameter type="in" var-type="string" >g_strOperatorFlag</parameter>
            <parameter type="in" var-type="i4" >g_nDialPlanId</parameter>
            <parameter type="in" var-type="string" >g_strForceModeratorFlag</parameter>
            <parameter type="in" var-type="string" >g_strForceMuteFlag</parameter>
            <parameter type="in" var-type="string" >g_strUsedDefaultANIFlag</parameter>
            <parameter type="in" var-type="i4" >s_nSiteId</parameter>
            <parameter type="in" var-type="i4" >g_nRedirectStatus</parameter>
            <parameter type="in" var-type="i8" >g_lPartySchedId</parameter>
            <parameter type="in" var-type="string" >g_strModReAuthFlag</parameter>
            <parameter type="in" var-type="string" >strSubConfType</parameter>
            <parameter type="in" var-type="i4" >g_nReleaseToConfStatus</parameter>
            <parameter type="inout" var-type="i4" >g_nScheduleDuration</parameter>
            <parameter type="inout" var-type="string" >g_strScheduleStartTime</parameter>
            <parameter type="inout" var-type="i8" >g_lTimeAvailable</parameter>
            <parameter type="inout" var-type="string" >g_strConfScheduleId</parameter>
            <parameter type="inout" var-type="string" >g_strCallLegId</parameter>
            <parameter type="inout" var-type="string" >g_strConfResource</parameter>
            <parameter type="inout" var-type="string" >g_strConfEventId</parameter>
            <parameter type="inout" var-type="string" >g_strModeratorFlag</parameter>
            <parameter type="inout" var-type="string" >f_strConfControllerIP</parameter>
            <parameter type="inout" var-type="i4" >f_nConfControllerPort</parameter>
            <parameter type="inout" var-type="string" >g_strCallerFirstName</parameter>
            <parameter type="inout" var-type="string" >g_strCallerLastName</parameter>
            <parameter type="inout" var-type="string" >g_strCallerOrg</parameter>
            <parameter type="inout" var-type="string" >g_strPartyPasscodeFlag</parameter>
            <parameter type="inout" var-type="string" >g_strMuteFlag</parameter>
            <parameter type="inout" var-type="string" >g_strModeratorMutedFlag</parameter>
            <parameter type="inout" var-type="string" >g_strConfPassCode</parameter>
            <parameter type="inout" var-type="i4" >g_nMaxCallerHoldTime</parameter>
            <parameter type="inout" var-type="string" >g_strPostPinPromptType</parameter>
            <parameter type="inout" var-type="i4" >g_nPostPinPromptIndex</parameter>
            <parameter type="inout" var-type="string" >g_strPostPinPromptUrl</parameter>
            <parameter type="inout" var-type="i4" >g_nServiceId</parameter>
            <parameter type="inout" var-type="string" >g_strModeratorRequiredFlag</parameter>
            <parameter type="inout" var-type="string" >g_strBillingCodeFlag</parameter>
            <parameter type="inout" var-type="string" >g_strRecordNamesFlag</parameter>
            <parameter type="inout" var-type="i4" >g_nArriveDepartOption</parameter>
            <parameter type="inout" var-type="string" >g_strPinLanguage</parameter>
            <parameter type="inout" var-type="i4" >g_nBillingType</parameter>
            <parameter type="inout" var-type="float" >g_fPrepaidBalance</parameter>
            <parameter type="inout" var-type="i4" >g_nCurrencyId</parameter>
            <parameter type="inout" var-type="i8" >g_lSubscriberId</parameter>
            <parameter type="inout" var-type="string" >g_strExistingCallLegId</parameter>
            <parameter type="inout" var-type="string" >g_strExistingSessionId</parameter>
            <parameter type="inout" var-type="string" >g_strHoldBillingFlag</parameter>
            <parameter type="inout" var-type="i4" >g_iRoundSeconds</parameter>
            <parameter type="inout" var-type="string" >g_strRechargeFlag</parameter>
            <parameter type="inout" var-type="i4" >g_iSubExpirationType</parameter>
            <parameter type="inout" var-type="i4" >g_iOfferingId</parameter>
            <parameter type="inout" var-type="string" >g_strSubscriberAccount</parameter>
            <parameter type="inout" var-type="string" >g_strPlayPartyCountFlag</parameter>
            <parameter type="inout" var-type="i4" >g_nCurrentNbrCallegs</parameter>
            <parameter type="inout" var-type="string" >g_strIsSubscriberFlag</parameter>
            <parameter type="inout" var-type="i4" >g_nPayphoneSrchgRateId</parameter>
            <parameter type="inout" var-type="float" >g_fPayphoneSrchgRateAmt</parameter>
            <parameter type="inout" var-type="i4" >g_nAccessNumberRateId</parameter>
            <parameter type="inout" var-type="float" >g_fAccessNumberRateAmt</parameter>
            <parameter type="inout" var-type="i4" >g_nAccessNumberRateType</parameter>
            <parameter type="inout" var-type="i4" >g_nMeteredRate1Id</parameter>
            <parameter type="inout" var-type="float" >g_fMeteredRate1Amt</parameter>
            <parameter type="inout" var-type="i4" >g_nMeteredRate2Id</parameter>
            <parameter type="inout" var-type="float" >g_fMeteredRate2Amt</parameter>
            <parameter type="inout" var-type="i4" >g_nFixedRate1Id</parameter>
            <parameter type="inout" var-type="float" >g_fFixedRate1Amt</parameter>
            <parameter type="inout" var-type="i4" >g_nFixedRate2Id</parameter>
            <parameter type="inout" var-type="float" >g_fFixedRate2Amt</parameter>
            <parameter type="inout" var-type="float" >g_fTotalMeteredRate</parameter>
            <parameter type="inout" var-type="float" >g_fTotalFixedRate</parameter>
            <parameter type="inout" var-type="string" >g_strConfSessionId</parameter>
            <parameter type="inout" var-type="string" >g_strPromptOnOutdialFlag</parameter>
            <parameter type="inout" var-type="string" >g_strAutoRecordFlag</parameter>
            <parameter type="inout" var-type="string" >g_strConfRecordAllowed</parameter>
            <parameter type="inout" var-type="string" >g_strHomeCallingCode</parameter>
            <parameter type="inout" var-type="i4" >g_nHomeCountryId</parameter>
            <parameter type="inout" var-type="string" >g_strOutdialCLI</parameter>
            <parameter type="inout" var-type="i4" >g_nAnonymousAttendeeId</parameter>
            <parameter type="inout" var-type="i4" >g_nOperatorAssistType</parameter>
            <parameter type="inout" var-type="string" >g_strQuickStartFlag</parameter>
            <parameter type="inout" var-type="string" >g_strMSResourceName</parameter>
            <parameter type="inout" var-type="string" >g_strAlternateSiteIP</parameter>
            <parameter type="inout" var-type="i4" >g_nAlternateSitePort</parameter>
            <parameter type="inout" var-type="string" >g_strConfSiteMovedFlag</parameter>
            <parameter type="inout" var-type="string" >g_strCCIPMovedFrom</parameter>
            <parameter type="inout" var-type="i4" >g_nCCPortMovedFrom</parameter>
            <parameter type="inout" var-type="string" >g_strCCIPMovedTo</parameter>
            <parameter type="inout" var-type="i4" >g_nCCPortMovedTo</parameter>
            <parameter type="inout" var-type="i4" >g_nMinutesTooEarly</parameter>
            <parameter type="inout" var-type="i4" >g_nOutdialOption</parameter>
            <parameter type="inout" var-type="string" >g_strMutedPartyPassCode</parameter>
            <parameter type="inout" var-type="string" >g_strReservationlessFlag</parameter>
            <parameter type="inout" var-type="i8" >g_lPartySchedId</parameter>
            <parameter type="inout" var-type="string" >g_strPartyDetail</parameter>
            <parameter type="inout" var-type="i4" >strUnUsedDefaultAudioMode</parameter>
            <parameter type="inout" var-type="string" >g_strPlayFirstCaller</parameter>
            <parameter type="inout" var-type="i4" >g_nPasscodeScheme</parameter>
            <parameter type="inout" var-type="i4" >g_nCurrNbrMods</parameter>
            <parameter type="inout" var-type="string" >g_strGlobalMusicOnFlag</parameter>
            <parameter type="inout" var-type="string" >g_strSelfMuteUnmuteFlagOn</parameter>
          </java>
          <results >
            <result name="Default" link="5" stubbed="0"/>
            <result name="Success" link="8" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strSIPStatus = Session.g_strSIPStatus.toString();

Server.logInfo("INFO: ********** JAVA CALLING AuthConfPasscode *********");

Server.logInfo("INFO: BEFORE pass code = " + Session.g_strPassCode);

Server.logInfo("INFO: BEFORE access number = " + Session.g_strAccessNumber);

Server.logInfo("INFO: BEFORE sched duration = " + Session.g_nScheduleDuration);

Server.logInfo("INFO: BEFORE sched start time = " + Session.g_strScheduleStartTime);

Server.logInfo("INFO: BEFORE time available = " + Session.g_lTimeAvailable);

Server.logInfo("INFO: BEFORE sched Id = " + Session.g_strConfScheduleId);

Server.logInfo("INFO: BEFORE call leg Id = " + Session.g_strCallLegId);

Server.logInfo("INFO: BEFORE DB name = " + Session.g_strDBNAME);

Server.logInfo("INFO: BEFORE access number Id = " + Session.g_nAccessNumberId);

Server.logInfo("INFO: BEFORE conf resource = " + Session.g_strConfResource);

Server.logInfo("INFO: BEFORE conf event Id = " + Session.g_strConfEventId);]]></script>
            <script language="javascript" timing="last" ><![CDATA[Server.logInfo("INFO: ********** iJavaReturnCode " + Session.f_nReturnCode);

if (Result.id == 2)

{

	switch (Session.f_nReturnCode)

	{

		case -99:

		case -98:

		case -50:

			Session.g_nErrorMsgNumber = 1001; //db error

			break;

		case -1:

			//Session.g_nErrorMsgNumber = 1010; //invalid passcode

			Server.logError("ERROR: INVALID PASSCODE, AND THE PASSCODE IS: " + Session.g_strPassCode);

			Session.g_nNbrPassCodeRetries++;

			break;

		case -2:

			Session.g_nErrorMsgNumber = 4002; //too early

			break;

		case -3:

			Session.g_nErrorMsgNumber = 4003; //too late

			break;

		case -4:

			Session.g_nErrorMsgNumber = 1005; //disable subscriber

			break;

		case -5:

			Session.g_nErrorMsgNumber = 4004; //max attendees

			break;

		case -6:

			//Session.g_nErrorMsgNumber = 4005; //locked conf

			break;

		case -7:

			Session.g_nErrorMsgNumber = 4006; //terminated conf

			break;

		case -8:

			//Session.g_nErrorMsgNumber = 4007; //passcode in used

			break;

		case -10:

			Session.g_nErrorMsgNumber = 4008; //no conf controller

			break;

		case -12:

			Session.g_nErrorMsgNumber = 1006; //disable corp acct

			break;

		case -13:

			Session.g_nErrorMsgNumber = 4009; //disabled conf

			break;

		case -14:

			Session.g_nTerminationReason = 26; //wrong day

			break;

		case -15:

			Session.g_nErrorMsgNumber = 2000; //insufficient balance

			break;

		case -16:

			Session.g_nErrorMsgNumber = 4013; //conf pin locked

			break;

		case -17:

			Session.g_nErrorMsgNumber = 0; //conf no rate

			break;

		case -18:

			Session.g_nErrorMsgNumber = 0; //conf cancelled

			Session.g_nTerminationReason = 25;

			break;

		case -19:

			Session.g_nErrorMsgNumber = 1021; //conf invalid access number

			Session.g_nTerminationReason = 28;

			break;

		case -20:

			Session.g_nErrorMsgNumber = 4016; //conf invalid subscriber access number

			Session.g_nTerminationReason = 28;

			break;

		case -21:

			//wrong site, must be redirect from gateway

			Server.logInfo("WARNING: WRONG SITE FOR THIS PASSCODE");

			Session.g_bWrongSiteHangOff = true;

			Session.g_nRedirectStatus = 1;

			break;

		case -22:

			Session.g_nErrorMsgNumber = 4018; //insufficient ms resource

			Session.g_nTerminationReason = 30;

			break;
		
		default:

			Session.g_nErrorMsgNumber = 0;

			break;

	}

}

else

{

	Server.logError("ERROR: FAIL TO VALIDATE PASSCODE, EXIT ON: " + Result.name);

	Session.g_nErrorMsgNumber = 1000; //jvm server error

}

if (Session.f_strConfControllerIP.length > 0 && Session.f_nConfControllerPort > 0)

{

	Session.g_strConfControllerIP = Session.f_strConfControllerIP;

	Session.g_nConfControllerPort = Session.f_nConfControllerPort;

}]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=884 y=111 ?>
          <!--FAILURE-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nFailure"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="3" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=916 y=351 ?>
          <!--return code from java

hard code time avail-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nReturnCode"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (Session.g_strMuteFlag == "T")
{
	Session.g_oMS.bMuteFlag = true;
	Session.g_bMutedState = true;
	Session.g_bMutedByMod = true;
	Session.g_nPromptSelfMuteUnMute = 908;
}
else
{
	Session.g_oMS.bMuteFlag = false;
}

if (Session.f_nReturnCode == Session.s_nFirstCaller || 3 == Session.f_nReturnCode)
{
	Session.g_strSetStateToGetConfRes = "T";
	Session.g_bFirstCaller = true;
}
else
{
	Session.g_bFirstCaller = false;
}
if (3 == Session.f_nReturnCode)
{
	Session.g_bNoCreateConfFirstCaller = true;
	Server.logInfo("First caller, but no need to create conference");
}
else
{
	Session.g_bNoCreateConfFirstCaller = false;
}
Server.logInfo("Pin level language " + Session.g_strPinLanguage);
if (Session.s_strIgnorePinLanguage == "F" && Session.g_strPinLanguage.length > 0){
 Session.g_strLanguage = Session.g_strPinLanguage;
}else{
    Server.logInfo("ignoring pin level language, continue with access number language");
}
if (Session.g_strHomeCallingCode.length <= 0)
{
	Server.logInfo("WARNING: SUBSCRIBER HOME COUNTRY IS BLANK: " + Session.g_strHomeCallingCode);
	Server.logInfo("WARNING: USE DEFAULT HOME COUNTRY: " + Session.s_strDefaultCountryCode);
	Session.g_strHomeCallingCode = Session.s_strDefaultCountryCode;

}

if (Session.g_strOutdialCLI.length > 0)
{
	Session.g_strOutdialCLI = "+" + Session.g_strOutdialCLI;
	Session.g_strOrigNbr = Session.g_strOutdialCLI;
}

Session.g_strAnonymousAttendeeId = new String(Session.g_nAnonymousAttendeeId);
Server.logInfo("RECORD NAME FLAG IS: " + Session.g_strRecordNamesFlag);
Server.logInfo("MS BLADE NAME IS: " + Session.g_strMSResourceName);

// if (Session.g_strPartyPasscodeFlag == "T" && Session.g_strMuteFlag == "T")
if (0 == Clib.strcmpi(Session.g_strPassCode, Session.g_strMutedPartyPassCode))
{

	Server.logInfo("MUTED PARTY PASSCODE");
	Session.g_oMS.bMuteFlag = true;
	Session.g_bMutedState = true;
	Session.g_nPromptSelfMuteUnMute = 908;
	Session.g_strMuteFlag = "T"
}
if ("T" == Session.g_strReservationlessFlag)
	Session.g_bReservationlessConf = true;
else
	Session.g_bReservationlessConf = false;
	
Session.g_lCSRRequestOfferingId = Session.g_iOfferingId;
if ("T" == Session.g_strSelfMuteUnmuteFlagOn)
	Session.g_bAllowSelfMuteUnmuteFlag = true;
else
	Session.g_bAllowSelfMuteUnmuteFlag = false;]]></script>
          </scripts>
        </action>
        <action id="4" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=899 y=225 ?>
          <!--send ALARM-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="" transaction="" message-name="s_strSendAlarmRequest" destination-port="" destination-type="1" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;calling_number&quot;" value="g_strAlarmType"/>
            <parameter tag="&quot;called_number&quot;" value="g_strAlarmPriority"/>
          </SOAP>
          <results >
            <result name="Default" link="2" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strAlarmType = "JAVA: validatePassCode";

Session.g_strAlarmPriority = "MAJOR";]]></script>
          </scripts>
        </action>
        <action id="5" plug-in="Pactolus.Branch.1" ><?xtml-editor x=671 y=123 ?>
          <!--s_strSendAlarmFlag==T-->
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="s_strSendAlarmFlag==T" link="4" stubbed="0" >s_strSendAlarmFlag match "T"</result>
          </results>
        </action>
        <action id="7" plug-in="Pactolus.JavaStaticMethod.1" ><?xtml-editor x=438 y=530 ?>
          <!--validatePassCode()-->
          <java xmlns="urn:www.pactolus.com:xtml:application" class="&quot;com.pactolus.conferencing.psAPISceAuthConfPasscodeB&quot;" method="&quot;validateConfPassCode&quot;" timeout="90" return="" method-return-var="f_nReturnCode" method-return-type="0" >
            <parameter type="in" var-type="string" >g_strDBNAME</parameter>
            <parameter type="in" var-type="string" >g_strSessionId</parameter>
            <parameter type="in" var-type="string" >s_strApplicationName</parameter>
            <parameter type="in" var-type="string" >g_strPassCode</parameter>
            <parameter type="in" var-type="string" >g_strStrippedOrigNbr</parameter>
            <parameter type="in" var-type="string" >g_strOutdialDestNbr</parameter>
            <parameter type="in" var-type="i4" >g_nAccessNumberId</parameter>
            <parameter type="in" var-type="i8" >g_lServiceProviderId</parameter>
            <parameter type="in" var-type="string" >g_strRetryFlag</parameter>
            <parameter type="in" var-type="string" >g_strSoapAddress</parameter>
            <parameter type="in" var-type="i4" >g_nSoapPort</parameter>
            <parameter type="in" var-type="i4" >g_nMaxRetryAllowed</parameter>
            <parameter type="in" var-type="i4" >g_nNbrPassCodeRetries</parameter>
            <parameter type="in" var-type="string" >g_strOrigDomIntlFlag</parameter>
            <parameter type="in" var-type="i4" >g_nOrigCountryId</parameter>
            <parameter type="in" var-type="string" >g_strInfoDigits</parameter>
            <parameter type="in" var-type="string" >g_oCallLegA.strFrom</parameter>
            <parameter type="in" var-type="string" >g_oCallLegA.strTo</parameter>
            <parameter type="in" var-type="string" >g_oCallLegA.strCallId</parameter>
            <parameter type="in" var-type="string" >g_strSIPStatus</parameter>
            <parameter type="in" var-type="i8" >g_lStartTime</parameter>
            <parameter type="in" var-type="string" >g_strGWIPIngress</parameter>
            <parameter type="in" var-type="i4" >g_nGWPortIngress</parameter>
            <parameter type="in" var-type="string" >g_strGWIPEgress</parameter>
            <parameter type="in" var-type="i4" >g_nGWPortEgress</parameter>
            <parameter type="in" var-type="i4" >g_nRtpEncoding</parameter>
            <parameter type="in" var-type="i4" >g_nRtpClockRate</parameter>
            <parameter type="in" var-type="i4" >g_nCallMode</parameter>
            <parameter type="in" var-type="string" >g_strOutdialFlag</parameter>
            <parameter type="in" var-type="string" >g_strOrigCallingCode</parameter>
            <parameter type="in" var-type="string" >g_strOrigAreaCode</parameter>
            <parameter type="in" var-type="string" >g_strDestDomIntlFlag</parameter>
            <parameter type="in" var-type="i4" >g_nDestCountryId</parameter>
            <parameter type="in" var-type="string" >g_strDestCallingCountryCode</parameter>
            <parameter type="in" var-type="string" >g_strDestAreaCode</parameter>
            <parameter type="in" var-type="string" >g_strSPTimeZone</parameter>
            <parameter type="in" var-type="string" >g_strModOutdialFlag</parameter>
            <parameter type="in" var-type="string" >g_strOperatorFlag</parameter>
            <parameter type="in" var-type="i4" >g_nDialPlanId</parameter>
            <parameter type="in" var-type="string" >g_strForceModeratorFlag</parameter>
            <parameter type="in" var-type="string" >g_strForceMuteFlag</parameter>
            <parameter type="in" var-type="string" >g_strUsedDefaultANIFlag</parameter>
            <parameter type="in" var-type="i4" >s_nSiteId</parameter>
            <parameter type="in" var-type="i4" >g_nRedirectStatus</parameter>
            <parameter type="in" var-type="i8" >g_lPartySchedId</parameter>
            <parameter type="in" var-type="string" >g_strModReAuthFlag</parameter>
            <parameter type="in" var-type="string" >strSubConfType</parameter>
            <parameter type="in" var-type="i4" >g_nReleaseToConfStatus</parameter>
            <parameter type="inout" var-type="i4" >g_nScheduleDuration</parameter>
            <parameter type="inout" var-type="string" >g_strScheduleStartTime</parameter>
            <parameter type="inout" var-type="i8" >g_lTimeAvailable</parameter>
            <parameter type="inout" var-type="string" >g_strConfScheduleId</parameter>
            <parameter type="inout" var-type="string" >g_strCallLegId</parameter>
            <parameter type="inout" var-type="string" >g_strConfResource</parameter>
            <parameter type="inout" var-type="string" >g_strConfEventId</parameter>
            <parameter type="inout" var-type="string" >g_strModeratorFlag</parameter>
            <parameter type="inout" var-type="string" >f_strConfControllerIP</parameter>
            <parameter type="inout" var-type="i4" >f_nConfControllerPort</parameter>
            <parameter type="inout" var-type="string" >g_strCallerFirstName</parameter>
            <parameter type="inout" var-type="string" >g_strCallerLastName</parameter>
            <parameter type="inout" var-type="string" >g_strCallerOrg</parameter>
            <parameter type="inout" var-type="string" >g_strPartyPasscodeFlag</parameter>
            <parameter type="inout" var-type="string" >g_strMuteFlag</parameter>
            <parameter type="inout" var-type="string" >g_strModeratorMutedFlag</parameter>
            <parameter type="inout" var-type="string" >g_strConfPassCode</parameter>
            <parameter type="inout" var-type="i4" >g_nMaxCallerHoldTime</parameter>
            <parameter type="inout" var-type="string" >g_strPostPinPromptType</parameter>
            <parameter type="inout" var-type="i4" >g_nPostPinPromptIndex</parameter>
            <parameter type="inout" var-type="string" >g_strPostPinPromptUrl</parameter>
            <parameter type="inout" var-type="i4" >g_nServiceId</parameter>
            <parameter type="inout" var-type="string" >g_strModeratorRequiredFlag</parameter>
            <parameter type="inout" var-type="string" >g_strBillingCodeFlag</parameter>
            <parameter type="inout" var-type="string" >g_strRecordNamesFlag</parameter>
            <parameter type="inout" var-type="i4" >g_nArriveDepartOption</parameter>
            <parameter type="inout" var-type="string" >g_strPinLanguage</parameter>
            <parameter type="inout" var-type="i4" >g_nBillingType</parameter>
            <parameter type="inout" var-type="float" >g_fPrepaidBalance</parameter>
            <parameter type="inout" var-type="i4" >g_nCurrencyId</parameter>
            <parameter type="inout" var-type="i8" >g_lSubscriberId</parameter>
            <parameter type="inout" var-type="string" >g_strExistingCallLegId</parameter>
            <parameter type="inout" var-type="string" >g_strExistingSessionId</parameter>
            <parameter type="inout" var-type="string" >g_strHoldBillingFlag</parameter>
            <parameter type="inout" var-type="i4" >g_iRoundSeconds</parameter>
            <parameter type="inout" var-type="string" >g_strRechargeFlag</parameter>
            <parameter type="inout" var-type="i4" >g_iSubExpirationType</parameter>
            <parameter type="inout" var-type="i4" >g_iOfferingId</parameter>
            <parameter type="inout" var-type="string" >g_strSubscriberAccount</parameter>
            <parameter type="inout" var-type="string" >g_strPlayPartyCountFlag</parameter>
            <parameter type="inout" var-type="i4" >g_nCurrentNbrCallegs</parameter>
            <parameter type="inout" var-type="string" >g_strIsSubscriberFlag</parameter>
            <parameter type="inout" var-type="i4" >g_nPayphoneSrchgRateId</parameter>
            <parameter type="inout" var-type="float" >g_fPayphoneSrchgRateAmt</parameter>
            <parameter type="inout" var-type="i4" >g_nAccessNumberRateId</parameter>
            <parameter type="inout" var-type="float" >g_fAccessNumberRateAmt</parameter>
            <parameter type="inout" var-type="i4" >g_nAccessNumberRateType</parameter>
            <parameter type="inout" var-type="i4" >g_nMeteredRate1Id</parameter>
            <parameter type="inout" var-type="float" >g_fMeteredRate1Amt</parameter>
            <parameter type="inout" var-type="i4" >g_nMeteredRate2Id</parameter>
            <parameter type="inout" var-type="float" >g_fMeteredRate2Amt</parameter>
            <parameter type="inout" var-type="i4" >g_nFixedRate1Id</parameter>
            <parameter type="inout" var-type="float" >g_fFixedRate1Amt</parameter>
            <parameter type="inout" var-type="i4" >g_nFixedRate2Id</parameter>
            <parameter type="inout" var-type="float" >g_fFixedRate2Amt</parameter>
            <parameter type="inout" var-type="float" >g_fTotalMeteredRate</parameter>
            <parameter type="inout" var-type="float" >g_fTotalFixedRate</parameter>
            <parameter type="inout" var-type="string" >g_strConfSessionId</parameter>
            <parameter type="inout" var-type="string" >g_strPromptOnOutdialFlag</parameter>
            <parameter type="inout" var-type="string" >g_strAutoRecordFlag</parameter>
            <parameter type="inout" var-type="string" >g_strConfRecordAllowed</parameter>
            <parameter type="inout" var-type="string" >g_strHomeCallingCode</parameter>
            <parameter type="inout" var-type="i4" >g_nHomeCountryId</parameter>
            <parameter type="inout" var-type="string" >g_strOutdialCLI</parameter>
            <parameter type="inout" var-type="i4" >g_nAnonymousAttendeeId</parameter>
            <parameter type="inout" var-type="i4" >g_nOperatorAssistType</parameter>
            <parameter type="inout" var-type="string" >g_strQuickStartFlag</parameter>
            <parameter type="inout" var-type="string" >g_strMSResourceName</parameter>
            <parameter type="inout" var-type="string" >g_strAlternateSiteIP</parameter>
            <parameter type="inout" var-type="i4" >g_nAlternateSitePort</parameter>
            <parameter type="inout" var-type="string" >g_strConfSiteMovedFlag</parameter>
            <parameter type="inout" var-type="string" >g_strCCIPMovedFrom</parameter>
            <parameter type="inout" var-type="i4" >g_nCCPortMovedFrom</parameter>
            <parameter type="inout" var-type="string" >g_strCCIPMovedTo</parameter>
            <parameter type="inout" var-type="i4" >g_nCCPortMovedTo</parameter>
            <parameter type="inout" var-type="i4" >g_nMinutesTooEarly</parameter>
            <parameter type="inout" var-type="i4" >g_nOutdialOption</parameter>
            <parameter type="inout" var-type="string" >g_strMutedPartyPassCode</parameter>
            <parameter type="inout" var-type="string" >g_strReservationlessFlag</parameter>
            <parameter type="inout" var-type="i8" >g_lPartySchedId</parameter>
            <parameter type="inout" var-type="string" >g_strPartyDetail</parameter>
            <parameter type="inout" var-type="i4" >strUnUsedDefaultAudioMode</parameter>
            <parameter type="inout" var-type="string" >g_strPlayFirstCaller</parameter>
            <parameter type="inout" var-type="i4" >g_nPasscodeScheme</parameter>
            <parameter type="inout" var-type="i4" >g_nCurrNbrMods</parameter>
            <parameter type="inout" var-type="string" >g_strGlobalMusicOnFlag</parameter>
            <parameter type="inout" var-type="string" >g_strSelfMuteUnmuteFlagOn</parameter>
          </java>
          <results >
            <result name="Default" link="5" stubbed="1"/>
            <result name="Success" link="8" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strSIPStatus = Session.g_strSIPStatus.toString();

Server.logInfo("INFO: ********** JAVA CALLING AuthConfPasscode *********");

Server.logInfo("INFO: BEFORE pass code = " + Session.g_strPassCode);

Server.logInfo("INFO: BEFORE access number = " + Session.g_strAccessNumber);

Server.logInfo("INFO: BEFORE sched duration = " + Session.g_nScheduleDuration);

Server.logInfo("INFO: BEFORE sched start time = " + Session.g_strScheduleStartTime);

Server.logInfo("INFO: BEFORE time available = " + Session.g_lTimeAvailable);

Server.logInfo("INFO: BEFORE sched Id = " + Session.g_strConfScheduleId);

Server.logInfo("INFO: BEFORE call leg Id = " + Session.g_strCallLegId);

Server.logInfo("INFO: BEFORE DB name = " + Session.g_strDBNAME);

Server.logInfo("INFO: BEFORE access number Id = " + Session.g_nAccessNumberId);

Server.logInfo("INFO: BEFORE conf resource = " + Session.g_strConfResource);

Server.logInfo("INFO: BEFORE conf event Id = " + Session.g_strConfEventId);]]></script>
            <script language="javascript" timing="last" ><![CDATA[Server.logInfo("INFO: ********** iJavaReturnCode " + Session.f_nReturnCode);

if (Result.id == 2)

{

	switch (Session.f_nReturnCode)

	{

		case -99:

		case -98:

		case -50:

			Session.g_nErrorMsgNumber = 1001; //db error

			break;

		case -1:

			//Session.g_nErrorMsgNumber = 1010; //invalid passcode

			Server.logError("ERROR: INVALID PASSCODE, AND THE PASSCODE IS: " + Session.g_strPassCode);

			Session.g_nNbrPassCodeRetries++;

			break;

		case -2:

			Session.g_nErrorMsgNumber = 4002; //too early

			break;

		case -3:

			Session.g_nErrorMsgNumber = 4003; //too late

			break;

		case -4:

			Session.g_nErrorMsgNumber = 1005; //disable subscriber

			break;

		case -5:

			Session.g_nErrorMsgNumber = 4004; //max attendees

			break;

		case -6:

			//Session.g_nErrorMsgNumber = 4005; //locked conf

			break;

		case -7:

			Session.g_nErrorMsgNumber = 4006; //terminated conf

			break;

		case -8:

			//Session.g_nErrorMsgNumber = 4007; //passcode in used

			break;

		case -10:

			Session.g_nErrorMsgNumber = 4008; //no conf controller

			break;

		case -12:

			Session.g_nErrorMsgNumber = 1006; //disable corp acct

			break;

		case -13:

			Session.g_nErrorMsgNumber = 4009; //disabled conf

			break;

		case -14:

			Session.g_nTerminationReason = 26; //wrong day

			break;

		case -15:

			Session.g_nErrorMsgNumber = 2000; //insufficient balance

			break;

		case -16:

			Session.g_nErrorMsgNumber = 4013; //conf pin locked

			break;

		case -17:

			Session.g_nErrorMsgNumber = 0; //conf no rate

			break;

		case -18:

			Session.g_nErrorMsgNumber = 0; //conf cancelled

			Session.g_nTerminationReason = 25;

			break;

		case -19:

			Session.g_nErrorMsgNumber = 1021; //conf invalid access number

			Session.g_nTerminationReason = 28;

			break;

		case -20:

			Session.g_nErrorMsgNumber = 4016; //conf invalid subscriber access number

			Session.g_nTerminationReason = 28;

			break;

		case -21:

			//wrong site, must be redirect from gateway

			Server.logInfo("WARNING: WRONG SITE FOR THIS PASSCODE");

			Session.g_bWrongSiteHangOff = true;

			Session.g_nRedirectStatus = 1;

			break;
			
		case -22:
		
			Session.g_nErrorMsgNumber = 4018; //insufficient ms resource

			Session.g_nTerminationReason = 30;

			break;

		default:

			Session.g_nErrorMsgNumber = 0;

			break;

	}

}

else

{

	Server.logError("ERROR: FAIL TO VALIDATE PASSCODE, EXIT ON: " + Result.name);

	Session.g_nErrorMsgNumber = 1000; //jvm server error

}

if (Session.f_strConfControllerIP.length > 0 && Session.f_nConfControllerPort > 0)

{

	Session.g_strConfControllerIP = Session.f_strConfControllerIP;

	Session.g_nConfControllerPort = Session.f_nConfControllerPort;

}]]></script>
          </scripts>
        </action>
        <action id="8" plug-in="Pactolus.Branch.1" ><?xtml-editor x=685 y=363 ?>
          <!--ConfSiteMoved?-->
          <results >
            <result name="Default" link="3" stubbed="0"/>
            <result name="g_strConfSiteMovedFlag==T" link="9" stubbed="0" >g_strConfSiteMovedFlag match "T"

AND f_bValidInfo == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if ("T" == Session.g_strConfSiteMovedFlag)

{

	if (Session.g_strCCIPMovedFrom.length <= 0 || Session.g_strCCIPMovedTo.length <= 0 || Session.g_nCCPortMovedFrom <= 0 || Session.g_nCCPortMovedTo <= 0)

	{
	/*
		Server.logError("ERROR: CONF SITE MOVED BUT INVALID IP OR PORT");

		Server.logError("ERROR: MOVE FROM IP: " + Session.g_strCCIPMovedFrom);

		Server.logError("ERROR: MOVE FROM PORT: " + Session.g_nCCPortMovedFrom);

		Server.logError("ERROR: MOVE TO IP: " + Session.g_strCCIPMovedTo);

		Server.logError("ERROR: MOVE TO PORT: " + Session.g_nCCPortMovedTo);
	*/
		Session.f_bValidInfo = false;

	}

	else

	{

		Session.f_bValidInfo = true;

	}

}]]></script>
          </scripts>
        </action>
        <action id="9" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=924 y=461 ?>
          <!--"ConfSiteMoved"-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strCCIPMovedFrom" transaction="s_strZeroTransactionId" message-name="&quot;ConfSiteMovedRequest&quot;" destination-port="g_nCCPortMovedFrom" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;ConferenceId&quot;" value="g_strConfScheduleId"/>
            <parameter tag="&quot;MovedToThisSiteId&quot;" value="s_nSiteId"/>
            <parameter tag="&quot;MovedToIP&quot;" value="g_strCCIPMovedTo"/>
            <parameter tag="&quot;MovedToPort&quot;" value="g_nCCPortMovedTo"/>
          </SOAP>
          <results >
            <result name="Default" link="3" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)

{

	Server.logError("ERROR: FAIL TO SEND CONF SITE CHANGED TO CC");

	Server.logError("ERROR: CONF CONTROLLER IP: " + Session.f_strConfControllerIP);

	Server.logError("ERROR: CONF CONTROLLER PORT: " + Session.f_nConfControllerPort);

}]]></script>
          </scripts>
        </action>
        <action id="10" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=693 y=486 ?>
          <!--"psAPISceGetBackupSite"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceGetBackupSite&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="9" stubbed="1"/>
          </results>
        </action>
      </actions>
      <text-objects >
        <text-object x-coord="442" y-coord="673" width="204" height="74" text="Evt Conf Call

From: Blank String

To: Dest nbr" font-name="Times New Roman" size="-16" red="0" green="0" blue="0" weight="0" underline="0" strikeout="0" point-size="12" italic="0"/>
        <text-object x-coord="417" y-coord="140" width="151" height="70" text="Evt Conf Call

From: Orig Nbr

To: Blank String" font-name="Times New Roman" size="-16" red="0" green="0" blue="0" weight="0" underline="0" strikeout="0" point-size="12" italic="0"/>
        <text-object x-coord="750" y-coord="681" width="412" height="108" text="g_nOperatorAssistType:

0.  check acd settings from access number

1.  moderator able to request csr regardless of access number

2.  either moderator or participant able to request csr regardless

3.  NOT able to request csr regardless" font-name="Times New Roman" size="-16" red="0" green="0" blue="0" weight="0" underline="0" strikeout="0" point-size="12" italic="0"/>
        <text-object x-coord="925" y-coord="565" width="128" height="59" text="Already move,
move conf to this site id
" font-name="Times New Roman" size="-16" red="0" green="0" blue="0" weight="0" underline="0" strikeout="0" point-size="12" italic="0"/>
        <text-object x-coord="87" y-coord="49" width="232" height="74" text="use default audio mode from initializeSession, not this one here" font-name="Times New Roman" size="-16" red="0" green="0" blue="0" weight="0" underline="0" strikeout="0" point-size="12" italic="0"/>
      </text-objects>
    </function>
    <function name="SetTimer" start="1" event="SetTimer" returns="void" >
      <actions >
        <action id="1" plug-in="Standard.Timer.1" ><?xtml-editor x=86 y=81 ?>
          <!--SET TIMER-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lTimerId" duration="g_lTimeAvailable"/>
          <results >
            <result name="Default" link="2" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: SetTimer");]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=339 y=82 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bTimerSet = true;]]></script>
          </scripts>
        </action>
      </actions>
    </function>
    <function name="StopTimer" start="1" event="StopTimer" returns="void" >
      <actions >
        <action id="1" plug-in="Pactolus.Branch.1" ><?xtml-editor x=140 y=141 ?>
          <!--WFM timer started?-->
          <results >
            <result name="Default" link="11" stubbed="1"/>
            <result name="timer set == true" link="2" stubbed="0" >g_bTimerSet == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: StopTimer");]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.Timer.1" ><?xtml-editor x=386 y=149 ?>
          <!--stop WFM timer-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="0" id="g_lWFMTimerId" duration=""/>
          <results >
            <result name="Default" link="11" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bTimerSet = false;]]></script>
          </scripts>
        </action>
        <action id="5" plug-in="Pactolus.Branch.1" ><?xtml-editor x=135 y=326 ?>
          <!--timer started?-->
          <results >
            <result name="Default" link="15" stubbed="1"/>
            <result name="hold timer set == true" link="7" stubbed="0" >g_bHoldTimerFlag == true</result>
          </results>
        </action>
        <action id="7" plug-in="Standard.Timer.1" ><?xtml-editor x=379 y=326 ?>
          <!--stop Hold timer-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="0" id="g_lHoldTimerId" duration=""/>
          <results >
            <result name="Default" link="15" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bHoldTimerFlag = false;]]></script>
          </scripts>
        </action>
        <action id="11" plug-in="Pactolus.Branch.1" ><?xtml-editor x=660 y=138 ?>
          <!--Wait for CSR timer started?-->
          <results >
            <result name="Default" link="5" stubbed="1"/>
            <result name="WCSR timer set == true" link="12" stubbed="0" >g_bWaitCSRTimerSet == true</result>
          </results>
        </action>
        <action id="12" plug-in="Standard.Timer.1" ><?xtml-editor x=891 y=197 ?>
          <!--stop WCSR timer-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="0" id="g_lWaitCSRTimerId" duration=""/>
          <results >
            <result name="Default" link="5" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bWaitCSRTimerSet = false;]]></script>
          </scripts>
        </action>
        <action id="15" plug-in="Pactolus.Branch.1" ><?xtml-editor x=618 y=320 ?>
          <!--beep beep timer started?-->
          <results >
            <result name="Default" link="18" stubbed="1"/>
            <result name="beep beep timer set == true" link="16" stubbed="0" >g_bBeepBeepTimerFlag == true</result>
          </results>
        </action>
        <action id="16" plug-in="Standard.Timer.1" ><?xtml-editor x=903 y=379 ?>
          <!--stop beep beep timer-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="0" id="g_lBeepBeepTimerId" duration=""/>
          <results >
            <result name="Default" link="18" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bBeepBeepTimerFlag = false;]]></script>
          </scripts>
        </action>
        <action id="17" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=886 y=762 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
        </action>
        <action id="18" plug-in="Pactolus.Branch.1" ><?xtml-editor x=152 y=528 ?>
          <!--connect to MOH started?-->
          <results >
            <result name="Default" link="21" stubbed="1"/>
            <result name="MOH timer flag == true" link="19" stubbed="0" >g_bMOHTimerFlag == true</result>
          </results>
        </action>
        <action id="19" plug-in="Standard.Timer.1" ><?xtml-editor x=407 y=529 ?>
          <!--stop connect to MOH-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="0" id="g_lMOHTimerId" duration=""/>
          <results >
            <result name="Default" link="21" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bMOHTimerFlag = false;]]></script>
          </scripts>
        </action>
        <action id="20" plug-in="Standard.Timer.1" ><?xtml-editor x=889 y=588 ?>
          <!--stop timer to check heartbeat with ACD controller-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="0" id="g_lHeartbeatRequestTimerId" duration=""/>
          <results >
            <result name="Default" link="22" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bHeartbeatTimerFlag = false;]]></script>
          </scripts>
        </action>
        <action id="21" plug-in="Pactolus.Branch.1" ><?xtml-editor x=641 y=529 ?>
          <!--ACD heart beat?-->
          <results >
            <result name="Default" link="22" stubbed="1"/>
            <result name="heartbeat timer flag == true?" link="20" stubbed="0" >g_bHeartbeatTimerFlag == true</result>
          </results>
        </action>
        <action id="22" plug-in="Pactolus.Branch.1" ><?xtml-editor x=161 y=799 ?>
          <!--check for reInviteA timer started?-->
          <results >
            <result name="Default" link="23" stubbed="1"/>
            <result name="g_bCkReInviteA" link="25" stubbed="0" >g_bCkReInviteTimerFlagA == true</result>
          </results>
        </action>
        <action id="23" plug-in="Pactolus.Branch.1" ><?xtml-editor x=620 y=794 ?>
          <!--check for reInviteB timer started?-->
          <results >
            <result name="Default" link="17" stubbed="0"/>
            <result name="g_bCkReInviteB" link="24" stubbed="0" >g_bCkReInviteTimerFlagB == true</result>
          </results>
        </action>
        <action id="24" plug-in="Standard.Timer.1" ><?xtml-editor x=902 y=917 ?>
          <!--stop ck reInvite timer B-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="0" id="g_lCkReInviteTimerIdB" duration=""/>
          <results >
            <result name="Default" link="17" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[Session.g_bCkReInviteTimerFlagB = false;]]></script>
          </scripts>
        </action>
        <action id="25" plug-in="Standard.Timer.1" ><?xtml-editor x=396 y=799 ?>
          <!--stop ck reInvite timerA-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="0" id="g_lCkReInviteTimerIdA" duration=""/>
          <results >
            <result name="Default" link="23" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[Session.g_bCkReInviteTimerFlagA = false;]]></script>
          </scripts>
        </action>
      </actions>
    </function>
    <function name="psAPISceSetConfResource" start="3" event="psAPISceSetConfResource" returns="i4" >
      <local-vars >
        <var name="f_nReturnCode" type="i4" >-50</var>
        <var name="strEmptyString" type="string" ></var>
      </local-vars>
      <actions >
        <action id="3" plug-in="Pactolus.JavaStaticMethod.1" ><?xtml-editor x=331 y=191 ?>
          <!--SetConfResource()-->
          <java xmlns="urn:www.pactolus.com:xtml:application" class="&quot;com.pactolus.conferencing.psAPISceSetConfResource&quot;" method="&quot;setConfResource&quot;" timeout="s_nTimeout" return="" method-return-var="f_nReturnCode" method-return-type="0" >
            <parameter type="in" var-type="string" >g_strDBNAME</parameter>
            <parameter type="in" var-type="string" >g_strSessionId</parameter>
            <parameter type="in" var-type="string" >g_strConfEventId</parameter>
            <parameter type="in" var-type="string" >g_oMS.strConferenceId</parameter>
            <parameter type="in" var-type="string" >strEmptyString</parameter>
            <parameter type="in" var-type="string" >strEmptyString</parameter>
            <parameter type="in" var-type="string" >strEmptyString</parameter>
            <parameter type="in" var-type="string" >strEmptyString</parameter>
            <parameter type="in" var-type="string" >strEmptyString</parameter>
            <parameter type="in" var-type="string" >strEmptyString</parameter>
            <parameter type="in" var-type="string" >g_strMSResourceName</parameter>
          </java>
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="Success" link="1" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: psAPISceSetConfResource");
Server.logInfo("INFO: *********JAVA CALLING SetConfResource *********");

Server.logInfo("INFO: BEFORE sched Id = " + Session.g_strConfScheduleId);

Server.logInfo("INFO: BEFORE conf resource = " + Session.g_oMS.strConferenceId);

Server.logInfo("INFO: BEFORE MS resource name = " + Session.g_strMSResourceName);

Server.logInfo("INFO: BEFORE DB name = " + Session.g_strDBNAME);

if (Session.g_strMSResourceName.length <= 1)

{

	Server.logInfo("NO MS RESOURCE NAME, MUST SET IT");

	var myString = new String(Session.g_oMS.strConferenceId);

	var myArray = myString.split("@");

	Session.g_strMSResourceName = myArray[1];

	Server.logInfo("MS RESOURCE NAME IS: " + Session.g_strMSResourceName);

}]]></script>
            <script language="javascript" timing="last" ><![CDATA[Server.logInfo("INFO: ********* SetConfResource returns " + Session.f_nReturnCode);

if (0 == Session.f_nReturnCode)

{

	Session.g_strSetStateToGetConfRes = "F";

	//reset this flag because it is set if first caller at autheticate passcode

}

if (Result.id == 2)

{

	Server.logInfo("INFO: SUCCESS CALL SET CONF RESOURCE.");

	if (-99 == Session.f_nReturnCode)
	{
		Session.g_nErrorMsgNumber = 1001; //db error
		Session.g_nTerminationReason = 39;
	}
	else if (-2 == Session.f_nReturnCode)
	{
		Session.g_nErrorMsgNumber = 4011; //conf not found
		Session.g_nTerminationReason = 39;
	}
	else

		Session.g_nErrorMsgNumber = 0;

}

else

{

	Server.logError("ERROR: FAIL TO CALL SET CONF RESOURCE, EXIT ON: " + Result.name);

	Session.g_nTerminationReason = 39;

	Session.g_nErrorMsgNumber = 1000; //jvm server error

}]]></script>
          </scripts>
        </action>
        <action id="1" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=633 y=294 ?>
          <!--return JAVA_SUCCESS-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nReturnCode"/>
        </action>
        <action id="2" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=616 y=155 ?>
          <!--return FAILED_JAVA-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nFailure"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logError("ERROR: FAIL TO SET CONFERENCE RESOURCE");]]></script>
          </scripts>
        </action>
      </actions>
    </function>
    <function name="OnSessionEnd" start="11" event="OnSessionEnd" returns="void" >
      <parameters >
        <parameter name="nSessionEndReason" type="i2"/>
      </parameters>
      <local-vars >
        <var name="f_nReturnCode" type="i4" >-1</var>
        <var name="bNullString" type="boolean" >0</var>
      </local-vars>
      <actions >
        <action id="11" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=57 y=94 ?>
          <!--stop timer if needed-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;StopTimer&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="31" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: OnSessionEnd");
js_disable_event();]]></script>
          </scripts>
        </action>
        <action id="3" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1337 y=1121 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="4" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=486 y=885 ?>
          <!--ConfCallLegCompletion-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceConfCallLegCompletion&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="10" stubbed="0"/>
          </results>
        </action>
        <action id="5" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=653 y=1134 ?>
          <!--DeleteMSConnection-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DeleteMSConnection&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="17" stubbed="0"/>
          </results>
        </action>
        <action id="6" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=208 y=1177 ?>
          <!--Remove member from temp conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;RemoveMemberFromConference&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
          </function>
          <results >
            <result name="Default" link="16" stubbed="0"/>
          </results>
        </action>
        <action id="7" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=671 y=1261 ?>
          <!--delete temp conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DeleteConference&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
          </function>
          <results >
            <result name="Default" link="5" stubbed="1"/>
          </results>
        </action>
        <action id="9" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1199 y=864 ?>
          <!--delete conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DeleteConference&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="22" stubbed="0"/>
          </results>
        </action>
        <action id="10" plug-in="Pactolus.Branch.1" ><?xtml-editor x=735 y=886 ?>
          <!--last caller?-->
          <results >
            <result name="Default" link="6" stubbed="1"/>
            <result name="f_nReturnCode==1" link="41" stubbed="0" >f_nReturnCode == 1</result>
            <result name="g_bConnectToMOH==true" link="39" stubbed="0" >g_bConnectToMOH == true</result>
          </results>
        </action>
        <action id="14" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1201 y=991 ?>
          <!--"SendDisconnectToMOH"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;SendDisconnectToMOH&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="6" stubbed="0"/>
          </results>
        </action>
        <action id="16" plug-in="Pactolus.Branch.1" ><?xtml-editor x=451 y=1177 ?>
          <!--you created temp conf?-->
          <results >
            <result name="Default" link="5" stubbed="0"/>
            <result name="g_bCreatedTempConf==true" link="7" stubbed="0" >g_bCreatedTempConf == true</result>
          </results>
        </action>
        <action id="17" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=884 y=1129 ?>
          <!--DeleteMOHMSConnection-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DeleteMSConnection&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMOH_MS</parameter>
          </function>
          <results >
            <result name="Default" link="19" stubbed="0"/>
          </results>
        </action>
        <action id="18" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=224 y=887 ?>
          <!--Remove member from conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;RemoveMemberFromConference&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="4" stubbed="0"/>
          </results>
        </action>
        <action id="19" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1118 y=1123 ?>
          <!--MoveConf?-->
          <results >
            <result name="Default" link="3" stubbed="0"/>
            <result name="g_bNeedToMoveConf" link="21" stubbed="0" >g_bNeedToMoveConf == true</result>
          </results>
        </action>
        <action id="20" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1589 y=1240 ?>
          <!--"ConfSiteMoved"-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strCCIPMovedFrom" transaction="s_strZeroTransactionId" message-name="&quot;ConfSiteMovedRequest&quot;" destination-port="g_nCCPortMovedFrom" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;ConferenceId&quot;" value="g_strConfScheduleId"/>
            <parameter tag="&quot;MovedToThisSiteId&quot;" value="g_nAlternateSiteId"/>
            <parameter tag="&quot;MovedToIP&quot;" value="g_strCCIPMovedTo"/>
            <parameter tag="&quot;MovedToPort&quot;" value="g_nCCPortMovedTo"/>
          </SOAP>
          <results >
            <result name="Default" link="3" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)

{

	Server.logError("ERROR: FAIL TO SEND CONF SITE CHANGED TO CC");

	Server.logError("ERROR: CONF CONTROLLER IP: " + Session.g_strCCIPMovedFrom);

	Server.logError("ERROR: CONF CONTROLLER PORT: " + Session.g_nCCPortMovedFrom);

}]]></script>
          </scripts>
        </action>
        <action id="21" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1360 y=1251 ?>
          <!--"MoveConfToBackupSite"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceMoveConfToBackupSite&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="20" stubbed="0"/>
          </results>
        </action>
        <action id="22" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1420 y=856 ?>
          <!--last caller?-->
          <results >
            <result name="Default" link="6" stubbed="1"/>
            <result name="g_bConnectToMOH==true" link="39" stubbed="1" >g_bConnectToMOH == true</result>
          </results>
        </action>
        <action id="26" plug-in="Pactolus.Branch.1" ><?xtml-editor x=611 y=59 ?>
          <!--adding party?-->
          <results >
            <result name="Default" link="40" stubbed="1"/>
            <result name="adding party == true" link="27" stubbed="0" >g_bAddingParty == true</result>
          </results>
        </action>
        <action id="27" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=851 y=53 ?>
          <!--send IVRConfRemoveAddParty-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="" transaction="" message-name="s_strIvrConfRemovePartyRequest" destination-port="" destination-type="3" destination-session="g_strAddPartySessionId" waiting-session-selected="" xml-namespace=""/>
          <results >
            <result name="Default" link="40" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("SEND TO session Id is: " + Session.g_strAddPartySessionId);]]></script>
          </scripts>
        </action>
        <action id="28" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=853 y=183 ?>
          <!--"psAPISceEndRequest"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceEndRequest&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="40" stubbed="1"/>
          </results>
        </action>
        <action id="29" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=859 y=314 ?>
          <!--"psAPISceEndAssignment"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceEndAssignment&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="28" stubbed="1"/>
          </results>
        </action>
        <action id="30" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=624 y=187 ?>
          <!--s_strMSG_END_REQUEST_CSR-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strACDControllerIP" transaction="s_strZeroTransactionId" message-name="s_strMsgEndRequestCSR" destination-port="g_nACDControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;RequestId&quot;" value="g_lCSRRequestId"/>
            <parameter tag="&quot;AssignmentId&quot;" value="0"/>
          </SOAP>
          <results >
            <result name="Default" link="28" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[Session.g_bSentACDBeginRequest = false;]]></script>
          </scripts>
        </action>
        <action id="31" plug-in="Pactolus.Branch.1" ><?xtml-editor x=305 y=97 ?>
          <results >
            <result name="Default" link="26" stubbed="0"/>
            <result name="BeginRequest" link="30" stubbed="0" >(g_nCallerCurrentState == s_nStateBeginRequest
OR g_nCallerCurrentState == s_nStateRouteToCsr
OR g_nCallerCurrentState == s_nStateZeroOutToCsr)
AND bNullString == false</result>
            <result name="BeginAssignment" link="32" stubbed="0" >(g_nCallerCurrentState == s_nStateBeginAssignment
OR g_nCallerCurrentState == s_nStateCsrPutOnHold
OR g_nCallerCurrentState == s_nStateCsrPutOffHold)
AND bNullString == false</result>
            <result name="Requeue" link="33" stubbed="0" >g_nCallerCurrentState == s_nStateRequeue
AND bNullString == false</result>
            <result name="SentACDBeginRequest" link="38" stubbed="0" >g_bSentACDBeginRequest == true
AND bNullString == false</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (Session.g_strACDControllerIP.length <=0 || Session.g_nACDControllerPort <= 0)
{
	Session.bNullString = true;
}
else
{
	Session.bNullString = false;
}]]></script>
          </scripts>
        </action>
        <action id="32" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=624 y=319 ?>
          <!--s_strMSG_END_REQUEST_CSR-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strACDControllerIP" transaction="s_strZeroTransactionId" message-name="s_strMsgEndRequestCSR" destination-port="g_nACDControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;RequestId&quot;" value="g_lCSRRequestId"/>
            <parameter tag="&quot;AssignmentId&quot;" value="g_lCSRAssignmentId"/>
          </SOAP>
          <results >
            <result name="Default" link="29" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[Session.g_bSentACDBeginRequest = false;]]></script>
          </scripts>
        </action>
        <action id="33" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=618 y=469 ?>
          <!--s_strMSG_END_REQUEST_CSR-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strACDControllerIP" transaction="s_strZeroTransactionId" message-name="s_strMsgEndRequestCSR" destination-port="g_nACDControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;RequestId&quot;" value="g_lCSRRequestId"/>
            <parameter tag="&quot;AssignmentId&quot;" value="0"/>
          </SOAP>
          <results >
            <result name="Default" link="28" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[Session.g_bSentACDBeginRequest = false;]]></script>
          </scripts>
        </action>
        <action id="34" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1118 y=630 ?>
          <!--"psAPISceEndAssignment"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceEndAssignment&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="36" stubbed="0"/>
          </results>
        </action>
        <action id="35" plug-in="Pactolus.Branch.1" ><?xtml-editor x=856 y=628 ?>
          <!--sent APIBeginAssignment?-->
          <results >
            <result name="Default" link="36" stubbed="1"/>
            <result name="g_bSentAPIBeginAssignment" link="34" stubbed="0" >g_bSentAPIBeginAssignment == true</result>
          </results>
        </action>
        <action id="36" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1337 y=625 ?>
          <!--sent APIBeginRequest?-->
          <results >
            <result name="Default" link="40" stubbed="1"/>
            <result name="g_bSentAPIBeginRequest" link="37" stubbed="0" >g_bSentAPIBeginRequest == true</result>
          </results>
        </action>
        <action id="37" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1561 y=620 ?>
          <!--"psAPISceEndRequest"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceEndRequest&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="40" stubbed="1"/>
          </results>
        </action>
        <action id="38" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=607 y=633 ?>
          <!--s_strMSG_END_REQUEST_CSR-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strACDControllerIP" transaction="s_strZeroTransactionId" message-name="s_strMsgEndRequestCSR" destination-port="g_nACDControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;RequestId&quot;" value="g_lCSRRequestId"/>
            <parameter tag="&quot;AssignmentId&quot;" value="g_lCSRAssignmentId"/>
          </SOAP>
          <results >
            <result name="Default" link="35" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[Session.g_bSentACDBeginRequest = false;]]></script>
          </scripts>
        </action>
        <action id="39" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=968 y=992 ?>
          <!--Remove member from MOH conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;RemoveMemberFromConference&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMOH_MS</parameter>
          </function>
          <results >
            <result name="Default" link="14" stubbed="0"/>
          </results>
        </action>
        <action id="40" plug-in="Pactolus.Branch.1" ><?xtml-editor x=5 y=893 ?>
          <!--send command to MS?-->
          <results >
            <result name="Default" link="4" stubbed="1"/>
            <result name="g_bNotifyMS" link="18" stubbed="0" >g_bNotifyMS == true</result>
          </results>
        </action>
        <action id="41" plug-in="Pactolus.Branch.1" ><?xtml-editor x=963 y=872 ?>
          <!--send command to MS?-->
          <results >
            <result name="Default" link="22" stubbed="1"/>
            <result name="g_bNotifyMS" link="9" stubbed="0" >g_bNotifyMS == true</result>
          </results>
        </action>
      </actions>
      <text-objects >
        <text-object x-coord="1584" y-coord="1165" width="140" height="45" text="Need to move conf to the alternate site id" font-name="Times New Roman" size="-16" red="0" green="0" blue="0" weight="0" underline="0" strikeout="0" point-size="12" italic="0"/>
      </text-objects>
    </function>
    <function name="OnBye" start="22" event="OnBye" returns="void" >
      <parameters >
        <parameter name="strAccept" type="string"/>
        <parameter name="strAcceptEncoding" type="string"/>
        <parameter name="strAcceptLanguage" type="string"/>
        <parameter name="strAllow" type="string" pass="byref"/>
        <parameter name="strAllowEvents" type="string" pass="byref"/>
        <parameter name="strAuthorization" type="string"/>
        <parameter name="strCallId" type="string"/>
        <parameter name="strCSeq" type="string"/>
        <parameter name="strDate" type="string"/>
        <parameter name="strEncryption" type="string"/>
        <parameter name="strErrorInfo" type="string" pass="byref"/>
        <parameter name="strFrom" type="string"/>
        <parameter name="strMaxForwards" type="string"/>
        <parameter name="strMIMEVersion" type="string" pass="byref"/>
        <parameter name="strProxyAuthorization" type="string"/>
        <parameter name="strProxyRequire" type="string"/>
        <parameter name="strRecordRoute" type="string"/>
        <parameter name="strReferredBy" type="string" pass="byref"/>
        <parameter name="strRequestUri" type="string" pass="byref"/>
        <parameter name="strRequire" type="string" pass="byref"/>
        <parameter name="strResponseKey" type="string" pass="byref"/>
        <parameter name="strRoute" type="string" pass="byref"/>
        <parameter name="strSupported" type="string" pass="byref"/>
        <parameter name="strTimestamp" type="string" pass="byref"/>
        <parameter name="strTo" type="string" pass="byref"/>
        <parameter name="strUserAgent" type="string" pass="byref"/>
        <parameter name="strVia" type="string" pass="byref"/>
      </parameters>
      <actions >
        <action id="22" plug-in="Pactolus.Branch.1" ><?xtml-editor x=69 y=285 ?>
          <!--call id?-->
          <results >
            <result name="Default" link="23" stubbed="0"/>
            <result name="callid A, dial in" link="32" stubbed="0" >strCallId match g_oCallLegA.strCallId</result>
            <result name="callid B, dial out" link="33" stubbed="0" >strCallId match g_oCallLegB.strCallId</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: OnBye");

js_disable_event();

Session.g_nTerminationReason = 1;

Session.g_lEndTime = Server.getUTCTime();]]></script>
          </scripts>
        </action>
        <action id="9" plug-in="Standard.EndSession.1" ><?xtml-editor x=1558 y=339 ?>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nCallerCurrentState = Session.s_nStateEndCall;]]></script>
          </scripts>
        </action>
        <action id="10" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1114 y=351 ?>
          <!--PARTY LEAVE-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;PartyLeave&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="29" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nConfLeaveReason = 0;
Session.g_strConfLeaveMsg = "PARTY HANGUP";]]></script>
          </scripts>
        </action>
        <action id="15" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=890 y=359 ?>
          <!--stop timer if needed-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;StopTimer&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="10" stubbed="0"/>
          </results>
        </action>
        <action id="21" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=834 y=1480 ?>
          <!--party declined to IVR-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="" transaction="" message-name="s_strIvrConfDeclineResponse" destination-port="" destination-type="3" destination-session="g_strIVRAddPartySessionId" waiting-session-selected="" xml-namespace=""/>
          <results >
            <result name="Default" link="29" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
        </action>
        <action id="23" plug-in="Pactolus.SipResponse.1" ><?xtml-editor x=280 y=116 ?>
          <!--Send 404 NOT FOUND back to caller-->
          <sip-response xmlns="urn:www.pactolus.com:xtml:sip" remove-via="0" reliable="0" increment-cseq-first="0" increment-cseq-last="0" >
            <call-id >strCallId</call-id>
            <cseq >strCSeq</cseq>
            <from >strFrom</from>
            <status >"SIP/2.0 404 Not Found"</status>
            <to >strTo</to>
            <via >strVia</via>
          </sip-response>
          <results >
            <result name="Default" link="24" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logError("ERROR: GOT BYE, BUT NEITHER FROM A OR B");

Server.logError("ERROR: FROM : " + Session.strFrom);

Server.logError("ERROR: TO: " + Session.strTo);

Server.logError("ERROR: CALL Id : " + Session.strCallId);

Server.logError("ERROR: CSEQ: " + Session.strCSeq);]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id == 2)

{

	Server.logInfo("INFO: SUCCESS RESPONSE 404 NOT FOUND TO BYE.");

}

else

{

	Server.logError("ERROR: FAIL TO RESPONSE 404 NOT FOUND TO BYE, EXIT ON: " + Result.name);

}]]></script>
          </scripts>
        </action>
        <action id="24" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=527 y=110 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="25" plug-in="Pactolus.Branch.1" ><?xtml-editor x=562 y=1050 ?>
          <!--dial out-->
          <results >
            <result name="Default" link="41" stubbed="1"/>
            <result name="g_bCurrentlyInSubConf" link="10" stubbed="1" >g_bCurrentlyInSubConf== true</result>
            <result name="g_bPrivateTalkInConference" link="44" stubbed="0" >g_bPrivateTalkInConference == true</result>
            <result name="web dial out and in ms" link="31" stubbed="0" >g_bWebDialOut == true

AND g_oMS.bCurrentlyConnected == true

AND g_bSentPartyJoin == false</result>
            <result name="IVR dial out and in temp conf" link="21" stubbed="0" >g_bIVRDialOut == true

AND g_oTempConf.bCurrentlyInConf == true

AND g_bSentPartyJoin == false</result>
          </results>
        </action>
        <action id="29" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1343 y=346 ?>
          <!--adding party?-->
          <results >
            <result name="Default" link="9" stubbed="0"/>
            <result name="adding party == true" link="30" stubbed="0" >g_bAddingParty == true</result>
          </results>
        </action>
        <action id="30" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1575 y=423 ?>
          <!--send IVRConfRemoveAddParty-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="" transaction="" message-name="s_strIvrConfRemovePartyRequest" destination-port="" destination-type="3" destination-session="g_strAddPartySessionId" waiting-session-selected="" xml-namespace=""/>
          <results >
            <result name="Default" link="9" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("SEND TO session Id is: " + Session.g_strAddPartySessionId);]]></script>
          </scripts>
        </action>
        <action id="31" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=849 y=1332 ?>
          <!--party declined to WEB-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="g_strResponseTransactionId" message-name="s_strConfAddResponse" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="902"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
            <parameter tag="&quot;dialOutRequestId&quot;" value="g_lDialOutRequestId"/>
            <parameter tag="&quot;SIPCallId&quot;" value="g_oCallLegB.strCallId"/>
          </SOAP>
          <results >
            <result name="Default" link="29" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "OUTDIAL: PARTY DECLINED";]]></script>
          </scripts>
        </action>
        <action id="32" plug-in="Pactolus.SipResponse.1" ><?xtml-editor x=313 y=344 ?>
          <!--Send 200 OK back to caller-->
          <sip-response xmlns="urn:www.pactolus.com:xtml:sip" remove-via="0" reliable="0" increment-cseq-first="0" increment-cseq-last="0" >
            <call-id >strCallId</call-id>
            <cseq >strCSeq</cseq>
            <from >strFrom</from>
            <status >"SIP/2.0 200 OK"</status>
            <to >strTo</to>
            <via >strVia</via>
          </sip-response>
          <results >
            <result name="Default" link="51" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="33" plug-in="Pactolus.SipResponse.1" ><?xtml-editor x=210 y=1177 ?>
          <!--Send 200 OK back to caller-->
          <sip-response xmlns="urn:www.pactolus.com:xtml:sip" remove-via="0" reliable="0" increment-cseq-first="0" increment-cseq-last="0" >
            <call-id >strCallId</call-id>
            <cseq >strCSeq</cseq>
            <from >strFrom</from>
            <status >"SIP/2.0 200 OK"</status>
            <to >strTo</to>
            <via >strVia</via>
          </sip-response>
          <results >
            <result name="Default" link="53" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="36" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1125 y=478 ?>
          <!--"psAPISceEndRequest"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceEndRequest&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="15" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 1;]]></script>
          </scripts>
        </action>
        <action id="38" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1121 y=584 ?>
          <!--"psAPISceEndAssignment"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceEndAssignment&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="36" stubbed="1"/>
          </results>
        </action>
        <action id="40" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=893 y=478 ?>
          <!--s_strMSG_END_REQUEST_CSR-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strACDControllerIP" transaction="s_strZeroTransactionId" message-name="s_strMsgEndRequestCSR" destination-port="g_nACDControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;RequestId&quot;" value="g_lCSRRequestId"/>
            <parameter tag="&quot;AssignmentId&quot;" value="0"/>
          </SOAP>
          <results >
            <result name="Default" link="36" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[Session.g_bSentACDBeginRequest = false;]]></script>
          </scripts>
        </action>
        <action id="41" plug-in="Pactolus.Branch.1" ><?xtml-editor x=574 y=388 ?>
          <results >
            <result name="Default" link="15" stubbed="0"/>
            <result name="BeginRequest" link="40" stubbed="0" >g_nCallerCurrentState == s_nStateBeginRequest

OR g_nCallerCurrentState == s_nStateRouteToCsr

OR g_nCallerCurrentState == s_nStateZeroOutToCsr</result>
            <result name="BeginAssignment" link="42" stubbed="0" >g_nCallerCurrentState == s_nStateBeginAssignment

OR g_nCallerCurrentState == s_nStateCsrPutOnHold

OR g_nCallerCurrentState == s_nStateCsrPutOffHold</result>
            <result name="Requeue" link="43" stubbed="0" >g_nCallerCurrentState == s_nStateRequeue</result>
            <result name="SentACDBeginRequest" link="50" stubbed="0" >g_bSentACDBeginRequest == true</result>
          </results>
        </action>
        <action id="42" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=893 y=610 ?>
          <!--s_strMSG_END_REQUEST_CSR-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strACDControllerIP" transaction="s_strZeroTransactionId" message-name="s_strMsgEndRequestCSR" destination-port="g_nACDControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;RequestId&quot;" value="g_lCSRRequestId"/>
            <parameter tag="&quot;AssignmentId&quot;" value="g_lCSRAssignmentId"/>
          </SOAP>
          <results >
            <result name="Default" link="38" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[Session.g_bSentACDBeginRequest = false;]]></script>
          </scripts>
        </action>
        <action id="43" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=887 y=760 ?>
          <!--s_strMSG_END_REQUEST_CSR-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strACDControllerIP" transaction="s_strZeroTransactionId" message-name="s_strMsgEndRequestCSR" destination-port="g_nACDControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;RequestId&quot;" value="g_lCSRRequestId"/>
            <parameter tag="&quot;AssignmentId&quot;" value="0"/>
          </SOAP>
          <results >
            <result name="Default" link="36" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[Session.g_bSentACDBeginRequest = false;]]></script>
          </scripts>
        </action>
        <action id="44" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=827 y=1113 ?>
          <!--PrivateTalkHangup-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="&quot;PrivateTalkHangup&quot;" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;ConferenceId&quot;" value="g_strConfScheduleId"/>
            <parameter tag="&quot;moderatorKey&quot;" value="g_strModeratorKey"/>
          </SOAP>
          <results >
            <result name="Default" link="45" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "PRIVATE TALK HANGUP";

Server.logInfo("SENDING PrivateTalkHangup TO CONFERENCE CONTROLLER");

Session.g_lPrivateTalkEndTime = Server.getUTCTime();]]></script>
            <script language="javascript" timing="last" ><![CDATA[Session.g_bPrivateTalkInConference = false;]]></script>
          </scripts>
        </action>
        <action id="45" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1080 y=1140 ?>
          <!--Remove member from temp conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;RemoveMemberFromConference&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
          </function>
          <results >
            <result name="Default" link="29" stubbed="1"/>
          </results>
        </action>
        <action id="46" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1387 y=921 ?>
          <!--"psAPISceEndAssignment"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceEndAssignment&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="48" stubbed="0"/>
          </results>
        </action>
        <action id="47" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1125 y=919 ?>
          <!--sent APIBeginAssignment?-->
          <results >
            <result name="Default" link="48" stubbed="1"/>
            <result name="g_bSentAPIBeginAssignment" link="46" stubbed="0" >g_bSentAPIBeginAssignment == true</result>
          </results>
        </action>
        <action id="48" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1606 y=916 ?>
          <!--sent APIBeginRequest?-->
          <results >
            <result name="Default" link="15" stubbed="1"/>
            <result name="g_bSentAPIBeginRequest" link="49" stubbed="0" >g_bSentAPIBeginRequest == true</result>
          </results>
        </action>
        <action id="49" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1830 y=911 ?>
          <!--"psAPISceEndRequest"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceEndRequest&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="15" stubbed="1"/>
          </results>
        </action>
        <action id="50" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=876 y=924 ?>
          <!--s_strMSG_END_REQUEST_CSR-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strACDControllerIP" transaction="s_strZeroTransactionId" message-name="s_strMsgEndRequestCSR" destination-port="g_nACDControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;RequestId&quot;" value="g_lCSRRequestId"/>
            <parameter tag="&quot;AssignmentId&quot;" value="g_lCSRAssignmentId"/>
          </SOAP>
          <results >
            <result name="Default" link="47" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[Session.g_bSentACDBeginRequest = false;]]></script>
          </scripts>
        </action>
        <action id="51" plug-in="Pactolus.Branch.1" ><?xtml-editor x=292 y=528 ?>
          <!--Check for TPCSR Caller Hung up-->
          <results >
            <result name="Default" link="41" stubbed="0"/>
            <result name="TPCSROutdial=&quot;T&quot;" link="52" stubbed="0" >g_strThirdPartyAcdOutdialAvail match "T"
AND g_bTPCSRRouteInProgress == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (Session.g_strThirdPartyAcdOutdialAvail == "T" && Session.g_bTPCSRRouteInProgress == true)
{
	Server.logError("TPCSR is enabled and we were in RouteToTPCSR. A Leg hung up. Hang up B and end session");
}
]]></script>
          </scripts>
        </action>
        <action id="52" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=465 y=634 ?>
          <!--HangupParty-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpParty&quot;" return="" external-function="1" library="lib_callcontrol.xml" >
            <parameter >g_oCallLegB</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="9" stubbed="1"/>
          </results>
        </action>
        <action id="53" plug-in="Pactolus.Branch.1" ><?xtml-editor x=375 y=955 ?>
          <!--Check for TPCSR Caller Hung up-->
          <results >
            <result name="Default" link="25" stubbed="0"/>
            <result name="TPCSROutdial=&quot;T&quot;" link="54" stubbed="0" >g_strThirdPartyAcdOutdialAvail match "T"
AND g_bTPCSRRouteInProgress == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (Session.g_strThirdPartyAcdOutdialAvail == "T" && Session.g_bTPCSRRouteInProgress == true)
{
	Server.logError("TPCSR is enabled and we were in RouteToTPCSR. B Leg hung up. Hang up A and end session");
}
]]></script>
          </scripts>
        </action>
        <action id="54" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=523 y=1221 ?>
          <!--HangupParty-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpParty&quot;" return="" external-function="1" library="lib_callcontrol.xml" >
            <parameter >g_oCallLegA</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="9" stubbed="1"/>
          </results>
        </action>
      </actions>
      <text-objects >
        <text-object x-coord="543" y-coord="192" width="394" height="27" text="Currently in the conference.  Does not matter dial in or dial out" font-name="Times New Roman" size="-16" red="0" green="0" blue="0" weight="0" underline="0" strikeout="0" point-size="12" italic="0"/>
      </text-objects>
    </function>
    <function name="psAPISceConfCallLegCompletion" start="4" event="psAPISceConfCallLegCompletion" returns="i4" >
      <local-vars >
        <var name="f_nReturnCode" type="i4" >-50</var>
        <var name="f_strBlankString" type="string" ></var>
      </local-vars>
      <actions >
        <action id="4" plug-in="Pactolus.Branch.1" ><?xtml-editor x=155 y=185 ?>
          <!--null string?-->
          <results >
            <result name="Default" link="5" stubbed="0"/>
            <result name="null string" link="2" stubbed="1" >g_bNullString == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: psAPISceConfCallLegCompletion");
if (Session.g_strDBNAME.length > 0)
{
	Session.g_bNullString = false;
}
else
{
	Session.g_bNullString = true;
}
Session.g_strStatus = new String(Session.g_strSIPStatus);]]></script>
          </scripts>
        </action>
        <action id="1" plug-in="Pactolus.JavaStaticMethod.1" ><?xtml-editor x=632 y=178 ?>
          <!--CallLegCompletion()-->
          <java xmlns="urn:www.pactolus.com:xtml:application" class="&quot;com.pactolus.conferencing.psAPISceConfCallLegCompletion&quot;" method="&quot;procConfCallCompletion&quot;" timeout="s_nTimeout" return="" method-return-var="f_nReturnCode" method-return-type="0" >
            <parameter type="in" var-type="string" >g_strDBNAME</parameter>
            <parameter type="in" var-type="string" >g_strSessionId</parameter>
            <parameter type="in" var-type="i4" >g_nTerminationReason</parameter>
            <parameter type="in" var-type="i8" >g_lEndTime</parameter>
            <parameter type="in" var-type="i8" >g_lMSConnectTime</parameter>
            <parameter type="in" var-type="string" >g_strConfEventId</parameter>
            <parameter type="in" var-type="string" >g_strCallLegId</parameter>
            <parameter type="in" var-type="string" >g_strModeratorFlag</parameter>
            <parameter type="in" var-type="string" >g_strSPTimeZone</parameter>
            <parameter type="in" var-type="i4" >g_nOrigAccessNbrId</parameter>
            <parameter type="in" var-type="i4" >g_nCallMode</parameter>
            <parameter type="in" var-type="string" >g_strPartyScheduleId</parameter>
            <parameter type="in" var-type="i8" >g_lServiceProviderId</parameter>
            <parameter type="in" var-type="string" >g_strInfoDigits</parameter>
            <parameter type="in" var-type="string" >g_strOrigDomIntlFlag</parameter>
            <parameter type="in" var-type="string" >g_strDestDomIntlFlag</parameter>
            <parameter type="in" var-type="i4" >g_nOrigCountryId</parameter>
            <parameter type="in" var-type="string" >g_strStrippedOrigNbr</parameter>
            <parameter type="in" var-type="string" >f_strBlankString</parameter>
            <parameter type="in" var-type="i4" >g_nRtpEncoding</parameter>
            <parameter type="in" var-type="i4" >g_nRtpClockRate</parameter>
            <parameter type="in" var-type="string" >g_oCallLegA.strFrom</parameter>
            <parameter type="in" var-type="string" >g_oCallLegA.strTo</parameter>
            <parameter type="in" var-type="string" >g_oCallLegA.strCallId</parameter>
            <parameter type="in" var-type="string" >g_strStatus</parameter>
            <parameter type="in" var-type="i8" >g_lStartTime</parameter>
            <parameter type="in" var-type="string" >g_strGWIPIngress</parameter>
            <parameter type="in" var-type="i4" >g_nGWPortIngress</parameter>
            <parameter type="in" var-type="string" >g_strGWIPEgress</parameter>
            <parameter type="in" var-type="i4" >g_nGWPortEgress</parameter>
            <parameter type="in" var-type="string" >s_strApplicationName</parameter>
            <parameter type="in" var-type="string" >g_strSoapAddress</parameter>
            <parameter type="in" var-type="i4" >g_nSoapPort</parameter>
            <parameter type="in" var-type="string" >g_strOutdialFlag</parameter>
            <parameter type="in" var-type="string" >g_strOrigCallingCode</parameter>
            <parameter type="in" var-type="string" >g_strOrigAreaCode</parameter>
            <parameter type="in" var-type="i4" >g_nDestCountryId</parameter>
            <parameter type="in" var-type="string" >g_strDestCallingCountryCode</parameter>
            <parameter type="in" var-type="string" >g_strDestAreaCode</parameter>
            <parameter type="in" var-type="i4" >g_nBillingType</parameter>
            <parameter type="in" var-type="i4" >g_nCurrencyId</parameter>
            <parameter type="in" var-type="i8" >g_lSubscriberId</parameter>
            <parameter type="in" var-type="i4" >g_nServiceId</parameter>
            <parameter type="in" var-type="string" >g_strOperatorFlag</parameter>
            <parameter type="in" var-type="i4" >g_iRoundSeconds</parameter>
            <parameter type="in" var-type="i4" >g_iSubExpirationType</parameter>
            <parameter type="in" var-type="i4" >g_nPayphoneSrchgRateId</parameter>
            <parameter type="in" var-type="float" >g_fPayphoneSrchgRateAmt</parameter>
            <parameter type="in" var-type="unknown" >g_nAccessNumberRateId</parameter>
            <parameter type="in" var-type="float" >g_fAccessNumberRateAmt</parameter>
            <parameter type="in" var-type="i4" >g_nAccessNumberRateType</parameter>
            <parameter type="in" var-type="i4" >g_nMeteredRate1Id</parameter>
            <parameter type="in" var-type="float" >g_fMeteredRate1Amt</parameter>
            <parameter type="in" var-type="i4" >g_nMeteredRate2Id</parameter>
            <parameter type="in" var-type="float" >g_fMeteredRate2Amt</parameter>
            <parameter type="in" var-type="i4" >g_nFixedRate1Id</parameter>
            <parameter type="in" var-type="float" >g_fFixedRate1Amt</parameter>
            <parameter type="in" var-type="i4" >g_nFixedRate2Id</parameter>
            <parameter type="in" var-type="float" >g_fFixedRate2Amt</parameter>
            <parameter type="in" var-type="float" >g_fTotalMeteredRate</parameter>
            <parameter type="in" var-type="float" >g_fTotalFixedRate</parameter>
            <parameter type="in" var-type="string" >g_strSetStateToGetConfRes</parameter>
            <parameter type="in" var-type="string" >g_strConfSessionId</parameter>
            <parameter type="in" var-type="i8" >g_lOutdialStartTime</parameter>
            <parameter type="in" var-type="i8" >g_lOutdialConnectTime</parameter>
            <parameter type="in" var-type="i8" >g_lHoldWFMStartTime</parameter>
            <parameter type="in" var-type="string" >f_strBlankString</parameter>
            <parameter type="in" var-type="string" >g_oCallLegA.strOrigTrunkGroup</parameter>
            <parameter type="in" var-type="string" >f_strBlankString</parameter>
            <parameter type="in" var-type="string" >g_strCustomerConferenceId</parameter>
            <parameter type="in" var-type="i8" >g_lPrivateTalkStartTime</parameter>
            <parameter type="in" var-type="i8" >g_lPrivateTalkEndTime</parameter>
            <parameter type="in" var-type="string" >g_strMediaServerIP</parameter>
            <parameter type="in" var-type="string" >g_strTransferInOutFlag</parameter>
          </java>
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="Success" link="3" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: ********JAVA CALLING ConfCallLegComplettion *********");

Server.logInfo("INFO: BEFORE DB name = " + Session.g_strDBNAME);

Server.logInfo("INFO: BEFORE Session Id = " + Session.g_strSessionId);

Server.logInfo("INFO: BEFORE termination reason = " + Session.g_nTerminationReason);

Server.logInfo("INFO: BEFORE end time = " + Session.g_lEndTime);

Server.logInfo("INFO: BEFORE MS connect time = " + Session.g_lMSConnectTime);

Server.logInfo("INFO: BEFORE conf event Id = " + Session.g_strConfEventId);

Server.logInfo("INFO: BEFORE call leg Id = " + Session.g_strCallLegId);]]></script>
            <script language="javascript" timing="last" ><![CDATA[Server.logInfo("INFO: **** Conf Call Leg Completion returns " + Session.f_nReturnCode);

if (Result.id == 2)
{
	if (-99 == Session.f_nReturnCode)
	{
		Session.g_nErrorMsgNumber = 1001; //db error
		Session.g_nTerminationReason = 39;
	}
	else
		Session.g_nErrorMsgNumber = 0;

}

else

{

	Server.logError("ERROR: FAIL TO WRITE CALL LEG CALL COMPLETION, EXIT ON: " + Result.name);

	Session.g_nTerminationReason = 39;

	Session.g_nErrorMsgNumber = 1000; //jvm server error

}]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=915 y=173 ?>
          <!--FAILURE-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nFailure"/>
        </action>
        <action id="3" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=927 y=285 ?>
          <!--JAVA RETURN CODE-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nReturnCode"/>
        </action>
        <action id="5" plug-in="Pactolus.Branch.1" ><?xtml-editor x=410 y=182 ?>
          <!--dial out?-->
          <results >
            <result name="Default" link="1" stubbed="0"/>
            <result name="dial out?" link="6" stubbed="0" >g_strOutdialFlag match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (Session.g_lEndTime <= 0)

{

	Session.g_lEndTime = Server.getUTCTime();

}]]></script>
          </scripts>
        </action>
        <action id="6" plug-in="Pactolus.JavaStaticMethod.1" ><?xtml-editor x=647 y=336 ?>
          <!--CallLegCompletion()-->
          <java xmlns="urn:www.pactolus.com:xtml:application" class="&quot;com.pactolus.conferencing.psAPISceConfCallLegCompletion&quot;" method="&quot;procConfCallCompletion&quot;" timeout="s_nTimeout" return="" method-return-var="f_nReturnCode" method-return-type="0" >
            <parameter type="in" var-type="string" >g_strDBNAME</parameter>
            <parameter type="in" var-type="string" >g_strSessionId</parameter>
            <parameter type="in" var-type="i4" >g_nTerminationReason</parameter>
            <parameter type="in" var-type="i8" >g_lEndTime</parameter>
            <parameter type="in" var-type="i8" >g_lMSConnectTime</parameter>
            <parameter type="in" var-type="string" >g_strConfEventId</parameter>
            <parameter type="in" var-type="string" >g_strCallLegId</parameter>
            <parameter type="in" var-type="string" >g_strModeratorFlag</parameter>
            <parameter type="in" var-type="string" >g_strSPTimeZone</parameter>
            <parameter type="in" var-type="i4" >g_nOrigAccessNbrId</parameter>
            <parameter type="in" var-type="i4" >g_nCallMode</parameter>
            <parameter type="in" var-type="string" >g_strPartyScheduleId</parameter>
            <parameter type="in" var-type="i8" >g_lServiceProviderId</parameter>
            <parameter type="in" var-type="string" >g_strInfoDigits</parameter>
            <parameter type="in" var-type="string" >g_strOrigDomIntlFlag</parameter>
            <parameter type="in" var-type="string" >g_strDestDomIntlFlag</parameter>
            <parameter type="in" var-type="i4" >g_nOrigCountryId</parameter>
            <parameter type="in" var-type="string" >f_strBlankString</parameter>
            <parameter type="in" var-type="string" >g_strOutdialDestNbr</parameter>
            <parameter type="in" var-type="i4" >g_nRtpEncoding</parameter>
            <parameter type="in" var-type="i4" >g_nRtpClockRate</parameter>
            <parameter type="in" var-type="string" >g_oCallLegB.strFrom</parameter>
            <parameter type="in" var-type="string" >g_oCallLegB.strTo</parameter>
            <parameter type="in" var-type="string" >g_oCallLegB.strCallId</parameter>
            <parameter type="in" var-type="string" >g_strStatus</parameter>
            <parameter type="in" var-type="i8" >g_lStartTime</parameter>
            <parameter type="in" var-type="string" >g_strGWIPIngress</parameter>
            <parameter type="in" var-type="i4" >g_nGWPortIngress</parameter>
            <parameter type="in" var-type="string" >g_strGWIPEgress</parameter>
            <parameter type="in" var-type="i4" >g_nGWPortEgress</parameter>
            <parameter type="in" var-type="string" >s_strApplicationName</parameter>
            <parameter type="in" var-type="string" >g_strSoapAddress</parameter>
            <parameter type="in" var-type="i4" >g_nSoapPort</parameter>
            <parameter type="in" var-type="string" >g_strOutdialFlag</parameter>
            <parameter type="in" var-type="string" >g_strOrigCallingCode</parameter>
            <parameter type="in" var-type="string" >g_strOrigAreaCode</parameter>
            <parameter type="in" var-type="i4" >g_nDestCountryId</parameter>
            <parameter type="in" var-type="string" >g_strDestCallingCountryCode</parameter>
            <parameter type="in" var-type="string" >g_strDestAreaCode</parameter>
            <parameter type="in" var-type="i4" >g_nBillingType</parameter>
            <parameter type="in" var-type="i4" >g_nCurrencyId</parameter>
            <parameter type="in" var-type="i8" >g_lSubscriberId</parameter>
            <parameter type="in" var-type="i4" >g_nServiceId</parameter>
            <parameter type="in" var-type="string" >g_strOperatorFlag</parameter>
            <parameter type="in" var-type="i4" >g_iRoundSeconds</parameter>
            <parameter type="in" var-type="i4" >g_iSubExpirationType</parameter>
            <parameter type="in" var-type="i4" >g_nPayphoneSrchgRateId</parameter>
            <parameter type="in" var-type="float" >g_fPayphoneSrchgRateAmt</parameter>
            <parameter type="in" var-type="i4" >g_nAccessNumberRateId</parameter>
            <parameter type="in" var-type="float" >g_fAccessNumberRateAmt</parameter>
            <parameter type="in" var-type="i4" >g_nAccessNumberRateType</parameter>
            <parameter type="in" var-type="i4" >g_nMeteredRate1Id</parameter>
            <parameter type="in" var-type="float" >g_fMeteredRate1Amt</parameter>
            <parameter type="in" var-type="i4" >g_nMeteredRate2Id</parameter>
            <parameter type="in" var-type="float" >g_fMeteredRate2Amt</parameter>
            <parameter type="in" var-type="i4" >g_nFixedRate1Id</parameter>
            <parameter type="in" var-type="float" >g_fFixedRate1Amt</parameter>
            <parameter type="in" var-type="i4" >g_nFixedRate2Id</parameter>
            <parameter type="in" var-type="float" >g_fFixedRate2Amt</parameter>
            <parameter type="in" var-type="float" >g_fTotalMeteredRate</parameter>
            <parameter type="in" var-type="float" >g_fTotalFixedRate</parameter>
            <parameter type="in" var-type="string" >g_strSetStateToGetConfRes</parameter>
            <parameter type="in" var-type="string" >g_strConfSessionId</parameter>
            <parameter type="in" var-type="i8" >g_lOutdialStartTime</parameter>
            <parameter type="in" var-type="i8" >g_lOutdialConnectTime</parameter>
            <parameter type="in" var-type="i8" >g_lHoldWFMStartTime</parameter>
            <parameter type="in" var-type="string" >g_strTranslatedDestNbr</parameter>
            <parameter type="in" var-type="string" >f_strBlankString</parameter>
            <parameter type="in" var-type="string" >g_oCallLegB.strDestTrunkGroup</parameter>
            <parameter type="in" var-type="string" >g_strCustomerConferenceId</parameter>
            <parameter type="in" var-type="i8" >g_lPrivateTalkStartTime</parameter>
            <parameter type="in" var-type="i8" >g_lPrivateTalkEndTime</parameter>
            <parameter type="in" var-type="string" >g_strMediaServerIP</parameter>
            <parameter type="in" var-type="string" >g_strTransferInOutFlag</parameter>
          </java>
          <results >
            <result name="Default" link="2" stubbed="1"/>
            <result name="Success" link="3" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: ********JAVA CALLING ConfCallLegComplettion *********");

Server.logInfo("INFO: BEFORE DB name = " + Session.g_strDBNAME);

Server.logInfo("INFO: BEFORE Session Id = " + Session.g_strSessionId);

Server.logInfo("INFO: BEFORE termination reason = " + Session.g_nTerminationReason);

Server.logInfo("INFO: BEFORE end time = " + Session.g_lEndTime);

Server.logInfo("INFO: BEFORE MS connect time = " + Session.g_lMSConnectTime);

Server.logInfo("INFO: BEFORE conf event Id = " + Session.g_strConfEventId);

Server.logInfo("INFO: BEFORE call leg Id = " + Session.g_strCallLegId);]]></script>
            <script language="javascript" timing="last" ><![CDATA[Server.logInfo("INFO: **** Conf Call Leg Completion returns " + Session.f_nReturnCode);

if (Result.id == 2)

{

	if (-99 == Session.f_nReturnCode)
	{
		Session.g_nErrorMsgNumber = 1001; //db error
		Session.g_nTerminationReason = 39;
	}

	else

		Session.g_nErrorMsgNumber = 0;

}

else

{

	Server.logError("ERROR: FAIL TO WRITE CALL LEG CALL COMPLETION, EXIT ON: " + Result.name);

	Session.g_nTerminationReason = 39;

	Session.g_nErrorMsgNumber = 1000; //jvm server error

}]]></script>
          </scripts>
        </action>
      </actions>
    </function>
    <function name="OnCancel" start="5" event="OnCancel" returns="void" >
      <parameters >
        <parameter name="strAccept" type="string"/>
        <parameter name="strAcceptEncoding" type="string"/>
        <parameter name="strAcceptLanguage" type="string"/>
        <parameter name="strAuthorization" type="string"/>
        <parameter name="strCallId" type="string"/>
        <parameter name="strContent" type="string"/>
        <parameter name="strContentDisposition" type="string"/>
        <parameter name="strContentType" type="string"/>
        <parameter name="strCSeq" type="string"/>
        <parameter name="strDate" type="string"/>
        <parameter name="strEncryption" type="string"/>
        <parameter name="strErrorInfo" type="string" pass="byref"/>
        <parameter name="strFrom" type="string"/>
        <parameter name="strMaxForwards" type="string"/>
        <parameter name="strProxyAuthorization" type="string"/>
        <parameter name="strProxyRequire" type="string"/>
        <parameter name="strRecordRoute" type="string"/>
        <parameter name="strRequestUri" type="string" pass="byref"/>
        <parameter name="strRequire" type="string" pass="byref"/>
        <parameter name="strResponseKey" type="string" pass="byref"/>
        <parameter name="strRoute" type="string" pass="byref"/>
        <parameter name="strSupported" type="string" pass="byref"/>
        <parameter name="strTimestamp" type="string" pass="byref"/>
        <parameter name="strTo" type="string" pass="byref"/>
        <parameter name="strUserAgent" type="string" pass="byref"/>
        <parameter name="strVia" type="string" pass="byref"/>
      </parameters>
      <actions >
        <action id="5" plug-in="Pactolus.Branch.1" ><?xtml-editor x=37 y=198 ?>
          <!--sent final response?-->
          <results >
            <result name="Default" link="8" stubbed="0"/>
            <result name="sent final response == false" link="6" stubbed="0" >g_bSentFinalResponse == false</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: OnCancel");]]></script>
          </scripts>
        </action>
        <action id="3" plug-in="Standard.EndSession.1" ><?xtml-editor x=551 y=127 ?>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nCallerCurrentState = Session.s_nStateEndCall;]]></script>
          </scripts>
        </action>
        <action id="6" plug-in="Pactolus.SipResponse.1" ><?xtml-editor x=302 y=347 ?>
          <!--200 OK-->
          <sip-response xmlns="urn:www.pactolus.com:xtml:sip" remove-via="0" reliable="0" increment-cseq-first="0" increment-cseq-last="0" >
            <call-id >strCallId</call-id>
            <cseq >strCSeq</cseq>
            <from >strFrom</from>
            <status >"SIP/2.0 200 OK"</status>
            <to >strTo</to>
            <via >strVia</via>
          </sip-response>
          <results >
            <result name="Default" link="7" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="7" plug-in="Pactolus.SipResponse.1" ><?xtml-editor x=535 y=347 ?>
          <!--487 Request Terminated-->
          <sip-response xmlns="urn:www.pactolus.com:xtml:sip" remove-via="0" reliable="0" increment-cseq-first="0" increment-cseq-last="0" >
            <call-id >strCallId</call-id>
            <contact >g_strContact</contact>
            <cseq >strCSeq</cseq>
            <from >strFrom</from>
            <status >"SIP/2.0 487 Request Terminated"</status>
            <to >strTo</to>
            <via >strVia</via>
          </sip-response>
          <results >
            <result name="Default" link="9" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[var cseq = new SipCSeq(Session.strCSeq);

cseq.method = "INVITE";

Session.strCSeq = cseq.encode();]]></script>
          </scripts>
        </action>
        <action id="8" plug-in="Pactolus.SipResponse.1" ><?xtml-editor x=289 y=134 ?>
          <!--200 OK-->
          <sip-response xmlns="urn:www.pactolus.com:xtml:sip" remove-via="0" reliable="0" increment-cseq-first="0" increment-cseq-last="0" >
            <call-id >strCallId</call-id>
            <cseq >strCSeq</cseq>
            <from >strFrom</from>
            <status >"SIP/2.0 200 OK"</status>
            <to >strTo</to>
            <via >strVia</via>
          </sip-response>
          <results >
            <result name="Default" link="3" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="9" plug-in="Pactolus.UserFunction.1" ><?xtml-editor x=778 y=347 ?>
          <!--send alert early-call-cancel-->
          <user-function xmlns="urn:www.pactolus.com:xtml:application" process="&quot;PACTOLUS_ps_c_adaptor&quot;" function="&quot;increment_event_counter&quot;" timeout="s_nTimeout" return="" async="1" >
            <parameter >"early-call-cancel"</parameter>
          </user-function>
          <results >
            <result name="Default" link="3" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
      </actions>
    </function>
    <function name="OnOptions" start="2" event="OnOptions" returns="void" >
      <parameters >
        <parameter name="strAccept" type="string"/>
        <parameter name="strAcceptEncoding" type="string"/>
        <parameter name="strAcceptLanguage" type="string"/>
        <parameter name="strAllow" type="string" pass="byref"/>
        <parameter name="strAllowEvents" type="string" pass="byref"/>
        <parameter name="strAuthorization" type="string"/>
        <parameter name="strCallId" type="string"/>
        <parameter name="strCallInfo" type="string" pass="byref"/>
        <parameter name="strContact" type="string"/>
        <parameter name="strContent" type="string"/>
        <parameter name="strContentDisposition" type="string"/>
        <parameter name="strContentEncoding" type="string" pass="byref"/>
        <parameter name="strContentLanguage" type="string" pass="byref"/>
        <parameter name="strContentType" type="string"/>
        <parameter name="strCSeq" type="string"/>
        <parameter name="strDate" type="string"/>
        <parameter name="strEncryption" type="string"/>
        <parameter name="strErrorInfo" type="string" pass="byref"/>
        <parameter name="strFrom" type="string"/>
        <parameter name="strMaxForwards" type="string"/>
        <parameter name="strMIMEVersion" type="string" pass="byref"/>
        <parameter name="strOrganization" type="string" pass="byref"/>
        <parameter name="strProxyAuthorization" type="string"/>
        <parameter name="strProxyRequire" type="string"/>
        <parameter name="strRecordRoute" type="string"/>
        <parameter name="strRemotePartyID" type="string" pass="byref"/>
        <parameter name="strReferredBy" type="string" pass="byref"/>
        <parameter name="strRequestUri" type="string" pass="byref"/>
        <parameter name="strRequire" type="string" pass="byref"/>
        <parameter name="strResponseKey" type="string" pass="byref"/>
        <parameter name="strRoute" type="string" pass="byref"/>
        <parameter name="strSupported" type="string" pass="byref"/>
        <parameter name="strTimestamp" type="string" pass="byref"/>
        <parameter name="strTo" type="string" pass="byref"/>
        <parameter name="strUserAgent" type="string" pass="byref"/>
        <parameter name="strVia" type="string" pass="byref"/>
      </parameters>
      <actions >
        <action id="2" plug-in="Pactolus.SipResponse.1" ><?xtml-editor x=211 y=142 ?>
          <!--200 OK-->
          <sip-response xmlns="urn:www.pactolus.com:xtml:sip" remove-via="0" reliable="0" increment-cseq-first="0" increment-cseq-last="0" >
            <call-id >strCallId</call-id>
            <cseq >strCSeq</cseq>
            <from >strFrom</from>
            <status >"SIP/2.0 200 OK"</status>
            <to >strTo</to>
            <via >strVia</via>
          </sip-response>
          <results >
            <result name="Default" link="1" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: OnOptions");]]></script>
          </scripts>
        </action>
        <action id="1" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=452 y=142 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
        </action>
      </actions>
    </function>
    <function name="OnConfAddPartyRequest" start="202" event="OnConfAddPartyRequest" returns="void" >
      <parameters >
        <parameter name="strConfControllerIpAddress" type="string" pass="byref"/>
        <parameter name="nConfControllerPort" type="i4" pass="byref"/>
        <parameter name="strTransactionId" type="string" pass="byref"/>
        <parameter name="strConferenceId" type="string" pass="byref"/>
        <parameter name="strCalledNumber" type="string" pass="byref"/>
        <parameter name="strExtNumber" type="string" pass="byref"/>
        <parameter name="strPassCode" type="string" pass="byref"/>
        <parameter name="lServiceProviderId" type="i8" pass="byref"/>
        <parameter name="nDestCountryId" type="i4" pass="byref"/>
        <parameter name="strDestCallingCountryCode" type="string" pass="byref"/>
        <parameter name="strDestAreaCode" type="string" pass="byref"/>
        <parameter name="strDomIntlFlag" type="string" pass="byref"/>
        <parameter name="nDialPlanId" type="i4" pass="byref"/>
        <parameter name="strModOutdialFlag" type="string" pass="byref"/>
        <parameter name="strCalledFirstName" type="string" pass="byref"/>
        <parameter name="strCalledLastName" type="string" pass="byref"/>
        <parameter name="strAccessNumber" type="string" pass="byref"/>
        <parameter name="lDialOutRequestId" type="i8" pass="byref"/>
        <parameter name="strForceModeratorFlag" type="string" pass="byref"/>
        <parameter name="strForceMuteFlag" type="string" pass="byref"/>
        <parameter name="strConfirmationFlag" type="string" pass="byref"/>
        <parameter name="strPrivateTalkFlag" type="string" pass="byref"/>
        <parameter name="strAnonymousFlag" type="string" pass="byref"/>
        <parameter name="nPrivilege" type="i4" pass="byref"/>
        <parameter name="strPrivateTalkConfEndPoint" type="string" pass="byref"/>
        <parameter name="strModeratorKey" type="string" pass="byref"/>
      </parameters>
      <local-vars >
        <var name="f_nReturnCode" type="i4" >-1</var>
        <var name="f_strDigits" type="string" ></var>
        <var name="f_sMaxRetry" type="i2" >0</var>
        <var name="f_nSUCCESS" type="i4" >0</var>
        <var name="f_nRINGNOANSWER" type="i4" >1</var>
        <var name="f_bValidDest" type="boolean" >0</var>
        <var name="f_oDigit" type="object" ></var>
        <var name="f_bNullString" type="boolean" >0</var>
        <var name="f_nCallLegCount" type="i4" >0</var>
        <var name="f_bIsWaitingForConfRes" type="boolean" >0</var>
        <var name="f_nWaitForResCounter" type="i4" >0</var>
        <var name="f_bPlayPleaseHold" type="boolean" >0</var>
        <var name="f_lCurrentTime" type="i8" >0</var>
        <var name="f_sCounter" type="i2" >0</var>
        <var name="f_bHasAccessNumber" type="boolean" >0</var>
        <var name="f_nPassCodeStatus" type="i4" >0</var>
        <var name="f_bHasExt" type="boolean" >0</var>
        <var name="f_nBUSY" type="i4" >2</var>
        <var name="f_nErrorCode" type="i4" >0</var>
        <var name="f_strConfControllerIP" type="string" ></var>
        <var name="f_nConfControllerPort" type="i4" >0</var>
        <var name="f_strTransactionId" type="string" ></var>
        <var name="f_strReturnMsg" type="string" ></var>
        <var name="f_bMoreThanFiveSecs" type="boolean" >0</var>
        <var name="f_nResourceUnavail" type="i4" >-5</var>
        <var name="f_strCallingNumber" type="string" ></var>
        <var name="bSameConferenceId" type="boolean" >0</var>
        <var name="nSetConfResourceRetry" type="i4" >0</var>
        <var name="strPreviousConferenceId" type="string" ></var>
        <var name="nPromptFirstCaller" type="i4" >0</var>
        <var name="strParseThisExt" type="string" ></var>
        <var name="strOrigDestinationNbr" type="string" ></var>
        <var name="oSplitArray" type="object" ></var>
        <var name="nMyIndex" type="i4" >0</var>
        <var name="bHasPause" type="boolean" >0</var>
        <var name="bDonePlay" type="boolean" >0</var>
      </local-vars>
      <actions >
        <action id="202" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=95 y=147 ?>
          <!--Trying-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strConfControllerIpAddress" transaction="strTransactionId" message-name="s_strConfAddResponse" destination-port="nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="90"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
            <parameter tag="&quot;dialOutRequestId&quot;" value="lDialOutRequestId"/>
            <parameter tag="&quot;SIPCallId&quot;" value="g_oCallLegB.strCallId"/>
          </SOAP>
          <results >
            <result name="Default" link="134" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: OnConfAddPartyRequest");
var i = 0;
var myStringArray = new String();
Server.logInfo("DESTINATION NUMBER IS : " + Session.strCalledNumber);
Session.strOrigDestinationNbr = Session.strCalledNumber;
if (Session.strOrigDestinationNbr.indexOf(',') > 0)
{
	Server.logInfo("DESTINATION HAS COMMA");
	Session.bHasPause = true;
	Session.strCalledNumber = Session.strOrigDestinationNbr.slice(0, Session.strOrigDestinationNbr.indexOf(','));
	Server.logInfo("DESTINATION NUMBER IS NOW: " + Session.strCalledNumber);
	Session.strParseThisExt = Session.strOrigDestinationNbr.substr(Session.strOrigDestinationNbr.indexOf(','));
	Server.logInfo("EXT NUMBER IS NOW: " + Session.strParseThisExt);
	myStringArray = Session.strParseThisExt.split(',');
	Server.logInfo("array length is: " + myStringArray.length);
	for (i = 0; i < myStringArray.length; i++)
	{
		Server.logInfo("Ext at index " + i + " is: " + myStringArray[i]);
		if (0 == myStringArray[i].length)
		{
			Server.logInfo("REPLACE COMMA WITH dot");
			Session.oSplitArray[i] = ".";
		}
		else
		{
			Server.logInfo("COPY CONTENT");
			Session.oSplitArray[i] = myStringArray[i];
		}
	}
	for (i = 0; i < Session.oSplitArray.length; i++)
	{
		Server.logInfo("AFTER CONVERT COMMA TO dot, at index " + i + " is: " + Session.oSplitArray[i]);
	}
}
else
{
	Server.logInfo("DESTINATION HAS NO COMMA");	
	Session.bHasPause = false;
}

Session.g_strReturnMsg = "TRYING";

//default Egress for dial out

Session.g_strGWIPEgress = Session.s_strPrimaryPSX;
Session.g_nGWPortEgress = 5060;
Session.g_nRtpClockRate = 8000;
Session.g_nRtpEncoding = 0;
Session.g_bThirdPartyDialOut = true;


Server.logInfo("INFO: RECEIVE ADD PARTY REQUEST FROM CONF CONTROLLER.");

Server.logInfo("INFO: conf controller IP: " + Session.strConfControllerIpAddress);

Server.logInfo("INFO: conf controller port: " + Session.nConfControllerPort);

Server.logInfo("INFO: transaction Id: " + Session.strTransactionId);

Server.logInfo("INFO: conference Id: " + Session.strConferenceId);

Server.logInfo("INFO: called number: " + Session.strCalledNumber);

Server.logInfo("INFO: called extension number: " + Session.strExtNumber);

Server.logInfo("INFO: pass code: " + Session.strPassCode);

Server.logInfo("INFO: service provider Id: " + Session.lServiceProviderId);

Server.logInfo("INFO: dest country Id: " + Session.nDestCountryId);

Server.logInfo("INFO: dest calling code: " + Session.strDestCallingCountryCode);

Server.logInfo("INFO: dest area code: " + Session.strDestAreaCode);

Server.logInfo("INFO: dest dom intl flag: " + Session.strDomIntlFlag);

Server.logInfo("INFO: dialing plan Id: " + Session.nDialPlanId);

Server.logInfo("INFO: mod outdial flag: " + Session.strModOutdialFlag);

Server.logInfo("INFO: called first name: " + Session.strCalledFirstName);

Server.logInfo("INFO: called last name: " + Session.strCalledLastName);

Server.logInfo("INFO: Access number: " + Session.strAccessNumber);

Server.logInfo("INFO: dial out request Id: " + Session.lDialOutRequestId);

Server.logInfo("INFO: force moderator flag: " + Session.strForceModeratorFlag);

Server.logInfo("INFO: force mute flag: " + Session.strForceMuteFlag);





Session.g_nConfControllerPort = Session.nConfControllerPort;

Session.g_strConfControllerIP = Session.strConfControllerIpAddress;

Session.g_bServingCaller = true;

Session.g_lDialOutRequestId = Session.lDialOutRequestId;

Session.g_strDialOutExtNbr = Session.strExtNumber;

Session.g_strForceModeratorFlag = Session.strForceModeratorFlag;

Session.g_strForceMuteFlag = Session.strForceMuteFlag;

Session.f_bValidDest = true;

if (Session.strAccessNumber.length > 0)

{

	Session.g_strAccessNumber = Session.strAccessNumber;

	Session.f_bHasAccessNumber = true;

}

else

{

	Session.f_bHasAccessNumber = false;

}
Session.g_bWebDialOut = true;
Session.g_lStartTime = Server.getUTCTime();
Session.g_strSessionId = Session._sessionId;
Session.g_strSoapAddress = Server.soapAddress;
Server.logInfo("SERVER SOAP PORT IS: " + Server.soapPort);
Session.g_nSoapPort = Clib.atoi(Server.soapPort);
if (0 == Session.g_nSoapPort)
{
	Server.logError("ERROR: Server.soapPort IS ZERO");
	Server.logInfo("SET DEFAULT SOAP PORT TO 7581");
	Session.g_nSoapPort = 7581;
}
Session.g_strPassCode = Session.strPassCode;
Session.g_strOutdialFlag = "T";
Session.g_lServiceProviderId = Clib.atol(Session.lServiceProviderId);
Session.g_strConfScheduleId = Session.strConferenceId;
Session.g_strResponseTransactionId = Session.strTransactionId;
Session.g_nDestCountryId = Session.nDestCountryId;
if (Session.strDestCallingCountryCode.length <= 0)
{
	Server.logInfo("WARNING: BLANK DEST CALLING CODE: " + Session.strDestCallingCountryCode);
	Server.logInfo("WARNING: USE DEFAULT HOME COUNTRY CODE: " + Session.s_strDefaultCountryCode);
	Session.g_strDestCallingCountryCode = Session.s_strDefaultCountryCode;
}
else
{
	Session.g_strDestCallingCountryCode = Session.strDestCallingCountryCode;
}
Session.g_strDestAreaCode = Session.strDestAreaCode;
Session.g_strDestDomIntlFlag = Session.strDomIntlFlag;
Session.g_strTranslatedDestNbr = Session.strCalledNumber;
Session.g_strOutdialDestNbr = Session.strCalledNumber;
Session.g_nDialPlanId = Number(Session.s_strOutdialDialingPlan);
Session.g_strModOutdialFlag = Session.strModOutdialFlag;
Session.g_strOrigNbr = Session.s_strDefaultAni;
Session.g_strUsedDefaultANIFlag = "T";
Session.g_strConfirmationFlag = Session.strConfirmationFlag;
Session.g_strPrivateTalkFlag = Session.strPrivateTalkFlag;
Session.g_strModeratorKey = Session.strModeratorKey;
if ("T" == Session.strAnonymousFlag)
{
	Session.g_bAnonymousCaller = true;
}
// Phone A object
Session.g_oCallLegA.bReverseFromTo = false;
Session.g_oCallLegA.strFrom = "";
Session.g_oCallLegA.strTo = "";
Session.g_oCallLegA.strCallId = "";
Session.g_oCallLegA.strContact = "";
Session.g_oCallLegA.strContent = "";
Session.g_oCallLegA.strOriginalContent = "";
Session.g_oCallLegA.strContentType = "";
Session.g_oCallLegA.strCSeq = "";
Session.g_oCallLegA.strRecordRoute = "";
Session.g_oCallLegA.strRoute = "";
Session.g_oCallLegA.strVia = "";
Session.g_oCallLegA.nSessionTimer = "";
Session.g_oCallLegA.strRequestUri = "";
// Phone B object
Session.g_oCallLegB.bCurrentlyDialing = false;
Session.g_oCallLegB.bAttemptedToOutdial = false;
Session.g_oCallLegB.bConnected = false;
Session.g_oCallLegB.bCurrentlyInConf = false;
Session.g_oCallLegB.bReverseFromTo = false;
Session.g_oCallLegB.strSessionTimerFlag = "";
Session.g_oCallLegB.nSessionTimer = "";
Session.g_oCallLegB.nRingNoAnswerTime = "";
Session.g_oCallLegB.strCalledNumber = "";
Session.g_oCallLegB.strRequestUri = "";
Session.g_oCallLegB.strBackupRequestUri = "";
Session.g_oCallLegB.strCallId = "";
Session.g_oCallLegB.strContent = "";
Session.g_oCallLegB.strCSeq = "";
Session.g_oCallLegB.strFrom = "";
Session.g_oCallLegB.strTo = "";
Session.g_oCallLegB.strRoute = "";
Session.g_oCallLegB.strRecordRoute = "";
Session.g_oCallLegB.strContact = "";
Session.g_oCallLegB.nSetUpTime = 0;
Session.g_oCallLegB.nTearDownTime = 0;
//Init MS
js_initMS (Session.g_oMS, Session.s_strConfMsType);
js_initMS (Session.g_oSubConfMS, Session.s_strConfMsType);
js_initMS (Session.g_oTempConf, Session.s_strConfMsType);
js_initMS (Session.g_oMOH_MS, Session.s_strConfMsType);
js_initMS (Session.g_oIVR_MS, Session.s_strConfMsType);
//mediaserver object
Session.g_oMS.strEndPoint = "";
Session.g_oMS.strConnectionId = "";
Session.g_oMS.strCallId = "";
Session.g_oMS.strContent = "";
Session.g_oMS.strConferenceId = "";	//use through out
Session.g_oMS.strType = Session.s_strConfMsType;
Session.g_oMS.bMuteFlag = false;
Session.g_oMS.bDeafFlag = false;
Session.g_oMS.bCurrentlyInConf = false;
Session.g_oMS.bCurrentlyConnected = false;
Session.g_oMS.nPacketizationPeriod = Session.s_nPacketizationPeriod;
// Session.g_oMS.nConferenceMaxParties = Session.s_nConferenceMaxParties;
Session.g_oMS.nConferenceMaxTalkers = Session.s_nConferenceMaxTalkers;
Session.g_oMS.strCodec = Session.s_strCodec;
//ASN
Session.g_oMS.nNbrActiveSpeakers = Session.s_nNbrActiveSpeakers;
Session.g_oMS.nReportingInterval = Session.s_nReportingInterval;
Session.g_oMS.nDBThreshold = Session.s_nDBThreshold;
//AGC
Session.g_oMS.nAGCTargetLevelIn = Session.s_nAGCTargetLevelIn;
Session.g_oMS.nAGCMaxLevelIn = Session.s_nAGCMaxLevelIn;
Session.g_oMS.nAGCTargetLevelOut = Session.s_nAGCTargetLevelOut;
Session.g_oMS.nAGCMaxLevelOut = Session.s_nAGCMaxLevelOut;

//sub conference object
Session.g_oSubConfMS.strType = Session.s_strConfMsType;
if (Session.g_bHandOff && !Session.g_bHandBack)
{
	Session.g_oSubConfMS.strCodec = Session.s_strFailoverCodec;
}
else
{
	Session.g_oSubConfMS.strCodec = Session.s_strCodec;
}

//ASN
Session.g_oSubConfMS.nNbrActiveSpeakers = Session.s_nNbrActiveSpeakers;
Session.g_oSubConfMS.nReportingInterval = Session.s_nReportingInterval;
Session.g_oSubConfMS.nDBThreshold = Session.s_nDBThreshold;
//AGC
Session.g_oSubConfMS.nAGCTargetLevelIn = Session.s_nAGCTargetLevelIn;
Session.g_oSubConfMS.nAGCMaxLevelIn = Session.s_nAGCMaxLevelIn;
Session.g_oSubConfMS.nAGCTargetLevelOut = Session.s_nAGCTargetLevelOut;
Session.g_oSubConfMS.nAGCMaxLevelOut = Session.s_nAGCMaxLevelOut;

//temp conference mediaserver object
Session.g_oTempConf.strEndPoint = "";
Session.g_oTempConf.strConnectionId = "";
Session.g_oTempConf.strCallId = "";
Session.g_oTempConf.strContent = "";
Session.g_oTempConf.strConferenceId = "";	//use through out
Session.g_oTempConf.strType = Session.s_strConfMsType;
Session.g_oTempConf.bMuteFlag = false;
Session.g_oTempConf.bDeafFlag = false;
Session.g_oTempConf.bCurrentlyInConf = false;
Session.g_oTempConf.bCurrentlyConnected = false;
Session.g_oTempConf.nPacketizationPeriod = Session.s_nPacketizationPeriod;
// Session.g_oTempConf.nConferenceMaxParties = Session.s_nConferenceMaxParties;
Session.g_oTempConf.nConferenceMaxTalkers = Session.s_nConferenceMaxTalkers;
Session.g_oTempConf.strCodec = Session.s_strCodec;
//ASN
Session.g_oTempConf.nNbrActiveSpeakers = Session.s_nNbrActiveSpeakers;
Session.g_oTempConf.nReportingInterval = Session.s_nReportingInterval;
Session.g_oTempConf.nDBThreshold = Session.s_nDBThreshold;
//AGC
Session.g_oTempConf.nAGCTargetLevelIn = Session.s_nAGCTargetLevelIn;
Session.g_oTempConf.nAGCMaxLevelIn = Session.s_nAGCMaxLevelIn;
Session.g_oTempConf.nAGCTargetLevelOut = Session.s_nAGCTargetLevelOut;
Session.g_oTempConf.nAGCMaxLevelOut = Session.s_nAGCMaxLevelOut;

//music on hold mediaserver object
Session.g_oMOH_MS.strEndPoint = "";
Session.g_oMOH_MS.strConnectionId = "";
Session.g_oMOH_MS.strCallId = "";
Session.g_oMOH_MS.strContent = "";
Session.g_oMOH_MS.strConferenceId = "";	//use through out
Session.g_oMOH_MS.strType = Session.s_strMohMsType;
Session.g_oMOH_MS.bMuteFlag = false;
Session.g_oMOH_MS.bDeafFlag = false;
Session.g_oMOH_MS.bCurrentlyInConf = false;
Session.g_oMOH_MS.bCurrentlyConnected = false;
Session.g_oMOH_MS.nPacketizationPeriod = Session.s_nPacketizationPeriod;
// Session.g_oMOH_MS.nConferenceMaxParties = Session.s_nConferenceMaxParties;
Session.g_oMOH_MS.nConferenceMaxTalkers = Session.s_nConferenceMaxTalkers;
Session.g_oMOH_MS.strCodec = Session.s_strCodec;
//ASN
Session.g_oMOH_MS.nNbrActiveSpeakers = Session.s_nNbrActiveSpeakers;
Session.g_oMOH_MS.nReportingInterval = Session.s_nReportingInterval;
Session.g_oMOH_MS.nDBThreshold = Session.s_nDBThreshold;
//AGC
Session.g_oMOH_MS.nAGCTargetLevelIn = Session.s_nAGCTargetLevelIn;
Session.g_oMOH_MS.nAGCMaxLevelIn = Session.s_nAGCMaxLevelIn;
Session.g_oMOH_MS.nAGCTargetLevelOut = Session.s_nAGCTargetLevelOut;
Session.g_oMOH_MS.nAGCMaxLevelOut = Session.s_nAGCMaxLevelOut;

//music on hold mediaserver object
Session.g_oIVR_MS.strEndPoint = "";
Session.g_oIVR_MS.strConnectionId = "";
Session.g_oIVR_MS.strCallId = "";
Session.g_oIVR_MS.strContent = "";
Session.g_oIVR_MS.strConferenceId = "";	//use through out
Session.g_oIVR_MS.strType = Session.s_strIvrMsType;
Session.g_oIVR_MS.bMuteFlag = false;
Session.g_oIVR_MS.bDeafFlag = false;
Session.g_oIVR_MS.bCurrentlyInConf = false;
Session.g_oIVR_MS.bCurrentlyConnected = false;
Session.g_oIVR_MS.nPacketizationPeriod = Session.s_nPacketizationPeriod;
// Session.g_oIVR_MS.nConferenceMaxParties = Session.s_nConferenceMaxParties;
Session.g_oIVR_MS.nConferenceMaxTalkers = Session.s_nConferenceMaxTalkers;
Session.g_oIVR_MS.strCodec = Session.s_strCodec;
//ASN
Session.g_oIVR_MS.nNbrActiveSpeakers = Session.s_nNbrActiveSpeakers;
Session.g_oIVR_MS.nReportingInterval = Session.s_nReportingInterval;
Session.g_oIVR_MS.nDBThreshold = Session.s_nDBThreshold;
//AGC
Session.g_oIVR_MS.nAGCTargetLevelIn = Session.s_nAGCTargetLevelIn;
Session.g_oIVR_MS.nAGCMaxLevelIn = Session.s_nAGCMaxLevelIn;
Session.g_oIVR_MS.nAGCTargetLevelOut = Session.s_nAGCTargetLevelOut;
Session.g_oIVR_MS.nAGCMaxLevelOut = Session.s_nAGCMaxLevelOut;

if (Session.s_strMSRetryFlag == "T")
{
	Session.g_oMS.bRetry = true;
	Session.g_oSubConfMS.bRetry = true;
	Session.g_oTempConf.bRetry = true;
	Session.g_oMOH_MS.bRetry = true;
	Session.g_oIVR_MS.bRetry = true;
}
else
{
	Session.g_oMS.bRetry = false;
	Session.g_oSubConfMS.bRetry = false;
	Session.g_oTempConf.bRetry = false;
	Session.g_oMOH_MS.bRetry = false;
	Session.g_oIVR_MS.bRetry = true;
}]]></script>
          </scripts>
        </action>
        <action id="7" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=803 y=268 ?>
          <!--validate the passcode-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceAuthConfPassCode&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="109" stubbed="1"/>
            <result name="NonFirstCaller" link="130" stubbed="1" >f_nReturnCode == s_nNonFirstCaller</result>
            <result name="WFM" link="141" stubbed="1" >f_nReturnCode == s_nWaitForMod</result>
            <result name="Waif for conf resource" link="175" stubbed="0" >f_nReturnCode == 2</result>
            <result name="Inused -8" link="197" stubbed="1" >f_nReturnCode == -8</result>
            <result name="FirstCaller" link="286" stubbed="1" >f_nReturnCode == s_nFirstCaller</result>
            <result name="Special FirstCaller" link="130" stubbed="1" >f_nReturnCode == 3</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_disable_event();
Session.f_nReturnCode = -50;
//initialize may over written it, use the one from CC
Session.g_strPassCode = Session.strPassCode;  ]]></script>
            <script language="javascript" timing="last" ><![CDATA[/* dh: for ThirdParty, if we are dialing out a moderator, make him/her the subscriber as well */

if( 'T' == Session.strModOutdialFlag ) {
	Session.g_strIsSubscriberFlag = 'T' ;
}
if (Session.f_nReturnCode == Session.s_nWaitForMod)
{
	Session.g_bWaitForModerator = true;
}
else if (-5 == Session.f_nReturnCode)
{
	Session.g_strReturnMsg = "MAX ATTENDEES REACHED, UNABLE TO ADD PARTY TO THE CONFERENCE";
}
else if (-6 == Session.f_nReturnCode)
{
	Session.g_strReturnMsg = "CONFERENCE IS LOCKED, UNABLE TO ADD PARTY TO THE CONFERENCE";
}
else if (-13 == Session.f_nReturnCode)
{
	Session.g_strReturnMsg = "CONFERENCE IS DISABLED, UNABLE TO ADD PARTY TO THE CONFERENCE";
	Session.g_nTerminationReason = 29;
}
else if (-19 == Session.f_nReturnCode)
{
	Session.g_strReturnMsg = "INVALID ACCESS NUMBER, UNABLE TO ADD PARTY TO THE CONFERENCE";
	Session.g_nTerminationReason = 28;
}
else if (-20 == Session.f_nReturnCode)
{
	Session.g_strReturnMsg = "INVALID SUBSCRIBER ACCESS NUMBER, UNABLE TO ADD PARTY TO THE CONFERENCE";
	Session.g_nTerminationReason = 28;
}
else if (-22 == Session.f_nReturnCode)
{
		Server.logError("ERROR: INSUFFICIENT MS RESOURCE");
		Session.g_strReturnMsg = "INSUFFICIENT MS RESOURCE";
		Session.g_nTerminationReason = 30;
}
else
{
	Session.g_strReturnMsg = "VALIDATE PASSCODE FAILED, UNABLE TO ADD PARTY TO THE CONFERENCE";
}
if (Session.g_strCallerFirstName.length <= 0)
{
	Session.g_strCallerFirstName = Session.strCalledFirstName;
}
if (Session.g_strCallerLastName.length <= 0)
{
	Session.g_strCallerLastName = Session.strCalledLastName;
}
js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="17" plug-in="Pactolus.Branch.1" ><?xtml-editor x=142 y=1078 ?>
          <!--setup for conf party B Leg-->
          <results >
            <result name="Default" link="62" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("BEFORE TRANSLATE DEST : <" + Session.g_strTranslatedDestNbr + ">");	

Session.g_strTranslatedDestNbr = js_translate_destination(Session.s_strCustomerCode, Session.g_strTranslatedDestNbr, Session.g_strHomeCallingCode, Session.s_strVPNPrepend, Session.s_nVPN_DestLength);

Server.logInfo("AFTER TRANSLATED DEST : <" + Session.g_strTranslatedDestNbr + ">");



Server.logInfo("BEFORE g_strTranslatedDestNbr prepend : <" + Session.g_strTranslatedDestNbr + ">");

Session.g_strTranslatedDestNbr = js_prepend_digits(Session.g_strTranslatedDestNbr, Session.s_strDigitPrependToOutdial);

Server.logInfo("AFTER g_strTranslatedDestNbr prepend : <" + Session.g_strTranslatedDestNbr + ">");



// Phone B object

Session.g_oCallLegB.strSessionTimerFlag = Session.s_strSessionTimerFlag;

Session.g_oCallLegB.nSessionTimer = Session.s_nSessionTimerInterval;

Session.g_oCallLegB.nRingNoAnswerTime = Session.s_nRingNoAnswerTime;

Session.g_oCallLegB.strCalledNumber = Session.g_strTranslatedDestNbr;

Session.g_oCallLegB.strRequestUri = Session.s_strPrimaryPSX;

Session.g_oCallLegB.strBackupRequestUri = Session.s_strBackupPSX;

Session.g_strContact = "<sip:" + Session.s_strLocalHost;

if( Server.sipPort != 5060 )
{
  Session.g_strContact = Session.g_strContact + ":" + Server.sipPort + ">";
}
else
{
	Session.g_strContact += ">"
}
if (Session.g_strCallerFirstName.length <= 0)

{

	Session.g_strCallerFirstName = Session.strCalledFirstName;

}

if (Session.g_strCallerLastName.length <= 0)

{

	Session.g_strCallerLastName = Session.strCalledLastName;

}]]></script>
          </scripts>
        </action>
        <action id="21" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=334 y=1318 ?>
          <!--set time available for this caller-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;SetTimer&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="42" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (Result.id == 2)

{

	Server.logInfo("INFO: SUCCESS CONNECT PARTY TO THE CONFERENCE");

}

else if (Result.id == 3)

{

	Server.logError("ERROR: ERROR BRANCH CONNECT PARTY TO THE CONFERENCE.");

	Server.logError("ERROR: g_oMS.strCallId = " + Session.g_oMS.strCallId);

	Server.logError("ERROR: g_oMS.strConnectionId = " + Session.g_oMS.strConnectionId);

	Server.logError("ERROR: g_oMS.strEndPoint = " + Session.g_oMS.strEndPoint);

}

else if (Result.id == 4)

{

	Server.logError("ERROR: TIMEOUT BRANCH CONNECT PARTY TO THE CONFERENCE.");

	Server.logError("ERROR: g_oMS.strCallId = " + Session.g_oMS.strCallId);

	Server.logError("ERROR: g_oMS.strConnectionId = " + Session.g_oMS.strConnectionId);

	Server.logError("ERROR: g_oMS.strEndPoint = " + Session.g_oMS.strEndPoint);

}

else if (Result.id == 1)

{

	Server.logError("ERROR: DEFAULT BRANCH CONNECT PARTY TO THE CONFERENCE.");

	Server.logError("ERROR: g_oMS.strCallId = " + Session.g_oMS.strCallId);

	Server.logError("ERROR: g_oMS.strConnectionId = " + Session.g_oMS.strConnectionId);

	Server.logError("ERROR: g_oMS.strEndPoint = " + Session.g_oMS.strEndPoint);

}]]></script>
          </scripts>
        </action>
        <action id="25" plug-in="Standard.EndSession.1" ><?xtml-editor x=1046 y=140 ?>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nCallerCurrentState = Session.s_nStateEndCall;]]></script>
          </scripts>
        </action>
        <action id="26" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1441 y=950 ?>
          <!--FAIL to add a call party-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strConfControllerIpAddress" transaction="strTransactionId" message-name="s_strConfAddResponse" destination-port="nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="g_strSIPStatus"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
            <parameter tag="&quot;dialOutRequestId&quot;" value="g_lDialOutRequestId"/>
            <parameter tag="&quot;SIPCallId&quot;" value="g_oCallLegB.strCallId"/>
          </SOAP>
          <results >
            <result name="Default" link="55" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[switch (Session.g_strSIPStatus)
{
	case 301:
		Session.g_strReturnMsg = "FAIL TO ADD PARTY TO CONFERENCE: MOVED PERMANENTLY";
		break;
	case 302:
		Session.g_strReturnMsg = "FAIL TO ADD PARTY TO CONFERENCE: MOVED TEMPORARY";
		break;
	case 305:
		Session.g_strReturnMsg = "FAIL TO ADD PARTY TO CONFERENCE: USE PROXY";
		break;
	case 380:
		Session.g_strReturnMsg = "FAIL TO ADD PARTY TO CONFERENCE: ALTERNATIVE SERVICE";
		break;
	case 400:
		Session.g_strReturnMsg = "FAIL TO ADD PARTY TO CONFERENCE: BAD REQUEST";
		break;
	case 401:
		Session.g_strReturnMsg = "FAIL TO ADD PARTY TO CONFERENCE: UNAUTHORIZE";
		break;
	case 402:
		Session.g_strReturnMsg = "FAIL TO ADD PARTY TO CONFERENCE: PAYMENT REQUIRED";
		break;
	case 403:
		Session.g_strReturnMsg = "FAIL TO ADD PARTY TO CONFERENCE: FORBIDDEN";
		break;
	case 404:
		Session.g_strReturnMsg = "FAIL TO ADD PARTY TO CONFERENCE: NOT FOUND";
		break;
	case 405:
		Session.g_strReturnMsg = "FAIL TO ADD PARTY TO CONFERENCE: METHOD NOT ALLOWED";
		break;
	case 406:
		Session.g_strReturnMsg = "FAIL TO ADD PARTY TO CONFERENCE: NOT ACCEPTABLE";
		break;
	case 407:
		Session.g_strReturnMsg = "FAIL TO ADD PARTY TO CONFERENCE: PROXY AUTHENTICATION REQUIRED";
		break;
	case 408:
		Session.g_strReturnMsg = "FAIL TO ADD PARTY TO CONFERENCE: REQUEST TIMEOUT";
		break;
	case 409:
		Session.g_strReturnMsg = "FAIL TO ADD PARTY TO CONFERENCE: CONFLICT";
		break;
	case 410:
		Session.g_strReturnMsg = "FAIL TO ADD PARTY TO CONFERENCE: GONE";
		break;
	case 411:
		Session.g_strReturnMsg = "FAIL TO ADD PARTY TO CONFERENCE: LENGTH REQUIRED";
		break;
	case 413:
		Session.g_strReturnMsg = "FAIL TO ADD PARTY TO CONFERENCE: REQUEST ENTITY TOO LARGE";
		break;
	case 414:
		Session.g_strReturnMsg = "FAIL TO ADD PARTY TO CONFERENCE: REQUEST URI TOO LONG";
		break;
	case 415:
		Session.g_strReturnMsg = "FAIL TO ADD PARTY TO CONFERENCE: UNSUPPORTED MEDIA TYPE";
		break;
	case 420:
		Session.g_strReturnMsg = "FAIL TO ADD PARTY TO CONFERENCE: BAD EXTENSION";
		break;
	case 480:
		Session.g_strReturnMsg = "FAIL TO ADD PARTY TO CONFERENCE: TEMPORARTY UNAVAILABLE";
		break;
	case 481:
		Session.g_strReturnMsg = "FAIL TO ADD PARTY TO CONFERENCE: CALL LEG/TRANSACTION DOES NOT EXIST";
		break;
	case 482:
		Session.g_strReturnMsg = "FAIL TO ADD PARTY TO CONFERENCE: LOOP DETECTED";
		break;
	case 483:
		Session.g_strReturnMsg = "FAIL TO ADD PARTY TO CONFERENCE: TOO MANY HOPS";
		break;
	case 484:
		Session.g_strReturnMsg = "FAIL TO ADD PARTY TO CONFERENCE: ADDRESS INCOMPLETE";
		break;
	case 485:
		Session.g_strReturnMsg = "FAIL TO ADD PARTY TO CONFERENCE: AMBIGUOUS";
		break;
	case 486:
		Session.g_strReturnMsg = "FAIL TO ADD PARTY TO CONFERENCE: BUSY HERE";
		break;
	case 487:
		Session.g_strReturnMsg = "FAIL TO ADD PARTY TO CONFERENCE: REQUEST TERMINATED";
		break;
	case 488:
		Session.g_strReturnMsg = "FAIL TO ADD PARTY TO CONFERENCE: NOT ACCEPTABLE";
		break;
	case 500:
		Session.g_strReturnMsg = "FAIL TO ADD PARTY TO CONFERENCE: SERVER INTERNAL ERROR";
		break;
	case 501:
		Session.g_strReturnMsg = "FAIL TO ADD PARTY TO CONFERENCE: NOT IMPLEMENTED";
		break;
	case 502:
		Session.g_strReturnMsg = "FAIL TO ADD PARTY TO CONFERENCE: BAD GATEWAY";
		break;
	case 503:
		Session.g_strReturnMsg = "FAIL TO ADD PARTY TO CONFERENCE: SERVICE UNAVAILABLE";
		break;
	case 504:
		Session.g_strReturnMsg = "FAIL TO ADD PARTY TO CONFERENCE: SERVER TIMEOUT";
		break;
	case 505:
		Session.g_strReturnMsg = "FAIL TO ADD PARTY TO CONFERENCE: VERSION NOT SUPPORTED";
		break;
	case 600:
		Session.g_strReturnMsg = "FAIL TO ADD PARTY TO CONFERENCE: BUSY EVERYWHERE";
		break;
	case 603:
		Session.g_strReturnMsg = "FAIL TO ADD PARTY TO CONFERENCE: DECLINE";
		break;
	case 604:
		Session.g_strReturnMsg = "FAIL TO ADD PARTY TO CONFERENCE: DOES NOT EXIST ANYWHERE";
		break;
	case 606:
		Session.g_strReturnMsg = "FAIL TO ADD PARTY TO CONFERENCE: NOT ACCEPTABLE";
		break;
	default:
		Session.g_strReturnMsg = "FAILURE TO ADD PARTY TO THE CONFERENCE";
		break;				
}]]></script>
          </scripts>
        </action>
        <action id="34" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=2922 y=3048 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="35" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=551 y=145 ?>
          <!--"psAPISceInitConfOutdialSession"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceInitConfOutdialSession&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="109" stubbed="0"/>
            <result name="SUCCESS" link="7" stubbed="1" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Session.f_nReturnCode != 0)

{

	Session.g_strReturnMsg = "INITIALIZE SESSION FAILED, UNABLE TO ADD PARTY TO THE CONFERENCE";

}]]></script>
          </scripts>
        </action>
        <action id="42" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=828 y=1583 ?>
          <!--Hang up caller-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpCaller&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="127" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 1;]]></script>
          </scripts>
        </action>
        <action id="55" plug-in="Standard.EndSession.1" ><?xtml-editor x=1657 y=952 ?></action>
        <action id="62" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=394 y=1070 ?>
          <!--dialing out to add a call party-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strConfControllerIpAddress" transaction="strTransactionId" message-name="s_strConfAddResponse" destination-port="nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="100"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
            <parameter tag="&quot;dialOutRequestId&quot;" value="g_lDialOutRequestId"/>
            <parameter tag="&quot;SIPCallId&quot;" value="g_oCallLegB.strCallId"/>
          </SOAP>
          <results >
            <result name="Default" link="231" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "DIALING OUT TO PARTY";]]></script>
          </scripts>
        </action>
        <action id="63" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1489 y=1210 ?>
          <!--No answer-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strConfControllerIpAddress" transaction="strTransactionId" message-name="s_strConfAddResponse" destination-port="nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="408"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
            <parameter tag="&quot;dialOutRequestId&quot;" value="g_lDialOutRequestId"/>
            <parameter tag="&quot;SIPCallId&quot;" value="g_oCallLegB.strCallId"/>
          </SOAP>
          <results >
            <result name="Default" link="55" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "OUTDIAL: NO ANSWER";
Session.g_nTerminationReason = 11;]]></script>
          </scripts>
        </action>
        <action id="64" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1738 y=1079 ?>
          <!--prompting party to join-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strConfControllerIpAddress" transaction="strTransactionId" message-name="s_strConfAddResponse" destination-port="nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="900"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
            <parameter tag="&quot;dialOutRequestId&quot;" value="g_lDialOutRequestId"/>
            <parameter tag="&quot;SIPCallId&quot;" value="g_oCallLegB.strCallId"/>
          </SOAP>
          <results >
            <result name="Default" link="334" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "PROMPTING PARTY TO JOIN";]]></script>
          </scripts>
        </action>
        <action id="65" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=598 y=1583 ?>
          <!--party declined-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strConfControllerIpAddress" transaction="strTransactionId" message-name="s_strConfAddResponse" destination-port="nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="902"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
            <parameter tag="&quot;dialOutRequestId&quot;" value="g_lDialOutRequestId"/>
            <parameter tag="&quot;SIPCallId&quot;" value="g_oCallLegB.strCallId"/>
          </SOAP>
          <results >
            <result name="Default" link="42" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "OUTDIAL: PARTY DECLINED";]]></script>
          </scripts>
        </action>
        <action id="66" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=596 y=1347 ?>
          <!--party accepted-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strConfControllerIpAddress" transaction="strTransactionId" message-name="s_strConfAddResponse" destination-port="nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="901"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
            <parameter tag="&quot;dialOutRequestId&quot;" value="g_lDialOutRequestId"/>
            <parameter tag="&quot;SIPCallId&quot;" value="g_oCallLegB.strCallId"/>
          </SOAP>
          <results >
            <result name="Default" link="234" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "OUTDIAL: PARTY ACCEPTED";]]></script>
          </scripts>
        </action>
        <action id="74" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=100 y=1317 ?>
          <!--FAIL to add a call party-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strConfControllerIpAddress" transaction="strTransactionId" message-name="s_strConfAddResponse" destination-port="nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="-999"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
            <parameter tag="&quot;dialOutRequestId&quot;" value="g_lDialOutRequestId"/>
            <parameter tag="&quot;SIPCallId&quot;" value="g_oCallLegB.strCallId"/>
          </SOAP>
          <results >
            <result name="Default" link="21" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = " FAILURE TO ADD PARTY TO THE CONFERENCE";]]></script>
          </scripts>
        </action>
        <action id="95" plug-in="Pactolus.Branch.1" ><?xtml-editor x=114 y=2903 ?>
          <!--first caller?-->
          <results >
            <result name="Default" link="123" stubbed="0"/>
            <result name="s_nFirstCaller" link="121" stubbed="0" >g_bFirstCaller == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_oMS.bMuteFlag = true;
Session.g_oMS.bDeafFlag = true;

var mySdp = new Sdp(Session.g_oCallLegB.strContent);
Server.logInfo("MY SDP IS: " + mySdp);
var myMedia = new SdpMedia (mySdp.media);
Server.logInfo("MY MEDIA IS: " + myMedia);
Server.logInfo("MY myMedia.rtpMaps.length: " + myMedia.rtpMaps.length);
// if (1 == myMedia.rtpMaps.length)
{
	switch(myMedia.rtpMaps[0].type)
	{
		case 0:
				Session.g_oMS.strCodec = "PCMU";
				break;
		case 2:
				Session.g_oMS.strCodec = "G.726-32";
				break;
		case 4:
				Session.g_oMS.strCodec = "G.723";
				break;
		case 8:
				Session.g_oMS.strCodec = "PCMA";
				break;
		case 15:
				Session.g_oMS.strCodec = "G.728";
				break;
		case 18:
				Session.g_oMS.strCodec = "G.729";
				break;
		default:
				break;
	}
}
Server.logInfo("MY Codec IS: " + Session.g_oMS.strCodec);]]></script>
          </scripts>
        </action>
        <action id="99" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=574 y=2841 ?>
          <!--Hang up caller-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpCaller&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="25" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 35;]]></script>
          </scripts>
        </action>
        <action id="105" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=2696 y=1870 ?>
          <!--FAIL to add a call party-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strConfControllerIpAddress" transaction="strTransactionId" message-name="s_strConfAddResponse" destination-port="nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="-999"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
            <parameter tag="&quot;dialOutRequestId&quot;" value="g_lDialOutRequestId"/>
            <parameter tag="&quot;SIPCallId&quot;" value="g_oCallLegB.strCallId"/>
          </SOAP>
          <results >
            <result name="Default" link="25" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = " FAILURE TO ADD PARTY TO THE CONFERENCE";]]></script>
          </scripts>
        </action>
        <action id="109" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=805 y=138 ?>
          <!--FAIL to add a call party-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strConfControllerIpAddress" transaction="strTransactionId" message-name="s_strConfAddResponse" destination-port="nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="-999"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
            <parameter tag="&quot;dialOutRequestId&quot;" value="g_lDialOutRequestId"/>
            <parameter tag="&quot;SIPCallId&quot;" value="g_oCallLegB.strCallId"/>
          </SOAP>
          <results >
            <result name="Default" link="25" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
        </action>
        <action id="121" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=336 y=3008 ?>
          <!--AddMemberToConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
            <parameter >g_oCallLegB</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="235" stubbed="0"/>
            <result name="FAILURE" link="99" stubbed="1" >f_nReturnCode == s_nFailure</result>
            <result name="CALLER HUNG UP" link="344" stubbed="1" >f_nReturnCode == s_nCallerHungup</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (3 == Result.id)

{

	Session.g_nTerminationReason = 1;

}]]></script>
          </scripts>
        </action>
        <action id="123" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=324 y=2849 ?>
          <!--AddMemberToConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
            <parameter >g_oCallLegB</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="235" stubbed="1"/>
            <result name="FAILURE" link="99" stubbed="0" >f_nReturnCode == s_nFailure</result>
            <result name="CALLER HUNGUP" link="344" stubbed="0" >f_nReturnCode == s_nCallerHungup</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (3 == Result.id)

{

	Session.g_nTerminationReason = 1;

}]]></script>
          </scripts>
        </action>
        <action id="126" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1147 y=1021 ?>
          <!--outdial party to ms-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;OutdialPartyToMS&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oCallLegB</parameter>
            <parameter >g_oMS</parameter>
            <parameter >g_lOutdialStartTime</parameter>
            <parameter >g_lOutdialConnectTime</parameter>
            <parameter >g_strSIPStatus</parameter>
            <parameter >g_strOrigNbr</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="26" stubbed="1"/>
            <result name="0 - SUCCESS" link="296" stubbed="0" >f_nReturnCode == f_nSUCCESS</result>
            <result name="1 - RING NO ANSWER" link="63" stubbed="0" >f_nReturnCode == f_nRINGNOANSWER</result>
            <result name="2 - BUSY" link="229" stubbed="0" >f_nReturnCode == f_nBUSY</result>
            <result name="-5 - RESOURCE UNAVAIL" link="289" stubbed="1" >f_nReturnCode == f_nResourceUnavail</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[var myUri = new SipRequestUri(Session.g_oCallLegB.strRequestUri);

if (myUri.url.dtg == undefined)

{

	Session.g_oCallLegB.strDestTrunkGroup = "";

}

else

{

	Session.g_oCallLegB.strDestTrunkGroup = myUri.url.dtg;

}



Server.logInfo("INFO: CALING LIBOUTDIAL RETURN: " + Session.f_nReturnCode);

Server.logInfo("CALLING js_calculate_uri_and_route");

Server.logInfo("BEFORE contact: " + Session.g_oCallLegB.strContact);

Server.logInfo("BEFORE record route: " + Session.g_oCallLegB.strRecordRoute);

Server.logInfo("BEFORE request Uri: " + Session.g_oCallLegB.strRequestUri);

Server.logInfo("BEFORE route: " + Session.g_oCallLegB.strRoute);

var bDialIn = false;

js_calculate_uri_and_route(bDialIn, Session.s_strSipVersion, Session.g_oCallLegB.strFrom, Session.g_oCallLegB.strContact, Session.g_oCallLegB.strRecordRoute, Session.g_oCallLegB.strRequestUri, Session.g_oCallLegB.strRoute);

Server.logInfo("AFTER contact: " + Session.g_oCallLegB.strContact);

Server.logInfo("AFTER record route: " + Session.g_oCallLegB.strRecordRoute);

Server.logInfo("AFTER request Uri: " + Session.g_oCallLegB.strRequestUri);

Server.logInfo("AFTER route: " + Session.g_oCallLegB.strRoute);

Server.logInfo("Call leg B request Uri is: " + Session.g_oCallLegB.strRequestUri);
if (1 == Result.id)
{
	Session.g_nTerminationReason = 34;
}
else if (5 == Result.id)
{
	Session.g_nTerminationReason = 30;
}]]></script>
          </scripts>
        </action>
        <action id="127" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1056 y=1582 ?>
          <!--DeleteMSConnection-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DeleteMSConnection&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="25" stubbed="1"/>
          </results>
        </action>
        <action id="128" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1299 y=2485 ?>
          <!--DeleteMSConnection-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DeleteMSConnection&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="95" stubbed="1"/>
          </results>
        </action>
        <action id="130" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1093 y=234 ?>
          <!--conferenceResource == null?-->
          <results >
            <result name="Default" link="141" stubbed="1"/>
            <result name="conferenceResource == null" link="109" stubbed="1" >g_strConfResource match "null"

OR g_bNullString == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (Session.g_strConfResource.length <= 0)
{
	Session.g_bNullString = true;
	Session.g_nErrorMsgNumber = 4014;
	Session.g_strReturnMsg = "NULL CONFERENCE RESOURCE, UNABLE TO ADD PARTY TO THE CONFERENCE";
	if (3 == Session.f_nReturnCode)
		Server.logError("ERROR: THE FIRST CALLER and NO NEED TO GET CONFERENCE ENDPOINT, BUT CONF RESOURCE IS NULL: " + Session.g_strConfResource);
	else
		Server.logError("ERROR: NOT THE FIRST CALLER, BUT CONF RESOURCE IS NULL: " + Session.g_strConfResource);
}
else
{
	Session.g_bNullString = false;
	Session.g_oMS.strConferenceId = Session.g_strConfResource;
}]]></script>
          </scripts>
        </action>
        <action id="134" plug-in="Pactolus.Branch.1" ><?xtml-editor x=318 y=146 ?>
          <!--valid dest length-->
          <results >
            <result name="Default" link="109" stubbed="1"/>
            <result name="valid dest == true and no access nbr" link="35" stubbed="0" >f_bValidDest == true

AND f_bHasAccessNumber == false</result>
            <result name="valid dest == true and has access nbr" link="195" stubbed="0" >f_bValidDest == true

AND f_bHasAccessNumber == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (1 == Result.id)

{

	Session.g_strReturnMsg = "FAIL TO ADD PARTY,  INVALID DESTINATION.";

}]]></script>
          </scripts>
        </action>
        <action id="136" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=822 y=2526 ?>
          <!--"RecordCallerName"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;RecordCallerName&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="139" stubbed="0"/>
          </results>
        </action>
        <action id="137" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1300 y=2581 ?>
          <!--WaitForModerator-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;WaitForModerator&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="201" stubbed="0"/>
          </results>
        </action>
        <action id="139" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1056 y=2522 ?>
          <!--wait for mod?-->
          <results >
            <result name="Default" link="128" stubbed="0"/>
            <result name="waitformod==true" link="137" stubbed="0" >g_bWaitForModerator == true</result>
            <result name="waifforres==true" link="177" stubbed="1" >f_bIsWaitingForConfRes == true</result>
          </results>
        </action>
        <action id="140" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1779 y=2702 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
        </action>
        <action id="141" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=130 y=945 ?>
          <!--psAPISceConfAuthDest-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceConfAuthDest&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="109" stubbed="1"/>
            <result name="SUCCESS" link="17" stubbed="0" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (-3 == Session.f_nReturnCode)

{

	Session.g_strReturnMsg = "MAX ATTENDEES REACHED, UNABLE TO ADD PARTY TO THE CONFERENCE";

}

else if (-2 == Session.f_nReturnCode)

{

	Session.g_strReturnMsg = "INSUFFICIENT DIGIT, UNABLE TO ADD PARTY TO THE CONFERENCE";

}

else if (-1 == Session.f_nReturnCode)

{

	Session.g_strReturnMsg = "RESTRICTED DESTINATION, UNABLE TO ADD PARTY TO THE CONFERENCE";

}

else if (-99 == Session.f_nReturnCode)

{

	Session.g_strReturnMsg = "AUTHORIZE DESTINATION FAILED, UNABLE TO ADD PARTY TO THE CONFERENCE";

}

var myDest = new String(Session.g_strOutdialDestNbr);
Server.logInfo("DESTINATION NUMBER IS: " + myDest);
if ( 0 == myDest.indexOf("011") )
{
	Server.logInfo("INTERNATIONAL DESTINATION NUMBER");
	myDest = myDest.slice(3);
	if ( '3' == myDest.charAt(0) && '3' == myDest.charAt(1) )
	{
		Server.logInfo("FRENCH COUNTRY CODE, SET LANGUAGE TO fre");
		Session.g_strLanguage = "fre";
	}
	
}]]></script>
          </scripts>
        </action>
        <action id="143" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2478 y=1076 ?>
          <!--play DTMF-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="0" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >f_oDigit[0]</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >f_oDigit[1]</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >f_oDigit[2]</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >f_oDigit[3]</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >f_oDigit[4]</audio>
          </play>
          <results >
            <result name="Default" link="145" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[var i = 0;



//initialize to silence

for (i = 0; i < 5; i++)

{

	Session.f_oDigit[i] = 99;

}



var strExt = new String(Session.strExtNumber);

// parse through the digit

for (i = 0; i < strExt.length; i++)

{

	switch (strExt.charAt(i))

	{

		case "0":

			Session.f_oDigit[i] = 200;

			break;

		case "1":

			Session.f_oDigit[i] = 201;

			break;

		case "2":

			Session.f_oDigit[i] = 202;

			break;

		case "3":

			Session.f_oDigit[i] = 203;

			break;

		case "4":

			Session.f_oDigit[i] = 204;

			break;

		case "5":

			Session.f_oDigit[i] = 205;

			break;

		case "6":

			Session.f_oDigit[i] = 206;

			break;

		case "7":

			Session.f_oDigit[i] = 207;

			break;

		case "8":

			Session.f_oDigit[i] = 208;

			break;

		case "9":

			Session.f_oDigit[i] = 209;

			break;

		default:

			Session.f_oDigit[i] = 99;

			break;

	}

}]]></script>
          </scripts>
        </action>
        <action id="144" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1949 y=1081 ?>
          <!--has ext?-->
          <results >
            <result name="Default" link="220" stubbed="1"/>
            <result name="strExtNumber&gt;0" link="228" stubbed="0" >f_bHasExt == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (Session.strExtNumber.length > 0 && Session.strExtNumber != "0")

{

	Session.f_bHasExt = true;

}

else

{

	Session.f_bHasExt = false;

}

// Hard code 9 times for ThirdParty 03/26/2004

Session.f_sMaxRetry = 9;

// Session.f_sMaxRetry = Session.g_nMaxRetryAllowed;]]></script>
          </scripts>
        </action>
        <action id="145" plug-in="Pactolus.Sleep.1" ><?xtml-editor x=2707 y=1076 ?>
          <!--5 secs-->
          <sleep xmlns="urn:www.pactolus.com:xtml:application" duration="5"/>
          <results >
            <result name="Default" link="220" stubbed="1"/>
          </results>
        </action>
        <action id="146" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=614 y=1725 ?>
          <!--No answer-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strConfControllerIpAddress" transaction="strTransactionId" message-name="s_strConfAddResponse" destination-port="nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="408"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
            <parameter tag="&quot;dialOutRequestId&quot;" value="g_lDialOutRequestId"/>
            <parameter tag="&quot;SIPCallId&quot;" value="g_oCallLegB.strCallId"/>
          </SOAP>
          <results >
            <result name="Default" link="42" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "OUTDIAL: NO ANSWER";]]></script>
          </scripts>
        </action>
        <action id="154" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=873 y=3011 ?>
          <!--play join as prompt-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;PlayJoinAsPrompt&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="333" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_disable_event();]]></script>
          </scripts>
        </action>
        <action id="155" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1355 y=2859 ?>
          <!--play current number of participant?-->
          <results >
            <result name="Default" link="168" stubbed="1"/>
            <result name="g_strPlayPartyCountFlag == &quot;T&quot;" link="167" stubbed="1" >g_strPlayPartyCountFlag match "T"</result>
          </results>
        </action>
        <action id="156" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2966 y=3525 ?>
          <!--Play Join Tone to conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;PlayPromptToConference&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
            <parameter >g_strLanguage</parameter>
            <parameter >s_nPromptArrivalTone</parameter>
          </function>
          <results >
            <result name="Default" link="161" stubbed="1"/>
          </results>
        </action>
        <action id="157" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2699 y=3466 ?>
          <!--play tone or name?-->
          <results >
            <result name="Default" link="161" stubbed="1"/>
            <result name="play tone - 1" link="156" stubbed="0" >g_nArriveDepartOption == 1</result>
            <result name="play name - 3" link="162" stubbed="0" >g_nArriveDepartOption == 3</result>
          </results>
        </action>
        <action id="158" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=3183 y=3635 ?>
          <!--xxx has joined-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="&quot;*&quot;" endpoint="g_oMS.strConferenceId" callid="g_oMS.strCallId" repeat="1" timeout="8" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="url" >g_strCallerRecordedName</audio>
            <audio type="index" >938</audio>
          </play>
          <results >
            <result name="Default" link="161" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="160" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2499 y=2539 ?>
          <!--party join to conf controller-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;PartyJoin&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="174" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[js_disable_event();]]></script>
          </scripts>
        </action>
        <action id="161" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=3189 y=3521 ?>
          <!--set DTMF Detection ON-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;SetDTMFOn&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="254" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[var myContent = new Sdp(Session.g_oMS.strContent);
Session.g_strMediaServerIP = myContent.connection.address;
Server.logInfo("ADD PARTY TO MEDIASERVER IP: " + Session.g_strMediaServerIP);]]></script>
          </scripts>
        </action>
        <action id="162" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2965 y=3639 ?>
          <!--null string-->
          <results >
            <result name="Default" link="158" stubbed="0"/>
            <result name="f_bNullString == true" link="156" stubbed="1" >f_bNullString == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("RECORDED NAME IS:  " + Session.g_strCallerRecordedName);

Server.logInfo("RECORDED NAME LENGTH IS:  " + Session.g_nRecordNameLength);

if (Session.g_nRecordNameLength <= 0)

{

	Session.f_bNullString = true;

}

else

{

	Session.f_bNullString = false;

}]]></script>
          </scripts>
        </action>
        <action id="163" plug-in="Pactolus.Branch.1" ><?xtml-editor x=3205 y=2536 ?>
          <!--subscriber?-->
          <results >
            <result name="Default" link="222" stubbed="1"/>
            <result name="subscriber and non first caller" link="164" stubbed="0" >g_strIsSubscriberFlag match "T"

AND g_bFirstCaller == false</result>
            <result name="subscriber and first caller" link="173" stubbed="0" >g_strIsSubscriberFlag match "T"

AND g_bFirstCaller == true</result>
          </results>
        </action>
        <action id="164" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=3444 y=2521 ?>
          <!--GetAndPlayBalance-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;GetAndPlayBalance&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="222" stubbed="1"/>
          </results>
        </action>
        <action id="165" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2073 y=2542 ?>
          <!--there is-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >925</audio>
            <audio type="number" >1</audio>
            <audio type="index" >927</audio>
            <audio type="index" >929</audio>
          </play>
          <results >
            <result name="Default" link="168" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="166" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2087 y=2691 ?>
          <!--there are-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >926</audio>
            <audio type="number" >f_nCallLegCount</audio>
            <audio type="index" >928</audio>
            <audio type="index" >929</audio>
          </play>
          <results >
            <result name="Default" link="168" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_nCallLegCount = Session.g_nCurrentNbrCallegs - 1;]]></script>
          </scripts>
        </action>
        <action id="167" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1812 y=2483 ?>
          <!--participants > 1-->
          <results >
            <result name="Default" link="172" stubbed="0"/>
            <result name="currentNbrCallLeg == 2" link="165" stubbed="0" >g_nCurrentNbrCallegs == 2</result>
            <result name="currentNbrCallLeg &gt; 2" link="166" stubbed="0" >g_nCurrentNbrCallegs &gt; 2</result>
          </results>
        </action>
        <action id="168" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2283 y=2540 ?>
          <!--silence-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="1" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >s_nPromptSilence</audio>
          </play>
          <results >
            <result name="Default" link="160" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="170" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2483 y=3467 ?>
          <!--non first caller-->
          <results >
            <result name="Default" link="157" stubbed="0"/>
            <result name="g_bFirstCaller" link="157" stubbed="1" >g_bFirstCaller == true</result>
          </results>
        </action>
        <action id="172" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2062 y=2394 ?>
          <!--you are the first one-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >nPromptFirstCaller</audio>
          </play>
          <results >
            <result name="Default" link="168" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="173" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=3458 y=2651 ?>
          <!--502: Your account balance is ...-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >503</audio>
            <audio type="currency" unit="" >g_fPrepaidBalance</audio>
          </play>
          <results >
            <result name="Default" link="222" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="174" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2963 y=2540 ?>
          <!--prepaid conference-->
          <results >
            <result name="Default" link="222" stubbed="1"/>
            <result name="billing type == 1?" link="163" stubbed="0" >g_nBillingType == 1</result>
          </results>
        </action>
        <action id="175" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1113 y=365 ?>
          <results >
            <result name="Default" link="141" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_bIsWaitingForConfRes = true;]]></script>
          </scripts>
        </action>
        <action id="176" plug-in="Pactolus.Sleep.1" ><?xtml-editor x=2165 y=1482 ?>
          <!--2 secs-->
          <sleep xmlns="urn:www.pactolus.com:xtml:application" duration="2"/>
          <results >
            <result name="Default" link="183" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (Session.f_bPlayPleaseHold == true)

{

	Session.f_bPlayPleaseHold = false;

}

else if(Session.f_bPlayPleaseHold == false)

{

	Session.f_bPlayPleaseHold = true;

}]]></script>
          </scripts>
        </action>
        <action id="177" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1682 y=1629 ?>
          <!--exceed max retry?-->
          <results >
            <result name="Default" link="176" stubbed="1"/>
            <result name="WaitForResCounter &gt; s_nMax?" link="180" stubbed="0" >f_nWaitForResCounter &gt; s_nMaxRetryWaitConfRes</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_nWaitForResCounter++;

Session.g_strRetryFlag = "T";]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (2 == Result.id)

{

	Session.g_nTerminationReason = 2;

	Session.g_nErrorMsgNumber = 4012;  //exceed max wait for conf resource

	Server.logError("ERROR: EXCEED MAX WAIT FOR CONFERENCE RESOURCE.");

}]]></script>
          </scripts>
        </action>
        <action id="178" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1901 y=1491 ?>
          <!--play hold?-->
          <results >
            <result name="Default" link="176" stubbed="0"/>
            <result name="f_bPlayPleaseHold == true" link="179" stubbed="0" >f_bPlayPleaseHold == true</result>
          </results>
        </action>
        <action id="179" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2178 y=1601 ?>
          <!--please hold-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >898</audio>
          </play>
          <results >
            <result name="Default" link="176" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_bPlayPleaseHold = false;]]></script>
          </scripts>
        </action>
        <action id="180" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1921 y=1699 ?>
          <!--could not be add-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >301</audio>
            <audio type="index" >874</audio>
            <audio type="index" >361</audio>
          </play>
          <results >
            <result name="Default" link="182" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="181" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1318 y=2697 ?>
          <!--please hold to be add to conf-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >871</audio>
          </play>
          <results >
            <result name="Default" link="177" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="182" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2178 y=1759 ?>
          <!--Hang up caller-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpCaller&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="184" stubbed="0"/>
          </results>
        </action>
        <action id="183" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2415 y=1481 ?>
          <!--validate the passcode-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceAuthConfPassCode&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="180" stubbed="1"/>
            <result name="WFM" link="216" stubbed="0" >f_nReturnCode == s_nWaitForMod</result>
            <result name="NonFirstCaller" link="321" stubbed="0" >f_nReturnCode == s_nNonFirstCaller</result>
            <result name="Waif for conf resource" link="177" stubbed="1" >f_nReturnCode == 2</result>
            <result name="Inused -8" link="199" stubbed="0" >f_nReturnCode == -8</result>
            <result name="FirstCaller" link="327" stubbed="1" >f_nReturnCode == s_nFirstCaller</result>
            <result name="Special FirstCaller" link="321" stubbed="1" >f_nReturnCode == 3</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_disable_event();]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Session.f_nReturnCode == Session.s_nWaitForMod)

{

	Session.g_bWaitForModerator = true;

}

else if (-5 == Session.f_nReturnCode)

{

	Session.g_strReturnMsg = "MAX ATTENDEES REACHED, UNABLE TO ADD PARTY TO THE CONFERENCE";

}

else if (-6 == Session.f_nReturnCode)

{

	Session.g_strReturnMsg = "CONFERENCE IS LOCKED, UNABLE TO ADD PARTY TO THE CONFERENCE";

}

else if (-13 == Session.f_nReturnCode)

{

	Session.g_strReturnMsg = "CONFERENCE IS DISABLED, UNABLE TO ADD PARTY TO THE CONFERENCE";

	Session.g_nTerminationReason = 29;

}

else if (-19 == Session.f_nReturnCode)

{

	Session.g_strReturnMsg = "INVALID ACCESS NUMBER, UNABLE TO ADD PARTY TO THE CONFERENCE";

	Session.g_nTerminationReason = 28;

}

else if (-20 == Session.f_nReturnCode)

{

	Session.g_strReturnMsg = "INVALID SUBSCRIBER ACCESS NUMBER, UNABLE TO ADD PARTY TO THE CONFERENCE";

	Session.g_nTerminationReason = 28;

}

else if (-22 == Session.f_nReturnCode)

{
		Server.logError("ERROR: INSUFFICIENT MS RESOURCE");
		
		Session.g_strReturnMsg = "INSUFFICIENT MS RESOURCE";

		Session.g_nTerminationReason = 30;
				
}

else

{

	Session.g_strReturnMsg = "VALIDATE PASSCODE FAILED, UNABLE TO ADD PARTY TO THE CONFERENCE";

}

if (Session.g_strCallerFirstName.length <= 0)

{

	Session.g_strCallerFirstName = Session.strCalledFirstName;

}

if (Session.g_strCallerLastName.length <= 0)

{

	Session.g_strCallerLastName = Session.strCalledLastName;

}

js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="184" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2417 y=1761 ?>
          <!--DeleteMSConnection-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DeleteMSConnection&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="105" stubbed="0"/>
          </results>
        </action>
        <action id="185" plug-in="Pactolus.JavaStaticMethod.1" ><?xtml-editor x=1101 y=512 ?>
          <!--"psAPISceConfCleanup"-->
          <java xmlns="urn:www.pactolus.com:xtml:application" class="&quot;com.pactolus.conferencing.psAPISceConfCleanup&quot;" method="&quot;cleanupCallLeg&quot;" timeout="s_nTimeout" return="" method-return-var="f_nReturnCode" method-return-type="0" >
            <parameter type="in" var-type="unknown" >g_strDBNAME</parameter>
            <parameter type="in" var-type="unknown" >g_strExistingCallLegId</parameter>
            <parameter type="in" var-type="unknown" >f_lCurrentTime</parameter>
          </java>
          <results >
            <result name="Default" link="188" stubbed="0"/>
            <result name="Success" link="189" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: ********JAVA CALLING psAPISceConfCleanupCallLeg *********");

Session.f_lCurrentTime = Server.getUTCTime();]]></script>
            <script language="javascript" timing="last" ><![CDATA[Server.logInfo("INFO: ********** iJavaReturnCode " + Session.f_nReturnCode);

if (Result.id == 2)

{

	Server.logInfo("INFO: SUCCESS CALL psAPISceConfCleanupCallLeg.");

}

else

{

	Server.logError("ERROR: FAIL TO CALL psAPISceConfCleanupCallLeg, EXIT ON: " + Result.name);

}]]></script>
          </scripts>
        </action>
        <action id="186" plug-in="Standard.WaitEvent.1" ><?xtml-editor x=611 y=514 ?>
          <!--for PONG-->
          <wait xmlns="urn:www.pactolus.com:xtml:communication" timeout="5" recv-name="g_strEventReceived" >
            <msg name="ConferencePong" >
              <parameter >f_nPassCodeStatus</parameter>
            </msg>
          </wait>
          <results >
            <result name="Default" link="185" stubbed="1"/>
            <result name="Success" link="198" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="187" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=375 y=521 ?>
          <!--PING to session-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="" transaction="" message-name="&quot;ConferencePing&quot;" destination-port="" destination-type="3" destination-session="g_strExistingSessionId" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;PingSessionId&quot;" value="g_strSessionId"/>
            <parameter tag="&quot;PassCode&quot;" value="g_strPassCode"/>
          </SOAP>
          <results >
            <result name="Default" link="185" stubbed="1"/>
            <result name="Success" link="186" stubbed="0"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_disable_event();]]></script>
          </scripts>
        </action>
        <action id="188" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1397 y=479 ?>
          <results >
            <result name="Default" link="109" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 21;

Session.g_nErrorMsgNumber = 1012;  //exceed max retries

Server.logError("ERROR: PASSCODE INUSED.");]]></script>
          </scripts>
        </action>
        <action id="189" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1399 y=570 ?>
          <!--exceed max retry?-->
          <results >
            <result name="Default" link="7" stubbed="1"/>
            <result name="Counter &gt;= MaxRetry?" link="109" stubbed="1" >f_sCounter &gt;= g_nMaxRetryAllowed</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_sCounter++;

Session.g_strRetryFlag = "T";]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (2 == Result.id)

{

	Session.g_nTerminationReason = 21;

	Session.g_nErrorMsgNumber = 4007;  //passcode inused

	Server.logError("ERROR: EXCEED MAX RETRIES VALIDATE PASSCODE.");

}]]></script>
          </scripts>
        </action>
        <action id="190" plug-in="Pactolus.JavaStaticMethod.1" ><?xtml-editor x=3623 y=1579 ?>
          <!--"psAPISceConfCleanup"-->
          <java xmlns="urn:www.pactolus.com:xtml:application" class="&quot;com.pactolus.conferencing.psAPISceConfCleanup&quot;" method="&quot;cleanupCallLeg&quot;" timeout="s_nTimeout" return="" method-return-var="f_nReturnCode" method-return-type="0" >
            <parameter type="in" var-type="unknown" >g_strDBNAME</parameter>
            <parameter type="in" var-type="unknown" >g_strExistingCallLegId</parameter>
            <parameter type="in" var-type="unknown" >f_lCurrentTime</parameter>
          </java>
          <results >
            <result name="Default" link="196" stubbed="1"/>
            <result name="Success" link="194" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: ********JAVA CALLING psAPISceConfCleanupCallLeg *********");

Session.f_lCurrentTime = Server.getUTCTime();]]></script>
            <script language="javascript" timing="last" ><![CDATA[Server.logInfo("INFO: ********** iJavaReturnCode " + Session.f_nReturnCode);

if (Result.id == 2)

{

	Server.logInfo("INFO: SUCCESS CALL psAPISceConfCleanupCallLeg.");

}

else

{

	Server.logError("ERROR: FAIL TO CALL psAPISceConfCleanupCallLeg, EXIT ON: " + Result.name);

}]]></script>
          </scripts>
        </action>
        <action id="191" plug-in="Standard.WaitEvent.1" ><?xtml-editor x=3189 y=1580 ?>
          <!--for PONG-->
          <wait xmlns="urn:www.pactolus.com:xtml:communication" timeout="5" recv-name="g_strEventReceived" >
            <msg name="ConferencePong" >
              <parameter >f_nPassCodeStatus</parameter>
            </msg>
          </wait>
          <results >
            <result name="Default" link="190" stubbed="1"/>
            <result name="Success" link="200" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="192" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=2932 y=1583 ?>
          <!--PING to session-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="" transaction="" message-name="&quot;ConferencePing&quot;" destination-port="" destination-type="3" destination-session="g_strExistingSessionId" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;PingSessionId&quot;" value="g_strSessionId"/>
            <parameter tag="&quot;PassCode&quot;" value="g_strPassCode"/>
          </SOAP>
          <results >
            <result name="Default" link="190" stubbed="1"/>
            <result name="Success" link="191" stubbed="0"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_disable_event();]]></script>
          </scripts>
        </action>
        <action id="194" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2703 y=1760 ?>
          <!--exceed max retry?-->
          <results >
            <result name="Default" link="183" stubbed="1"/>
            <result name="Counter &gt;= MaxRetry?" link="196" stubbed="0" >f_sCounter &gt;= g_nMaxRetryAllowed</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_sCounter++;

Session.g_strRetryFlag = "T";]]></script>
          </scripts>
        </action>
        <action id="195" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=556 y=271 ?>
          <!--"psAPISceInitConfSession"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceInitConfSession&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="109" stubbed="1"/>
            <result name="SUCCESS" link="7" stubbed="0" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Session.f_nReturnCode != 0)

{

	Session.g_strReturnMsg = "INITIALIZE SESSION FAILED, UNABLE TO ADD PARTY TO THE CONFERENCE";

}]]></script>
          </scripts>
        </action>
        <action id="196" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2946 y=1760 ?>
          <!--could not be added-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >301</audio>
            <audio type="index" >874</audio>
          </play>
          <results >
            <result name="Default" link="182" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 21;

Session.g_nErrorMsgNumber = 4007;  //passcode in used

Server.logError("ERROR: PASSCODE IN USED.");]]></script>
          </scripts>
        </action>
        <action id="197" plug-in="Pactolus.Branch.1" ><?xtml-editor x=100 y=524 ?>
          <!--same session-->
          <results >
            <result name="Default" link="187" stubbed="0"/>
            <result name="same session" link="185" stubbed="1" >g_strExistingSessionId match g_strSessionId</result>
          </results>
        </action>
        <action id="198" plug-in="Pactolus.Branch.1" ><?xtml-editor x=857 y=514 ?>
          <!--passcode inused?-->
          <results >
            <result name="Default" link="185" stubbed="0"/>
            <result name="passcode inused" link="188" stubbed="1" >f_nPassCodeStatus == s_nPasscodeInUsed</result>
          </results>
        </action>
        <action id="199" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2704 y=1585 ?>
          <!--same session-->
          <results >
            <result name="Default" link="192" stubbed="0"/>
            <result name="same session" link="190" stubbed="1" >g_strExistingSessionId match g_strSessionId</result>
          </results>
        </action>
        <action id="200" plug-in="Pactolus.Branch.1" ><?xtml-editor x=3419 y=1584 ?>
          <!--passcode inused?-->
          <results >
            <result name="Default" link="190" stubbed="0"/>
            <result name="passcode inused" link="196" stubbed="1" >f_nPassCodeStatus == s_nPasscodeInUsed</result>
          </results>
        </action>
        <action id="201" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1540 y=2700 ?>
          <!--s_nStateEndCall-->
          <results >
            <result name="Default" link="140" stubbed="0"/>
            <result name="s_nStateEndCall" link="55" stubbed="1" >f_nReturnCode == s_nStateEndCall</result>
            <result name="s_nNON_FIRST_CALLER" link="95" stubbed="1" >f_nReturnCode == s_nNonFirstCaller</result>
          </results>
        </action>
        <action id="203" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=3286 y=1196 ?>
          <!--"RecordCallerName"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;RecordCallerName&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="137" stubbed="1"/>
          </results>
        </action>
        <action id="204" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=3655 y=1360 ?>
          <!--"RecordCallerName"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;RecordCallerName&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="128" stubbed="1"/>
          </results>
        </action>
        <action id="211" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=317 y=2630 ?>
          <!--Collect billing code-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;(xxxxxxxxxx|x.T|x.#)&quot;" language="g_strLanguage" digits="g_strBillingCodeNumber" retry-count="g_nMaxRetryAllowed" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >943</audio>
            <audio type="index" >580</audio>
            <timeout-prompt type="index" >552</timeout-prompt>
          </play>
          <results >
            <result name="Default" link="213" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="212" plug-in="Pactolus.Branch.1" ><?xtml-editor x=89 y=2631 ?>
          <!--get billing code?-->
          <results >
            <result name="Default" link="136" stubbed="1"/>
            <result name="g_strBillingCodeFlag==T" link="211" stubbed="0" >g_strBillingCodeFlag match "T"</result>
          </results>
        </action>
        <action id="213" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=583 y=2529 ?>
          <!--set billing code-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceSetBillingCode&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="136" stubbed="0"/>
          </results>
        </action>
        <action id="214" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=3071 y=1194 ?>
          <!--set billing code-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceSetBillingCode&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="203" stubbed="0"/>
          </results>
        </action>
        <action id="215" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2865 y=1195 ?>
          <!--Collect billing code-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;(xxxxxxxxxx|x.T|x.#)&quot;" language="g_strLanguage" digits="g_strBillingCodeNumber" retry-count="g_nMaxRetryAllowed" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >943</audio>
            <audio type="index" >580</audio>
            <timeout-prompt type="index" >552</timeout-prompt>
          </play>
          <results >
            <result name="Default" link="214" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="216" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2626 y=1196 ?>
          <!--get billing code?-->
          <results >
            <result name="Default" link="203" stubbed="1"/>
            <result name="g_strBillingCodeFlag==T" link="215" stubbed="0" >g_strBillingCodeFlag match "T"</result>
          </results>
        </action>
        <action id="217" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=3411 y=1357 ?>
          <!--set billing code-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceSetBillingCode&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="204" stubbed="0"/>
          </results>
        </action>
        <action id="218" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=3205 y=1358 ?>
          <!--Collect billing code-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;(xxxxxxxxxx|x.T|x.#)&quot;" language="g_strLanguage" digits="g_strBillingCodeNumber" retry-count="g_nMaxRetryAllowed" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >943</audio>
            <audio type="index" >580</audio>
            <timeout-prompt type="index" >552</timeout-prompt>
          </play>
          <results >
            <result name="Default" link="217" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="219" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2966 y=1359 ?>
          <!--get billing code?-->
          <results >
            <result name="Default" link="204" stubbed="1"/>
            <result name="g_strBillingCodeFlag==T" link="218" stubbed="0" >g_strBillingCodeFlag match "T"</result>
          </results>
        </action>
        <action id="220" plug-in="Pactolus.Branch.1" ><?xtml-editor x=98 y=1592 ?>
          <!--prompt to accept?-->
          <results >
            <result name="Default" link="221" stubbed="0"/>
            <result name="strConfirmationFlag == T" link="314" stubbed="0" >strConfirmationFlag match "T"</result>
          </results>
        </action>
        <action id="221" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=311 y=1585 ?>
          <!--you are invited to conf-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="15" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >890</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >871</audio>
          </play>
          <results >
            <result name="Default" link="66" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: ASK TO ACCEPT OR DECLINE.");]]></script>
          </scripts>
        </action>
        <action id="222" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2470 y=2852 ?>
          <!--record conf-->
          <results >
            <result name="Default" link="257" stubbed="0"/>
            <result name="record allow and auto record" link="223" stubbed="1" >g_strConfRecordAllowed match "T"

AND g_strAutoRecordFlag match "T"</result>
          </results>
        </action>
        <action id="223" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=2431 y=3159 ?>
          <!--START_RECORD_REQUEST-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="s_strStartRecordRequest" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace=""/>
          <results >
            <result name="Default" link="224" stubbed="0"/>
            <result name="Success" link="227" stubbed="0"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)

{

	Server.logError("ERROR: FAIL TO SEND START RECORD REQUEST TO CONF CONTROLLER.");

	Server.logError("ERROR: CONF CONTROLLER IP: " + Session.g_strConfControllerIP);

	Server.logError("ERROR: CONF CONTROLLER PORT: " + Session.g_nConfControllerPort);

}]]></script>
          </scripts>
        </action>
        <action id="224" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2692 y=3122 ?>
          <!--fail to record-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >957</audio>
          </play>
          <results >
            <result name="Default" link="225" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="225" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2914 y=3118 ?>
          <!--Hang up caller-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpCaller&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="25" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 40;
Session.g_nConfLeaveReason = 7;
Session.g_strConfLeaveMsg = "FAIL TO SEND START/STOP RECORD CONFERENCE TO CC";]]></script>
          </scripts>
        </action>
        <action id="226" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2931 y=3268 ?>
          <!--record started-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >955</audio>
          </play>
          <results >
            <result name="Default" link="257" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="227" plug-in="Standard.WaitEvent.1" ><?xtml-editor x=2703 y=3276 ?>
          <wait xmlns="urn:www.pactolus.com:xtml:communication" timeout="10" recv-name="g_strEventReceived" >
            <msg name="StartRecordResponse" >
              <parameter >f_nReturnCode</parameter>
              <parameter >g_strReturnMsg</parameter>
            </msg>
          </wait>
          <results >
            <result name="Default" link="224" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
            <result name="SUCCESS" link="226" stubbed="0" >'Result'  == 'Success'

AND f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_nReturnCode = -50;

Session.g_strReturnMsg = "";]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 5)

{

	Server.logError("ERROR: FAIL TO WAIT FOR START RECORD RESPONSE");

	Server.logError("ERROR: EXIT ON: " + Result.name);

	Server.logError("ERROR: RETURN CODE: " + Session.f_nReturnCode);

	Server.logError("ERROR: RETURN MESSAGE: " + Session.g_strReturnMsg);

}]]></script>
          </scripts>
        </action>
        <action id="228" plug-in="Pactolus.UserFunction.1" ><?xtml-editor x=2202 y=1079 ?>
          <user-function xmlns="urn:www.pactolus.com:xtml:application" process="&quot;PACTOLUS_ps_c_adaptor&quot;" function="&quot;is_valid_number&quot;" timeout="5" return="f_nReturnCode" async="0" >
            <parameter >strExtNumber</parameter>
          </user-function>
          <results >
            <result name="Default" link="220" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
            <result name="VALID NUMBER" link="143" stubbed="0" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_nReturnCode = -50;]]></script>
          </scripts>
        </action>
        <action id="229" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1482 y=1338 ?>
          <!--Busy-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strConfControllerIpAddress" transaction="strTransactionId" message-name="s_strConfAddResponse" destination-port="nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="486"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
            <parameter tag="&quot;dialOutRequestId&quot;" value="g_lDialOutRequestId"/>
            <parameter tag="&quot;SIPCallId&quot;" value="g_oCallLegB.strCallId"/>
          </SOAP>
          <results >
            <result name="Default" link="55" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "NUMBER YOU DIALED WAS BUSY";
Session.g_nTerminationReason = 10;]]></script>
          </scripts>
        </action>
        <action id="231" plug-in="Pactolus.Branch.1" ><?xtml-editor x=635 y=1067 ?>
          <!--private talk?-->
          <results >
            <result name="Default" link="291" stubbed="0"/>
            <result name="g_strPrivateTalk == &quot;T&quot;" link="292" stubbed="0" >g_strPrivateTalkFlag match "T"

OR g_strPrivateTalkFlag match "t"</result>
          </results>
        </action>
        <action id="232" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1151 y=1185 ?>
          <!--"OutdialPartyToConference"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;OutdialPartyToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oCallLegB</parameter>
            <parameter >g_oTempConf</parameter>
            <parameter >g_lOutdialStartTime</parameter>
            <parameter >g_lOutdialConnectTime</parameter>
            <parameter >g_strSIPStatus</parameter>
            <parameter >f_strCallingNumber</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="26" stubbed="1"/>
            <result name="0 - SUCCESS" link="335" stubbed="1" >f_nReturnCode == s_nSuccess</result>
            <result name="1 - RING NO ANSWER" link="63" stubbed="1" >f_nReturnCode == f_nRINGNOANSWER</result>
            <result name="2 - BUSY" link="229" stubbed="1" >f_nReturnCode == f_nBUSY</result>
            <result name="-5 - RESOURCE UNAVAILABLE" link="283" stubbed="1" >f_nReturnCode == f_nResourceUnavail</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_oTempConf.strConferenceId = Session.strPrivateTalkConfEndPoint;]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (1 == Result.id)

{

	Session.g_nTerminationReason = 34;

	if (1 == Session.f_nReturnCode)

	{

		Session.f_nErrorCode = -5;

		Session.g_strReturnMsg = "RING NO ANSWER, UNABLE TO ADD PARTY";

	}

	else if (2 == Session.f_nReturnCode)

	{

		Session.f_nErrorCode = -6;

		Session.g_strReturnMsg = "BUSY PHONE, UNABLE TO ADD PARTY";

	}

	else

	{

		Session.f_nErrorCode = -7;

		Session.g_strReturnMsg = "OUTDIAL FAILED, UNABLE TO ADD PARTY";

	}

}
else if (5 == Result.id)
{
	Session.g_nTerminationReason = 30;
}
var myUri = new SipRequestUri(Session.g_oCallLegB.strRequestUri);

if (myUri.url.dtg == undefined)

{

	Session.g_oCallLegB.strDestTrunkGroup = "";

}

else

{

	Session.g_oCallLegB.strDestTrunkGroup = myUri.url.dtg;

}



Server.logInfo("CALLING js_calculate_uri_and_route");

Server.logInfo("BEFORE contact: " + Session.g_oCallLegB.strContact);

Server.logInfo("BEFORE record route: " + Session.g_oCallLegB.strRecordRoute);

Server.logInfo("BEFORE request Uri: " + Session.g_oCallLegB.strRequestUri);

Server.logInfo("BEFORE route: " + Session.g_oCallLegB.strRoute);

var bDialIn = false;

js_calculate_uri_and_route(bDialIn, Session.s_strSipVersion, Session.g_oCallLegB.strFrom, Session.g_oCallLegB.strContact, Session.g_oCallLegB.strRecordRoute, Session.g_oCallLegB.strRequestUri, Session.g_oCallLegB.strRoute);

Server.logInfo("AFTER contact: " + Session.g_oCallLegB.strContact);

Server.logInfo("AFTER record route: " + Session.g_oCallLegB.strRecordRoute);

Server.logInfo("AFTER request Uri: " + Session.g_oCallLegB.strRequestUri);

Server.logInfo("AFTER route: " + Session.g_oCallLegB.strRoute);

Server.logInfo("Call leg B request Uri is: " + Session.g_oCallLegB.strRequestUri);]]></script>
          </scripts>
        </action>
        <action id="234" plug-in="Pactolus.Branch.1" ><?xtml-editor x=83 y=2510 ?>
          <!--anonymous caller?-->
          <results >
            <result name="Default" link="212" stubbed="0"/>
            <result name="g_bAnonymousCaller" link="139" stubbed="1" >g_bAnonymousCaller == true</result>
          </results>
        </action>
        <action id="235" plug-in="Pactolus.Branch.1" ><?xtml-editor x=577 y=3009 ?>
          <!--anonymous caller?-->
          <results >
            <result name="Default" link="154" stubbed="0"/>
            <result name="g_bAnonymousCaller" link="240" stubbed="0" >g_bAnonymousCaller == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_lMSConnectTime = Server.getUTCTime();]]></script>
          </scripts>
        </action>
        <action id="237" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1126 y=3134 ?>
          <!--party join to conf controller-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;PartyJoin&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="34" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[Session.g_oMS.bMuteFlag = true;
Session.g_oMS.bDeafFlag = false;
Session.g_bMutedState = true;
Session.g_bMutedByMod = true;
Session.g_nPromptSelfMuteUnMute = 908;
Server.logInfo("INFO: MODIFY MEMBER TO ANONYMOUS.");
js_disable_event();]]></script>
          </scripts>
        </action>
        <action id="238" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2324 y=2381 ?>
          <!--Press ** Main Menu-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >359</audio>
            <audio type="index" >946</audio>
          </play>
          <results >
            <result name="Default" link="160" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="239" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1692 y=1458 ?>
          <!--party accepted-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strConfControllerIpAddress" transaction="strTransactionId" message-name="s_strConfAddResponse" destination-port="nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="901"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
            <parameter tag="&quot;dialOutRequestId&quot;" value="g_lDialOutRequestId"/>
            <parameter tag="&quot;SIPCallId&quot;" value="g_oCallLegB.strCallId"/>
          </SOAP>
          <results >
            <result name="Default" link="34" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "OUTDIAL: PARTY ACCEPTED";

Session.g_lPrivateTalkStartTime = Server.getUTCTime();]]></script>
            <script language="javascript" timing="last" ><![CDATA[Session.g_bPrivateTalkInConference = true;]]></script>
          </scripts>
        </action>
        <action id="240" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=887 y=3131 ?>
          <!--will now place you into conf-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;PlayJoinAsPrompt&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="237" stubbed="0"/>
          </results>
        </action>
        <action id="241" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=336 y=2214 ?>
          <!--accept or decline-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;(1|2)&quot;" language="g_strLanguage" digits="f_strDigits" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >890</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >311</audio>
            <audio type="index" >893</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >312</audio>
            <audio type="index" >894</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >362</audio>
            <audio type="index" >895</audio>
          </play>
          <results >
            <result name="Default" link="242" stubbed="0"/>
            <result name="Success" ><?xtml-editor visible=no?></result>
            <result name="Error" ><?xtml-editor visible=no?></result>
            <result name="Timeout"/>
            <result name="ACCEPT" link="316" stubbed="1" >'Result'  == 'Success'

AND f_strDigits match "1"</result>
            <result name="DECLINE" link="65" stubbed="1" >'Result'  == 'Success'

AND f_strDigits match "2"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: ASK TO ACCEPT OR DECLINE.");

Session.f_sMaxRetry--;]]></script>
          </scripts>
        </action>
        <action id="242" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=620 y=2214 ?>
          <!--accept or decline-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="15" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;(1|2)&quot;" language="g_strLanguage" digits="f_strDigits" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >890</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >311</audio>
            <audio type="index" >893</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >312</audio>
            <audio type="index" >894</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >362</audio>
            <audio type="index" >895</audio>
          </play>
          <results >
            <result name="Default" link="243" stubbed="0"/>
            <result name="Success" ><?xtml-editor visible=no?></result>
            <result name="Error" ><?xtml-editor visible=no?></result>
            <result name="Timeout"/>
            <result name="ACCEPT" link="316" stubbed="1" >'Result'  == 'Success'

AND f_strDigits match "1"</result>
            <result name="DECLINE" link="65" stubbed="1" >'Result'  == 'Success'

AND f_strDigits match "2"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: ASK TO ACCEPT OR DECLINE.");

Session.f_sMaxRetry--;]]></script>
          </scripts>
        </action>
        <action id="243" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=862 y=2214 ?>
          <!--accept or decline-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="20" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;(1|2)&quot;" language="g_strLanguage" digits="f_strDigits" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >890</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >311</audio>
            <audio type="index" >893</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >312</audio>
            <audio type="index" >894</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >362</audio>
            <audio type="index" >895</audio>
          </play>
          <results >
            <result name="Default" link="244" stubbed="0"/>
            <result name="Success" ><?xtml-editor visible=no?></result>
            <result name="Error" ><?xtml-editor visible=no?></result>
            <result name="Timeout"/>
            <result name="ACCEPT" link="316" stubbed="1" >'Result'  == 'Success'

AND f_strDigits match "1"</result>
            <result name="DECLINE" link="65" stubbed="1" >'Result'  == 'Success'

AND f_strDigits match "2"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: ASK TO ACCEPT OR DECLINE.");

Session.f_sMaxRetry--;]]></script>
          </scripts>
        </action>
        <action id="244" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1116 y=2201 ?>
          <!--max retry?-->
          <results >
            <result name="Default" link="247" stubbed="0"/>
            <result name="f_sMaxRetry  == 0?" link="146" stubbed="1" >f_sMaxRetry == 0</result>
          </results>
        </action>
        <action id="245" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1582 y=2188 ?>
          <!--accept or decline-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="15" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;(1|2)&quot;" language="g_strLanguage" digits="f_strDigits" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >890</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >311</audio>
            <audio type="index" >893</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >312</audio>
            <audio type="index" >894</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >362</audio>
            <audio type="index" >895</audio>
          </play>
          <results >
            <result name="Default" link="246" stubbed="0"/>
            <result name="Success" ><?xtml-editor visible=no?></result>
            <result name="Error" ><?xtml-editor visible=no?></result>
            <result name="Timeout"/>
            <result name="ACCEPT" link="316" stubbed="1" >'Result'  == 'Success'

AND f_strDigits match "1"</result>
            <result name="DECLINE" link="65" stubbed="1" >'Result'  == 'Success'

AND f_strDigits match "2"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: ASK TO ACCEPT OR DECLINE.");

Session.f_sMaxRetry--;]]></script>
          </scripts>
        </action>
        <action id="246" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1824 y=2188 ?>
          <!--accept or decline-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="20" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;(1|2)&quot;" language="g_strLanguage" digits="f_strDigits" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >890</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >311</audio>
            <audio type="index" >893</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >312</audio>
            <audio type="index" >894</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >362</audio>
            <audio type="index" >895</audio>
          </play>
          <results >
            <result name="Default" link="244" stubbed="1"/>
            <result name="Success" ><?xtml-editor visible=no?></result>
            <result name="Error" ><?xtml-editor visible=no?></result>
            <result name="Timeout"/>
            <result name="ACCEPT" link="316" stubbed="1" >'Result'  == 'Success'

AND f_strDigits match "1"</result>
            <result name="DECLINE" link="65" stubbed="1" >'Result'  == 'Success'

AND f_strDigits match "2"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: ASK TO ACCEPT OR DECLINE.");

Session.f_sMaxRetry--;]]></script>
          </scripts>
        </action>
        <action id="247" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1343 y=2194 ?>
          <!--accept or decline-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;(1|2)&quot;" language="g_strLanguage" digits="f_strDigits" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >890</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >311</audio>
            <audio type="index" >893</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >312</audio>
            <audio type="index" >894</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >362</audio>
            <audio type="index" >895</audio>
          </play>
          <results >
            <result name="Default" link="245" stubbed="0"/>
            <result name="Success" ><?xtml-editor visible=no?></result>
            <result name="Error" ><?xtml-editor visible=no?></result>
            <result name="Timeout"/>
            <result name="ACCEPT" link="316" stubbed="1" >'Result'  == 'Success'

AND f_strDigits match "1"</result>
            <result name="DECLINE" link="65" stubbed="1" >'Result'  == 'Success'

AND f_strDigits match "2"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: ASK TO ACCEPT OR DECLINE.");

Session.f_sMaxRetry--;]]></script>
          </scripts>
        </action>
        <action id="248" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1404 y=3001 ?>
          <!--you are the first one-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >nPromptFirstCaller</audio>
          </play>
          <results >
            <result name="Default" link="168" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="250" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=2707 y=2636 ?>
          <!--party accepted-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strConfControllerIpAddress" transaction="strTransactionId" message-name="s_strConfAddResponse" destination-port="nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="901"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
            <parameter tag="&quot;dialOutRequestId&quot;" value="g_lDialOutRequestId"/>
            <parameter tag="&quot;SIPCallId&quot;" value="g_oCallLegB.strCallId"/>
          </SOAP>
          <results >
            <result name="Default" link="174" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "OUTDIAL: PARTY ACCEPTED";]]></script>
          </scripts>
        </action>
        <action id="251" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1657 y=366 ?>
          <!--CreateAConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;CreateConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="109" stubbed="1"/>
            <result name="SUCCESS&amp;&amp;!SameOldConfId" link="285" stubbed="0" >f_nReturnCode == s_nSuccess
AND bSameConferenceId == false</result>
            <result name="SUCCESS&amp;&amp;SameOldConfId" link="320" stubbed="1" >f_nReturnCode == s_nSuccess
AND bSameConferenceId == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (Session.g_strMSResourceName.length > 1)

{

	Server.logInfo("HAS MS RESOURCE NAME: " + Session.g_strMSResourceName);

	Session.g_oMS.strConferenceId = "ms/cnf/$@" + Session.g_strMSResourceName;

}
Session.g_oMS.bPersistentFlag = true;
Session.g_oMS.nConferenceMaxParties = Session.s_nConferenceMaxParties;]]></script>
            <script language="javascript" timing="middle" ><![CDATA[if (Session.strPreviousConferenceId != Session.g_oMS.strConferenceId)
{
	Session.bSameConferenceId = false;
	Server.logInfo("GOT NEW CONFERENCE ID");
}
else
{
	Session.bSameConferenceId = true;
	Server.logInfo("GOT SAME CONFERENCE ID, GO GET ANOTHER ONE");
}
Session.strPreviousConferenceId = Session.g_oMS.strConferenceId;]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (1 == Result.id)
{
	Session.g_nTerminationReason = 37;
}]]></script>
          </scripts>
        </action>
        <action id="252" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2134 y=358 ?>
          <!--set conference resource-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceSetConfResource&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="255" stubbed="0"/>
            <result name="SUCCESS" link="141" stubbed="1" >f_nReturnCode == s_nSuccess</result>
            <result name="s_nResourceAlreadyInUsed" link="319" stubbed="0" >f_nReturnCode == s_nResourceAlreadyInUsed</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (2 == Result.id && 0 == Session.g_strConfResource.length)
{
	Session.g_strConfResource = Session.g_oMS.strConferenceId;
	Server.logInfo("CREATE CONFERENCE, SET CONFERENCE RESOURCE, SET g_strConfResource to oMS.strConferenceId");
}]]></script>
          </scripts>
        </action>
        <action id="253" plug-in="Standard.Timer.1" ><?xtml-editor x=2676 y=3038 ?>
          <!--ck reInvite timer-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lCkReInviteTimerIdB" duration="g_nCkReInviteTime"/>
          <results >
            <result name="Default" link="34" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[//Session.g_lLastReInviteTime = Server.getUTCTime();

Session.g_bCkReInviteTimerFlagB = true;]]></script>
          </scripts>
        </action>
        <action id="254" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2431 y=3045 ?>
          <results >
            <result name="Default" link="253" stubbed="0"/>
            <result name="session timer == T|| Time==0" link="34" stubbed="1" >s_strSessionTimerFlag match "T"

OR g_nCkReInviteTime == 0</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nCkReInviteTime = Session.g_oCallLegB.nSessionTimer;]]></script>
          </scripts>
        </action>
        <action id="255" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2366 y=357 ?>
          <!--"DeleteConference"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DeleteConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="109" stubbed="1"/>
          </results>
        </action>
        <action id="257" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2718 y=2849 ?>
          <!--muted?-->
          <results >
            <result name="Default" link="271" stubbed="0"/>
            <result name="g_bMuteThisParty" link="332" stubbed="0" >g_bMuteThisParty == true</result>
          </results>
        </action>
        <action id="258" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1044 y=3397 ?>
          <!--UnmutePartyRequest-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="s_strUnmutePartyRequest" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;callerPassCode&quot;" value="g_strCCGeneratedPassCode"/>
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="261" stubbed="0"/>
            <result name="Success" link="259" stubbed="0"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_disable_event();

Server.logInfo("INFO: **** UNMUTE PARTY REQUEST ****");]]></script>
          </scripts>
        </action>
        <action id="259" plug-in="Standard.WaitEvent.1" ><?xtml-editor x=1277 y=3535 ?>
          <!--UnmutePartyResponse-->
          <wait xmlns="urn:www.pactolus.com:xtml:communication" timeout="5" recv-name="g_strEventReceived" >
            <msg name="UnmutePartyResponse" >
              <parameter >f_strConfControllerIP</parameter>
              <parameter >f_nConfControllerPort</parameter>
              <parameter >f_strTransactionId</parameter>
              <parameter >f_nReturnCode</parameter>
              <parameter >f_strReturnMsg</parameter>
            </msg>
          </wait>
          <results >
            <result name="Default" link="261" stubbed="1"/>
            <result name="Success" link="260" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_nReturnCode = -1;]]></script>
            <script language="javascript" timing="last" ><![CDATA[js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="260" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1510 y=3533 ?>
          <!--success?-->
          <results >
            <result name="Default" link="261" stubbed="1"/>
            <result name="f_nReturnCode == 0" link="272" stubbed="0" >f_nReturnCode == 0</result>
          </results>
        </action>
        <action id="261" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1262 y=3396 ?>
          <!--can't unmute-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >933</audio>
          </play>
          <results >
            <result name="Default" link="345" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="262" plug-in="Pactolus.Branch.1" ><?xtml-editor x=824 y=3290 ?>
          <!--CallPartyFlag==T?-->
          <results >
            <result name="Default" link="268" stubbed="0"/>
            <result name="g_strPartyPasscodeFlag==T" link="258" stubbed="0" >g_strPartyPasscodeFlag match "T"</result>
          </results>
        </action>
        <action id="263" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1762 y=3796 ?>
          <!--SELF UNMUTE PARTY-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="g_strResponseTransactionId" message-name="s_strConfUnmutePartyEvent" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;callerPassCode&quot;" value="g_strCCGeneratedPassCode"/>
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="265" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: **** SELF UNMUTE ****");]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)

{

	Server.logError("ERROR: FAIL TO SEND SOAP MESSAGE UNMUTE YOUR OWN LINE.");

}]]></script>
          </scripts>
        </action>
        <action id="265" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2009 y=3785 ?>
          <!--your line unmuted-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >s_nPromptUnmuted</audio>
          </play>
          <results >
            <result name="Default" link="345" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nPromptSelfMuteUnMute = 907;

Session.g_bMutedState = false;]]></script>
          </scripts>
        </action>
        <action id="266" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1500 y=3681 ?>
          <!--CallPartyFlag==T?-->
          <results >
            <result name="Default" link="267" stubbed="0"/>
            <result name="g_strPartyPasscodeFlag==T" link="263" stubbed="0" >g_strPartyPasscodeFlag match "T"</result>
          </results>
        </action>
        <action id="267" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1743 y=3663 ?>
          <!--SELF UNMUTE PARTY-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="g_strResponseTransactionId" message-name="s_strConfUnmutePartyEvent" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;callerPassCode&quot;" value="g_strCCGeneratedPassCode"/>
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="265" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: **** SELF UNMUTE ****");]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)

{

	Server.logError("ERROR: FAIL TO SEND SOAP MESSAGE UNMUTE YOUR OWN LINE.");

}]]></script>
          </scripts>
        </action>
        <action id="268" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1028 y=3246 ?>
          <!--UnmutePartyRequest-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="s_strUnmutePartyRequest" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;callerPassCode&quot;" value="g_strCCGeneratedPassCode"/>
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="261" stubbed="1"/>
            <result name="Success" link="259" stubbed="1"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_disable_event();

Server.logInfo("INFO: **** UNMUTE PARTY REQUEST ****");]]></script>
          </scripts>
        </action>
        <action id="269" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=356 y=3300 ?>
          <!--your line has been muted
press *6 to unmute your line-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="6" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;(*1)&quot;" language="g_strLanguage" digits="g_strUnmuteDigits" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >900</audio>
            <audio type="index" >355</audio>
            <audio type="index" >908</audio>
          </play>
          <results >
            <result name="Default" link="345" stubbed="1"/>
            <result name="Success" link="270" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="270" plug-in="Pactolus.Branch.1" ><?xtml-editor x=596 y=3297 ?>
          <!--what digit?-->
          <results >
            <result name="Default" link="345" stubbed="1"/>
            <result name="*6" link="262" stubbed="0" >g_strUnmuteDigits match "^\*{1}6{1}$"</result>
          </results>
        </action>
        <action id="271" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2958 y=2846 ?>
          <!--"ChangeToConferenceMode"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ChangeToConferenceMode&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="318" stubbed="0"/>
            <result name="SUCCESS" link="345" stubbed="0" >f_nReturnCode == s_nSuccess</result>
          </results>
        </action>
        <action id="272" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1745 y=3520 ?>
          <!--"ChangeToConferenceMode"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ChangeToConferenceMode&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="261" stubbed="1"/>
            <result name="SUCCESS" link="266" stubbed="0" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: MODIFY MEMBER TO UNMUTE.");

Session.g_oMS.bMuteFlag = false;]]></script>
          </scripts>
        </action>
        <action id="273" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=625 y=2359 ?>
          <!--accept or decline-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="16" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;(1|2)&quot;" language="g_strLanguage" digits="f_strDigits" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >890</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >311</audio>
            <audio type="index" >893</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >312</audio>
            <audio type="index" >894</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >362</audio>
            <audio type="index" >895</audio>
          </play>
          <results >
            <result name="Default" link="274" stubbed="0"/>
            <result name="Success" ><?xtml-editor visible=no?></result>
            <result name="Error" ><?xtml-editor visible=no?></result>
            <result name="Timeout"/>
            <result name="ACCEPT" link="316" stubbed="1" >'Result'  == 'Success'
AND f_strDigits match "1"</result>
            <result name="DECLINE" link="65" stubbed="1" >'Result'  == 'Success'
AND f_strDigits match "2"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: ASK TO ACCEPT OR DECLINE.");
Session.f_sMaxRetry--;]]></script>
          </scripts>
        </action>
        <action id="274" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=867 y=2359 ?>
          <!--accept or decline-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="23" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;(1|2)&quot;" language="g_strLanguage" digits="f_strDigits" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >890</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >311</audio>
            <audio type="index" >893</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >312</audio>
            <audio type="index" >894</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >362</audio>
            <audio type="index" >895</audio>
          </play>
          <results >
            <result name="Default" link="276" stubbed="0"/>
            <result name="Success" ><?xtml-editor visible=no?></result>
            <result name="Error" ><?xtml-editor visible=no?></result>
            <result name="Timeout"/>
            <result name="ACCEPT" link="316" stubbed="1" >'Result'  == 'Success'
AND f_strDigits match "1"</result>
            <result name="DECLINE" link="65" stubbed="1" >'Result'  == 'Success'
AND f_strDigits match "2"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: ASK TO ACCEPT OR DECLINE.");
Session.f_sMaxRetry--;]]></script>
          </scripts>
        </action>
        <action id="275" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=341 y=2359 ?>
          <!--accept or decline-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="17" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;(1|2)&quot;" language="g_strLanguage" digits="f_strDigits" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >890</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >311</audio>
            <audio type="index" >893</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >312</audio>
            <audio type="index" >894</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >362</audio>
            <audio type="index" >895</audio>
          </play>
          <results >
            <result name="Default" link="273" stubbed="0"/>
            <result name="Success" ><?xtml-editor visible=no?></result>
            <result name="Error" ><?xtml-editor visible=no?></result>
            <result name="Timeout"/>
            <result name="ACCEPT" link="316" stubbed="1" >'Result'  == 'Success'
AND f_strDigits match "1"</result>
            <result name="DECLINE" link="65" stubbed="1" >'Result'  == 'Success'
AND f_strDigits match "2"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: ASK TO ACCEPT OR DECLINE.");
Session.f_sMaxRetry--;]]></script>
          </scripts>
        </action>
        <action id="276" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1128 y=2340 ?>
          <!--max retry?-->
          <results >
            <result name="Default" link="277" stubbed="0"/>
            <result name="f_sMaxRetry  == 0?" link="146" stubbed="1" >f_sMaxRetry == 0</result>
          </results>
        </action>
        <action id="277" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1340 y=2338 ?>
          <!--accept or decline-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="16" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;(1|2)&quot;" language="g_strLanguage" digits="f_strDigits" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >890</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >311</audio>
            <audio type="index" >893</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >312</audio>
            <audio type="index" >894</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >362</audio>
            <audio type="index" >895</audio>
          </play>
          <results >
            <result name="Default" link="278" stubbed="0"/>
            <result name="Success" ><?xtml-editor visible=no?></result>
            <result name="Error" ><?xtml-editor visible=no?></result>
            <result name="Timeout"/>
            <result name="ACCEPT" link="316" stubbed="1" >'Result'  == 'Success'
AND f_strDigits match "1"</result>
            <result name="DECLINE" link="65" stubbed="1" >'Result'  == 'Success'
AND f_strDigits match "2"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: ASK TO ACCEPT OR DECLINE.");
Session.f_sMaxRetry--;]]></script>
          </scripts>
        </action>
        <action id="278" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1579 y=2332 ?>
          <!--accept or decline-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="16" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;(1|2)&quot;" language="g_strLanguage" digits="f_strDigits" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >890</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >311</audio>
            <audio type="index" >893</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >312</audio>
            <audio type="index" >894</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >362</audio>
            <audio type="index" >895</audio>
          </play>
          <results >
            <result name="Default" link="279" stubbed="0"/>
            <result name="Success" ><?xtml-editor visible=no?></result>
            <result name="Error" ><?xtml-editor visible=no?></result>
            <result name="Timeout"/>
            <result name="ACCEPT" link="316" stubbed="1" >'Result'  == 'Success'
AND f_strDigits match "1"</result>
            <result name="DECLINE" link="65" stubbed="1" >'Result'  == 'Success'
AND f_strDigits match "2"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: ASK TO ACCEPT OR DECLINE.");
Session.f_sMaxRetry--;]]></script>
          </scripts>
        </action>
        <action id="279" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1821 y=2332 ?>
          <!--accept or decline-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="23" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;(1|2)&quot;" language="g_strLanguage" digits="f_strDigits" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >890</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >311</audio>
            <audio type="index" >893</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >312</audio>
            <audio type="index" >894</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >362</audio>
            <audio type="index" >895</audio>
          </play>
          <results >
            <result name="Default" link="276" stubbed="1"/>
            <result name="Success" ><?xtml-editor visible=no?></result>
            <result name="Error" ><?xtml-editor visible=no?></result>
            <result name="Timeout"/>
            <result name="ACCEPT" link="316" stubbed="1" >'Result'  == 'Success'
AND f_strDigits match "1"</result>
            <result name="DECLINE" link="65" stubbed="1" >'Result'  == 'Success'
AND f_strDigits match "2"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: ASK TO ACCEPT OR DECLINE.");
Session.f_sMaxRetry--;]]></script>
          </scripts>
        </action>
        <action id="280" plug-in="Pactolus.Branch.1" ><?xtml-editor x=118 y=2294 ?>
          <!--french?-->
          <results >
            <result name="Default" link="241" stubbed="0"/>
            <result name="g_strLanguage==&quot;fre&quot;" link="275" stubbed="0" >g_strLanguage match "fre"</result>
          </results>
        </action>
        <action id="283" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1876 y=118 ?>
          <!--"psAPISceDisableMS"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceDisableMS&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="289" stubbed="0"/>
          </results>
        </action>
        <action id="285" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1903 y=362 ?>
          <!--"psAPISceEnableMS"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceEnableMS&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="252" stubbed="0"/>
          </results>
        </action>
        <action id="286" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1380 y=232 ?>
          <!--ms in service-->
          <results >
            <result name="Default" link="109" stubbed="1"/>
            <result name="!s_bMsOutOfService" link="287" stubbed="0" >s_bMsOutOfService == false</result>
            <result name="s_bMsOutOfService &gt; 5 secs" link="251" stubbed="0" >s_bMsOutOfService == true

AND f_bMoreThanFiveSecs == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if ( (Server.getUTCTime() - Session.s_lMSOutOfServiceTime) > 5 )

	Session.f_bMoreThanFiveSecs = true;]]></script>
          </scripts>
        </action>
        <action id="287" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1637 y=118 ?>
          <!--CreateAConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;CreateConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="283" stubbed="0"/>
            <result name="SUCCESS&amp;&amp;!SameOldConfId" link="252" stubbed="1" >f_nReturnCode == s_nSuccess
AND bSameConferenceId == false</result>
            <result name="SUCCESS&amp;&amp;SameOldConfId" link="320" stubbed="0" >f_nReturnCode == s_nSuccess
AND bSameConferenceId == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (Session.g_strMSResourceName.length > 1)

{

	Server.logInfo("HAS MS RESOURCE NAME: " + Session.g_strMSResourceName);

	Session.g_oMS.strConferenceId = "ms/cnf/$@" + Session.g_strMSResourceName;

}
Session.g_oMS.bPersistentFlag = true;
Session.g_oMS.nConferenceMaxParties = Session.s_nConferenceMaxParties;]]></script>
            <script language="javascript" timing="middle" ><![CDATA[if (Session.strPreviousConferenceId != Session.g_oMS.strConferenceId)
{
	Session.bSameConferenceId = false;
	Server.logInfo("GOT NEW CONFERENCE ID");
}
else
{
	Session.bSameConferenceId = true;
	Server.logInfo("GOT SAME CONFERENCE ID, GO GET ANOTHER ONE");
}
Session.strPreviousConferenceId = Session.g_oMS.strConferenceId;]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (1 == Result.id)
{
	Session.g_nTerminationReason = 37;
}]]></script>
          </scripts>
        </action>
        <action id="289" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=2104 y=119 ?>
          <!--FAIL to add a call party-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strConfControllerIpAddress" transaction="strTransactionId" message-name="s_strConfAddResponse" destination-port="nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="-9"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
            <parameter tag="&quot;dialOutRequestId&quot;" value="g_lDialOutRequestId"/>
            <parameter tag="&quot;SIPCallId&quot;" value="g_oCallLegB.strCallId"/>
          </SOAP>
          <results >
            <result name="Default" link="25" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "FAILURE TO ADD PARTY TO THE CONFERENCE";]]></script>
            <script language="javascript" timing="last" ><![CDATA[Session.g_bNeedToMoveConf = true;]]></script>
          </scripts>
        </action>
        <action id="291" plug-in="Pactolus.Branch.1" ><?xtml-editor x=856 y=914 ?>
          <!--ms in service-->
          <results >
            <result name="Default" link="26" stubbed="1"/>
            <result name="!s_bMsOutOfService" link="293" stubbed="0" >s_bMsOutOfService == false</result>
            <result name="s_bMsOutOfService &gt; 5 secs" link="126" stubbed="0" >s_bMsOutOfService == true

AND f_bMoreThanFiveSecs == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if ( (Server.getUTCTime() - Session.s_lMSOutOfServiceTime) > 5 )

	Session.f_bMoreThanFiveSecs = true;]]></script>
          </scripts>
        </action>
        <action id="292" plug-in="Pactolus.Branch.1" ><?xtml-editor x=874 y=1222 ?>
          <!--ms in service-->
          <results >
            <result name="Default" link="26" stubbed="1"/>
            <result name="!s_bMsOutOfService" link="232" stubbed="0" >s_bMsOutOfService == false</result>
            <result name="s_bMsOutOfService &gt; 5 secs" link="294" stubbed="0" >s_bMsOutOfService == true

AND f_bMoreThanFiveSecs == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if ( (Server.getUTCTime() - Session.s_lMSOutOfServiceTime) > 5 )

	Session.f_bMoreThanFiveSecs = true;
	
if ("T" == Session.s_strLoadTestMode)
	Session.f_strCallingNumber = "PrivateTalk";
else
	Session.f_strCallingNumber = Session.s_strDefaultAni;]]></script>
          </scripts>
        </action>
        <action id="293" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1129 y=842 ?>
          <!--outdial party to ms-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;OutdialPartyToMS&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oCallLegB</parameter>
            <parameter >g_oMS</parameter>
            <parameter >g_lOutdialStartTime</parameter>
            <parameter >g_lOutdialConnectTime</parameter>
            <parameter >g_strSIPStatus</parameter>
            <parameter >g_strOrigNbr</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="26" stubbed="1"/>
            <result name="0 - SUCCESS" link="64" stubbed="1" >f_nReturnCode == f_nSUCCESS</result>
            <result name="1 - RING NO ANSWER" link="63" stubbed="1" >f_nReturnCode == f_nRINGNOANSWER</result>
            <result name="2 - BUSY" link="229" stubbed="1" >f_nReturnCode == f_nBUSY</result>
            <result name="-5 - RESOURCE UNAVAIL" link="283" stubbed="1" >f_nReturnCode == f_nResourceUnavail</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[var myUri = new SipRequestUri(Session.g_oCallLegB.strRequestUri);

if (myUri.url.dtg == undefined)

{

	Session.g_oCallLegB.strDestTrunkGroup = "";

}

else

{

	Session.g_oCallLegB.strDestTrunkGroup = myUri.url.dtg;

}



Server.logInfo("INFO: CALING LIBOUTDIAL RETURN: " + Session.f_nReturnCode);

Server.logInfo("CALLING js_calculate_uri_and_route");

Server.logInfo("BEFORE contact: " + Session.g_oCallLegB.strContact);

Server.logInfo("BEFORE record route: " + Session.g_oCallLegB.strRecordRoute);

Server.logInfo("BEFORE request Uri: " + Session.g_oCallLegB.strRequestUri);

Server.logInfo("BEFORE route: " + Session.g_oCallLegB.strRoute);

var bDialIn = false;

js_calculate_uri_and_route(bDialIn, Session.s_strSipVersion, Session.g_oCallLegB.strFrom, Session.g_oCallLegB.strContact, Session.g_oCallLegB.strRecordRoute, Session.g_oCallLegB.strRequestUri, Session.g_oCallLegB.strRoute);

Server.logInfo("AFTER contact: " + Session.g_oCallLegB.strContact);

Server.logInfo("AFTER record route: " + Session.g_oCallLegB.strRecordRoute);

Server.logInfo("AFTER request Uri: " + Session.g_oCallLegB.strRequestUri);

Server.logInfo("AFTER route: " + Session.g_oCallLegB.strRoute);

Server.logInfo("Call leg B request Uri is: " + Session.g_oCallLegB.strRequestUri);
if (1 == Result.id)
{
	Session.g_nTerminationReason = 34;
}
else if (5 == Result.id)
{
	Session.g_nTerminationReason = 30;
}]]></script>
          </scripts>
        </action>
        <action id="294" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1164 y=1365 ?>
          <!--"OutdialPartyToConference"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;OutdialPartyToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oCallLegB</parameter>
            <parameter >g_oTempConf</parameter>
            <parameter >g_lOutdialStartTime</parameter>
            <parameter >g_lOutdialConnectTime</parameter>
            <parameter >g_strSIPStatus</parameter>
            <parameter >f_strCallingNumber</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="26" stubbed="1"/>
            <result name="0 - SUCCESS" link="295" stubbed="0" >f_nReturnCode == s_nSuccess</result>
            <result name="1 - RING NO ANSWER" link="63" stubbed="1" >f_nReturnCode == f_nRINGNOANSWER</result>
            <result name="2 - BUSY" link="229" stubbed="1" >f_nReturnCode == f_nBUSY</result>
            <result name="-5 - RESOURCE UNAVAILABLE" link="289" stubbed="1" >f_nReturnCode == f_nResourceUnavail</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_oTempConf.strConferenceId = Session.strPrivateTalkConfEndPoint;]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (1 == Result.id)

{

	Session.g_nTerminationReason = 34;

	if (1 == Session.f_nReturnCode)

	{

		Session.f_nErrorCode = -5;

		Session.g_strReturnMsg = "RING NO ANSWER, UNABLE TO ADD PARTY";

	}

	else if (2 == Session.f_nReturnCode)

	{

		Session.f_nErrorCode = -6;

		Session.g_strReturnMsg = "BUSY PHONE, UNABLE TO ADD PARTY";

	}

	else

	{

		Session.f_nErrorCode = -7;

		Session.g_strReturnMsg = "OUTDIAL FAILED, UNABLE TO ADD PARTY";

	}

}
else if (5 == Result.id)
{
	Session.g_nTerminationReason = 30;
}

var myUri = new SipRequestUri(Session.g_oCallLegB.strRequestUri);

if (myUri.url.dtg == undefined)

{

	Session.g_oCallLegB.strDestTrunkGroup = "";

}

else

{

	Session.g_oCallLegB.strDestTrunkGroup = myUri.url.dtg;

}



Server.logInfo("CALLING js_calculate_uri_and_route");

Server.logInfo("BEFORE contact: " + Session.g_oCallLegB.strContact);

Server.logInfo("BEFORE record route: " + Session.g_oCallLegB.strRecordRoute);

Server.logInfo("BEFORE request Uri: " + Session.g_oCallLegB.strRequestUri);

Server.logInfo("BEFORE route: " + Session.g_oCallLegB.strRoute);

var bDialIn = false;

js_calculate_uri_and_route(bDialIn, Session.s_strSipVersion, Session.g_oCallLegB.strFrom, Session.g_oCallLegB.strContact, Session.g_oCallLegB.strRecordRoute, Session.g_oCallLegB.strRequestUri, Session.g_oCallLegB.strRoute);

Server.logInfo("AFTER contact: " + Session.g_oCallLegB.strContact);

Server.logInfo("AFTER record route: " + Session.g_oCallLegB.strRecordRoute);

Server.logInfo("AFTER request Uri: " + Session.g_oCallLegB.strRequestUri);

Server.logInfo("AFTER route: " + Session.g_oCallLegB.strRoute);

Server.logInfo("Call leg B request Uri is: " + Session.g_oCallLegB.strRequestUri);]]></script>
          </scripts>
        </action>
        <action id="295" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1477 y=1462 ?>
          <!--"psAPISceEnableMS"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceEnableMS&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="335" stubbed="1"/>
          </results>
        </action>
        <action id="296" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1475 y=1080 ?>
          <!--"psAPISceEnableMS"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceEnableMS&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="64" stubbed="0"/>
          </results>
        </action>
        <action id="297" plug-in="Pactolus.Branch.1" ><?xtml-editor x=156 y=3383 ?>
          <!--ModMutedThisParty?-->
          <results >
            <result name="Default" link="269" stubbed="0"/>
            <result name="g_strModeratorMutedFlag" link="298" stubbed="0" >g_strModeratorMutedFlag match "T"
OR g_strMuteFlag match "T"</result>
          </results>
        </action>
        <action id="298" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=374 y=3483 ?>
          <!--your line has been muted-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="6" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;(*1)&quot;" language="g_strLanguage" digits="g_strUnmuteDigits" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >900</audio>
          </play>
          <results >
            <result name="Default" link="345" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="299" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=334 y=1930 ?>
          <!--accept or decline-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;(1|2)&quot;" language="g_strLanguage" digits="f_strDigits" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >890</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >311</audio>
            <audio type="index" >893</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >312</audio>
            <audio type="index" >894</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >362</audio>
            <audio type="index" >895</audio>
            <audio type="index" >211</audio>
          </play>
          <results >
            <result name="Default" link="300" stubbed="0"/>
            <result name="Success" ><?xtml-editor visible=no?></result>
            <result name="Error" ><?xtml-editor visible=no?></result>
            <result name="Timeout"/>
            <result name="ACCEPT" link="316" stubbed="1" >'Result'  == 'Success'

AND f_strDigits match "1"</result>
            <result name="DECLINE" link="65" stubbed="1" >'Result'  == 'Success'

AND f_strDigits match "2"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: ASK TO ACCEPT OR DECLINE.");

Session.f_sMaxRetry--;]]></script>
          </scripts>
        </action>
        <action id="300" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=618 y=1930 ?>
          <!--accept or decline-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="15" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;(1|2)&quot;" language="g_strLanguage" digits="f_strDigits" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >890</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >311</audio>
            <audio type="index" >893</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >312</audio>
            <audio type="index" >894</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >362</audio>
            <audio type="index" >895</audio>
            <audio type="index" >211</audio>
          </play>
          <results >
            <result name="Default" link="301" stubbed="0"/>
            <result name="Success" ><?xtml-editor visible=no?></result>
            <result name="Error" ><?xtml-editor visible=no?></result>
            <result name="Timeout"/>
            <result name="ACCEPT" link="316" stubbed="1" >'Result'  == 'Success'

AND f_strDigits match "1"</result>
            <result name="DECLINE" link="65" stubbed="1" >'Result'  == 'Success'

AND f_strDigits match "2"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: ASK TO ACCEPT OR DECLINE.");

Session.f_sMaxRetry--;]]></script>
          </scripts>
        </action>
        <action id="301" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=860 y=1930 ?>
          <!--accept or decline-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="20" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;(1|2)&quot;" language="g_strLanguage" digits="f_strDigits" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >890</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >311</audio>
            <audio type="index" >893</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >312</audio>
            <audio type="index" >894</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >362</audio>
            <audio type="index" >895</audio>
            <audio type="index" >211</audio>
          </play>
          <results >
            <result name="Default" link="302" stubbed="0"/>
            <result name="Success" ><?xtml-editor visible=no?></result>
            <result name="Error" ><?xtml-editor visible=no?></result>
            <result name="Timeout"/>
            <result name="ACCEPT" link="316" stubbed="1" >'Result'  == 'Success'

AND f_strDigits match "1"</result>
            <result name="DECLINE" link="65" stubbed="1" >'Result'  == 'Success'

AND f_strDigits match "2"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: ASK TO ACCEPT OR DECLINE.");

Session.f_sMaxRetry--;]]></script>
          </scripts>
        </action>
        <action id="302" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1114 y=1917 ?>
          <!--max retry?-->
          <results >
            <result name="Default" link="305" stubbed="0"/>
            <result name="f_sMaxRetry  == 0?" link="146" stubbed="1" >f_sMaxRetry == 0</result>
          </results>
        </action>
        <action id="303" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1580 y=1904 ?>
          <!--accept or decline-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="15" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;(1|2)&quot;" language="g_strLanguage" digits="f_strDigits" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >890</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >311</audio>
            <audio type="index" >893</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >312</audio>
            <audio type="index" >894</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >362</audio>
            <audio type="index" >895</audio>
            <audio type="index" >211</audio>
          </play>
          <results >
            <result name="Default" link="304" stubbed="0"/>
            <result name="Success" ><?xtml-editor visible=no?></result>
            <result name="Error" ><?xtml-editor visible=no?></result>
            <result name="Timeout"/>
            <result name="ACCEPT" link="316" stubbed="1" >'Result'  == 'Success'

AND f_strDigits match "1"</result>
            <result name="DECLINE" link="65" stubbed="1" >'Result'  == 'Success'

AND f_strDigits match "2"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: ASK TO ACCEPT OR DECLINE.");

Session.f_sMaxRetry--;]]></script>
          </scripts>
        </action>
        <action id="304" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1822 y=1904 ?>
          <!--accept or decline-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="20" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;(1|2)&quot;" language="g_strLanguage" digits="f_strDigits" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >890</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >311</audio>
            <audio type="index" >893</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >312</audio>
            <audio type="index" >894</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >362</audio>
            <audio type="index" >895</audio>
            <audio type="index" >211</audio>
          </play>
          <results >
            <result name="Default" link="302" stubbed="1"/>
            <result name="Success" ><?xtml-editor visible=no?></result>
            <result name="Error" ><?xtml-editor visible=no?></result>
            <result name="Timeout"/>
            <result name="ACCEPT" link="316" stubbed="1" >'Result'  == 'Success'

AND f_strDigits match "1"</result>
            <result name="DECLINE" link="65" stubbed="1" >'Result'  == 'Success'

AND f_strDigits match "2"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: ASK TO ACCEPT OR DECLINE.");

Session.f_sMaxRetry--;]]></script>
          </scripts>
        </action>
        <action id="305" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1341 y=1910 ?>
          <!--accept or decline-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;(1|2)&quot;" language="g_strLanguage" digits="f_strDigits" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >890</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >311</audio>
            <audio type="index" >893</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >312</audio>
            <audio type="index" >894</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >362</audio>
            <audio type="index" >895</audio>
            <audio type="index" >211</audio>
          </play>
          <results >
            <result name="Default" link="303" stubbed="0"/>
            <result name="Success" ><?xtml-editor visible=no?></result>
            <result name="Error" ><?xtml-editor visible=no?></result>
            <result name="Timeout"/>
            <result name="ACCEPT" link="316" stubbed="1" >'Result'  == 'Success'

AND f_strDigits match "1"</result>
            <result name="DECLINE" link="65" stubbed="1" >'Result'  == 'Success'

AND f_strDigits match "2"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: ASK TO ACCEPT OR DECLINE.");

Session.f_sMaxRetry--;]]></script>
          </scripts>
        </action>
        <action id="306" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=623 y=2075 ?>
          <!--accept or decline-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="16" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;(1|2)&quot;" language="g_strLanguage" digits="f_strDigits" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >890</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >311</audio>
            <audio type="index" >893</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >312</audio>
            <audio type="index" >894</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >362</audio>
            <audio type="index" >895</audio>
            <audio type="index" >211</audio>
          </play>
          <results >
            <result name="Default" link="307" stubbed="0"/>
            <result name="Success" ><?xtml-editor visible=no?></result>
            <result name="Error" ><?xtml-editor visible=no?></result>
            <result name="Timeout"/>
            <result name="ACCEPT" link="316" stubbed="1" >'Result'  == 'Success'
AND f_strDigits match "1"</result>
            <result name="DECLINE" link="65" stubbed="1" >'Result'  == 'Success'
AND f_strDigits match "2"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: ASK TO ACCEPT OR DECLINE.");
Session.f_sMaxRetry--;]]></script>
          </scripts>
        </action>
        <action id="307" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=865 y=2075 ?>
          <!--accept or decline-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="23" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;(1|2)&quot;" language="g_strLanguage" digits="f_strDigits" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >890</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >311</audio>
            <audio type="index" >893</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >312</audio>
            <audio type="index" >894</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >362</audio>
            <audio type="index" >895</audio>
            <audio type="index" >211</audio>
          </play>
          <results >
            <result name="Default" link="309" stubbed="0"/>
            <result name="Success" ><?xtml-editor visible=no?></result>
            <result name="Error" ><?xtml-editor visible=no?></result>
            <result name="Timeout"/>
            <result name="ACCEPT" link="316" stubbed="1" >'Result'  == 'Success'
AND f_strDigits match "1"</result>
            <result name="DECLINE" link="65" stubbed="1" >'Result'  == 'Success'
AND f_strDigits match "2"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: ASK TO ACCEPT OR DECLINE.");
Session.f_sMaxRetry--;]]></script>
          </scripts>
        </action>
        <action id="308" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=339 y=2075 ?>
          <!--accept or decline-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="17" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;(1|2)&quot;" language="g_strLanguage" digits="f_strDigits" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >890</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >311</audio>
            <audio type="index" >893</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >312</audio>
            <audio type="index" >894</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >362</audio>
            <audio type="index" >895</audio>
            <audio type="index" >211</audio>
          </play>
          <results >
            <result name="Default" link="306" stubbed="0"/>
            <result name="Success" ><?xtml-editor visible=no?></result>
            <result name="Error" ><?xtml-editor visible=no?></result>
            <result name="Timeout"/>
            <result name="ACCEPT" link="316" stubbed="1" >'Result'  == 'Success'
AND f_strDigits match "1"</result>
            <result name="DECLINE" link="65" stubbed="1" >'Result'  == 'Success'
AND f_strDigits match "2"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: ASK TO ACCEPT OR DECLINE.");
Session.f_sMaxRetry--;]]></script>
          </scripts>
        </action>
        <action id="309" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1126 y=2056 ?>
          <!--max retry?-->
          <results >
            <result name="Default" link="310" stubbed="0"/>
            <result name="f_sMaxRetry  == 0?" link="146" stubbed="1" >f_sMaxRetry == 0</result>
          </results>
        </action>
        <action id="310" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1338 y=2054 ?>
          <!--accept or decline-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="16" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;(1|2)&quot;" language="g_strLanguage" digits="f_strDigits" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >890</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >311</audio>
            <audio type="index" >893</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >312</audio>
            <audio type="index" >894</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >362</audio>
            <audio type="index" >895</audio>
            <audio type="index" >211</audio>
          </play>
          <results >
            <result name="Default" link="311" stubbed="0"/>
            <result name="Success" ><?xtml-editor visible=no?></result>
            <result name="Error" ><?xtml-editor visible=no?></result>
            <result name="Timeout"/>
            <result name="ACCEPT" link="316" stubbed="1" >'Result'  == 'Success'
AND f_strDigits match "1"</result>
            <result name="DECLINE" link="65" stubbed="1" >'Result'  == 'Success'
AND f_strDigits match "2"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: ASK TO ACCEPT OR DECLINE.");
Session.f_sMaxRetry--;]]></script>
          </scripts>
        </action>
        <action id="311" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1577 y=2048 ?>
          <!--accept or decline-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="16" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;(1|2)&quot;" language="g_strLanguage" digits="f_strDigits" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >890</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >311</audio>
            <audio type="index" >893</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >312</audio>
            <audio type="index" >894</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >362</audio>
            <audio type="index" >895</audio>
            <audio type="index" >211</audio>
          </play>
          <results >
            <result name="Default" link="312" stubbed="0"/>
            <result name="Success" ><?xtml-editor visible=no?></result>
            <result name="Error" ><?xtml-editor visible=no?></result>
            <result name="Timeout"/>
            <result name="ACCEPT" link="316" stubbed="1" >'Result'  == 'Success'
AND f_strDigits match "1"</result>
            <result name="DECLINE" link="65" stubbed="1" >'Result'  == 'Success'
AND f_strDigits match "2"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: ASK TO ACCEPT OR DECLINE.");
Session.f_sMaxRetry--;]]></script>
          </scripts>
        </action>
        <action id="312" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1819 y=2048 ?>
          <!--accept or decline-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="23" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;(1|2)&quot;" language="g_strLanguage" digits="f_strDigits" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >890</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >311</audio>
            <audio type="index" >893</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >312</audio>
            <audio type="index" >894</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >362</audio>
            <audio type="index" >895</audio>
            <audio type="index" >211</audio>
          </play>
          <results >
            <result name="Default" link="309" stubbed="1"/>
            <result name="Success" ><?xtml-editor visible=no?></result>
            <result name="Error" ><?xtml-editor visible=no?></result>
            <result name="Timeout"/>
            <result name="ACCEPT" link="316" stubbed="1" >'Result'  == 'Success'
AND f_strDigits match "1"</result>
            <result name="DECLINE" link="65" stubbed="1" >'Result'  == 'Success'
AND f_strDigits match "2"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: ASK TO ACCEPT OR DECLINE.");
Session.f_sMaxRetry--;]]></script>
          </scripts>
        </action>
        <action id="313" plug-in="Pactolus.Branch.1" ><?xtml-editor x=116 y=2010 ?>
          <!--french?-->
          <results >
            <result name="Default" link="299" stubbed="0"/>
            <result name="g_strLanguage==&quot;fre&quot;" link="308" stubbed="0" >g_strLanguage match "fre"</result>
          </results>
        </action>
        <action id="314" plug-in="Pactolus.Branch.1" ><?xtml-editor x=21 y=2144 ?>
          <results >
            <result name="Default" link="280" stubbed="1"/>
            <result name="strLoadTestMode==&quot;T&quot;" link="313" stubbed="0" >s_strLoadTestMode match "T"</result>
          </results>
        </action>
        <action id="316" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=83 y=2396 ?>
          <!--party accepted-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strConfControllerIpAddress" transaction="strTransactionId" message-name="s_strConfAddResponse" destination-port="nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="901"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
            <parameter tag="&quot;dialOutRequestId&quot;" value="g_lDialOutRequestId"/>
            <parameter tag="&quot;SIPCallId&quot;" value="g_oCallLegB.strCallId"/>
          </SOAP>
          <results >
            <result name="Default" link="234" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "OUTDIAL: PARTY ACCEPTED";]]></script>
          </scripts>
        </action>
        <action id="318" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=3182 y=2831 ?>
          <!--Hang up caller-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpCaller&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="25" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 36;]]></script>
          </scripts>
        </action>
        <action id="319" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2398 y=453 ?>
          <results >
            <result name="Default" link="109" stubbed="1"/>
            <result name="nSetConfResourceRetry&lt;3?" link="286" stubbed="1" >nSetConfResourceRetry &lt; 3</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.nSetConfResourceRetry++;
Server.logInfo("CONF RESOURCE INUSED, GET ANOTHER CONFERENCE ID");]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (1 == Result.id)
{
	Session.g_intTerminationReason = 47;
}]]></script>
          </scripts>
        </action>
        <action id="320" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1895 y=230 ?>
          <!--get a different conference-->
          <results >
            <result name="Default" link="109" stubbed="1"/>
            <result name="nSetConfResourceRetry&lt;3?" link="286" stubbed="1" >nSetConfResourceRetry &lt; 3</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("GET ANOTHER CONFERENCE ID");
Session.g_oMS.strConferenceId = "";
Session.nSetConfResourceRetry++;]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (1 == Result.id)
{
	Session.g_intTerminationReason = 47;
}]]></script>
          </scripts>
        </action>
        <action id="321" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2708 y=1339 ?>
          <!--conferenceResource == null?-->
          <results >
            <result name="Default" link="219" stubbed="0"/>
            <result name="conferenceResource == null" link="180" stubbed="1" >g_strConfResource match "null"

OR g_bNullString == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (Session.g_strConfResource.length <= 0)
{
	Session.g_bNullString = true;
	Session.g_nErrorMsgNumber = 4014;
	Session.g_strReturnMsg = "NULL CONFERENCE RESOURCE, UNABLE TO ADD PARTY TO THE CONFERENCE";
	if (3 == Session.f_nReturnCode)
		Server.logError("ERROR: THE FIRST CALLER and NO NEED TO GET CONFERENCE ENDPOINT, BUT CONF RESOURCE IS NULL: " + Session.g_strConfResource);
	else
		Server.logError("ERROR: NOT THE FIRST CALLER, BUT CONF RESOURCE IS NULL: " + Session.g_strConfResource);
}
else
{
	Session.g_bNullString = false;
	Session.g_oMS.strConferenceId = Session.g_strConfResource;
}]]></script>
          </scripts>
        </action>
        <action id="322" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2725 y=2215 ?>
          <!--CreateAConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;CreateConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="180" stubbed="1"/>
            <result name="SUCCESS&amp;&amp;!SameOldConfId" link="326" stubbed="0" >f_nReturnCode == s_nSuccess
AND bSameConferenceId == false</result>
            <result name="SUCCESS&amp;&amp;SameOldConfId" link="330" stubbed="1" >f_nReturnCode == s_nSuccess
AND bSameConferenceId == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (Session.g_strMSResourceName.length > 1)

{

	Server.logInfo("HAS MS RESOURCE NAME: " + Session.g_strMSResourceName);

	Session.g_oMS.strConferenceId = "ms/cnf/$@" + Session.g_strMSResourceName;

}
Session.g_oMS.bPersistentFlag = true;
Session.g_oMS.nConferenceMaxParties = Session.s_nConferenceMaxParties;]]></script>
            <script language="javascript" timing="middle" ><![CDATA[if (Session.strPreviousConferenceId != Session.g_oMS.strConferenceId)
{
	Session.bSameConferenceId = false;
	Server.logInfo("GOT NEW CONFERENCE ID");
}
else
{
	Session.bSameConferenceId = true;
	Server.logInfo("GOT SAME CONFERENCE ID, GO GET ANOTHER ONE");
}
Session.strPreviousConferenceId = Session.g_oMS.strConferenceId;]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (1 == Result.id)
{
	Session.g_nTerminationReason = 37;
}]]></script>
          </scripts>
        </action>
        <action id="323" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=3202 y=2207 ?>
          <!--set conference resource-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceSetConfResource&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="324" stubbed="0"/>
            <result name="SUCCESS" link="219" stubbed="1" >f_nReturnCode == s_nSuccess</result>
            <result name="s_nResourceAlreadyInUsed" link="331" stubbed="0" >f_nReturnCode == s_nResourceAlreadyInUsed</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (2 == Result.id && 0 == Session.g_strConfResource.length)
{
	Session.g_strConfResource = Session.g_oMS.strConferenceId;
	Server.logInfo("CREATE CONFERENCE, SET CONFERENCE RESOURCE, SET g_strConfResource to oMS.strConferenceId");
}]]></script>
          </scripts>
        </action>
        <action id="324" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=3434 y=2206 ?>
          <!--"DeleteConference"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DeleteConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="180" stubbed="1"/>
          </results>
        </action>
        <action id="325" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2950 y=1985 ?>
          <!--"psAPISceDisableMS"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceDisableMS&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="329" stubbed="0"/>
          </results>
        </action>
        <action id="326" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2971 y=2211 ?>
          <!--"psAPISceEnableMS"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceEnableMS&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="323" stubbed="0"/>
          </results>
        </action>
        <action id="327" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2448 y=2081 ?>
          <!--ms in service-->
          <results >
            <result name="Default" link="180" stubbed="1"/>
            <result name="!s_bMsOutOfService" link="328" stubbed="0" >s_bMsOutOfService == false</result>
            <result name="s_bMsOutOfService &gt; 5 secs" link="322" stubbed="0" >s_bMsOutOfService == true

AND f_bMoreThanFiveSecs == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if ( (Server.getUTCTime() - Session.s_lMSOutOfServiceTime) > 5 )

	Session.f_bMoreThanFiveSecs = true;]]></script>
          </scripts>
        </action>
        <action id="328" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2711 y=1985 ?>
          <!--CreateAConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;CreateConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="325" stubbed="0"/>
            <result name="SUCCESS&amp;&amp;!SameOldConfId" link="323" stubbed="1" >f_nReturnCode == s_nSuccess
AND bSameConferenceId == false</result>
            <result name="SUCCESS&amp;&amp;SameOldConfId" link="330" stubbed="0" >f_nReturnCode == s_nSuccess
AND bSameConferenceId == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (Session.g_strMSResourceName.length > 1)

{

	Server.logInfo("HAS MS RESOURCE NAME: " + Session.g_strMSResourceName);

	Session.g_oMS.strConferenceId = "ms/cnf/$@" + Session.g_strMSResourceName;

}
Session.g_oMS.bPersistentFlag = true;
Session.g_oMS.nConferenceMaxParties = Session.s_nConferenceMaxParties;]]></script>
            <script language="javascript" timing="middle" ><![CDATA[if (Session.strPreviousConferenceId != Session.g_oMS.strConferenceId)
{
	Session.bSameConferenceId = false;
	Server.logInfo("GOT NEW CONFERENCE ID");
}
else
{
	Session.bSameConferenceId = true;
	Server.logInfo("GOT SAME CONFERENCE ID, GO GET ANOTHER ONE");
}
Session.strPreviousConferenceId = Session.g_oMS.strConferenceId;]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (1 == Result.id)
{
	Session.g_nTerminationReason = 37;
}]]></script>
          </scripts>
        </action>
        <action id="329" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=3178 y=1986 ?>
          <!--FAIL to add a call party-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strConfControllerIpAddress" transaction="strTransactionId" message-name="s_strConfAddResponse" destination-port="nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="-9"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
            <parameter tag="&quot;dialOutRequestId&quot;" value="g_lDialOutRequestId"/>
            <parameter tag="&quot;SIPCallId&quot;" value="g_oCallLegB.strCallId"/>
          </SOAP>
          <results >
            <result name="Default" link="180" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "FAILURE TO ADD PARTY TO THE CONFERENCE";]]></script>
            <script language="javascript" timing="last" ><![CDATA[Session.g_bNeedToMoveConf = true;]]></script>
          </scripts>
        </action>
        <action id="330" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2965 y=2099 ?>
          <!--get a different conference-->
          <results >
            <result name="Default" link="328" stubbed="1"/>
            <result name="nSetConfResourceRetry&lt;3?" link="327" stubbed="1" >nSetConfResourceRetry &lt; 3</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("GET ANOTHER CONFERENCE ID");
Session.g_oMS.strConferenceId = "";
Session.nSetConfResourceRetry++;]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (1 == Result.id)
{
	Session.g_intTerminationReason = 47;
}]]></script>
          </scripts>
        </action>
        <action id="331" plug-in="Pactolus.Branch.1" ><?xtml-editor x=3450 y=2304 ?>
          <results >
            <result name="Default" link="180" stubbed="1"/>
            <result name="nSetConfResourceRetry&lt;3?" link="327" stubbed="1" >nSetConfResourceRetry &lt; 3</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.nSetConfResourceRetry++;
Server.logInfo("CONF RESOURCE INUSED, GET ANOTHER CONFERENCE ID");]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (1 == Result.id)
{
	Session.g_intTerminationReason = 47;
}]]></script>
          </scripts>
        </action>
        <action id="332" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2968 y=2939 ?>
          <!--event base conf?-->
          <results >
            <result name="Default" link="297" stubbed="1"/>
            <result name="g_nDnisIdentifiedConfFlag == 1" link="345" stubbed="1" >g_nDnisIdentifiedConfFlag == 1</result>
          </results>
        </action>
        <action id="333" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1110 y=2914 ?>
          <!--1st caller &&
speaker &&
play 1st caller-->
          <results >
            <result name="Default" link="155" stubbed="0"/>
            <result name="play first caller" link="248" stubbed="0" >g_nCurrentNbrCallegs == 1
AND g_strPlayFirstCaller match "T"
AND g_nDefaultAudioMode == 0</result>
            <result name="first caller , don't play" link="168" stubbed="1" >g_nCurrentNbrCallegs == 1
AND (g_nDefaultAudioMode != 0
OR g_strPlayFirstCaller match "F")</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (1 == Session.g_nDnisIdentifiedConfFlag)
{
	Session.nPromptFirstCaller = 4140;
}
else
{
	Session.nPromptFirstCaller = Session.s_nPromptFirstCaller;
}]]></script>
          </scripts>
        </action>
        <action id="334" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1944 y=1222 ?>
          <!--bHasPause-->
          <results >
            <result name="Default" link="144" stubbed="1"/>
            <result name="bHasPause" link="336" stubbed="1" >bHasPause == true</result>
          </results>
        </action>
        <action id="335" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1468 y=1553 ?>
          <!--bHasPause-->
          <results >
            <result name="Default" link="239" stubbed="0"/>
            <result name="bHasPause" link="343" stubbed="0" >bHasPause == true</result>
          </results>
        </action>
        <action id="336" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1849 y=1306 ?>
          <!--playDTMF?-->
          <results >
            <result name="Default" link="337" stubbed="0"/>
            <result name="array[index] == ." link="338" stubbed="0" >oSplitArray[nMyIndex] == "."
OR oSplitArray[nMyIndex] match "\."</result>
          </results>
        </action>
        <action id="337" plug-in="Pactolus.PSDtmfPlay.1" ><?xtml-editor x=2089 y=1303 ?>
          <dtmf-play xmlns="urn:www.pactolus.com:xtml:media" start-play="1" endpoint="g_oMS.strEndPoint" connection-id="g_oMS.strConnectionId" callid="g_oMS.strCallId" return-immediate="0" repeat="1" returns="f_nReturnCode" timeout="s_nTimeout" ms-type="g_oMS.strType" dg="oSplitArray[nMyIndex]" di="" dl="" da=""/>
          <results >
            <result name="Default" link="339" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="338" plug-in="Pactolus.Sleep.1" ><?xtml-editor x=2103 y=1412 ?>
          <!--2 secs-->
          <sleep xmlns="urn:www.pactolus.com:xtml:application" duration="2"/>
          <results >
            <result name="Default" link="339" stubbed="1"/>
          </results>
        </action>
        <action id="339" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2324 y=1294 ?>
          <!--done play?-->
          <results >
            <result name="Default" link="336" stubbed="1"/>
            <result name="bDonePlay" link="144" stubbed="1" >bDonePlay == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.nMyIndex++;
if (Session.nMyIndex >= Session.oSplitArray.length)
{
	Session.bDonePlay = true;
}
else
{
	Session.bDonePlay = false;
}]]></script>
          </scripts>
        </action>
        <action id="340" plug-in="Pactolus.PSDtmfPlay.1" ><?xtml-editor x=1066 y=1709 ?>
          <dtmf-play xmlns="urn:www.pactolus.com:xtml:media" start-play="1" endpoint="g_oTempConf.strEndPoint" connection-id="g_oTempConf.strConnectionId" callid="g_oTempConf.strCallId" return-immediate="0" repeat="1" returns="f_nReturnCode" timeout="s_nTimeout" ms-type="g_oTempConf.strType" dg="oSplitArray[nMyIndex]" di="" dl="" da=""/>
          <results >
            <result name="Default" link="342" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="341" plug-in="Pactolus.Sleep.1" ><?xtml-editor x=1080 y=1818 ?>
          <!--2 secs-->
          <sleep xmlns="urn:www.pactolus.com:xtml:application" duration="2"/>
          <results >
            <result name="Default" link="342" stubbed="1"/>
          </results>
        </action>
        <action id="342" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1301 y=1700 ?>
          <!--done play?-->
          <results >
            <result name="Default" link="343" stubbed="1"/>
            <result name="bDonePlay" link="239" stubbed="1" >bDonePlay == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.nMyIndex++;
if (Session.nMyIndex >= Session.oSplitArray.length)
{
	Session.bDonePlay = true;
}
else
{
	Session.bDonePlay = false;
}]]></script>
          </scripts>
        </action>
        <action id="343" plug-in="Pactolus.Branch.1" ><?xtml-editor x=826 y=1712 ?>
          <!--playDTMF?-->
          <results >
            <result name="Default" link="340" stubbed="0"/>
            <result name="array[index] == ." link="341" stubbed="0" >oSplitArray[nMyIndex] match "\."
OR oSplitArray[nMyIndex] == "."</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(" Session.oSplitArray[Session.nMyIndex] IS: " + Session.oSplitArray[Session.nMyIndex]);]]></script>
          </scripts>
        </action>
        <action id="344" plug-in="Standard.EndSession.1" ><?xtml-editor x=585 y=2942 ?></action>
        <action id="345" plug-in="Pactolus.Branch.1" ><?xtml-editor x=3196 y=2924 ?>
          <results >
            <result name="Default" link="170" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (true == Session.g_bMuteThisParty || Session.g_strMuteFlag == "T")

{

	Session.g_oMS.bMuteFlag = true;

	Session.g_bMutedState = true;

	Session.g_nPromptSelfMuteUnMute = 908;

	if ("T" == Session.g_strMuteFlag)
	{
		Session.g_bMutedByMod = true;
	}
	else
	{
		Session.g_bMutedByMod = false;
	}

}

else

{

	Session.g_oMS.bMuteFlag = false;

}

Session.g_oMS.bDeafFlag = false;

Server.logInfo("INFO: MODIFY MEMBER TO BACK TO CONFERENCE.");]]></script>
          </scripts>
        </action>
      </actions>
    </function>
    <function name="OnDTMF" start="208" event="OnDTMF" returns="void" >
      <parameters >
        <parameter name="strEndpoint" type="string"/>
        <parameter name="strRequestId" type="string"/>
        <parameter name="strDtmf" type="string"/>
      </parameters>
      <local-vars >
        <var name="f_nReturnCode" type="i4" >0</var>
        <var name="f_nCounter" type="i4" >0</var>
        <var name="f_nConfControllerPort" type="i4" >0</var>
        <var name="f_strConfControllerIP" type="string" ></var>
        <var name="f_strTransactionId" type="string" ></var>
        <var name="f_strDigit" type="string" ></var>
        <var name="f_strReturnMsg" type="string" ></var>
        <var name="f_bNullString" type="boolean" >0</var>
        <var name="f_strRecordFile" type="string" ></var>
        <var name="f_bModeratorFlag" type="boolean" >0</var>
        <var name="f_oMSObject" type="object" ></var>
        <var name="f_strConfScheduleId" type="string" ></var>
        <var name="bThirdParty" type="boolean" >0</var>
        <var name="nResultCode" type="i4" >-1</var>
      </local-vars>
      <actions >
        <action id="208" plug-in="Pactolus.Branch.1" ><?xtml-editor x=73 y=466 ?>
          <!--currently in sub conf?-->
          <results >
            <result name="Default" link="233" stubbed="0"/>
            <result name="g_bCurrentlyInSubConf" link="264" stubbed="1" >g_bCurrentlyInSubConf == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: OnDTMF");
Server.logInfo("RECEIVE DIGIT: " + Session.strDtmf);]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=2410 y=1181 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("OPERATOR REQUEST FLAG: " + Session.g_bEBCRequestCSR);
Server.logInfo("OPERATOR PRIVATE TALK REQUEST FLAG: " + Session.g_bEBCRequestPrivateCSR);]]></script>
          </scripts>
        </action>
        <action id="21" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2303 y=3960 ?>
          <!--Moderator Main Menu-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ModMainMenu&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="163" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bCurrentlyInMMenu = true;]]></script>
          </scripts>
        </action>
        <action id="22" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2202 y=1180 ?>
          <!--set DTMF Detection ON-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;SetDTMFOn&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="2" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bCurrentlyInMMenu = false;]]></script>
          </scripts>
        </action>
        <action id="27" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1721 y=1176 ?>
          <!--NonModMainMenu-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NonModMainMenu&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="213" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bCurrentlyInMMenu = true;]]></script>
          </scripts>
        </action>
        <action id="29" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1836 y=1896 ?>
          <results >
            <result name="Default" link="171" stubbed="1"/>
            <result name="*1-add party" link="32" stubbed="0" >strDtmf match "^\*{1}1$"</result>
            <result name="*2-drop last party" link="42" stubbed="0" >strDtmf match "^\*{1}2$"</result>
            <result name="*3-extent by 30 mins" link="107" stubbed="0" >strDtmf match "^\*{1}3$"
AND g_bReservationlessConf == false</result>
            <result name="*4-lock/unlock conf" link="46" stubbed="0" >strDtmf match "^\*{1}4$"</result>
            <result name="*5-mute/unmute all" link="49" stubbed="0" >strDtmf match "^\*{1}5$"</result>
            <result name="*6-count party" link="52" stubbed="0" >strDtmf match "^\*{1}6$"</result>
            <result name="*7-allow/disallow conf continue" link="232" stubbed="1" >strDtmf match "^\*{1}7$"</result>
            <result name="*8-self mute/unmute" link="68" stubbed="0" >strDtmf match "^\*{1}8$"</result>
            <result name="*0 or 00-private talk with csr" link="189" stubbed="1" >(strDtmf match "^\*{1}0$"
OR strDtmf match "^0{2}$")
AND g_bTalkingWithCSR == false
AND g_bWaitForCSR == false</result>
            <result name="*#-end conf" link="186" stubbed="0" >strDtmf match "^\*{1}\#$"</result>
            <result name="**-Main Menu" link="21" stubbed="0" >strDtmf match "^\*{2}$"</result>
            <result name="*91-Play Time" link="172" stubbed="1" >strDtmf match "^\*9{1}1$"</result>
            <result name="*92-Play Balance" link="173" stubbed="1" >strDtmf match "^\*9{1}2$"</result>
            <result name="*93-Start Record" link="177" stubbed="1" >strDtmf match "^\*{1}9{1}3{1}$"</result>
            <result name="*94-Stop Record" link="177" stubbed="1" >strDtmf match "^\*{1}9{1}4{1}$"</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (10 == Result.id)
{
	Session.g_nRequestCSRType = 1;
	Session.g_strRequestCSRPrivateTalkFlag = "T";
}
else if (17 == Result.id)
{
	Session.g_nRequestCSRType = 1;
	Session.g_strRequestCSRPrivateTalkFlag = "F";	
}]]></script>
          </scripts>
        </action>
        <action id="30" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1163 y=1249 ?>
          <!--Moderator-->
          <results >
            <result name="Default" link="31" stubbed="0"/>
            <result name="ModFlag==T" link="29" stubbed="0" >g_strModeratorFlag match "T"</result>
          </results>
        </action>
        <action id="31" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1399 y=731 ?>
          <results >
            <result name="Default" link="171" stubbed="1"/>
            <result name="*1- self mute/unmute" link="96" stubbed="0" >strDtmf match "^\*1$"</result>
            <result name="*2- party count" link="226" stubbed="1" >strDtmf match "^\*2$"</result>
            <result name="**-Main Menu" link="27" stubbed="0" >strDtmf match "^\*\*$"</result>
            <result name="*0 private talk with csr" link="189" stubbed="1" >strDtmf match "^\*{1}0{1}$"
AND g_bTalkingWithCSR == false
AND g_bWaitForCSR == false</result>
            <result name="00 csr" link="187" stubbed="1" >strDtmf match "^\0{2}$"
AND g_bTalkingWithCSR == false
AND g_bWaitForCSR == false</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (5 == Result.id)
{
	Session.g_nRequestCSRType = 1;
	Session.g_strRequestCSRPrivateTalkFlag = "T";
}
else if (6 == Result.id)
{
	Session.g_nRequestCSRType = 1;
	Session.g_strRequestCSRPrivateTalkFlag = "F";	
}]]></script>
          </scripts>
        </action>
        <action id="32" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2229 y=1286 ?>
          <!--remove from conference

add to new conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;RemoveOldAddNew&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="138" stubbed="0"/>
            <result name="SUCCESS" link="36" stubbed="0" >f_nReturnCode == s_nSuccess</result>
          </results>
        </action>
        <action id="35" plug-in="Standard.EndSession.1" ><?xtml-editor x=3421 y=1274 ?></action>
        <action id="36" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2477 y=1408 ?>
          <!--add party-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;IVRConfAddParty&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="221" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bCurrentlyInMMenu = true;]]></script>
            <script language="javascript" timing="last" ><![CDATA[Session.g_bCurrentlyInMMenu = false;]]></script>
          </scripts>
        </action>
        <action id="37" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=3190 y=1274 ?>
          <!--HangUp Caller-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpCaller&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="35" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 36;
Session.g_nConfLeaveReason = 6;
Session.g_strConfLeaveMsg = "FAIL TO MODIFY CONFERENCE";]]></script>
          </scripts>
        </action>
        <action id="39" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2715 y=1336 ?>
          <!--mute state?-->
          <results >
            <result name="Default" link="22" stubbed="1"/>
            <result name="g_bMutedState" link="215" stubbed="0" >g_bMutedState == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("CURRENT MUTE STATE IS: " + Session.g_bMutedState);

Server.logInfo("CURRENT HOLD STATE IS: " + Session.g_bHoldState);

if (Session.g_bHoldState)

{

	Session.g_oMS.bMuteFlag = true;

	Session.g_oMS.bDeafFlag = true;

}

else if (Session.g_bMutedState)

{

	Session.g_oMS.bMuteFlag = true;

	Session.g_oMS.bDeafFlag = false;

}

else

{

	Session.g_oMS.bMuteFlag = false;

	Session.g_oMS.bDeafFlag = false;

}]]></script>
          </scripts>
        </action>
        <action id="42" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2349 y=1605 ?>
          <!--getLastParty-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceConfGetLastParty&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="43" stubbed="0"/>
          </results>
        </action>
        <action id="43" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2564 y=1599 ?>
          <!--same one OR not success-->
          <results >
            <result name="Default" link="44" stubbed="0"/>
            <result name="same one or not success" link="139" stubbed="0" >g_strLastPartySessionId match g_strSessionId

OR f_nReturnCode != s_nSuccess</result>
          </results>
        </action>
        <action id="44" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=2850 y=1557 ?>
          <!--REMOVE LAST CALLER-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="s_strConfRemoveLastRequest" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="138" stubbed="1"/>
            <result name="Success" link="140" stubbed="0"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: **** DROP LAST CALLER ****");]]></script>
          </scripts>
        </action>
        <action id="45" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=2646 y=1894 ?>
          <!--EXTEND CONFERENCE-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="s_strConfExtendRequest" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;hours&quot;" value="0"/>
            <parameter tag="&quot;minutes&quot;" value="30"/>
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="138" stubbed="1"/>
            <result name="Success" link="125" stubbed="0"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_disable_event();

Server.logInfo("INFO: **** EXTEND CONF ****");]]></script>
          </scripts>
        </action>
        <action id="46" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2402 y=2216 ?>
          <!--lock/unlock?-->
          <results >
            <result name="Default" link="47" stubbed="0"/>
            <result name="unlock = 858" link="48" stubbed="0" >g_nPromptLockUnLock == 858</result>
          </results>
        </action>
        <action id="47" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=2644 y=2184 ?>
          <!--LOCK CONFERENCE-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="s_strConfLockRequest" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="138" stubbed="1"/>
            <result name="Success" link="143" stubbed="0"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: **** LOCK CONFERENCE ****");]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)

{

	Server.logError("ERROR: FAIL TO SEND SOAP MESSAGE LOCK CONFERENCE.");

}]]></script>
          </scripts>
        </action>
        <action id="48" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=2658 y=2314 ?>
          <!--UNLOCK CONFERENCE-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="s_strConfUnlockRequest" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="138" stubbed="1"/>
            <result name="Success" link="144" stubbed="0"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: **** UNLOCK CONFERENCE ****");]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)

{

	Server.logError("ERROR: FAIL TO SEND SOAP MESSAGE UNLOCK CONFERENCE.");

}]]></script>
          </scripts>
        </action>
        <action id="49" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2400 y=2513 ?>
          <!--mute/unmute-->
          <results >
            <result name="Default" link="50" stubbed="0"/>
            <result name="unmute = 860" link="51" stubbed="0" >g_nPromptMuteUnMute == 860</result>
          </results>
        </action>
        <action id="50" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=2658 y=2465 ?>
          <!--MUTE ALL-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="s_strMuteAllRequest" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="138" stubbed="1"/>
            <result name="Success" link="145" stubbed="0"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: **** MUTE ALL ****");]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)

{

	Server.logError("ERROR: FAIL TO SEND SOAP MESSAGE MUTE ALL.");

}]]></script>
          </scripts>
        </action>
        <action id="51" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=2668 y=2593 ?>
          <!--UNMUTE ALL-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="s_strUnmuteAllRequest" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="138" stubbed="1"/>
            <result name="Success" link="146" stubbed="0"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: **** UNMUTE ALL ****");]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)

{

	Server.logError("ERROR: FAIL TO SEND SOAP MESSAGE UNMUTE ALL.");

}]]></script>
          </scripts>
        </action>
        <action id="52" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2393 y=2744 ?>
          <!--"ChangeToDataMode"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ChangeToDataMode&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="53" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_oMS.bMuteFlag = true;
Session.g_oMS.bDeafFlag = true;
Server.logInfo("INFO: MOD MAIN MENU MODIFY MEMBER REMOVE FROM CONFERENCE.");]]></script>
          </scripts>
        </action>
        <action id="53" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2616 y=2741 ?>
          <!--success?-->
          <results >
            <result name="Default" link="22" stubbed="1"/>
            <result name="success?" link="226" stubbed="1" >f_nReturnCode == s_nSuccess</result>
          </results>
        </action>
        <action id="54" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2907 y=2731 ?>
          <!--count call legs-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceConfCount&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="39" stubbed="1"/>
            <result name="NbrCallLeg==1" link="55" stubbed="0" >g_nCurrentNbrCallegs == 1</result>
            <result name="NbrCallLeg &gt; 2" link="56" stubbed="0" >g_nCurrentNbrCallegs &gt;= 2</result>
          </results>
        </action>
        <action id="55" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=3259 y=2636 ?>
          <!--there is one participant-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >925</audio>
            <audio type="number" >g_nCurrentNbrCallegs</audio>
            <audio type="index" >927</audio>
            <audio type="index" >929</audio>
          </play>
          <results >
            <result name="Default" link="39" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="56" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=3278 y=2852 ?>
          <!--number of call legs-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >926</audio>
            <audio type="number" >g_nCurrentNbrCallegs</audio>
            <audio type="index" >928</audio>
            <audio type="index" >929</audio>
          </play>
          <results >
            <result name="Default" link="39" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="58" plug-in="Pactolus.Branch.1" ><?xtml-editor x=3815 y=2374 ?>
          <!--CallPartyFlag==T?-->
          <results >
            <result name="Default" link="59" stubbed="0"/>
            <result name="g_strPartyPasscodeFlag==T" link="60" stubbed="0" >g_strPartyPasscodeFlag match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_disable_event();

Server.logInfo("INFO: SEND PARTY JOIN ****");

Server.logInfo("INFO: CONF CON IP = " + Session.g_strConfControllerIP);

Server.logInfo("INFO: CONF CON PORT = " + Session.g_nConfControllerPort);

Server.logInfo("INFO: CONF CON TRANS Id = " + Session.g_strResponseTransactionId);

Server.logInfo("INFO: CONF CON MSG NAME = " + Session.s_strConfGetRoleCall);

Server.logInfo("INFO: CONF SCHED Id =  " + Session.g_strConfScheduleId);

Server.logInfo("INFO: PASSCODE = " + Session.g_strPassCode);

Server.logInfo("INFO: SOAP PORT = " + Session.g_nSoapPort);]]></script>
          </scripts>
        </action>
        <action id="59" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=4061 y=2586 ?>
          <!--GET ROLL CALL-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="s_strConfGetRoleCall" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;callerPassCode&quot;" value="g_strCCGeneratedPassCode"/>
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="61" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
        </action>
        <action id="60" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=4056 y=2465 ?>
          <!--GET ROLL CALLS-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="s_strConfGetRoleCall" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;callerPassCode&quot;" value="g_strCCGeneratedPassCode"/>
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="61" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
        </action>
        <action id="61" plug-in="Standard.WaitEvent.1" ><?xtml-editor x=4293 y=2466 ?>
          <!--ConfGetRollCallResponse-->
          <wait xmlns="urn:www.pactolus.com:xtml:communication" timeout="5" recv-name="g_strEventReceived" >
            <msg name="ConfGetRollCallResponse" >
              <parameter >f_strConfControllerIP</parameter>
              <parameter >f_nConfControllerPort</parameter>
              <parameter >f_strTransactionId</parameter>
              <parameter >g_nRecordedNameCount</parameter>
              <parameter >g_strRecordedNameURLs</parameter>
            </msg>
          </wait>
          <results >
            <result name="Default" link="39" stubbed="1"/>
            <result name="Success" link="63" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="62" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=4778 y=2774 ?>
          <!--Play the name-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;(x|*|#)&quot;" language="g_strLanguage" digits="f_strDigit" retry-count="" clear-digits="1" terminating-digit="" quick-collect="1" digit-timer="1" >
            <audio type="url" >g_oRecordedNameURLs[f_nCounter]</audio>
          </play>
          <results >
            <result name="Default" link="64" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_strDigit = "";

Server.logInfo("PLAY PARTICIPANT NAME: " + Session.g_oRecordedNameURLs[Session.f_nCounter]);]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Session.f_strDigit.length <= 0)

{

	Session.f_bNullString = true;

}

else

{

	Session.f_bNullString = false;

}]]></script>
          </scripts>
        </action>
        <action id="63" plug-in="Pactolus.Branch.1" ><?xtml-editor x=3551 y=2697 ?>
          <!--parse recorded name-->
          <results >
            <result name="Default" link="39" stubbed="1"/>
            <result name="recorded name &gt; 0" link="99" stubbed="0" >g_nRecordedNameCount &gt; 0</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nRecordedNameCount--;  //don't want to count yourself

if (Session.g_nRecordedNameCount > 0)

{

	Server.logInfo("NAMES FROM CC: " + Session.g_strRecordedNameURLs);

	Session.f_nCounter = 0;

	var i = 0;

	var token = Clib.strtok(Session.g_strRecordedNameURLs, ";");

	while (null != token)

	{

		Server.logInfo("TOKEN IS NOT NULL");

		if (Clib.strcmp(Session.g_strCallerRecordedName, token) != 0)

		{

			Server.logInfo("TOKEN IS NOT THE SAME AS CALLER NAME");

			Session.g_oRecordedNameURLs[i] = token;

			Server.logInfo("RECORDED NAME: " + Session.g_oRecordedNameURLs[i]);

			i++;

		}

		token = Clib.strtok(null, ";");

	}

}]]></script>
          </scripts>
        </action>
        <action id="64" plug-in="Pactolus.Branch.1" ><?xtml-editor x=5030 y=2773 ?>
          <!--hear more name?-->
          <results >
            <result name="Default" link="39" stubbed="1"/>
            <result name="no digit and more name" link="157" stubbed="1" >f_bNullString == true

AND f_nCounter &lt; g_nRecordedNameCount</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_nCounter++;]]></script>
          </scripts>
        </action>
        <action id="65" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2461 y=2944 ?>
          <!--allow/disallow-->
          <results >
            <result name="Default" link="66" stubbed="0"/>
            <result name="disallow= 902" link="67" stubbed="0" >g_nPromptAllowDisallow == 902</result>
          </results>
        </action>
        <action id="66" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=2684 y=2894 ?>
          <!--CONF_CONTINUE_REQUEST-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="s_strConfContinueRequest" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="138" stubbed="1"/>
            <result name="Success" link="147" stubbed="0"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: **** CONF CONTINUE REQUEST ****");]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)

{

	Server.logError("ERROR: FAIL TO SEND SOAP MESSAGE CONF_CONTINUE_REQUEST.");

}]]></script>
          </scripts>
        </action>
        <action id="67" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=2698 y=3067 ?>
          <!--CONF_DISCONTINUE_REQUEST-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="s_strConfDiscontinueRequest" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="138" stubbed="1"/>
            <result name="Success" link="148" stubbed="0"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: **** CONF DISCONTINUE REQUEST ****");]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)

{

	Server.logError("ERROR: FAIL TO SEND SOAP MESSAGE CONF_DISCONTINUE_REQUEST.");

}]]></script>
          </scripts>
        </action>
        <action id="68" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2358 y=3205 ?>
          <!--selfmute/unmute-->
          <results >
            <result name="Default" link="128" stubbed="0"/>
            <result name="self muted == 908" link="131" stubbed="0" >g_nPromptSelfMuteUnMute == 908</result>
          </results>
        </action>
        <action id="69" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=3116 y=3194 ?>
          <!--SELF MUTE PARTY-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="s_strConfMutePartyEvent" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;callerPassCode&quot;" value="g_strCCGeneratedPassCode"/>
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="149" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: **** SELF MUTE ****");]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)

{

	Server.logError("ERROR: FAIL TO SEND SOAP MESSAGE MUTE YOUR OWN LINE.");

}]]></script>
          </scripts>
        </action>
        <action id="70" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=3116 y=3346 ?>
          <!--SELF UNMUTE PARTY-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="g_strResponseTransactionId" message-name="s_strConfUnmutePartyEvent" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;callerPassCode&quot;" value="g_strCCGeneratedPassCode"/>
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="150" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: **** SELF UNMUTE ****");]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)

{

	Server.logError("ERROR: FAIL TO SEND SOAP MESSAGE UNMUTE YOUR OWN LINE.");

}]]></script>
          </scripts>
        </action>
        <action id="71" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=2526 y=3838 ?>
          <!--END CONFERENCE-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="s_strConfEndRequest" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="138" stubbed="1"/>
            <result name="Success" link="151" stubbed="0"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: **** END CONFERENCE ****");]]></script>
          </scripts>
        </action>
        <action id="72" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2961 y=3817 ?>
          <!--HangUp Caller-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpCaller&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="74" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 13;
Session.g_nConfLeaveReason = 8;
Session.g_strConfLeaveMsg = "MODERATOR PRESS DTMF TO END CONFERENCE";]]></script>
          </scripts>
        </action>
        <action id="74" plug-in="Standard.EndSession.1" ><?xtml-editor x=3186 y=3814 ?></action>
        <action id="88" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=2644 y=639 ?>
          <!--SELF MUTE PARTY-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="s_strConfMutePartyEvent" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;callerPassCode&quot;" value="g_strCCGeneratedPassCode"/>
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="153" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: **** SELF MUTE ****");]]></script>
          </scripts>
        </action>
        <action id="89" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=2894 y=880 ?>
          <!--SELF UNMUTE PARTY-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="s_strConfUnmutePartyEvent" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;callerPassCode&quot;" value="g_strCCGeneratedPassCode"/>
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="154" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: **** SELF UNMUTE ****");]]></script>
          </scripts>
        </action>
        <action id="90" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2665 y=925 ?>
          <!--CallPartyFlag==T?-->
          <results >
            <result name="Default" link="89" stubbed="0"/>
            <result name="g_strPartyPasscodeFlag==T" link="91" stubbed="0" >g_strPartyPasscodeFlag match "T"</result>
          </results>
        </action>
        <action id="91" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=2906 y=1020 ?>
          <!--SELF UNMUTE PARTY-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="s_strConfUnmutePartyEvent" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;callerPassCode&quot;" value="g_strCCGeneratedPassCode"/>
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="154" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: **** SELF UNMUTE ****");]]></script>
          </scripts>
        </action>
        <action id="92" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2422 y=686 ?>
          <!--CallPartyFlag==T?-->
          <results >
            <result name="Default" link="88" stubbed="0"/>
            <result name="g_strPartyPasscodeFlag==T" link="93" stubbed="0" >g_strPartyPasscodeFlag match "T"</result>
          </results>
        </action>
        <action id="93" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=2666 y=784 ?>
          <!--SELF MUTE PARTY-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="s_strConfMutePartyEvent" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;callerPassCode&quot;" value="g_strCCGeneratedPassCode"/>
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="153" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: **** SELF MUTE ****");]]></script>
          </scripts>
        </action>
        <action id="94" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1968 y=911 ?>
          <!--Mute by mod?-->
          <results >
            <result name="Default" link="134" stubbed="0"/>
            <result name="mutebymod==true" link="152" stubbed="0" >g_bMutedByMod == true</result>
          </results>
        </action>
        <action id="96" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1719 y=785 ?>
          <!--selfmute/unmute-->
          <results >
            <result name="Default" link="133" stubbed="0"/>
            <result name="self muted == 908" link="94" stubbed="0" >g_nPromptSelfMuteUnMute == 908</result>
          </results>
        </action>
        <action id="98" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=3792 y=2808 ?>
          <!--here are the names-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >944</audio>
          </play>
          <results >
            <result name="Default" link="99" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="99" plug-in="Pactolus.Branch.1" ><?xtml-editor x=4020 y=2689 ?>
          <!--parse recorded name-->
          <results >
            <result name="Default" link="157" stubbed="0"/>
            <result name="recorded name &gt; 5" link="100" stubbed="0" >g_nRecordedNameCount &gt; 5</result>
          </results>
        </action>
        <action id="100" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=4275 y=2788 ?>
          <!--press * to return to conf-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >320</audio>
            <audio type="index" >905</audio>
          </play>
          <results >
            <result name="Default" link="157" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="101" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=3273 y=3588 ?>
          <!--"CSRBeginRequest"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;CSRBeginRequest&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="166" stubbed="0"/>
            <result name="SUCCESS" link="245" stubbed="0" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_disable_event();

Session.g_nCSRRouteReasonCode = 3;  //mod zero out

if (true == Session.g_bCurrentlyInSubConf)

{

	Session.g_strCSRRequestEndPoint = Session.g_oSubConfMS.strConferenceId;

}

else

{

	Session.g_strCSRRequestEndPoint = Session.g_oMS.strConferenceId;

}]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (2 == Result.id)

{

	Session.g_nCallerCurrentState = Session.s_nStateZeroOutToCsr;

	Session.g_bZeroOutToCSR = true;

	js_enable_event();

}]]></script>
          </scripts>
        </action>
        <action id="104" plug-in="Standard.Timer.1" ><?xtml-editor x=2850 y=3591 ?>
          <!--play beep beep every 10 secs-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lBeepBeepTimerId" duration="s_nSleepTime"/>
          <results >
            <result name="Default" link="105" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bBeepBeepTimerFlag = true;]]></script>
          </scripts>
        </action>
        <action id="105" plug-in="Standard.Timer.1" ><?xtml-editor x=3063 y=3591 ?>
          <!--set max wait time for CSR-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lWaitCSRTimerId" duration="s_nCsrHoldTime"/>
          <results >
            <result name="Default" link="101" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bWaitCSRTimerSet = true;]]></script>
          </scripts>
        </action>
        <action id="107" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2383 y=1965 ?>
          <!--option avail?-->
          <results >
            <result name="Default" link="45" stubbed="0"/>
            <result name="g_nScheduleDuration &lt;= 0?" link="141" stubbed="0" >g_nScheduleDuration &lt;= 0</result>
          </results>
        </action>
        <action id="109" plug-in="Pactolus.Branch.1" ><?xtml-editor x=3552 y=2472 ?>
          <!--record option on?-->
          <results >
            <result name="Default" link="39" stubbed="1"/>
            <result name="g_strRecordNameFlag == &quot;T&quot;" link="58" stubbed="0" >g_strRecordNamesFlag match "T"</result>
          </results>
        </action>
        <action id="125" plug-in="Standard.WaitEvent.1" ><?xtml-editor x=2876 y=1885 ?>
          <!--Extend conf response-->
          <wait xmlns="urn:www.pactolus.com:xtml:communication" timeout="5" recv-name="g_strEventReceived" >
            <msg name="ExtendConferenceResponse" >
              <parameter >f_strConfControllerIP</parameter>
              <parameter >f_nConfControllerPort</parameter>
              <parameter >f_strTransactionId</parameter>
              <parameter >f_nReturnCode</parameter>
              <parameter >f_strReturnMsg</parameter>
            </msg>
          </wait>
          <results >
            <result name="Default" link="138" stubbed="1"/>
            <result name="Success" link="126" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_nReturnCode = -1;]]></script>
            <script language="javascript" timing="last" ><![CDATA[js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="126" plug-in="Pactolus.Branch.1" ><?xtml-editor x=3112 y=1878 ?>
          <!--success?-->
          <results >
            <result name="Default" link="138" stubbed="1"/>
            <result name="f_nReturnCode == 0" link="142" stubbed="0" >f_nReturnCode == 0</result>
          </results>
        </action>
        <action id="128" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2606 y=3194 ?>
          <!--mute state?-->
          <results >
            <result name="Default" link="216" stubbed="0"/>
            <result name="g_bMutedState" link="216" stubbed="1" >g_bMutedState == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("CURRENT MUTE STATE IS: " + Session.g_bMutedState);

Server.logInfo("CURRENT HOLD STATE IS: " + Session.g_bHoldState);

Session.g_bMutedState = true;

if (Session.g_bHoldState)

{

	Session.g_oMS.bMuteFlag = true;

	Session.g_oMS.bDeafFlag = true;

}

else if (Session.g_bMutedState)

{

	Session.g_oMS.bMuteFlag = true;

	Session.g_oMS.bDeafFlag = false;

}

else

{

	Session.g_oMS.bMuteFlag = false;

	Session.g_oMS.bDeafFlag = false;

}]]></script>
          </scripts>
        </action>
        <action id="131" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2624 y=3343 ?>
          <!--mute state?-->
          <results >
            <result name="Default" link="217" stubbed="0"/>
            <result name="!g_bMutedState" link="217" stubbed="1" >g_bMutedState == false</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("CURRENT MUTE STATE IS: " + Session.g_bMutedState);

Server.logInfo("CURRENT HOLD STATE IS: " + Session.g_bHoldState);

Session.g_bMutedState = false;

if (Session.g_bHoldState)

{

	Session.g_oMS.bMuteFlag = true;

	Session.g_oMS.bDeafFlag = true;

}

else if (Session.g_bMutedState)

{

	Session.g_oMS.bMuteFlag = true;

	Session.g_oMS.bDeafFlag = false;

}

else

{

	Session.g_oMS.bMuteFlag = false;

	Session.g_oMS.bDeafFlag = false;

}]]></script>
          </scripts>
        </action>
        <action id="133" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1954 y=708 ?>
          <!--mute state?-->
          <results >
            <result name="Default" link="218" stubbed="0"/>
            <result name="g_bMutedState" link="218" stubbed="1" >g_bMutedState == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("CURRENT MUTE STATE IS: " + Session.g_bMutedState);

Server.logInfo("CURRENT HOLD STATE IS: " + Session.g_bHoldState);

Session.g_bMutedState = true;

if (Session.g_bHoldState)

{

	Session.g_oMS.bMuteFlag = true;

	Session.g_oMS.bDeafFlag = true;

}

else if (Session.g_bMutedState)

{

	Session.g_oMS.bMuteFlag = true;

	Session.g_oMS.bDeafFlag = false;

}

else

{

	Session.g_oMS.bMuteFlag = false;

	Session.g_oMS.bDeafFlag = false;

}]]></script>
          </scripts>
        </action>
        <action id="134" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2192 y=904 ?>
          <!--mute state?-->
          <results >
            <result name="Default" link="219" stubbed="0"/>
            <result name="!g_bMutedState" link="219" stubbed="1" >g_bMutedState == false</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("CURRENT MUTE STATE IS: " + Session.g_bMutedState);

Server.logInfo("CURRENT HOLD STATE IS: " + Session.g_bHoldState);

Session.g_bMutedState = false;

if (Session.g_bHoldState)

{

	Session.g_oMS.bMuteFlag = true;

	Session.g_oMS.bDeafFlag = true;

}

else if (Session.g_bMutedState)

{

	Session.g_oMS.bMuteFlag = true;

	Session.g_oMS.bDeafFlag = false;

}

else

{

	Session.g_oMS.bMuteFlag = false;

	Session.g_oMS.bDeafFlag = false;

}]]></script>
          </scripts>
        </action>
        <action id="138" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2460 y=1264 ?>
          <!--can't complete transaction-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="f_oMSObject.strConnectionId" endpoint="f_oMSObject.strEndPoint" callid="f_oMSObject.strCallId" repeat="1" timeout="10" ms-type="f_oMSObject.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >363</audio>
          </play>
          <results >
            <result name="Default" link="22" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (true == Session.g_bCurrentlyInSubConf)

{

	Session.f_oMSObject = Session.g_oSubConfMS;

}

else

{

	Session.f_oMSObject = Session.g_oMS;

}]]></script>
          </scripts>
        </action>
        <action id="139" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2866 y=1713 ?>
          <!--invalid choice-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >337</audio>
          </play>
          <results >
            <result name="Default" link="22" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="140" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=3103 y=1553 ?>
          <!--party dropped-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >915</audio>
          </play>
          <results >
            <result name="Default" link="22" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="141" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2655 y=2038 ?>
          <!--option not avail-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >524</audio>
          </play>
          <results >
            <result name="Default" link="22" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="142" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=3358 y=1877 ?>
          <!--conf extended-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >879</audio>
          </play>
          <results >
            <result name="Default" link="22" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="143" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2897 y=2178 ?>
          <!--conf is locked-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >914</audio>
          </play>
          <results >
            <result name="Default" link="22" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nPromptLockUnLock = 858;]]></script>
          </scripts>
        </action>
        <action id="144" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2901 y=2319 ?>
          <!--conf is unlocked-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >932</audio>
          </play>
          <results >
            <result name="Default" link="22" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nPromptLockUnLock = 857;]]></script>
          </scripts>
        </action>
        <action id="145" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2906 y=2461 ?>
          <!--all muted-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >919</audio>
          </play>
          <results >
            <result name="Default" link="22" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nPromptMuteUnMute = 860;]]></script>
          </scripts>
        </action>
        <action id="146" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2910 y=2602 ?>
          <!--all unmuted-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >921</audio>
          </play>
          <results >
            <result name="Default" link="22" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nPromptMuteUnMute = 859;]]></script>
          </scripts>
        </action>
        <action id="147" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2928 y=2896 ?>
          <!--continue @out mod-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >923</audio>
          </play>
          <results >
            <result name="Default" link="22" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nPromptAllowDisallow = 902;]]></script>
          </scripts>
        </action>
        <action id="148" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2945 y=3067 ?>
          <!--discontinue @out mod-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >922</audio>
          </play>
          <results >
            <result name="Default" link="22" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nPromptAllowDisallow = 901;]]></script>
          </scripts>
        </action>
        <action id="149" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=3370 y=3189 ?>
          <!--your line is muted-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >s_nPromptMuted</audio>
          </play>
          <results >
            <result name="Default" link="22" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nPromptSelfMuteUnMute = 908;]]></script>
          </scripts>
        </action>
        <action id="150" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=3371 y=3339 ?>
          <!--your line unmuted-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >s_nPromptUnmuted</audio>
          </play>
          <results >
            <result name="Default" link="22" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nPromptSelfMuteUnMute = 907;]]></script>
          </scripts>
        </action>
        <action id="151" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2745 y=3823 ?>
          <!--conf will end-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >916</audio>
          </play>
          <results >
            <result name="Default" link="72" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="152" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2205 y=1033 ?>
          <!--can't unmute-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >933</audio>
          </play>
          <results >
            <result name="Default" link="22" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="153" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2894 y=638 ?>
          <!--your line is muted-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >s_nPromptMuted</audio>
          </play>
          <results >
            <result name="Default" link="22" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nPromptSelfMuteUnMute = 908;]]></script>
          </scripts>
        </action>
        <action id="154" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=3161 y=884 ?>
          <!--your line is unmuted-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >s_nPromptUnmuted</audio>
          </play>
          <results >
            <result name="Default" link="22" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nPromptSelfMuteUnMute = 907;]]></script>
          </scripts>
        </action>
        <action id="155" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2625 y=3453 ?>
          <!--beep - beep (340)-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="0" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >340</audio>
          </play>
          <results >
            <result name="Default" link="104" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="156" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2604 y=3577 ?>
          <!--CSR will join you shortly-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="f_oMSObject.strConnectionId" endpoint="f_oMSObject.strEndPoint" callid="f_oMSObject.strCallId" repeat="1" timeout="10" ms-type="f_oMSObject.strType" returns="" start-play="1" interrupt="0" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >1506</audio>
            <audio type="silence" >0.2</audio>
            <audio type="index" >340</audio>
          </play>
          <results >
            <result name="Default" link="104" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (true == Session.g_bCurrentlyInSubConf)

{

	Session.f_oMSObject = Session.g_oSubConfMS;

}

else

{

	Session.f_oMSObject = Session.g_oMS;

}]]></script>
          </scripts>
        </action>
        <action id="157" plug-in="Pactolus.Branch.1" ><?xtml-editor x=4547 y=2774 ?>
          <!--null string-->
          <results >
            <result name="Default" link="62" stubbed="0"/>
            <result name="f_bNullString == true" link="64" stubbed="1" >f_bNullString == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("RECORDED NAME LENGTH IS:  " + Session.g_oRecordedNameURLs[Session.f_nCounter].length);

if (Session.g_oRecordedNameURLs[Session.f_nCounter].length <= 1)

{

	Session.f_bNullString = true;

}

else

{

	Session.f_bNullString = false;

}]]></script>
          </scripts>
        </action>
        <action id="160" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1886 y=2234 ?>
          <!--"GetAndPlayTime"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;GetAndPlayTime&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="22" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_disable_event();]]></script>
            <script language="javascript" timing="last" ><![CDATA[js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="161" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1880 y=2357 ?>
          <!--"GetAndPlayBalance"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;GetAndPlayBalance&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="22" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_disable_event();]]></script>
            <script language="javascript" timing="last" ><![CDATA[js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="162" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2188 y=3597 ?>
          <!--ACD on?-->
          <results >
            <result name="Default" link="22" stubbed="1"/>
            <result name="ACD enable ==&quot;T&quot;" link="244" stubbed="0" >g_strACDEnable match "T"</result>
          </results>
        </action>
        <action id="163" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2531 y=3957 ?>
          <!--wait for CSR-->
          <results >
            <result name="Default" link="22" stubbed="1"/>
            <result name="wait for CSR" link="2" stubbed="1" >g_bWaitForCSR == true
OR g_bTalkingWithCSR == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bCurrentlyInMMenu = false;]]></script>
          </scripts>
        </action>
        <action id="166" plug-in="Standard.Timer.1" ><?xtml-editor x=3486 y=3586 ?>
          <!--stop beep beep-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="0" id="g_lBeepBeepTimerId" duration=""/>
          <results >
            <result name="Default" link="167" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bBeepBeepTimerFlag = false;]]></script>
          </scripts>
        </action>
        <action id="167" plug-in="Standard.Timer.1" ><?xtml-editor x=3703 y=3582 ?>
          <!--stop max wait time for CSR-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="0" id="g_lWaitCSRTimerId" duration=""/>
          <results >
            <result name="Default" link="138" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bWaitCSRTimerSet = false;]]></script>
          </scripts>
        </action>
        <action id="168" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1888 y=2451 ?>
          <!--start record-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="" transaction="" message-name="&quot;ConfStartRecord&quot;" destination-port="" destination-type="1" destination-session="" waiting-session-selected="g_strRecordedSessionId" xml-namespace="" >
            <parameter tag="&quot;calling_number&quot;" value="g_oMS.strConferenceId"/>
            <parameter tag="" value="g_oMS.strType"/>
            <parameter tag="&quot;called_number&quot;" value="f_strRecordFile"/>
          </SOAP>
          <results >
            <result name="Default" link="22" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: SEND START RECORDING conference id is: " + Session.g_oMS.strConferenceId);

//Session.g_strRecordFileName = Session._sessionId + Server.getUTCTime() + ".wav";

Session.g_strRecordFileName = Server.getUTCTime();

Session.f_strRecordFile = Session.g_strRecordLocation + Session.g_strRecordFileName;]]></script>
            <script language="javascript" timing="last" ><![CDATA[Server.logInfo("INFO: SENT RECORD CONFERENCE TO session Id is: " + Session.g_strRecordedSessionId);]]></script>
          </scripts>
        </action>
        <action id="169" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1893 y=2625 ?>
          <!--stop record-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="" transaction="" message-name="&quot;ConfStopRecord&quot;" destination-port="" destination-type="3" destination-session="g_strRecordedSessionId" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;calling_number&quot;" value="g_oMS.strConferenceId"/>
            <parameter tag="" value="g_oMS.strType"/>
            <parameter tag="&quot;called_number&quot;" value="f_strRecordFile"/>
          </SOAP>
          <results >
            <result name="Default" link="22" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: SEND STOP RECORDING conference id is: " + Session.g_oMS.strConferenceId);]]></script>
            <script language="javascript" timing="last" ><![CDATA[Server.logInfo("INFO: SENT RECORD CONFERENCE TO session Id is: " + Session.g_strRecordedSessionId);]]></script>
          </scripts>
        </action>
        <action id="171" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1476 y=1232 ?>
          <!--wait for CSR-->
          <results >
            <result name="Default" link="22" stubbed="1"/>
            <result name="wait for CSR" link="2" stubbed="1" >g_bWaitForCSR == true
OR g_bTalkingWithCSR == true</result>
          </results>
        </action>
        <action id="172" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1647 y=2235 ?>
          <!--prepaid conference-->
          <results >
            <result name="Default" link="171" stubbed="1"/>
            <result name="billing type == 1?" link="160" stubbed="0" >g_nBillingType == 1</result>
          </results>
        </action>
        <action id="173" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1648 y=2361 ?>
          <!--prepaid conference-->
          <results >
            <result name="Default" link="171" stubbed="1"/>
            <result name="billing type == 1?" link="161" stubbed="0" >g_nBillingType == 1</result>
          </results>
        </action>
        <action id="174" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1342 y=3168 ?>
          <!--conf rec ON-->
          <results >
            <result name="Default" link="171" stubbed="1"/>
            <result name="ConfRecordAllowed == T" link="175" stubbed="0" >g_strConfRecordAllowed match "T"</result>
          </results>
        </action>
        <action id="175" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1583 y=3168 ?>
          <!--START_RECORD_REQUEST-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="s_strStartRecordRequest" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace=""/>
          <results >
            <result name="Default" link="176" stubbed="0"/>
            <result name="Success" link="182" stubbed="0"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)

{

	Server.logError("ERROR: FAIL TO SEND START RECORD REQUEST TO CONF CONTROLLER.");

	Server.logError("ERROR: CONF CONTROLLER IP: " + Session.g_strConfControllerIP);

	Server.logError("ERROR: CONF CONTROLLER PORT: " + Session.g_nConfControllerPort);

}]]></script>
          </scripts>
        </action>
        <action id="176" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1838 y=3162 ?>
          <!--fail to start record-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >957</audio>
          </play>
          <results >
            <result name="Default" link="180" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="177" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1107 y=3069 ?>
          <!--start or stop-->
          <results >
            <result name="Default" link="179" stubbed="0"/>
            <result name="start" link="174" stubbed="0"/>
          </results>
        </action>
        <action id="178" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1542 y=2833 ?>
          <!--fail to stop record-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >958</audio>
          </play>
          <results >
            <result name="Default" link="180" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="179" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1325 y=3009 ?>
          <!--STOP_RECORD_REQUEST-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="s_strStopRecordRequest" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace=""/>
          <results >
            <result name="Default" link="178" stubbed="0"/>
            <result name="Success" link="184" stubbed="0"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)

{

	Server.logError("ERROR: FAIL TO SEND STOP RECORD REQUEST TO CONF CONTROLLER.");

	Server.logError("ERROR: CONF CONTROLLER IP: " + Session.g_strConfControllerIP);

	Server.logError("ERROR: CONF CONTROLLER PORT: " + Session.g_nConfControllerPort);

}]]></script>
          </scripts>
        </action>
        <action id="180" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1778 y=2831 ?>
          <!--HangUp Caller-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpCaller&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="74" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 40;
Session.g_nConfLeaveReason = 7;
Session.g_strConfLeaveMsg = "FAIL TO SEND START/STOP RECORD TO CC";]]></script>
          </scripts>
        </action>
        <action id="181" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1651 y=3353 ?>
          <!--record started-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >955</audio>
          </play>
          <results >
            <result name="Default" link="171" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="182" plug-in="Standard.WaitEvent.1" ><?xtml-editor x=1351 y=3360 ?>
          <wait xmlns="urn:www.pactolus.com:xtml:communication" timeout="10" recv-name="g_strEventReceived" >
            <msg name="StartRecordResponse" >
              <parameter >f_nReturnCode</parameter>
              <parameter >g_strReturnMsg</parameter>
            </msg>
          </wait>
          <results >
            <result name="Default" link="176" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
            <result name="SUCCESS" link="181" stubbed="0" >'Result'  == 'Success'

AND f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_nReturnCode = -50;

Session.g_strReturnMsg = "";]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 5)

{

	Server.logError("ERROR: FAIL TO WAIT FOR START RECORD RESPONSE");

	Server.logError("ERROR: EXIT ON: " + Result.name);

	Server.logError("ERROR: RETURN CODE: " + Session.f_nReturnCode);

	Server.logError("ERROR: RETURN MESSAGE: " + Session.g_strReturnMsg);

}]]></script>
          </scripts>
        </action>
        <action id="183" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1870 y=3006 ?>
          <!--record stopped-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >956</audio>
          </play>
          <results >
            <result name="Default" link="171" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="184" plug-in="Standard.WaitEvent.1" ><?xtml-editor x=1570 y=3013 ?>
          <wait xmlns="urn:www.pactolus.com:xtml:communication" timeout="10" recv-name="g_strEventReceived" >
            <msg name="StopRecordResponse" >
              <parameter >f_nReturnCode</parameter>
              <parameter >g_strReturnMsg</parameter>
            </msg>
          </wait>
          <results >
            <result name="Default" link="178" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
            <result name="SUCCESS" link="183" stubbed="0" >'Result'  == 'Success'

AND f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_nReturnCode = -50;

Session.g_strReturnMsg = "";]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 5)

{

	Server.logError("ERROR: FAIL TO WAIT FOR STOP RECORD RESPONSE");

	Server.logError("ERROR: EXIT ON: " + Result.name);

	Server.logError("ERROR: RETURN CODE: " + Session.f_nReturnCode);

	Server.logError("ERROR: RETURN MESSAGE: " + Session.g_strReturnMsg);

}]]></script>
          </scripts>
        </action>
        <action id="186" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2305 y=3782 ?>
          <!--Are you sure want the conference to end?-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="13" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;(x|*|#)&quot;" language="g_strLanguage" digits="f_strDigit" retry-count="1" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >916</audio>
            <audio type="index" >311</audio>
            <audio type="index" >582</audio>
            <timeout-prompt type="index" >s_nPromptNoResponse</timeout-prompt>
          </play>
          <results >
            <result name="Default" link="22" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
            <result name="strDigit = 1" link="71" stubbed="0" >f_strDigit match "1"</result>
          </results>
        </action>
        <action id="187" plug-in="Pactolus.Branch.1" ><?xtml-editor x=650 y=444 ?>
          <!--operator assist type-->
          <results >
            <result name="Default" link="22" stubbed="1"/>
            <result name="(type 0 and mod) or type 1" link="230" stubbed="0" >(g_nOperatorAssistType == 0
AND f_bModeratorFlag == true)
OR g_nOperatorAssistType == 1</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("OPERATOR ASSIST TYPE: " + Session.g_nOperatorAssistType);
Server.logInfo("ACD ENABLE FLAG: " + Session.g_strACDEnable);
Server.logInfo("MODERATOR FLAG: " + Session.g_strModeratorFlag);
if ("T" == Session.g_strModeratorFlag)
{
	Session.f_bModeratorFlag = true;
}
else
{
	Session.f_bModeratorFlag = false;
}]]></script>
          </scripts>
        </action>
        <action id="188" plug-in="Pactolus.Branch.1" ><?xtml-editor x=334 y=459 ?>
          <!--what digit?-->
          <results >
            <result name="Default" link="193" stubbed="0"/>
            <result name="*" link="187" stubbed="0" >strDtmf match "^\*{1}$"</result>
            <result name="*1" link="205" stubbed="0" >strDtmf match "^\*{1}1$"</result>
            <result name="**" link="189" stubbed="0" >strDtmf match "^\*{2}$"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[//request csr via IVR

Session.g_nRequestCSRType = 1;

Server.logInfo("RECEIVE DIGIT: " + Session.strDtmf);]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (3 == Result.id)

{

	Session.g_strRequestCSRPrivateTalkFlag = "T";

}

else

{

	Session.g_strRequestCSRPrivateTalkFlag = "F";	

}]]></script>
          </scripts>
        </action>
        <action id="189" plug-in="Pactolus.Branch.1" ><?xtml-editor x=614 y=738 ?>
          <!--operator assist type-->
          <results >
            <result name="Default" link="22" stubbed="1"/>
            <result name="(type 0 and mod) or type 1" link="190" stubbed="1" >((g_nOperatorAssistType == 0
AND f_bModeratorFlag == true)
OR g_nOperatorAssistType == 1)
AND g_strACDEnable match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if ("T" == Session.g_strModeratorFlag)

{

	Session.f_bModeratorFlag = true;

}

else

{

	Session.f_bModeratorFlag = false;

}]]></script>
          </scripts>
        </action>
        <action id="190" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=857 y=741 ?>
          <!--"SideBarOperatorRequest"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;SideBarOperatorRequest&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="22" stubbed="1"/>
            <result name="SUCCESS" link="2" stubbed="1" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_nReturnCode = -1;]]></script>
            <script language="javascript" timing="last" ><![CDATA[js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="192" plug-in="Pactolus.Branch.1" ><?xtml-editor x=812 y=255 ?>
          <results >
            <result name="Default" link="22" stubbed="1"/>
            <result name="#1 Participant Count" link="52" stubbed="1" >strDtmf match "^\#1$"</result>
            <result name="#2 Roll Call" link="109" stubbed="1" >strDtmf match "^\#2$"</result>
            <result name="#3 Outdial Participant" link="32" stubbed="1" >strDtmf match "^\#3$"</result>
            <result name="#4 Lock/unlock conf" link="46" stubbed="1" >strDtmf match "^\#4$"</result>
            <result name="#5 Mute/unmute conf" link="49" stubbed="1" >strDtmf match "^\#5$"</result>
            <result name="#6 continue/discontinue" link="232" stubbed="1" >strDtmf match "^\#6$"</result>
            <result name="## Main Menu" link="21" stubbed="1" >strDtmf match "^\##$"</result>
          </results>
        </action>
        <action id="193" plug-in="Pactolus.Branch.1" ><?xtml-editor x=555 y=258 ?>
          <!--in sub conf?-->
          <results >
            <result name="Default" link="22" stubbed="1"/>
            <result name="g_strModeratorFlag==T" link="192" stubbed="0" >g_strModeratorFlag match "T"</result>
          </results>
        </action>
        <action id="194" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1360 y=382 ?>
          <!--UnmutePartyRequest-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="s_strUnmutePartyRequest" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;callerPassCode&quot;" value="g_strCCGeneratedPassCode"/>
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="197" stubbed="1"/>
            <result name="Success" link="195" stubbed="0"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_disable_event();

Server.logInfo("INFO: **** UNMUTE PARTY REQUEST ****");]]></script>
          </scripts>
        </action>
        <action id="195" plug-in="Standard.WaitEvent.1" ><?xtml-editor x=1586 y=223 ?>
          <!--UnmutePartyResponse-->
          <wait xmlns="urn:www.pactolus.com:xtml:communication" timeout="5" recv-name="g_strEventReceived" >
            <msg name="UnmutePartyResponse" >
              <parameter >f_strConfControllerIP</parameter>
              <parameter >f_nConfControllerPort</parameter>
              <parameter >f_strTransactionId</parameter>
              <parameter >f_nReturnCode</parameter>
              <parameter >f_strReturnMsg</parameter>
            </msg>
          </wait>
          <results >
            <result name="Default" link="197" stubbed="1"/>
            <result name="Success" link="196" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_nReturnCode = -1;]]></script>
            <script language="javascript" timing="last" ><![CDATA[js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="196" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1817 y=252 ?>
          <!--success?-->
          <results >
            <result name="Default" link="197" stubbed="0"/>
            <result name="f_nReturnCode == 0" link="220" stubbed="0" >f_nReturnCode == 0</result>
          </results>
        </action>
        <action id="197" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2057 y=133 ?>
          <!--can't unmute-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >933</audio>
          </play>
          <results >
            <result name="Default" link="22" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="198" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=2574 y=450 ?>
          <!--SELF UNMUTE PARTY-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="g_strResponseTransactionId" message-name="s_strConfUnmutePartyEvent" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;callerPassCode&quot;" value="g_strCCGeneratedPassCode"/>
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="200" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: **** SELF UNMUTE ****");]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)

{

	Server.logError("ERROR: FAIL TO SEND SOAP MESSAGE UNMUTE YOUR OWN LINE.");

}]]></script>
          </scripts>
        </action>
        <action id="200" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2829 y=449 ?>
          <!--your line unmuted-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >s_nPromptUnmuted</audio>
          </play>
          <results >
            <result name="Default" link="22" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nPromptSelfMuteUnMute = 907;

Session.g_bMutedState = false;]]></script>
          </scripts>
        </action>
        <action id="201" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1047 y=267 ?>
          <!--CallPartyFlag==T?-->
          <results >
            <result name="Default" link="202" stubbed="0"/>
            <result name="g_strPartyPasscodeFlag==T" link="194" stubbed="0" >g_strPartyPasscodeFlag match "T"</result>
          </results>
        </action>
        <action id="202" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1344 y=243 ?>
          <!--UnmutePartyRequest-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="s_strUnmutePartyRequest" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;callerPassCode&quot;" value="g_strCCGeneratedPassCode"/>
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="197" stubbed="1"/>
            <result name="Success" link="195" stubbed="1"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_disable_event();

Server.logInfo("INFO: **** UNMUTE PARTY REQUEST ****");]]></script>
          </scripts>
        </action>
        <action id="203" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2311 y=341 ?>
          <!--CallPartyFlag==T?-->
          <results >
            <result name="Default" link="204" stubbed="0"/>
            <result name="g_strPartyPasscodeFlag==T" link="198" stubbed="0" >g_strPartyPasscodeFlag match "T"</result>
          </results>
        </action>
        <action id="204" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=2554 y=331 ?>
          <!--SELF UNMUTE PARTY-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="g_strResponseTransactionId" message-name="s_strConfUnmutePartyEvent" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;callerPassCode&quot;" value="g_strCCGeneratedPassCode"/>
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="200" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: **** SELF UNMUTE ****");]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)

{

	Server.logError("ERROR: FAIL TO SEND SOAP MESSAGE UNMUTE YOUR OWN LINE.");

}]]></script>
          </scripts>
        </action>
        <action id="205" plug-in="Pactolus.Branch.1" ><?xtml-editor x=667 y=635 ?>
          <!--already unmuted?-->
          <results >
            <result name="Default" link="201" stubbed="1"/>
            <result name="g_bMuteState==false" link="22" stubbed="1" >g_bMutedState == false

OR g_bCurrentlyInSubConf == true</result>
          </results>
        </action>
        <action id="209" plug-in="Pactolus.Branch.1" ><?xtml-editor x=570 y=1240 ?>
          <!--what digit?-->
          <results >
            <result name="Default" link="22" stubbed="1"/>
            <result name="*1 Add Participant" link="231" stubbed="0" >strDtmf match "^\*{1}1{1}$"</result>
            <result name="*2 Drop Last Participant" link="42" stubbed="1" >strDtmf match "^\*{1}2{1}$"</result>
            <result name="*5 Lock/Unlock" link="46" stubbed="1" >strDtmf match "^\*{1}5{1}$"</result>
            <result name="*6 Mute/Unmute Self" link="211" stubbed="0" >strDtmf match "^\*{1}6{1}$"</result>
            <result name="*8 Allow/Disallow to continue" link="232" stubbed="1" >strDtmf match "^\*{1}8{1}$"</result>
            <result name="## Mute All" link="50" stubbed="1" >strDtmf match "^\#{2}$"</result>
            <result name="99 UnMute All" link="51" stubbed="1" >strDtmf match "9{2}$"</result>
            <result name="*# Participant Count" link="52" stubbed="1" >strDtmf match "^\*{1}\#{1}$"</result>
            <result name="*0 or 00 Private Talk CSR" link="189" stubbed="1" >(strDtmf match "^\*{1}0{1}$"
OR strDtmf match "^0{2}$")
AND g_bTalkingWithCSR == false
AND g_bWaitForCSR == false</result>
            <result name="** Main Menu" link="21" stubbed="1" >strDtmf match "^\*{2}$"</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (9 == Result.id)
{
	Session.g_nRequestCSRType = 1;
	Session.g_strRequestCSRPrivateTalkFlag = "T";
}
else if (10 == Result.id)
{
	Session.g_nRequestCSRType = 1;
	Session.g_strRequestCSRPrivateTalkFlag = "F";	
}]]></script>
          </scripts>
        </action>
        <action id="210" plug-in="Pactolus.Branch.1" ><?xtml-editor x=250 y=1075 ?>
          <!--Moderator-->
          <results >
            <result name="Default" link="212" stubbed="0"/>
            <result name="ModFlag==T" link="209" stubbed="0" >g_strModeratorFlag match "T"</result>
          </results>
        </action>
        <action id="211" plug-in="Pactolus.Branch.1" ><?xtml-editor x=876 y=1406 ?>
          <!--if currently muted, try to unmute
if currently unmuted, try to mute-->
          <results >
            <result name="Default" link="201" stubbed="1"/>
            <result name="Currently Unmuted" link="128" stubbed="1" >g_bMutedState == false</result>
            <result name="g_strMuteFlag" link="22" stubbed="1" >g_strMuteFlag match "T"</result>
          </results>
        </action>
        <action id="212" plug-in="Pactolus.Branch.1" ><?xtml-editor x=554 y=953 ?>
          <!--what digit?-->
          <results >
            <result name="Default" link="22" stubbed="1"/>
            <result name="*6 Mute/Unmute Self" link="214" stubbed="0" >strDtmf match "^\*{1}6{1}$"</result>
            <result name="*# Participant Count" link="52" stubbed="1" >strDtmf match "^\*{1}\#{1}$"</result>
            <result name="*0 or 00 Private Talk CSR" link="189" stubbed="1" >(strDtmf match "^\*{1}0{1}$"
OR strDtmf match "^0{2}$")
AND g_bTalkingWithCSR == false
AND g_bWaitForCSR == false</result>
            <result name="** Main Menu" link="27" stubbed="1" >strDtmf match "^\*{2}$"</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (4 == Result.id)
{
	Session.g_nRequestCSRType = 1;
	Session.g_strRequestCSRPrivateTalkFlag = "T";
}
else if (5 == Result.id)
{
	Session.g_nRequestCSRType = 1;
	Session.g_strRequestCSRPrivateTalkFlag = "F";	
}]]></script>
          </scripts>
        </action>
        <action id="213" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1955 y=1174 ?>
          <!--wait for CSR-->
          <results >
            <result name="Default" link="22" stubbed="1"/>
            <result name="wait for CSR" link="2" stubbed="1" >g_bWaitForCSR == true
OR g_bTalkingWithCSR == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bCurrentlyInMMenu = false;]]></script>
          </scripts>
        </action>
        <action id="214" plug-in="Pactolus.Branch.1" ><?xtml-editor x=824 y=949 ?>
          <results >
            <result name="Default" link="128" stubbed="1"/>
            <result name="strMuteFlag" link="22" stubbed="1" >g_strMuteFlag match "T"</result>
            <result name="CurrentlyMuted and MutedByMod" link="229" stubbed="0" >g_bMutedState == true
AND (g_bMutedByMod == true
OR g_strModeratorMutedFlag match "T")</result>
            <result name="CurrentlyMuted and !MutedByMod" link="201" stubbed="1" >g_bMutedState == true
AND g_bMutedByMod == false
AND g_strModeratorMutedFlag match "F"</result>
          </results>
        </action>
        <action id="215" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2969 y=1423 ?>
          <!--"ChangeToMutedMode"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ChangeToMutedMode&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="37" stubbed="1"/>
            <result name="SUCCESS" link="22" stubbed="1" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: MOD MAIN MENU CHANGE TO MUTED, RETURN TO CONFERENCE.");]]></script>
          </scripts>
        </action>
        <action id="216" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2867 y=3194 ?>
          <!--"ChangeToMutedMode"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ChangeToMutedMode&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="138" stubbed="1"/>
            <result name="SUCCESS" link="69" stubbed="0" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: MODIFY MEMBER TO MUTE.");]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)

{
	Server.logError("ERROR: MDCX FAILED TO MUTE LINE.");
	
	Session.g_bMutedState = false;
	Session.g_oMS.bMuteFlag = false;
}]]></script>
          </scripts>
        </action>
        <action id="217" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2862 y=3344 ?>
          <!--"ChangeToConferenceMode"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ChangeToConferenceMode&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="138" stubbed="1"/>
            <result name="SUCCESS" link="70" stubbed="0" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: MODIFY MEMBER TO UNMUTE.");]]></script>
          </scripts>
        </action>
        <action id="218" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2179 y=704 ?>
          <!--"ChangeToMutedMode"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ChangeToMutedMode&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="152" stubbed="1"/>
            <result name="SUCCESS" link="92" stubbed="0" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: MODIFY MEMBER TO MUTE.");]]></script>
          </scripts>
        </action>
        <action id="219" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2403 y=909 ?>
          <!--"ChangeToConferenceMode"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ChangeToConferenceMode&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="138" stubbed="1"/>
            <result name="SUCCESS" link="90" stubbed="0" >f_nReturnCode == s_nSuccess</result>
          </results>
        </action>
        <action id="220" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2052 y=340 ?>
          <!--"ChangeToConferenceMode"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ChangeToConferenceMode&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="197" stubbed="1"/>
            <result name="SUCCESS" link="203" stubbed="0" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: MODIFY MEMBER TO UNMUTE.");

Session.g_oMS.bMuteFlag = false;]]></script>
          </scripts>
        </action>
        <action id="221" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2481 y=1499 ?>
          <!--mute state?-->
          <results >
            <result name="Default" link="222" stubbed="0"/>
            <result name="g_bMutedState" link="215" stubbed="1" >g_bMutedState == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("CURRENT MUTE STATE IS: " + Session.g_bMutedState);

Server.logInfo("CURRENT HOLD STATE IS: " + Session.g_bHoldState);

if (Session.g_bHoldState)

{

	Session.g_oMS.bMuteFlag = true;

	Session.g_oMS.bDeafFlag = true;

}

else if (Session.g_bMutedState)

{

	Session.g_oMS.bMuteFlag = true;

	Session.g_oMS.bDeafFlag = false;

}

else

{

	Session.g_oMS.bMuteFlag = false;

	Session.g_oMS.bDeafFlag = false;

}]]></script>
          </scripts>
        </action>
        <action id="222" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2715 y=1441 ?>
          <!--"ChangeToConferenceMode"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ChangeToConferenceMode&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="37" stubbed="1"/>
            <result name="SUCCESS" link="22" stubbed="1" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: MOD MAIN MENU MODIFY MEMBER RETURN TO CONFERENCE.");]]></script>
          </scripts>
        </action>
        <action id="226" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=3112 y=3023 ?>
          <!--ConfGetCallerCountRequest-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="s_strConfGetCallerCountRequest" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="39" stubbed="1"/>
            <result name="Success" link="227" stubbed="0"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.enableEvents(false);
Server.logInfo("INFO: **** ConfGetCallerCountRequest ****");]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)
{
	Server.logError("ERROR: FAIL TO SEND SOAP MESSAGE ConfGetCallerCountRequest.");
}]]></script>
          </scripts>
        </action>
        <action id="227" plug-in="Standard.WaitEvent.1" ><?xtml-editor x=3367 y=3032 ?>
          <!--ConfGetCallerCountResponse-->
          <wait xmlns="urn:www.pactolus.com:xtml:communication" timeout="5" recv-name="g_strEventReceived" >
            <msg name="ConfGetCallerCountResponse" >
              <parameter >f_strConfControllerIP</parameter>
              <parameter >f_nConfControllerPort</parameter>
              <parameter >f_strTransactionId</parameter>
              <parameter >f_strConfScheduleId</parameter>
              <parameter >g_nCurrentNbrCallegs</parameter>
            </msg>
          </wait>
          <results >
            <result name="Default" link="228" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nCurrentNbrCallegs = 0;]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)
{
	Server.logError("NO RESPONSE FOR ConfGetCallerCountRequest, exit on: " + Result.name);
}]]></script>
          </scripts>
        </action>
        <action id="228" plug-in="Pactolus.Branch.1" ><?xtml-editor x=3586 y=3030 ?>
          <results >
            <result name="Default" link="39" stubbed="1"/>
            <result name="==1" link="55" stubbed="1" >g_nCurrentNbrCallegs == 1</result>
            <result name="&gt;=2" link="56" stubbed="1" >g_nCurrentNbrCallegs &gt;= 2</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.enableEvents(true);]]></script>
          </scripts>
        </action>
        <action id="229" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1062 y=943 ?>
          <!--can't unmute-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >933</audio>
          </play>
          <results >
            <result name="Default" link="22" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="230" plug-in="Pactolus.Branch.1" ><?xtml-editor x=887 y=441 ?>
          <!--operator assist type-->
          <results >
            <result name="Default" link="22" stubbed="1"/>
            <result name="ACDEnable" link="244" stubbed="1" >g_strACDEnable match "T"</result>
          </results>
        </action>
        <action id="231" plug-in="Pactolus.Branch.1" ><?xtml-editor x=845 y=1238 ?>
          <results >
            <result name="Default" link="32" stubbed="1"/>
            <result name="g_nOutdialOption==1" link="22" stubbed="1" >g_nOutdialOption == 1</result>
          </results>
        </action>
        <action id="232" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2220 y=2953 ?>
          <!--mod required?-->
          <results >
            <result name="Default" link="22" stubbed="1"/>
            <result name="&quot;T&quot;== g_strModRequiredFlag" link="65" stubbed="0" >g_strModeratorRequiredFlag match "T"</result>
          </results>
        </action>
        <action id="233" plug-in="Pactolus.Branch.1" ><?xtml-editor x=39 y=1151 ?>
          <!--prepaid conference-->
          <results >
            <result name="Default" link="234" stubbed="0"/>
            <result name="bThirdParty" link="210" stubbed="0" >bThirdParty == true</result>
            <result name="billing type == 1?" link="29" stubbed="1" >g_nBillingType == 1</result>
          </results>
        </action>
        <action id="234" plug-in="Pactolus.Branch.1" ><?xtml-editor x=233 y=1645 ?>
          <!--event base conf?-->
          <results >
            <result name="Default" link="30" stubbed="1"/>
            <result name="g_nDnisIdentifiedConfFlag == 1" link="235" stubbed="0" >g_nDnisIdentifiedConfFlag == 1</result>
          </results>
        </action>
        <action id="235" plug-in="Pactolus.Branch.1" ><?xtml-editor x=482 y=1674 ?>
          <results >
            <result name="Default" link="22" stubbed="1"/>
            <result name="**-Main Menu" link="238" stubbed="0" >strDtmf match "^\*\*$"</result>
            <result name="*0 or 00 Request private talk CSR" link="239" stubbed="0" >(strDtmf match "^\*{1}0{1}$"
OR strDtmf match "^0{2}$")
AND g_bEBCRequestPrivateCSR == false
AND g_bEBCRequestCSR == false</result>
            <result name="*0 or 00 Cancel Request private talk CSR" link="247" stubbed="0" >(strDtmf match "^\*{1}0{1}$"
OR strDtmf match "^0{2}$")
AND g_bEBCRequestPrivateCSR == true
AND g_bEBCRequestCSR == false</result>
            <result name="14 - raise hand" link="240" stubbed="0" >strDtmf match "^1{1}4{1}$"</result>
            <result name="13 - cancel raise hand" link="241" stubbed="0" >strDtmf match "^1{1}3{1}$"</result>
            <result name="63 - self mute" link="254" stubbed="0" >strDtmf match "^63$"
AND g_bAllowSelfMuteUnmuteFlag == true</result>
            <result name="66 - self unmute" link="255" stubbed="0" >strDtmf match "^6{2}$"
AND g_bAllowSelfMuteUnmuteFlag == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("OPERATOR REQUEST FLAG: " + Session.g_bEBCRequestCSR);
Server.logInfo("OPERATOR PRIVATE TALK REQUEST FLAG: " + Session.g_bEBCRequestPrivateCSR);]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (3 == Result.id)
{
	Session.g_nRequestCSRType = 3;
}
]]></script>
          </scripts>
        </action>
        <action id="236" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1246 y=1723 ?>
          <!--"SideBarOperatorRequest"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;SideBarOperatorRequest&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="22" stubbed="1"/>
            <result name="SUCCESS" link="22" stubbed="1" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_nReturnCode = -1;
Session.g_strRequestCSRPrivateTalkFlag = "T";
Session.g_bEBCRequestPrivateCSR = true;]]></script>
          </scripts>
        </action>
        <action id="237" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1041 y=1861 ?>
          <!--"CancelSideBarOperatorRequest"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;CancelSideBarOperatorRequest&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="22" stubbed="1"/>
            <result name="SUCCESS" link="22" stubbed="1" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_nReturnCode = -1;]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (2 == Result.id)
{
	Server.logInfo("RESET REQUEST PRIVATE TALK FLAG");
	Server.logInfo("g_strRequestCSRPrivateTalkFlag: " + Session.g_strRequestCSRPrivateTalkFlag);
	Server.logInfo("g_bEBCRequestPrivateCSR: " + Session.g_bEBCRequestPrivateCSR);
	Session.g_strRequestCSRPrivateTalkFlag = "F";
	Session.g_bEBCRequestPrivateCSR = false;
	Server.logInfo("RESET g_strRequestCSRPrivateTalkFlag: " + Session.g_strRequestCSRPrivateTalkFlag);
	Server.logInfo("RESET g_bEBCRequestPrivateCSR: " + Session.g_bEBCRequestPrivateCSR);
}]]></script>
          </scripts>
        </action>
        <action id="238" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=789 y=1623 ?>
          <!--"EventBaseMainMenu"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;EventBaseMainMenu&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="2" stubbed="1"/>
          </results>
        </action>
        <action id="239" plug-in="Pactolus.Branch.1" ><?xtml-editor x=797 y=1730 ?>
          <!--operator assist type-->
          <results >
            <result name="Default" link="22" stubbed="1"/>
            <result name="(type 0 and mod) or type 1" link="246" stubbed="0" >((g_nOperatorAssistType == 0
AND f_bModeratorFlag == true)
OR g_nOperatorAssistType == 1)
AND g_strACDEnable match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("OPERATOR ASSIST TYPE: " + Session.g_nOperatorAssistType);
Server.logInfo("ACD ENABLE FLAG: " + Session.g_strACDEnable);
Server.logInfo("MODERATOR FLAG: " + Session.g_strModeratorFlag);
if ("T" == Session.g_strModeratorFlag)
{
	Session.f_bModeratorFlag = true;
}
else
{
	Session.f_bModeratorFlag = false;
}]]></script>
          </scripts>
        </action>
        <action id="240" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=811 y=2048 ?>
          <!--s_strQandARequest-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="s_strQandARequest" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
            <parameter tag="&quot;CCGeneratedPasscode&quot;" value="g_strCCGeneratedPassCode"/>
          </SOAP>
          <results >
            <result name="Default" link="22" stubbed="1"/>
            <result name="Success" link="252" stubbed="0"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: **** CONF Q&A Request ****");]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)
{
	Server.logError("ERROR: FAIL TO SEND SOAP MESSAGE CONF Q and A Request.");
}]]></script>
          </scripts>
        </action>
        <action id="241" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=816 y=2184 ?>
          <!--s_strCancelQandARequest-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="s_strCancelQandARequest" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
            <parameter tag="&quot;CCGeneratedPasscode&quot;" value="g_strCCGeneratedPassCode"/>
          </SOAP>
          <results >
            <result name="Default" link="22" stubbed="1"/>
            <result name="Success" link="253" stubbed="0"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: **** CONF Cancel Q&A Request ****");]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)
{
	Server.logError("ERROR: FAIL TO SEND SOAP MESSAGE CONF Cancel Q and A Request.");
}]]></script>
          </scripts>
        </action>
        <action id="242" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1002 y=1568 ?>
          <!--operator assist type-->
          <results >
            <result name="Default" link="236" stubbed="1"/>
            <result name="ACDEnable" link="238" stubbed="1" >g_strACDEnable match "T"</result>
          </results>
        </action>
        <action id="243" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1049 y=2324 ?>
          <!--"CancelOperatorRequest"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;CancelOperatorRequest&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="22" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_nReturnCode = -1;]]></script>
          </scripts>
        </action>
        <action id="244" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2400 y=3595 ?>
          <!--event base conf?-->
          <results >
            <result name="Default" link="156" stubbed="0"/>
            <result name="g_nDnisIdentifiedConfFlag == 1" link="251" stubbed="0" >g_nDnisIdentifiedConfFlag == 1</result>
          </results>
        </action>
        <action id="245" plug-in="Pactolus.Branch.1" ><?xtml-editor x=3505 y=3686 ?>
          <!--event base conf?-->
          <results >
            <result name="Default" link="2" stubbed="1"/>
            <result name="g_nDnisIdentifiedConfFlag == 1" link="22" stubbed="1" >g_nDnisIdentifiedConfFlag == 1</result>
          </results>
        </action>
        <action id="246" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1028 y=1726 ?>
          <!--beep beep-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="5" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >340</audio>
          </play>
          <results >
            <result name="Default" link="236" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="247" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=826 y=1867 ?>
          <!--beep beep-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="5" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >340</audio>
          </play>
          <results >
            <result name="Default" link="237" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="248" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1345 y=2032 ?>
          <!--beep beep-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="5" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >340</audio>
          </play>
          <results >
            <result name="Default" link="22" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bPartyHandRaised = true;]]></script>
          </scripts>
        </action>
        <action id="249" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1349 y=2170 ?>
          <!--beep beep-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="5" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >340</audio>
          </play>
          <results >
            <result name="Default" link="22" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bPartyHandRaised = false;]]></script>
          </scripts>
        </action>
        <action id="250" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=821 y=2330 ?>
          <!--beep beep-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="5" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >340</audio>
          </play>
          <results >
            <result name="Default" link="243" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="251" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2616 y=3709 ?>
          <!--beep beep-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="5" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >340</audio>
          </play>
          <results >
            <result name="Default" link="104" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="252" plug-in="Standard.WaitEvent.1" ><?xtml-editor x=1062 y=2039 ?>
          <!--ConfQandAResponse-->
          <wait xmlns="urn:www.pactolus.com:xtml:communication" timeout="s_nTimeout" recv-name="g_strEventReceived" >
            <msg name="ConfQandAResponse" >
              <parameter ></parameter>
              <parameter ></parameter>
              <parameter ></parameter>
              <parameter >nResultCode</parameter>
              <parameter ></parameter>
            </msg>
          </wait>
          <results >
            <result name="Default" link="22" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
            <result name="SUCCESS" link="248" stubbed="0" >nResultCode == 0</result>
          </results>
        </action>
        <action id="253" plug-in="Standard.WaitEvent.1" ><?xtml-editor x=1063 y=2177 ?>
          <!--ConfCancelQandAResponse-->
          <wait xmlns="urn:www.pactolus.com:xtml:communication" timeout="s_nTimeout" recv-name="g_strEventReceived" >
            <msg name="ConfCancelQandAResponse" >
              <parameter ></parameter>
              <parameter ></parameter>
              <parameter ></parameter>
              <parameter >nResultCode</parameter>
              <parameter ></parameter>
            </msg>
          </wait>
          <results >
            <result name="Default" link="22" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
            <result name="SUCCESS" link="249" stubbed="0" >nResultCode == 0</result>
          </results>
        </action>
        <action id="254" plug-in="Pactolus.Branch.1" ><?xtml-editor x=814 y=2469 ?>
          <!--currently mute or hold?-->
          <results >
            <result name="Default" link="128" stubbed="1"/>
            <result name="mute||hold" link="22" stubbed="1" >g_bMutedState == true
OR g_bHoldState == true</result>
          </results>
        </action>
        <action id="255" plug-in="Pactolus.Branch.1" ><?xtml-editor x=809 y=2575 ?>
          <!--currently mute?-->
          <results >
            <result name="Default" link="22" stubbed="1"/>
            <result name="mute" link="131" stubbed="1" >g_bMutedState == true</result>
          </results>
        </action>
        <action id="256" plug-in="Pactolus.Branch.1" ><?xtml-editor x=284 y=49 ?>
          <!--currently mute or hold-->
          <results >
            <result name="Default" link="258" stubbed="0"/>
            <result name="mute||hold" link="22" stubbed="1" >g_bMutedState == true
OR g_bHoldState == true</result>
          </results>
        </action>
        <action id="257" plug-in="Pactolus.Branch.1" ><?xtml-editor x=299 y=155 ?>
          <!--currently mute or hold-->
          <results >
            <result name="Default" link="22" stubbed="1"/>
            <result name="mute" link="259" stubbed="0" >g_bMutedState == true</result>
          </results>
        </action>
        <action id="258" plug-in="Pactolus.Branch.1" ><?xtml-editor x=502 y=43 ?>
          <!--mute state?-->
          <results >
            <result name="Default" link="260" stubbed="0"/>
            <result name="g_bMutedState" link="260" stubbed="1" >g_bMutedState == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bMutedState = true;
if (Session.g_bHoldState)
{
	Session.g_oMS.bMuteFlag = true;
	Session.g_oMS.bDeafFlag = true;
}
else if (Session.g_bMutedState)
{
	Session.g_oMS.bMuteFlag = true;
	Session.g_oMS.bDeafFlag = false;
}
else
{
	Session.g_oMS.bMuteFlag = false;
	Session.g_oMS.bDeafFlag = false;
}]]></script>
          </scripts>
        </action>
        <action id="259" plug-in="Pactolus.Branch.1" ><?xtml-editor x=528 y=149 ?>
          <!--mute state?-->
          <results >
            <result name="Default" link="261" stubbed="0"/>
            <result name="!g_bMutedState" link="261" stubbed="1" >g_bMutedState == false</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bMutedState = false;
if (Session.g_bHoldState)
{
	Session.g_oMS.bMuteFlag = true;
	Session.g_oMS.bDeafFlag = true;
}
else if (Session.g_bMutedState)
{
	Session.g_oMS.bMuteFlag = true;
	Session.g_oMS.bDeafFlag = false;
}
else
{
	Session.g_oMS.bMuteFlag = false;
	Session.g_oMS.bDeafFlag = false;
}]]></script>
          </scripts>
        </action>
        <action id="260" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=707 y=40 ?>
          <!--"ChangeToMutedMode"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ChangeToMutedMode&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oSubConfMS</parameter>
          </function>
          <results >
            <result name="Default" link="22" stubbed="1"/>
            <result name="SUCCESS" link="263" stubbed="0" >f_nReturnCode == 0</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: MODIFY MEMBER TO MUTE.");]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)
{
	Server.logError("ERROR: MDCX FAILED TO MUTE LINE.");
	Session.g_bMutedState = false;
	Session.g_oMS.bMuteFlag = false;
}]]></script>
          </scripts>
        </action>
        <action id="261" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=744 y=146 ?>
          <!--"ChangeToConferenceMode"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ChangeToConferenceMode&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oSubConfMS</parameter>
          </function>
          <results >
            <result name="Default" link="22" stubbed="1"/>
            <result name="SUCCESS" link="262" stubbed="0" >f_nReturnCode == 0</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: MODIFY MEMBER TO UNMUTE.");]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)
{
	Server.logError("ERROR: MDCX FAILED TO UNMUTE LINE.");
	Session.g_bMutedState = true;
	Session.g_oMS.bMuteFlag = true;
}]]></script>
          </scripts>
        </action>
        <action id="262" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=950 y=144 ?>
          <!--SELF UNMUTE PARTY-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="g_strResponseTransactionId" message-name="s_strConfUnmutePartyEvent" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;callerPassCode&quot;" value="g_strCCGeneratedPassCode"/>
            <parameter tag="&quot;conferenceId&quot;" value="g_strSubConferenceId"/>
          </SOAP>
          <results >
            <result name="Default" link="22" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: **** SELF UNMUTE ****");]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)
{
	Server.logError("ERROR: FAIL TO SEND SOAP MESSAGE UNMUTE YOUR OWN LINE.");
}]]></script>
          </scripts>
        </action>
        <action id="263" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=943 y=33 ?>
          <!--SELF MUTE PARTY-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="s_strConfMutePartyEvent" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;callerPassCode&quot;" value="g_strCCGeneratedPassCode"/>
            <parameter tag="&quot;conferenceId&quot;" value="g_strSubConferenceId"/>
          </SOAP>
          <results >
            <result name="Default" link="22" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: **** SELF MUTE ****");]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)
{
	Server.logError("ERROR: FAIL TO SEND SOAP MESSAGE MUTE YOUR OWN LINE.");
}]]></script>
          </scripts>
        </action>
        <action id="264" plug-in="Pactolus.Branch.1" ><?xtml-editor x=49 y=55 ?>
          <results >
            <result name="Default" link="22" stubbed="1"/>
            <result name="63 mute" link="256" stubbed="0" >strDtmf match "^63$"
AND g_bAllowSelfMuteUnmuteFlag == true</result>
            <result name="66 unmute" link="257" stubbed="0" >strDtmf match "^6{2}$"
AND g_bAllowSelfMuteUnmuteFlag == true</result>
          </results>
        </action>
      </actions>
    </function>
    <function name="OnMutePartyRequest" start="15" event="OnMutePartyRequest" returns="void" >
      <parameters >
        <parameter name="strConfControllerIpAddress" type="string"/>
        <parameter name="nConfControllerPort" type="i4"/>
        <parameter name="strTransactionId" type="string"/>
        <parameter name="strModeratorMute" type="string"/>
      </parameters>
      <local-vars >
        <var name="f_nReturnCode" type="i4" >-1</var>
        <var name="f_oMS" type="object" ></var>
        <var name="f_strConfControllerIP" type="string" ></var>
        <var name="f_nConfControllerPort" type="i4" >0</var>
        <var name="f_strTransactionId" type="string" ></var>
        <var name="f_strReturnMsg" type="string" ></var>
      </local-vars>
      <actions >
        <action id="15" plug-in="Pactolus.Branch.1" ><?xtml-editor x=133 y=332 ?>
          <results >
            <result name="Default" link="17" stubbed="0"/>
            <result name="mute, csr hold, main menu?" link="5" stubbed="1" >g_bCurrentlyInMMenu == true
OR g_bMutedState == true
OR g_bWaitForCSR == true</result>
            <result name="hold" link="70" stubbed="1" >g_bHoldState == true
OR g_nCallerCurrentState == s_nStateAppletPutOnHold
OR g_nCallerCurrentState == s_nStateCsrPutOnHold</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: OnMutePartyRequest");
js_disable_event();

Server.logInfo("INFO: RECEIVE MUTE PARTY REQUEST FROM CONF CONTROLLER.");
Server.logInfo("INFO: Moderator Mute Flag: " + Session.strModeratorMute);
Server.logInfo("INFO: Conf Controller Port: " + Session.nConfControllerPort);
Server.logInfo("INFO: Conf Controller IP: " + Session.strConfControllerIpAddress);
Server.logInfo("INFO: Transaction Id: " + Session.strTransactionId);

Server.logInfo("INFO: g_bMutedState: " + Session.g_bMutedState);
Server.logInfo("INFO: g_bWaitForCSR: " + Session.g_bWaitForCSR);
Server.logInfo("INFO: g_bCurrentlyInMMenu: " + Session.g_bCurrentlyInMMenu);
Server.logInfo("INFO: g_bHoldState: " + Session.g_bHoldState);
Server.logInfo("INFO: g_intCallerCurrentState ID: " + Session.g_intCallerCurrentState);
Session.g_strReturnMsg = "";

if (true == Session.g_bCurrentlyInMMenu)
{
	Session.g_strReturnMsg = "FAILURE MUTE A PARTY, PARTY IS CURRENTLY IN MAIN MENU.";
}
else if (true == Session.g_bHoldState || Session.s_nStateCsrPutOnHold == Session.g_nCallerCurrentState || Session.s_nStateCsrPutOffHold == Session.g_nCallerCurrentState)
{
	Session.g_strReturnMsg = "FAILURE MUTE A PARTY, PARTY IS CURRENTLY ON HOLD.";
}
else if (true == Session.g_bMutedState)
{
	Session.g_strReturnMsg = "FAILURE MUTE A PARTY, PARTY IS CURRENTLY MUTED.";
}
else if (true == Session.g_bWaitForCSR)
{
		Session.g_strReturnMsg = "FAILURE MUTE A PARTY, PARTY IS CURRENTLY WAITING FOR CSR.";
}
if (Session.strModeratorMute == "T")
{
	Session.g_strModeratorMutedFlag = "T";
	if (Session.g_bCurrentlyInSubConf)
	{
		Session.g_bSubConfMuteByModFlag = true;
	}
	else
	{
		Session.g_bMutedByMod = true;
	}
}
Server.logInfo(" f_oMS.strEndPoint" + Session.f_oMS.strEndPoint);
Server.logInfo(" f_oMS.strConnectionId" + Session.f_oMS.strConnectionId);
Server.logInfo(" f_oMS.strCallId" + Session.f_oMS.strCallId);
Server.logInfo(" f_oMS.strType" + Session.f_oMS.strType);]]></script>
          </scripts>
        </action>
        <action id="1" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1416 y=254 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1177 y=428 ?>
          <!--SUCCESS mute a party-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="strTransactionId" message-name="s_strConfMuteResponse" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="s_nSuccess"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="92" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "SUCCESSFUL MUTE A PARTY";
Session.g_nPromptSelfMuteUnMute = 908;
Session.g_bMutedState = true;
Session.g_nCallerCurrentState = Session.s_nStateAppletPutOffHold;
Session.g_bHoldState = false;]]></script>
          </scripts>
        </action>
        <action id="5" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1158 y=259 ?>
          <!--FAILURE mute a party-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="strTransactionId" message-name="s_strConfMuteResponse" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="s_nFailure"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="1" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "FAILURE MUTE A PARTY, UNABLE TO MODIFY CONFERENCE.";]]></script>
          </scripts>
        </action>
        <action id="12" plug-in="Pactolus.Branch.1" ><?xtml-editor x=374 y=144 ?>
          <!--currently in main menu?-->
          <results >
            <result name="Default" link="17" stubbed="1"/>
            <result name="currently mute?" >g_bMutedState == true</result>
            <result name="onhold OR in main menu?" >g_bHoldState == true

OR g_bCurrentlyInMMenu == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: RECEIVE MUTE PARTY REQUEST FROM CONF CONTROLLER.");

Server.logInfo("INFO: Moderator Mute Flag: " + Session.strModeratorMute);

Server.logInfo("INFO: Conf Controller Port: " + Session.nConfControllerPort);

Server.logInfo("INFO: Conf Controller IP: " + Session.strConfControllerIpAddress);

Server.logInfo("INFO: Transaction Id: " + Session.strTransactionId);

if (Session.strModeratorMute == "T")

{

	Session.g_bMutedByMod = true;

}]]></script>
          </scripts>
        </action>
        <action id="13" plug-in="Pactolus.Branch.1" ><?xtml-editor x=923 y=315 ?>
          <!--success?-->
          <results >
            <result name="Default" link="5" stubbed="0"/>
            <result name="success?" link="2" stubbed="0" >f_nReturnCode == s_nSuccess</result>
          </results>
        </action>
        <action id="14" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=631 y=322 ?>
          <!--"ChangeToMuteMode"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ChangeToMutedMode&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="13" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_oMS.bMuteFlag = true;]]></script>
          </scripts>
        </action>
        <action id="17" plug-in="Pactolus.Branch.1" ><?xtml-editor x=380 y=323 ?>
          <!--in sub conf?-->
          <results >
            <result name="Default" link="14" stubbed="0"/>
            <result name="g_bCurrentlyInSubConf" link="18" stubbed="0" >g_bCurrentlyInSubConf == true</result>
            <result name="g_bTalkingToCSR" link="95" stubbed="0" >g_bTalkingWithCSR == true
AND g_bSideBarOperatorRequest == true</result>
          </results>
        </action>
        <action id="18" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=647 y=442 ?>
          <!--"ChangeToMuteMode"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ChangeToMutedMode&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oSubConfMS</parameter>
          </function>
          <results >
            <result name="Default" link="13" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_oSubConfMS.bMuteFlag = true;]]></script>
          </scripts>
        </action>
        <action id="19" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=855 y=678 ?>
          <!--set DTMF Detection ON-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;SetDTMFOn&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="1" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nCallerCurrentState = Session.s_nStateWait;]]></script>
          </scripts>
        </action>
        <action id="21" plug-in="Pactolus.Branch.1" ><?xtml-editor x=613 y=678 ?>
          <!--what digit?-->
          <results >
            <result name="Default" link="19" stubbed="1"/>
            <result name="*6" link="31" stubbed="1" >g_strUnmuteDigits match "^\*{1}6{1}$"</result>
          </results>
        </action>
        <action id="25" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=417 y=1167 ?>
          <!--UnmutePartyRequest-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="s_strUnmutePartyRequest" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;callerPassCode&quot;" value="g_strCCGeneratedPassCode"/>
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="40" stubbed="1"/>
            <result name="Success" link="26" stubbed="1"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_disable_event();

Server.logInfo("INFO: **** UNMUTE PARTY REQUEST ****");]]></script>
          </scripts>
        </action>
        <action id="26" plug-in="Standard.WaitEvent.1" ><?xtml-editor x=638 y=1044 ?>
          <!--UnmutePartyResponse-->
          <wait xmlns="urn:www.pactolus.com:xtml:communication" timeout="5" recv-name="g_strEventReceived" >
            <msg name="UnmutePartyResponse" >
              <parameter >f_strConfControllerIP</parameter>
              <parameter >f_nConfControllerPort</parameter>
              <parameter >f_strTransactionId</parameter>
              <parameter >f_nReturnCode</parameter>
              <parameter >f_strReturnMsg</parameter>
            </msg>
          </wait>
          <results >
            <result name="Default" link="40" stubbed="1"/>
            <result name="Success" link="27" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_nReturnCode = -1;]]></script>
            <script language="javascript" timing="last" ><![CDATA[js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="27" plug-in="Pactolus.Branch.1" ><?xtml-editor x=874 y=1037 ?>
          <!--success?-->
          <results >
            <result name="Default" link="40" stubbed="1"/>
            <result name="f_nReturnCode == 0" link="46" stubbed="1" >f_nReturnCode == 0</result>
          </results>
        </action>
        <action id="28" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=954 y=1393 ?>
          <!--SELF UNMUTE PARTY-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="s_strConfUnmutePartyEvent" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;callerPassCode&quot;" value="g_strCCGeneratedPassCode"/>
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="30" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: **** SELF UNMUTE ****");]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)

{

	Server.logError("ERROR: FAIL TO SEND SOAP MESSAGE UNMUTE YOUR OWN LINE.");

}]]></script>
          </scripts>
        </action>
        <action id="29" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=420 y=1291 ?>
          <!--"ChangeToConferenceMode"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ChangeToConferenceMode&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="40" stubbed="1"/>
            <result name="SUCCESS" link="32" stubbed="1" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: MODIFY MEMBER TO UNMUTE.");

Session.g_oMS.bMuteFlag = false;]]></script>
          </scripts>
        </action>
        <action id="30" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1209 y=1392 ?>
          <!--your line unmuted-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="f_oMS.strConnectionId" endpoint="f_oMS.strEndPoint" callid="f_oMS.strCallId" repeat="1" timeout="10" ms-type="f_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >s_nPromptUnmuted</audio>
          </play>
          <results >
            <result name="Default" link="1" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nPromptSelfMuteUnMute = 907;

Session.g_bMutedState = false;]]></script>
          </scripts>
        </action>
        <action id="31" plug-in="Pactolus.Branch.1" ><?xtml-editor x=178 y=1076 ?>
          <!--CallPartyFlag==T?-->
          <results >
            <result name="Default" link="39" stubbed="0"/>
            <result name="g_strPartyPasscodeFlag==T" link="25" stubbed="0" >g_strPartyPasscodeFlag match "T"</result>
          </results>
        </action>
        <action id="32" plug-in="Pactolus.Branch.1" ><?xtml-editor x=688 y=1291 ?>
          <!--CallPartyFlag==T?-->
          <results >
            <result name="Default" link="33" stubbed="0"/>
            <result name="g_strPartyPasscodeFlag==T" link="28" stubbed="0" >g_strPartyPasscodeFlag match "T"</result>
          </results>
        </action>
        <action id="33" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=944 y=1275 ?>
          <!--SELF UNMUTE PARTY-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="s_strConfUnmutePartyEvent" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;callerPassCode&quot;" value="g_strCCGeneratedPassCode"/>
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="30" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: **** SELF UNMUTE ****");]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)

{

	Server.logError("ERROR: FAIL TO SEND SOAP MESSAGE UNMUTE YOUR OWN LINE.");

}]]></script>
          </scripts>
        </action>
        <action id="36" plug-in="Pactolus.Branch.1" ><?xtml-editor x=141 y=705 ?>
          <!--Muted by mod?-->
          <results >
            <result name="Default" link="45" stubbed="0"/>
            <result name="ModeratorMute==&quot;T&quot;" link="44" stubbed="0" >strModeratorMute match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (Session.g_bCurrentlyInSubConf)
{
	Server.logInfo("CURRENTLY IN SUB CONFERENCE");
	Session.f_oMS = Session.g_oSubConfMS;
}
else if (Session.g_bTalkingWithCSR)
{
	Server.logInfo("CURRENTLY NOT IN SUB CONFERENCE");
	Session.f_oMS = Session.g_oTempConf;
}
else
{
	Server.logInfo("CURRENTLY NOT IN SUB CONFERENCE");
	Session.f_oMS = Session.g_oMS;
}]]></script>
          </scripts>
        </action>
        <action id="39" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=406 y=1051 ?>
          <!--UnmutePartyRequest-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="s_strUnmutePartyRequest" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;callerPassCode&quot;" value="g_strCCGeneratedPassCode"/>
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="40" stubbed="1"/>
            <result name="Success" link="26" stubbed="0"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_disable_event();

Server.logInfo("INFO: **** UNMUTE PARTY REQUEST ****");]]></script>
          </scripts>
        </action>
        <action id="40" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1092 y=1038 ?>
          <!--can't unmute-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="f_oMS.strConnectionId" endpoint="f_oMS.strEndPoint" callid="f_oMS.strCallId" repeat="1" timeout="10" ms-type="f_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >933</audio>
          </play>
          <results >
            <result name="Default" link="19" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="44" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=390 y=813 ?>
          <!--your line is muted-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="f_oMS.strConnectionId" endpoint="f_oMS.strEndPoint" callid="f_oMS.strCallId" repeat="1" timeout="10" ms-type="f_oMS.strType" returns="" start-play="1" interrupt="0" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >s_nPromptMuted</audio>
          </play>
          <results >
            <result name="Default" link="19" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("CURRENT MUTE STATE IS: " + Session.g_bMutedState);]]></script>
          </scripts>
        </action>
        <action id="45" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=376 y=683 ?>
          <!--your line has been muted-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="f_oMS.strConnectionId" endpoint="f_oMS.strEndPoint" callid="f_oMS.strCallId" repeat="1" timeout="6" ms-type="f_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;(*1)&quot;" language="g_strLanguage" digits="g_strUnmuteDigits" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >900</audio>
            <audio type="index" >355</audio>
            <audio type="index" >908</audio>
          </play>
          <results >
            <result name="Default" link="19" stubbed="1"/>
            <result name="Success" link="21" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strUnmuteDigits = "";]]></script>
          </scripts>
        </action>
        <action id="46" plug-in="Pactolus.Branch.1" ><?xtml-editor x=204 y=1322 ?>
          <!--in sub conf?-->
          <results >
            <result name="Default" link="29" stubbed="0"/>
            <result name="g_bCurrentlyInSubConf" link="47" stubbed="0" >g_bCurrentlyInSubConf == true</result>
          </results>
        </action>
        <action id="47" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=436 y=1431 ?>
          <!--"ChangeToConferenceMode"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ChangeToConferenceMode&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oSubConfMS</parameter>
          </function>
          <results >
            <result name="Default" link="40" stubbed="1"/>
            <result name="SUCCESS" link="32" stubbed="0" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: MODIFY MEMBER TO UNMUTE.");

Session.g_oMS.bMuteFlag = false;]]></script>
          </scripts>
        </action>
        <action id="56" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=777 y=1712 ?>
          <!--"ChangeToMutedMode"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ChangeToMutedMode&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="5" stubbed="1"/>
            <result name="SUCCESS" link="2" stubbed="1" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_oMS.bMuteFlag = true;
Session.g_oMS.bDeafFlag = false;]]></script>
          </scripts>
        </action>
        <action id="59" plug-in="Pactolus.Branch.1" ><?xtml-editor x=362 y=1721 ?>
          <!--MOH?-->
          <results >
            <result name="Default" link="71" stubbed="0"/>
            <result name="g_strMusicOnHoldFlag==&quot;T&quot;" link="60" stubbed="0" >g_strMusicOnHoldFlag match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bDontPlayContinueToHold = true;]]></script>
          </scripts>
        </action>
        <action id="60" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=364 y=1866 ?>
          <!--"DisconnectFromMOH"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DisconnectFromMOH&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="61" stubbed="1"/>
          </results>
        </action>
        <action id="61" plug-in="Pactolus.Branch.1" ><?xtml-editor x=776 y=2162 ?>
          <!--Dial In?-->
          <results >
            <result name="Default" link="73" stubbed="0"/>
            <result name="g_strOutdialFlag = &quot;T&quot;;" link="74" stubbed="0" >g_strOutdialFlag match "T"</result>
          </results>
        </action>
        <action id="62" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1296 y=2078 ?>
          <!--AddMemberToConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
            <parameter >g_oCallLegA</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="83" stubbed="0"/>
            <result name="FAILURE" link="66" stubbed="1" >f_nReturnCode == s_nFailure</result>
            <result name="CALLERHUNGUP" link="65" stubbed="1" >f_nReturnCode == s_nCallerHungup</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_oMS.bMuteFlag = true;
Session.g_oMS.bDeafFlag = false;]]></script>
          </scripts>
        </action>
        <action id="63" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1314 y=2512 ?>
          <!--AddMemberToConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
            <parameter >g_oCallLegB</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="83" stubbed="1"/>
            <result name="FAILURE" link="66" stubbed="1" >f_nReturnCode == s_nFailure</result>
            <result name="CALLERHUNGUP" link="65" stubbed="1" >f_nReturnCode == s_nCallerHungup</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_oMS.bMuteFlag = true;
Session.g_oMS.bDeafFlag = false;]]></script>
          </scripts>
        </action>
        <action id="64" plug-in="Standard.EndSession.1" ><?xtml-editor x=2015 y=2087 ?></action>
        <action id="65" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1567 y=2215 ?>
          <!--"PartyLeave"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;PartyLeave&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="91" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nConfLeaveReason = 0;
Session.g_strConfLeaveMsg = "PARTY HANGUP WHILE TRYING TO ADD MEMBER TO CONFERENCE";]]></script>
          </scripts>
        </action>
        <action id="66" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1551 y=2092 ?>
          <!--HangUp Caller-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpCaller&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="91" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 35;
Session.g_nConfLeaveReason = 9;
Session.g_strConfLeaveMsg = "FAIL TO ADD PARTY TO CONFERENCE";]]></script>
          </scripts>
        </action>
        <action id="70" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=123 y=1722 ?>
          <!--"StopTimer"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;StopTimer&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="59" stubbed="0"/>
          </results>
        </action>
        <action id="71" plug-in="Pactolus.Branch.1" ><?xtml-editor x=571 y=1718 ?>
          <!--in sub conf?-->
          <results >
            <result name="Default" link="56" stubbed="0"/>
            <result name="g_bCurrentlyInSubConf" link="72" stubbed="0" >g_bCurrentlyInSubConf == true</result>
            <result name="g_bTallkingWithCSR" link="97" stubbed="0" >g_bTalkingWithCSR == true
AND g_bSideBarOperatorRequest == true</result>
          </results>
        </action>
        <action id="72" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=791 y=1827 ?>
          <!--"ChangeToMutedMode"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ChangeToMutedMode&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oSubConfMS</parameter>
          </function>
          <results >
            <result name="Default" link="5" stubbed="1"/>
            <result name="SUCCESS" link="87" stubbed="0" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_oSubConfMS.bMuteFlag = true;
Session.g_oSubConfMS.bDeafFlag = false;]]></script>
          </scripts>
        </action>
        <action id="73" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1011 y=2093 ?>
          <!--in sub conf?-->
          <results >
            <result name="Default" link="62" stubbed="0"/>
            <result name="g_bCurrentlyInSubConf" link="75" stubbed="0" >g_bCurrentlyInSubConf == true</result>
            <result name="g_bSideBarOperatorRequest" link="84" stubbed="0" >g_bSideBarOperatorRequest == true
AND g_bTalkingWithCSR == true</result>
          </results>
        </action>
        <action id="74" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1029 y=2558 ?>
          <!--in sub conf?-->
          <results >
            <result name="Default" link="63" stubbed="0"/>
            <result name="g_bCurrentlyInSubConf" link="76" stubbed="0" >g_bCurrentlyInSubConf == true</result>
            <result name="g_bSideBarOperatorRequest" link="85" stubbed="0" >g_bSideBarOperatorRequest == true
AND g_bTalkingWithCSR == true</result>
          </results>
        </action>
        <action id="75" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1308 y=2222 ?>
          <!--AddMemberToConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oSubConfMS</parameter>
            <parameter >g_oCallLegA</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="87" stubbed="1"/>
            <result name="FAILURE" link="66" stubbed="1" >f_nReturnCode == s_nFailure</result>
            <result name="CALLERHUNGUP" link="65" stubbed="1" >f_nReturnCode == s_nCallerHungup</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_oSubConfMS.bMuteFlag = true;
Session.g_oSubConfMS.bDeafFlag = false;]]></script>
          </scripts>
        </action>
        <action id="76" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1333 y=2667 ?>
          <!--AddMemberToConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oSubConfMS</parameter>
            <parameter >g_oCallLegB</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="87" stubbed="1"/>
            <result name="FAILURE" link="66" stubbed="1" >f_nReturnCode == s_nFailure</result>
            <result name="CALLERHUNGUP" link="65" stubbed="1" >f_nReturnCode == s_nCallerHungup</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_oSubConfMS.bMuteFlag = true;
Session.g_oSubConfMS.bDeafFlag = false;]]></script>
          </scripts>
        </action>
        <action id="77" plug-in="Standard.Timer.1" ><?xtml-editor x=2431 y=1770 ?>
          <!--ck reInvite timer-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lCkReInviteTimerIdA" duration="g_nCkReInviteTime"/>
          <results >
            <result name="Default" link="1" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bCkReInviteTimerFlagA = true;
Server.logInfo("SET TIMER TO CHECK FOR REINVITE A LEG");]]></script>
          </scripts>
        </action>
        <action id="78" plug-in="Standard.Timer.1" ><?xtml-editor x=2449 y=1886 ?>
          <!--ck reInvite timer B-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lCkReInviteTimerIdB" duration="g_nCkReInviteTime"/>
          <results >
            <result name="Default" link="1" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bCkReInviteTimerFlagB = true;
Server.logInfo("SET TIMER TO CHECK FOR REINVITE B LEG");]]></script>
          </scripts>
        </action>
        <action id="79" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1724 y=1809 ?>
          <results >
            <result name="Default" link="1" stubbed="1"/>
            <result name="Time &gt; 0" link="80" stubbed="0" >g_nCkReInviteTime &gt; 0</result>
          </results>
        </action>
        <action id="80" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1960 y=1803 ?>
          <!--Dial In?-->
          <results >
            <result name="Default" link="81" stubbed="0"/>
            <result name="g_strOutdialFlag = &quot;T&quot;" link="82" stubbed="0" >g_strOutdialFlag match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("ConfOffHoldPartyRequest, RESET TIMER TO CHECK FOR REINVITE");]]></script>
          </scripts>
        </action>
        <action id="81" plug-in="Standard.Timer.1" ><?xtml-editor x=2202 y=1770 ?>
          <!--stop ck reInvite timer-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="0" id="g_lCkReInviteTimerIdA" duration=""/>
          <results >
            <result name="Default" link="77" stubbed="0"/>
          </results>
        </action>
        <action id="82" plug-in="Standard.Timer.1" ><?xtml-editor x=2216 y=1887 ?>
          <!--stop ck reInvite timer B-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="0" id="g_lCkReInviteTimerIdB" duration=""/>
          <results >
            <result name="Default" link="78" stubbed="0"/>
          </results>
        </action>
        <action id="83" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1552 y=2004 ?>
          <!--ConfMSConnectionIDChangedNotify-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ConfMSConnectionIDChangedNotify&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="2" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_oMS = Session.g_oMS;]]></script>
          </scripts>
        </action>
        <action id="84" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1313 y=2355 ?>
          <!--AddMemberToConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
            <parameter >g_oCallLegA</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="87" stubbed="1"/>
            <result name="FAILURE" link="66" stubbed="1" >f_nReturnCode == s_nFailure</result>
            <result name="CALLERHUNGUP" link="65" stubbed="1" >f_nReturnCode == s_nCallerHungup</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_oTempConf.bMuteFlag = true;
Session.g_oTempConf.bDeafFlag = false;]]></script>
          </scripts>
        </action>
        <action id="85" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1337 y=2793 ?>
          <!--AddMemberToConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
            <parameter >g_oCallLegB</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="87" stubbed="1"/>
            <result name="FAILURE" link="66" stubbed="1" >f_nReturnCode == s_nFailure</result>
            <result name="CALLERHUNGUP" link="65" stubbed="1" >f_nReturnCode == s_nCallerHungup</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_oTempConf.bMuteFlag = true;
Session.g_oTempConf.bDeafFlag = false;]]></script>
          </scripts>
        </action>
        <action id="87" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1022 y=1824 ?>
          <!--SUCCESS mute a party-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="strTransactionId" message-name="s_strConfMuteResponse" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="s_nSuccess"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="99" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "SUCCESSFUL MUTE A PARTY";
Session.g_nPromptSelfMuteUnMute = 908;
Session.g_bMutedState = true;
Session.g_nCallerCurrentState = Session.s_nStateAppletPutOffHold;
Session.g_bHoldState = false;]]></script>
          </scripts>
        </action>
        <action id="91" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1782 y=2091 ?>
          <!--FAILURE mute a party-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="strTransactionId" message-name="s_strConfMuteResponse" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="s_nFailure"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="64" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "FAILURE MUTE A PARTY, UNABLE TO MODIFY CONFERENCE.";]]></script>
          </scripts>
        </action>
        <action id="92" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1398 y=428 ?>
          <!--Event conf?-->
          <results >
            <result name="Default" link="36" stubbed="1"/>
            <result name="g_nDnisIdentifyConferenceFlag == 1" link="98" stubbed="0" >g_nDnisIdentifiedConfFlag == 1</result>
          </results>
        </action>
        <action id="94" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1492 y=1818 ?>
          <!--your line is muted-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="f_oMS.strConnectionId" endpoint="f_oMS.strEndPoint" callid="f_oMS.strCallId" repeat="1" timeout="10" ms-type="f_oMS.strType" returns="" start-play="1" interrupt="0" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >s_nPromptMuted</audio>
          </play>
          <results >
            <result name="Default" link="79" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("CURRENT MUTE STATE IS: " + Session.g_bMutedState);
if (Session.g_bCurrentlyInSubConf)
{
	Server.logInfo("CURRENTLY IN SUB CONFERENCE");
	Session.f_oMS = Session.g_oSubConfMS;
}
else if (Session.g_bTalkingWithCSR)
{
	Server.logInfo("CURRENTLY NOT IN SUB CONFERENCE");
	Session.f_oMS = Session.g_oTempConf;
}
else
{
	Server.logInfo("CURRENTLY NOT IN SUB CONFERENCE");
	Session.f_oMS = Session.g_oMS;
}
Server.logInfo(" f_oMS.strEndPoint" + Session.f_oMS.strEndPoint);
Server.logInfo(" f_oMS.strConnectionId" + Session.f_oMS.strConnectionId);
Server.logInfo(" f_oMS.strCallId" + Session.f_oMS.strCallId);
Server.logInfo(" f_oMS.strType" + Session.f_oMS.strType);]]></script>
          </scripts>
        </action>
        <action id="95" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=651 y=563 ?>
          <!--"ChangeToMuteMode"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ChangeToMutedMode&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
          </function>
          <results >
            <result name="Default" link="13" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_oTempConf.bMuteFlag = true;]]></script>
          </scripts>
        </action>
        <action id="97" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=787 y=1935 ?>
          <!--"ChangeToMutedMode"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ChangeToMutedMode&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
          </function>
          <results >
            <result name="Default" link="5" stubbed="1"/>
            <result name="SUCCESS" link="87" stubbed="1" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_oTempConf.bMuteFlag = true;
Session.g_oTempConf.bDeafFlag = false;]]></script>
          </scripts>
        </action>
        <action id="98" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1644 y=431 ?>
          <results >
            <result name="Default" link="19" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("CURRENT MUTE STATE IS: " + Session.g_bMutedState);
if (Session.g_bCurrentlyInSubConf)
{
	Server.logInfo("CURRENTLY IN SUB CONFERENCE");
	Session.f_oMS = Session.g_oSubConfMS;
}
else if (Session.g_bTalkingWithCSR)
{
	Server.logInfo("CURRENTLY NOT IN SUB CONFERENCE");
	Session.f_oMS = Session.g_oTempConf;
}
else
{
	Server.logInfo("CURRENTLY NOT IN SUB CONFERENCE");
	Session.f_oMS = Session.g_oMS;
}]]></script>
          </scripts>
        </action>
        <action id="99" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1262 y=1822 ?>
          <!--Event conf?-->
          <results >
            <result name="Default" link="94" stubbed="0"/>
            <result name="g_nDnisIdentifyConferenceFlag == 1" link="79" stubbed="1" >g_nDnisIdentifiedConfFlag == 1</result>
          </results>
        </action>
      </actions>
      <text-objects >
        <text-object x-coord="86" y-coord="50" width="191" height="108" text="if currently in main menu,

already out of conference,

set mute flag, when return

to conference, check this flag

and set accordingly" font-name="Times New Roman" size="-16" red="0" green="0" blue="0" weight="0" underline="0" strikeout="0" point-size="12" italic="0"/>
      </text-objects>
    </function>
    <function name="OnUnmutePartyRequest" start="20" event="OnUnmutePartyRequest" returns="void" >
      <parameters >
        <parameter name="strConfControllerIpAddress" type="string"/>
        <parameter name="nConfControllerPort" type="i4"/>
        <parameter name="strTransactionId" type="string"/>
        <parameter name="strModeratorUnmute" type="string"/>
        <parameter name="strPlayUnmutePromptFlag" type="string"/>
      </parameters>
      <local-vars >
        <var name="f_nReturnCode" type="i4" >-1</var>
        <var name="oMS" type="object" ></var>
      </local-vars>
      <actions >
        <action id="20" plug-in="Pactolus.Branch.1" ><?xtml-editor x=99 y=413 ?>
          <!--anonymous caller?-->
          <results >
            <result name="Default" link="14" stubbed="0"/>
            <result name="g_bAnonymousCaller" link="6" stubbed="1" >g_bAnonymousCaller == true</result>
            <result name="g_strMuteFlag" link="6" stubbed="1" >g_strMuteFlag match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: OnUnmutePartyRequest");
js_disable_event();]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=820 y=1012 ?>
          <!--SUCCESS unmute a party-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="strTransactionId" message-name="s_strConfUnmuteResponse" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="s_nSuccess"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="26" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "SUCCESSFUL UNMUTE A PARTY";
Session.g_nPromptSelfMuteUnMute = 907;
Session.g_bMutedState = false;
if ("T" == Session.strModeratorUnmute)
{
	Session.g_bMutedByMod = false;
	Session.g_bSubConfMuteByModFlag = false;
	Session.g_strModeratorMutedFlag = "F";
}]]></script>
          </scripts>
        </action>
        <action id="3" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1042 y=405 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="6" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=558 y=397 ?>
          <!--FAILURE unmute a party-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="strTransactionId" message-name="s_strConfUnmuteResponse" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="s_nFailure"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="27" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "FAIL TO UNMUTE A PARTY";]]></script>
          </scripts>
        </action>
        <action id="14" plug-in="Pactolus.Branch.1" ><?xtml-editor x=327 y=406 ?>
          <!--mute by mod?-->
          <results >
            <result name="Default" link="6" stubbed="0"/>
            <result name="currently unmute" link="2" stubbed="1" >g_bMutedState == false</result>
            <result name="Moderator == &quot;T&quot; or selfmute" link="16" stubbed="0" >g_bMutedByMod == false
OR strModeratorUnmute match "T"
OR g_strModeratorFlag match "T"
OR (g_bSubConfMuteByModFlag == false
AND g_bCurrentlyInSubConf == true)</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: RECEIVE UNMUTE PARTY REQUEST FROM CONF CONTROLLER.");
Server.logInfo("INFO: Moderator UnMute Flag: " + Session.strModeratorUnmute);
Server.logInfo("INFO: Conf Controller Port: " + Session.nConfControllerPort);
Server.logInfo("INFO: Conf Controller IP: " + Session.strConfControllerIpAddress);
Server.logInfo("INFO: Transaction Id: " + Session.strTransactionId);]]></script>
          </scripts>
        </action>
        <action id="16" plug-in="Pactolus.Branch.1" ><?xtml-editor x=581 y=554 ?>
          <!--currently in main menu?-->
          <results >
            <result name="Default" link="21" stubbed="0"/>
            <result name="in main menu" link="2" stubbed="0" >g_bCurrentlyInMMenu == true</result>
            <result name="hold" link="45" stubbed="1" >g_bHoldState == true
OR g_nCallerCurrentState == s_nStateAppletPutOnHold
OR g_nCallerCurrentState == s_nStateCsrPutOnHold</result>
          </results>
        </action>
        <action id="18" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1069 y=500 ?>
          <!--"ChangeToConferenceMode"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ChangeToConferenceMode&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="6" stubbed="1"/>
            <result name="SUCCESS" link="2" stubbed="1" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_oMS.bMuteFlag = false;

	]]></script>
          </scripts>
        </action>
        <action id="19" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1497 y=1001 ?>
          <!--your line is unmuted-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="oMS.strConnectionId" endpoint="oMS.strEndPoint" callid="oMS.strCallId" repeat="1" timeout="10" ms-type="oMS.strType" returns="" start-play="1" interrupt="0" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >s_nPromptUnmuted</audio>
          </play>
          <results >
            <result name="Default" link="34" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("CURRENT MUTE STATE IS: " + Session.g_bMutedState);
if (Session.g_bCurrentlyInSubConf)
{
	Server.logInfo("CURRENTLY IN SUB CONFERENCE");
	Session.oMS = Session.g_oSubConfMS;
}
else if (Session.g_bTalkingWithCSR)
{
	Server.logInfo("CURRENTLY NOT IN SUB CONFERENCE");
	Session.oMS = Session.g_oTempConf;
}
else
{
	Server.logInfo("CURRENTLY NOT IN SUB CONFERENCE");
	Session.oMS = Session.g_oMS;
}]]></script>
          </scripts>
        </action>
        <action id="21" plug-in="Pactolus.Branch.1" ><?xtml-editor x=802 y=552 ?>
          <!--in sub conf?-->
          <results >
            <result name="Default" link="18" stubbed="0"/>
            <result name="g_bCurrentlyInSubConf" link="22" stubbed="0" >g_bCurrentlyInSubConf == true</result>
            <result name="g_bTalkingToCSR" link="32" stubbed="0" >g_bTalkingWithCSR == true</result>
          </results>
        </action>
        <action id="22" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1084 y=669 ?>
          <!--"ChangeToConferenceMode"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ChangeToConferenceMode&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oSubConfMS</parameter>
          </function>
          <results >
            <result name="Default" link="6" stubbed="1"/>
            <result name="SUCCESS" link="2" stubbed="1" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_oSubConfMS.bMuteFlag = false;

	]]></script>
          </scripts>
        </action>
        <action id="26" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1039 y=1010 ?>
          <!--play unmute prompt?-->
          <results >
            <result name="Default" link="27" stubbed="1"/>
            <result name="playUnmutePrompt==T" link="66" stubbed="0" >strPlayUnmutePromptFlag match "T"</result>
          </results>
        </action>
        <action id="27" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=795 y=401 ?>
          <!--set DTMF Detection ON-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;SetDTMFOn&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="3" stubbed="0"/>
          </results>
        </action>
        <action id="30" plug-in="Pactolus.Branch.1" ><?xtml-editor x=361 y=680 ?>
          <!--set g_strModeratorMutedFlag=F-->
          <results >
            <result name="Default" link="31" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if ("T" == Session.strModeratorUnmute)
{
	Session.g_bMutedByMod = false;
	Session.g_bSubConfMuteByModFlag = false;
	Session.g_strModeratorMutedFlag = "F";

}]]></script>
          </scripts>
        </action>
        <action id="31" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=582 y=675 ?>
          <!--SUCCESS unmute a party-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="strTransactionId" message-name="s_strConfUnmuteResponse" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="s_nSuccess"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="27" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "SUCCESS - PARTY MUTABLE";]]></script>
          </scripts>
        </action>
        <action id="32" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1071 y=836 ?>
          <!--"ChangeToConferenceMode"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ChangeToConferenceMode&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
          </function>
          <results >
            <result name="Default" link="6" stubbed="1"/>
            <result name="SUCCESS" link="2" stubbed="1" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_oTempConf.bMuteFlag = false;

	]]></script>
          </scripts>
        </action>
        <action id="34" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1726 y=1000 ?>
          <!--in sub conf?-->
          <results >
            <result name="Default" link="27" stubbed="1"/>
            <result name="g_bCurrentlyInSubConf" link="3" stubbed="1" >g_bCurrentlyInSubConf == true</result>
            <result name="g_bTalkingToCSR" link="3" stubbed="1" >g_bTalkingWithCSR == true</result>
          </results>
        </action>
        <action id="35" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1002 y=1216 ?>
          <!--"ChangeToConferenceMode"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ChangeToConferenceMode&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="6" stubbed="1"/>
            <result name="SUCCESS" link="2" stubbed="1" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_oMS.bMuteFlag = false;
Session.g_oMS.bDeafFlag = false;]]></script>
          </scripts>
        </action>
        <action id="36" plug-in="Pactolus.Branch.1" ><?xtml-editor x=587 y=1225 ?>
          <!--MOH?-->
          <results >
            <result name="Default" link="46" stubbed="0"/>
            <result name="g_strMusicOnHoldFlag==&quot;T&quot;" link="37" stubbed="0" >g_strMusicOnHoldFlag match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bDontPlayContinueToHold = true;]]></script>
          </scripts>
        </action>
        <action id="37" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=589 y=1370 ?>
          <!--"DisconnectFromMOH"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DisconnectFromMOH&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="38" stubbed="1"/>
          </results>
        </action>
        <action id="38" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1001 y=1666 ?>
          <!--Dial In?-->
          <results >
            <result name="Default" link="48" stubbed="0"/>
            <result name="g_strOutdialFlag = &quot;T&quot;;" link="49" stubbed="0" >g_strOutdialFlag match "T"</result>
          </results>
        </action>
        <action id="39" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1521 y=1582 ?>
          <!--AddMemberToConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
            <parameter >g_oCallLegA</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="58" stubbed="0"/>
            <result name="FAILURE" link="43" stubbed="1" >f_nReturnCode == s_nFailure</result>
            <result name="CALLERHUNGUP" link="42" stubbed="1" >f_nReturnCode == s_nCallerHungup</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_oMS.bMuteFlag = false;
Session.g_oMS.bDeafFlag = false;]]></script>
          </scripts>
        </action>
        <action id="40" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1539 y=2016 ?>
          <!--AddMemberToConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
            <parameter >g_oCallLegB</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="58" stubbed="1"/>
            <result name="FAILURE" link="43" stubbed="1" >f_nReturnCode == s_nFailure</result>
            <result name="CALLERHUNGUP" link="42" stubbed="1" >f_nReturnCode == s_nCallerHungup</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_oMS.bMuteFlag = false;
Session.g_oMS.bDeafFlag = false;]]></script>
          </scripts>
        </action>
        <action id="41" plug-in="Standard.EndSession.1" ><?xtml-editor x=2223 y=1599 ?></action>
        <action id="42" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1782 y=1698 ?>
          <!--"PartyLeave"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;PartyLeave&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="62" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nConfLeaveReason = 0;
Session.g_strConfLeaveMsg = "PARTY HANGUP WHILE TRYING TO ADD MEMBER TO CONFERENCE";]]></script>
          </scripts>
        </action>
        <action id="43" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1776 y=1596 ?>
          <!--HangUp Caller-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpCaller&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="62" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 35;
Session.g_nConfLeaveReason = 9;
Session.g_strConfLeaveMsg = "FAIL TO ADD PARTY TO CONFERENCE";]]></script>
          </scripts>
        </action>
        <action id="45" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=348 y=1226 ?>
          <!--"StopTimer"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;StopTimer&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="36" stubbed="0"/>
          </results>
        </action>
        <action id="46" plug-in="Pactolus.Branch.1" ><?xtml-editor x=796 y=1222 ?>
          <!--in sub conf?-->
          <results >
            <result name="Default" link="35" stubbed="0"/>
            <result name="g_bCurrentlyInSubConf" link="47" stubbed="0" >g_bCurrentlyInSubConf == true</result>
            <result name="g_bTalkingWithCSR" link="64" stubbed="0" >g_bTalkingWithCSR == true
AND g_bSideBarOperatorRequest == true</result>
          </results>
        </action>
        <action id="47" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1016 y=1331 ?>
          <!--"ChangeToConferenceMode"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ChangeToConferenceMode&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oSubConfMS</parameter>
          </function>
          <results >
            <result name="Default" link="65" stubbed="1"/>
            <result name="SUCCESS" link="61" stubbed="0" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_oSubConfMS.bMuteFlag = false;
Session.g_oSubConfMS.bDeafFlag = false;]]></script>
          </scripts>
        </action>
        <action id="48" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1236 y=1597 ?>
          <!--in sub conf?-->
          <results >
            <result name="Default" link="39" stubbed="0"/>
            <result name="g_bCurrentlyInSubConf" link="50" stubbed="0" >g_bCurrentlyInSubConf == true</result>
            <result name="g_bSideBarOperatorRequest" link="59" stubbed="0" >g_bSideBarOperatorRequest == true
AND g_bTalkingWithCSR == true</result>
          </results>
        </action>
        <action id="49" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1254 y=2062 ?>
          <!--in sub conf?-->
          <results >
            <result name="Default" link="40" stubbed="0"/>
            <result name="g_bCurrentlyInSubConf" link="51" stubbed="0" >g_bCurrentlyInSubConf == true</result>
            <result name="g_bSideBarOperatorRequest" link="60" stubbed="0" >g_bSideBarOperatorRequest == true
AND g_bTalkingWithCSR == true</result>
          </results>
        </action>
        <action id="50" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1533 y=1726 ?>
          <!--AddMemberToConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oSubConfMS</parameter>
            <parameter >g_oCallLegA</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="61" stubbed="1"/>
            <result name="FAILURE" link="43" stubbed="1" >f_nReturnCode == s_nFailure</result>
            <result name="CALLERHUNGUP" link="42" stubbed="1" >f_nReturnCode == s_nCallerHungup</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_oSubConfMS.bMuteFlag = false;
Session.g_oSubConfMS.bDeafFlag = false;]]></script>
          </scripts>
        </action>
        <action id="51" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1558 y=2171 ?>
          <!--AddMemberToConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oSubConfMS</parameter>
            <parameter >g_oCallLegB</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="61" stubbed="1"/>
            <result name="FAILURE" link="43" stubbed="1" >f_nReturnCode == s_nFailure</result>
            <result name="CALLERHUNGUP" link="42" stubbed="1" >f_nReturnCode == s_nCallerHungup</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_oSubConfMS.bMuteFlag = false;
Session.g_oSubConfMS.bDeafFlag = false;]]></script>
          </scripts>
        </action>
        <action id="52" plug-in="Standard.Timer.1" ><?xtml-editor x=2691 y=1275 ?>
          <!--ck reInvite timer-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lCkReInviteTimerIdA" duration="g_nCkReInviteTime"/>
          <results >
            <result name="Default" link="3" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bCkReInviteTimerFlagA = true;
Server.logInfo("SET TIMER TO CHECK FOR REINVITE A LEG");]]></script>
          </scripts>
        </action>
        <action id="53" plug-in="Standard.Timer.1" ><?xtml-editor x=2709 y=1391 ?>
          <!--ck reInvite timer B-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lCkReInviteTimerIdB" duration="g_nCkReInviteTime"/>
          <results >
            <result name="Default" link="3" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bCkReInviteTimerFlagB = true;
Server.logInfo("SET TIMER TO CHECK FOR REINVITE B LEG");]]></script>
          </scripts>
        </action>
        <action id="54" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1984 y=1314 ?>
          <results >
            <result name="Default" link="3" stubbed="1"/>
            <result name="Time &gt; 0" link="55" stubbed="0" >g_nCkReInviteTime &gt; 0</result>
          </results>
        </action>
        <action id="55" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2220 y=1308 ?>
          <!--Dial In?-->
          <results >
            <result name="Default" link="56" stubbed="0"/>
            <result name="g_strOutdialFlag = &quot;T&quot;" link="57" stubbed="0" >g_strOutdialFlag match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("ConfOffHoldPartyRequest, RESET TIMER TO CHECK FOR REINVITE");]]></script>
          </scripts>
        </action>
        <action id="56" plug-in="Standard.Timer.1" ><?xtml-editor x=2462 y=1275 ?>
          <!--stop ck reInvite timer-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="0" id="g_lCkReInviteTimerIdA" duration=""/>
          <results >
            <result name="Default" link="52" stubbed="0"/>
          </results>
        </action>
        <action id="57" plug-in="Standard.Timer.1" ><?xtml-editor x=2476 y=1392 ?>
          <!--stop ck reInvite timer B-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="0" id="g_lCkReInviteTimerIdB" duration=""/>
          <results >
            <result name="Default" link="53" stubbed="0"/>
          </results>
        </action>
        <action id="58" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1777 y=1508 ?>
          <!--ConfMSConnectionIDChangedNotify-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ConfMSConnectionIDChangedNotify&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="2" stubbed="1"/>
          </results>
        </action>
        <action id="59" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1538 y=1859 ?>
          <!--AddMemberToConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
            <parameter >g_oCallLegA</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="61" stubbed="1"/>
            <result name="FAILURE" link="43" stubbed="1" >f_nReturnCode == s_nFailure</result>
            <result name="CALLERHUNGUP" link="42" stubbed="1" >f_nReturnCode == s_nCallerHungup</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_oTempConf.bMuteFlag = false;
Session.g_oTempConf.bDeafFlag = false;]]></script>
          </scripts>
        </action>
        <action id="60" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1562 y=2297 ?>
          <!--AddMemberToConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
            <parameter >g_oCallLegB</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="61" stubbed="1"/>
            <result name="FAILURE" link="43" stubbed="1" >f_nReturnCode == s_nFailure</result>
            <result name="CALLERHUNGUP" link="42" stubbed="1" >f_nReturnCode == s_nCallerHungup</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_oTempConf.bMuteFlag = false;
Session.g_oTempConf.bDeafFlag = false;]]></script>
          </scripts>
        </action>
        <action id="61" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1247 y=1328 ?>
          <!--SUCCESS unmute a party-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="strTransactionId" message-name="s_strConfUnmuteResponse" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="s_nSuccess"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="67" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "SUCCESSFUL UNMUTE A PARTY";
Session.g_nPromptSelfMuteUnMute = 907;
Session.g_bMutedState = false;
Session.g_nCallerCurrentState = Session.s_nStateAppletPutOffHold;
Session.g_bHoldState = false;
if ("T" == Session.strModeratorUnmute)
{
	Session.g_bMutedByMod = false;
	Session.g_bSubConfMuteByModFlag = false;
	Session.g_strModeratorMutedFlag = "F";
}]]></script>
          </scripts>
        </action>
        <action id="62" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=2007 y=1595 ?>
          <!--FAILURE unmute a party-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="strTransactionId" message-name="s_strConfUnmuteResponse" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="s_nFailure"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="41" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "FAILURE UNMUTE A PARTY, UNABLE TO MODIFY CONFERENCE.";]]></script>
          </scripts>
        </action>
        <action id="63" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1752 y=1321 ?>
          <!--your line is unmuted-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="oMS.strConnectionId" endpoint="oMS.strEndPoint" callid="oMS.strCallId" repeat="1" timeout="10" ms-type="oMS.strType" returns="" start-play="1" interrupt="0" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >s_nPromptUnmuted</audio>
          </play>
          <results >
            <result name="Default" link="54" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("CURRENT MUTE STATE IS: " + Session.g_bMutedState);
if (Session.g_bCurrentlyInSubConf)
{
	Server.logInfo("CURRENTLY IN SUB CONFERENCE");
	Session.oMS = Session.g_oSubConfMS;
}
else if (Session.g_bTalkingWithCSR)
{
	Server.logInfo("CURRENTLY NOT IN SUB CONFERENCE");
	Session.oMS = Session.g_oTempConf;
}
else
{
	Server.logInfo("CURRENTLY NOT IN SUB CONFERENCE");
	Session.oMS = Session.g_oMS;
}]]></script>
          </scripts>
        </action>
        <action id="64" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1022 y=1460 ?>
          <!--"ChangeToConferenceMode"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ChangeToConferenceMode&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
          </function>
          <results >
            <result name="Default" link="65" stubbed="1"/>
            <result name="SUCCESS" link="61" stubbed="1" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_oTempConf.bMuteFlag = false;
Session.g_oTempConf.bDeafFlag = false;]]></script>
          </scripts>
        </action>
        <action id="65" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1253 y=1454 ?>
          <!--FAILURE unmute a party-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="strTransactionId" message-name="s_strConfUnmuteResponse" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="s_nFailure"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="3" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "FAIL TO UNMUTE A PARTY";]]></script>
          </scripts>
        </action>
        <action id="66" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1272 y=1009 ?>
          <!--Event conf?-->
          <results >
            <result name="Default" link="19" stubbed="0"/>
            <result name="g_nDnisIdentifyConferenceFlag == 1" link="34" stubbed="1" >g_nDnisIdentifiedConfFlag == 1</result>
          </results>
        </action>
        <action id="67" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1479 y=1321 ?>
          <!--Event conf?-->
          <results >
            <result name="Default" link="63" stubbed="0"/>
            <result name="g_nDnisIdentifyConferenceFlag == 1" link="54" stubbed="1" >g_nDnisIdentifiedConfFlag == 1</result>
          </results>
        </action>
      </actions>
      <text-objects >
        <text-object x-coord="93" y-coord="65" width="220" height="109" text="if currently in the main menu,

it is already out of the conf.

Just set the mute state flag to false,

when return to conference from 

main menu will check this flag" font-name="Times New Roman" size="-16" red="0" green="0" blue="0" weight="0" underline="0" strikeout="0" point-size="12" italic="0"/>
      </text-objects>
    </function>
    <function name="OnTimer" start="9" event="OnTimer" returns="void" >
      <parameters >
        <parameter name="nTimerId" type="i4"/>
      </parameters>
      <local-vars >
        <var name="f_strACDControllerIP" type="string" ></var>
        <var name="f_nACDControllerPort" type="i4" >0</var>
        <var name="f_strTransactionId" type="string" ></var>
        <var name="f_lCurrentTime" type="i8" >0</var>
        <var name="f_bGetReInviteOnTime" type="boolean" >0</var>
        <var name="f_nReturnCode" type="i4" >-1</var>
        <var name="f_nHoldTime" type="i4" >0</var>
        <var name="f_nPromptNumber" type="i4" >99</var>
        <var name="f_nMaxWaitTime" type="i4" >0</var>
        <var name="f_bIgnorThisTimer" type="boolean" >0</var>
        <var name="nContinueToHold" type="i4" >0</var>
        <var name="strRequestNotify" type="string" ></var>
        <var name="strSignal" type="string" ></var>
      </local-vars>
      <actions >
        <action id="9" plug-in="Pactolus.Branch.1" ><?xtml-editor x=117 y=357 ?>
          <!--timerId?-->
          <results >
            <result name="Default" link="14" stubbed="0"/>
            <result name="WFM maxout" link="106" stubbed="0" >nTimerId == g_lWFMTimerId

AND g_bTimerSet == true</result>
            <result name="Hold timer" link="111" stubbed="0" >nTimerId == g_lHoldTimerId

AND g_bHoldTimerFlag == true</result>
            <result name="Wait for CSR maxout" link="69" stubbed="0" >nTimerId == g_lWaitCSRTimerId

AND g_bWaitCSRTimerSet == true</result>
            <result name="Beep Beep Timer" link="96" stubbed="0" >nTimerId == g_lBeepBeepTimerId

AND g_bBeepBeepTimerFlag == true</result>
            <result name="Heart beat timer" link="31" stubbed="0" >nTimerId == g_lHeartbeatRequestTimerId

AND g_bHeartbeatTimerFlag == true</result>
            <result name="Check Timer Id A" link="110" stubbed="1" >nTimerId == g_lCkReInviteTimerIdA

AND g_bCkReInviteTimerFlagA == true</result>
            <result name="Time to connect to MOH" link="53" stubbed="0" >nTimerId == g_lMOHTimerId

AND g_bMOHTimerFlag == true</result>
            <result name="Check ReInvite Timer IdB" link="110" stubbed="1" >nTimerId == g_lCkReInviteTimerIdB

AND g_bCkReInviteTimerFlagB == true</result>
            <result name="Wait For TPCSR time duration" link="100" stubbed="1" >nTimerId == g_lWaitTPCSRTimerId</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: OnTimer");
Server.logInfo("TIMER ID IS: "  + Session.nTimerId);
js_disable_event();
switch (Session.nTimerId)
{
	case Session.g_lWFMTimerId:
		Server.logInfo("WAIT FOR MODERATOR EXPIRES");
		break;
	case Session.g_lHoldTimerId:
		Server.logInfo("PLAY PLEASE HOLD EXPIRES");
		break;
	case Session.g_lWaitCSRTimerId:
		Server.logInfo("WAIT FOR CSR EXPIRES");
		break;
	case Session.g_lBeepBeepTimerId:
		Server.logInfo("PLAY BEEP BEEP TONE EXPIRES");
		break;
	case Session.g_lHeartbeatRequestTimerId:
		Server.logInfo("SEND HEART BEAT TO ACD CONTROLLER EXPIRES");
		break;
	case Session.g_lCkReInviteTimerIdA:
		Server.logInfo("CHECK FOR REINVITE EXPIRES FROM DIAL IN CALL LEG");
		break;
	case Session.g_lMOHTimerId:
		Server.logInfo("TIME TO CONNECT TO MOH EXPIRES");
		break;
	case Session.g_lCkReInviteTimerIdB:
		Server.logInfo("CHECK FOR REINVITE EXPIRES FROM DIAL OUT CALL LEG");
		break;
	case Session.g_lWaitTPCSRTimerId:
		Server.logInfo("WAIT FOR THIRD PARTY CSR EXPIRES");
		break;
	default:
		Server.logInfo("UNKNOWN TIMER EXPIRES");
		break;
}]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (2 == Result.id)
{
	Server.logInfo("WARNING: TIMER EXPIRES FOR WAITING FOR MODERATOR");
	Session.g_nTerminationReason = 22;
}
else if (7 == Result.id)
{
	Server.logError("ERROR: TIMER EXPIRES FOR WAITING FOR REINVITE FROM CALL LEG A");
	Session.g_nTerminationReason = 12;
}
else if (9 == Result.id)
{
	Server.logError("ERROR: TIMER EXPIRES FOR WAITING FOR REINVITE FROM CALL LEG B");
	Session.g_nTerminationReason = 12;
}]]></script>
          </scripts>
        </action>
        <action id="1" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1055 y=272 ?>
          <!--HangUp Caller-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpCaller&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="18" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nConfLeaveReason = 10;
Session.g_strConfLeaveMsg = "EXCEED MAX TIME WAIT FOR MODERATOR TO JOIN";]]></script>
          </scripts>
        </action>
        <action id="11" plug-in="Standard.Timer.1" ><?xtml-editor x=1037 y=598 ?>
          <!--play please hold every 10 secs-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lHoldTimerId" duration="s_nSleepTime"/>
          <results >
            <result name="Default" link="14" stubbed="1"/>
          </results>
        </action>
        <action id="14" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=331 y=156 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="18" plug-in="Standard.EndSession.1" ><?xtml-editor x=1292 y=272 ?></action>
        <action id="20" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1461 y=1709 ?>
          <!--HangUp Caller-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpCaller&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="18" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 42;
Session.g_nConfLeaveReason = 12;
Session.g_strConfLeaveMsg = "NO PING RESPONSE FROM ACD CONTROLLER";]]></script>
          </scripts>
        </action>
        <action id="27" plug-in="Standard.Timer.1" ><?xtml-editor x=999 y=1533 ?>
          <!--play beep beep every 10 secs-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lBeepBeepTimerId" duration="s_nSleepTime"/>
          <results >
            <result name="Default" link="109" stubbed="0"/>
          </results>
        </action>
        <action id="29" plug-in="Pactolus.Branch.1" ><?xtml-editor x=546 y=475 ?>
          <!--Temp Conf?-->
          <results >
            <result name="Default" link="45" stubbed="0"/>
            <result name="In TempConf == true" link="46" stubbed="0" >g_oTempConf.bCurrentlyInConf == true</result>
            <result name="In MOH Conf == true" link="67" stubbed="0" >g_oMOH_MS.bCurrentlyInConf == true

OR g_oMOH_MS.bCurrentlyConnected == true</result>
            <result name="In SubConf == true" link="97" stubbed="0" >g_bCurrentlyInSubConf == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_enable_event();

if (1 == Session.g_nDnisIdentifiedConfFlag)
{
	if (Session.g_bDontPlayContinueToHold)
		Session.nContinueToHold = 99;
	else
		Session.nContinueToHold = 4144;
}
else
{
	Session.nContinueToHold = 904;
}
if (Session.g_oTempConf.bCurrentlyInConf)
{
	Server.logInfo("CURRENTLY IN TEMP CONF FLAG:  " + Session.g_oTempConf.bCurrentlyInConf);
	Server.logInfo("CURRENTLY CONNECT TO TEMP CONF FLAG:  " + Session.g_oTempConf.bCurrentlyConnected);
	Server.logInfo("TEMP ENDPOINT:  " + Session.g_oTempConf.strEndPoint);
	Server.logInfo("TEMP CONNECTION ID:  " + Session.g_oTempConf.strConnectionId);
	if (Session.g_oTempConf.strEndPoint.length <= 0)
		Server.logError("ERROR: CURRENTLY IN TEMP CONF, BUT TEMP ENDPOINT IS BLANK");
}
else if (Session.g_oMOH_MS.bCurrentlyInConf|Session.g_oMOH_MS.bCurrentlyConnected)
{
	Server.logInfo("CURRENTLY IN MOH CONF FLAG:  " + Session.g_oMOH_MS.bCurrentlyInConf);
	Server.logInfo("CURRENTLY CONNECT TO MOH CONF FLAG:  " + Session.g_oMOH_MS.bCurrentlyConnected);
	Server.logInfo("MOH ENDPOINT:  " + Session.g_oMOH_MS.strEndPoint);
	Server.logInfo("MOH CONNECTION ID:  " + Session.g_oMOH_MS.strConnectionId);
	if (Session.g_oMOH_MS.strEndPoint.length <= 0)
		Server.logError("ERROR: CURRENTLY IN MOH CONF, BUT MOH ENDPOINT IS BLANK");
}
else if (Session.g_bCurrentlyInSubConf || Session.g_oSubConfMS.bCurrentlyInConf)
{
	Server.logInfo("CURRENTLY IN SUB CONF FLAG:  " + Session.g_bCurrentlyInSubConf);
	Server.logInfo("CURRENTLY IN SUB CONF FLAG:  " + Session.g_oSubConfMS.bCurrentlyInConf);
	Server.logInfo("CURRENTLY CONNECT TO SUB CONF FLAG:  " + Session.g_oSubConfMS.bCurrentlyConnected);
	Server.logInfo("SUB CONF ENDPOINT:  " + Session.g_oSubConfMS.strEndPoint);
	Server.logInfo("SUB CONF CONNECTION ID:  " + Session.g_oSubConfMS.strConnectionId);
	if (Session.g_oSubConfMS.strEndPoint.length <= 0)
		Server.logError("ERROR: CURRENTLY IN SUB CONF, BUT SUB CONF ENDPOINT IS BLANK");
}
else
{
	Server.logInfo("CURRENTLY IN MAIN CONF FLAG:  " + Session.g_oMS.bCurrentlyInConf);
	Server.logInfo("CURRENTLY CONNECT TO MAIN CONF FLAG:  " + Session.g_oMS.bCurrentlyConnected);
	Server.logInfo("MAIN ENDPOINT:  " + Session.g_oMS.strEndPoint);
	Server.logInfo("MAIN CONNECTION ID:  " + Session.g_oMS.strConnectionId);
	if (Session.g_oMS.strEndPoint.length <= 0)
		Server.logError("ERROR: CURRENTLY IN MAIN CONF, BUT MAIN CONF ENDPOINT IS BLANK");
}]]></script>
          </scripts>
        </action>
        <action id="31" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=489 y=1776 ?>
          <!--heartbeat request-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strACDControllerIP" transaction="s_strZeroTransactionId" message-name="&quot;HeartbeatRequest&quot;" destination-port="g_nACDControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;SoapAgentPort&quot;" value="g_nSoapPort"/>
          </SOAP>
          <results >
            <result name="Default" link="33" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
        </action>
        <action id="32" plug-in="Standard.Timer.1" ><?xtml-editor x=974 y=1908 ?>
          <!--set timer to check heartbeat with ACD controller-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lHeartbeatRequestTimerId" duration="s_nHeartBeatTime"/>
          <results >
            <result name="Default" link="14" stubbed="1"/>
          </results>
        </action>
        <action id="33" plug-in="Standard.WaitEvent.1" ><?xtml-editor x=724 y=1777 ?>
          <!--wait for heartbeat response-->
          <wait xmlns="urn:www.pactolus.com:xtml:communication" timeout="10" recv-name="g_strEventReceived" >
            <msg name="HeartbeatResponse" >
              <parameter >f_strACDControllerIP</parameter>
              <parameter >f_nACDControllerPort</parameter>
              <parameter >f_strTransactionId</parameter>
            </msg>
          </wait>
          <results >
            <result name="Default" link="40" stubbed="0"/>
            <result name="Success" link="32" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="40" plug-in="Pactolus.Branch.1" ><?xtml-editor x=956 y=1773 ?>
          <!--Temp Conf?-->
          <results >
            <result name="Default" link="51" stubbed="0"/>
            <result name="InTempConf==true" link="50" stubbed="0" >g_oTempConf.bCurrentlyInConf == true</result>
          </results>
        </action>
        <action id="45" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=803 y=468 ?>
          <!--please continue to hold-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="0" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >nContinueToHold</audio>
          </play>
          <results >
            <result name="Default" link="11" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("PLAY PLEASE HOLD IN MAIN CONFERENCE");]]></script>
          </scripts>
        </action>
        <action id="46" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=810 y=595 ?>
          <!--please continue to hold-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oTempConf.strConnectionId" endpoint="g_oTempConf.strEndPoint" callid="g_oTempConf.strCallId" repeat="1" timeout="10" ms-type="g_oTempConf.strType" returns="" start-play="1" interrupt="0" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >nContinueToHold</audio>
          </play>
          <results >
            <result name="Default" link="11" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("PLAY PLEASE HOLD IN TEMP CONFERENCE");]]></script>
          </scripts>
        </action>
        <action id="47" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1075 y=1057 ?>
          <!--can't reach CSR-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oTempConf.strConnectionId" endpoint="g_oTempConf.strEndPoint" callid="g_oTempConf.strCallId" repeat="1" timeout="10" ms-type="g_oTempConf.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >f_nPromptNumber</audio>
          </play>
          <results >
            <result name="Default" link="88" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="48" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1081 y=1230 ?>
          <!--can't reach CSR-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMOH_MS.strConnectionId" endpoint="g_oMOH_MS.strEndPoint" callid="g_oMOH_MS.strCallId" repeat="1" timeout="10" ms-type="g_oMOH_MS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >f_nPromptNumber</audio>
          </play>
          <results >
            <result name="Default" link="88" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="49" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=768 y=1419 ?>
          <!--beep - beep (340)-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="0" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >340</audio>
          </play>
          <results >
            <result name="Default" link="27" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="50" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1239 y=1869 ?>
          <!--ERROR-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oTempConf.strConnectionId" endpoint="g_oTempConf.strEndPoint" callid="g_oTempConf.strCallId" repeat="1" timeout="10" ms-type="g_oTempConf.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >305</audio>
          </play>
          <results >
            <result name="Default" link="20" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="51" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1224 y=1717 ?>
          <!--ERROR-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >305</audio>
          </play>
          <results >
            <result name="Default" link="20" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="52" plug-in="Pactolus.Branch.1" ><?xtml-editor x=433 y=1987 ?>
          <!--Get ReInvite On Time?-->
          <results >
            <result name="Default" link="1" stubbed="1"/>
            <result name="f_bGetReInviteOnTime==true" link="14" stubbed="1" >f_bGetReInviteOnTime == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_lCurrentTime = Server.getUTCTime();
if ( (Session.f_lCurrentTime - Session.g_lLastReInviteTimeA) > (Session.g_oCallLegA.nSessionTimer + 60) )
{
	Session.f_bGetReInviteOnTime = false;
}
else
{
	Session.f_bGetReInviteOnTime = true;
	Session.g_lLastReInviteTimeA = Server.getUTCTime();
}]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (1 == Result.id)
	Session.g_nTerminationReason = 12;]]></script>
          </scripts>
        </action>
        <action id="53" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=446 y=2092 ?>
          <!--"ConnectToMOH"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ConnectToMOH&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="95" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bMOHTimerFlag = false;]]></script>
          </scripts>
        </action>
        <action id="59" plug-in="Standard.Timer.1" ><?xtml-editor x=1193 y=2073 ?>
          <!--play please hold every 10 secs-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lHoldTimerId" duration="f_nHoldTime"/>
          <results >
            <result name="Default" link="115" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bHoldTimerFlag = true;

Session.f_nHoldTime = Session.s_nSleepTime - Session.s_nPreMohTime;]]></script>
          </scripts>
        </action>
        <action id="60" plug-in="Standard.Timer.1" ><?xtml-editor x=946 y=2084 ?>
          <!--set max wait time for CSR-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lWaitCSRTimerId" duration="f_nMaxWaitTime"/>
          <results >
            <result name="Default" link="59" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bWaitCSRTimerSet = true;]]></script>
          </scripts>
        </action>
        <action id="67" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=810 y=731 ?>
          <!--please continue to hold-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMOH_MS.strConnectionId" endpoint="g_oMOH_MS.strEndPoint" callid="g_oMOH_MS.strCallId" repeat="1" timeout="10" ms-type="g_oMOH_MS.strType" returns="" start-play="1" interrupt="0" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >nContinueToHold</audio>
          </play>
          <results >
            <result name="Default" link="114" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("PLAY PLEASE HOLD IN MOH CONFERENCE");]]></script>
          </scripts>
        </action>
        <action id="69" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=548 y=1008 ?>
          <!--stop timers-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;StopTimer&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="70" stubbed="0"/>
          </results>
        </action>
        <action id="70" plug-in="Pactolus.Branch.1" ><?xtml-editor x=779 y=998 ?>
          <!--Temp Conf?-->
          <results >
            <result name="Default" link="71" stubbed="0"/>
            <result name="In TempConf == true" link="47" stubbed="0" >g_oTempConf.bCurrentlyInConf == true</result>
            <result name="In MOH Conf == true" link="48" stubbed="0" >g_oMOH_MS.bCurrentlyInConf == true

OR g_oMOH_MS.bCurrentlyConnected == true</result>
            <result name="In SubConf == true" link="98" stubbed="0" >g_bCurrentlyInSubConf == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (Session.g_nCallerCurrentState == Session.s_nStateWaitForMod)

{

	Session.f_nPromptNumber = 99;

}

else

{

	Session.f_nPromptNumber = 1503

}]]></script>
          </scripts>
        </action>
        <action id="71" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1045 y=883 ?>
          <!--can't reach CSR-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >f_nPromptNumber</audio>
          </play>
          <results >
            <result name="Default" link="88" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="78" plug-in="Standard.EndSession.1" ><?xtml-editor x=2074 y=1087 ?></action>
        <action id="79" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1600 y=1104 ?>
          <!--routed to CSR?-->
          <results >
            <result name="Default" link="87" stubbed="0"/>
            <result name="state == zero out to csr" link="94" stubbed="0" >g_nCallerCurrentState == s_nStateZeroOutToCsr</result>
          </results>
        </action>
        <action id="87" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1822 y=1094 ?>
          <!--HangUp Caller-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpCaller&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="78" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (Session.g_bWaitForModerator == true)
{
	Session.g_nTerminationReason = 22;
}
else
{
	Session.g_nTerminationReason = 45;
}
Session.g_nConfLeaveReason = 13;
Session.g_strConfLeaveMsg = "EXCEED MAX TIME WAIT FOR CSR";]]></script>
          </scripts>
        </action>
        <action id="88" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1373 y=1147 ?>
          <!--"DisconnectFromMOH"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DisconnectFromMOH&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="79" stubbed="0"/>
          </results>
        </action>
        <action id="89" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2301 y=1265 ?>
          <!--set DTMF Detection ON-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;SetDTMFOn&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="14" stubbed="1"/>
          </results>
        </action>
        <action id="92" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2083 y=1267 ?>
          <!--"psAPISceEndRequest"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceEndRequest&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="89" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 1;]]></script>
          </scripts>
        </action>
        <action id="93" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2085 y=1390 ?>
          <!--"psAPISceEndAssignment"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceEndAssignment&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="89" stubbed="1"/>
          </results>
        </action>
        <action id="94" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1847 y=1268 ?>
          <!--s_strMSG_END_REQUEST_CSR-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strACDControllerIP" transaction="s_strZeroTransactionId" message-name="s_strMsgEndRequestCSR" destination-port="g_nACDControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;RequestId&quot;" value="g_lCSRRequestId"/>
            <parameter tag="&quot;AssignmentId&quot;" value="0"/>
          </SOAP>
          <results >
            <result name="Default" link="92" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bSentACDBeginRequest = false;]]></script>
          </scripts>
        </action>
        <action id="95" plug-in="Pactolus.Branch.1" ><?xtml-editor x=699 y=2084 ?>
          <!--set timer?-->
          <results >
            <result name="Default" link="59" stubbed="1"/>
            <result name="f_nMaxWaitTime &gt; 0 ?" link="60" stubbed="0" >f_nMaxWaitTime &gt; 0</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (Session.g_nCallerCurrentState == Session.s_nStateWaitForMod)

{

	Session.f_nMaxWaitTime = Session.g_nMaxCallerHoldTime;

}

else if (Session.g_nCallerCurrentState == Session.s_nStateCsrPutOnHold)

{

	Session.f_nMaxWaitTime = 0;

}

else if (Session.g_nCallerCurrentState == Session.s_nStateAppletPutOnHold)

{

	Session.f_nMaxWaitTime = 0;

}

else if (Session.g_bWaitForCSR == true)

{

	Session.f_nMaxWaitTime = Session.s_nCsrHoldTime;

}
else
{
	Session.f_nMaxWaitTime = Session.s_nCsrHoldTime;
}]]></script>
          </scripts>
        </action>
        <action id="96" plug-in="Pactolus.Branch.1" ><?xtml-editor x=526 y=1477 ?>
          <!--in sub conf?-->
          <results >
            <result name="Default" link="49" stubbed="0"/>
            <result name="g_bCurrentlyInSubConf" link="99" stubbed="0" >g_bCurrentlyInSubConf == true</result>
          </results>
        </action>
        <action id="97" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=812 y=864 ?>
          <!--please continue to hold-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oSubConfMS.strConnectionId" endpoint="g_oSubConfMS.strEndPoint" callid="g_oSubConfMS.strCallId" repeat="1" timeout="10" ms-type="g_oSubConfMS.strType" returns="" start-play="1" interrupt="0" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >nContinueToHold</audio>
          </play>
          <results >
            <result name="Default" link="11" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("PLAY PLEASE HOLD IN SUB CONFERENCE");]]></script>
          </scripts>
        </action>
        <action id="98" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1065 y=1371 ?>
          <!--can't reach CSR-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oSubConfMS.strConnectionId" endpoint="g_oSubConfMS.strEndPoint" callid="g_oSubConfMS.strCallId" repeat="1" timeout="10" ms-type="g_oSubConfMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >f_nPromptNumber</audio>
          </play>
          <results >
            <result name="Default" link="88" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="99" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=779 y=1578 ?>
          <!--beep - beep (340)-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oSubConfMS.strConnectionId" endpoint="g_oSubConfMS.strEndPoint" callid="g_oSubConfMS.strCallId" repeat="1" timeout="10" ms-type="g_oSubConfMS.strType" returns="" start-play="1" interrupt="0" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >340</audio>
          </play>
          <results >
            <result name="Default" link="27" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="100" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1606 y=979 ?>
          <!--TPCSR Write CDR Record-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;TPCSRWriteCDR&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="87" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_lEndTime = Server.getUTCTime();
Session.g_lOutdialConnectTime = Session.g_lEndTime - Session.g_lStartTime;]]></script>
          </scripts>
        </action>
        <action id="101" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=810 y=24 ?>
          <!--Moderator failed to arrive to conf...-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="20" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >874</audio>
            <audio type="index" >899</audio>
            <audio type="index" >322</audio>
          </play>
          <results >
            <result name="Default" link="1" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="106" plug-in="Pactolus.Branch.1" ><?xtml-editor x=535 y=101 ?>
          <!--Temp Conf?-->
          <results >
            <result name="Default" link="101" stubbed="0"/>
            <result name="In TempConf == true" link="107" stubbed="0" >g_oTempConf.bCurrentlyInConf == true
OR g_oTempConf.bCurrentlyConnected == true</result>
            <result name="In MOH Conf == true" link="108" stubbed="0" >g_oMOH_MS.bCurrentlyInConf == true

OR g_oMOH_MS.bCurrentlyConnected == true</result>
          </results>
        </action>
        <action id="107" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=802 y=161 ?>
          <!--Moderator failed to arrive to conf...-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oTempConf.strConnectionId" endpoint="g_oTempConf.strEndPoint" callid="g_oTempConf.strCallId" repeat="1" timeout="20" ms-type="g_oTempConf.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >874</audio>
            <audio type="index" >899</audio>
            <audio type="index" >322</audio>
          </play>
          <results >
            <result name="Default" link="1" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="108" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=808 y=317 ?>
          <!--Moderator failed to arrive to conf...-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oTempConf.strConnectionId" endpoint="g_oTempConf.strEndPoint" callid="g_oTempConf.strCallId" repeat="1" timeout="20" ms-type="g_oTempConf.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >874</audio>
            <audio type="index" >899</audio>
            <audio type="index" >322</audio>
          </play>
          <results >
            <result name="Default" link="1" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="109" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1199 y=1533 ?>
          <!--event base conf?-->
          <results >
            <result name="Default" link="14" stubbed="1"/>
            <result name="g_nDnisIdentifiedConfFlag == 1" link="89" stubbed="1" >g_nDnisIdentifiedConfFlag == 1</result>
          </results>
        </action>
        <action id="110" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1059 y=399 ?>
          <!--HangUp Caller-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpCaller&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="18" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nConfLeaveReason = 11;
Session.g_strConfLeaveMsg = "EXCEED MAX TIME WAIT FOR REINVITE";]]></script>
          </scripts>
        </action>
        <action id="111" plug-in="Pactolus.Branch.1" ><?xtml-editor x=551 y=666 ?>
          <results >
            <result name="Default" link="29" stubbed="0"/>
            <result name="don't play continue to hold" link="14" stubbed="1" >g_nDnisIdentifiedConfFlag == 1
AND g_bDontPlayContinueToHold == true</result>
          </results>
        </action>
        <action id="113" plug-in="Pactolus.MGCPNotifyRequest.1" ><?xtml-editor x=1312 y=720 ?>
          <rqnt xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMOH_MS.strConnectionId" endpoint="g_oMOH_MS.strEndPoint" callid="g_oMOH_MS.strCallId" timeout="10" returns="" ms-type="g_oMOH_MS.strType" >
            <parameters >
              <quarantine step="1" loop="0" process="0" discard="1"/>
              <events ><![CDATA[strRequestNotify]]></events>
              <signals ><![CDATA[strSignal]]></signals>
              <digit-map ><![CDATA["(*0)"]]></digit-map>
            </parameters>
          </rqnt>
          <results >
            <result name="Default" link="11" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("TURN ON DTMF COLLECTION WHILE IN MOH");
Server.logInfo("INFO: RQNT MS call id = " + Session.g_oMOH_MS.strCallId);
Server.logInfo("INFO: RQNT MS connection id = " + Session.g_oMOH_MS.strConnectionId);
Server.logInfo("INFO: RQNT MS end point = " + Session.g_oMOH_MS.strEndPoint);
Session.strRequestNotify = "D/[0-9#*T]@" + Session.g_oMOH_MS.strConnectionId + "(D)";
Session.strSignal = "D/cc@" + Session.g_oMOH_MS.strConnectionId + "(sit=1)";]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)
{
	Server.logError("ERROR: FAIL TO TURN DTMF COLLECTION ON, EXIT BRANCH: " + Result.name);
}]]></script>
          </scripts>
        </action>
        <action id="114" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1064 y=722 ?>
          <results >
            <result name="Default" link="11" stubbed="1"/>
            <result name="turn DTMF collection ON" link="113" stubbed="0" >g_bDtmfCollectionOnHold == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: In sub conference flag: " + Session.g_bCurrentlyInSubConf);
Server.logInfo("INFO: Request CSR flag: " + Session.g_bEBCRequestCSR);
Server.logInfo("INFO: Private talk request CSR flag: " + Session.g_bEBCRequestPrivateCSR);
Server.logInfo("INFO: In private talk flag: " + Session.g_bPrivateTalkInConference);
Server.logInfo("INFO: Talking with CSR flag: " + Session.g_bTalkingWithCSR);
Server.logInfo("INFO: Turn on DTMF collection ON flag: " + Session.g_bDtmfCollectionOnHold);]]></script>
          </scripts>
        </action>
        <action id="115" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1419 y=2074 ?>
          <!--set DTMF Detection ON-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;SetDTMFOn&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="14" stubbed="1"/>
          </results>
        </action>
      </actions>
    </function>
    <function name="psAPISceInitConfSession" start="3" event="psAPISceInitConfSession" returns="i4" >
      <local-vars >
        <var name="f_nReturnCode" type="i4" >-50</var>
      </local-vars>
      <actions >
        <action id="3" plug-in="Pactolus.JavaStaticMethod.1" ><?xtml-editor x=85 y=206 ?>
          <!--"initConfSession()"-->
          <java xmlns="urn:www.pactolus.com:xtml:application" class="&quot;com.pactolus.conferencing.psAPISceInitConfSession&quot;" method="&quot;initConfSession&quot;" timeout="s_nTimeout" return="" method-return-var="f_nReturnCode" method-return-type="0" >
            <parameter type="in" var-type="string" >g_strSessionId</parameter>
            <parameter type="in" var-type="string" >g_strOrigNbr</parameter>
            <parameter type="in" var-type="string" >g_strAccessNumber</parameter>
            <parameter type="inout" var-type="i4" >g_nAccessNumberId</parameter>
            <parameter type="inout" var-type="i8" >g_lServiceProviderId</parameter>
            <parameter type="inout" var-type="string" >g_strLanguage</parameter>
            <parameter type="inout" var-type="i4" >g_nMaxRetryAllowed</parameter>
            <parameter type="inout" var-type="i4" >g_nDialPlanId</parameter>
            <parameter type="inout" var-type="i4" >g_nOrigCountryId</parameter>
            <parameter type="inout" var-type="string" >g_strOrigCallingCode</parameter>
            <parameter type="inout" var-type="string" >g_strOrigAreaCode</parameter>
            <parameter type="inout" var-type="string" >g_strOrigDomIntlFlag</parameter>
            <parameter type="inout" var-type="string" >g_strDBNAME</parameter>
            <parameter type="inout" var-type="string" >g_strWelcomePromptType</parameter>
            <parameter type="inout" var-type="string" >g_strWelcomePromptUrl</parameter>
            <parameter type="inout" var-type="i4" >g_nWelcomePromptIndex</parameter>
            <parameter type="inout" var-type="string" >g_strCustomerServicePhone</parameter>
            <parameter type="inout" var-type="string" >g_strSPTimeZone</parameter>
            <parameter type="inout" var-type="i4" >g_nLocalGMTOffset</parameter>
            <parameter type="inout" var-type="string" >g_strStrippedOrigNbr</parameter>
            <parameter type="inout" var-type="string" >g_strACDEnable</parameter>
            <parameter type="inout" var-type="string" >g_strACDCSROnMaxLoginsEnabled</parameter>
            <parameter type="inout" var-type="string" >g_strACDGreetingEnabled</parameter>
            <parameter type="inout" var-type="string" >g_strACDControllerIP</parameter>
            <parameter type="inout" var-type="i4" >g_nACDControllerPort</parameter>
            <parameter type="inout" var-type="string" >g_strMusicOnHoldFlag</parameter>
            <parameter type="inout" var-type="i4" >g_nPassCodeLength</parameter>
            <parameter type="inout" var-type="string" >g_strThirdPartyAcdOutdialNumber</parameter>
            <parameter type="inout" var-type="string" >g_strThirdPartyAcdOutdialAvail</parameter>
            <parameter type="inout" var-type="i4" >g_nThirdPartyAcdOutdialDur</parameter>
            <parameter type="inout" var-type="string" >g_strBadANIRouteToCSR</parameter>
            <parameter type="inout" var-type="i4" >g_nDnisIdentifiedConfFlag</parameter>
            <parameter type="inout" var-type="i4" >g_nEventDnisType</parameter>
            <parameter type="inout" var-type="string" >g_strConfScheduleId</parameter>
            <parameter type="inout" var-type="string" >g_strScheduleStartTime</parameter>
            <parameter type="inout" var-type="string" >g_strPassCode</parameter>
            <parameter type="inout" var-type="string" >g_strReservationCode</parameter>
            <parameter type="inout" var-type="i4" >g_nInvalidConferenceCode</parameter>
            <parameter type="inout" var-type="string" >g_strInvalidConferenceMsg</parameter>
            <parameter type="inout" var-type="i4" >g_nDefaultAudioMode</parameter>
            <parameter type="inout" var-type="string" >g_strDialedNumberFromDB</parameter>
            <parameter type="inout" var-type="boolean" >g_bSecondaryDnisNumberFlag</parameter>
            <parameter type="inout" var-type="string" >g_strOrigCountryName</parameter>
          </java>
          <results >
            <result name="Default" link="8" stubbed="0"/>
            <result name="Success" link="11" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: psAPISceInitConfSession");
Server.logInfo("INFO: *********JAVA CALLING INITIALIZE CONF *********");]]></script>
            <script language="javascript" timing="last" ><![CDATA[Server.logInfo("INFO: ********** iJavaReturnCode " + Session.f_nReturnCode);
Server.logInfo("Session ID is: " + Session._sessionId);
Server.logInfo("Welcome Prompt Type is: " + Session.g_strWelcomePromptType);
Server.logInfo("ACCESS NUMBER IS: " + Session.g_strAccessNumber);
Server.logInfo("DIALED NUMBER FROM DB IS: " + Session.g_strDialedNumberFromDB);
Server.logInfo("BACKUP NUMBER FLAG FROM DB IS: " + Session.g_bSecondaryDnisNumberFlag);
Server.logInfo("ORIG COUNTRY NAME FROM DB IS: " + Session.g_strOrigCountryName);

if (Result.id == 2)

{

	switch (Session.f_nReturnCode)

	{

		case -99:

		case -98:

		case -50:

			Session.g_nErrorMsgNumber = 1001; //db error

			Session.g_nTerminationReason = 39;

			break;

		case -2:

			Session.g_nErrorMsgNumber = 1002; //bad ani

			Session.g_nTerminationReason = 8;

			break;

		case -3:

			Session.g_nErrorMsgNumber = 1003; //no service provider

			Session.g_nTerminationReason = 3;

			break;

		case -4:

			Session.g_nErrorMsgNumber = 1004; //service disable

			Session.g_nTerminationReason = 5;

			break;

		case -5:

			Session.g_nErrorMsgNumber = 1009; //no acd settings

			break;			

		default:

			Session.g_nErrorMsgNumber = 0;

			break;

	}

}

else

{

	Server.logError("ERROR: FAIL TO CALL INIT CONF SESSION, EXIT ON: " + Result.name);

	Session.g_nTerminationReason = 39;

	Session.g_nErrorMsgNumber = 1000; //jvm server error

}

if (1 == Session.g_nDnisIdentifiedConfFlag)
{
	Server.logInfo("THIS IS EVENT BASE CONFERENCE");
	Server.logInfo("EVENT DNIS TYPE IS: " + Session.g_nEventDnisType);
	switch (Session.g_nEventDnisType)
	{
		case 1:
			Server.logInfo("GET PASSCODE");
			break;
		case 2:
			Server.logInfo("PARTICIPANT CONFERENCE");
			break;
		case 3:
			Server.logInfo("SPEAKER CONFERENCE");
			break;
		case 4:
			Server.logInfo("PARTICIPANT BELL");
			break;
		case 5:
			Server.logInfo("SPEAKER BELL");
			break;
		case 6:
			Server.logInfo("COMM LINE");
			break;
		default:
			Server.logInfo("DEFAULT");
			break;
	}	
	Session.g_strAutoAssign = "F";
}
else
{
	Server.logInfo("THIS IS NOT EVENT BASE CONFERENCE");
	Session.g_strAutoAssign = "T";
}]]></script>
          </scripts>
        </action>
        <action id="1" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=745 y=205 ?>
          <!--FAILURE-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nFailure"/>
        </action>
        <action id="2" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=727 y=451 ?>
          <!--return code from java-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nReturnCode"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (0 == Session.g_nPassCodeLength)
{
	Session.g_strPassCodeDigitMap = "(xxxxxxxxxxxxxxx|x.T|x.#|x.*)";
}
else
{
	var temp_digits = "(";
	for (var i = 0; i < Session.g_nPassCodeLength; i++)
	{
		temp_digits += "x";
	}
	Session.g_strPassCodeDigitMap = temp_digits + "|x.T|x.#|x.*)";
	Session.g_nPromptFollowByPound = 99;  //set this to silence
}
//do it once per session only
if (!Session.g_bSaveOrigAccessNbrId)
{
	Session.g_bSaveOrigAccessNbrId = true;
	Session.g_nOrigAccessNbrId = Session.g_nAccessNumberId;
	Session.g_strOrigAccessNbr = Session.g_strAccessNumber;
	if (3 == Session.g_nEventDnisType)
		Session.g_nReleaseToConfStatus = 1;
	else
		Session.g_nReleaseToConfStatus = 0;
}]]></script>
          </scripts>
        </action>
        <action id="4" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=734 y=307 ?>
          <!--send ALARM-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="" transaction="" message-name="s_strSendAlarmRequest" destination-port="" destination-type="1" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;calling_number&quot;" value="g_strAlarmType"/>
            <parameter tag="&quot;called_number&quot;" value="g_strAlarmPriority"/>
          </SOAP>
          <results >
            <result name="Default" link="1" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strAlarmType = "JAVA: initConfSession";

Session.g_strAlarmPriority = "MAJOR";]]></script>
          </scripts>
        </action>
        <action id="5" plug-in="Pactolus.Branch.1" ><?xtml-editor x=520 y=208 ?>
          <!--s_strSendAlarmFlag==T-->
          <results >
            <result name="Default" link="1" stubbed="0"/>
            <result name="s_strSendAlarmFlag==T" link="4" stubbed="0" >s_strSendAlarmFlag match "T"</result>
          </results>
        </action>
        <action id="6" plug-in="Pactolus.Branch.1" ><?xtml-editor x=470 y=480 ?>
          <!---99 or -50 send alarm-->
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="returnCode==-99 or -50" link="7" stubbed="0" >f_nReturnCode == -50

OR f_nReturnCode == -99</result>
            <result name="returnCode== -99" link="10" stubbed="0" >f_nReturnCode == -98</result>
          </results>
        </action>
        <action id="7" plug-in="Pactolus.UserFunction.1" ><?xtml-editor x=727 y=538 ?>
          <!--send alert db error-->
          <user-function xmlns="urn:www.pactolus.com:xtml:application" process="&quot;PACTOLUS_ps_c_adaptor&quot;" function="&quot;increment_event_counter&quot;" timeout="s_nTimeout" return="" async="1" >
            <parameter >"dbase-error"</parameter>
          </user-function>
          <results >
            <result name="Default" link="5" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="8" plug-in="Pactolus.UserFunction.1" ><?xtml-editor x=289 y=207 ?>
          <!--send alert db error-->
          <user-function xmlns="urn:www.pactolus.com:xtml:application" process="&quot;PACTOLUS_ps_c_adaptor&quot;" function="&quot;increment_event_counter&quot;" timeout="s_nTimeout" return="" async="1" >
            <parameter >"dbase-error"</parameter>
          </user-function>
          <results >
            <result name="Default" link="5" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="10" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=739 y=672 ?>
          <!--sys not avail-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >370</audio>
          </play>
          <results >
            <result name="Default" link="7" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="11" plug-in="Pactolus.Branch.1" ><?xtml-editor x=246 y=479 ?>
          <!--if TPCSROutDial==T 
AND OutdialNumber is null-->
          <results >
            <result name="Default" link="6" stubbed="0"/>
            <result name="if TPCSROutDial==T AND OutdialNumber is null" link="1" stubbed="1" >g_strThirdPartyAcdOutdialAvail match "T"
AND g_strThirdPartyAcdOutdialNumber match ""</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (Session.g_strThirdPartyAcdOutdialAvail ==  "T" && Session.g_strThirdPartyAcdOutdialNumber == "")
{
	Server.logError("ERROR: psApiSceInitConfSession got ThirdPartyAcdOutdialAvail=T, but the ThirdPartyAcdOutdialNumber was enpty");
}]]></script>
          </scripts>
        </action>
      </actions>
      <text-objects >
        <text-object x-coord="84" y-coord="40" width="188" height="77" text="dnisIdentifyConferenceFlag:
1: event type
-3: not event type
-4: expired conference" font-name="Times New Roman" size="-16" red="0" green="0" blue="0" weight="0" underline="0" strikeout="0" point-size="12" italic="0"/>
        <text-object x-coord="81" y-coord="659" width="237" height="115" text="g_strDefaultAudioMode:
0 - speak
1 - hold
2 - mute" font-name="Times New Roman" size="-16" red="0" green="0" blue="0" weight="0" underline="0" strikeout="0" point-size="12" italic="0"/>
        <text-object x-coord="600" y-coord="32" width="198" height="89" text="AutoAssign:
T: Non Event Conf Type
F: Event Conf Type" font-name="Times New Roman" size="-16" red="0" green="0" blue="0" weight="0" underline="0" strikeout="0" point-size="12" italic="0"/>
        <text-object x-coord="350" y-coord="34" width="200" height="144" text="EventDnisType:
1: get passcode
2: no passcode, non speaker
3: no passcode, speaker
4: standard bell, speaker
5: standard bell, non speaker
6: comm line conference" font-name="Times New Roman" size="-16" red="0" green="0" blue="0" weight="0" underline="0" strikeout="0" point-size="12" italic="0"/>
      </text-objects>
    </function>
    <function name="PartyJoin" start="30" event="PartyJoin" returns="void" >
      <local-vars >
        <var name="f_strHostIP" type="string" ></var>
        <var name="f_nHostPort" type="i4" >0</var>
        <var name="f_strTransactionId" type="string" ></var>
        <var name="f_nReturnCode" type="i4" >0</var>
        <var name="f_strWFM" type="string" ></var>
        <var name="f_strMediaServerEndPoint" type="string" ></var>
        <var name="f_strCustomerConferenceId" type="string" ></var>
        <var name="f_nAttendeeId" type="i4" >0</var>
        <var name="f_strSendResponseBack" type="string" ></var>
        <var name="f_strMutedParty" type="string" ></var>
        <var name="f_strAnonymousCaller" type="string" >F</var>
        <var name="f_bNullString" type="boolean" >0</var>
        <var name="f_strPlayFirstNonAnonymousPrompt" type="string" >F</var>
        <var name="f_strNotifyMS" type="string" >F</var>
        <var name="strHoldFlag" type="string" ></var>
        <var name="strEndpointConnectionId" type="string" ></var>
      </local-vars>
      <actions >
        <action id="30" plug-in="Pactolus.Branch.1" ><?xtml-editor x=72 y=85 ?>
          <results >
            <result name="Default" link="34" stubbed="0"/>
            <result name="already sent party join" link="31" stubbed="0" >g_bSentPartyJoin == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: PartyJoin");
js_disable_event();
Session.g_strEventReceived = "";

// doesn't matter what dnis, use default audio mode, dnis type is for display only
if (2 == Session.g_nDefaultAudioMode)
{
	Session.f_strMutedParty = "T";
}
else if (Session.g_bAnonymousCaller)
{
	Session.f_strAnonymousCaller = "T";
	Session.f_strMutedParty = "T";
}
else
{
	Session.f_strAnonymousCaller = "F";
	Session.f_strMutedParty = Session.g_strMuteFlag;
}
if (1 == Session.g_nDefaultAudioMode)
{
	Session.strHoldFlag = "T";
}
else
{
	Session.strHoldFlag = "F";
}

Session.strEndpointConnectionId = Session.g_oMS.strEndPoint + "#" + Session.g_oMS.strConnectionId;]]></script>
          </scripts>
        </action>
        <action id="1" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=620 y=351 ?>
          <!--PARTY JOIN CONF-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="s_strConfJoin" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
            <parameter tag="&quot;callerPassCode&quot;" value="g_strPassCode"/>
            <parameter tag="&quot;moderatorFlag&quot;" value="g_strModeratorFlag"/>
            <parameter tag="&quot;callingNumber&quot;" value="g_strOrigNbr"/>
            <parameter tag="&quot;callerFirstName&quot;" value="g_strCallerFirstName"/>
            <parameter tag="&quot;callerLastName&quot;" value="g_strCallerLastName"/>
            <parameter tag="&quot;callerOrganization&quot;" value="g_strCallerOrg"/>
            <parameter tag="&quot;soapPort&quot;" value="g_nSoapPort"/>
            <parameter tag="&quot;muteFlag&quot;" value="f_strMutedParty"/>
            <parameter tag="&quot;holdFlag&quot;" value="strHoldFlag"/>
            <parameter tag="&quot;mediaServerEndpoint&quot;" value="g_oMS.strConferenceId"/>
            <parameter tag="&quot;moderatorRequiredFlag&quot;" value="g_strModeratorRequiredFlag"/>
            <parameter tag="&quot;nameURL&quot;" value="g_strCallerRecordedName"/>
            <parameter tag="&quot;prepaidBalance&quot;" value="g_fPrepaidBalance"/>
            <parameter tag="&quot;MSConnectTime&quot;" value="g_lPartyJoinTime"/>
            <parameter tag="&quot;totalMeteredRate&quot;" value="g_fTotalMeteredRate"/>
            <parameter tag="&quot;totalFixedRate&quot;" value="g_fTotalFixedRate"/>
            <parameter tag="&quot;operatorFlag&quot;" value="g_strOperatorFlag"/>
            <parameter tag="&quot;dialOutExtNbr&quot;" value="g_strDialOutExtNbr"/>
            <parameter tag="&quot;dialOutRequestId&quot;" value="g_lDialOutRequestId"/>
            <parameter tag="&quot;confSessionId&quot;" value="g_strConfSessionId"/>
            <parameter tag="&quot;callLegId&quot;" value="g_strCallLegId"/>
            <parameter tag="&quot;subscriberFlag&quot;" value="g_strIsSubscriberFlag"/>
            <parameter tag="&quot;attendeeId&quot;" value="g_nAttendeeId"/>
            <parameter tag="&quot;accessNumber&quot;" value="g_strOrigAccessNbr"/>
            <parameter tag="&quot;SIPCallId&quot;" value="g_oCallLegA.strCallId"/>
            <parameter tag="&quot;msConnectionId&quot;" value="strEndpointConnectionId"/>
            <parameter tag="&quot;quickStartFlag&quot;" value="g_strQuickStartFlag"/>
            <parameter tag="&quot;anonymousCaller&quot;" value="f_strAnonymousCaller"/>
            <parameter tag="&quot;CSRRequestId&quot;" value="g_lCSRRequestId"/>
            <parameter tag="&quot;ConfStatus&quot;" value="g_nReleaseToConfStatus"/>
            <parameter tag="&quot;AccessNumberType&quot;" value="g_nEventDnisType"/>
            <parameter tag="&quot;PartySchedId&quot;" value="g_lPartySchedId"/>
            <parameter tag="&quot;PartyDetailString&quot;" value="g_strPartyDetail"/>
            <parameter tag="&quot;SubConferenceId&quot;" value="g_strSubConferenceId"/>
            <parameter tag="&quot;ACDUserId&quot;" value="g_lZeroLong"/>
          </SOAP>
          <results >
            <result name="Default" link="11" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
        </action>
        <action id="2" plug-in="Pactolus.Branch.1" ><?xtml-editor x=336 y=286 ?>
          <!--CallPartyFlag==T?-->
          <results >
            <result name="Default" link="3" stubbed="0"/>
            <result name="g_strPartyPasscodeFlag==T" link="1" stubbed="0" >g_strPartyPasscodeFlag match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: SEND PARTY JOIN ****");

Server.logInfo("INFO: CONF CON IP = " + Session.g_strConfControllerIP);

Server.logInfo("INFO: CONF CON PORT = " + Session.g_nConfControllerPort);

Server.logInfo("INFO: CONF CON TRANS Id = " + Session.g_strResponseTransactionId);

Server.logInfo("INFO: CONF CON MSG NAME = " + Session.s_strConfJoin);

Server.logInfo("INFO: CONF EVENT Id =  " + Session.g_strConfEventId);

Server.logInfo("INFO: CONF SCHED Id =  " + Session.g_strConfScheduleId);

Server.logInfo("INFO: PASSCODE = " + Session.g_strPassCode);

Server.logInfo("INFO: MODERATOR FLAG = " + Session.g_strModeratorFlag);

Server.logInfo("INFO: CALLING NUMBER = " + Session.g_strOrigNbr);

Server.logInfo("INFO: CALLER FIRST NAME = " + Session.g_strCallerFirstName);

Server.logInfo("INFO: CALLER LAST NAME = " + Session.g_strCallerLastName);

Server.logInfo("INFO: CALLER ORG = " + Session.g_strCallerOrg);

Server.logInfo("INFO: SOAP PORT = " + Session.g_nSoapPort);]]></script>
          </scripts>
        </action>
        <action id="3" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=606 y=224 ?>
          <!--PARTY JOIN CONF-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="s_strConfJoin" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
            <parameter tag="&quot;callerPassCode&quot;" value="g_strPassCode"/>
            <parameter tag="&quot;moderatorFlag&quot;" value="g_strModeratorFlag"/>
            <parameter tag="&quot;callingNumber&quot;" value="g_strOrigNbr"/>
            <parameter tag="&quot;callerFirstName&quot;" value="g_strCallerFirstName"/>
            <parameter tag="&quot;callerLastName&quot;" value="g_strCallerLastName"/>
            <parameter tag="&quot;callerOrganization&quot;" value="g_strCallerOrg"/>
            <parameter tag="&quot;soapPort&quot;" value="g_nSoapPort"/>
            <parameter tag="&quot;muteFlag&quot;" value="f_strMutedParty"/>
            <parameter tag="&quot;holdFlag&quot;" value="strHoldFlag"/>
            <parameter tag="&quot;mediaServerEndpoint&quot;" value="g_oMS.strConferenceId"/>
            <parameter tag="&quot;moderatorRequiredFlag&quot;" value="g_strModeratorRequiredFlag"/>
            <parameter tag="&quot;nameURL&quot;" value="g_strCallerRecordedName"/>
            <parameter tag="&quot;prepaidBalance&quot;" value="g_fPrepaidBalance"/>
            <parameter tag="&quot;MSConnectTime&quot;" value="g_lPartyJoinTime"/>
            <parameter tag="&quot;totalMeteredRate&quot;" value="g_fTotalMeteredRate"/>
            <parameter tag="&quot;totalFixedRate&quot;" value="g_fTotalFixedRate"/>
            <parameter tag="&quot;operatorFlag&quot;" value="g_strOperatorFlag"/>
            <parameter tag="&quot;dialOutExtNbr&quot;" value="g_strDialOutExtNbr"/>
            <parameter tag="&quot;dialOutRequestId&quot;" value="g_lDialOutRequestId"/>
            <parameter tag="&quot;confSessionId&quot;" value="g_strConfSessionId"/>
            <parameter tag="&quot;callLegId&quot;" value="g_strCallLegId"/>
            <parameter tag="&quot;subscriberFlag&quot;" value="g_strIsSubscriberFlag"/>
            <parameter tag="&quot;attendeeId&quot;" value="g_nAttendeeId"/>
            <parameter tag="&quot;accessNumber&quot;" value="g_strOrigAccessNbr"/>
            <parameter tag="&quot;SIPCallId&quot;" value="g_oCallLegA.strCallId"/>
            <parameter tag="&quot;msConnectionId&quot;" value="strEndpointConnectionId"/>
            <parameter tag="&quot;quickStartFlag&quot;" value="g_strQuickStartFlag"/>
            <parameter tag="&quot;anonymousCaller&quot;" value="f_strAnonymousCaller"/>
            <parameter tag="&quot;CSRRequestId&quot;" value="g_lCSRRequestId"/>
            <parameter tag="&quot;ConfStatus&quot;" value="g_nReleaseToConfStatus"/>
            <parameter tag="&quot;AccessNumberType&quot;" value="g_nEventDnisType"/>
            <parameter tag="&quot;PartySchedId&quot;" value="g_lPartySchedId"/>
            <parameter tag="&quot;PartyDetailString&quot;" value="g_strPartyDetail"/>
            <parameter tag="&quot;SubConferenceId&quot;" value="g_strSubConferenceId"/>
            <parameter tag="&quot;ACDUserId&quot;" value="g_lZeroLong"/>
          </SOAP>
          <results >
            <result name="Default" link="11" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
        </action>
        <action id="4" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1059 y=274 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if ( 0 == Clib.strcmp(Session.f_strWFM, "F") )

{

	Server.logInfo("MOD ALREADY JOINED, NO NEED TO WAIT");

	Session.g_bWaitForModerator = false;

	Session.g_strConfResource = Session.f_strMediaServerEndPoint;
	
}

else

{

	Server.logInfo("MOD HAS NOT JOIN, MUST WAIT ");

}


Session.g_strCustomerConferenceId = Session.f_strCustomerConferenceId;

if ("T" == Session.f_strMutedParty)

{

	Session.g_bMuteThisParty = true;

}

else

{

	Session.g_bMuteThisParty = false;

}

Server.logInfo("PASSCODE IS: " + Session.g_strPassCode);
Server.logInfo("CC GENERATED PASSCODE IS: " + Session.g_strCCGeneratedPassCode);

if ( 0 == Clib.strcmp(Session.g_strPassCode, Session.g_strCCGeneratedPassCode) )
{
	Session.g_bConfControllerGeneratedPCode = false;
	Server.logInfo("CC generated passcode");
}
else
{
	Session.g_bConfControllerGeneratedPCode = true;
	Server.logInfo("CC not generated passcode");
}

Session.g_bSentPartyJoin = true;
Session.g_bSentPartyLeave = false;

js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="5" plug-in="Pactolus.Branch.1" ><?xtml-editor x=105 y=398 ?>
          <!--dial out?-->
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="OutdialFlag==&quot;T&quot;" link="9" stubbed="0" >g_strOutdialFlag match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[/*
if (Session.g_bTransferParty)
	Session.g_lPartyJoinTime = Session.g_lMSConnectTime;
else
	Session.g_lPartyJoinTime = Server.getUTCTime();
*/]]></script>
          </scripts>
        </action>
        <action id="6" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=636 y=705 ?>
          <!--PARTY JOIN CONF-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="s_strConfJoin" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
            <parameter tag="&quot;callerPassCode&quot;" value="g_strPassCode"/>
            <parameter tag="&quot;moderatorFlag&quot;" value="g_strModeratorFlag"/>
            <parameter tag="&quot;calledNumber&quot;" value="g_strOutdialDestNbr"/>
            <parameter tag="&quot;callerFirstName&quot;" value="g_strCallerFirstName"/>
            <parameter tag="&quot;callerLastName&quot;" value="g_strCallerLastName"/>
            <parameter tag="&quot;callerOrganization&quot;" value="g_strCallerOrg"/>
            <parameter tag="&quot;soapPort&quot;" value="g_nSoapPort"/>
            <parameter tag="&quot;muteFlag&quot;" value="f_strMutedParty"/>
            <parameter tag="&quot;holdFlag&quot;" value="strHoldFlag"/>
            <parameter tag="&quot;mediaServerEndpoint&quot;" value="g_oMS.strConferenceId"/>
            <parameter tag="&quot;moderatorRequiredFlag&quot;" value="g_strModeratorRequiredFlag"/>
            <parameter tag="&quot;nameURL&quot;" value="g_strCallerRecordedName"/>
            <parameter tag="&quot;prepaidBalance&quot;" value="g_fPrepaidBalance"/>
            <parameter tag="&quot;MSConnectTime&quot;" value="g_lPartyJoinTime"/>
            <parameter tag="&quot;totalMeteredRate&quot;" value="g_fTotalMeteredRate"/>
            <parameter tag="&quot;totalFixedRate&quot;" value="g_fTotalFixedRate"/>
            <parameter tag="&quot;operatorFlag&quot;" value="g_strOperatorFlag"/>
            <parameter tag="&quot;dialOutExtNbr&quot;" value="g_strDialOutExtNbr"/>
            <parameter tag="&quot;dialOutRequestId&quot;" value="g_lDialOutRequestId"/>
            <parameter tag="&quot;confSessionId&quot;" value="g_strConfSessionId"/>
            <parameter tag="&quot;callLegId&quot;" value="g_strCallLegId"/>
            <parameter tag="&quot;subscriberFlag&quot;" value="g_strIsSubscriberFlag"/>
            <parameter tag="&quot;attendeeId&quot;" value="g_nAttendeeId"/>
            <parameter tag="&quot;accessNumber&quot;" value="g_strOrigAccessNbr"/>
            <parameter tag="&quot;SIPCallId&quot;" value="g_oCallLegB.strCallId"/>
            <parameter tag="&quot;msConnectionId&quot;" value="strEndpointConnectionId"/>
            <parameter tag="&quot;quickStartFlag&quot;" value="g_strQuickStartFlag"/>
            <parameter tag="&quot;anonymousCaller&quot;" value="f_strAnonymousCaller"/>
            <parameter tag="&quot;CSRRequestId&quot;" value="g_lCSRRequestId"/>
            <parameter tag="&quot;ConfStatus&quot;" value="g_nReleaseToConfStatus"/>
            <parameter tag="&quot;AccessNumberType&quot;" value="g_nEventDnisType"/>
            <parameter tag="&quot;PartySchedId&quot;" value="g_lPartySchedId"/>
            <parameter tag="&quot;PartyDetailString&quot;" value="g_strPartyDetail"/>
            <parameter tag="&quot;SubConferenceId&quot;" value="g_strSubConferenceId"/>
            <parameter tag="&quot;ACDUserId&quot;" value="g_lZeroLong"/>
          </SOAP>
          <results >
            <result name="Default" link="22" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
        </action>
        <action id="7" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=629 y=575 ?>
          <!--PARTY JOIN CONF-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="s_strConfJoin" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
            <parameter tag="&quot;callerPassCode&quot;" value="g_strPassCode"/>
            <parameter tag="&quot;moderatorFlag&quot;" value="g_strModeratorFlag"/>
            <parameter tag="&quot;calledNumber&quot;" value="g_strOutdialDestNbr"/>
            <parameter tag="&quot;callerFirstName&quot;" value="g_strCallerFirstName"/>
            <parameter tag="&quot;callerLastName&quot;" value="g_strCallerLastName"/>
            <parameter tag="&quot;callerOrganization&quot;" value="g_strCallerOrg"/>
            <parameter tag="&quot;soapPort&quot;" value="g_nSoapPort"/>
            <parameter tag="&quot;muteFlag&quot;" value="f_strMutedParty"/>
            <parameter tag="&quot;holdFlag&quot;" value="strHoldFlag"/>
            <parameter tag="&quot;mediaServerEndpoint&quot;" value="g_oMS.strConferenceId"/>
            <parameter tag="&quot;moderatorRequiredFlag&quot;" value="g_strModeratorRequiredFlag"/>
            <parameter tag="&quot;nameURL&quot;" value="g_strCallerRecordedName"/>
            <parameter tag="&quot;prepaidBalance&quot;" value="g_fPrepaidBalance"/>
            <parameter tag="&quot;MSConnectTime&quot;" value="g_lPartyJoinTime"/>
            <parameter tag="&quot;totalMeteredRate&quot;" value="g_fTotalMeteredRate"/>
            <parameter tag="&quot;totalFixedRate&quot;" value="g_fTotalFixedRate"/>
            <parameter tag="&quot;operatorFlag&quot;" value="g_strOperatorFlag"/>
            <parameter tag="&quot;dialOutExtNbr&quot;" value="g_strDialOutExtNbr"/>
            <parameter tag="&quot;dialOutRequestId&quot;" value="g_lDialOutRequestId"/>
            <parameter tag="&quot;confSessionId&quot;" value="g_strConfSessionId"/>
            <parameter tag="&quot;callLegId&quot;" value="g_strCallLegId"/>
            <parameter tag="&quot;subscriberFlag&quot;" value="g_strIsSubscriberFlag"/>
            <parameter tag="&quot;attendeeId&quot;" value="g_nAttendeeId"/>
            <parameter tag="&quot;accessNumber&quot;" value="g_strOrigAccessNbr"/>
            <parameter tag="&quot;SIPCallId&quot;" value="g_oCallLegB.strCallId"/>
            <parameter tag="&quot;msConnectionId&quot;" value="strEndpointConnectionId"/>
            <parameter tag="&quot;quickStartFlag&quot;" value="g_strQuickStartFlag"/>
            <parameter tag="&quot;anonymousCaller&quot;" value="f_strAnonymousCaller"/>
            <parameter tag="&quot;CSRRequestId&quot;" value="g_lCSRRequestId"/>
            <parameter tag="&quot;ConfStatus&quot;" value="g_nReleaseToConfStatus"/>
            <parameter tag="&quot;AccessNumberType&quot;" value="g_nEventDnisType"/>
            <parameter tag="&quot;PartySchedId&quot;" value="g_lPartySchedId"/>
            <parameter tag="&quot;PartyDetailString&quot;" value="g_strPartyDetail"/>
            <parameter tag="&quot;SubConferenceId&quot;" value="g_strSubConferenceId"/>
            <parameter tag="&quot;ACDUserId&quot;" value="g_lZeroLong"/>
          </SOAP>
          <results >
            <result name="Default" link="22" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
        </action>
        <action id="9" plug-in="Pactolus.Branch.1" ><?xtml-editor x=350 y=619 ?>
          <!--CallPartyFlag==T?-->
          <results >
            <result name="Default" link="7" stubbed="0"/>
            <result name="g_strPartyPasscodeFlag==T" link="6" stubbed="0" >g_strPartyPasscodeFlag match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: SEND PARTY JOIN ****");

Server.logInfo("INFO: CONF CON IP = " + Session.g_strConfControllerIP);

Server.logInfo("INFO: CONF CON PORT = " + Session.g_nConfControllerPort);

Server.logInfo("INFO: CONF CON TRANS Id = " + Session.g_strResponseTransactionId);

Server.logInfo("INFO: CONF CON MSG NAME = " + Session.s_strConfJoin);

Server.logInfo("INFO: CONF EVENT Id =  " + Session.g_strConfEventId);

Server.logInfo("INFO: CONF SCHED Id =  " + Session.g_strConfScheduleId);

Server.logInfo("INFO: PASSCODE = " + Session.g_strPassCode);

Server.logInfo("INFO: MODERATOR FLAG = " + Session.g_strModeratorFlag);

Server.logInfo("INFO: CALLING NUMBER = " + Session.g_strOrigNbr);

Server.logInfo("INFO: CALLER FIRST NAME = " + Session.g_strCallerFirstName);

Server.logInfo("INFO: CALLER LAST NAME = " + Session.g_strCallerLastName);

Server.logInfo("INFO: CALLER ORG = " + Session.g_strCallerOrg);

Server.logInfo("INFO: SOAP PORT = " + Session.g_nSoapPort);]]></script>
          </scripts>
        </action>
        <action id="11" plug-in="Standard.WaitEvent.1" ><?xtml-editor x=1062 y=373 ?>
          <!--ConfJoinEventResponse -->
          <wait xmlns="urn:www.pactolus.com:xtml:communication" timeout="8" recv-name="g_strEventReceived" >
            <msg name="ConfJoinEventResponse" >
              <parameter >f_strHostIP</parameter>
              <parameter >f_nHostPort</parameter>
              <parameter >f_strTransactionId</parameter>
              <parameter >f_strWFM</parameter>
              <parameter >f_strMediaServerEndPoint</parameter>
              <parameter >f_strCustomerConferenceId</parameter>
              <parameter >g_strCCGeneratedPassCode</parameter>
              <parameter >f_strPlayFirstNonAnonymousPrompt</parameter>
            </msg>
            <msg name="psConfRemovePartyRequest" >
              <parameter >f_strHostIP</parameter>
              <parameter >f_nHostPort</parameter>
              <parameter >f_strTransactionId</parameter>
              <parameter >g_nTerminationReason</parameter>
              <parameter >g_lEndTime</parameter>
              <parameter >f_strSendResponseBack</parameter>
              <parameter >f_strNotifyMS</parameter>
            </msg>
          </wait>
          <results >
            <result name="Default" link="29" stubbed="0"/>
            <result name="Success" link="32" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[Session.g_bPlayFirstNonAnonymousPrompt = false;
if (Session.f_strPlayFirstNonAnonymousPrompt = 'T')
{
	Session.g_bPlayFirstNonAnonymousPrompt = true;
}
]]></script>
          </scripts>
        </action>
        <action id="18" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1540 y=291 ?>
          <!--HangUpCaller-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpCaller&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="33" stubbed="0"/>
          </results>
        </action>
        <action id="19" plug-in="Standard.EndSession.1" ><?xtml-editor x=2233 y=282 ?></action>
        <action id="20" plug-in="Pactolus.UserFunction.1" ><?xtml-editor x=1991 y=279 ?>
          <!--send alert conf-controller-shutdown-->
          <user-function xmlns="urn:www.pactolus.com:xtml:application" process="&quot;PACTOLUS_ps_c_adaptor&quot;" function="&quot;increment_event_counter&quot;" timeout="s_nTimeout" return="" async="1" >
            <parameter >"conf-controller-shutdown"</parameter>
          </user-function>
          <results >
            <result name="Default" link="19" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="22" plug-in="Standard.WaitEvent.1" ><?xtml-editor x=1062 y=710 ?>
          <!--ConfJoinEventResponse -->
          <wait xmlns="urn:www.pactolus.com:xtml:communication" timeout="8" recv-name="g_strEventReceived" >
            <msg name="ConfJoinEventResponse" >
              <parameter >f_strHostIP</parameter>
              <parameter >f_nHostPort</parameter>
              <parameter >f_strTransactionId</parameter>
              <parameter >f_strWFM</parameter>
              <parameter >f_strMediaServerEndPoint</parameter>
              <parameter >f_strCustomerConferenceId</parameter>
              <parameter >g_strCCGeneratedPassCode</parameter>
              <parameter >f_strPlayFirstNonAnonymousPrompt</parameter>
            </msg>
            <msg name="psConfRemovePartyRequest" >
              <parameter >f_strHostIP</parameter>
              <parameter >f_nHostPort</parameter>
              <parameter >f_strTransactionId</parameter>
              <parameter >g_nTerminationReason</parameter>
              <parameter >g_lEndTime</parameter>
              <parameter >f_strSendResponseBack</parameter>
              <parameter >f_strNotifyMS</parameter>
            </msg>
          </wait>
          <results >
            <result name="Default" link="29" stubbed="1"/>
            <result name="Success" link="32" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[Session.g_bPlayFirstNonAnonymousPrompt = false;
if (Session.f_strPlayFirstNonAnonymous = 'T')
{
	Session.g_bPlayFirstNonAnonymousPrompt = true;
}
]]></script>
          </scripts>
        </action>
        <action id="29" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1312 y=296 ?>
          <results >
            <result name="Default" link="18" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (Session.g_strEventReceived != "psConfRemovePartyRequest")

{

	Server.logError("ERROR: NO RESPONSE FOR CONF JOIN EVENT.");

}

if ("T" == Session.f_strSendResponseBack || "t" == Session.f_strSendResponseBack)

{

	Session.g_bSendMsgToCC = true;

}

else

{

	Session.g_bSendMsgToCC = false;

}
Session.g_nTerminationReason = 41;]]></script>
          </scripts>
        </action>
        <action id="31" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=348 y=185 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
        </action>
        <action id="32" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1332 y=547 ?>
          <!--ConfJoinResponse?-->
          <results >
            <result name="Default" link="29" stubbed="1"/>
            <result name="ConfJoinEventResponse" link="4" stubbed="1" >g_strEventReceived match "ConfJoinEventResponse"</result>
            <result name="Not WFM &amp;&amp; No Conf Resource" link="18" stubbed="1" >f_bNullString == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if ( 0 == Clib.strcmp(Session.f_strWFM, "F") &&  0 == Session.f_strMediaServerEndPoint.length && !Session.g_bMoveDirectlyInSubConf)
{
	Session.f_bNullString = true;
	Server.logError("MOD JOINED CONF, BUT NO CONFERENCE ENDPOINT");
}
]]></script>
          </scripts>
        </action>
        <action id="33" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1768 y=290 ?>
          <!--ConfRemovePartyRequest?-->
          <results >
            <result name="Default" link="20" stubbed="0"/>
            <result name="ConfRemovePartyRequest" link="19" stubbed="1" >g_strEventReceived match "ConfRemovePartyRequest"</result>
          </results>
        </action>
        <action id="34" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=330 y=74 ?>
          <!--"psAPISceConfCallLegSetMSConnectTime"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceConfCallLegSetMSConnectTime&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="5" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("Party Join, set MS connect time in DB");
Server.logInfo("INFO: MS connect time = " + Session.g_lMSConnectTime);
Server.logInfo("INFO: now time = " + Server.getUTCTime());
Server.logInfo("INFO: transfer party flag = " + Session.g_bTransferParty);
if (0 == Session.g_lMSConnectTime)
{
	Server.logInfo("THERE IS NO CONNECT TIME, MUST HAD GONE DIRECTLY INTO SUB CONF");
	Session.g_lMSConnectTime = Server.getUTCTime();
}
Session.g_lPartyJoinTime = Session.g_lMSConnectTime;]]></script>
            <script language="javascript" timing="last" ><![CDATA[Server.logInfo("set MS connect time returns: " + Session.f_nReturnCode);]]></script>
          </scripts>
        </action>
      </actions>
      <text-objects >
        <text-object x-coord="632" y-coord="508" width="125" height="44" text="send called number, oudial dest number" font-name="Times New Roman" size="-16" red="0" green="0" blue="0" weight="0" underline="0" strikeout="0" point-size="12" italic="0"/>
        <text-object x-coord="609" y-coord="116" width="137" height="71" text="send calling number,
origin number" font-name="Times New Roman" size="-16" red="0" green="0" blue="0" weight="0" underline="0" strikeout="0" point-size="12" italic="0"/>
      </text-objects>
    </function>
    <function name="SetDTMFOn" start="6" event="SetDTMFOn" returns="void" >
      <local-vars >
        <var name="f_strRequestNotify" type="string" ></var>
        <var name="f_strSignal" type="string" ></var>
      </local-vars>
      <actions >
        <action id="6" plug-in="Pactolus.Branch.1" ><?xtml-editor x=45 y=372 ?>
          <!--postpaid and no conf record-->
          <results >
            <result name="Default" link="16" stubbed="0"/>
            <result name="prepaid or conf record allowed" link="11" stubbed="1" >g_nBillingType == 1

OR g_strConfRecordAllowed match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: SetDTMFOn");
js_disable_event();

Server.logInfo("INFO: RQNT MS call id = " + Session.g_oMS.strCallId);

Server.logInfo("INFO: RQNT MS connection id = " + Session.g_oMS.strConnectionId);

Server.logInfo("INFO: RQNT MS end point = " + Session.g_oMS.strEndPoint);]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Pactolus.MGCPNotifyRequest.1" ><?xtml-editor x=971 y=28 ?>
          <rqnt xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" timeout="s_nTimeout" returns="" ms-type="g_oMS.strType" >
            <parameters >
              <quarantine step="1" loop="0" process="0" discard="1"/>
              <events ><![CDATA[f_strRequestNotify]]></events>
              <signals ><![CDATA[f_strSignal]]></signals>
              <digit-map ><![CDATA["(*T|**)"]]></digit-map>
            </parameters>
          </rqnt>
          <results >
            <result name="Default" link="3" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_strRequestNotify = "D/[*T]@" + Session.g_oMS.strConnectionId + "(D)";

Session.f_strSignal = "D/cc@" + Session.g_oMS.strConnectionId + "(sit=1)";]]></script>
          </scripts>
        </action>
        <action id="3" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1194 y=318 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="4" plug-in="Pactolus.Branch.1" ><?xtml-editor x=217 y=122 ?>
          <!--prepaid conference-->
          <results >
            <result name="Default" link="13" stubbed="1"/>
            <result name="billing type == 1?" link="2" stubbed="1" >g_nBillingType == 1</result>
          </results>
        </action>
        <action id="5" plug-in="Pactolus.MGCPNotifyRequest.1" ><?xtml-editor x=959 y=318 ?>
          <rqnt xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" timeout="s_nTimeout" returns="" ms-type="g_oMS.strType" >
            <parameters >
              <quarantine step="1" loop="0" process="0" discard="1"/>
              <events ><![CDATA[f_strRequestNotify]]></events>
              <signals ><![CDATA[f_strSignal]]></signals>
              <digit-map ><![CDATA["(14|15|00|99|*1|*5|*6|*8|*0|*#|**|##)"]]></digit-map>
            </parameters>
          </rqnt>
          <results >
            <result name="Default" link="3" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_strRequestNotify = "D/[0-9#*T]@" + Session.g_oMS.strConnectionId + "(D)";

Session.f_strSignal = "D/cc@" + Session.g_oMS.strConnectionId + "(sit=1)";]]></script>
          </scripts>
        </action>
        <action id="7" plug-in="Pactolus.MGCPNotifyRequest.1" ><?xtml-editor x=465 y=119 ?>
          <rqnt xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" timeout="s_nTimeout" returns="" ms-type="g_oMS.strType" >
            <parameters >
              <quarantine step="1" loop="0" process="0" discard="1"/>
              <events ><![CDATA[f_strRequestNotify]]></events>
              <signals ><![CDATA[]]></signals>
              <digit-map ><![CDATA["(xx|*x|**|*#)"]]></digit-map>
            </parameters>
          </rqnt>
          <results >
            <result name="Default" link="3" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: RQNT MS call id = " + Session.g_oMS.strCallId);

Server.logInfo("INFO: RQNT MS connection id = " + Session.g_oMS.strConnectionId);

Server.logInfo("INFO: RQNT MS end point = " + Session.g_oMS.strEndPoint);

// Session.f_strRequestNotify = "D/[0-9#*T]@" + Session.g_oMS.strConnectionId + "(D)";

Session.f_strRequestNotify = "D/[0-9#*T]@" + Session.g_oMS.strConnectionId + "(D)";]]></script>
          </scripts>
        </action>
        <action id="8" plug-in="Pactolus.MGCPNotifyRequest.1" ><?xtml-editor x=697 y=117 ?>
          <rqnt xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" timeout="s_nTimeout" returns="" ms-type="g_oMS.strType" >
            <parameters >
              <quarantine step="1" loop="0" process="0" discard="1"/>
              <events ><![CDATA[f_strRequestNotify]]></events>
              <signals ><![CDATA[]]></signals>
              <digit-map ><![CDATA["(*[0-8]|*91|*92|*93|*94|**|*#)"]]></digit-map>
            </parameters>
          </rqnt>
          <results >
            <result name="Default" link="3" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: RQNT MS call id = " + Session.g_oMS.strCallId);

Server.logInfo("INFO: RQNT MS connection id = " + Session.g_oMS.strConnectionId);

Server.logInfo("INFO: RQNT MS end point = " + Session.g_oMS.strEndPoint);

// Session.f_strRequestNotify = "D/[0-9#*T]@" + Session.g_oMS.strConnectionId + "(D)";

Session.f_strRequestNotify = "D/[0-9#*T]@" + Session.g_oMS.strConnectionId + "(D)";]]></script>
          </scripts>
        </action>
        <action id="9" plug-in="Pactolus.Branch.1" ><?xtml-editor x=30 y=122 ?>
          <!--NO CSR-->
          <results >
            <result name="Default" link="6" stubbed="1"/>
            <result name="operatorAssistType == 3" link="3" stubbed="1" >g_nOperatorAssistType == 3</result>
          </results>
        </action>
        <action id="10" plug-in="Pactolus.MGCPNotifyRequest.1" ><?xtml-editor x=970 y=153 ?>
          <rqnt xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" timeout="s_nTimeout" returns="" ms-type="g_oMS.strType" >
            <parameters >
              <quarantine step="1" loop="0" process="0" discard="1"/>
              <events ><![CDATA[f_strRequestNotify]]></events>
              <signals ><![CDATA[f_strSignal]]></signals>
              <digit-map ><![CDATA["(*T|**)"]]></digit-map>
            </parameters>
          </rqnt>
          <results >
            <result name="Default" link="3" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: RQNT MS call id = " + Session.g_oMS.strCallId);

Server.logInfo("INFO: RQNT MS connection id = " + Session.g_oMS.strConnectionId);

Server.logInfo("INFO: RQNT MS end point = " + Session.g_oMS.strEndPoint);

// Session.f_strRequestNotify = "D/[0-9#*T]@" + Session.g_oMS.strConnectionId + "(D)";

Session.f_strRequestNotify = "D/[*T]@" + Session.g_oMS.strConnectionId + "(D)";

Session.f_strSignal = "D/cc@" + Session.g_oMS.strConnectionId + "(sit=1)";]]></script>
          </scripts>
        </action>
        <action id="11" plug-in="Pactolus.Branch.1" ><?xtml-editor x=475 y=325 ?>
          <!--in sub conf?-->
          <results >
            <result name="Default" link="13" stubbed="0"/>
            <result name="g_bCurrentlyInSubConf" link="14" stubbed="0" >g_bCurrentlyInSubConf == true</result>
          </results>
        </action>
        <action id="12" plug-in="Pactolus.MGCPNotifyRequest.1" ><?xtml-editor x=970 y=450 ?>
          <rqnt xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oSubConfMS.strConnectionId" endpoint="g_oSubConfMS.strEndPoint" callid="g_oSubConfMS.strCallId" timeout="s_nTimeout" returns="" ms-type="g_oSubConfMS.strType" >
            <parameters >
              <quarantine step="1" loop="0" process="0" discard="1"/>
              <events ><![CDATA[f_strRequestNotify]]></events>
              <signals ><![CDATA[f_strSignal]]></signals>
              <digit-map ><![CDATA["(14|15|00|99|*1|*5|*6|*8|*0|*#|**|##)"]]></digit-map>
            </parameters>
          </rqnt>
          <results >
            <result name="Default" link="3" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_strRequestNotify = "D/[0-9#*T]@" + Session.g_oSubConfMS.strConnectionId + "(D)";

Session.f_strSignal = "D/cc@" + Session.g_oSubConfMS.strConnectionId + "(sit=1)";]]></script>
          </scripts>
        </action>
        <action id="13" plug-in="Pactolus.Branch.1" ><?xtml-editor x=700 y=323 ?>
          <results >
            <result name="Default" link="5" stubbed="0"/>
            <result name="blank endpoint" link="3" stubbed="1" >g_oMS.strEndPoint.length &lt;= 0</result>
          </results>
        </action>
        <action id="14" plug-in="Pactolus.Branch.1" ><?xtml-editor x=707 y=450 ?>
          <results >
            <result name="Default" link="12" stubbed="0"/>
            <result name="blank endpoint" link="3" stubbed="1" >g_oSubConfMS.strEndPoint.length &lt;= 0</result>
          </results>
        </action>
        <action id="16" plug-in="Pactolus.Branch.1" ><?xtml-editor x=263 y=372 ?>
          <results >
            <result name="Default" link="11" stubbed="0"/>
            <result name="turn DTMF collection ON" link="17" stubbed="0" >g_bCurrentlyInSubConf == false
AND g_bEBCRequestCSR == false
AND g_bPrivateTalkInConference == false
AND g_bTalkingWithCSR == false
AND g_bDtmfCollectionOnHold == true</result>
          </results>
        </action>
        <action id="17" plug-in="Pactolus.MGCPNotifyRequest.1" ><?xtml-editor x=482 y=480 ?>
          <rqnt xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMOH_MS.strConnectionId" endpoint="g_oMOH_MS.strEndPoint" callid="g_oMOH_MS.strCallId" timeout="s_nTimeout" returns="" ms-type="g_oMOH_MS.strType" >
            <parameters >
              <quarantine step="1" loop="0" process="0" discard="1"/>
              <events ><![CDATA[f_strRequestNotify]]></events>
              <signals ><![CDATA[f_strSignal]]></signals>
              <digit-map ><![CDATA["(*0|00)"]]></digit-map>
            </parameters>
          </rqnt>
          <results >
            <result name="Default" link="11" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("TURN ON DTMF COLLECTION WHILE IN MOH");
Server.logInfo("INFO: RQNT MS call id = " + Session.g_oMOH_MS.strCallId);
Server.logInfo("INFO: RQNT MS connection id = " + Session.g_oMOH_MS.strConnectionId);
Server.logInfo("INFO: RQNT MS end point = " + Session.g_oMOH_MS.strEndPoint);
Session.f_strRequestNotify = "D/[0-9#*T]@" + Session.g_oMOH_MS.strConnectionId + "(D)";
Session.f_strSignal = "D/cc@" + Session.g_oMOH_MS.strConnectionId + "(sit=1)";]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)
{
	Server.logError("ERROR: FAIL TO TURN DTMF COLLECTION ON, EXIT BRANCH: " + Result.name);
}]]></script>
          </scripts>
        </action>
      </actions>
    </function>
    <function name="PartyLeave" start="23" event="PartyLeave" returns="void" >
      <local-vars >
        <var name="f_bNullString" type="boolean" >0</var>
        <var name="f_strDeleteSubConf" type="string" >T</var>
        <var name="f_strConferenceId" type="string" ></var>
        <var name="f_strControllerIP" type="string" ></var>
        <var name="f_nControllerPort" type="i4" >0</var>
        <var name="f_strTransactionId" type="string" ></var>
        <var name="strTransferedFlag" type="string" >F</var>
        <var name="nReturnCode" type="i4" >0</var>
      </local-vars>
      <actions >
        <action id="23" plug-in="Pactolus.Branch.1" ><?xtml-editor x=75 y=87 ?>
          <!--sent party join?-->
          <results >
            <result name="Default" link="4" stubbed="0"/>
            <result name="sent party join == true" link="31" stubbed="0" >g_bSentPartyJoin == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: PartyLeave");
Server.logInfo("Session.g_strSubConferenceId : " + Session.g_strSubConferenceId);
Server.logInfo("Session.g_strConfScheduleId : " + Session.g_strConfScheduleId);

if (Session.g_bCurrentlyInSubConf)
{
	Server.logInfo("CURRENTLY IN SUB CONFERENCE");
	if (0 == Session.g_strSubConferenceId.length)
	{
		Server.logError("ERROR: CURRENTLY IN SUB CONFERENCE, BUT SUB CONFERENCE ID IS BLANK");
		Session.f_strConferenceId = Session.g_strConfScheduleId;	
	}
	else
	{
		Session.f_strConferenceId = Session.g_strSubConferenceId;
	}
}
else
{
	Session.f_strConferenceId = Session.g_strConfScheduleId;
}]]></script>
          </scripts>
        </action>
        <action id="1" plug-in="Pactolus.Branch.1" ><?xtml-editor x=413 y=250 ?>
          <!--CallPartyFlag==T?-->
          <results >
            <result name="Default" link="3" stubbed="0"/>
            <result name="!g_bSendMsgToCC" link="24" stubbed="1" >g_bSendMsgToCC == false</result>
            <result name="g_strPartyPasscodeFlag==T" link="2" stubbed="0" >g_strPartyPasscodeFlag match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: **** SEND PARTY LEAVE ****");

Server.logInfo("INFO: CONF CON IP = " + Session.g_strConfControllerIP);

Server.logInfo("INFO: CONF CON PORT = " + Session.g_nConfControllerPort);

Server.logInfo("INFO: CONF CON TRANS Id = " + Session.g_strResponseTransactionId);

Server.logInfo("INFO: CONF CON MSG NAME = " + Session.s_strConfLeave);

Server.logInfo("INFO: CONF EVENT Id =  " + Session.g_strConfEventId);

Server.logInfo("INFO: CONF SCHED Id =  " + Session.g_strConfScheduleId);

Server.logInfo("INFO: PASSCODE = " + Session.g_strPassCode);

if (0 == Session.g_lEndTime)

{

	Session.g_lEndTime = Server.getUTCTime();

}]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=603 y=419 ?>
          <!--PARTY LEAVE CONF-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="s_strConfLeave" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;conferenceId&quot;" value="f_strConferenceId"/>
            <parameter tag="&quot;callerPassCode&quot;" value="g_strCCGeneratedPassCode"/>
            <parameter tag="&quot;disconnectTime&quot;" value="g_lEndTime"/>
            <parameter tag="&quot;reasonCode&quot;" value="g_nConfLeaveReason"/>
            <parameter tag="&quot;reasonMsg&quot;" value="g_strConfLeaveMsg"/>
            <parameter tag="&quot;transferedFlag&quot;" value="strTransferedFlag"/>
          </SOAP>
          <results >
            <result name="Default" link="26" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
        </action>
        <action id="3" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=587 y=255 ?>
          <!--PARTY LEAVE CONF-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="s_strConfLeave" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;conferenceId&quot;" value="f_strConferenceId"/>
            <parameter tag="&quot;callerPassCode&quot;" value="g_strCCGeneratedPassCode"/>
            <parameter tag="&quot;disconnectTime&quot;" value="g_lEndTime"/>
            <parameter tag="&quot;reasonCode&quot;" value="g_nConfLeaveReason"/>
            <parameter tag="&quot;reasonMsg&quot;" value="g_strConfLeaveMsg"/>
            <parameter tag="&quot;transferedFlag&quot;" value="strTransferedFlag"/>
          </SOAP>
          <results >
            <result name="Default" link="26" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
        </action>
        <action id="4" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=275 y=75 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (Session.g_bCurrentlyInSubConf)
	Session.g_bCurrentlyInSubConf = false;
js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="14" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1060 y=592 ?>
          <!--play depart tone to conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;PlayPromptToConference&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
            <parameter >g_strLanguage</parameter>
            <parameter >s_nPromptDepartTone</parameter>
          </function>
          <results >
            <result name="Default" link="4" stubbed="0"/>
          </results>
        </action>
        <action id="16" plug-in="Pactolus.Branch.1" ><?xtml-editor x=392 y=680 ?>
          <!--play tone or name?-->
          <results >
            <result name="Default" link="4" stubbed="1"/>
            <result name="play tone - 1" link="33" stubbed="0" >g_nArriveDepartOption == 1</result>
            <result name="play name - 3" link="21" stubbed="0" >g_nArriveDepartOption == 3</result>
          </results>
        </action>
        <action id="17" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1141 y=860 ?>
          <!--xxx has left conf-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="&quot;*&quot;" endpoint="g_oMS.strConferenceId" callid="g_oMS.strCallId" repeat="1" timeout="8" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="url" >g_strCallerRecordedName</audio>
            <audio type="index" >939</audio>
          </play>
          <results >
            <result name="Default" link="4" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="21" plug-in="Pactolus.Branch.1" ><?xtml-editor x=367 y=1203 ?>
          <!--null string-->
          <results >
            <result name="Default" link="37" stubbed="0"/>
            <result name="f_bNullString == true" link="36" stubbed="0" >f_bNullString == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("RECORDED NAME IS:  " + Session.g_strCallerRecordedName);

Server.logInfo("RECORDED NAME LENGTH IS:  " + Session.g_nRecordNameLength);

if (Session.g_nRecordNameLength <= 0)

{

	Session.f_bNullString = true;

}

else

{

	Session.f_bNullString = false;

}]]></script>
          </scripts>
        </action>
        <action id="24" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1048 y=148 ?>
          <!--in MOH?-->
          <results >
            <result name="Default" link="25" stubbed="1"/>
            <result name="g_bConnectedToMOH == true" link="25" stubbed="1" >g_bConnectToMOH == true

OR g_bWaitForModerator == true</result>
          </results>
        </action>
        <action id="25" plug-in="Pactolus.Branch.1" ><?xtml-editor x=117 y=684 ?>
          <!--anonymous caller?-->
          <results >
            <result name="Default" link="16" stubbed="0"/>
            <result name="g_bAnonymousCaller" link="4" stubbed="1" >g_bAnonymousCaller == true</result>
            <result name="!g_bNotifyMS" link="4" stubbed="1" >g_bNotifyMS == false</result>
          </results>
        </action>
        <action id="26" plug-in="Pactolus.Branch.1" ><?xtml-editor x=815 y=254 ?>
          <!--in sub conf?-->
          <results >
            <result name="Default" link="24" stubbed="0"/>
            <result name="g_bCurrentlyInSubConf" link="27" stubbed="0" >g_bCurrentlyInSubConf == true</result>
          </results>
        </action>
        <action id="27" plug-in="Standard.WaitEvent.1" ><?xtml-editor x=1055 y=355 ?>
          <!--ConfLeaveEventResponse-->
          <wait xmlns="urn:www.pactolus.com:xtml:communication" timeout="5" recv-name="g_strEventReceived" >
            <msg name="ConfLeaveEventResponse" >
              <parameter >f_strControllerIP</parameter>
              <parameter >f_nControllerPort</parameter>
              <parameter >f_strTransactionId</parameter>
              <parameter >f_strDeleteSubConf</parameter>
            </msg>
          </wait>
          <results >
            <result name="Default" link="30" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)

{

	Server.logError("NO RESPONSE FROM CC FOR CONF LEAVE EVENT FOR PARTY IN SUB CONFERENCE");

}]]></script>
          </scripts>
        </action>
        <action id="28" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1747 y=333 ?>
          <!--delete sub conf-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DeleteConference&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oSubConfMS</parameter>
          </function>
          <results >
            <result name="Default" link="24" stubbed="1"/>
          </results>
        </action>
        <action id="29" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1508 y=343 ?>
          <!--delete sub conf-->
          <results >
            <result name="Default" link="24" stubbed="1"/>
            <result name="f_strDeleteSubConf==&quot;T&quot;" link="28" stubbed="0" >f_strDeleteSubConf match "T"</result>
          </results>
        </action>
        <action id="30" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1285 y=349 ?>
          <!--Remove from sub conf-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;RemoveMemberFromConference&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oSubConfMS</parameter>
          </function>
          <results >
            <result name="Default" link="29" stubbed="0"/>
          </results>
        </action>
        <action id="31" plug-in="Pactolus.Branch.1" ><?xtml-editor x=88 y=265 ?>
          <!--already sent party leave?-->
          <results >
            <result name="Default" link="1" stubbed="0"/>
            <result name="g_bSentPartyLeave" link="26" stubbed="1" >g_bSentPartyLeave == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_disable_event();
if (Session.g_bSendLeaveWithTransfer)
	Session.strTransferedFlag = "T";
else
	Session.strTransferedFlag = "F";]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (false == Session.g_bSentPartyLeave)
{
	Session.g_bSentPartyLeave = true;
	Session.g_bSentPartyJoin = false;
}]]></script>
          </scripts>
        </action>
        <action id="32" plug-in="Pactolus.Branch.1" ><?xtml-editor x=846 y=1143 ?>
          <!--Is Global Music On?-->
          <results >
            <result name="Default" link="17" stubbed="0"/>
            <result name="globaMusicFlag==&quot;T&quot;" link="4" stubbed="0" >g_strGlobalMusicOnFlag match "T"</result>
          </results>
        </action>
        <action id="33" plug-in="Pactolus.Branch.1" ><?xtml-editor x=825 y=676 ?>
          <!--Is Global Music On?-->
          <results >
            <result name="Default" link="14" stubbed="0"/>
            <result name="globaMusicFlag==&quot;T&quot;" link="4" stubbed="0" >g_strGlobalMusicOnFlag match "T"</result>
          </results>
        </action>
        <action id="36" plug-in="Pactolus.JavaStaticMethod.1" ><?xtml-editor x=579 y=916 ?>
          <java xmlns="urn:www.pactolus.com:xtml:application" class="&quot;com.pactolus.conferencing.psAPISceGlobalMusicFlag&quot;" method="&quot;getGlobalMusicFlagByEventID&quot;" timeout="4" return="" method-return-var="nReturnCode" method-return-type="0" >
            <parameter type="in" var-type="string" >g_strDBNAME</parameter>
            <parameter type="in" var-type="string" >g_strDBSessionId</parameter>
            <parameter type="in" var-type="string" >g_strConfEventId</parameter>
            <parameter type="inout" var-type="string" >g_strGlobalMusicOnFlag</parameter>
          </java>
          <results >
            <result name="Default" link="31" stubbed="0"/>
            <result name="Success" link="33" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="37" plug-in="Pactolus.JavaStaticMethod.1" ><?xtml-editor x=630 y=1167 ?>
          <java xmlns="urn:www.pactolus.com:xtml:application" class="&quot;com.pactolus.conferencing.psAPISceGlobalMusicFlag&quot;" method="&quot;getGlobalMusicFlagByEventID&quot;" timeout="4" return="" method-return-var="nReturnCode" method-return-type="0" >
            <parameter type="in" var-type="string" >g_strDBNAME</parameter>
            <parameter type="in" var-type="string" >g_strDBSessionId</parameter>
            <parameter type="in" var-type="string" >g_strConfEventId</parameter>
            <parameter type="inout" var-type="string" >g_strGlobalMusicOnFlag</parameter>
          </java>
          <results >
            <result name="Default" link="4" stubbed="0"/>
            <result name="Success" link="32" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
      </actions>
    </function>
    <function name="IVRConfAddParty" start="190" event="IVRConfAddParty" returns="void" >
      <local-vars >
        <var name="f_strDestNumber" type="string" ></var>
        <var name="f_strDTMF" type="string" ></var>
        <var name="f_strRequestNotify" type="string" ></var>
        <var name="f_nReturnCode" type="i4" >-1</var>
        <var name="f_nCurrentState" type="i4" >1</var>
        <var name="f_strReturnMsg" type="string" ></var>
        <var name="f_nPromptToPlay" type="i4" >0</var>
        <var name="f_oDigit" type="object" ></var>
        <var name="f_bValidDest" type="boolean" >0</var>
        <var name="f_strSignal" type="string" ></var>
        <var name="f_nTIMEOUT" type="i4" >0</var>
        <var name="f_strRequestId" type="string" ></var>
        <var name="f_bMisDial" type="boolean" >0</var>
        <var name="f_strTerminationDigit" type="string" ></var>
        <var name="f_strDigitsEntered" type="string" ></var>
        <var name="f_bIntlDestination" type="boolean" >0</var>
      </local-vars>
      <actions >
        <action id="190" plug-in="Pactolus.Branch.1" ><?xtml-editor x=40 y=308 ?>
          <results >
            <result name="Default" link="3" stubbed="0"/>
            <result name="strLoadTestMode==&quot;T&quot;" link="191" stubbed="0" >s_strLoadTestMode match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: IVRConfAddParty");]]></script>
          </scripts>
        </action>
        <action id="3" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=269 y=221 ?>
          <!--Collect destination-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oTempConf.strConnectionId" endpoint="g_oTempConf.strEndPoint" callid="g_oTempConf.strCallId" repeat="1" timeout="70" ms-type="g_oTempConf.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="s_strOutdialDigitMap" language="g_strLanguage" digits="f_strDestNumber" retry-count="3" clear-digits="0" terminating-digit="f_strTerminationDigit" quick-collect="0" digit-timer="" >
            <audio type="index" >882</audio>
            <audio type="index" >362</audio>
            <audio type="index" >320</audio>
            <audio type="index" >884</audio>
            <timeout-prompt type="index" >s_nPromptNoResponse</timeout-prompt>
          </play>
          <results >
            <result name="Default" link="175" stubbed="1"/>
            <result name="Success" link="54" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_nCurrentState = 1;
Session.f_strDestNumber = "";
Session.f_strTerminationDigit = "";
Session.f_bIntlDestination = false;
Session.f_bMisDial = false;
Session.f_bValidDest = false;]]></script>
          </scripts>
        </action>
        <action id="6" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1370 y=456 ?>
          <!--send IVRConfAddParty-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="" transaction="" message-name="s_strIvrConfAddPartyRequest" destination-port="" destination-type="1" destination-session="" waiting-session-selected="g_strAddPartySessionId" xml-namespace="" >
            <parameter tag="&quot;calling_number&quot;" value="g_strOrigNbr"/>
            <parameter tag="&quot;called_number&quot;" value="g_strOutdialDestNbr"/>
            <parameter tag="&quot;ms_endpoint&quot;" value="g_oTempConf.strConferenceId"/>
            <parameter tag="&quot;session_id&quot;" value="g_strSessionId"/>
            <parameter tag="&quot;service_provider_id&quot;" value="g_lServiceProviderId"/>
            <parameter tag="&quot;conf_pass_code&quot;" value="g_strConfPassCode"/>
            <parameter tag="&quot;dialing_plan_id&quot;" value="g_nDialPlanId"/>
            <parameter tag="&quot;access_number&quot;" value="g_strAccessNumber"/>
            <parameter tag="&quot;destCountryId&quot;" value="g_nDestCountryId"/>
            <parameter tag="&quot;destDomIntlFlag&quot;" value="g_strDestDomIntlFlag"/>
            <parameter tag="&quot;destAreaCode&quot;" value="g_strDestAreaCode"/>
            <parameter tag="&quot;destCallingCountryCode&quot;" value="g_strDestCallingCountryCode"/>
          </SOAP>
          <results >
            <result name="Default" link="57" stubbed="0"/>
            <result name="Success" link="148" stubbed="0"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: SEND calling number is: " + Session.g_strOrigNbr);

Server.logInfo("INFO: SEND called number is: " + Session.g_strOutdialDestNbr);

Server.logInfo("INFO: SEND MS end point is: " + Session.g_oTempConf.strConferenceId);

Server.logInfo("INFO: SEND FROM session Id is: " + Session.g_strSessionId);

Server.logInfo("INFO: SEND service provider Id is: " + Session.g_lServiceProviderId);

Server.logInfo("INFO: SEND conference passcode is: " + Session.g_strConfPassCode);

Server.logInfo("INFO: SEND access number is: " + Session.g_strAccessNumber);

Session.g_bAddingParty = true;

js_disable_event();]]></script>
            <script language="javascript" timing="last" ><![CDATA[Server.logInfo("INFO: SENT IVRCONFADDPARTY TO session Id is: " + Session.g_strAddPartySessionId);]]></script>
          </scripts>
        </action>
        <action id="8" plug-in="Pactolus.MGCPNotifyRequest.1" ><?xtml-editor x=77 y=855 ?>
          <!--set DTMF-->
          <rqnt xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oTempConf.strConnectionId" endpoint="g_oTempConf.strEndPoint" callid="g_oTempConf.strCallId" timeout="s_nTimeout" returns="" ms-type="g_oTempConf.strType" >
            <parameters >
              <quarantine step="1" loop="0" process="0" discard="1"/>
              <events ><![CDATA[f_strRequestNotify]]></events>
              <signals ><![CDATA[]]></signals>
              <digit-map ><![CDATA["(*1|*2|xxxxx|x.T|x.#)"]]></digit-map>
            </parameters>
          </rqnt>
          <results >
            <result name="Default" link="60" stubbed="0"/>
            <result name="Success" link="9" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("RQNT MS call id = " + Session.g_oTempConf.strCallId);

Server.logInfo("RQNT MS connection id = " + Session.g_oTempConf.strConnectionId);

Server.logInfo("RQNT MS end point = " + Session.g_oTempConf.strEndPoint);

Server.logInfo("**** MODERATOR, TURN ON DTMF DETECTION ****");

Session.f_strRequestNotify = "D/[0-9#*T]@" + Session.g_oTempConf.strConnectionId + "(D)";

js_disable_event();]]></script>
          </scripts>
        </action>
        <action id="9" plug-in="Standard.WaitEvent.1" ><?xtml-editor x=291 y=1049 ?>
          <!--wait for DTMF-->
          <wait xmlns="urn:www.pactolus.com:xtml:communication" timeout="30" recv-name="g_strEventReceived" >
            <msg name="Pactolus.MGCPDtmf.1" >
              <parameter >g_oTempConf.strEndPoint</parameter>
              <parameter >f_strRequestId</parameter>
              <parameter >f_strDTMF</parameter>
            </msg>
            <msg name="IVRConfPartyDeclineResponse"/>
          </wait>
          <results >
            <result name="Default" link="60" stubbed="1"/>
            <result name="Success" link="99" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout" link="192" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_strDTMF = "";]]></script>
            <script language="javascript" timing="last" ><![CDATA[js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="31" plug-in="Standard.WaitEvent.1" ><?xtml-editor x=1793 y=589 ?>
          <!--wait for response-->
          <wait xmlns="urn:www.pactolus.com:xtml:communication" timeout="f_nTIMEOUT" recv-name="g_strEventReceived" >
            <msg name="IVRConfAddPartyResponse" >
              <parameter >f_nReturnCode</parameter>
              <parameter >f_strReturnMsg</parameter>
            </msg>
            <msg name="Pactolus.MGCPDtmf.1" >
              <parameter >g_oTempConf.strEndPoint</parameter>
              <parameter >f_strRequestId</parameter>
              <parameter >f_strDTMF</parameter>
            </msg>
          </wait>
          <results >
            <result name="Default" link="167" stubbed="1"/>
            <result name="Success" link="149" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_strDTMF = "";

Session.f_nTIMEOUT = Session.s_nRingNoAnswerTime + 2;]]></script>
            <script language="javascript" timing="last" ><![CDATA[js_enable_event();

if (Result.id == 2)

{

	Server.logInfo("INFO: SUCCESS WAIT FOR RESPONSE.");

}

else

{

	Server.logError("ERROR: FAIL TO WAIT FOR RESPONSE, EXIT ON: " + Result.name);

}]]></script>
          </scripts>
        </action>
        <action id="33" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2282 y=526 ?>
          <!--add success?-->
          <results >
            <result name="Default" link="142" stubbed="0"/>
            <result name="success" link="8" stubbed="1" >f_nReturnCode == 0</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: GOT RESPONSE WITH RETURN CODE: ") + Session.f_nReturnCode;

Server.logInfo("INFO: GOT RESPONSE WITH RETURN MSG: ") + Session.f_strReturnMsg;]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (1 == Result.id)

{

	if (-2 == Session.f_nReturnCode)

	{

		Session.f_nPromptToPlay = 880; //max

	}

	else if (-3 == Session.f_nReturnCode)

	{

		Session.f_nPromptToPlay = 888; //sorry locked

	}

	else if (-5 == Session.f_nReturnCode)

	{

		Session.f_nPromptToPlay = 551; //no answer

	}

	else if (-6 == Session.f_nReturnCode)

	{

		Session.f_nPromptToPlay = 562; //sorry busy

	}

	else

	{

		Session.f_nPromptToPlay = 561; //sorry can't connect

	}

}]]></script>
          </scripts>
        </action>
        <action id="34" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=588 y=1377 ?>
          <!--add or drop?-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oTempConf.strConnectionId" endpoint="g_oTempConf.strEndPoint" callid="g_oTempConf.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oTempConf.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;(*1|*2)&quot;" language="g_strLanguage" digits="f_strDTMF" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >350</audio>
            <audio type="index" >910</audio>
            <audio type="index" >351</audio>
            <audio type="index" >911</audio>
          </play>
          <results >
            <result name="Default" link="61" stubbed="1"/>
            <result name="Success" link="35" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="35" plug-in="Pactolus.Branch.1" ><?xtml-editor x=849 y=1375 ?>
          <!--add or drop?-->
          <results >
            <result name="Default" link="48" stubbed="1"/>
            <result name="*1 bridge conf" link="37" stubbed="1" >f_nCurrentState == 1

AND f_strDTMF match "^\*1$"</result>
            <result name="*2 disconnect party" link="48" stubbed="0" >f_nCurrentState == 1

AND f_strDTMF match "^\*2$"</result>
          </results>
        </action>
        <action id="36" plug-in="Pactolus.Branch.1" ><?xtml-editor x=820 y=981 ?>
          <!--add or drop?-->
          <results >
            <result name="Default" link="179" stubbed="0"/>
            <result name="1 bridge conf" link="37" stubbed="0" >f_nCurrentState == 1

AND f_strDTMF match "^\*1$"</result>
            <result name="2 disconnect party" link="48" stubbed="1" >f_nCurrentState == 1

AND f_strDTMF match "^\*2$"</result>
          </results>
        </action>
        <action id="37" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1102 y=1083 ?>
          <!--send IVRConfBridgeAddParty-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="" transaction="" message-name="s_strIvrConfBridgePartyRequest" destination-port="" destination-type="3" destination-session="g_strAddPartySessionId" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;ms_endpoint&quot;" value="g_oMS.strConferenceId"/>
          </SOAP>
          <results >
            <result name="Default" link="168" stubbed="0"/>
            <result name="Success" link="169" stubbed="0"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("SEND MS end point is: " + Session.g_oMS.strConferenceId);]]></script>
            <script language="javascript" timing="last" ><![CDATA[Server.logInfo("SEND TO session Id is: " + Session.g_strAddPartySessionId);

Session.f_nCurrentState = 2;

Session.g_bAddingParty = false;]]></script>
          </scripts>
        </action>
        <action id="45" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=273 y=1758 ?>
          <!--add new or return-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oTempConf.strConnectionId" endpoint="g_oTempConf.strEndPoint" callid="g_oTempConf.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oTempConf.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;(x)&quot;" language="g_strLanguage" digits="f_strDTMF" retry-count="3" clear-digits="0" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >311</audio>
            <audio type="index" >886</audio>
            <audio type="index" >320</audio>
            <audio type="index" >884</audio>
            <timeout-prompt type="index" >s_nPromptNoResponse</timeout-prompt>
          </play>
          <results >
            <result name="Default" link="175" stubbed="1"/>
            <result name="Success" link="47" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="47" plug-in="Pactolus.Branch.1" ><?xtml-editor x=533 y=2038 ?>
          <!--add new or return?-->
          <results >
            <result name="Default" link="194" stubbed="1"/>
            <result name="* return to conf" link="175" stubbed="1" >f_nCurrentState != 1

AND f_strDTMF match "\*"</result>
            <result name="1 add another party" link="190" stubbed="1" >f_nCurrentState != 1

AND f_strDTMF match "1"</result>
          </results>
        </action>
        <action id="48" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1132 y=1370 ?>
          <!--send IVRConfRemoveAddParty-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="" transaction="" message-name="s_strIvrConfRemovePartyRequest" destination-port="" destination-type="3" destination-session="g_strAddPartySessionId" waiting-session-selected="" xml-namespace=""/>
          <results >
            <result name="Default" link="86" stubbed="0"/>
            <result name="Success" link="170" stubbed="0"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("SEND TO session Id is: " + Session.g_strAddPartySessionId);

Session.f_nCurrentState = 3;

Session.g_bAddingParty = false;]]></script>
          </scripts>
        </action>
        <action id="54" plug-in="Pactolus.Branch.1" ><?xtml-editor x=539 y=222 ?>
          <!--return to conf-->
          <results >
            <result name="Default" link="165" stubbed="0"/>
            <result name="*-return to conf" link="175" stubbed="1" >g_bReturnToConf == true</result>
            <result name="mis dial == true;" link="190" stubbed="1" >f_bMisDial == true</result>
            <result name="valid dest" link="188" stubbed="1" >f_bValidDest == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bReturnToConf = false;

Session.f_bMisDial = false;

Session.f_bValidDest = false;

if (Session.f_strDestNumber.length > 0 && Session.f_strTerminationDigit == "*")

{

	Session.f_bMisDial = true;

}

else if (Session.f_strDestNumber.length == 0 && Session.f_strTerminationDigit == "*")

{

	Session.g_bReturnToConf = true;

}

/*

if ("1" == Session.s_strOutdialDialingPlan)

{

	if (Session.f_strDestNumber.length < 10)

		Session.f_bValidDest = false;

	else

		Session.f_bValidDest = true;

}

*/

else if (Session.f_strDestNumber.length == 0 && Session.f_strTerminationDigit == "#")
{
	Session.f_bValidDest = false;
}

else

{

	Session.f_bValidDest = true;

}]]></script>
          </scripts>
        </action>
        <action id="57" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1609 y=407 ?>
          <!--fail to reach party-->
          <results >
            <result name="Default" link="167" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logError("ERROR: FAIL TO SEND SOAP MESSAGE TO ADD PARTY.");

js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="60" plug-in="Pactolus.Branch.1" ><?xtml-editor x=279 y=650 ?>
          <!--put back in conference-->
          <results >
            <result name="Default" link="61" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logError("ERROR: FAIL TO WAIT FOR DTMF.");

js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="61" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=515 y=648 ?>
          <!--send IVRConfRemoveAddParty-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="" transaction="" message-name="s_strIvrConfRemovePartyRequest" destination-port="" destination-type="3" destination-session="g_strAddPartySessionId" waiting-session-selected="" xml-namespace=""/>
          <results >
            <result name="Default" link="175" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("SEND TO session Id is: " + Session.g_strAddPartySessionId);]]></script>
            <script language="javascript" timing="last" ><![CDATA[Session.g_bAddingParty = false;]]></script>
          </scripts>
        </action>
        <action id="82" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=841 y=393 ?>
          <!--psAPISceConfAuthDest-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceConfAuthDest&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="96" stubbed="0"/>
            <result name="SUCCESS" link="171" stubbed="0" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strTranslatedDestNbr = Session.f_strDestNumber;]]></script>
          </scripts>
        </action>
        <action id="86" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1379 y=1366 ?>
          <!--put back in conference-->
          <results >
            <result name="Default" link="175" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logError("ERROR: FAIL TO CONF REMOVE PARTY.");]]></script>
          </scripts>
        </action>
        <action id="96" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1075 y=267 ?>
          <!--I am sorry-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oTempConf.strConnectionId" endpoint="g_oTempConf.strEndPoint" callid="g_oTempConf.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oTempConf.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >301</audio>
          </play>
          <results >
            <result name="Default" link="166" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="99" plug-in="Pactolus.Branch.1" ><?xtml-editor x=555 y=858 ?>
          <!--DTMF-->
          <results >
            <result name="Default" link="140" stubbed="0"/>
            <result name="DTMF" link="36" stubbed="0" >g_strEventReceived match "Dtmf"</result>
          </results>
        </action>
        <action id="103" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1214 y=1688 ?>
          <!--HangUp Caller-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpCaller&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="139" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nConfLeaveReason = 4;
Session.g_strConfLeaveMsg = "FAIL TO SEND SIP INVITE PARTY TO HOLD";]]></script>
          </scripts>
        </action>
        <action id="128" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=758 y=1826 ?>
          <!--Remove member from temp conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;RemoveMemberFromConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
          </function>
          <results >
            <result name="Default" link="132" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: ADD PARTY, RETURN TO CONF, REMOVE FROM TEMP CONF.");]]></script>
          </scripts>
        </action>
        <action id="131" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1459 y=1822 ?>
          <!--AddMemberToOldConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
            <parameter >g_oCallLegA</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="187" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: ADD PARTY, ADD MEMBER BACK TO OLD CONF.");]]></script>
          </scripts>
        </action>
        <action id="132" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=981 y=1825 ?>
          <!--delete temp conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DeleteConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
          </function>
          <results >
            <result name="Default" link="177" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: ADD PARTY, RETURN TO CONF, DELETE TEMP CONF.");]]></script>
            <script language="javascript" timing="last" ><![CDATA[Session.g_bCreatedTempConf = false;]]></script>
          </scripts>
        </action>
        <action id="135" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=2370 y=1783 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="136" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1694 y=1819 ?>
          <!--success?-->
          <results >
            <result name="Default" link="180" stubbed="0"/>
            <result name="FAILURE" link="103" stubbed="1" >f_nReturnCode == s_nFailure</result>
            <result name="CALLERHUNGUP" >f_nReturnCode == s_nCallerHungup</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Result.id == 2)

{

	Session.g_nTerminationReason = 35;

}

else if (Result.id == 3)

{

	Session.g_nTerminationReason = 1;

}]]></script>
          </scripts>
        </action>
        <action id="137" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=742 y=1689 ?>
          <!--Remove member from temp conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;RemoveMemberFromConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
          </function>
          <results >
            <result name="Default" link="138" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 35;]]></script>
          </scripts>
        </action>
        <action id="138" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=974 y=1689 ?>
          <!--delete temp conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DeleteConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
          </function>
          <results >
            <result name="Default" link="103" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: ADD PARTY, RETURN TO CONF, DELETE TEMP CONF.");]]></script>
            <script language="javascript" timing="last" ><![CDATA[Session.g_bCreatedTempConf = false;]]></script>
          </scripts>
        </action>
        <action id="139" plug-in="Standard.EndSession.1" ><?xtml-editor x=1439 y=1689 ?></action>
        <action id="140" plug-in="Pactolus.Branch.1" ><?xtml-editor x=798 y=787 ?>
          <!--party declined already

current state is 3-->
          <results >
            <result name="Default" link="194" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_nCurrentState = 3;]]></script>
          </scripts>
        </action>
        <action id="142" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2519 y=521 ?>
          <!--play error prompt-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oTempConf.strConnectionId" endpoint="g_oTempConf.strEndPoint" callid="g_oTempConf.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oTempConf.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >f_nPromptToPlay</audio>
          </play>
          <results >
            <result name="Default" link="175" stubbed="1"/>
            <result name="Success" link="190" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="143" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1352 y=883 ?>
          <!--play DTMF-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="&quot;*&quot;" endpoint="g_oTempConf.strEndPoint" callid="g_oTempConf.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oTempConf.strType" returns="" start-play="1" interrupt="1" return-immediate="1" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >f_oDigit[0]</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >f_oDigit[1]</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >f_oDigit[2]</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >f_oDigit[3]</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >f_oDigit[4]</audio>
          </play>
          <results >
            <result name="Default" link="8" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[var i = 0;



//initialize to silence

for (i = 0; i < 5; i++)

{

	Session.f_oDigit[i] = 99;

}

// parse through the digit

for (i = 0; i < Session.f_strDTMF.length; i++)

{

	switch (Session.f_strDTMF.charAt(i))

	{

		case "0":

			Session.f_oDigit[i] = 200;

			break;

		case "1":

			Session.f_oDigit[i] = 201;

			break;

		case "2":

			Session.f_oDigit[i] = 202;

			break;

		case "3":

			Session.f_oDigit[i] = 203;

			break;

		case "4":

			Session.f_oDigit[i] = 204;

			break;

		case "5":

			Session.f_oDigit[i] = 205;

			break;

		case "6":

			Session.f_oDigit[i] = 206;

			break;

		case "7":

			Session.f_oDigit[i] = 207;

			break;

		case "8":

			Session.f_oDigit[i] = 208;

			break;

		case "9":

			Session.f_oDigit[i] = 209;

			break;

		default:

			Session.f_oDigit[i] = 99;

			break;

	}

}]]></script>
          </scripts>
        </action>
        <action id="147" plug-in="Pactolus.MGCPNotifyRequest.1" ><?xtml-editor x=1587 y=902 ?>
          <!--Play DTMF-->
          <rqnt xmlns="urn:www.pactolus.com:xtml:media" connection-id="&quot;*&quot;" endpoint="g_oTempConf.strEndPoint" callid="g_oTempConf.strCallId" timeout="s_nTimeout" returns="" ms-type="g_oTempConf.strType" >
            <parameters >
              <quarantine step="1" loop="0" process="0" discard="1"/>
              <events ><![CDATA[A/oc]]></events>
              <signals ><![CDATA[f_strSignal]]></signals>
              <digit-map ><![CDATA[]]></digit-map>
            </parameters>
          </rqnt>
          <results >
            <result name="Default" link="192" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_strSignal = "A/pd@*(dg='"+Session.f_strDTMF+"#' dl=250 di=500 da=10)";

//Session.f_strSignal = "A/pd@"+Session.g_oTempConf.strConnectionId+"(dg='"+Session.f_strDTMF+"#' dl=250 di=500 da=10)";]]></script>
          </scripts>
        </action>
        <action id="148" plug-in="Pactolus.MGCPNotifyRequest.1" ><?xtml-editor x=1576 y=587 ?>
          <!--set DTMF-->
          <rqnt xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oTempConf.strConnectionId" endpoint="g_oTempConf.strEndPoint" callid="g_oTempConf.strCallId" timeout="s_nTimeout" returns="" ms-type="g_oTempConf.strType" >
            <parameters >
              <quarantine step="1" loop="0" process="0" discard="1"/>
              <events ><![CDATA[f_strRequestNotify]]></events>
              <signals ><![CDATA[]]></signals>
              <digit-map ><![CDATA["(*2)"]]></digit-map>
            </parameters>
          </rqnt>
          <results >
            <result name="Default" link="31" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("RQNT MS call id = " + Session.g_oTempConf.strCallId);

Server.logInfo("RQNT MS connection id = " + Session.g_oTempConf.strConnectionId);

Server.logInfo("RQNT MS end point = " + Session.g_oTempConf.strEndPoint);

Server.logInfo("**** MODERATOR, TURN ON DTMF DETECTION ****");

Session.f_strRequestNotify = "D/[*2]@" + Session.g_oTempConf.strConnectionId + "(D)";]]></script>
          </scripts>
        </action>
        <action id="149" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2042 y=590 ?>
          <!--DTMF-->
          <results >
            <result name="Default" link="33" stubbed="0"/>
            <result name="DTMF" link="172" stubbed="0" >g_strEventReceived match "Dtmf"</result>
          </results>
        </action>
        <action id="150" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=2526 y=735 ?>
          <!--send IVRConfRemoveAddParty-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="" transaction="" message-name="s_strIvrConfRemovePartyRequest" destination-port="" destination-type="3" destination-session="g_strAddPartySessionId" waiting-session-selected="" xml-namespace=""/>
          <results >
            <result name="Default" link="151" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("SEND TO session Id is: " + Session.g_strAddPartySessionId);

Session.f_nCurrentState = 3;

Session.g_bAddingParty = false;]]></script>
          </scripts>
        </action>
        <action id="151" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2754 y=729 ?>
          <!--dropped participant-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oTempConf.strConnectionId" endpoint="g_oTempConf.strEndPoint" callid="g_oTempConf.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oTempConf.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >915</audio>
          </play>
          <results >
            <result name="Default" link="194" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="165" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=789 y=216 ?>
          <!--invalid dest-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oTempConf.strConnectionId" endpoint="g_oTempConf.strEndPoint" callid="g_oTempConf.strCallId" repeat="1" timeout="10" ms-type="g_oTempConf.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >514</audio>
          </play>
          <results >
            <result name="Default" link="190" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="166" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1318 y=263 ?>
          <!--play a prompt-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oTempConf.strConnectionId" endpoint="g_oTempConf.strEndPoint" callid="g_oTempConf.strCallId" repeat="1" timeout="10" ms-type="g_oTempConf.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >f_nPromptToPlay</audio>
          </play>
          <results >
            <result name="Default" link="190" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
            <result name="MAX ATTENDEES -3 " link="175" stubbed="1" >f_nReturnCode == -3</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[switch (Session.f_nReturnCode)

{

	case -1:

		Server.logInfo("INFO: RESTRICTED DEST");

		Session.f_nPromptToPlay = Session.s_nPromptRestrictedDest;

		break;

	case -2:

		Server.logInfo("INFO: INSUFFICIENT DIGIT DEST");

		Session.f_nPromptToPlay = Session.s_nPromptInvalidDest;

		break;

	case -3:

		Server.logInfo("INFO: MAX ATTENDEES");

		Session.f_nPromptToPlay = Session.s_nPromptMaxAttendeesReach;

		break;

	case -99:

		Server.logError("ERROR: DB ERROR PASSCODE:" + Session.g_strPassCode);

		Session.f_nPromptToPlay = Session.s_nPromptDBError;

		break;

	default:

		Session.f_nPromptToPlay = Session.s_nPromptUnableCompleteCall;

		break;

}]]></script>
          </scripts>
        </action>
        <action id="167" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1835 y=404 ?>
          <!--can't reach party-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oTempConf.strConnectionId" endpoint="g_oTempConf.strEndPoint" callid="g_oTempConf.strCallId" repeat="1" timeout="10" ms-type="g_oTempConf.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >561</audio>
          </play>
          <results >
            <result name="Default" link="190" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="168" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1371 y=1050 ?>
          <!--couldn't add party-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oTempConf.strConnectionId" endpoint="g_oTempConf.strEndPoint" callid="g_oTempConf.strCallId" repeat="1" timeout="10" ms-type="g_oTempConf.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >913</audio>
          </play>
          <results >
            <result name="Default" link="175" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="169" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1385 y=1197 ?>
          <!--party added-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oTempConf.strConnectionId" endpoint="g_oTempConf.strEndPoint" callid="g_oTempConf.strCallId" repeat="1" timeout="10" ms-type="g_oTempConf.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >912</audio>
          </play>
          <results >
            <result name="Default" link="194" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="170" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1390 y=1478 ?>
          <!--party dropped-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oTempConf.strConnectionId" endpoint="g_oTempConf.strEndPoint" callid="g_oTempConf.strCallId" repeat="1" timeout="10" ms-type="g_oTempConf.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >915</audio>
          </play>
          <results >
            <result name="Default" link="194" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="171" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1108 y=452 ?>
          <!--Play instructions-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oTempConf.strConnectionId" endpoint="g_oTempConf.strEndPoint" callid="g_oTempConf.strCallId" repeat="1" timeout="8" ms-type="g_oTempConf.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;(*2)&quot;" language="g_strLanguage" digits="f_strDigitsEntered" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >909</audio>
            <audio type="index" >350</audio>
            <audio type="index" >910</audio>
            <audio type="index" >351</audio>
            <audio type="index" >911</audio>
          </play>
          <results >
            <result name="Default" link="6" stubbed="0"/>
            <result name="Success" link="173" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_nCurrentState = 1;]]></script>
          </scripts>
        </action>
        <action id="172" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2297 y=742 ?>
          <!--cancel?-->
          <results >
            <result name="Default" link="31" stubbed="1"/>
            <result name="*2 to cancel?" link="150" stubbed="0" >f_strDTMF match "^\*2$"</result>
          </results>
        </action>
        <action id="173" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1376 y=623 ?>
          <!--*2-->
          <results >
            <result name="Default" link="6" stubbed="0"/>
            <result name="*2" link="174" stubbed="0" >f_strDigitsEntered match "^\*2$"</result>
          </results>
        </action>
        <action id="174" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1583 y=753 ?>
          <!--dropped participant-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oTempConf.strConnectionId" endpoint="g_oTempConf.strEndPoint" callid="g_oTempConf.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oTempConf.strType" returns="" start-play="1" interrupt="0" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >915</audio>
          </play>
          <results >
            <result name="Default" link="190" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="175" plug-in="Pactolus.Branch.1" ><?xtml-editor x=527 y=1753 ?>
          <!--Dial In?-->
          <results >
            <result name="Default" link="128" stubbed="1"/>
            <result name="g_strOutdialFlag = &quot;T&quot;;" link="128" stubbed="1" >g_strOutdialFlag match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_disable_event();]]></script>
          </scripts>
        </action>
        <action id="177" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1220 y=1817 ?>
          <!--Dial In?-->
          <results >
            <result name="Default" link="131" stubbed="0"/>
            <result name="g_strOutdialFlag = &quot;T&quot;;" link="178" stubbed="0" >g_strOutdialFlag match "T"</result>
          </results>
        </action>
        <action id="178" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1460 y=1940 ?>
          <!--AddMemberToOldConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
            <parameter >g_oCallLegB</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="187" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: ADD PARTY, ADD MEMBER BACK TO OLD CONF.");]]></script>
          </scripts>
        </action>
        <action id="179" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1076 y=892 ?>
          <!--CONV?-->
          <results >
            <result name="Default" link="8" stubbed="1"/>
            <result name="g_oTempConf.strType == CONV" link="143" stubbed="0" >g_oTempConf.strType == "CONV"</result>
          </results>
        </action>
        <action id="180" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1904 y=1817 ?>
          <!--"StopTimer"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;StopTimer&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="186" stubbed="0"/>
          </results>
        </action>
        <action id="181" plug-in="Standard.Timer.1" ><?xtml-editor x=2858 y=1875 ?>
          <!--ck reInvite timer-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lCkReInviteTimerIdA" duration="g_nCkReInviteTime"/>
          <results >
            <result name="Default" link="135" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bCkReInviteTimerFlagA = true;
Server.logInfo("SET TIMER TO CHECK FOR REINVITE A LEG");]]></script>
          </scripts>
        </action>
        <action id="182" plug-in="Standard.Timer.1" ><?xtml-editor x=2876 y=1991 ?>
          <!--ck reInvite timer B-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lCkReInviteTimerIdB" duration="g_nCkReInviteTime"/>
          <results >
            <result name="Default" link="135" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bCkReInviteTimerFlagB = true;
Server.logInfo("SET TIMER TO CHECK FOR REINVITE B LEG");]]></script>
          </scripts>
        </action>
        <action id="183" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2387 y=1908 ?>
          <!--Dial In?-->
          <results >
            <result name="Default" link="184" stubbed="0"/>
            <result name="g_strOutdialFlag = &quot;T&quot;" link="185" stubbed="0" >g_strOutdialFlag match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("IVRCONFADDPARTY, RESET TIMER TO CHECK FOR REINVITE");]]></script>
          </scripts>
        </action>
        <action id="184" plug-in="Standard.Timer.1" ><?xtml-editor x=2629 y=1875 ?>
          <!--stop ck reInvite timer-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="0" id="g_lCkReInviteTimerIdA" duration=""/>
          <results >
            <result name="Default" link="181" stubbed="0"/>
          </results>
        </action>
        <action id="185" plug-in="Standard.Timer.1" ><?xtml-editor x=2643 y=1992 ?>
          <!--stop ck reInvite timer B-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="0" id="g_lCkReInviteTimerIdB" duration=""/>
          <results >
            <result name="Default" link="182" stubbed="0"/>
          </results>
        </action>
        <action id="186" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2147 y=1820 ?>
          <results >
            <result name="Default" link="135" stubbed="0"/>
            <result name="Time &gt; 0" link="183" stubbed="0" >g_nCkReInviteTime &gt; 0</result>
          </results>
        </action>
        <action id="187" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1695 y=1938 ?>
          <!--ConfMSConnectionIDChangedNotify-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ConfMSConnectionIDChangedNotify&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="136" stubbed="1"/>
          </results>
        </action>
        <action id="188" plug-in="Pactolus.Branch.1" ><?xtml-editor x=275 y=528 ?>
          <results >
            <result name="Default" link="82" stubbed="1"/>
            <result name="outdial option==2 &amp;&amp; intl dest" link="189" stubbed="0" >g_nOutdialOption == 2
AND f_bIntlDestination == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[var myDest = new String(Session.f_strDestNumber);
if ( "1" == Session.s_strOutdialDialingPlan  && '0' == myDest.charAt(0) && '1' == myDest.charAt(1) && '1' == myDest.charAt(2) )
{
	Session.f_bIntlDestination = true;
}
else
{
	Session.f_bIntlDestination = false;
}]]></script>
          </scripts>
        </action>
        <action id="189" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=521 y=523 ?>
          <!--restricted dest-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oTempConf.strConnectionId" endpoint="g_oTempConf.strEndPoint" callid="g_oTempConf.strCallId" repeat="1" timeout="10" ms-type="g_oTempConf.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >513</audio>
          </play>
          <results >
            <result name="Default" link="190" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="191" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=286 y=379 ?>
          <!--Collect destination+0-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oTempConf.strConnectionId" endpoint="g_oTempConf.strEndPoint" callid="g_oTempConf.strCallId" repeat="1" timeout="70" ms-type="g_oTempConf.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="s_strOutdialDigitMap" language="g_strLanguage" digits="f_strDestNumber" retry-count="3" clear-digits="0" terminating-digit="f_strTerminationDigit" quick-collect="0" digit-timer="" >
            <audio type="index" >882</audio>
            <audio type="index" >362</audio>
            <audio type="index" >320</audio>
            <audio type="index" >884</audio>
            <audio type="silence" >.5</audio>
            <audio type="index" >200</audio>
            <audio type="silence" >.2</audio>
            <timeout-prompt type="index" >s_nPromptNoResponse</timeout-prompt>
          </play>
          <results >
            <result name="Default" link="175" stubbed="1"/>
            <result name="Success" link="54" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_nCurrentState = 1;
Session.f_strDestNumber = "";
Session.f_strTerminationDigit = "";
Session.f_bIntlDestination = false;
Session.f_bMisDial = false;
Session.f_bValidDest = false;]]></script>
          </scripts>
        </action>
        <action id="192" plug-in="Pactolus.Branch.1" ><?xtml-editor x=292 y=1428 ?>
          <results >
            <result name="Default" link="34" stubbed="0"/>
            <result name="strLoadTestMode==&quot;T&quot;" link="193" stubbed="0" >s_strLoadTestMode match "T"</result>
          </results>
        </action>
        <action id="193" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=606 y=1542 ?>
          <!--add or drop+1?-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oTempConf.strConnectionId" endpoint="g_oTempConf.strEndPoint" callid="g_oTempConf.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oTempConf.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;(*1|*2)&quot;" language="g_strLanguage" digits="f_strDTMF" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >350</audio>
            <audio type="index" >910</audio>
            <audio type="index" >351</audio>
            <audio type="index" >911</audio>
            <audio type="silence" >2</audio>
            <audio type="index" >201</audio>
            <audio type="silence" >1</audio>
          </play>
          <results >
            <result name="Default" link="61" stubbed="1"/>
            <result name="Success" link="35" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="194" plug-in="Pactolus.Branch.1" ><?xtml-editor x=57 y=1861 ?>
          <results >
            <result name="Default" link="45" stubbed="0"/>
            <result name="strLoadTestMode==&quot;T&quot;" link="195" stubbed="0" >s_strLoadTestMode match "T"</result>
          </results>
        </action>
        <action id="195" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=289 y=1963 ?>
          <!--add new or return+2-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oTempConf.strConnectionId" endpoint="g_oTempConf.strEndPoint" callid="g_oTempConf.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oTempConf.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;(x)&quot;" language="g_strLanguage" digits="f_strDTMF" retry-count="3" clear-digits="0" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >311</audio>
            <audio type="index" >886</audio>
            <audio type="index" >320</audio>
            <audio type="index" >884</audio>
            <audio type="silence" >2</audio>
            <audio type="index" >202</audio>
            <audio type="silence" >1</audio>
            <timeout-prompt type="index" >s_nPromptNoResponse</timeout-prompt>
          </play>
          <results >
            <result name="Default" link="175" stubbed="1"/>
            <result name="Success" link="47" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
      </actions>
      <text-objects >
        <text-object x-coord="327" y-coord="27" width="173" height="150" text="f_nCurrentState

1    collect and outdial party

2    bridge party to conference

3    drop the outdial party

4    return to the conference

at 1 can go to 2 or 3



at 2 can go to 1 or 4

at 3 can go to 1 or 4

at 4 finish



Press 1

" font-name="Times New Roman" size="14" red="0" green="0" blue="0" weight="0" underline="0" strikeout="0" point-size="10" italic="0"/>
        <text-object x-coord="38" y-coord="21" width="148" height="84" text="enter the phone number

press *1 to add

press *2 to hang up

press * to return to conf" font-name="Times New Roman" size="-16" red="0" green="0" blue="0" weight="0" underline="0" strikeout="0" point-size="12" italic="0"/>
      </text-objects>
    </function>
    <function name="OnIVRConfAddPartyRequest" start="20" event="OnIVRConfAddPartyRequest" returns="void" >
      <parameters >
        <parameter name="strCallingNumber" type="string"/>
        <parameter name="strCalledNumber" type="string"/>
        <parameter name="strEndPoint" type="string"/>
        <parameter name="strSessionId" type="string"/>
        <parameter name="lServiceProviderId" type="i8"/>
        <parameter name="strConfPassCode" type="string"/>
        <parameter name="nDialPlanId" type="i4"/>
        <parameter name="strAccessNumber" type="string"/>
        <parameter name="nDestCountryId" type="i4"/>
        <parameter name="strDestDomIntlFlag" type="string"/>
        <parameter name="strDestAreaCode" type="string"/>
        <parameter name="strDestCallingCountryCode" type="string"/>
      </parameters>
      <local-vars >
        <var name="f_nReturnCode" type="i4" >-1</var>
        <var name="f_nErrorCode" type="i4" >-1</var>
        <var name="f_lCurrentTime" type="i8" >0</var>
        <var name="f_sCounter" type="i2" >0</var>
        <var name="f_nPassCodeStatus" type="i4" >0</var>
        <var name="f_strCallingNumber" type="string" ></var>
      </local-vars>
      <actions >
        <action id="20" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=117 y=427 ?>
          <!--Initialize Conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceInitConfSession&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="21" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: OnIVRConfAddPartyRequest");
Server.logInfo("INFO: RECEIVE IVR CONF ADD PARTY FROM SOAP AGENT.");

Server.logInfo("INFO: Calling Number is: " + Session.strCallingNumber);

Server.logInfo("INFO: Called Number is: " + Session.strCalledNumber);

Server.logInfo("INFO: The End Point is: " + Session.strEndPoint);

Server.logInfo("INFO: The Session Id is: " + Session.strSessionId);

Server.logInfo("INFO: The Service provider Id is: " + Session.lServiceProviderId);

Server.logInfo("INFO: The Conference Passcode is: " + Session.strConfPassCode);

Server.logInfo("INFO: The Access Number is: " + Session.strAccessNumber);

Server.logInfo("INFO: dest country Id: " + Session.nDestCountryId);

Server.logInfo("INFO: dest calling code: " + Session.strDestCallingCountryCode);

Server.logInfo("INFO: dest area code: " + Session.strDestAreaCode);

Server.logInfo("INFO: dest dom intl flag: " + Session.strDomIntlFlag);

Session.g_lStartTime = Server.getUTCTime();
Session.g_strSessionId = Session._sessionId;
Session.g_strSoapAddress = Server.soapAddress;
Server.logInfo("SERVER SOAP PORT IS: " + Server.soapPort);
Session.g_nSoapPort = Clib.atoi(Server.soapPort);
if (0 == Session.g_nSoapPort)
{
	Server.logError("ERROR: Server.soapPort IS ZERO");
	Server.logInfo("SET DEFAULT SOAP PORT TO 7581");
	Session.g_nSoapPort = 7581;
}
Session.g_strPassCode = Session.strConfPassCode;
// Session.g_strOrigNbr = Session.strCallingNumber;
Session.g_strOrigNbr = Session.s_strDefaultAni;
Session.g_strUsedDefaultANIFlag = "T";
Session.g_strOutdialDestNbr = Session.strCalledNumber;
Session.g_strTranslatedDestNbr = Session.strCalledNumber;
Session.g_lServiceProviderId = Session.lServiceProviderId;
Session.g_strOutdialFlag = "T";
Session.g_bIVRDialOut = true;
Session.g_strIVRAddPartySessionId = Session.strSessionId;
Session.g_nDialPlanId = Number(Session.s_strOutdialDialingPlan);
Session.g_strAccessNumber = Session.strAccessNumber;
Session.g_strModOutdialFlag = "T";
Session.g_bServingCaller = true;
Session.g_nDestCountryId = Session.nDestCountryId;
if (Session.strDestCallingCountryCode.length <= 0)
{
	Server.logInfo("WARNING: BLANK DEST CALLING CODE: " + Session.strDestCallingCountryCode);
	Server.logInfo("WARNING: USE DEFAULT HOME COUNTRY CODE: " + Session.s_strDefaultCountryCode);
	Session.g_strDestCallingCountryCode = Session.s_strDefaultCountryCode;
}
else
{
	Session.g_strDestCallingCountryCode = Session.strDestCallingCountryCode;
}
Session.g_strDestAreaCode = Session.strDestAreaCode;
Session.g_strDestDomIntlFlag = Session.strDestDomIntlFlag;

// Phone A object
Session.g_oCallLegA.bReverseFromTo = false;
Session.g_oCallLegA.strFrom = "";
Session.g_oCallLegA.strTo = "";
Session.g_oCallLegA.strCallId = "";
Session.g_oCallLegA.strContact = "";
Session.g_oCallLegA.strContent = "";
Session.g_oCallLegA.strOriginalContent = "";
Session.g_oCallLegA.strContentType = "";
Session.g_oCallLegA.strCSeq = "";
Session.g_oCallLegA.strRecordRoute = "";
Session.g_oCallLegA.strRoute = "";
Session.g_oCallLegA.strVia = "";
Session.g_oCallLegA.nSessionTimer = "";
Session.g_oCallLegA.strRequestUri = "";

// Phone B object
Session.g_oCallLegB.bCurrentlyDialing = false;
Session.g_oCallLegB.bAttemptedToOutdial = false;
Session.g_oCallLegB.bConnected = false;
Session.g_oCallLegB.bCurrentlyInConf = false;
Session.g_oCallLegB.bReverseFromTo = false;
Session.g_oCallLegB.strSessionTimerFlag = "";
Session.g_oCallLegB.nSessionTimer = "";
Session.g_oCallLegB.nRingNoAnswerTime = "";
Session.g_oCallLegB.strCalledNumber = "";
Session.g_oCallLegB.strRequestUri = "";
Session.g_oCallLegB.strBackupRequestUri = "";
Session.g_oCallLegB.strCallId = "";
Session.g_oCallLegB.strContent = "";
Session.g_oCallLegB.strCSeq = "";
Session.g_oCallLegB.strFrom = "";
Session.g_oCallLegB.strTo = "";
Session.g_oCallLegB.strRoute = "";
Session.g_oCallLegB.strRecordRoute = "";
Session.g_oCallLegB.strContact = "";
Session.g_oCallLegB.nSetUpTime = 0;
Session.g_oCallLegB.nTearDownTime = 0;
//Init MS
js_initMS (Session.g_oMS, Session.s_strConfMsType);
js_initMS (Session.g_oSubConfMS, Session.s_strConfMsType);
js_initMS (Session.g_oTempConf, Session.s_strConfMsType);
js_initMS (Session.g_oMOH_MS, Session.s_strConfMsType);
js_initMS (Session.g_oIVR_MS, Session.s_strConfMsType);

//mediaserver object
Session.g_oMS.strEndPoint = "";
Session.g_oMS.strConnectionId = "";
Session.g_oMS.strCallId = "";
Session.g_oMS.strContent = "";
Session.g_oMS.strConferenceId = "";	//use through out
Session.g_oMS.strType = Session.s_strConfMsType;
Session.g_oMS.bMuteFlag = false;
Session.g_oMS.bDeafFlag = false;
Session.g_oMS.bCurrentlyInConf = false;
Session.g_oMS.bCurrentlyConnected = false;
Session.g_oMS.nPacketizationPeriod = Session.s_nPacketizationPeriod;
// Session.g_oMS.nConferenceMaxParties = Session.s_nConferenceMaxParties;
Session.g_oMS.nConferenceMaxTalkers = Session.s_nConferenceMaxTalkers;
Session.g_oMS.strCodec = Session.s_strCodec;
//ASN
Session.g_oMS.nNbrActiveSpeakers = Session.s_nNbrActiveSpeakers;
Session.g_oMS.nReportingInterval = Session.s_nReportingInterval;
Session.g_oMS.nDBThreshold = Session.s_nDBThreshold;
//AGC
Session.g_oMS.nAGCTargetLevelIn = Session.s_nAGCTargetLevelIn;
Session.g_oMS.nAGCMaxLevelIn = Session.s_nAGCMaxLevelIn;
Session.g_oMS.nAGCTargetLevelOut = Session.s_nAGCTargetLevelOut;
Session.g_oMS.nAGCMaxLevelOut = Session.s_nAGCMaxLevelOut;
//sub conference object
Session.g_oSubConfMS.strType = Session.s_strConfMsType;
if (Session.g_bHandOff && !Session.g_bHandBack)
{
	Session.g_oSubConfMS.strCodec = Session.s_strFailoverCodec;
}
else
{
	Session.g_oSubConfMS.strCodec = Session.s_strCodec;
}

//ASN
Session.g_oSubConfMS.nNbrActiveSpeakers = Session.s_nNbrActiveSpeakers;
Session.g_oSubConfMS.nReportingInterval = Session.s_nReportingInterval;
Session.g_oSubConfMS.nDBThreshold = Session.s_nDBThreshold;
//AGC
Session.g_oSubConfMS.nAGCTargetLevelIn = Session.s_nAGCTargetLevelIn;
Session.g_oSubConfMS.nAGCMaxLevelIn = Session.s_nAGCMaxLevelIn;
Session.g_oSubConfMS.nAGCTargetLevelOut = Session.s_nAGCTargetLevelOut;
Session.g_oSubConfMS.nAGCMaxLevelOut = Session.s_nAGCMaxLevelOut;
//temp conference mediaserver object
Session.g_oTempConf.strEndPoint = "";
Session.g_oTempConf.strConnectionId = "";
Session.g_oTempConf.strCallId = "";
Session.g_oTempConf.strContent = "";
Session.g_oTempConf.strConferenceId = "";	//use through out
Session.g_oTempConf.strType = Session.s_strConfMsType;
Session.g_oTempConf.bMuteFlag = false;
Session.g_oTempConf.bDeafFlag = false;
Session.g_oTempConf.bCurrentlyInConf = false;
Session.g_oTempConf.bCurrentlyConnected = false;
Session.g_oTempConf.nPacketizationPeriod = Session.s_nPacketizationPeriod;
// Session.g_oTempConf.nConferenceMaxParties = Session.s_nConferenceMaxParties;
Session.g_oTempConf.nConferenceMaxTalkers = Session.s_nConferenceMaxTalkers;
Session.g_oTempConf.strCodec = Session.s_strCodec;
//ASN
Session.g_oTempConf.nNbrActiveSpeakers = Session.s_nNbrActiveSpeakers;
Session.g_oTempConf.nReportingInterval = Session.s_nReportingInterval;
Session.g_oTempConf.nDBThreshold = Session.s_nDBThreshold;
//AGC
Session.g_oTempConf.nAGCTargetLevelIn = Session.s_nAGCTargetLevelIn;
Session.g_oTempConf.nAGCMaxLevelIn = Session.s_nAGCMaxLevelIn;
Session.g_oTempConf.nAGCTargetLevelOut = Session.s_nAGCTargetLevelOut;
Session.g_oTempConf.nAGCMaxLevelOut = Session.s_nAGCMaxLevelOut;

//music on hold mediaserver object
Session.g_oMOH_MS.strEndPoint = "";
Session.g_oMOH_MS.strConnectionId = "";
Session.g_oMOH_MS.strCallId = "";
Session.g_oMOH_MS.strContent = "";
Session.g_oMOH_MS.strConferenceId = "";	//use through out
Session.g_oMOH_MS.strType = Session.s_strMohMsType;
Session.g_oMOH_MS.bMuteFlag = false;
Session.g_oMOH_MS.bDeafFlag = false;
Session.g_oMOH_MS.bCurrentlyInConf = false;
Session.g_oMOH_MS.bCurrentlyConnected = false;
Session.g_oMOH_MS.nPacketizationPeriod = Session.s_nPacketizationPeriod;
// Session.g_oMOH_MS.nConferenceMaxParties = Session.s_nConferenceMaxParties;
Session.g_oMOH_MS.nConferenceMaxTalkers = Session.s_nConferenceMaxTalkers;
Session.g_oMOH_MS.strCodec = Session.s_strCodec;
//ASN
Session.g_oMOH_MS.nNbrActiveSpeakers = Session.s_nNbrActiveSpeakers;
Session.g_oMOH_MS.nReportingInterval = Session.s_nReportingInterval;
Session.g_oMOH_MS.nDBThreshold = Session.s_nDBThreshold;
//AGC
Session.g_oMOH_MS.nAGCTargetLevelIn = Session.s_nAGCTargetLevelIn;
Session.g_oMOH_MS.nAGCMaxLevelIn = Session.s_nAGCMaxLevelIn;
Session.g_oMOH_MS.nAGCTargetLevelOut = Session.s_nAGCTargetLevelOut;
Session.g_oMOH_MS.nAGCMaxLevelOut = Session.s_nAGCMaxLevelOut;

//music on hold mediaserver object
Session.g_oIVR_MS.strEndPoint = "";
Session.g_oIVR_MS.strConnectionId = "";
Session.g_oIVR_MS.strCallId = "";
Session.g_oIVR_MS.strContent = "";
Session.g_oIVR_MS.strConferenceId = "";	//use through out
Session.g_oIVR_MS.strType = Session.s_strIvrMsType;
Session.g_oIVR_MS.bMuteFlag = false;
Session.g_oIVR_MS.bDeafFlag = false;
Session.g_oIVR_MS.bCurrentlyInConf = false;
Session.g_oIVR_MS.bCurrentlyConnected = false;
Session.g_oIVR_MS.nPacketizationPeriod = Session.s_nPacketizationPeriod;
// Session.g_oIVR_MS.nConferenceMaxParties = Session.s_nConferenceMaxParties;
Session.g_oIVR_MS.nConferenceMaxTalkers = Session.s_nConferenceMaxTalkers;
Session.g_oIVR_MS.strCodec = Session.s_strCodec;
//ASN
Session.g_oIVR_MS.nNbrActiveSpeakers = Session.s_nNbrActiveSpeakers;
Session.g_oIVR_MS.nReportingInterval = Session.s_nReportingInterval;
Session.g_oIVR_MS.nDBThreshold = Session.s_nDBThreshold;
//AGC
Session.g_oIVR_MS.nAGCTargetLevelIn = Session.s_nAGCTargetLevelIn;
Session.g_oIVR_MS.nAGCMaxLevelIn = Session.s_nAGCMaxLevelIn;
Session.g_oIVR_MS.nAGCTargetLevelOut = Session.s_nAGCTargetLevelOut;
Session.g_oIVR_MS.nAGCMaxLevelOut = Session.s_nAGCMaxLevelOut;

if (Session.s_strMSRetryFlag == "T")
{
	Session.g_oMS.bRetry = true;
	Session.g_oSubConfMS.bRetry = true;
	Session.g_oTempConf.bRetry = true;
	Session.g_oMOH_MS.bRetry = true;
	Session.g_oIVR_MS.bRetry = true;
}
else
{
	Session.g_oMS.bRetry = false;
	Session.g_oSubConfMS.bRetry = false;
	Session.g_oTempConf.bRetry = false;
	Session.g_oMOH_MS.bRetry = false;
	Session.g_oIVR_MS.bRetry = true;
}
//default Egress for dial out
Session.g_strGWIPEgress = Session.s_strPrimaryPSX;
Session.g_nGWPortEgress = 5060;
Session.g_nRtpClockRate = 8000;
Session.g_nRtpEncoding = 0;]]></script>
          </scripts>
        </action>
        <action id="4" plug-in="Pactolus.Branch.1" ><?xtml-editor x=349 y=751 ?>
          <!--setup for conf party-->
          <results >
            <result name="Default" link="34" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[/* if moderator hang up while in the temp conference with outdial party

this outdial party may be the last party in the conf according to the DB because

we called validate pin already.

If this party is the last party, will responsible for delete conference

*/

Session.g_oMS.strConferenceId = Session.g_strConfResource;	//use through out

Session.g_oTempConf.strConferenceId = Session.strEndPoint;

var myDest = new String(Session.g_strOutdialDestNbr);
Server.logInfo("DESTINATION NUMBER IS: " + myDest);
if ( 0 == myDest.indexOf("011") )
{
	Server.logInfo("INTERNATIONAL DESTINATION NUMBER");
	myDest = myDest.slice(3);
	if ( '3' == myDest.charAt(0) && '3' == myDest.charAt(1) )
	{
		Server.logInfo("FRENCH COUNTRY CODE, SET LANGUAGE TO fre");
		Session.g_strLanguage = "fre";
	}
	
}


Server.logInfo("BEFORE TRANSLATE DEST : <" + Session.g_strTranslatedDestNbr + ">");	

Session.g_strTranslatedDestNbr = js_translate_destination(Session.s_strCustomerCode, Session.g_strTranslatedDestNbr, Session.g_strHomeCallingCode, Session.s_strVPNPrepend, Session.s_nVPN_DestLength);

Server.logInfo("AFTER TRANSLATED DEST : <" + Session.g_strTranslatedDestNbr + ">");

Server.logInfo("BEFORE g_strTranslatedDestNbr prepend : <" + Session.g_strTranslatedDestNbr + " >");

Session.g_strTranslatedDestNbr = js_prepend_digits(Session.g_strTranslatedDestNbr, Session.s_strDigitPrependToOutdial);

Server.logInfo("AFTER g_strTranslatedDestNbr prepend : <" + Session.g_strTranslatedDestNbr + " >");



// Phone B object

Session.g_oCallLegB.strSessionTimerFlag = "F" //Session.s_strSessionTimerFlag;

Session.g_oCallLegB.nSessionTimer = Session.s_nSessionTimerInterval;

Session.g_oCallLegB.nRingNoAnswerTime = Session.s_nRingNoAnswerTime;

Session.g_oCallLegB.strCalledNumber = Session.g_strTranslatedDestNbr;

Session.g_oCallLegB.strRequestUri = Session.s_strPrimaryPSX;

Session.g_oCallLegB.strBackupRequestUri = Session.s_strBackupPSX;



Session.g_strContact = "<sip:" + Session.s_strLocalHost;

if( Server.sipPort != 5060 )
{
  Session.g_strContact = Session.g_strContact + ":" + Server.sipPort + ">";
}
else
{
	Session.g_strContact += ">"
}]]></script>
          </scripts>
        </action>
        <action id="14" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1064 y=750 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
        </action>
        <action id="15" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=598 y=549 ?>
          <!--validate the passcode-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceAuthConfPassCode&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="22" stubbed="1"/>
            <result name="Insued -8" link="43" stubbed="0" >f_nReturnCode == -8</result>
            <result name="SUCCESS" link="37" stubbed="0" >f_nReturnCode == 0
OR f_nReturnCode == 1
OR f_nReturnCode == 3</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_disable_event();
Session.g_strPassCode = Session.strConfPassCode;]]></script>
            <script language="javascript" timing="last" ><![CDATA[// -5, -6, -7 for no answer, busy, dialout error

if (1 == Result.id)

{

	if (-5 == Session.f_nReturnCode)

	{

		Session.f_nErrorCode = -2;

		Session.g_strReturnMsg = "MAX ATTENDEES REACHED, UNABLE TO ADD PARTY";

	}

	else if (-6 == Session.f_nReturnCode)

	{

		Session.f_nErrorCode = -3;

		Session.g_strReturnMsg = "CONFERENCE IS LOCKED, UNABLE TO ADD PARTY";

	}

	else if (-13 == Session.f_nReturnCode)

	{

		Session.f_nErrorCode = -8;

		Session.g_strReturnMsg = "CONFERENCE IS DISABLED, UNABLE TO ADD PARTY TO THE CONFERENCE";

		Session.g_nTerminationReason = 29;

	}

	else if (-19 == Session.f_nReturnCode)

	{

		Session.f_nErrorCode = -9;

		Session.g_strReturnMsg = "INVALID ACCESS NUMBER, UNABLE TO ADD PARTY";

		Session.g_nTerminationReason = 28;

	}

	else if (-20 == Session.f_nReturnCode)

	{

		Session.f_nErrorCode = -10;

		Session.g_strReturnMsg = "INVALID SUBSCRIBER ACCESS NUMBER, UNABLE TO ADD PARTY TO THE CONFERENCE";

		Session.g_nTerminationReason = 28;

	}

	else if (-22 == Session.f_nReturnCode)
	
	{

		Server.logError("ERROR: INSUFFICIENT MS RESOURCE");

		Session.f_nErrorCode = -11;
				
		Session.g_strReturnMsg = "INSUFFICIENT MS RESOURCE";

		Session.g_nTerminationReason = 30;

	}
		
	else

	{

		Session.f_nErrorCode = -4;

		Session.g_strReturnMsg = "VALIDATE PASSCODE FAILED, UNABLE TO ADD PARTY";

	}

}

js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="19" plug-in="Standard.EndSession.1" ><?xtml-editor x=799 y=372 ?>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nCallerCurrentState = Session.s_nStateEndCall;]]></script>
          </scripts>
        </action>
        <action id="21" plug-in="Pactolus.Branch.1" ><?xtml-editor x=351 y=419 ?>
          <!--check return code-->
          <results >
            <result name="Default" link="22" stubbed="0"/>
            <result name="f_nReturnCode==0" link="15" stubbed="0" >f_nReturnCode == 0</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (Session.f_nReturnCode != 0)

{

	Session.f_nErrorCode = -1;

	Session.g_strReturnMsg = "INITIALIZE SESSION FAILED, UNABLE TO ADD PARTY";

}]]></script>
          </scripts>
        </action>
        <action id="22" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=583 y=375 ?>
          <!--RESPONSE FAILURE-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="" transaction="" message-name="s_strIvrConfAddPartyResponse" destination-port="" destination-type="3" destination-session="strSessionId" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;returnCode&quot;" value="f_nErrorCode"/>
            <parameter tag="&quot;returnMsg&quot;" value="g_strReturnMsg"/>
          </SOAP>
          <results >
            <result name="Default" link="19" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
        </action>
        <action id="24" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=840 y=749 ?>
          <!--RESPONSE SUCCESS-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="" transaction="" message-name="s_strIvrConfAddPartyResponse" destination-port="" destination-type="3" destination-session="strSessionId" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;returnCode&quot;" value="s_nSuccess"/>
            <parameter tag="&quot;returnMsg&quot;" value="g_strReturnMsg"/>
          </SOAP>
          <results >
            <result name="Default" link="14" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "SUCCESSFUL ADD PARTY";]]></script>
          </scripts>
        </action>
        <action id="34" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=590 y=750 ?>
          <!--"OutdialPartyToConference"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;OutdialPartyToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oCallLegB</parameter>
            <parameter >g_oTempConf</parameter>
            <parameter >g_lOutdialStartTime</parameter>
            <parameter >g_lOutdialConnectTime</parameter>
            <parameter >g_strSIPStatus</parameter>
            <parameter >f_strCallingNumber</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="22" stubbed="1"/>
            <result name="SUCCESS" link="24" stubbed="0" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if ("T" == Session.s_strLoadTestMode)
	Session.f_strCallingNumber = "LoadIVROutdial";
else
	Session.f_strCallingNumber = Session.s_strDefaultAni;]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (1 == Result.id)

{

	Session.g_nTerminationReason = 34;

	if (1 == Session.f_nReturnCode)

	{

		Session.f_nErrorCode = -5;

		Session.g_strReturnMsg = "RING NO ANSWER, UNABLE TO ADD PARTY";
		Session.g_nTerminationReason = 11;

	}

	else if (2 == Session.f_nReturnCode)

	{

		Session.f_nErrorCode = -6;

		Session.g_strReturnMsg = "BUSY PHONE, UNABLE TO ADD PARTY";
		Session.g_nTerminationReason = 10;

	}

	else

	{

		Session.f_nErrorCode = -7;

		Session.g_strReturnMsg = "OUTDIAL FAILED, UNABLE TO ADD PARTY";

	}

}

var myUri = new SipRequestUri(Session.g_oCallLegB.strRequestUri);

if (myUri.url.dtg == undefined)

{

	Session.g_oCallLegB.strDestTrunkGroup = "";

}

else

{

	Session.g_oCallLegB.strDestTrunkGroup = myUri.url.dtg;

}



Server.logInfo("CALLING js_calculate_uri_and_route");

Server.logInfo("BEFORE contact: " + Session.g_oCallLegB.strContact);

Server.logInfo("BEFORE record route: " + Session.g_oCallLegB.strRecordRoute);

Server.logInfo("BEFORE request Uri: " + Session.g_oCallLegB.strRequestUri);

Server.logInfo("BEFORE route: " + Session.g_oCallLegB.strRoute);

var bDialIn = false;

js_calculate_uri_and_route(bDialIn, Session.s_strSipVersion, Session.g_oCallLegB.strFrom, Session.g_oCallLegB.strContact, Session.g_oCallLegB.strRecordRoute, Session.g_oCallLegB.strRequestUri, Session.g_oCallLegB.strRoute);

Server.logInfo("AFTER contact: " + Session.g_oCallLegB.strContact);

Server.logInfo("AFTER record route: " + Session.g_oCallLegB.strRecordRoute);

Server.logInfo("AFTER request Uri: " + Session.g_oCallLegB.strRequestUri);

Server.logInfo("AFTER route: " + Session.g_oCallLegB.strRoute);

Server.logInfo("Call leg B request Uri is: " + Session.g_oCallLegB.strRequestUri);]]></script>
          </scripts>
        </action>
        <action id="37" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=130 y=749 ?>
          <!--encrypt tag-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceEncrypt&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="4" stubbed="0"/>
          </results>
        </action>
        <action id="38" plug-in="Pactolus.JavaStaticMethod.1" ><?xtml-editor x=1796 y=530 ?>
          <!--"psAPISceConfCleanup"-->
          <java xmlns="urn:www.pactolus.com:xtml:application" class="&quot;com.pactolus.conferencing.psAPISceConfCleanup&quot;" method="&quot;cleanupCallLeg&quot;" timeout="s_nTimeout" return="" method-return-var="f_nReturnCode" method-return-type="0" >
            <parameter type="in" var-type="unknown" >g_strDBNAME</parameter>
            <parameter type="in" var-type="unknown" >g_strExistingCallLegId</parameter>
            <parameter type="in" var-type="unknown" >f_lCurrentTime</parameter>
          </java>
          <results >
            <result name="Default" link="41" stubbed="0"/>
            <result name="Success" link="42" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: ********JAVA CALLING psAPISceConfCleanupCallLeg *********");

Session.f_lCurrentTime = Server.getUTCTime();]]></script>
            <script language="javascript" timing="last" ><![CDATA[Server.logInfo("INFO: ********** iJavaReturnCode " + Session.f_nReturnCode);

if (Result.id == 2)

{

	Server.logInfo("INFO: SUCCESS CALL psAPISceConfCleanupCallLeg.");

}

else

{

	Server.logError("ERROR: FAIL TO CALL psAPISceConfCleanupCallLeg, EXIT ON: " + Result.name);

}]]></script>
          </scripts>
        </action>
        <action id="39" plug-in="Standard.WaitEvent.1" ><?xtml-editor x=1342 y=541 ?>
          <!--for PONG-->
          <wait xmlns="urn:www.pactolus.com:xtml:communication" timeout="5" recv-name="g_strEventReceived" >
            <msg name="ConferencePong"/>
          </wait>
          <results >
            <result name="Default" link="38" stubbed="1"/>
            <result name="Success" link="44" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="40" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1085 y=544 ?>
          <!--PING to session-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="" transaction="" message-name="&quot;ConferencePing&quot;" destination-port="" destination-type="3" destination-session="g_strExistingSessionId" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;PingSessionId&quot;" value="g_strSessionId"/>
            <parameter tag="&quot;PassCode&quot;" value="g_strPassCode"/>
          </SOAP>
          <results >
            <result name="Default" link="38" stubbed="1"/>
            <result name="Success" link="39" stubbed="0"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_disable_event();]]></script>
          </scripts>
        </action>
        <action id="41" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2027 y=484 ?>
          <results >
            <result name="Default" link="22" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 21;

Session.g_nErrorMsgNumber = 4007;  //passcode inused

Server.logError("ERROR: PASSCODE INUSED.");]]></script>
          </scripts>
        </action>
        <action id="42" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2042 y=627 ?>
          <!--exceed max retry?-->
          <results >
            <result name="Default" link="15" stubbed="1"/>
            <result name="Counter &gt;= MaxRetry?" link="22" stubbed="1" >f_sCounter &gt;= g_nMaxRetryAllowed</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_sCounter++;

Session.g_strRetryFlag = "T";]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (2 == Result.id)

{

	Session.g_nTerminationReason = 21;

	Session.g_nErrorMsgNumber = 4007;  //passcode inused

	Server.logError("ERROR: EXCEED MAX RETRIES VALIDATE PASSCODE INSUED.");

}]]></script>
          </scripts>
        </action>
        <action id="43" plug-in="Pactolus.Branch.1" ><?xtml-editor x=847 y=545 ?>
          <!--same session-->
          <results >
            <result name="Default" link="40" stubbed="0"/>
            <result name="same session" link="38" stubbed="1" >g_strExistingSessionId match g_strSessionId</result>
          </results>
        </action>
        <action id="44" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1578 y=539 ?>
          <!--passcode inused?-->
          <results >
            <result name="Default" link="38" stubbed="0"/>
            <result name="passcode inused" link="41" stubbed="1" >f_nPassCodeStatus == s_nPasscodeInUsed</result>
          </results>
        </action>
      </actions>
      <text-objects >
        <text-object x-coord="95" y-coord="59" width="624" height="219" text="f_nErrorCode:

    -1    INITIALIZE SESSION FAILED

    -2    MAX ATTENDEES

    -3     CONFERENCE LOCKED

    -4    VALIDATE PASSCODE FAILED

    -5    RING NO ANSWER

    -6    BUSY PHONE

    -7    OUTDIAL FAILED" font-name="Times New Roman" size="-16" red="0" green="0" blue="0" weight="0" underline="0" strikeout="0" point-size="12" italic="0"/>
      </text-objects>
    </function>
    <function name="OnIVRConfBridgePartyRequest" start="22" event="OnIVRConfBridgePartyRequest" returns="void" >
      <parameters >
        <parameter name="strMSEndPoint" type="string"/>
      </parameters>
      <local-vars >
        <var name="f_nReturnCode" type="i4" >-1</var>
        <var name="f_bNullString" type="boolean" >0</var>
        <var name="f_strConfControllerIP" type="string" ></var>
        <var name="f_nConfControllerPort" type="i4" >0</var>
        <var name="f_strTransactionId" type="string" ></var>
        <var name="f_strReturnMsg" type="string" ></var>
      </local-vars>
      <actions >
        <action id="22" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=131 y=440 ?>
          <!--Remove member from conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;RemoveMemberFromConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
          </function>
          <results >
            <result name="Default" link="65" stubbed="1"/>
            <result name="SUCCESS" link="42" stubbed="0" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: OnIVRConfBridgePartyRequest");
Server.logInfo("INFO: RECEIVE IVR CONF BRIDGE PARTY FROM SOAP AGENT.");

Server.logInfo("INFO: The End Point is: " + Session.strMSEndPoint);]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Pactolus.Branch.1" ><?xtml-editor x=129 y=587 ?>
          <!--SET MS VARS TO CONF-->
          <results >
            <result name="Default" link="24" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_oMS.strEndPoint = "";

Session.g_oMS.strConnectionId = "";

Session.g_oMS.strCallId = "";

Session.g_oMS.strContent = "";



Session.g_oMS.bMuteFlag = true;

Session.g_oMS.bDeafFlag = true;]]></script>
          </scripts>
        </action>
        <action id="4" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=2677 y=1442 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="13" plug-in="Standard.EndSession.1" ><?xtml-editor x=1105 y=554 ?></action>
        <action id="14" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=136 y=709 ?>
          <!--party join to conf controller-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;PartyJoin&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="34" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[js_disable_event();]]></script>
          </scripts>
        </action>
        <action id="19" plug-in="Standard.EndSession.1" ><?xtml-editor x=612 y=580 ?>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 1;]]></script>
          </scripts>
        </action>
        <action id="24" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=357 y=587 ?>
          <!--AddMemberToConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
            <parameter >g_oCallLegB</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="14" stubbed="1"/>
            <result name="FAILURE" link="65" stubbed="0" >f_nReturnCode == s_nFailure</result>
            <result name="CALLERHUNGUP" link="19" stubbed="0" >f_nReturnCode == s_nCallerHungup</result>
          </results>
        </action>
        <action id="26" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1963 y=1454 ?>
          <!--set DTMF detection ON-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;SetDTMFOn&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="43" stubbed="0"/>
          </results>
        </action>
        <action id="27" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1240 y=1246 ?>
          <!--play tone or name?-->
          <results >
            <result name="Default" link="26" stubbed="1"/>
            <result name="play tone - 1" link="31" stubbed="0" >g_nArriveDepartOption == 1</result>
            <result name="play name - 3" link="28" stubbed="0" >g_nArriveDepartOption == 3</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_disable_event();

Session.g_lMSConnectTime = Server.getUTCTime();]]></script>
          </scripts>
        </action>
        <action id="28" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1487 y=1456 ?>
          <!--null string-->
          <results >
            <result name="Default" link="29" stubbed="0"/>
            <result name="f_bNullString == true" link="31" stubbed="1" >f_bNullString == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("RECORDED NAME IS:  " + Session.g_strCallerRecordedName);

Server.logInfo("RECORDED NAME LENGTH IS:  " + Session.g_nRecordNameLength);

if (Session.g_nRecordNameLength <= 0)

{

	Session.f_bNullString = true;

}

else

{

	Session.f_bNullString = false;

}]]></script>
          </scripts>
        </action>
        <action id="29" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1734 y=1455 ?>
          <!--xxx has joined-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="&quot;*&quot;" endpoint="g_oMS.strConferenceId" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="url" >g_strCallerRecordedName</audio>
            <audio type="index" >938</audio>
          </play>
          <results >
            <result name="Default" link="26" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="31" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1468 y=1305 ?>
          <!--Play Join Tone to conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;PlayPromptToConference&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
            <parameter >g_strLanguage</parameter>
            <parameter >s_nPromptArrivalTone</parameter>
          </function>
          <results >
            <result name="Default" link="26" stubbed="1"/>
          </results>
        </action>
        <action id="32" plug-in="Pactolus.Branch.1" ><?xtml-editor x=588 y=703 ?>
          <!--subscriber?-->
          <results >
            <result name="Default" link="47" stubbed="1"/>
            <result name="g_strIsSubscriberFlag== &quot;T&quot;" link="33" stubbed="0" >g_strIsSubscriberFlag match "T"</result>
          </results>
        </action>
        <action id="33" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=817 y=707 ?>
          <!--GetAndPlayBalance-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;GetAndPlayBalance&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="47" stubbed="0"/>
          </results>
        </action>
        <action id="34" plug-in="Pactolus.Branch.1" ><?xtml-editor x=356 y=706 ?>
          <!--prepaid conference-->
          <results >
            <result name="Default" link="47" stubbed="1"/>
            <result name="billing type == 1?" link="32" stubbed="0" >g_nBillingType == 1</result>
          </results>
        </action>
        <action id="35" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=875 y=441 ?>
          <!--"RecordCallerName"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;RecordCallerName&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="38" stubbed="0"/>
          </results>
        </action>
        <action id="36" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=623 y=442 ?>
          <!--"MSOutdialParty"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;MSOutdialParty&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oCallLegB</parameter>
            <parameter >g_oMS</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="66" stubbed="0"/>
            <result name="SUCCESS" link="35" stubbed="0" >f_nReturnCode == s_nSuccess</result>
            <result name="CALLER HUNGUP" link="13" stubbed="1" >f_nReturnCode == s_nCallerHungup</result>
          </results>
        </action>
        <action id="38" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1087 y=439 ?>
          <!--DeleteMSConnection-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DeleteMSConnection&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="2" stubbed="1"/>
          </results>
        </action>
        <action id="39" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1321 y=265 ?>
          <!--set billing code-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceSetBillingCode&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="38" stubbed="1"/>
          </results>
        </action>
        <action id="40" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1115 y=266 ?>
          <!--Collect billing code-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;(xxxxxxxxxx|x.T|x.#)&quot;" language="g_strLanguage" digits="g_strBillingCodeNumber" retry-count="g_nMaxRetryAllowed" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >943</audio>
            <audio type="index" >580</audio>
            <timeout-prompt type="index" >552</timeout-prompt>
          </play>
          <results >
            <result name="Default" link="39" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="41" plug-in="Pactolus.Branch.1" ><?xtml-editor x=876 y=267 ?>
          <!--get billing code?-->
          <results >
            <result name="Default" link="35" stubbed="1"/>
            <result name="g_strBillingCodeFlag==T" link="40" stubbed="0" >g_strBillingCodeFlag match "T"</result>
          </results>
        </action>
        <action id="42" plug-in="Pactolus.Branch.1" ><?xtml-editor x=375 y=443 ?>
          <!--record name?-->
          <results >
            <result name="Default" link="2" stubbed="1"/>
            <result name="RecordNameFlag==&quot;T&quot;" link="36" stubbed="0" >g_strRecordNamesFlag match "T"</result>
          </results>
        </action>
        <action id="43" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2195 y=1451 ?>
          <results >
            <result name="Default" link="44" stubbed="0"/>
            <result name="session timer == T|| Time==0" link="4" stubbed="1" >s_strSessionTimerFlag match "T"

OR g_nCkReInviteTime == 0</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nCkReInviteTime = Session.g_oCallLegB.nSessionTimer;]]></script>
          </scripts>
        </action>
        <action id="44" plug-in="Standard.Timer.1" ><?xtml-editor x=2446 y=1444 ?>
          <!--ck reInvite timer-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lCkReInviteTimerIdB" duration="g_nCkReInviteTime"/>
          <results >
            <result name="Default" link="4" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[//Session.g_lLastReInviteTime = Server.getUTCTime();

Session.g_bCkReInviteTimerFlagB = true;]]></script>
          </scripts>
        </action>
        <action id="47" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1037 y=705 ?>
          <!--muted?-->
          <results >
            <result name="Default" link="61" stubbed="0"/>
            <result name="g_bMuteThisParty" link="69" stubbed="0" >g_bMuteThisParty == true</result>
          </results>
        </action>
        <action id="48" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=2354 y=1029 ?>
          <!--UnmutePartyRequest-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="s_strUnmutePartyRequest" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;callerPassCode&quot;" value="g_strCCGeneratedPassCode"/>
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="51" stubbed="0"/>
            <result name="Success" link="49" stubbed="0"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_disable_event();

Server.logInfo("INFO: **** UNMUTE PARTY REQUEST ****");]]></script>
          </scripts>
        </action>
        <action id="49" plug-in="Standard.WaitEvent.1" ><?xtml-editor x=2587 y=1167 ?>
          <!--UnmutePartyResponse-->
          <wait xmlns="urn:www.pactolus.com:xtml:communication" timeout="5" recv-name="g_strEventReceived" >
            <msg name="UnmutePartyResponse" >
              <parameter >f_strConfControllerIP</parameter>
              <parameter >f_nConfControllerPort</parameter>
              <parameter >f_strTransactionId</parameter>
              <parameter >f_nReturnCode</parameter>
              <parameter >f_strReturnMsg</parameter>
            </msg>
          </wait>
          <results >
            <result name="Default" link="51" stubbed="1"/>
            <result name="Success" link="50" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_nReturnCode = -1;]]></script>
            <script language="javascript" timing="last" ><![CDATA[js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="50" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2822 y=1166 ?>
          <!--success?-->
          <results >
            <result name="Default" link="51" stubbed="1"/>
            <result name="f_nReturnCode == 0" link="54" stubbed="0" >f_nReturnCode == 0</result>
          </results>
        </action>
        <action id="51" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2572 y=1028 ?>
          <!--can't unmute-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >933</audio>
          </play>
          <results >
            <result name="Default" link="70" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="52" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2134 y=922 ?>
          <!--CallPartyFlag==T?-->
          <results >
            <result name="Default" link="58" stubbed="0"/>
            <result name="g_strPartyPasscodeFlag==T" link="48" stubbed="0" >g_strPartyPasscodeFlag match "T"</result>
          </results>
        </action>
        <action id="53" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=3074 y=1429 ?>
          <!--SELF UNMUTE PARTY-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="g_strResponseTransactionId" message-name="s_strConfUnmutePartyEvent" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;callerPassCode&quot;" value="g_strCCGeneratedPassCode"/>
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="55" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: **** SELF UNMUTE ****");]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)

{

	Server.logError("ERROR: FAIL TO SEND SOAP MESSAGE UNMUTE YOUR OWN LINE.");

}]]></script>
          </scripts>
        </action>
        <action id="54" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=3055 y=1162 ?>
          <!--"ChangeToConferenceMode"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ChangeToConferenceMode&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="51" stubbed="1"/>
            <result name="SUCCESS" link="56" stubbed="0" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: MODIFY MEMBER TO UNMUTE.");

Session.g_oMS.bMuteFlag = false;]]></script>
          </scripts>
        </action>
        <action id="55" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=3320 y=1425 ?>
          <!--your line unmuted-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >s_nPromptUnmuted</audio>
          </play>
          <results >
            <result name="Default" link="70" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nPromptSelfMuteUnMute = 907;

Session.g_bMutedState = false;]]></script>
          </scripts>
        </action>
        <action id="56" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2812 y=1314 ?>
          <!--CallPartyFlag==T?-->
          <results >
            <result name="Default" link="57" stubbed="0"/>
            <result name="g_strPartyPasscodeFlag==T" link="53" stubbed="0" >g_strPartyPasscodeFlag match "T"</result>
          </results>
        </action>
        <action id="57" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=3055 y=1296 ?>
          <!--SELF UNMUTE PARTY-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="g_strResponseTransactionId" message-name="s_strConfUnmutePartyEvent" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;callerPassCode&quot;" value="g_strCCGeneratedPassCode"/>
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="55" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: **** SELF UNMUTE ****");]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)

{

	Server.logError("ERROR: FAIL TO SEND SOAP MESSAGE UNMUTE YOUR OWN LINE.");

}]]></script>
          </scripts>
        </action>
        <action id="58" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=2338 y=878 ?>
          <!--UnmutePartyRequest-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="s_strUnmutePartyRequest" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;callerPassCode&quot;" value="g_strCCGeneratedPassCode"/>
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="51" stubbed="1"/>
            <result name="Success" link="49" stubbed="1"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_disable_event();

Server.logInfo("INFO: **** UNMUTE PARTY REQUEST ****");]]></script>
          </scripts>
        </action>
        <action id="59" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1680 y=922 ?>
          <!--your line has been muted-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="6" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;(*1)&quot;" language="g_strLanguage" digits="g_strUnmuteDigits" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >900</audio>
            <audio type="index" >355</audio>
            <audio type="index" >908</audio>
          </play>
          <results >
            <result name="Default" link="70" stubbed="1"/>
            <result name="Success" link="60" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="60" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1910 y=924 ?>
          <!--what digit?-->
          <results >
            <result name="Default" link="70" stubbed="1"/>
            <result name="*6" link="52" stubbed="0" >g_strUnmuteDigits match "^\*{1}6{1}$"</result>
          </results>
        </action>
        <action id="61" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1240 y=711 ?>
          <!--"ChangeToConferenceMode"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ChangeToConferenceMode&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="67" stubbed="0"/>
            <result name="SUCCESS" link="70" stubbed="0" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[// if (true == Session.g_bMuteThisParty || Session.g_strMuteFlag == "T")

if (true == Session.g_bMuteThisParty)

{

	Session.g_oMS.bMuteFlag = true;

	Session.g_bMutedState = true;

	Session.g_nPromptSelfMuteUnMute = 908;
	
	if ("T" == Session.g_strMuteFlag)
	{
		Session.g_bMutedByMod = true;
	}
	else
	{
		Session.g_bMutedByMod = false;
	}

}

else

{

	Session.g_oMS.bMuteFlag = false;

}

Session.g_oMS.bDeafFlag = false;

]]></script>
          </scripts>
        </action>
        <action id="62" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1426 y=971 ?>
          <!--ModMutedThisParty?-->
          <results >
            <result name="Default" link="59" stubbed="0"/>
            <result name="g_strModeratorMutedFlag" link="63" stubbed="0" >g_strModeratorMutedFlag match "T"
OR g_strMuteFlag match "T"</result>
          </results>
        </action>
        <action id="63" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1695 y=1089 ?>
          <!--your line has been muted-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="6" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;(*1)&quot;" language="g_strLanguage" digits="g_strUnmuteDigits" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >900</audio>
          </play>
          <results >
            <result name="Default" link="70" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="65" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=610 y=620 ?>
          <!--HangUp Caller-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpCaller&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="13" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 35;]]></script>
          </scripts>
        </action>
        <action id="66" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=887 y=554 ?>
          <!--HangUp Caller-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpCaller&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="13" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 34;]]></script>
          </scripts>
        </action>
        <action id="67" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1483 y=679 ?>
          <!--HangUp Caller-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpCaller&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="13" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 38;
Session.g_nConfLeaveReason = 6;
Session.g_strConfLeaveMsg = "FAIL TO MODIFY CONFERENCE";]]></script>
          </scripts>
        </action>
        <action id="69" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1190 y=978 ?>
          <!--event base conf?-->
          <results >
            <result name="Default" link="62" stubbed="0"/>
            <result name="g_nDnisIdentifiedConfFlag == 1" link="70" stubbed="1" >g_nDnisIdentifiedConfFlag == 1</result>
          </results>
        </action>
        <action id="70" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1500 y=798 ?>
          <results >
            <result name="Default" link="27" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[// if (true == Session.g_bMuteThisParty || Session.g_strMuteFlag == "T")
if (true == Session.g_bMuteThisParty)
{
	Session.g_oMS.bMuteFlag = true;
	Session.g_bMutedState = true;
	Session.g_nPromptSelfMuteUnMute = 908;
	if ("T" == Session.g_strMuteFlag)
	{
		Session.g_bMutedByMod = true;
	}
	else
	{
		Session.g_bMutedByMod = false;
	}

}
else
{
	Session.g_oMS.bMuteFlag = false;
}
Session.g_oMS.bDeafFlag = false;]]></script>
          </scripts>
        </action>
      </actions>
    </function>
    <function name="OnIVRConfRemovePartyRequest" start="3" event="OnIVRConfRemovePartyRequest" returns="void" >
      <actions >
        <action id="3" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=175 y=283 ?>
          <!--hangup caller-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpCaller&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="9" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: OnIVRRemovePartyRequest");
Session.g_nTerminationReason = 13;

Server.logInfo("INFO: RECEIVE IVR CONF REMOVE PARTY FROM SOAP AGENT.");]]></script>
          </scripts>
        </action>
        <action id="9" plug-in="Standard.EndSession.1" ><?xtml-editor x=410 y=282 ?></action>
      </actions>
    </function>
    <function name="OnConfHoldPartyRequest" start="28" event="OnConfHoldPartyRequest" returns="void" >
      <parameters >
        <parameter name="strConfControllerIpAddress" type="string"/>
        <parameter name="nConfControllerPort" type="i4"/>
        <parameter name="strTransactionId" type="string"/>
      </parameters>
      <local-vars >
        <var name="f_nReturnCode" type="i4" >-1</var>
      </local-vars>
      <actions >
        <action id="28" plug-in="Pactolus.Branch.1" ><?xtml-editor x=84 y=370 ?>
          <results >
            <result name="Default" link="19" stubbed="0"/>
            <result name="hold, main menu?" link="5" stubbed="1" >g_bCurrentlyInMMenu == true
OR g_bHoldState == true
OR g_bWaitForCSR == true
OR g_nCallerCurrentState == s_nStateCsrPutOnHold
OR g_nCallerCurrentState == s_nStateAppletPutOnHold</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: OnConfHoldPartyRequest");
js_disable_event();

Server.logInfo("INFO: RECEIVE HOLD PARTY REQUEST FROM CONF CONTROLLER.");

Server.logInfo("INFO: Conf Controller Port: " + Session.nConfControllerPort);

Server.logInfo("INFO: Conf Controller IP: " + Session.strConfControllerIpAddress);

Server.logInfo("INFO: Transaction Id: " + Session.strTransactionId);



if (true == Session.g_bCurrentlyInMMenu)

{

	Session.g_strReturnMsg = "FAILURE HOLD A PARTY, PARTY IS CURRENTLY IN MAIN MENU.";

}

else if (true == Session.g_bHoldState || Session.s_nStateCsrPutOnHold == Session.g_nCallerCurrentState || Session.s_nStateCsrPutOffHold == Session.g_nCallerCurrentState)

{

	Session.g_strReturnMsg = "FAILURE HOLD A PARTY, PARTY IS CURRENTLY ON HOLD.";

}

else if (true == Session.g_bMutedState)

{

	Session.g_strReturnMsg = "FAILURE HOLD A PARTY, PARTY IS CURRENTLY MUTED.";

}

else if (true == Session.g_bWaitForCSR)

{

		Session.g_strReturnMsg = "FAILURE HOLD A PARTY, PARTY IS CURRENTLY WAITING FOR CSR.";

}]]></script>
          </scripts>
        </action>
        <action id="1" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1321 y=621 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1077 y=623 ?>
          <!--SUCCESS hold a party-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="strTransactionId" message-name="s_strConfHoldResponse" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="s_nSuccess"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
          </SOAP>
          <results >
            <result name="Default" link="1" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "SUCCESSFUL HOLD A PARTY";

Session.g_nCallerCurrentState = Session.s_nStateAppletPutOnHold;

Session.g_bHoldState = true;]]></script>
          </scripts>
        </action>
        <action id="5" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1280 y=109 ?>
          <!--FAILURE hold a party-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="strTransactionId" message-name="s_strConfHoldResponse" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="s_nFailure"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
          </SOAP>
          <results >
            <result name="Default" link="1" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
        </action>
        <action id="14" plug-in="Pactolus.Branch.1" ><?xtml-editor x=71 y=156 ?>
          <!--currently in main menu?-->
          <results >
            <result name="Default" link="18" stubbed="0"/>
            <result name="currently on hold" >g_bHoldState == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: RECEIVE HOLD PARTY REQUEST FROM CONF CONTROLLER.");

Server.logInfo("INFO: Conf Controller Port: " + Session.nConfControllerPort);

Server.logInfo("INFO: Conf Controller IP: " + Session.strConfControllerIpAddress);

Server.logInfo("INFO: Transaction Id: " + Session.strTransactionId);

js_disable_event();]]></script>
          </scripts>
        </action>
        <action id="18" plug-in="Pactolus.Branch.1" ><?xtml-editor x=285 y=156 ?>
          <!--currently in main menu?-->
          <results >
            <result name="Default" link="19" stubbed="1"/>
            <result name="currentlyInMainMenu" link="5" stubbed="1" >g_bCurrentlyInMMenu == true

OR g_bWaitForCSR == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: RECEIVE HOLD PARTY REQUEST FROM CONF CONTROLLER.");

Server.logInfo("INFO: Conf Controller Port: " + Session.nConfControllerPort);

Server.logInfo("INFO: Conf Controller IP: " + Session.strConfControllerIpAddress);

Server.logInfo("INFO: Transaction Id: " + Session.strTransactionId);]]></script>
          </scripts>
        </action>
        <action id="19" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=344 y=362 ?>
          <!--"setDTMFOff"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;setDTMFOff&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="24" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bDontPlayContinueToHold = true;]]></script>
          </scripts>
        </action>
        <action id="20" plug-in="Standard.Timer.1" ><?xtml-editor x=816 y=630 ?>
          <!--5 secs to connect MOH-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lMOHTimerId" duration="s_nPreMohTime"/>
          <results >
            <result name="Default" link="2" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bMOHTimerFlag = true;
Session.g_bDtmfCollectionOnHold = true;]]></script>
          </scripts>
        </action>
        <action id="21" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=578 y=623 ?>
          <!--Remove member from conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;RemoveMemberFromConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="20" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: CONF HOLD PARTY REQUEST, REMOVE MEMBER FROM CONFERENCE.");]]></script>
          </scripts>
        </action>
        <action id="24" plug-in="Pactolus.Branch.1" ><?xtml-editor x=594 y=355 ?>
          <!--MOH?-->
          <results >
            <result name="Default" link="29" stubbed="0"/>
            <result name="g_strMusicOnHoldFlag==&quot;T&quot;" link="32" stubbed="0" >g_strMusicOnHoldFlag match "T"</result>
          </results>
        </action>
        <action id="26" plug-in="Standard.Timer.1" ><?xtml-editor x=1558 y=282 ?>
          <!--play please hold every 10 secs-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lHoldTimerId" duration="s_nSleepTime"/>
          <results >
            <result name="Default" link="2" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bHoldTimerFlag = true;]]></script>
          </scripts>
        </action>
        <action id="27" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1287 y=279 ?>
          <!--please hold-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >898</audio>
          </play>
          <results >
            <result name="Default" link="26" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="29" plug-in="Pactolus.Branch.1" ><?xtml-editor x=805 y=350 ?>
          <!--in sub conf?-->
          <results >
            <result name="Default" link="35" stubbed="0"/>
            <result name="g_bCurrentlyInSubConf" link="36" stubbed="0" >g_bCurrentlyInSubConf == true</result>
          </results>
        </action>
        <action id="31" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1281 y=455 ?>
          <!--please hold-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oSubConfMS.strConnectionId" endpoint="g_oSubConfMS.strEndPoint" callid="g_oSubConfMS.strCallId" repeat="1" timeout="10" ms-type="g_oSubConfMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >898</audio>
          </play>
          <results >
            <result name="Default" link="26" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="32" plug-in="Pactolus.Branch.1" ><?xtml-editor x=324 y=623 ?>
          <!--in sub conf?-->
          <results >
            <result name="Default" link="21" stubbed="0"/>
            <result name="g_bCurrentlyInSubConf" link="33" stubbed="0" >g_bCurrentlyInSubConf == true</result>
            <result name="g_bSideBarOperatorRequest" link="34" stubbed="0" >g_bSideBarOperatorRequest == true
AND g_bTalkingWithCSR == true</result>
          </results>
        </action>
        <action id="33" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=579 y=741 ?>
          <!--Remove member from conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;RemoveMemberFromConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver" >
            <parameter >g_oSubConfMS</parameter>
          </function>
          <results >
            <result name="Default" link="20" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: CONF HOLD PARTY REQUEST, REMOVE MEMBER FROM CONFERENCE.");]]></script>
          </scripts>
        </action>
        <action id="34" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=579 y=878 ?>
          <!--Remove member from conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;RemoveMemberFromConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
          </function>
          <results >
            <result name="Default" link="20" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: CONF HOLD PARTY REQUEST, REMOVE MEMBER FROM TEMP CONFERENCE SIDEBAR TALKING WITH CSR");]]></script>
          </scripts>
        </action>
        <action id="35" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1048 y=178 ?>
          <!--"ChangeToDataMode"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ChangeToDataMode&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="5" stubbed="0"/>
            <result name="SUCCESS" link="27" stubbed="0" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_oMS.bMuteFlag = true;
Session.g_oMS.bDeafFlag = true;]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)
{
	Server.logError("ERROR: FAIL TO CHANGE TO DATA MODE");
}]]></script>
          </scripts>
        </action>
        <action id="36" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1064 y=465 ?>
          <!--"ChangeToDataMode"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ChangeToDataMode&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oSubConfMS</parameter>
          </function>
          <results >
            <result name="Default" link="5" stubbed="1"/>
            <result name="SUCCESS" link="31" stubbed="0" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_oSubConfMS.bMuteFlag = true;
Session.g_oSubConfMS.bDeafFlag = true;]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)
{
	Server.logError("ERROR: FAIL TO CHANGE TO DATA MODE");
}]]></script>
          </scripts>
        </action>
      </actions>
      <text-objects >
        <text-object x-coord="356" y-coord="275" width="255" height="56" text="In conference already then hold, don't play continue to hold" font-name="Times New Roman" size="-16" red="0" green="0" blue="0" weight="0" underline="0" strikeout="0" point-size="12" italic="0"/>
      </text-objects>
    </function>
    <function name="OnConfOffholdPartyRequest" start="32" event="OnConfOffholdPartyRequest" returns="void" >
      <parameters >
        <parameter name="strConfControllerIpAddress" type="string"/>
        <parameter name="nConfControllerPort" type="i4"/>
        <parameter name="strTransactionId" type="string"/>
      </parameters>
      <local-vars >
        <var name="f_nReturnCode" type="i4" >-1</var>
      </local-vars>
      <actions >
        <action id="32" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=68 y=184 ?>
          <!--"StopTimer"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;StopTimer&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="16" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: OnConfOffHoldPartyRequest");
js_disable_event();]]></script>
          </scripts>
        </action>
        <action id="1" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1507 y=299 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="4" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1248 y=298 ?>
          <!--FAILURE unhold a party-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="strTransactionId" message-name="s_strConfOffHoldResponse" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="s_nFailure"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
          </SOAP>
          <results >
            <result name="Default" link="1" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "FAILURE UNHOLD A PARTY";]]></script>
          </scripts>
        </action>
        <action id="5" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1257 y=437 ?>
          <!--SUCCESS unhold a party-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="strTransactionId" message-name="s_strConfOffHoldResponse" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="s_nSuccess"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
          </SOAP>
          <results >
            <result name="Default" link="30" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "SUCCESSFUL UNHOLD A PARTY";

Session.g_nCallerCurrentState = Session.s_nStateAppletPutOffHold;

Session.g_bHoldState = false;]]></script>
          </scripts>
        </action>
        <action id="15" plug-in="Pactolus.Branch.1" ><?xtml-editor x=331 y=343 ?>
          <!--currently in main menu?-->
          <results >
            <result name="Default" link="18" stubbed="0"/>
            <result name="currentlyInMainMenu==true" link="5" stubbed="1" >g_bCurrentlyInMMenu == true</result>
          </results>
        </action>
        <action id="16" plug-in="Pactolus.Branch.1" ><?xtml-editor x=72 y=349 ?>
          <!--mute by mod?-->
          <results >
            <result name="Default" link="15" stubbed="0"/>
            <result name="already off hold" link="5" stubbed="1" >g_bHoldState == false</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: RECEIVE OFF HOLD PARTY REQUEST FROM CONF CONTROLLER.");

Server.logInfo("INFO: Conf Controller Port: " + Session.nConfControllerPort);

Server.logInfo("INFO: Conf Controller IP: " + Session.strConfControllerIpAddress);

Server.logInfo("INFO: Transaction Id: " + Session.strTransactionId);]]></script>
          </scripts>
        </action>
        <action id="18" plug-in="Pactolus.Branch.1" ><?xtml-editor x=77 y=494 ?>
          <!--MOH?-->
          <results >
            <result name="Default" link="33" stubbed="0"/>
            <result name="g_strMusicOnHoldFlag==&quot;T&quot;" link="19" stubbed="0" >g_strMusicOnHoldFlag match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bDontPlayContinueToHold = true;]]></script>
          </scripts>
        </action>
        <action id="19" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=316 y=637 ?>
          <!--"DisconnectFromMOH"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DisconnectFromMOH&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="20" stubbed="0"/>
          </results>
        </action>
        <action id="20" plug-in="Pactolus.Branch.1" ><?xtml-editor x=83 y=829 ?>
          <!--Dial In?-->
          <results >
            <result name="Default" link="35" stubbed="0"/>
            <result name="g_strOutdialFlag = &quot;T&quot;;" link="36" stubbed="0" >g_strOutdialFlag match "T"</result>
          </results>
        </action>
        <action id="21" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=603 y=763 ?>
          <!--AddMemberToConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver" >
            <parameter >g_oMS</parameter>
            <parameter >g_oCallLegA</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="45" stubbed="0"/>
            <result name="FAILURE" link="28" stubbed="1" >f_nReturnCode == s_nFailure</result>
            <result name="CALLERHUNGUP" link="27" stubbed="1" >f_nReturnCode == s_nCallerHungup</result>
          </results>
        </action>
        <action id="22" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=621 y=1179 ?>
          <!--AddMemberToConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver" >
            <parameter >g_oMS</parameter>
            <parameter >g_oCallLegB</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="45" stubbed="1"/>
            <result name="FAILURE" link="28" stubbed="1" >f_nReturnCode == s_nFailure</result>
            <result name="CALLERHUNGUP" link="27" stubbed="0" >f_nReturnCode == s_nCallerHungup</result>
          </results>
        </action>
        <action id="24" plug-in="Standard.EndSession.1" ><?xtml-editor x=1356 y=758 ?></action>
        <action id="27" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=901 y=1172 ?>
          <!--"PartyLeave"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;PartyLeave&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="29" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nConfLeaveReason = 0;
Session.g_strConfLeaveMsg = "PARTY HANGUP WHILE TRYING TO ADD MEMBER TO CONFERENCE";]]></script>
          </scripts>
        </action>
        <action id="28" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=858 y=759 ?>
          <!--HangUp Caller-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpCaller&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="29" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 35;
Session.g_nConfLeaveReason = 9;
Session.g_strConfLeaveMsg = "FAIL TO ADD PARTY TO CONFERENCE";]]></script>
          </scripts>
        </action>
        <action id="29" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1101 y=760 ?>
          <!--FAILURE unhold a party-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="strTransactionId" message-name="s_strConfOffHoldResponse" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="s_nFailure"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
          </SOAP>
          <results >
            <result name="Default" link="24" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "FAILURE UNHOLD A PARTY";]]></script>
          </scripts>
        </action>
        <action id="30" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1509 y=431 ?>
          <!--"SetDTMFOn"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;SetDTMFOn&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="41" stubbed="0"/>
          </results>
        </action>
        <action id="33" plug-in="Pactolus.Branch.1" ><?xtml-editor x=582 y=313 ?>
          <!--in sub conf?-->
          <results >
            <result name="Default" link="50" stubbed="0"/>
            <result name="g_bCurrentlyInSubConf" link="52" stubbed="0" >g_bCurrentlyInSubConf == true</result>
          </results>
        </action>
        <action id="35" plug-in="Pactolus.Branch.1" ><?xtml-editor x=318 y=760 ?>
          <!--in sub conf?-->
          <results >
            <result name="Default" link="21" stubbed="0"/>
            <result name="g_bCurrentlyInSubConf" link="37" stubbed="0" >g_bCurrentlyInSubConf == true</result>
            <result name="g_bSideBarOperatorRequest" link="46" stubbed="0" >g_bSideBarOperatorRequest == true
AND g_bTalkingWithCSR == true</result>
          </results>
        </action>
        <action id="36" plug-in="Pactolus.Branch.1" ><?xtml-editor x=336 y=1225 ?>
          <!--in sub conf?-->
          <results >
            <result name="Default" link="22" stubbed="0"/>
            <result name="g_bCurrentlyInSubConf" link="38" stubbed="0" >g_bCurrentlyInSubConf == true</result>
            <result name="g_bSideBarOperatorRequest" link="47" stubbed="0" >g_bSideBarOperatorRequest == true
AND g_bTalkingWithCSR == true</result>
          </results>
        </action>
        <action id="37" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=615 y=889 ?>
          <!--AddMemberToConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver" >
            <parameter >g_oSubConfMS</parameter>
            <parameter >g_oCallLegA</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="5" stubbed="1"/>
            <result name="FAILURE" link="28" stubbed="1" >f_nReturnCode == s_nFailure</result>
            <result name="CALLERHUNGUP" link="27" stubbed="1" >f_nReturnCode == s_nCallerHungup</result>
          </results>
        </action>
        <action id="38" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=640 y=1334 ?>
          <!--AddMemberToConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver" >
            <parameter >g_oSubConfMS</parameter>
            <parameter >g_oCallLegB</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="5" stubbed="1"/>
            <result name="FAILURE" link="28" stubbed="1" >f_nReturnCode == s_nFailure</result>
            <result name="CALLERHUNGUP" link="27" stubbed="1" >f_nReturnCode == s_nCallerHungup</result>
          </results>
        </action>
        <action id="39" plug-in="Standard.Timer.1" ><?xtml-editor x=2439 y=397 ?>
          <!--ck reInvite timer-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lCkReInviteTimerIdA" duration="g_nCkReInviteTime"/>
          <results >
            <result name="Default" link="1" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bCkReInviteTimerFlagA = true;
Server.logInfo("SET TIMER TO CHECK FOR REINVITE A LEG");]]></script>
          </scripts>
        </action>
        <action id="40" plug-in="Standard.Timer.1" ><?xtml-editor x=2457 y=513 ?>
          <!--ck reInvite timer B-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lCkReInviteTimerIdB" duration="g_nCkReInviteTime"/>
          <results >
            <result name="Default" link="1" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bCkReInviteTimerFlagB = true;
Server.logInfo("SET TIMER TO CHECK FOR REINVITE B LEG");]]></script>
          </scripts>
        </action>
        <action id="41" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1732 y=436 ?>
          <results >
            <result name="Default" link="1" stubbed="1"/>
            <result name="Time &gt; 0" link="42" stubbed="0" >g_nCkReInviteTime &gt; 0</result>
          </results>
        </action>
        <action id="42" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1968 y=430 ?>
          <!--Dial In?-->
          <results >
            <result name="Default" link="43" stubbed="0"/>
            <result name="g_strOutdialFlag = &quot;T&quot;" link="44" stubbed="0" >g_strOutdialFlag match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("ConfOffHoldPartyRequest, RESET TIMER TO CHECK FOR REINVITE");]]></script>
          </scripts>
        </action>
        <action id="43" plug-in="Standard.Timer.1" ><?xtml-editor x=2210 y=397 ?>
          <!--stop ck reInvite timer-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="0" id="g_lCkReInviteTimerIdA" duration=""/>
          <results >
            <result name="Default" link="39" stubbed="0"/>
          </results>
        </action>
        <action id="44" plug-in="Standard.Timer.1" ><?xtml-editor x=2224 y=514 ?>
          <!--stop ck reInvite timer B-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="0" id="g_lCkReInviteTimerIdB" duration=""/>
          <results >
            <result name="Default" link="40" stubbed="0"/>
          </results>
        </action>
        <action id="45" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=806 y=666 ?>
          <!--ConfMSConnectionIDChangedNotify-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ConfMSConnectionIDChangedNotify&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="5" stubbed="1"/>
          </results>
        </action>
        <action id="46" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=620 y=1022 ?>
          <!--AddMemberToConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
            <parameter >g_oCallLegA</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="45" stubbed="1"/>
            <result name="FAILURE" link="28" stubbed="1" >f_nReturnCode == s_nFailure</result>
            <result name="CALLERHUNGUP" link="27" stubbed="1" >f_nReturnCode == s_nCallerHungup</result>
          </results>
        </action>
        <action id="47" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=644 y=1460 ?>
          <!--AddMemberToConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
            <parameter >g_oCallLegB</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="45" stubbed="1"/>
            <result name="FAILURE" link="28" stubbed="1" >f_nReturnCode == s_nFailure</result>
            <result name="CALLERHUNGUP" link="27" stubbed="1" >f_nReturnCode == s_nCallerHungup</result>
          </results>
        </action>
        <action id="48" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1056 y=543 ?>
          <!--"ChangeToDataMode"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ChangeToDataMode&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oSubConfMS</parameter>
          </function>
          <results >
            <result name="Default" link="4" stubbed="1"/>
            <result name="SUCCESS" link="5" stubbed="1" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)
{
	Server.logError("ERROR: FAIL TO CHANGE TO DATA MODE");
}]]></script>
          </scripts>
        </action>
        <action id="49" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1045 y=298 ?>
          <!--"ChangeToDataMode"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ChangeToDataMode&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="4" stubbed="0"/>
            <result name="SUCCESS" link="5" stubbed="1" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)
{
	Server.logError("ERROR: FAIL TO CHANGE TO DATA MODE");
}]]></script>
          </scripts>
        </action>
        <action id="50" plug-in="Pactolus.Branch.1" ><?xtml-editor x=808 y=218 ?>
          <!--mute?-->
          <results >
            <result name="Default" link="51" stubbed="0"/>
            <result name="g_bMutedState" link="49" stubbed="0" >g_bMutedState == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (true == Session.g_bMutedState)
{
	Session.g_oMS.bMuteFlag = true;
}
else
{
	Session.g_oMS.bMuteFlag = false;
}
Session.g_oMS.bDeafFlag = false;]]></script>
          </scripts>
        </action>
        <action id="51" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1033 y=189 ?>
          <!--"ChangeToConferenceMode"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ChangeToConferenceMode&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="4" stubbed="1"/>
            <result name="SUCCESS" link="5" stubbed="1" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)
{
	Server.logError("ERROR: FAIL TO CHANGE TO DATA MODE");
}]]></script>
          </scripts>
        </action>
        <action id="52" plug-in="Pactolus.Branch.1" ><?xtml-editor x=822 y=457 ?>
          <!--mute?-->
          <results >
            <result name="Default" link="53" stubbed="0"/>
            <result name="g_bMutedState" link="48" stubbed="0" >g_bMutedState == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (true == Session.g_bMutedState)
{
	Session.g_oSubConfMS.bMuteFlag = true;
}
else
{
	Session.g_oSubConfMS.bMuteFlag = false;
}
Session.g_oSubConfMS.bDeafFlag = false;]]></script>
          </scripts>
        </action>
        <action id="53" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1039 y=441 ?>
          <!--"ChangeToConferenceMode"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ChangeToConferenceMode&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oSubConfMS</parameter>
          </function>
          <results >
            <result name="Default" link="4" stubbed="1"/>
            <result name="SUCCESS" link="5" stubbed="1" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)
{
	Server.logError("ERROR: FAIL TO CHANGE TO DATA MODE");
}]]></script>
          </scripts>
        </action>
      </actions>
    </function>
    <function name="psAPISceInitConfOutdialSession" start="1" event="psAPISceInitConfOutdialSession" returns="i4" >
      <local-vars >
        <var name="f_nReturnCode" type="i4" >-50</var>
      </local-vars>
      <actions >
        <action id="1" plug-in="Pactolus.JavaStaticMethod.1" ><?xtml-editor x=194 y=452 ?>
          <!--"initConfSession()"-->
          <java xmlns="urn:www.pactolus.com:xtml:application" class="&quot;com.pactolus.conferencing.psAPISceInitConfSession&quot;" method="&quot;initConfOutdialSession&quot;" timeout="s_nTimeout" return="" method-return-var="f_nReturnCode" method-return-type="0" >
            <parameter type="inout" var-type="string" >g_strDBNAME</parameter>
            <parameter type="inout" var-type="string" >g_strACDControllerIP</parameter>
            <parameter type="inout" var-type="i4" >g_nACDControllerPort</parameter>
          </java>
          <results >
            <result name="Default" link="7" stubbed="0"/>
            <result name="Success" link="8" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: psAPISceInitConfOutdialSession");
Server.logInfo("INFO : *********JAVA CALLING INITIALIZE OUTDIAL CONF *********");]]></script>
            <script language="javascript" timing="last" ><![CDATA[Server.logInfo("INFO: ********** iJavaReturnCode " + Session.f_nReturnCode);

if (Result.id == 2)

{

	Server.logInfo("INFO: SUCCESS CALL INIT OUTDIAL CONF SESSION");

	if (-99 == Session.f_nReturnCode || -98 == Session.f_nReturnCode || -50 == Session.f_nReturnCode)
	{
		Session.g_nErrorMsgNumber = 1001; //db error
		Session.g_nTerminationReason = 39;
	}
	else if (-2 == Session.f_nReturnCode)

		Session.g_nErrorMsgNumber = 1002; //bad ani

	else if (-3 == Session.f_nReturnCode)

		Session.g_nErrorMsgNumber = 1003; //no service provider

	else if (-4 == Session.f_nReturnCode)

		Session.g_nErrorMsgNumber = 1004; //service disable

	else if (-5 == Session.f_nReturnCode)

		Session.g_nErrorMsgNumber = 1009; //no acd settings

	else

		Session.g_nErrorMsgNumber = 0;

}	

else

{

	Server.logError("ERROR: FAIL TO CALL INIT OUTDIAL CONF SESSION, EXIT ON: " + Result.name);

	Session.g_nTerminationReason = 39;

	Session.g_nErrorMsgNumber = 1000; //jvm server error

}]]></script>
          </scripts>
        </action>
        <action id="3" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=711 y=686 ?>
          <!--return code from java-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nReturnCode"/>
        </action>
        <action id="4" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=669 y=342 ?>
          <!--FAILURE-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nFailure"/>
        </action>
        <action id="6" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=664 y=440 ?>
          <!--send ALARM-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="" transaction="" message-name="s_strSendAlarmRequest" destination-port="" destination-type="1" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;calling_number&quot;" value="g_strAlarmType"/>
            <parameter tag="&quot;called_number&quot;" value="g_strAlarmPriority"/>
          </SOAP>
          <results >
            <result name="Default" link="4" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strAlarmType = "JAVA: initConfSession";

Session.g_strAlarmPriority = "MAJOR";]]></script>
          </scripts>
        </action>
        <action id="7" plug-in="Pactolus.Branch.1" ><?xtml-editor x=450 y=341 ?>
          <!--s_strSendAlarmFlag==T-->
          <results >
            <result name="Default" link="4" stubbed="0"/>
            <result name="s_strSendAlarmFlag==T" link="6" stubbed="0" >s_strSendAlarmFlag match "T"</result>
          </results>
        </action>
        <action id="8" plug-in="Pactolus.Branch.1" ><?xtml-editor x=466 y=685 ?>
          <!---99 or -50 send alarm-->
          <results >
            <result name="Default" link="3" stubbed="0"/>
            <result name="returnCode==-99 or -50" link="7" stubbed="1" >f_nReturnCode == -50

OR f_nReturnCode == -99

OR f_nReturnCode == -98</result>
          </results>
        </action>
      </actions>
    </function>
    <function name="OnConfPlayPromptRequest" start="5" event="OnConfPlayPromptRequest" returns="void" >
      <parameters >
        <parameter name="strHost" type="string"/>
        <parameter name="nPort" type="i4"/>
        <parameter name="strTransactionId" type="string"/>
        <parameter name="nIndex" type="i4"/>
        <parameter name="strAllCallers" type="string"/>
      </parameters>
      <actions >
        <action id="5" plug-in="Pactolus.Branch.1" ><?xtml-editor x=134 y=280 ?>
          <!--To all callers?-->
          <results >
            <result name="Default" link="10" stubbed="0"/>
            <result name="strAllCallers==T" link="11" stubbed="0" >strAllCallers match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: OnConfPlayPromptRequest");
Server.logInfo("INFO: RECEIVE CONF PLAY PROMPT REQUEST FROM CONF CONTROLLER.");

Server.logInfo("INFO: Index to play: " + Session.nIndex);

Server.logInfo("INFO: To the whole conference: " + Session.strAllCallers);

Server.logInfo("INFO: TransactionId: " + Session.strTransactionId);

Server.logInfo("INFO: Conf Controller IP: " + Session.strHost);

Server.logInfo("INFO: Conf Controller Port: " + Session.nPort);]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=673 y=340 ?>
          <!--SUCCESS-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: SUCCESS PLAY PROMPT");]]></script>
          </scripts>
        </action>
        <action id="10" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=384 y=229 ?>
          <!--prompt to party-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >nIndex</audio>
          </play>
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="11" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=381 y=392 ?>
          <!--prompt to conference-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="&quot;*&quot;" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="1" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >nIndex</audio>
          </play>
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
      </actions>
    </function>
    <function name="OnResponse" start="9" event="OnResponse" returns="void" >
      <parameters >
        <parameter name="strAccept" type="string"/>
        <parameter name="strAcceptEncoding" type="string"/>
        <parameter name="strAcceptLanguage" type="string"/>
        <parameter name="strAlertInfo" type="string" pass="byref"/>
        <parameter name="strAllow" type="string" pass="byref"/>
        <parameter name="strAllowEvents" type="string" pass="byref"/>
        <parameter name="strCallId" type="string"/>
        <parameter name="strCallInfo" type="string" pass="byref"/>
        <parameter name="strContact" type="string"/>
        <parameter name="strContent" type="string"/>
        <parameter name="strContentDisposition" type="string"/>
        <parameter name="strContentEncoding" type="string" pass="byref"/>
        <parameter name="strContentLanguage" type="string" pass="byref"/>
        <parameter name="strContentType" type="string"/>
        <parameter name="strCSeq" type="string"/>
        <parameter name="strDate" type="string"/>
        <parameter name="strEncryption" type="string"/>
        <parameter name="strErrorInfo" type="string" pass="byref"/>
        <parameter name="strFrom" type="string"/>
        <parameter name="strInReplyTo" type="string"/>
        <parameter name="strMIMEVersion" type="string" pass="byref"/>
        <parameter name="strMinSE" type="string" pass="byref"/>
        <parameter name="strOrganization" type="string" pass="byref"/>
        <parameter name="strPriority" type="string" pass="byref"/>
        <parameter name="strProxyAuthenticate" type="string"/>
        <parameter name="strRecordRoute" type="string"/>
        <parameter name="strRemotePartyID" type="string" pass="byref"/>
        <parameter name="strRequire" type="string" pass="byref"/>
        <parameter name="strRetryAfter" type="string" pass="byref"/>
        <parameter name="strRSeq" type="string" pass="byref"/>
        <parameter name="strServer" type="string" pass="byref"/>
        <parameter name="strSessionExpires" type="string" pass="byref"/>
        <parameter name="strStatus" type="string" pass="byref"/>
        <parameter name="strSubscriptionState" type="string" pass="byref"/>
        <parameter name="strSupported" type="string" pass="byref"/>
        <parameter name="strTimestamp" type="string" pass="byref"/>
        <parameter name="strTo" type="string" pass="byref"/>
        <parameter name="strUnsupported" type="string" pass="byref"/>
        <parameter name="strUserAgent" type="string" pass="byref"/>
        <parameter name="strVia" type="string" pass="byref"/>
        <parameter name="strWarning" type="string" pass="byref"/>
        <parameter name="strWWWAuthenticate" type="string" pass="byref"/>
      </parameters>
      <local-vars >
        <var name="f_bNullString" type="boolean" >0</var>
      </local-vars>
      <actions >
        <action id="9" plug-in="Pactolus.Branch.1" ><?xtml-editor x=94 y=163 ?>
          <!--response for INVITE?-->
          <results >
            <result name="Default" link="8" stubbed="0"/>
            <result name="INVITE?" link="16" stubbed="0" >strCSeq match "INVITE"

AND g_bWebDialOut == true

AND f_bNullString == false</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: OnResponse");
if ( (Session.g_strConfControllerIP.length <= 0)||(0 == Session.g_nConfControllerPort) )

{

	Session.f_bNullString = true;

}

else

{

	Session.f_bNullString = false;

}]]></script>
          </scripts>
        </action>
        <action id="1" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1095 y=221 ?>
          <!--FAILURE to add a call party-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="g_strResponseTransactionId" message-name="s_strConfAddResponse" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="-1"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
            <parameter tag="&quot;dialOutRequestId&quot;" value="g_lDialOutRequestId"/>
            <parameter tag="&quot;SIPCallId&quot;" value="g_oCallLegB.strCallId"/>
          </SOAP>
          <results >
            <result name="Default" link="8" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "OUTDIAL: TRYING";]]></script>
          </scripts>
        </action>
        <action id="3" plug-in="Pactolus.Branch.1" ><?xtml-editor x=725 y=291 ?>
          <!--what is the status?-->
          <results >
            <result name="Default" link="1" stubbed="0"/>
            <result name="18? == in progress" link="4" stubbed="0" >strStatus match "18"</result>
            <result name="200 == OK" link="5" stubbed="0" >strStatus match "200"</result>
            <result name="408 == timeout" link="6" stubbed="0" >strStatus match "408"</result>
            <result name="486 == busy here" link="7" stubbed="0" >strStatus match "486"</result>
          </results>
        </action>
        <action id="4" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1111 y=370 ?>
          <!--Ringing-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="g_strResponseTransactionId" message-name="s_strConfAddResponse" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="180"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
            <parameter tag="&quot;dialOutRequestId&quot;" value="g_lDialOutRequestId"/>
            <parameter tag="&quot;SIPCallId&quot;" value="g_oCallLegB.strCallId"/>
          </SOAP>
          <results >
            <result name="Default" link="8" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "OUTDIAL: RINGING";]]></script>
          </scripts>
        </action>
        <action id="5" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1116 y=523 ?>
          <!--Connected-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="g_strResponseTransactionId" message-name="s_strConfAddResponse" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="200"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
            <parameter tag="&quot;dialOutRequestId&quot;" value="g_lDialOutRequestId"/>
            <parameter tag="&quot;SIPCallId&quot;" value="g_oCallLegB.strCallId"/>
          </SOAP>
          <results >
            <result name="Default" link="8" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "OUTDIAL: CONNECTED";]]></script>
          </scripts>
        </action>
        <action id="6" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1117 y=668 ?>
          <!--No answer-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="g_strResponseTransactionId" message-name="s_strConfAddResponse" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="408"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
            <parameter tag="&quot;dialOutRequestId&quot;" value="g_lDialOutRequestId"/>
            <parameter tag="&quot;SIPCallId&quot;" value="g_oCallLegB.strCallId"/>
          </SOAP>
          <results >
            <result name="Default" link="8" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "OUTDIAL: NO ANSWER";]]></script>
          </scripts>
        </action>
        <action id="7" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1109 y=808 ?>
          <!--Busy-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="g_strResponseTransactionId" message-name="s_strConfAddResponse" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="486"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
            <parameter tag="&quot;dialOutRequestId&quot;" value="g_lDialOutRequestId"/>
            <parameter tag="&quot;SIPCallId&quot;" value="g_oCallLegB.strCallId"/>
          </SOAP>
          <results >
            <result name="Default" link="8" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "OUTDIAL: BUSY";]]></script>
          </scripts>
        </action>
        <action id="8" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=347 y=142 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
        </action>
        <action id="10" plug-in="Pactolus.Branch.1" ><?xtml-editor x=738 y=1077 ?>
          <!--what is the status?-->
          <results >
            <result name="Default" link="15" stubbed="0"/>
            <result name="18? == in progress" link="11" stubbed="0" >strStatus match "18"</result>
            <result name="200 == OK" link="12" stubbed="0" >strStatus match "200"</result>
            <result name="408 == timeout" link="13" stubbed="0" >strStatus match "408"</result>
            <result name="486 == busy here" link="14" stubbed="0" >strStatus match "486"</result>
          </results>
        </action>
        <action id="11" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1124 y=1156 ?>
          <!--Ringing-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="g_strResponseTransactionId" message-name="s_strConfAddResponse" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="180"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
            <parameter tag="&quot;dialOutRequestId&quot;" value="g_lDialOutRequestId"/>
            <parameter tag="&quot;SIPCallId&quot;" value="g_oCallLegB.strCallId"/>
          </SOAP>
          <results >
            <result name="Default" link="8" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "OUTDIAL: RINGING";]]></script>
          </scripts>
        </action>
        <action id="12" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1129 y=1309 ?>
          <!--Connected-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="g_strResponseTransactionId" message-name="s_strConfAddResponse" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="200"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
            <parameter tag="&quot;dialOutRequestId&quot;" value="g_lDialOutRequestId"/>
            <parameter tag="&quot;SIPCallId&quot;" value="g_oCallLegB.strCallId"/>
          </SOAP>
          <results >
            <result name="Default" link="8" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "OUTDIAL: CONNECTED";]]></script>
          </scripts>
        </action>
        <action id="13" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1130 y=1454 ?>
          <!--No answer-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="g_strResponseTransactionId" message-name="s_strConfAddResponse" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="408"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
            <parameter tag="&quot;dialOutRequestId&quot;" value="g_lDialOutRequestId"/>
            <parameter tag="&quot;SIPCallId&quot;" value="g_oCallLegB.strCallId"/>
          </SOAP>
          <results >
            <result name="Default" link="8" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "OUTDIAL: NO ANSWER";]]></script>
          </scripts>
        </action>
        <action id="14" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1122 y=1594 ?>
          <!--Busy-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="g_strResponseTransactionId" message-name="s_strConfAddResponse" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="486"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
            <parameter tag="&quot;dialOutRequestId&quot;" value="g_lDialOutRequestId"/>
            <parameter tag="&quot;SIPCallId&quot;" value="g_oCallLegB.strCallId"/>
          </SOAP>
          <results >
            <result name="Default" link="8" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "OUTDIAL: BUSY";]]></script>
          </scripts>
        </action>
        <action id="15" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1108 y=1007 ?>
          <!--FAILURE to add a call party-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="g_strResponseTransactionId" message-name="s_strConfAddResponse" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="-1"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
            <parameter tag="&quot;dialOutRequestId&quot;" value="g_lDialOutRequestId"/>
            <parameter tag="&quot;SIPCallId&quot;" value="g_oCallLegB.strCallId"/>
          </SOAP>
          <results >
            <result name="Default" link="8" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "OUTDIAL: TRYING";]]></script>
          </scripts>
        </action>
        <action id="16" plug-in="Pactolus.Branch.1" ><?xtml-editor x=459 y=671 ?>
          <!--ThirdParty dialout?-->
          <results >
            <result name="Default" link="3" stubbed="0"/>
            <result name="g_bThirdPartyDialOut" link="10" stubbed="0" >g_bThirdPartyDialOut == true</result>
          </results>
        </action>
      </actions>
    </function>
    <function name="psAPISceConfCount" start="1" event="psAPISceConfCount" returns="i4" >
      <local-vars >
        <var name="f_nReturnCode" type="i4" >-50</var>
      </local-vars>
      <actions >
        <action id="1" plug-in="Pactolus.JavaStaticMethod.1" ><?xtml-editor x=241 y=210 ?>
          <!--getPartyCount()-->
          <java xmlns="urn:www.pactolus.com:xtml:application" class="&quot;com.pactolus.conferencing.psAPISceConfCount&quot;" method="&quot;getPartyCount&quot;" timeout="s_nTimeout" return="" method-return-var="f_nReturnCode" method-return-type="0" >
            <parameter type="in" var-type="string" >g_strDBNAME</parameter>
            <parameter type="in" var-type="string" >g_strSessionId</parameter>
            <parameter type="in" var-type="string" >g_strConfEventId</parameter>
            <parameter type="inout" var-type="i4" >g_nCurrentNbrCallegs</parameter>
          </java>
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="Success" link="3" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: psAPISceConfCount");
Server.logInfo("INFO: ********JAVA CALLING getPartyCount *********");

Server.logInfo("INFO: BEFORE DB name = " + Session.g_strDBNAME);

Server.logInfo("INFO: BEFORE session Id = " + Session.g_strSessionId);

Server.logInfo("INFO: BEFORE conf event Id = " + Session.g_strConfEventId);

]]></script>
            <script language="javascript" timing="last" ><![CDATA[Server.logInfo("INFO: ********** iJavaReturnCode " + Session.f_nReturnCode);

if (Result.id == 2)

{

	Server.logInfo("INFO: SUCCESS GET CURRENT NUMBER OF CALL LEGS.");

	Server.logInfo("INFO: Current number of callegs in the conference = " + Session.g_nCurrentNbrCallegs);

	if (-99 == Session.f_nReturnCode)
	{
		Session.g_nErrorMsgNumber = 1001; //db error
		Session.g_nTerminationReason = 39;
	}
	else if (-2 == Session.f_nReturnCode)

		Session.g_nErrorMsgNumber = 4011; //conf not found

	else

		Session.g_nErrorMsgNumber = 0;

}

else

{

	Server.logError("ERROR: FAIL TO GET CURRENT NUMBER OF CALL LEGS, EXIT ON: " + Result.name);

	Session.g_nTerminationReason = 39;

	Session.g_nErrorMsgNumber = 1000; //jvm server error

}]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=551 y=193 ?>
          <!--FAILURE-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nFailure"/>
        </action>
        <action id="3" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=560 y=284 ?>
          <!--return code from java-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nReturnCode"/>
        </action>
      </actions>
    </function>
    <function name="WaitForModerator" start="11" event="WaitForModerator" returns="i4" >
      <local-vars >
        <var name="f_nReturnCode" type="i4" >-1</var>
      </local-vars>
      <actions >
        <action id="11" plug-in="Pactolus.Branch.1" ><?xtml-editor x=145 y=99 ?>
          <!--g_nMaxCallerHoldTime > 0?-->
          <results >
            <result name="Default" link="29" stubbed="0"/>
            <result name="g_nMaxCallerHoldTime &gt; 0" link="10" stubbed="0" >g_nMaxCallerHoldTime &gt; 0</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: WaitForModerator");
Session.g_nCallerCurrentState = Session.s_nStateWaitForMod;

js_disable_event();]]></script>
          </scripts>
        </action>
        <action id="1" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=611 y=455 ?>
          <!--WaitForModerator, Please hold-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >897</audio>
            <audio type="index" >898</audio>
          </play>
          <results >
            <result name="Default" link="13" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="3" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=864 y=59 ?>
          <!--s_nStateEndCall-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nStateEndCall"/>
        </action>
        <action id="4" plug-in="Standard.Timer.1" ><?xtml-editor x=1160 y=521 ?>
          <!--set max wait time

WFM-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lWFMTimerId" duration="g_nMaxCallerHoldTime"/>
          <results >
            <result name="Default" link="5" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bTimerSet = true;]]></script>
          </scripts>
        </action>
        <action id="5" plug-in="Standard.Timer.1" ><?xtml-editor x=1419 y=517 ?>
          <!--play please hold every 10 secs-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lHoldTimerId" duration="s_nSleepTime"/>
          <results >
            <result name="Default" link="6" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bHoldTimerFlag = true;]]></script>
          </scripts>
        </action>
        <action id="6" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1664 y=514 ?>
          <!--s_nStateWait-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nStateWait"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="7" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=620 y=56 ?>
          <!--Hang up caller-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpCaller&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="3" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 22;]]></script>
          </scripts>
        </action>
        <action id="10" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=404 y=285 ?>
          <!--party join to conf controller

put caller in queue-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;PartyJoin&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="1" stubbed="0"/>
            <result name="WFM = F" link="42" stubbed="0" >g_bWaitForModerator == false</result>
          </results>
        </action>
        <action id="13" plug-in="Pactolus.Branch.1" ><?xtml-editor x=881 y=513 ?>
          <!--MOH?-->
          <results >
            <result name="Default" link="4" stubbed="0"/>
            <result name="g_strMusicOnHoldFlag==&quot;T&quot;" link="16" stubbed="0" >g_strMusicOnHoldFlag match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_lHoldWFMStartTime = Server.getUTCTime();]]></script>
          </scripts>
        </action>
        <action id="16" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=589 y=723 ?>
          <!--Delete MS Connection-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DeleteMSConnection&quot;" return="" external-function="1" library="lib_mediaserver" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="37" stubbed="0"/>
          </results>
        </action>
        <action id="29" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=388 y=57 ?>
          <!--Mod has not joined-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >897</audio>
            <audio type="index" >899</audio>
          </play>
          <results >
            <result name="Default" link="7" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="37" plug-in="Standard.Timer.1" ><?xtml-editor x=832 y=716 ?>
          <!--5 secs to connect MOH-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lMOHTimerId" duration="s_nPreMohTime"/>
          <results >
            <result name="Default" link="6" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bMOHTimerFlag = true;]]></script>
          </scripts>
        </action>
        <action id="39" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1164 y=717 ?>
          <!--Please hold-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >898</audio>
          </play>
          <results >
            <result name="Default" link="6" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="40" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=897 y=278 ?>
          <!--s_nNonFirstCaller-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nNonFirstCaller"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_oMS.strConferenceId = Session.g_strConfResource

js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="42" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=643 y=278 ?>
          <!--Delete MS Connection-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DeleteMSConnection&quot;" return="" external-function="1" library="lib_mediaserver" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="40" stubbed="0"/>
          </results>
        </action>
      </actions>
    </function>
    <function name="OnModeratorJoinRequest" start="44" event="OnModeratorJoinRequest" returns="void" >
      <parameters >
        <parameter name="strHost" type="string"/>
        <parameter name="strPort" type="string"/>
        <parameter name="strTransactionId" type="string"/>
        <parameter name="strConferenceResource" type="string"/>
        <parameter name="lConnectTime" type="i8"/>
        <parameter name="strMutedParty" type="string"/>
      </parameters>
      <local-vars >
        <var name="f_nReturnCode" type="i4" >-1</var>
        <var name="f_bNullString" type="boolean" >0</var>
        <var name="f_strConfControllerIP" type="string" ></var>
        <var name="f_nConfControllerPort" type="i4" >0</var>
        <var name="f_strTransactionId" type="string" ></var>
        <var name="f_strReturnMsg" type="string" ></var>
      </local-vars>
      <actions >
        <action id="44" plug-in="Pactolus.Branch.1" ><?xtml-editor x=366 y=201 ?>
          <!--WFM?-->
          <results >
            <result name="Default" link="45" stubbed="0"/>
            <result name="WFM == true" link="1" stubbed="0" >g_bWaitForModerator == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: OnModeratorJoinRequest");
js_disable_event();

if ("T" == Session.strMutedParty)

{

	Session.g_bMuteThisParty = true;

}

else

{

	Session.g_bMuteThisParty = false;

}]]></script>
          </scripts>
        </action>
        <action id="1" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=674 y=281 ?>
          <!--stop timers-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;StopTimer&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="29" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: RECEIVE MODERATOR JOIN REQUEST FROM CONF CONTROLLER.");

Server.logInfo("INFO: Conf Controller IP: " + Session.strHost);

Server.logInfo("INFO: Conf Controller Port: " + Session.strPort);

Server.logInfo("INFO: TransactionId: " + Session.strTransactionId);

Server.logInfo("INFO: Conference Resource: " + Session.strConferenceResource);

Session.g_lMSConnectTime = Session.lConnectTime;

Session.g_bWaitForModerator = false;]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=105 y=472 ?>
          <!--Delete MS Connection-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DeleteMSConnection&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="75" stubbed="0"/>
            <result name="SUCCESS" link="69" stubbed="0" >f_nReturnCode == s_nSuccess</result>
          </results>
        </action>
        <action id="3" plug-in="Pactolus.Branch.1" ><?xtml-editor x=593 y=681 ?>
          <!--set conference resource-->
          <results >
            <result name="Default" link="36" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: Moderator joined the conference.");

Server.logInfo("INFO: Conference resource is: " + Session.strConferenceResource);

Session.g_oMS.strConferenceId = Session.strConferenceResource;

Session.g_strConfResource = Session.strConferenceResource;]]></script>
          </scripts>
        </action>
        <action id="10" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1395 y=655 ?>
          <!--HangUp Caller-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpCaller&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="27" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 35;
Session.g_nConfLeaveReason = 9;
Session.g_strConfLeaveMsg = "FAIL TO ADD PARTY TO CONFERENCE";]]></script>
          </scripts>
        </action>
        <action id="16" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1404 y=802 ?>
          <!--END THE CALL-->
          <results >
            <result name="Default" link="27" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logError("ERROR: FAIL TO ADD WFM INTO CONFERENCE.");

Session.g_nTerminationReason = 1;]]></script>
          </scripts>
        </action>
        <action id="20" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1153 y=234 ?>
          <!--play join as ???-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;PlayJoinAsPrompt&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="2" stubbed="0"/>
          </results>
        </action>
        <action id="24" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1068 y=668 ?>
          <!--AddMemberAToConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
            <parameter >g_oCallLegA</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="70" stubbed="1"/>
            <result name="FAILURE" link="10" stubbed="0" >f_nReturnCode == s_nFailure</result>
            <result name="CALLER HUNG UP" link="16" stubbed="0" >f_nReturnCode == s_nCallerHungup</result>
          </results>
        </action>
        <action id="25" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=805 y=1108 ?>
          <!--Play Join Tone to conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;PlayPromptToConference&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
            <parameter >g_strLanguage</parameter>
            <parameter >s_nPromptArrivalTone</parameter>
          </function>
          <results >
            <result name="Default" link="43" stubbed="1"/>
          </results>
        </action>
        <action id="27" plug-in="Standard.EndSession.1" ><?xtml-editor x=1619 y=805 ?></action>
        <action id="28" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1775 y=951 ?>
          <!--set DTMF Detection ON-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;SetDTMFOn&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="50" stubbed="0"/>
          </results>
        </action>
        <action id="29" plug-in="Pactolus.Branch.1" ><?xtml-editor x=909 y=277 ?>
          <!--in MOH-->
          <results >
            <result name="Default" link="20" stubbed="0"/>
            <result name="ConnectToMOH==true" link="30" stubbed="0" >g_bConnectToMOH == true</result>
          </results>
        </action>
        <action id="30" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1166 y=381 ?>
          <!--"DisconnectFromMOH"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DisconnectFromMOH&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="10" stubbed="1"/>
            <result name="SUCCESS" link="69" stubbed="1" >f_nReturnCode == s_nSuccess</result>
          </results>
        </action>
        <action id="32" plug-in="Pactolus.Branch.1" ><?xtml-editor x=498 y=963 ?>
          <!--play tone or name?-->
          <results >
            <result name="Default" link="43" stubbed="0"/>
            <result name="play tone - 1" link="25" stubbed="0" >g_nArriveDepartOption == 1</result>
            <result name="play name - 3" link="40" stubbed="0" >g_nArriveDepartOption == 3</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_lMSConnectTime = Server.getUTCTime();]]></script>
          </scripts>
        </action>
        <action id="33" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1025 y=1221 ?>
          <!--xxx has joined-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="&quot;*&quot;" endpoint="g_oMS.strConferenceId" callid="g_oMS.strCallId" repeat="1" timeout="8" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="url" >g_strCallerRecordedName</audio>
            <audio type="index" >938</audio>
          </play>
          <results >
            <result name="Default" link="43" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="36" plug-in="Pactolus.Branch.1" ><?xtml-editor x=827 y=676 ?>
          <!--Dial In?-->
          <results >
            <result name="Default" link="24" stubbed="0"/>
            <result name="g_strOutdialFlag = &quot;T&quot;;" link="37" stubbed="0" >g_strOutdialFlag match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[// if (true == Session.g_bAnonymousCaller || true == Session.g_bMuteThisParty || "T" == Session.g_strMuteFlag)

if (true == Session.g_bAnonymousCaller || true == Session.g_bMuteThisParty)

{

	Session.g_oMS.bMuteFlag = true;

	Session.g_oMS.bDeafFlag = false;

	Session.g_bMutedState = true;

	Session.g_nPromptSelfMuteUnMute = 908;
	
	if ("T" == Session.g_strMuteFlag)
	{
		Session.g_bMutedByMod = true;
	}
	else
	{
		Session.g_bMutedByMod = false;
	}

	Server.logInfo("INFO: MODIFY MEMBER TO MUTED.");

}]]></script>
          </scripts>
        </action>
        <action id="37" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1084 y=823 ?>
          <!--AddMemberBToConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
            <parameter >g_oCallLegB</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="70" stubbed="1"/>
            <result name="FAILURE" link="10" stubbed="1" >f_nReturnCode == s_nFailure</result>
            <result name="CALLER HUNG UP" link="16" stubbed="1" >f_nReturnCode == s_nCallerHungup</result>
          </results>
        </action>
        <action id="40" plug-in="Pactolus.Branch.1" ><?xtml-editor x=800 y=1220 ?>
          <!--null string-->
          <results >
            <result name="Default" link="43" stubbed="1"/>
            <result name="f_bNullString == true" link="43" stubbed="1" >f_bNullString == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("RECORDED NAME LENGTH IS:  " + Session.g_strCallerRecordedName.length);

if (Session.g_strCallerRecordedName.length <= 1)

{

	Session.f_bNullString = true;

}

else

{

	Session.f_bNullString = false;

}]]></script>
          </scripts>
        </action>
        <action id="41" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1044 y=962 ?>
          <!--subscriber?-->
          <results >
            <result name="Default" link="55" stubbed="1"/>
            <result name="g_strIsSubscriberFlag== &quot;T&quot;" link="42" stubbed="0" >g_strIsSubscriberFlag match "T"</result>
          </results>
        </action>
        <action id="42" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1300 y=961 ?>
          <!--GetAndPlayBalance-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;GetAndPlayBalance&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="55" stubbed="0"/>
          </results>
        </action>
        <action id="43" plug-in="Pactolus.Branch.1" ><?xtml-editor x=787 y=963 ?>
          <!--prepaid conference-->
          <results >
            <result name="Default" link="55" stubbed="1"/>
            <result name="billing type == 1?" link="41" stubbed="0" >g_nBillingType == 1</result>
          </results>
        </action>
        <action id="45" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=655 y=173 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="48" plug-in="Standard.Timer.1" ><?xtml-editor x=2495 y=1050 ?>
          <!--ck reInvite timer-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lCkReInviteTimerIdB" duration="g_nCkReInviteTime"/>
          <results >
            <result name="Default" link="45" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[//Session.g_lLastReInviteTime = Server.getUTCTime();

Session.g_bCkReInviteTimerFlagB = true;]]></script>
          </scripts>
        </action>
        <action id="49" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2256 y=1054 ?>
          <results >
            <result name="Default" link="48" stubbed="0"/>
            <result name="session timer == T|| Time==0" link="45" stubbed="1" >s_strSessionTimerFlag match "T"

OR g_nCkReInviteTime == 0</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nCkReInviteTime = Session.g_oCallLegB.nSessionTimer;]]></script>
          </scripts>
        </action>
        <action id="50" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2011 y=950 ?>
          <!--Dial In?-->
          <results >
            <result name="Default" link="52" stubbed="0"/>
            <result name="g_strOutdialFlag = &quot;T&quot;;" link="49" stubbed="0" >g_strOutdialFlag match "T"</result>
          </results>
        </action>
        <action id="51" plug-in="Standard.Timer.1" ><?xtml-editor x=2477 y=898 ?>
          <!--ck reInvite timer-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lCkReInviteTimerIdA" duration="g_nCkReInviteTime"/>
          <results >
            <result name="Default" link="45" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[//Session.g_lLastReInviteTime = Server.getUTCTime();

Session.g_bCkReInviteTimerFlagA = true;]]></script>
          </scripts>
        </action>
        <action id="52" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2238 y=902 ?>
          <results >
            <result name="Default" link="51" stubbed="0"/>
            <result name="session timer == T|| Time==0" link="45" stubbed="1" >s_strSessionTimerFlag match "T"

OR g_nCkReInviteTime == 0</result>
          </results>
        </action>
        <action id="53" plug-in="Pactolus.Branch.1" ><?xtml-editor x=276 y=968 ?>
          <!--anonymous caller?-->
          <results >
            <result name="Default" link="32" stubbed="0"/>
            <result name="g_bAnonymousCaller" link="43" stubbed="1" >g_bAnonymousCaller == true</result>
          </results>
        </action>
        <action id="55" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1525 y=957 ?>
          <!--muted?-->
          <results >
            <result name="Default" link="28" stubbed="0"/>
            <result name="g_bMuteThisParty" link="77" stubbed="0" >g_bMuteThisParty == true</result>
          </results>
        </action>
        <action id="56" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=2485 y=1300 ?>
          <!--UnmutePartyRequest-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="s_strUnmutePartyRequest" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;callerPassCode&quot;" value="g_strCCGeneratedPassCode"/>
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="59" stubbed="0"/>
            <result name="Success" link="57" stubbed="0"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_disable_event();

Server.logInfo("INFO: **** UNMUTE PARTY REQUEST ****");]]></script>
          </scripts>
        </action>
        <action id="57" plug-in="Standard.WaitEvent.1" ><?xtml-editor x=2718 y=1438 ?>
          <!--UnmutePartyResponse-->
          <wait xmlns="urn:www.pactolus.com:xtml:communication" timeout="5" recv-name="g_strEventReceived" >
            <msg name="UnmutePartyResponse" >
              <parameter >f_strConfControllerIP</parameter>
              <parameter >f_nConfControllerPort</parameter>
              <parameter >f_strTransactionId</parameter>
              <parameter >f_nReturnCode</parameter>
              <parameter >f_strReturnMsg</parameter>
            </msg>
          </wait>
          <results >
            <result name="Default" link="59" stubbed="1"/>
            <result name="Success" link="58" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_nReturnCode = -1;]]></script>
            <script language="javascript" timing="last" ><![CDATA[js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="58" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2951 y=1436 ?>
          <!--success?-->
          <results >
            <result name="Default" link="59" stubbed="1"/>
            <result name="f_nReturnCode == 0" link="62" stubbed="0" >f_nReturnCode == 0</result>
          </results>
        </action>
        <action id="59" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2703 y=1299 ?>
          <!--can't unmute-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >933</audio>
          </play>
          <results >
            <result name="Default" link="28" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="60" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2265 y=1193 ?>
          <!--CallPartyFlag==T?-->
          <results >
            <result name="Default" link="66" stubbed="0"/>
            <result name="g_strPartyPasscodeFlag==T" link="56" stubbed="0" >g_strPartyPasscodeFlag match "T"</result>
          </results>
        </action>
        <action id="61" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=3203 y=1699 ?>
          <!--SELF UNMUTE PARTY-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="g_strResponseTransactionId" message-name="s_strConfUnmutePartyEvent" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;callerPassCode&quot;" value="g_strCCGeneratedPassCode"/>
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="63" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: **** SELF UNMUTE ****");]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)

{

	Server.logError("ERROR: FAIL TO SEND SOAP MESSAGE UNMUTE YOUR OWN LINE.");

}]]></script>
          </scripts>
        </action>
        <action id="62" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=3184 y=1432 ?>
          <!--"ChangeToConferenceMode"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ChangeToConferenceMode&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="59" stubbed="1"/>
            <result name="SUCCESS" link="64" stubbed="0" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: MODIFY MEMBER TO UNMUTE.");

Session.g_oMS.bMuteFlag = false;]]></script>
          </scripts>
        </action>
        <action id="63" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=3449 y=1695 ?>
          <!--your line unmuted-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >s_nPromptUnmuted</audio>
          </play>
          <results >
            <result name="Default" link="28" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nPromptSelfMuteUnMute = 907;

Session.g_bMutedState = false;]]></script>
          </scripts>
        </action>
        <action id="64" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2941 y=1584 ?>
          <!--CallPartyFlag==T?-->
          <results >
            <result name="Default" link="65" stubbed="0"/>
            <result name="g_strPartyPasscodeFlag==T" link="61" stubbed="0" >g_strPartyPasscodeFlag match "T"</result>
          </results>
        </action>
        <action id="65" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=3184 y=1566 ?>
          <!--SELF UNMUTE PARTY-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="g_strResponseTransactionId" message-name="s_strConfUnmutePartyEvent" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;callerPassCode&quot;" value="g_strCCGeneratedPassCode"/>
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="63" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: **** SELF UNMUTE ****");]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)

{

	Server.logError("ERROR: FAIL TO SEND SOAP MESSAGE UNMUTE YOUR OWN LINE.");

}]]></script>
          </scripts>
        </action>
        <action id="66" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=2469 y=1149 ?>
          <!--UnmutePartyRequest-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="s_strUnmutePartyRequest" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;callerPassCode&quot;" value="g_strCCGeneratedPassCode"/>
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="59" stubbed="1"/>
            <result name="Success" link="57" stubbed="1"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_disable_event();

Server.logInfo("INFO: **** UNMUTE PARTY REQUEST ****");]]></script>
          </scripts>
        </action>
        <action id="67" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1797 y=1203 ?>
          <!--your line has been muted-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="6" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;(*1)&quot;" language="g_strLanguage" digits="g_strUnmuteDigits" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >900</audio>
            <audio type="index" >355</audio>
            <audio type="index" >908</audio>
          </play>
          <results >
            <result name="Default" link="28" stubbed="1"/>
            <result name="Success" link="68" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="68" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2037 y=1200 ?>
          <!--what digit?-->
          <results >
            <result name="Default" link="28" stubbed="1"/>
            <result name="*6" link="60" stubbed="0" >g_strUnmuteDigits match "^\*{1}6{1}$"</result>
          </results>
        </action>
        <action id="69" plug-in="Pactolus.Branch.1" ><?xtml-editor x=362 y=686 ?>
          <results >
            <result name="Default" link="3" stubbed="0"/>
            <result name="f_bNullString" link="76" stubbed="0" >f_bNullString == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (Session.strConferenceResource.length > 0)
{
	Session.f_bNullString = false;
}
else
{
	Session.f_bNullString = true;
	Server.logError("MOD JOINED CONF, BUT NO CONFERENCE ENDPOINT");
}
]]></script>
          </scripts>
        </action>
        <action id="70" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=52 y=979 ?>
          <!--ConfMSConnectionIDChangedNotify-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ConfMSConnectionIDChangedNotify&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="53" stubbed="0"/>
          </results>
        </action>
        <action id="71" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1555 y=1262 ?>
          <!--ModMutedThisParty?-->
          <results >
            <result name="Default" link="67" stubbed="0"/>
            <result name="g_strModeratorMutedFlag" link="72" stubbed="0" >g_strModeratorMutedFlag match "T"
OR g_strMuteFlag match "T"</result>
          </results>
        </action>
        <action id="72" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1816 y=1388 ?>
          <!--your line has been muted-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="6" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;(*1)&quot;" language="g_strLanguage" digits="g_strUnmuteDigits" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >900</audio>
          </play>
          <results >
            <result name="Default" link="28" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="75" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=350 y=464 ?>
          <!--HangUp Caller-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpCaller&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="27" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 40;
Session.g_nConfLeaveReason = 14;
Session.g_strConfLeaveMsg = "FAIL TO TO DELETE MS CONNECTION";]]></script>
          </scripts>
        </action>
        <action id="76" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=600 y=773 ?>
          <!--HangUp Caller-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpCaller&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="27" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 39;
Session.g_nConfLeaveReason = 15;
Session.g_strConfLeaveMsg = "OnModeratorJoin NO CONFERENCE ENDPOINT";]]></script>
          </scripts>
        </action>
        <action id="77" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1779 y=1061 ?>
          <!--event base conf?-->
          <results >
            <result name="Default" link="71" stubbed="1"/>
            <result name="g_nDnisIdentifiedConfFlag == 1" link="28" stubbed="1" >g_nDnisIdentifiedConfFlag == 1</result>
          </results>
        </action>
      </actions>
    </function>
    <function name="PlayJoinAsPrompt" start="8" event="PlayJoinAsPrompt" returns="i4" >
      <actions >
        <action id="8" plug-in="Pactolus.Branch.1" ><?xtml-editor x=134 y=259 ?>
          <!--event base conf?-->
          <results >
            <result name="Default" link="5" stubbed="0"/>
            <result name="g_nDnisIdentifiedConfFlag == 1" link="2" stubbed="1" >g_nDnisIdentifiedConfFlag == 1
OR g_bTransferParty == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: PlayJoinAsPrompt");]]></script>
          </scripts>
        </action>
        <action id="1" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=652 y=185 ?>
          <!--join as participant-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="0" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >864</audio>
            <audio type="index" >865</audio>
          </play>
          <results >
            <result name="Default" link="6" stubbed="0"/>
            <result name="Success" link="2" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="2" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=925 y=266 ?>
          <!--s_nSuccess-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nSuccess"/>
        </action>
        <action id="4" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=662 y=372 ?>
          <!--join as moderator-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="0" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >864</audio>
            <audio type="index" >866</audio>
          </play>
          <results >
            <result name="Default" link="6" stubbed="1"/>
            <result name="Success" link="2" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="5" plug-in="Pactolus.Branch.1" ><?xtml-editor x=381 y=257 ?>
          <!--Moderator?-->
          <results >
            <result name="Default" link="1" stubbed="0"/>
            <result name="Moderator==T" link="4" stubbed="0" >g_strModeratorFlag match "T"</result>
          </results>
        </action>
        <action id="6" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=910 y=181 ?>
          <!--s_nFailure-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nFailure"/>
        </action>
        <action id="7" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=666 y=553 ?>
          <!--join as moderator-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >864</audio>
            <audio type="index" >866</audio>
          </play>
          <results >
            <result name="Default" link="6" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
      </actions>
    </function>
    <function name="psAPISceConfAuthDest" start="3" event="psAPISceConfAuthDest" returns="i4" >
      <local-vars >
        <var name="f_nReturnCode" type="i4" >-50</var>
      </local-vars>
      <actions >
        <action id="3" plug-in="Pactolus.JavaStaticMethod.1" ><?xtml-editor x=163 y=123 ?>
          <!--authorizeDestination-->
          <java xmlns="urn:www.pactolus.com:xtml:application" class="&quot;com.pactolus.conferencing.psAPISceConfAuthDest&quot;" method="&quot;authorizeDestination&quot;" timeout="s_nTimeout" return="" method-return-var="f_nReturnCode" method-return-type="0" >
            <parameter type="in" var-type="string" >g_strDBNAME</parameter>
            <parameter type="in" var-type="string" >g_strSessionId</parameter>
            <parameter type="in" var-type="string" >s_strApplicationName</parameter>
            <parameter type="in" var-type="string" >g_strTranslatedDestNbr</parameter>
            <parameter type="in" var-type="i8" >g_lServiceProviderId</parameter>
            <parameter type="in" var-type="i4" >g_nServiceId</parameter>
            <parameter type="in" var-type="i4" >g_nDialPlanId</parameter>
            <parameter type="in" var-type="string" >g_strConfEventId</parameter>
            <parameter type="in" var-type="string" >g_strHomeCallingCode</parameter>
            <parameter type="in" var-type="i4" >g_nHomeCountryId</parameter>
            <parameter type="inout" var-type="string" >g_strOutdialDestNbr</parameter>
            <parameter type="inout" var-type="i4" >g_nDestCountryId</parameter>
            <parameter type="inout" var-type="string" >g_strDestDomIntlFlag</parameter>
            <parameter type="inout" var-type="string" >g_strDestAreaCode</parameter>
            <parameter type="inout" var-type="string" >g_strDestCallingCountryCode</parameter>
          </java>
          <results >
            <result name="Default" link="1" stubbed="0"/>
            <result name="Success" link="2" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: psAPISceConfAuthDest");
Session.g_strSIPStatus = Session.g_strSIPStatus.toString();

Server.logInfo("INFO: *********JAVA CALLING AuthorizeDestination *********");

Server.logInfo("INFO: BEFORE DB name = " + Session.g_strDBNAME);

Server.logInfo("INFO: BEFORE session Id = " + Session.g_strSessionId);

Server.logInfo("INFO: BEFORE application name = " + Session.s_strApplicationName);

Server.logInfo("INFO: BEFORE destination number = " + Session.g_strTranslatedDestNbr);

Server.logInfo("INFO: BEFORE service provider Id = " + Session.g_lServiceProviderId);

Server.logInfo("INFO: BEFORE serverice Id = " + Session.g_nServiceId);

Server.logInfo("INFO: BEFORE dial plan Id = " + Session.g_nDialPlanId);

Server.logInfo("INFO: BEFORE conference event Id = " + Session.g_strConfEventId);

Server.logInfo("INFO: BEFORE outdial destination number = " + Session.g_strOutdialDestNbr);

Server.logInfo("INFO: BEFORE destination country Id = " + Session.g_nDestCountryId);

Server.logInfo("INFO: BEFORE destination international flag = " + Session.g_strDestDomIntlFlag);

Server.logInfo("INFO: BEFORE destination area code = " + Session.g_strDestAreaCode);

Server.logInfo("INFO: BEFORE destination dialing code = " + Session.g_strDestCallingCountryCode);

]]></script>
            <script language="javascript" timing="last" ><![CDATA[Server.logInfo("INFO: ********* iJavaReturnCode " + Session.f_nReturnCode);

if (Result.id == 2)

{

	switch (Session.f_nReturnCode)

	{

		case -99:

		case -50:

			Session.g_nErrorMsgNumber = 1001; //db error
			Session.g_nTerminationReason = 39;

			break;

		case -1:

			Session.g_nErrorMsgNumber = 1007; //restricted dest

			break;

		case -2:

			Session.g_nErrorMsgNumber = 1008; //insufficient digits

			break;

		case -3:

			Session.g_nErrorMsgNumber = 4004; //max attendees

			break;

		default:

			Session.g_nErrorMsgNumber = 0;

			break;

	}

}

else

{

	Server.logError("ERROR: FAIL TO VALIDATE DESTINATION, EXIT ON: " + Result.name);

	Session.g_nTerminationReason = 39;

	Session.g_nErrorMsgNumber = 1000; //jvm server error

}]]></script>
          </scripts>
        </action>
        <action id="1" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=473 y=106 ?>
          <!--FAILURE-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nFailure"/>
        </action>
        <action id="2" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=482 y=197 ?>
          <!--return code from java

hard code time avail-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nReturnCode"/>
        </action>
      </actions>
    </function>
    <function name="OnConfPlayWarningPromptRequest" start="5" event="OnConfPlayWarningPromptRequest" returns="void" >
      <parameters >
        <parameter name="strConfControllerIP" type="string"/>
        <parameter name="nConfControllerPort" type="i4"/>
        <parameter name="strTransactionId" type="string"/>
        <parameter name="nTimeRemainingMinutes" type="i4"/>
        <parameter name="nTimeRemainingSeconds" type="i4"/>
      </parameters>
      <actions >
        <action id="5" plug-in="Pactolus.Sleep.1" ><?xtml-editor x=269 y=281 ?>
          <!--1 sec-->
          <sleep xmlns="urn:www.pactolus.com:xtml:application" duration="1"/>
          <results >
            <result name="Default" link="3" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: OnConfPlayWarningPromptRequest");]]></script>
          </scripts>
        </action>
        <action id="1" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=815 y=490 ?>
          <!--play a prompt to all callers-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="0" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="number" >nTimeRemainingMinutes</audio>
            <audio type="index" >309</audio>
          </play>
          <results >
            <result name="Default" link="2" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="2" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=797 y=218 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
        </action>
        <action id="3" plug-in="Pactolus.Branch.1" ><?xtml-editor x=543 y=277 ?>
          <!--minutes == ?-->
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="1 minute" link="4" stubbed="0" >nTimeRemainingMinutes == 1</result>
            <result name="2 or more minute" link="1" stubbed="0" >nTimeRemainingMinutes &gt; 1</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: RECEIVE CONF PLAY WARNING PROMPT REQUEST.");

Server.logInfo("INFO: Minute: " + Session.nTimeRemainingMinutes);

Server.logInfo("INFO: Second: " + Session.nTimeRemainingSeconds);

Server.logInfo("INFO: TransactionId: " + Session.strTransactionId);

Server.logInfo("INFO: Conf Controller IP: " + Session.strConfControllerIP);

Server.logInfo("INFO: Conf Controller Port: " + Session.nConfControllerPort);]]></script>
          </scripts>
        </action>
        <action id="4" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=821 y=336 ?>
          <!--play a prompt to all callers-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="0" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="number" >nTimeRemainingMinutes</audio>
            <audio type="index" >308</audio>
          </play>
          <results >
            <result name="Default" link="2" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
      </actions>
    </function>
    <function name="OnConfFunctionsStateChangeNotify" start="2" event="OnConfFunctionsStateChangeNotify" returns="void" >
      <parameters >
        <parameter name="strConfControllerIP" type="string"/>
        <parameter name="nConfControllerPort" type="i4"/>
        <parameter name="strTransactionId" type="string"/>
        <parameter name="strThirdPartyConferenceId" type="string"/>
        <parameter name="strConferenceId" type="string"/>
        <parameter name="bLockedState" type="boolean"/>
        <parameter name="bMutedState" type="boolean"/>
        <parameter name="bContinuesState" type="boolean"/>
        <parameter name="bRecordingState" type="boolean"/>
        <parameter name="bQandAEnabledState" type="boolean"/>
        <parameter name="bEventStarted" type="boolean"/>
        <parameter name="bSpeakersSubConferenceActive" type="boolean"/>
        <parameter name="bGlobalMusicOn" type="boolean"/>
        <parameter name="bLastLegConferenceExpired" type="boolean"/>
      </parameters>
      <actions >
        <action id="2" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=95 y=115 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: OnConfFunctionStateChangeNotify");
js_disable_event();

Server.logInfo("INFO: RECEIVE STATE CHANGE FROM CONFERENCE CONTROLLER.");
Server.logInfo("INFO: Conference Id: " + Session.strConferenceId);
Server.logInfo("INFO: Third Party Conference Id: " + Session.strThirdPartyConferenceId);
Server.logInfo("INFO: bContinuesState: " + Session.bContinuesState);
Server.logInfo("INFO: bLockedState:  " + Session.bLockedState);
Server.logInfo("INFO: bMutedState: " + Session.bMutedState);
Server.logInfo("INFO: bQandAEnabledState: " + Session.bRecordingState);
Server.logInfo("INFO: bRecordingState: " + Session.bQandAEnabledState);
Server.logInfo("INFO: bEventStarted: " + Session.bEventStarted);
Server.logInfo("INFO: bSpeakersSubConferenceActive: " + Session.bSpeakersSubConferenceActive);
Server.logInfo("INFO: bGlobalMusicOn: " + Session.bGlobalMusicOn);
Server.logInfo("INFO: bLastLegConferenceExpired: " + Session.bLastLegConferenceExpired);
Server.logInfo("INFO: TransactionId: " + Session.strTransactionId);
Server.logInfo("INFO: Conf Controller IP: " + Session.strConfControllerIP);
Server.logInfo("INFO: Conf Controller Port: " + Session.nConfControllerPort);

if ("locked" == Session.strFunctionName && "true" == Session.strNewState)
if (Session.bLockedState)
{
	Server.logInfo("Conference currently lock, set prompt to unlock");
	Session.g_nPromptLockUnLock = 858;
}
else if (!Session.bLockedState)
{
	Server.logInfo("Conference currently unlock, set prompt to lock");
	Session.g_nPromptLockUnLock = 857;
}

if (Session.bMutedState)
{
	Server.logInfo("Conference currently muted, set prompt to unmute");
	Session.g_nPromptMuteUnMute = 860;
}
else if (!Session.bMutedState)
{
	Server.logInfo("Conference currently unmuted, set prompt to mute");
	Session.g_nPromptMuteUnMute = 859;
}

if (Session.bContinuesState)
{
	Server.logInfo("Conference currently continue without moderator, set prompt to discontinue");
	Session.g_nPromptAllowDisallow = 902;
	Session.g_strConfContinueNoMod = "T";
}
else if (!Session.bContinuesState)
{
	Server.logInfo("Conference currently discontinue without moderator, set prompt to continue");
	Session.g_nPromptAllowDisallow = 901;
	Session.g_strConfContinueNoMod = "F";
}

if (Session.bRecordingState)
{
	Server.logInfo("Conference currently recording, set prompt to stop recording");
	Session.g_nPROMPT_CONF_RECORD = 952;
}
else if (!Session.bRecordingState)
{
	Server.logInfo("Conference currently not recording, set prompt to start recording");
	Session.g_nPROMPT_CONF_RECORD = 953;
}

Server.logInfo("Allow self mute unmute flag is: " + Session.bSelfMuteUnmuteOn);
Session.g_bAllowSelfMuteUnmuteFlag = Session.bSelfMuteUnmuteOn;
js_enable_event();]]></script>
          </scripts>
        </action>
      </actions>
    </function>
    <function name="NonModMainMenu" start="88" event="NonModMainMenu" returns="void" >
      <local-vars >
        <var name="f_strDigit" type="string" ></var>
        <var name="f_nReturnCode" type="i4" >-1</var>
        <var name="f_strConfControllerIP" type="string" ></var>
        <var name="f_nConfControllerPort" type="i4" >0</var>
        <var name="f_strTransactionId" type="string" ></var>
        <var name="f_strReturnMsg" type="string" ></var>
        <var name="f_bRequestedCSR" type="boolean" >0</var>
        <var name="f_strConfScheduleId" type="string" ></var>
        <var name="f_nTimeout" type="i4" >0</var>
        <var name="f_nPromptPress" type="i4" >311</var>
      </local-vars>
      <actions >
        <action id="88" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=113 y=104 ?>
          <!--"ChangeToDataMode"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ChangeToDataMode&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="74" stubbed="0"/>
            <result name="SUCCESS" link="128" stubbed="0" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: NonModMainMenu");

Session.g_oMS.bMuteFlag = true;

Session.g_oMS.bDeafFlag = true;

Server.logInfo("INFO: NON MOD MAIN MENU MODIFY MEMBER REMOVE FROM CONFERENCE.");]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Pactolus.Branch.1" ><?xtml-editor x=131 y=718 ?>
          <results >
            <result name="Default" link="149" stubbed="1"/>
            <result name="1-count party" link="148" stubbed="1" >f_strDigit match "1"</result>
            <result name="2-mute/unmute" link="79" stubbed="1" >f_strDigit match "2"</result>
            <result name="3-main menu" link="16" stubbed="0" >f_strDigit match "3"</result>
            <result name="*-return to conf" link="76" stubbed="1" >f_strDigit match "\*"</result>
          </results>
        </action>
        <action id="16" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=422 y=653 ?>
          <!--what to do?-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="30" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;(x|*|#)&quot;" language="g_strLanguage" digits="f_strDigit" retry-count="3" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >518</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >320</audio>
            <audio type="index" >905</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >311</audio>
            <audio type="index" >862</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >312</audio>
            <audio type="index" >g_nPromptSelfMuteUnMute</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >313</audio>
            <audio type="index" >906</audio>
            <timeout-prompt type="index" >s_nPromptNoResponse</timeout-prompt>
          </play>
          <results >
            <result name="Default" link="76" stubbed="1"/>
            <result name="Success" link="2" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout" link="150" stubbed="1"/>
          </results>
        </action>
        <action id="21" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=439 y=820 ?>
          <!--count call legs-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceConfCount&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="76" stubbed="1"/>
            <result name="NbrCallLeg == 1" link="22" stubbed="0" >g_nCurrentNbrCallegs == 1</result>
            <result name="NbrCallLeg &gt; 1" link="71" stubbed="0" >g_nCurrentNbrCallegs &gt; 1</result>
          </results>
        </action>
        <action id="22" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=723 y=771 ?>
          <!--number of call legs-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >925</audio>
            <audio type="number" >g_nCurrentNbrCallegs</audio>
            <audio type="index" >927</audio>
            <audio type="index" >929</audio>
          </play>
          <results >
            <result name="Default" link="76" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="54" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=892 y=2451 ?>
          <!--HangUp Caller-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpCaller&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="95" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 38;
Session.g_nConfLeaveReason = 6;
Session.g_strConfLeaveMsg = "FAIL TO MODIFY CONFERENCE";]]></script>
          </scripts>
        </action>
        <action id="71" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=736 y=949 ?>
          <!--number of call legs-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >926</audio>
            <audio type="number" >g_nCurrentNbrCallegs</audio>
            <audio type="index" >928</audio>
            <audio type="index" >929</audio>
          </play>
          <results >
            <result name="Default" link="76" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="74" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=343 y=98 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bCurrentlyInMMenu = false;]]></script>
          </scripts>
        </action>
        <action id="76" plug-in="Pactolus.Branch.1" ><?xtml-editor x=417 y=2472 ?>
          <!--mute state?-->
          <results >
            <result name="Default" link="92" stubbed="0"/>
            <result name="g_bMutedState" link="141" stubbed="0" >g_bMutedState == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("CURRENT MUTE STATE IS: " + Session.g_bMutedState);

Server.logInfo("CURRENT HOLD STATE IS: " + Session.g_bHoldState);

if (Session.g_bHoldState)

{

	Session.g_oMS.bMuteFlag = true;

	Session.g_oMS.bDeafFlag = true;

}

else if (Session.g_bMutedState)

{

	Session.g_oMS.bMuteFlag = true;

	Session.g_oMS.bDeafFlag = false;

}

else

{

	Session.g_oMS.bMuteFlag = false;

	Session.g_oMS.bDeafFlag = false;

}]]></script>
          </scripts>
        </action>
        <action id="79" plug-in="Pactolus.Branch.1" ><?xtml-editor x=392 y=1221 ?>
          <!--selfmute/unmute-->
          <results >
            <result name="Default" link="98" stubbed="0"/>
            <result name="self muted == 908" link="100" stubbed="0" >g_nPromptSelfMuteUnMute == 908</result>
          </results>
        </action>
        <action id="92" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=657 y=2452 ?>
          <!--"ChangeToConferenceMode"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ChangeToConferenceMode&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="54" stubbed="0"/>
            <result name="SUCCESS" link="74" stubbed="1" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: NON MOD MAIN MENU MODIFY MEMBER RETURN TO CONFERENCE.");]]></script>
          </scripts>
        </action>
        <action id="93" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=878 y=1069 ?>
          <!--SELF MUTE PARTY-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="s_strConfMutePartyEvent" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;callerPassCode&quot;" value="g_strCCGeneratedPassCode"/>
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="111" stubbed="1"/>
            <result name="Success" link="109" stubbed="0"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: **** SELF MUTE ****");]]></script>
          </scripts>
        </action>
        <action id="94" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1151 y=1371 ?>
          <!--SELF UNMUTE PARTY-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="s_strConfUnmutePartyEvent" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;callerPassCode&quot;" value="g_strCCGeneratedPassCode"/>
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="111" stubbed="1"/>
            <result name="Success" link="110" stubbed="0"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: **** SELF UNMUTE ****");]]></script>
          </scripts>
        </action>
        <action id="95" plug-in="Standard.EndSession.1" ><?xtml-editor x=1129 y=2447 ?></action>
        <action id="96" plug-in="Pactolus.Branch.1" ><?xtml-editor x=911 y=1433 ?>
          <!--CallPartyFlag==T?-->
          <results >
            <result name="Default" link="94" stubbed="0"/>
            <result name="g_strPartyPasscodeFlag==T" link="97" stubbed="0" >g_strPartyPasscodeFlag match "T"</result>
          </results>
        </action>
        <action id="97" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1167 y=1569 ?>
          <!--SELF UNMUTE PARTY-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="s_strConfUnmutePartyEvent" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;callerPassCode&quot;" value="g_strCCGeneratedPassCode"/>
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="111" stubbed="1"/>
            <result name="Success" link="110" stubbed="0"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: **** SELF UNMUTE ****");]]></script>
          </scripts>
        </action>
        <action id="98" plug-in="Pactolus.Branch.1" ><?xtml-editor x=616 y=1114 ?>
          <!--CallPartyFlag==T?-->
          <results >
            <result name="Default" link="93" stubbed="0"/>
            <result name="g_strPartyPasscodeFlag==T" link="99" stubbed="0" >g_strPartyPasscodeFlag match "T"</result>
          </results>
        </action>
        <action id="99" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=893 y=1222 ?>
          <!--SELF MUTE PARTY-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="s_strConfMutePartyEvent" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;callerPassCode&quot;" value="g_strCCGeneratedPassCode"/>
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="111" stubbed="1"/>
            <result name="Success" link="109" stubbed="0"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: **** SELF MUTE ****");]]></script>
          </scripts>
        </action>
        <action id="100" plug-in="Pactolus.Branch.1" ><?xtml-editor x=634 y=1574 ?>
          <!--Mute by mod?-->
          <results >
            <result name="Default" link="124" stubbed="1"/>
            <result name="mutedFlag==&quot;T&quot;" link="76" stubbed="1" >g_strMuteFlag match "T"</result>
            <result name="mutedbymod" link="111" stubbed="0" >g_bMutedByMod == true
OR g_strModeratorMutedFlag match "T"</result>
          </results>
        </action>
        <action id="109" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1159 y=1161 ?>
          <!--your line is muted-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >s_nPromptMuted</audio>
          </play>
          <results >
            <result name="Default" link="76" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nPromptSelfMuteUnMute = 908;

Session.g_bMutedState = true;

Server.logInfo("CURRENT MUTE STATE IS: " + Session.g_bMutedState);]]></script>
          </scripts>
        </action>
        <action id="110" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1416 y=1476 ?>
          <!--your line is unmuted-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >s_nPromptUnmuted</audio>
          </play>
          <results >
            <result name="Default" link="76" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nPromptSelfMuteUnMute = 907;

Session.g_bMutedState = false;

Server.logInfo("CURRENT MUTE STATE IS: " + Session.g_bMutedState);]]></script>
          </scripts>
        </action>
        <action id="111" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=920 y=1560 ?>
          <!--can't unmute-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >933</audio>
          </play>
          <results >
            <result name="Default" link="76" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="115" plug-in="Pactolus.Branch.1" ><?xtml-editor x=876 y=199 ?>
          <!--what digit?-->
          <results >
            <result name="Default" link="149" stubbed="0"/>
            <result name="1 Mute/Unmute Self" link="79" stubbed="1" >f_strDigit match "^1{1}$"</result>
            <result name="2 Participant Count" link="148" stubbed="1" >f_strDigit match "^2{1}$"</result>
            <result name="3 Main Menu" link="142" stubbed="1" >f_strDigit match "^3{1}$"</result>
            <result name="* Return to conf" link="76" stubbed="1" >f_strDigit match "^\*{1}$"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("Collected digits : " + Session.f_strDigit);
Server.logInfo("Terminated digit: " + Session.g_strTerminationDigit);]]></script>
            <script language="javascript" timing="last" ><![CDATA[Session.g_strTerminationDigit = "";]]></script>
          </scripts>
        </action>
        <action id="116" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=630 y=204 ?>
          <!--Main Menu no CSR-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="20" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;(00|99|*1|*5|*6|*8|*0|*#|**|##|x.T|*.T|#.T)&quot;" language="g_strLanguage" digits="f_strDigit" retry-count="" clear-digits="1" terminating-digit="g_strTerminationDigit" quick-collect="0" digit-timer="" >
            <audio type="index" >518</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >320</audio>
            <audio type="index" >905</audio>
            <audio type="silence" >.4</audio>
            <audio type="index" >f_nPromptPress</audio>
            <audio type="index" >g_nPromptSelfMuteUnMute</audio>
            <audio type="silence" >.4</audio>
            <audio type="index" >312</audio>
            <audio type="index" >862</audio>
            <audio type="silence" >.4</audio>
            <audio type="index" >313</audio>
            <audio type="index" >906</audio>
          </play>
          <results >
            <result name="Default" link="76" stubbed="1"/>
            <result name="Success" link="115" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout" link="150" stubbed="1"/>
          </results>
        </action>
        <action id="117" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=957 y=1938 ?>
          <!--UnmutePartyRequest-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="s_strUnmutePartyRequest" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;callerPassCode&quot;" value="g_strCCGeneratedPassCode"/>
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="120" stubbed="1"/>
            <result name="Success" link="118" stubbed="0"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_disable_event();

Server.logInfo("INFO: **** UNMUTE PARTY REQUEST ****");]]></script>
          </scripts>
        </action>
        <action id="118" plug-in="Standard.WaitEvent.1" ><?xtml-editor x=1204 y=1934 ?>
          <!--UnmutePartyResponse-->
          <wait xmlns="urn:www.pactolus.com:xtml:communication" timeout="5" recv-name="g_strEventReceived" >
            <msg name="UnmutePartyResponse" >
              <parameter >f_strConfControllerIP</parameter>
              <parameter >f_nConfControllerPort</parameter>
              <parameter >f_strTransactionId</parameter>
              <parameter >f_nReturnCode</parameter>
              <parameter >f_strReturnMsg</parameter>
            </msg>
          </wait>
          <results >
            <result name="Default" link="120" stubbed="1"/>
            <result name="Success" link="119" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_nReturnCode = -1;]]></script>
            <script language="javascript" timing="last" ><![CDATA[js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="119" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1441 y=1963 ?>
          <!--success?-->
          <results >
            <result name="Default" link="120" stubbed="0"/>
            <result name="f_nReturnCode == 0" link="122" stubbed="0" >f_nReturnCode == 0</result>
          </results>
        </action>
        <action id="120" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1686 y=1951 ?>
          <!--can't unmute-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >933</audio>
          </play>
          <results >
            <result name="Default" link="76" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="121" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=984 y=2273 ?>
          <!--SELF UNMUTE PARTY-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="g_strResponseTransactionId" message-name="s_strConfUnmutePartyEvent" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;callerPassCode&quot;" value="g_strCCGeneratedPassCode"/>
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="123" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: **** SELF UNMUTE ****");]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)

{

	Server.logError("ERROR: FAIL TO SEND SOAP MESSAGE UNMUTE YOUR OWN LINE.");

}]]></script>
          </scripts>
        </action>
        <action id="122" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=736 y=2102 ?>
          <!--"ChangeToConferenceMode"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ChangeToConferenceMode&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="120" stubbed="1"/>
            <result name="SUCCESS" link="126" stubbed="0" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: MODIFY MEMBER TO UNMUTE.");

Session.g_oMS.bMuteFlag = false;]]></script>
          </scripts>
        </action>
        <action id="123" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1239 y=2272 ?>
          <!--your line unmuted-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >s_nPromptUnmuted</audio>
          </play>
          <results >
            <result name="Default" link="76" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nPromptSelfMuteUnMute = 907;
Session.g_bMutedState = false;
Server.logInfo("CURRENT MUTE STATE IS: " + Session.g_bMutedState);]]></script>
          </scripts>
        </action>
        <action id="124" plug-in="Pactolus.Branch.1" ><?xtml-editor x=715 y=1824 ?>
          <!--CallPartyFlag==T?-->
          <results >
            <result name="Default" link="125" stubbed="0"/>
            <result name="g_strPartyPasscodeFlag==T" link="117" stubbed="0" >g_strPartyPasscodeFlag match "T"</result>
          </results>
        </action>
        <action id="125" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=941 y=1799 ?>
          <!--UnmutePartyRequest-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="s_strUnmutePartyRequest" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;callerPassCode&quot;" value="g_strCCGeneratedPassCode"/>
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="120" stubbed="1"/>
            <result name="Success" link="118" stubbed="1"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_disable_event();

Server.logInfo("INFO: **** UNMUTE PARTY REQUEST ****");]]></script>
          </scripts>
        </action>
        <action id="126" plug-in="Pactolus.Branch.1" ><?xtml-editor x=973 y=2100 ?>
          <!--CallPartyFlag==T?-->
          <results >
            <result name="Default" link="127" stubbed="0"/>
            <result name="g_strPartyPasscodeFlag==T" link="121" stubbed="0" >g_strPartyPasscodeFlag match "T"</result>
          </results>
        </action>
        <action id="127" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1216 y=2090 ?>
          <!--SELF UNMUTE PARTY-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="g_strResponseTransactionId" message-name="s_strConfUnmutePartyEvent" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;callerPassCode&quot;" value="g_strCCGeneratedPassCode"/>
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="123" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: **** SELF UNMUTE ****");]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)

{

	Server.logError("ERROR: FAIL TO SEND SOAP MESSAGE UNMUTE YOUR OWN LINE.");

}]]></script>
          </scripts>
        </action>
        <action id="128" plug-in="Pactolus.Branch.1" ><?xtml-editor x=360 y=208 ?>
          <!--operator assist type-->
          <results >
            <result name="Default" link="142" stubbed="0"/>
            <result name="type 1 and ACD enable" link="144" stubbed="0" >g_nOperatorAssistType == 1
AND g_strACDEnable match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if ("eng" == Session.g_strLanguage)
{
	if ( 1 == Session.g_nOperatorAssistType && "T" == Session.g_strACDEnable )
	{
		if ("T" == Session.g_strMuteFlag)
		{
			Session.f_nPromptPress = 99;
			Session.g_nPromptSelfMuteUnMute = 99;
			Session.f_nTimeout = 14;
		}
		else
		{
			Session.f_nTimeout = 18;
		}
	}
	else
	{
		if ("T" == Session.g_strMuteFlag)
		{
			Session.f_nPromptPress = 99;
			Session.g_nPromptSelfMuteUnMute = 99;
			Session.f_nTimeout = 10;
		}
		else
		{
			Session.f_nTimeout = 14;
		}	
	}
}
else
{
	if ( 1 == Session.g_nOperatorAssistType && "T" == Session.g_strACDEnable )
	{
		if ("T" == Session.g_strMuteFlag)
		{
			Session.f_nPromptPress = 99;
			Session.g_nPromptSelfMuteUnMute = 99;
			Session.f_nTimeout = 80;
		}
		else
		{
			Session.f_nTimeout = 84;
		}
	}
	else
	{
		if ("T" == Session.g_strMuteFlag)
		{
			Session.f_nPromptPress = 99;
			Session.g_nPromptSelfMuteUnMute = 99;
			Session.f_nTimeout = 60;
		}
		else
		{
			Session.f_nTimeout = 64;
		}	
	}
}]]></script>
          </scripts>
        </action>
        <action id="129" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1147 y=352 ?>
          <!--"SideBarOperatorRequest"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;SideBarOperatorRequest&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="76" stubbed="1"/>
            <result name="SUCCESS" link="76" stubbed="1" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_nReturnCode = -1;]]></script>
            <script language="javascript" timing="last" ><![CDATA[js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="130" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=650 y=354 ?>
          <!--Main Menu with CSR-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="80" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;(00|99|*1|*5|*6|*8|*0|*#|**|##|x.T|*.T|#.T)&quot;" language="g_strLanguage" digits="f_strDigit" retry-count="" clear-digits="1" terminating-digit="g_strTerminationDigit" quick-collect="0" digit-timer="" >
            <audio type="index" >518</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >320</audio>
            <audio type="index" >905</audio>
            <audio type="silence" >.4</audio>
            <audio type="index" >f_nPromptPress</audio>
            <audio type="index" >g_nPromptSelfMuteUnMute</audio>
            <audio type="silence" >.4</audio>
            <audio type="index" >312</audio>
            <audio type="index" >862</audio>
            <audio type="silence" >.4</audio>
            <audio type="index" >313</audio>
            <audio type="index" >906</audio>
            <audio type="silence" >.4</audio>
            <audio type="index" >966</audio>
            <audio type="index" >963</audio>
            <audio type="silence" >.4</audio>
            <audio type="index" >964</audio>
            <audio type="index" >962</audio>
          </play>
          <results >
            <result name="Default" link="76" stubbed="1"/>
            <result name="Success" link="131" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout" link="150" stubbed="1"/>
          </results>
        </action>
        <action id="131" plug-in="Pactolus.Branch.1" ><?xtml-editor x=886 y=352 ?>
          <!--what digit?-->
          <results >
            <result name="Default" link="149" stubbed="1"/>
            <result name="1 Mute/Unmute Self" link="79" stubbed="1" >f_strDigit match "^1{1}$"</result>
            <result name="2 Participant Count" link="148" stubbed="1" >f_strDigit match "^2{1}$"</result>
            <result name="3 Main Menu" link="144" stubbed="1" >f_strDigit match "^3{1}$"</result>
            <result name="00 CSR" link="76" stubbed="1" >f_strDigit match "^0{2}$"
AND g_bTalkingWithCSR == false
AND g_bWaitForCSR == false</result>
            <result name="*0 Private Talk CSR" link="129" stubbed="1" >f_strDigit match "^\*{1}0{1}$"
AND g_bTalkingWithCSR == false
AND g_bWaitForCSR == false</result>
            <result name="* Return to conf" link="76" stubbed="1" >f_strDigit match "^\*{1}$"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("Collected digits : " + Session.f_strDigit);
Server.logInfo("Terminated digit: " + Session.g_strTerminationDigit);]]></script>
            <script language="javascript" timing="last" ><![CDATA[Session.g_strTerminationDigit = "";
if (6 == Result.id)
{
	Session.g_nRequestCSRType = 1;
	Session.g_strRequestCSRPrivateTalkFlag = "T";
}
else if (5 == Result.id)
{
	Session.g_nRequestCSRType = 1;
	Session.g_strRequestCSRPrivateTalkFlag = "F";	
}]]></script>
          </scripts>
        </action>
        <action id="133" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1850 y=517 ?>
          <!--"CSRBeginRequest"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;CSRBeginRequest&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="134" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_disable_event();
Session.g_nCSRRouteReasonCode = 3;  //zero out
Session.g_strCSRRequestEndPoint = Session.g_oMS.strConferenceId;]]></script>
          </scripts>
        </action>
        <action id="134" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2083 y=506 ?>
          <!--success?-->
          <results >
            <result name="Default" link="135" stubbed="0"/>
            <result name="success?" link="76" stubbed="1" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (2 == Result.id)
{
	Session.g_nCallerCurrentState = Session.s_nStateZeroOutToCsr;
	Session.g_bZeroOutToCSR = true;
}
js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="135" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2336 y=502 ?>
          <!--could not complete transaction-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >363</audio>
          </play>
          <results >
            <result name="Default" link="136" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="136" plug-in="Standard.Timer.1" ><?xtml-editor x=2587 y=496 ?>
          <!--stop play beep-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="0" id="g_lBeepBeepTimerId" duration=""/>
          <results >
            <result name="Default" link="137" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bBeepBeepTimerFlag = false;]]></script>
          </scripts>
        </action>
        <action id="137" plug-in="Standard.Timer.1" ><?xtml-editor x=2838 y=493 ?>
          <!--stop max wait time for CSR-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="0" id="g_lWaitCSRTimerId" duration=""/>
          <results >
            <result name="Default" link="76" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bWaitCSRTimerSet = false;]]></script>
            <script language="javascript" timing="last" ><![CDATA[js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="138" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1149 y=515 ?>
          <!--CSR will join you shortly-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="0" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >1506</audio>
            <audio type="silence" >0.2</audio>
            <audio type="index" >340</audio>
          </play>
          <results >
            <result name="Default" link="139" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_bRequestedCSR = true;]]></script>
          </scripts>
        </action>
        <action id="139" plug-in="Standard.Timer.1" ><?xtml-editor x=1365 y=512 ?>
          <!--play beep  every 10 secs-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lBeepBeepTimerId" duration="s_nSleepTime"/>
          <results >
            <result name="Default" link="140" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bBeepBeepTimerFlag = true;]]></script>
          </scripts>
        </action>
        <action id="140" plug-in="Standard.Timer.1" ><?xtml-editor x=1613 y=516 ?>
          <!--set max wait time for CSR-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lWaitCSRTimerId" duration="s_nCsrHoldTime"/>
          <results >
            <result name="Default" link="133" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bWaitCSRTimerSet = true;]]></script>
          </scripts>
        </action>
        <action id="141" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=671 y=2573 ?>
          <!--"ChangeToMutedMode"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ChangeToMutedMode&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="54" stubbed="1"/>
            <result name="SUCCESS" link="92" stubbed="1" >f_nReturnCode == s_nSuccess</result>
          </results>
        </action>
        <action id="142" plug-in="Pactolus.Branch.1" ><?xtml-editor x=623 y=27 ?>
          <!--eng-->
          <results >
            <result name="Default" link="143" stubbed="0"/>
            <result name="g_strLanguage==eng" link="116" stubbed="0" >g_strLanguage match "eng"</result>
          </results>
        </action>
        <action id="143" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=832 y=18 ?>
          <!--Main Menu no CSR-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="60" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;(00|99|*1|*5|*6|*8|*0|*#|**|##|x.T|*.T|#.T)&quot;" language="g_strLanguage" digits="f_strDigit" retry-count="" clear-digits="1" terminating-digit="g_strTerminationDigit" quick-collect="0" digit-timer="" >
            <audio type="index" >518</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >320</audio>
            <audio type="index" >905</audio>
            <audio type="silence" >.4</audio>
            <audio type="index" >f_nPromptPress</audio>
            <audio type="index" >g_nPromptSelfMuteUnMute</audio>
            <audio type="silence" >.4</audio>
            <audio type="index" >312</audio>
            <audio type="index" >862</audio>
            <audio type="silence" >.4</audio>
            <audio type="index" >313</audio>
            <audio type="index" >906</audio>
          </play>
          <results >
            <result name="Default" link="76" stubbed="1"/>
            <result name="Success" link="115" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout" link="150" stubbed="1"/>
          </results>
        </action>
        <action id="144" plug-in="Pactolus.Branch.1" ><?xtml-editor x=324 y=368 ?>
          <!--eng-->
          <results >
            <result name="Default" link="130" stubbed="0"/>
            <result name="g_strLanguage==eng" link="145" stubbed="0" >g_strLanguage match "eng"</result>
          </results>
        </action>
        <action id="145" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=662 y=487 ?>
          <!--Main Menu with CSR-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="30" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;(00|99|*1|*5|*6|*8|*0|*#|**|##|x.T|*.T|#.T)&quot;" language="g_strLanguage" digits="f_strDigit" retry-count="" clear-digits="1" terminating-digit="g_strTerminationDigit" quick-collect="0" digit-timer="" >
            <audio type="index" >518</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >320</audio>
            <audio type="index" >905</audio>
            <audio type="silence" >.4</audio>
            <audio type="index" >f_nPromptPress</audio>
            <audio type="index" >g_nPromptSelfMuteUnMute</audio>
            <audio type="silence" >.4</audio>
            <audio type="index" >312</audio>
            <audio type="index" >862</audio>
            <audio type="silence" >.4</audio>
            <audio type="index" >313</audio>
            <audio type="index" >906</audio>
            <audio type="silence" >.4</audio>
            <audio type="index" >966</audio>
            <audio type="index" >963</audio>
            <audio type="silence" >.4</audio>
            <audio type="index" >964</audio>
            <audio type="index" >962</audio>
          </play>
          <results >
            <result name="Default" link="76" stubbed="1"/>
            <result name="Success" link="131" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout" link="150" stubbed="1"/>
          </results>
        </action>
        <action id="146" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1446 y=769 ?>
          <results >
            <result name="Default" link="76" stubbed="1"/>
            <result name="==1" link="22" stubbed="1" >g_nCurrentNbrCallegs == 1</result>
            <result name="&gt;=2" link="71" stubbed="1" >g_nCurrentNbrCallegs &gt;= 2</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.enableEvents(true);]]></script>
          </scripts>
        </action>
        <action id="147" plug-in="Standard.WaitEvent.1" ><?xtml-editor x=1227 y=771 ?>
          <!--ConfGetCallerCountResponse-->
          <wait xmlns="urn:www.pactolus.com:xtml:communication" timeout="5" recv-name="g_strEventReceived" >
            <msg name="ConfGetCallerCountResponse" >
              <parameter >f_strConfControllerIP</parameter>
              <parameter >f_nConfControllerPort</parameter>
              <parameter >f_strTransactionId</parameter>
              <parameter >f_strConfScheduleId</parameter>
              <parameter >g_nCurrentNbrCallegs</parameter>
            </msg>
          </wait>
          <results >
            <result name="Default" link="146" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nCurrentNbrCallegs = 0;]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)
{
	Server.logError("NO RESPONSE FOR ConfGetCallerCountRequest, exit on: " + Result.name);
}]]></script>
          </scripts>
        </action>
        <action id="148" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=982 y=777 ?>
          <!--ConfGetCallerCountRequest-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="s_strConfGetCallerCountRequest" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="76" stubbed="1"/>
            <result name="Success" link="147" stubbed="0"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.enableEvents(false);
Server.logInfo("INFO: **** ConfGetCallerCountRequest ****");]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)
{
	Server.logError("ERROR: FAIL TO SEND SOAP MESSAGE ConfGetCallerCountRequest.");
}]]></script>
          </scripts>
        </action>
        <action id="149" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1153 y=197 ?>
          <!--invalid choice-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >337</audio>
          </play>
          <results >
            <result name="Default" link="76" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="150" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=896 y=521 ?>
          <!--no response-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >552</audio>
          </play>
          <results >
            <result name="Default" link="76" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
      </actions>
    </function>
    <function name="psAPISceConfGetLastParty" start="1" event="psAPISceConfGetLastParty" returns="i4" >
      <local-vars >
        <var name="f_nReturnCode" type="i4" >-50</var>
      </local-vars>
      <actions >
        <action id="1" plug-in="Pactolus.JavaStaticMethod.1" ><?xtml-editor x=160 y=205 ?>
          <!--getLastParty()-->
          <java xmlns="urn:www.pactolus.com:xtml:application" class="&quot;com.pactolus.conferencing.psAPISceConfGetLastParty&quot;" method="&quot;getLastConfParty&quot;" timeout="s_nTimeout" return="" method-return-var="f_nReturnCode" method-return-type="0" >
            <parameter type="in" var-type="string" >g_strDBNAME</parameter>
            <parameter type="in" var-type="string" >g_strSessionId</parameter>
            <parameter type="in" var-type="string" >g_strConfEventId</parameter>
            <parameter type="inout" var-type="string" >g_strLastPartySessionId</parameter>
          </java>
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="Success" link="3" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: psAPISceConfGetLastParty");
Server.logInfo("INFO: ********JAVA CALLING getLastConfParty *********");

Server.logInfo("INFO: BEFORE DB name = " + Session.g_strDBNAME);

Server.logInfo("INFO: BEFORE session Id = " + Session.g_strSessionId);

Server.logInfo("INFO: BEFORE conf event Id = " + Session.g_strConfEventId);

]]></script>
            <script language="javascript" timing="last" ><![CDATA[Server.logInfo("INFO: ********** iJavaReturnCode " + Session.f_nReturnCode);

if (Result.id == 2)

{

	Server.logInfo("INFO: SUCCESS GET CURRENT NUMBER OF CALL LEGS.");

	Server.logInfo("INFO: Last Party session Id = " + Session.g_strLastPartySessionId);

	if (-99 == Session.f_nReturnCode)
	{
		Session.g_nErrorMsgNumber = 1001; //db error
		Session.g_nTerminationReason = 39;
	}
	else if (-2 == Session.f_nReturnCode)

		Session.g_nErrorMsgNumber = 4011; //conf not found

	else

		Session.g_nErrorMsgNumber = 0;

}

else

{

	Server.logError("ERROR: FAIL TO GET LAST PARTY SESSION Id, EXIT ON: " + Result.name);

	Session.g_nTerminationReason = 39;

	Session.g_nErrorMsgNumber = 1000; //jvm server error

}]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=470 y=188 ?>
          <!--FAILURE-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nFailure"/>
        </action>
        <action id="3" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=479 y=279 ?>
          <!--return code from java-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nReturnCode"/>
        </action>
      </actions>
    </function>
    <function name="OnServiceLoad" start="5" event="OnServiceLoad" returns="void" >
      <parameters >
        <parameter name="strAppName" type="string"/>
        <parameter name="nSessionCount" type="i2"/>
        <parameter name="nMaxIterations" type="i2"/>
        <parameter name="nServerId" type="i2"/>
      </parameters>
      <actions >
        <action id="5" plug-in="Pactolus.UserFunction.1" ><?xtml-editor x=88 y=60 ?>
          <!--GET PSX IP from config-->
          <user-function xmlns="urn:www.pactolus.com:xtml:application" process="&quot;PACTOLUS_ps_c_adaptor&quot;" function="&quot;get_property&quot;" timeout="s_nTimeout" return="" async="0" >
            <parameter >"primary-softswitch"</parameter>
            <parameter >s_strPrimaryPSX</parameter>
            <parameter >"backup-softswitch"</parameter>
            <parameter >s_strBackupPSX</parameter>
            <parameter >"use-softswitch-flag"</parameter>
            <parameter >s_strUseSoftswitchFlag</parameter>
            <parameter >"gateway-type"</parameter>
            <parameter >s_strGatewayType</parameter>
            <parameter >"appserver-logical-ip"</parameter>
            <parameter >s_strLocalHost</parameter>
            <parameter >"conference-default-ani"</parameter>
            <parameter >s_strDefaultAni</parameter>
            <parameter >"send-alarm-flag"</parameter>
            <parameter >s_strSendAlarmFlag</parameter>
            <parameter >"prepend-to-outdial"</parameter>
            <parameter >s_strDigitPrependToOutdial</parameter>
            <parameter >"packetization-period"</parameter>
            <parameter >s_nPacketizationPeriod</parameter>
            <parameter >"ms-connect-retry"</parameter>
            <parameter >s_strMSRetryFlag</parameter>
            <parameter >"outdial-dialing-plan"</parameter>
            <parameter >s_strOutdialDialingPlan</parameter>
            <parameter >"outdial-digit-map"</parameter>
            <parameter >s_strOutdialDigitMap</parameter>
            <parameter >"ring-no-answer-time"</parameter>
            <parameter >s_nRingNoAnswerTime</parameter>
            <parameter >"session-timer-enabled"</parameter>
            <parameter >s_strSessionTimerFlag</parameter>
            <parameter >"session-timer-interval"</parameter>
            <parameter >s_nSessionTimerInterval</parameter>
            <parameter >"max-retry-wait-conf-res"</parameter>
            <parameter >s_nMaxRetryWaitConfRes</parameter>
            <parameter >"ignore-pin-language"</parameter>
            <parameter >s_strIgnorePinLanguage</parameter>
            <parameter >"customer-code"</parameter>
            <parameter >s_strCustomerCode</parameter>
            <parameter >"vpn-dest-length"</parameter>
            <parameter >s_nVPN_DestLength</parameter>
            <parameter >"vpn-prepend"</parameter>
            <parameter >s_strVPNPrepend</parameter>
            <parameter >"default-country-code"</parameter>
            <parameter >s_strDefaultCountryCode</parameter>
            <parameter >"conference-start-call-delay"</parameter>
            <parameter >s_fConfStartCallDelay</parameter>
            <parameter >"conference-max-parties"</parameter>
            <parameter >s_nConferenceMaxParties</parameter>
            <parameter >"conference-max-talkers"</parameter>
            <parameter >s_nConferenceMaxTalkers</parameter>
            <parameter >"codec"</parameter>
            <parameter >s_strCodec</parameter>
            <parameter >"ivr-mediaserver-type"</parameter>
            <parameter >s_strIvrMsType</parameter>
            <parameter >"music-on-hold-mediaserver-type"</parameter>
            <parameter >s_strMohMsType</parameter>
            <parameter >"conferencing-media-server-type"</parameter>
            <parameter >s_strConfMsType</parameter>
            <parameter >"number-active-speaker-report"</parameter>
            <parameter >s_nNbrActiveSpeakers</parameter>
            <parameter >"asn-reporting-interval"</parameter>
            <parameter >s_nReportingInterval</parameter>
            <parameter >"asn-threshold-db"</parameter>
            <parameter >s_nDBThreshold</parameter>
            <parameter >"site-id"</parameter>
            <parameter >s_nSiteId</parameter>
            <parameter >"failover-codec"</parameter>
            <parameter >s_strFailoverCodec</parameter>
            <parameter >"load-test-mode"</parameter>
            <parameter >s_strLoadTestMode</parameter>
            <parameter >"use-486-failure-for-tollfree"</parameter>
            <parameter >s_strSend486</parameter>
            <parameter >"acd-play-bridge-tone"</parameter>
            <parameter >s_strPlayBridgeTone</parameter>
            <parameter >"moh-delay"</parameter>
            <parameter >s_nPreMohTime</parameter>
            <parameter >"max-moh-duration"</parameter>
            <parameter >s_nCsrHoldTime</parameter>
            <parameter >"target-agc-level-in"</parameter>
            <parameter >s_nAGCTargetLevelIn</parameter>
            <parameter >"max-agc-level-in"</parameter>
            <parameter >s_nAGCMaxLevelIn</parameter>
            <parameter >"target-agc-level-out"</parameter>
            <parameter >s_nAGCTargetLevelOut</parameter>
            <parameter >"max-agc-level-out"</parameter>
            <parameter >s_nAGCMaxLevelOut</parameter>
          </user-function>
          <results >
            <result name="Default" link="4" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: OnServiceLoad");
Session.s_strApplicationName = Session._appName;]]></script>
            <script language="javascript" timing="last" ><![CDATA[Server.logInfo("LOCAL HOST IP IS: " + Session.s_strLocalHost);
if (Session.s_strLocalHost.length <= 0)
{
	Session.s_strLocalHost = Server.ipAddress;
	Server.logInfo("WARNING:  NO SETTING FOR LOCAL HOST IP ADDRESS.  USE DEFAULT: " + Session.s_strLocalHost);
}
else
{
	Server.logInfo("LOCAL HOST IP BEFORE js_resolve_address IS: " + Session.s_strLocalHost);
		// this doesn't work now, platform issue
		// js_resolve_address(Session.s_strLocalHost);
	Server.logInfo("LOCAL HOST IP AFTER js_resolve_address IS: " + Session.s_strLocalHost);
}
Server.logInfo("LOCAL HOST IP IS: " + Session.s_strLocalHost);
if (Session.s_nPacketizationPeriod <= 0)
{
	Session.s_nPacketizationPeriod = 20;
	Server.logInfo("WARNING: NO SETTING FOR PACKETIZATION PERIOD.  USE DEFAULT: " + Session.s_nPacketizationPeriod);
}
if (Session.s_strOutdialDigitMap.length <= 0)
{
	Session.s_strOutdialDigitMap = "(1xxxxxxxxxx|[2-9]xxxxxxxxx|x.*|x.#|x.T|*)";
	Server.logInfo("WARNING: NO SETTING OUTDIAL DIGIT MAP.  USE DEFAULT: " + Session.s_strOutdialDigitMap);
}
if (Session.s_nRingNoAnswerTime <= 0)
{
	Session.s_nRingNoAnswerTime = 60;
	Server.logInfo("WARNING: NO SETTING RING NO ANSWER TIME.  USE DEFAULT: " + Session.s_nRingNoAnswerTime);
}
if (Session.s_strSessionTimerFlag.length <= 0 || "F" == Session.s_strSessionTimerFlag)
{
	Session.s_strSessionTimerFlag = "F";
	Server.logInfo("WARNING: NO SETTING FOR SESSION TIMER FLAG.  USE DEFAULT: F");
	Session.s_nSessionTimerInterval = 0;
	Server.logInfo("WARNING: NO SETTING SESSION TIMER INTERVAL.  USE DEFAULT: 0");
}
else
{
	if (Session.s_nSessionTimerInterval <= 0)
	{
		Session.s_nSessionTimerInterval = 120;
		Server.logInfo("WARNING: NO SETTING SESSION TIMER INTERVAL.  USE DEFAULT: 120");
	}
}
if (Session.s_strOutdialDialingPlan.length <= 0)
{
	Session.s_strOutdialDialingPlan = "1";
	Server.logInfo("WARNING: NO SETTING FOR DIALING PLAN.  USE DEFAULT: 1");
}
if (Session.s_nMaxRetryWaitConfRes <= 0)
{
	Session.s_nMaxRetryWaitConfRes = 10;
	Server.logInfo("WARNING: NO SETTING FOR MAX RETRY WAIT FOR CONF RESOURCE.  USE DEFAULT: 10");
}
if (Session.s_nConferenceMaxParties <= 0)
{
	Session.s_nConferenceMaxParties = 125;
	Server.logInfo("WARNING: NO SETTING CONFERENCE MAX PARTIES.  USE DEFAULT: 125");
}
if (Session.s_nConferenceMaxTalkers <= 0)
{
	Session.s_nConferenceMaxTalkers = 16;
	Server.logInfo("WARNING: NO SETTING CONFERENCE MAX TALKERS.  USE DEFAULT: 16");
}
if (Session.s_strCodec.length <= 0)
{
	Session.s_strCodec = "PCMU";
	Server.logInfo("WARNING: NO SETTING FOR CODEC.  USE DEFAULT: PCMU");
}
if (Session.s_strIvrMsType.length <= 0)
{
	Session.s_strIvrMsType = "CONV";
	Server.logInfo("WARNING: NO SETTING FOR s_strIvrMsType.  USE DEFAULT: CONV");
}
if (Session.s_strMohMsType.length <= 0)
{
	Session.s_strMohMsType = "CONV";
	Server.logInfo("WARNING: NO SETTING FOR s_strMohMsType.  USE DEFAULT: CONV");
}
if (Session.s_strConfMsType.length <= 0)
{
	Session.s_strConfMsType = "CONV";
	Server.logInfo("WARNING: NO SETTING FOR s_strConfMsType.  USE DEFAULT: CONV");
}
else
{
	Server.logInfo("CONF MS TYPE IS: " + Session.s_strConfMsType);
}
if (Session.s_nNbrActiveSpeakers <= 0)
{
	Session.s_nNbrActiveSpeakers = 3;
	Server.logInfo("WARNING: NO SETTING FOR s_NbrActiveSpeakers.  USE DEFAULT: 3");
}
if (Session.s_strFailoverCodec.length <= 0)
{
	Session.s_strFailoverCodec = "G.729";
	Server.logInfo("WARNING: NO SETTING FOR s_strFailoverCodec.length.  USE DEFAULT: G.729");
}
if (Session.s_fConfStartCallDelay <= 0)
{
	Session.s_fConfStartCallDelay = 0.1;
	Server.logInfo("WARNING: NO SETTING FOR s_fConfStartCallDelay.length.  USE DEFAULT: 0.1");
}
if (Session.s_strPlayBridgeTone.length <= 0)
{
	Session.s_strPlayBridgeTone = "T";
	Server.logError("WARNING: NO SETTING FOR DEFAULT PLAY BRIDGE TONE.  USE DEFAULT OF: " + Session.s_strPlayBridgeTone);
}
if (Session.s_nPreMohTime <= 0)
{
	Session.s_nPreMohTime = 5;
	Server.logInfo("WARNING: NO SETTING FOR s_nPreMohTime.  USE DEFAULT: 5");
}
if (Session.s_nCsrHoldTime <= 0)
{
	Session.s_nCsrHoldTime = 3600;
	Server.logInfo("WARNING: NO SETTING FOR s_nCsrHoldTime.  USE DEFAULT: 3600");
}]]></script>
          </scripts>
        </action>
        <action id="4" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=319 y=59 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
        </action>
      </actions>
      <text-objects >
        <text-object x-coord="130" y-coord="398" width="693" height="320" text="g_lStartTime:        first time hit the session

                    dial in: OnInvite

                    dial out: OnAddPartyRequest, OnIVRAddPartyRequest



g_lEndTime:        OnBye,  or OnRemovePartyRequest, or psAPIConfCallLegCompletion if &lt;= 0



g_lPartyJoinTime: PartyJoin: when send party join to conf controller



g_lOutdialStartTime: OnAddPartyRequest, OnIVRAddPartyRequest: time start outdial



g_lOutdialConnectTime: OnAddPartyRequest, OnIVRAddPartyRequest: time outdial party answer



g_lHoldWFMStartTime: WaitForModerator: time start wait for moderator



g_lMSConnectTime: Main, OnAddPartyRequest, OnIVRBridgePartyRequest:  time actually add to conference" font-name="Times New Roman" size="-16" red="0" green="0" blue="0" weight="0" underline="0" strikeout="0" point-size="12" italic="0"/>
      </text-objects>
    </function>
    <function name="ModMainMenu" start="102" event="ModMainMenu" returns="void" >
      <local-vars >
        <var name="f_strDigit" type="string" ></var>
        <var name="f_nReturnCode" type="i4" >-1</var>
        <var name="f_nCounter" type="i4" >0</var>
        <var name="f_strConfControllerIP" type="string" ></var>
        <var name="f_nConfControllerPort" type="i4" >0</var>
        <var name="f_strTransactionId" type="string" ></var>
        <var name="f_strReturnMsg" type="string" ></var>
        <var name="f_bNullString" type="boolean" >0</var>
        <var name="f_bRecordON" type="boolean" >0</var>
        <var name="f_bACDON" type="boolean" >0</var>
        <var name="f_bRequestedCSR" type="boolean" >0</var>
        <var name="f_bConfRecordON" type="boolean" >0</var>
        <var name="f_bThirdParty" type="boolean" >0</var>
        <var name="f_bModeratorFlag" type="boolean" >0</var>
        <var name="f_strConfScheduleId" type="string" ></var>
        <var name="f_nPromptOne" type="i4" >350</var>
        <var name="f_nPromptTwo" type="i4" >855</var>
        <var name="f_nTimeout" type="i4" >0</var>
        <var name="f_bModRequired" type="boolean" >0</var>
        <var name="f_nPromptAllowDisallow" type="i4" >99</var>
        <var name="f_nPromptPressX" type="i4" >0</var>
        <var name="f_nPromptWithoutMod" type="i4" >99</var>
        <var name="nPromptExtConfBy" type="i4" >861</var>
        <var name="nPrompt30" type="i4" >22</var>
        <var name="nPromptMinutes" type="i4" >309</var>
        <var name="nPromptPress3" type="i4" >313</var>
      </local-vars>
      <actions >
        <action id="102" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=53 y=58 ?>
          <!--"ChangeToDataMode"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ChangeToDataMode&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="90" stubbed="0"/>
            <result name="SUCCESS" link="182" stubbed="0" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: ModMainMenu");

if ("T" == Session.g_strModeratorRequiredFlag)
{
	Session.f_bModRequired = true;
	Session.f_nPromptAllowDisallow = Session.g_nPromptAllowDisallow;
	Session.f_nPromptWithoutMod = 903;
	if (Session.f_bThirdParty)
		Session.f_nPromptPressX = 357;
	else
		Session.f_nPromptPressX = 317;
}
else
{
	Session.f_bModRequired = false;
	Session.f_nPromptAllowDisallow = 99;
	Session.f_nPromptPressX = 99;
	Session.f_nPromptWithoutMod = 99;
}
Session.g_oMS.bMuteFlag = true;

Session.g_oMS.bDeafFlag = true;

Server.logInfo("INFO: MOD MAIN MENU MODIFY MEMBER REMOVE FROM CONFERENCE.");

if (Session.g_strACDEnable == "T")

{

	Session.f_bACDON = true;

}

else

{

	Session.f_bACDON = false;

}

if (Session.g_strRecordNamesFlag == "T")

{

	Session.f_bRecordON = true;

}

else

{

	Session.f_bRecordON = false;

}

if (Session.g_strConfRecordAllowed == "T")

{

	Session.f_bConfRecordON = true;

}

else

{

	Session.f_bConfRecordON = false;

}
if (Session.g_bReservationlessConf)
{
	Session.nPromptExtConfBy = 99;
	Session.nPrompt30 = 99;
	Session.nPromptMinutes = 99;
	Session.nPromptPress3 = 99;
}]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Pactolus.Branch.1" ><?xtml-editor x=802 y=409 ?>
          <results >
            <result name="Default" link="257" stubbed="1"/>
            <result name="1-add party" link="99" stubbed="0" >f_strDigit match "^1$"</result>
            <result name="2-drop last party" link="85" stubbed="0" >f_strDigit match "^2$"</result>
            <result name="3-extent by 30 mins" link="153" stubbed="1" >f_strDigit match "^3$"
AND g_bReservationlessConf == false</result>
            <result name="4-lock/unlock conf" link="61" stubbed="1" >f_strDigit match "^4$"</result>
            <result name="5-mute/unmute all" link="62" stubbed="1" >f_strDigit match "^5$"</result>
            <result name="6-count party" link="252" stubbed="1" >f_strDigit match "^6$"</result>
            <result name="7-allow/disallow conf continue" link="256" stubbed="1" >f_strDigit match "^7$"</result>
            <result name="8-self mute/unmute" link="67" stubbed="1" >f_strDigit match "^8$"</result>
            <result name="91 time remaining" link="204" stubbed="1" >f_strDigit match "^9{1}1{1}$"</result>
            <result name="92 balance remaining" link="205" stubbed="1" >f_strDigit match "^9{1}2{1}$"</result>
            <result name="93 conf record" link="206" stubbed="1" >f_strDigit match "^9{1}3{1}$"</result>
            <result name="9-repeat main menu" link="182" stubbed="1" >f_strDigit match "^9{1}$"</result>
            <result name="00 CSR" link="190" stubbed="1" >f_strDigit match "^0{2}$"</result>
            <result name="*0 private talke CSR" link="222" stubbed="1" >f_strDigit match "^\*{1}0{1}$"</result>
            <result name="#-end conf" link="216" stubbed="1" >f_strDigit match "^\#$"

OR g_strTerminationDigit match "#"</result>
            <result name="*-return to conf" link="95" stubbed="1" >f_strDigit match "^\*$"</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[Session.g_strTerminationDigit = "";
if (15 == Result.id)
{
	Session.g_nRequestCSRType = 1;
	Session.g_strRequestCSRPrivateTalkFlag = "T";
}
else if (14 == Result.id)
{
	Session.g_nRequestCSRType = 1;
	Session.g_strRequestCSRPrivateTalkFlag = "F";	
}]]></script>
          </scripts>
        </action>
        <action id="3" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1258 y=1489 ?>
          <!--UNLOCK CONFERENCE-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="s_strConfUnlockRequest" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="160" stubbed="1"/>
            <result name="Success" link="166" stubbed="0"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: **** UNLOCK CONFERENCE ****");]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)

{

	Server.logError("ERROR: FAIL TO SEND SOAP MESSAGE UNLOCK CONFERENCE.");

}]]></script>
          </scripts>
        </action>
        <action id="4" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1142 y=2947 ?>
          <!--END CONFERENCE-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="s_strConfEndRequest" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="160" stubbed="1"/>
            <result name="Success" link="58" stubbed="0"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: **** END CONFERENCE ****");]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)

{

	Server.logError("ERROR: FAIL TO SEND SOAP MESSAGE END CONFERENCE.");

}]]></script>
          </scripts>
        </action>
        <action id="5" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1244 y=1354 ?>
          <!--LOCK CONFERENCE-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="s_strConfLockRequest" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="160" stubbed="1"/>
            <result name="Success" link="165" stubbed="0"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: **** LOCK CONFERENCE ****");]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)

{

	Server.logError("ERROR: FAIL TO SEND SOAP MESSAGE LOCK CONFERENCE.");

}]]></script>
          </scripts>
        </action>
        <action id="6" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1428 y=478 ?>
          <!--add party-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;IVRConfAddParty&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="243" stubbed="0"/>
          </results>
        </action>
        <action id="8" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1532 y=706 ?>
          <!--REMOVE LAST CALLER-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="s_strConfRemoveLastRequest" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="160" stubbed="1"/>
            <result name="Success" link="161" stubbed="0"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: **** DROP LAST CALLER ****");]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)

{

	Server.logError("ERROR: FAIL TO SEND SOAP MESSAGE REMOVE LAST CALLER.");

}]]></script>
          </scripts>
        </action>
        <action id="16" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2389 y=585 ?>
          <!--record flag ON, ACD ON-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="60" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;([0-8]|9x|9.T|9.#|00|*0|*.T|#)&quot;" language="g_strLanguage" digits="f_strDigit" retry-count="3" clear-digits="1" terminating-digit="g_strTerminationDigit" quick-collect="0" digit-timer="" >
            <audio type="index" >518</audio>
            <audio type="index" >320</audio>
            <audio type="index" >905</audio>
            <audio type="index" >311</audio>
            <audio type="index" >855</audio>
            <audio type="index" >312</audio>
            <audio type="index" >856</audio>
            <audio type="index" >313</audio>
            <audio type="index" >861</audio>
            <audio type="index" >22</audio>
            <audio type="index" >309</audio>
            <audio type="index" >314</audio>
            <audio type="index" >g_nPromptLockUnLock</audio>
            <audio type="index" >315</audio>
            <audio type="index" >g_nPromptMuteUnMute</audio>
            <audio type="index" >316</audio>
            <audio type="index" >862</audio>
            <audio type="index" >940</audio>
            <audio type="index" >f_nPromptPressX</audio>
            <audio type="index" >f_nPromptAllowDisallow</audio>
            <audio type="index" >f_nPromptWithoutMod</audio>
            <audio type="index" >318</audio>
            <audio type="index" >g_nPromptSelfMuteUnMute</audio>
            <audio type="index" >319</audio>
            <audio type="index" >906</audio>
            <audio type="index" >310</audio>
            <audio type="digits" >91</audio>
            <audio type="index" >947</audio>
            <audio type="index" >310</audio>
            <audio type="digits" >92</audio>
            <audio type="index" >521</audio>
            <audio type="index" >321</audio>
            <audio type="index" >889</audio>
            <audio type="index" >966</audio>
            <audio type="index" >963</audio>
            <audio type="index" >964</audio>
            <audio type="index" >962</audio>
            <timeout-prompt type="index" >s_nPromptNoResponse</timeout-prompt>
          </play>
          <results >
            <result name="Default" link="95" stubbed="1"/>
            <result name="Success" link="2" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="18" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1236 y=1660 ?>
          <!--MUTE ALL-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="s_strMuteAllRequest" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="160" stubbed="1"/>
            <result name="Success" link="167" stubbed="0"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: **** MUTE ALL ****");]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)

{

	Server.logError("ERROR: FAIL TO SEND SOAP MESSAGE MUTE ALL.");

}]]></script>
          </scripts>
        </action>
        <action id="19" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1253 y=1806 ?>
          <!--UNMUTE ALL-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="s_strUnmuteAllRequest" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="160" stubbed="1"/>
            <result name="Success" link="168" stubbed="0"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: **** UNMUTE ALL ****");]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)

{

	Server.logError("ERROR: FAIL TO SEND SOAP MESSAGE UNMUTE ALL.");

}]]></script>
          </scripts>
        </action>
        <action id="20" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1271 y=1011 ?>
          <!--EXTEND CONFERENCE-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="s_strConfExtendRequest" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;hours&quot;" value="0"/>
            <parameter tag="&quot;minutes&quot;" value="30"/>
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="160" stubbed="1"/>
            <result name="Success" link="157" stubbed="0"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_disable_event();

Server.logInfo("INFO: **** EXTEND CONF ****");]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)

{

	Server.logError("ERROR: FAIL TO SEND SOAP MESSAGE EXTEND CONFERENCE.");

}]]></script>
          </scripts>
        </action>
        <action id="21" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=938 y=1997 ?>
          <!--count call legs-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceConfCount&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="95" stubbed="1"/>
            <result name="NbrCallLeg == 1" link="22" stubbed="0" >g_nCurrentNbrCallegs == 1</result>
            <result name="NbrCallLeg &gt;= 2" link="82" stubbed="0" >g_nCurrentNbrCallegs &gt;= 2</result>
          </results>
        </action>
        <action id="22" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1239 y=1949 ?>
          <!--there is one participant-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >925</audio>
            <audio type="number" >g_nCurrentNbrCallegs</audio>
            <audio type="index" >927</audio>
            <audio type="index" >929</audio>
          </play>
          <results >
            <result name="Default" link="95" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="45" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1192 y=2335 ?>
          <!--CONF_CONTINUE_REQUEST-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="s_strConfContinueRequest" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="160" stubbed="1"/>
            <result name="Success" link="169" stubbed="0"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: **** CONF CONTINUE REQUEST ****");]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)

{

	Server.logError("ERROR: FAIL TO SEND SOAP MESSAGE CONF_CONTINUE_REQUEST.");

}]]></script>
          </scripts>
        </action>
        <action id="46" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1195 y=2480 ?>
          <!--CONF_DISCONTINUE_REQUEST-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="s_strConfDiscontinueRequest" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="160" stubbed="1"/>
            <result name="Success" link="170" stubbed="0"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: **** CONF DISCONTINUE REQUEST ****");]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)

{

	Server.logError("ERROR: FAIL TO SEND SOAP MESSAGE CONF_DISCONTINUE_REQUEST.");

}]]></script>
          </scripts>
        </action>
        <action id="54" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1517 y=3078 ?>
          <!--HangUp Caller-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpCaller&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="116" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 38;
Session.g_nConfLeaveReason = 6;
Session.g_strConfLeaveMsg = "FAIL TO MODIFY CONFERENCE";]]></script>
          </scripts>
        </action>
        <action id="58" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1453 y=2942 ?>
          <!--HangUp Caller-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpCaller&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="116" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 13;
Session.g_nConfLeaveReason = 8;
Session.g_strConfLeaveMsg = "MODERATOR PRESS DTMF TO END CONFERENCE";]]></script>
          </scripts>
        </action>
        <action id="61" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1001 y=1395 ?>
          <!--lock/unlock?-->
          <results >
            <result name="Default" link="5" stubbed="0"/>
            <result name="unlock = 858" link="3" stubbed="0" >g_nPromptLockUnLock == 858</result>
          </results>
        </action>
        <action id="62" plug-in="Pactolus.Branch.1" ><?xtml-editor x=969 y=1726 ?>
          <!--mute/unmute-->
          <results >
            <result name="Default" link="18" stubbed="0"/>
            <result name="unmute = 860" link="19" stubbed="0" >g_nPromptMuteUnMute == 860</result>
          </results>
        </action>
        <action id="63" plug-in="Pactolus.Branch.1" ><?xtml-editor x=932 y=2381 ?>
          <!--allow/disallow-->
          <results >
            <result name="Default" link="45" stubbed="0"/>
            <result name="disallow= 902" link="46" stubbed="0" >g_nPromptAllowDisallow == 902</result>
          </results>
        </action>
        <action id="67" plug-in="Pactolus.Branch.1" ><?xtml-editor x=914 y=2682 ?>
          <!--selfmute/unmute-->
          <results >
            <result name="Default" link="105" stubbed="0"/>
            <result name="self muted == 908" link="233" stubbed="1" >g_nPromptSelfMuteUnMute == 908</result>
          </results>
        </action>
        <action id="82" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1257 y=2161 ?>
          <!--number of call legs-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >926</audio>
            <audio type="number" >g_nCurrentNbrCallegs</audio>
            <audio type="index" >928</audio>
            <audio type="index" >929</audio>
          </play>
          <results >
            <result name="Default" link="155" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="85" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1090 y=712 ?>
          <!--getLastParty-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceConfGetLastParty&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="86" stubbed="0"/>
          </results>
        </action>
        <action id="86" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1321 y=713 ?>
          <!--same one OR not success-->
          <results >
            <result name="Default" link="8" stubbed="0"/>
            <result name="same one or not success" link="162" stubbed="0" >g_strLastPartySessionId match g_strSessionId

OR f_nReturnCode != s_nSuccess</result>
          </results>
        </action>
        <action id="90" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=295 y=42 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bCurrentlyInMMenu = false;]]></script>
          </scripts>
        </action>
        <action id="95" plug-in="Pactolus.Branch.1" ><?xtml-editor x=821 y=3106 ?>
          <!--mute state?-->
          <results >
            <result name="Default" link="109" stubbed="0"/>
            <result name="g_bMutedState" link="242" stubbed="0" >g_bMutedState == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("CURRENT MUTE STATE IS: " + Session.g_bMutedState);

Server.logInfo("CURRENT HOLD STATE IS: " + Session.g_bHoldState);

if (Session.g_bHoldState)

{

	Session.g_oMS.bMuteFlag = true;

	Session.g_oMS.bDeafFlag = true;

}

else if (Session.g_bMutedState)

{

	Session.g_oMS.bMuteFlag = true;

	Session.g_oMS.bDeafFlag = false;

}

else

{

	Session.g_oMS.bMuteFlag = false;

	Session.g_oMS.bDeafFlag = false;

}]]></script>
          </scripts>
        </action>
        <action id="99" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1075 y=376 ?>
          <!--remove from conference

add to new conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;RemoveOldAddNew&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="111" stubbed="0"/>
            <result name="FAILURE" link="160" stubbed="1" >f_nReturnCode == s_nFailure</result>
            <result name="SUCCESS" link="6" stubbed="0" >f_nReturnCode == s_nSuccess</result>
          </results>
        </action>
        <action id="105" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1197 y=2625 ?>
          <!--SELF MUTE PARTY-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="s_strConfMutePartyEvent" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;callerPassCode&quot;" value="g_strCCGeneratedPassCode"/>
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="160" stubbed="1"/>
            <result name="Success" link="171" stubbed="0"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: **** SELF MUTE ****");]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)

{

	Server.logError("ERROR: FAIL TO SEND SOAP MESSAGE MUTE YOUR OWN LINE.");

}]]></script>
          </scripts>
        </action>
        <action id="107" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1212 y=2784 ?>
          <!--SELF UNMUTE PARTY-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="s_strConfUnmutePartyEvent" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;callerPassCode&quot;" value="g_strCCGeneratedPassCode"/>
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="160" stubbed="1"/>
            <result name="Success" link="172" stubbed="0"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: **** SELF UNMUTE ****");]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)

{

	Server.logError("ERROR: FAIL TO SEND SOAP MESSAGE UNMUTE YOUR OWN LINE.");

}]]></script>
          </scripts>
        </action>
        <action id="108" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1280 y=3084 ?>
          <!--success?-->
          <results >
            <result name="Default" link="54" stubbed="0"/>
            <result name="success?" link="90" stubbed="1" >f_nReturnCode == s_nSuccess</result>
          </results>
        </action>
        <action id="109" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1051 y=3084 ?>
          <!--modify conf member-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ChangeToConferenceMode&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="108" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: MOD MAIN MENU MODIFY MEMBER RETURN TO CONFERENCE.");]]></script>
            <script language="javascript" timing="last" ><![CDATA[Server.logInfo("SidebarOperatorRequest disable events...Reenabled on return from ModifyConfereceMember");
js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="111" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1428 y=353 ?>
          <!--party leave-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;PartyLeave&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="117" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nConfLeaveReason = 0;
Session.g_strConfLeaveMsg = "PARTY HANGUP WHILE TRYING TO ADD MEMBER TO CONFERENCE";]]></script>
          </scripts>
        </action>
        <action id="116" plug-in="Standard.EndSession.1" ><?xtml-editor x=1727 y=3081 ?></action>
        <action id="117" plug-in="Standard.EndSession.1" ><?xtml-editor x=1647 y=352 ?></action>
        <action id="119" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1709 y=2174 ?>
          <!--CallPartyFlag==T?-->
          <results >
            <result name="Default" link="120" stubbed="0"/>
            <result name="g_strPartyPasscodeFlag==T" link="121" stubbed="0" >g_strPartyPasscodeFlag match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: SEND PARTY JOIN ****");

Server.logInfo("INFO: CONF CON IP = " + Session.g_strConfControllerIP);

Server.logInfo("INFO: CONF CON PORT = " + Session.g_nConfControllerPort);

Server.logInfo("INFO: CONF CON TRANS Id = " + Session.g_strResponseTransactionId);

Server.logInfo("INFO: CONF CON MSG NAME = " + Session.s_strConfGetRoleCall);

Server.logInfo("INFO: CONF SCHED Id =  " + Session.g_strConfScheduleId);

Server.logInfo("INFO: PASSCODE = " + Session.g_strPassCode);

Server.logInfo("INFO: SOAP PORT = " + Session.g_nSoapPort);

js_disable_event();]]></script>
          </scripts>
        </action>
        <action id="120" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1931 y=2126 ?>
          <!--Get roll call-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="s_strConfGetRoleCall" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;callerPassCode&quot;" value="g_strCCGeneratedPassCode"/>
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="122" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
        </action>
        <action id="121" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1950 y=2265 ?>
          <!--get roll call-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="s_strConfGetRoleCall" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;callerPassCode&quot;" value="g_strCCGeneratedPassCode"/>
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="122" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
        </action>
        <action id="122" plug-in="Standard.WaitEvent.1" ><?xtml-editor x=2184 y=2223 ?>
          <!--ConfGetRollCallResponse-->
          <wait xmlns="urn:www.pactolus.com:xtml:communication" timeout="5" recv-name="g_strEventReceived" >
            <msg name="ConfGetRollCallResponse" >
              <parameter >f_strConfControllerIP</parameter>
              <parameter >f_nConfControllerPort</parameter>
              <parameter >f_strTransactionId</parameter>
              <parameter >g_nRecordedNameCount</parameter>
              <parameter >g_strRecordedNameURLs</parameter>
            </msg>
          </wait>
          <results >
            <result name="Default" link="95" stubbed="1"/>
            <result name="Success" link="124" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="123" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=3121 y=2397 ?>
          <!--Play the name-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;(x|*|#)&quot;" language="g_strLanguage" digits="f_strDigit" retry-count="" clear-digits="1" terminating-digit="" quick-collect="1" digit-timer="1" >
            <audio type="url" >g_oRecordedNameURLs[f_nCounter]</audio>
          </play>
          <results >
            <result name="Default" link="125" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_strDigit = "";]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Session.f_strDigit.length <= 0)

{

	Session.f_bNullString = true;

}

else

{

	Session.f_bNullString = false;

}]]></script>
          </scripts>
        </action>
        <action id="124" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2427 y=2220 ?>
          <!--parse recorded name-->
          <results >
            <result name="Default" link="95" stubbed="1"/>
            <result name="recorded name &gt; 0" link="144" stubbed="0" >g_nRecordedNameCount &gt; 0</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nRecordedNameCount--;  //don't want to count yourself

if (Session.g_nRecordedNameCount > 0)

{

	Session.f_nCounter = 0;

	var i = 0;

	var token = Clib.strtok(Session.g_strRecordedNameURLs, ";");

	while (null != token)

	{

		if (Clib.strcmp(Session.g_strCallerRecordedName, token) != 0)

		{

			Session.g_oRecordedNameURLs[i] = token;

			Server.logInfo("RECORDED NAME: " + Session.g_oRecordedNameURLs[i]);

			i++;

		}

		token = Clib.strtok(null, ";");

	}

}]]></script>
          </scripts>
        </action>
        <action id="125" plug-in="Pactolus.Branch.1" ><?xtml-editor x=3397 y=2395 ?>
          <!--hear more name?-->
          <results >
            <result name="Default" link="95" stubbed="1"/>
            <result name="no digit and more name" link="176" stubbed="1" >f_bNullString == true

AND f_nCounter &lt; g_nRecordedNameCount</result>
            <result name="* return to conf" link="95" stubbed="1" >f_strDigit match "\*"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_nCounter++;]]></script>
          </scripts>
        </action>
        <action id="144" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2654 y=2217 ?>
          <!--here are the names-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >944</audio>
          </play>
          <results >
            <result name="Default" link="145" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="145" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2902 y=2212 ?>
          <!--parse recorded name-->
          <results >
            <result name="Default" link="176" stubbed="1"/>
            <result name="recorded name &gt; 5" link="146" stubbed="0" >g_nRecordedNameCount &gt; 5</result>
          </results>
        </action>
        <action id="146" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=3133 y=2207 ?>
          <!--press # return to previous menu-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >321</audio>
            <audio type="index" >1270</audio>
          </play>
          <results >
            <result name="Default" link="176" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="147" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1782 y=3282 ?>
          <!--"CSRBeginRequest"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;CSRBeginRequest&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="148" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_disable_event();

Session.g_nCSRRouteReasonCode = 3;  //mod zero out

Session.g_strCSRRequestEndPoint = Session.g_oMS.strConferenceId;]]></script>
          </scripts>
        </action>
        <action id="148" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2015 y=3271 ?>
          <!--success?-->
          <results >
            <result name="Default" link="179" stubbed="0"/>
            <result name="success?" link="95" stubbed="1" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (2 == Result.id)
{
	Session.g_nCallerCurrentState = Session.s_nStateZeroOutToCsr;
	Session.g_bZeroOutToCSR = true;
}
js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="150" plug-in="Standard.Timer.1" ><?xtml-editor x=1297 y=3277 ?>
          <!--play beep  every 10 secs-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lBeepBeepTimerId" duration="s_nSleepTime"/>
          <results >
            <result name="Default" link="151" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bBeepBeepTimerFlag = true;]]></script>
          </scripts>
        </action>
        <action id="151" plug-in="Standard.Timer.1" ><?xtml-editor x=1545 y=3281 ?>
          <!--set max wait time for CSR-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lWaitCSRTimerId" duration="s_nCsrHoldTime"/>
          <results >
            <result name="Default" link="147" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bWaitCSRTimerSet = true;]]></script>
          </scripts>
        </action>
        <action id="153" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1040 y=1058 ?>
          <!--option avail?-->
          <results >
            <result name="Default" link="20" stubbed="0"/>
            <result name="g_nScheduleDuration &lt;= 0?" link="163" stubbed="0" >g_nScheduleDuration &lt;= 0</result>
          </results>
        </action>
        <action id="155" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1475 y=2176 ?>
          <!--record option on?-->
          <results >
            <result name="Default" link="95" stubbed="1"/>
            <result name="g_strRecordNameFlag == &quot;T&quot;" link="119" stubbed="0" >g_strRecordNamesFlag match "T"</result>
          </results>
        </action>
        <action id="157" plug-in="Standard.WaitEvent.1" ><?xtml-editor x=1525 y=1007 ?>
          <!--Extend conf response-->
          <wait xmlns="urn:www.pactolus.com:xtml:communication" timeout="5" recv-name="g_strEventReceived" >
            <msg name="ExtendConferenceResponse" >
              <parameter >f_strConfControllerIP</parameter>
              <parameter >f_nConfControllerPort</parameter>
              <parameter >f_strTransactionId</parameter>
              <parameter >f_nReturnCode</parameter>
              <parameter >f_strReturnMsg</parameter>
            </msg>
          </wait>
          <results >
            <result name="Default" link="160" stubbed="1"/>
            <result name="Success" link="158" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_nReturnCode = -1;]]></script>
            <script language="javascript" timing="last" ><![CDATA[js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="158" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1765 y=1002 ?>
          <!--success?-->
          <results >
            <result name="Default" link="160" stubbed="1"/>
            <result name="f_nReturnCode == 0" link="164" stubbed="0" >f_nReturnCode == 0</result>
          </results>
        </action>
        <action id="160" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1985 y=711 ?>
          <!--can't complete transaction-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >363</audio>
          </play>
          <results >
            <result name="Default" link="95" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="161" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1761 y=705 ?>
          <!--party dropped-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >915</audio>
          </play>
          <results >
            <result name="Default" link="95" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="162" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1545 y=831 ?>
          <!--invalid choice-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >337</audio>
          </play>
          <results >
            <result name="Default" link="95" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="163" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1286 y=1166 ?>
          <!--option not avail-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >524</audio>
          </play>
          <results >
            <result name="Default" link="95" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="164" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2011 y=997 ?>
          <!--conf extended-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >879</audio>
          </play>
          <results >
            <result name="Default" link="95" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="165" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1491 y=1349 ?>
          <!--conf is locked-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >914</audio>
          </play>
          <results >
            <result name="Default" link="95" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nPromptLockUnLock = 858;]]></script>
          </scripts>
        </action>
        <action id="166" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1495 y=1490 ?>
          <!--conf is unlocked-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >932</audio>
          </play>
          <results >
            <result name="Default" link="95" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nPromptLockUnLock = 857;]]></script>
          </scripts>
        </action>
        <action id="167" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1480 y=1653 ?>
          <!--all muted-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >919</audio>
          </play>
          <results >
            <result name="Default" link="95" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nPromptMuteUnMute = 860;]]></script>
          </scripts>
        </action>
        <action id="168" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1484 y=1794 ?>
          <!--all unmuted-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >921</audio>
          </play>
          <results >
            <result name="Default" link="95" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nPromptMuteUnMute = 859;]]></script>
          </scripts>
        </action>
        <action id="169" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1430 y=2330 ?>
          <!--continue @out mod-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >923</audio>
          </play>
          <results >
            <result name="Default" link="95" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nPromptAllowDisallow = 902;]]></script>
          </scripts>
        </action>
        <action id="170" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1436 y=2473 ?>
          <!--discontinue @out mod-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >922</audio>
          </play>
          <results >
            <result name="Default" link="95" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nPromptAllowDisallow = 901;]]></script>
          </scripts>
        </action>
        <action id="171" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1425 y=2620 ?>
          <!--your line is muted-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >s_nPromptMuted</audio>
          </play>
          <results >
            <result name="Default" link="95" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nPromptSelfMuteUnMute = 908;

Session.g_bMutedState = true;

Server.logInfo("CURRENT MUTE STATE IS: " + Session.g_bMutedState);]]></script>
          </scripts>
        </action>
        <action id="172" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1444 y=2781 ?>
          <!--your line unmuted-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >s_nPromptUnmuted</audio>
          </play>
          <results >
            <result name="Default" link="95" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nPromptSelfMuteUnMute = 907;

Session.g_bMutedState = false;

Server.logInfo("CURRENT MUTE STATE IS: " + Session.g_bMutedState);]]></script>
          </scripts>
        </action>
        <action id="174" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1081 y=3280 ?>
          <!--CSR will join you shortly-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="0" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >963</audio>
            <audio type="silence" >0.2</audio>
            <audio type="index" >340</audio>
          </play>
          <results >
            <result name="Default" link="150" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_bRequestedCSR = true;]]></script>
          </scripts>
        </action>
        <action id="175" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1823 y=3394 ?>
          <!--beep - beep (340)-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="0" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >340</audio>
          </play>
          <results >
            <result name="Default" link="150" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="176" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2870 y=2388 ?>
          <!--null string-->
          <results >
            <result name="Default" link="123" stubbed="0"/>
            <result name="f_bNullString == true" link="125" stubbed="1" >f_bNullString == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("RECORDED NAME LENGTH IS:  " + Session.g_oRecordedNameURLs[Session.f_nCounter].length);

if (Session.g_oRecordedNameURLs[Session.f_nCounter].length <= 1)

{

	Session.f_bNullString = true;

}

else

{

	Session.f_bNullString = false;

}]]></script>
          </scripts>
        </action>
        <action id="177" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1959 y=102 ?>
          <!--prepaid

record option on?-->
          <results >
            <result name="Default" link="186" stubbed="1"/>
            <result name="Nrecord==T and acd==T" >f_bRecordON == true

AND f_bACDON == true</result>
            <result name="Nrecord==F and acd==T" >f_bRecordON == false

AND f_bACDON == true</result>
            <result name="Nrecord==F and acd==F" >f_bRecordON == false

AND f_bACDON == false</result>
          </results>
        </action>
        <action id="178" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2405 y=418 ?>
          <!--record flag ON, ACD OFF-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="60" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;([0-8]|9x|9.T|9.#|*|#)&quot;" language="g_strLanguage" digits="f_strDigit" retry-count="3" clear-digits="1" terminating-digit="g_strTerminationDigit" quick-collect="0" digit-timer="" >
            <audio type="index" >518</audio>
            <audio type="index" >320</audio>
            <audio type="index" >905</audio>
            <audio type="index" >311</audio>
            <audio type="index" >855</audio>
            <audio type="index" >312</audio>
            <audio type="index" >856</audio>
            <audio type="index" >313</audio>
            <audio type="index" >861</audio>
            <audio type="index" >22</audio>
            <audio type="index" >309</audio>
            <audio type="index" >314</audio>
            <audio type="index" >g_nPromptLockUnLock</audio>
            <audio type="index" >315</audio>
            <audio type="index" >g_nPromptMuteUnMute</audio>
            <audio type="index" >316</audio>
            <audio type="index" >862</audio>
            <audio type="index" >940</audio>
            <audio type="index" >f_nPromptPressX</audio>
            <audio type="index" >f_nPromptAllowDisallow</audio>
            <audio type="index" >f_nPromptWithoutMod</audio>
            <audio type="index" >318</audio>
            <audio type="index" >g_nPromptSelfMuteUnMute</audio>
            <audio type="index" >319</audio>
            <audio type="index" >906</audio>
            <audio type="index" >310</audio>
            <audio type="digits" >91</audio>
            <audio type="index" >947</audio>
            <audio type="index" >310</audio>
            <audio type="digits" >92</audio>
            <audio type="index" >521</audio>
            <audio type="index" >321</audio>
            <audio type="index" >889</audio>
            <timeout-prompt type="index" >s_nPromptNoResponse</timeout-prompt>
          </play>
          <results >
            <result name="Default" link="95" stubbed="1"/>
            <result name="Success" link="255" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="179" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2268 y=3267 ?>
          <!--could not complete transaction-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >363</audio>
          </play>
          <results >
            <result name="Default" link="192" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="180" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=334 y=3099 ?>
          <!--"GetAndPlayTime"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;GetAndPlayTime&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="95" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_disable_event();]]></script>
            <script language="javascript" timing="last" ><![CDATA[js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="181" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=343 y=3219 ?>
          <!--"GetAndPlayBalance"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;GetAndPlayBalance&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="95" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_disable_event();]]></script>
            <script language="javascript" timing="last" ><![CDATA[js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="182" plug-in="Pactolus.Branch.1" ><?xtml-editor x=308 y=154 ?>
          <!--prepaid conference-->
          <results >
            <result name="Default" link="199" stubbed="1"/>
            <result name="g_bThirdParty" link="221" stubbed="1" >f_bThirdParty == true</result>
            <result name="billing type == 1?" link="194" stubbed="1" >g_nBillingType == 1</result>
          </results>
        </action>
        <action id="183" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2795 y=163 ?>
          <!--postpaid

record option on?-->
          <results >
            <result name="Default" link="188" stubbed="1"/>
            <result name="Nrecord==T and acd==T" >f_bRecordON == true

AND f_bACDON == true</result>
            <result name="Nrecord==F and acd==T" >f_bRecordON == false

AND f_bACDON == true</result>
            <result name="Nrecord==F and acd== F" >f_bRecordON == false

AND f_bACDON == false</result>
          </results>
        </action>
        <action id="184" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=3168 y=556 ?>
          <!--record flag ON, ACD ON-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="60" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;(00|*0|*.T|x.T|#)&quot;" language="g_strLanguage" digits="f_strDigit" retry-count="3" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >518</audio>
            <audio type="index" >320</audio>
            <audio type="index" >905</audio>
            <audio type="index" >311</audio>
            <audio type="index" >855</audio>
            <audio type="index" >312</audio>
            <audio type="index" >856</audio>
            <audio type="index" >nPromptPress3</audio>
            <audio type="index" >nPromptExtConfBy</audio>
            <audio type="index" >nPrompt30</audio>
            <audio type="index" >nPromptMinutes</audio>
            <audio type="index" >314</audio>
            <audio type="index" >g_nPromptLockUnLock</audio>
            <audio type="index" >315</audio>
            <audio type="index" >g_nPromptMuteUnMute</audio>
            <audio type="index" >316</audio>
            <audio type="index" >862</audio>
            <audio type="index" >940</audio>
            <audio type="index" >f_nPromptPressX</audio>
            <audio type="index" >f_nPromptAllowDisallow</audio>
            <audio type="index" >f_nPromptWithoutMod</audio>
            <audio type="index" >318</audio>
            <audio type="index" >g_nPromptSelfMuteUnMute</audio>
            <audio type="index" >319</audio>
            <audio type="index" >906</audio>
            <audio type="index" >321</audio>
            <audio type="index" >889</audio>
            <audio type="index" >966</audio>
            <audio type="index" >963</audio>
            <audio type="index" >964</audio>
            <audio type="index" >962</audio>
            <timeout-prompt type="index" >s_nPromptNoResponse</timeout-prompt>
          </play>
          <results >
            <result name="Default" link="95" stubbed="1"/>
            <result name="Success" link="2" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="185" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=3133 y=411 ?>
          <!--record flag ON, ACD OFF-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="60" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;(x|*|#)&quot;" language="g_strLanguage" digits="f_strDigit" retry-count="3" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >518</audio>
            <audio type="index" >320</audio>
            <audio type="index" >905</audio>
            <audio type="index" >311</audio>
            <audio type="index" >855</audio>
            <audio type="index" >312</audio>
            <audio type="index" >856</audio>
            <audio type="index" >nPromptPress3</audio>
            <audio type="index" >nPromptExtConfBy</audio>
            <audio type="index" >nPrompt30</audio>
            <audio type="index" >nPromptMinutes</audio>
            <audio type="index" >314</audio>
            <audio type="index" >g_nPromptLockUnLock</audio>
            <audio type="index" >315</audio>
            <audio type="index" >g_nPromptMuteUnMute</audio>
            <audio type="index" >316</audio>
            <audio type="index" >862</audio>
            <audio type="index" >940</audio>
            <audio type="index" >f_nPromptPressX</audio>
            <audio type="index" >f_nPromptAllowDisallow</audio>
            <audio type="index" >f_nPromptWithoutMod</audio>
            <audio type="index" >318</audio>
            <audio type="index" >g_nPromptSelfMuteUnMute</audio>
            <audio type="index" >319</audio>
            <audio type="index" >906</audio>
            <audio type="index" >321</audio>
            <audio type="index" >889</audio>
            <timeout-prompt type="index" >s_nPromptNoResponse</timeout-prompt>
          </play>
          <results >
            <result name="Default" link="95" stubbed="1"/>
            <result name="Success" link="255" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="186" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2249 y=88 ?>
          <!--record flag OFF, ACD OFF-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="60" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;([0-8]|9x|9.T|9.#|*|#)&quot;" language="g_strLanguage" digits="f_strDigit" retry-count="3" clear-digits="1" terminating-digit="g_strTerminationDigit" quick-collect="0" digit-timer="" >
            <audio type="index" >518</audio>
            <audio type="index" >320</audio>
            <audio type="index" >905</audio>
            <audio type="index" >311</audio>
            <audio type="index" >855</audio>
            <audio type="index" >312</audio>
            <audio type="index" >856</audio>
            <audio type="index" >313</audio>
            <audio type="index" >861</audio>
            <audio type="index" >22</audio>
            <audio type="index" >309</audio>
            <audio type="index" >314</audio>
            <audio type="index" >g_nPromptLockUnLock</audio>
            <audio type="index" >315</audio>
            <audio type="index" >g_nPromptMuteUnMute</audio>
            <audio type="index" >316</audio>
            <audio type="index" >862</audio>
            <audio type="index" >f_nPromptPressX</audio>
            <audio type="index" >f_nPromptAllowDisallow</audio>
            <audio type="index" >f_nPromptWithoutMod</audio>
            <audio type="index" >318</audio>
            <audio type="index" >g_nPromptSelfMuteUnMute</audio>
            <audio type="index" >319</audio>
            <audio type="index" >906</audio>
            <audio type="index" >310</audio>
            <audio type="digits" >91</audio>
            <audio type="index" >947</audio>
            <audio type="index" >310</audio>
            <audio type="digits" >92</audio>
            <audio type="index" >521</audio>
            <audio type="index" >321</audio>
            <audio type="index" >889</audio>
            <timeout-prompt type="index" >s_nPromptNoResponse</timeout-prompt>
          </play>
          <results >
            <result name="Default" link="95" stubbed="1"/>
            <result name="Success" link="255" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="187" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2390 y=273 ?>
          <!--record flag OFF, ACD ON-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="60" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;([0-8]|9x|9.T|9.#|00|*0|*.T|#)&quot;" language="g_strLanguage" digits="f_strDigit" retry-count="3" clear-digits="1" terminating-digit="g_strTerminationDigit" quick-collect="0" digit-timer="" >
            <audio type="index" >518</audio>
            <audio type="index" >320</audio>
            <audio type="index" >905</audio>
            <audio type="index" >311</audio>
            <audio type="index" >855</audio>
            <audio type="index" >312</audio>
            <audio type="index" >856</audio>
            <audio type="index" >313</audio>
            <audio type="index" >861</audio>
            <audio type="index" >22</audio>
            <audio type="index" >309</audio>
            <audio type="index" >314</audio>
            <audio type="index" >g_nPromptLockUnLock</audio>
            <audio type="index" >315</audio>
            <audio type="index" >g_nPromptMuteUnMute</audio>
            <audio type="index" >316</audio>
            <audio type="index" >862</audio>
            <audio type="index" >f_nPromptPressX</audio>
            <audio type="index" >f_nPromptAllowDisallow</audio>
            <audio type="index" >f_nPromptWithoutMod</audio>
            <audio type="index" >318</audio>
            <audio type="index" >g_nPromptSelfMuteUnMute</audio>
            <audio type="index" >319</audio>
            <audio type="index" >906</audio>
            <audio type="index" >310</audio>
            <audio type="digits" >91</audio>
            <audio type="index" >947</audio>
            <audio type="index" >310</audio>
            <audio type="digits" >92</audio>
            <audio type="index" >521</audio>
            <audio type="index" >321</audio>
            <audio type="index" >889</audio>
            <audio type="index" >966</audio>
            <audio type="index" >963</audio>
            <audio type="index" >964</audio>
            <audio type="index" >962</audio>
            <timeout-prompt type="index" >s_nPromptNoResponse</timeout-prompt>
          </play>
          <results >
            <result name="Default" link="95" stubbed="1"/>
            <result name="Success" link="2" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="188" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2958 y=107 ?>
          <!--record flag OFF, ACD OFF-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="60" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;(x|*|#)&quot;" language="g_strLanguage" digits="f_strDigit" retry-count="3" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >518</audio>
            <audio type="index" >320</audio>
            <audio type="index" >905</audio>
            <audio type="index" >311</audio>
            <audio type="index" >855</audio>
            <audio type="index" >312</audio>
            <audio type="index" >856</audio>
            <audio type="index" >nPromptPress3</audio>
            <audio type="index" >nPromptExtConfBy</audio>
            <audio type="index" >nPrompt30</audio>
            <audio type="index" >nPromptMinutes</audio>
            <audio type="index" >314</audio>
            <audio type="index" >g_nPromptLockUnLock</audio>
            <audio type="index" >315</audio>
            <audio type="index" >g_nPromptMuteUnMute</audio>
            <audio type="index" >316</audio>
            <audio type="index" >862</audio>
            <audio type="index" >f_nPromptPressX</audio>
            <audio type="index" >f_nPromptAllowDisallow</audio>
            <audio type="index" >f_nPromptWithoutMod</audio>
            <audio type="index" >318</audio>
            <audio type="index" >g_nPromptSelfMuteUnMute</audio>
            <audio type="index" >319</audio>
            <audio type="index" >906</audio>
            <audio type="index" >321</audio>
            <audio type="index" >889</audio>
            <timeout-prompt type="index" >s_nPromptNoResponse</timeout-prompt>
          </play>
          <results >
            <result name="Default" link="95" stubbed="1"/>
            <result name="Success" link="255" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="189" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=3068 y=264 ?>
          <!--record flag OFF, ACD ON-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="60" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;(00|*0|*.T|x.T|#)&quot;" language="g_strLanguage" digits="f_strDigit" retry-count="3" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >518</audio>
            <audio type="index" >320</audio>
            <audio type="index" >905</audio>
            <audio type="index" >311</audio>
            <audio type="index" >855</audio>
            <audio type="index" >312</audio>
            <audio type="index" >856</audio>
            <audio type="index" >nPromptPress3</audio>
            <audio type="index" >nPromptExtConfBy</audio>
            <audio type="index" >nPrompt30</audio>
            <audio type="index" >nPromptMinutes</audio>
            <audio type="index" >314</audio>
            <audio type="index" >g_nPromptLockUnLock</audio>
            <audio type="index" >315</audio>
            <audio type="index" >g_nPromptMuteUnMute</audio>
            <audio type="index" >316</audio>
            <audio type="index" >862</audio>
            <audio type="index" >f_nPromptPressX</audio>
            <audio type="index" >f_nPromptAllowDisallow</audio>
            <audio type="index" >f_nPromptWithoutMod</audio>
            <audio type="index" >318</audio>
            <audio type="index" >g_nPromptSelfMuteUnMute</audio>
            <audio type="index" >319</audio>
            <audio type="index" >906</audio>
            <audio type="index" >321</audio>
            <audio type="index" >889</audio>
            <audio type="index" >966</audio>
            <audio type="index" >963</audio>
            <audio type="index" >964</audio>
            <audio type="index" >962</audio>
            <timeout-prompt type="index" >s_nPromptNoResponse</timeout-prompt>
          </play>
          <results >
            <result name="Default" link="95" stubbed="1"/>
            <result name="Success" link="2" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="190" plug-in="Pactolus.Branch.1" ><?xtml-editor x=818 y=3282 ?>
          <!--ACD on?-->
          <results >
            <result name="Default" link="95" stubbed="1"/>
            <result name="ACD enable ==&quot;T&quot;" link="174" stubbed="0" >g_strACDEnable match "T"</result>
          </results>
        </action>
        <action id="191" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1635 y=3514 ?>
          <!--requested CSR?-->
          <results >
            <result name="Default" link="90" stubbed="1"/>
            <result name="f_bRequestedCSR == true" link="147" stubbed="1" >f_bRequestedCSR == true</result>
          </results>
        </action>
        <action id="192" plug-in="Standard.Timer.1" ><?xtml-editor x=2519 y=3261 ?>
          <!--stop play beep-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="0" id="g_lBeepBeepTimerId" duration=""/>
          <results >
            <result name="Default" link="193" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bBeepBeepTimerFlag = false;]]></script>
          </scripts>
        </action>
        <action id="193" plug-in="Standard.Timer.1" ><?xtml-editor x=2767 y=3265 ?>
          <!--stop max wait time for CSR-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="0" id="g_lWaitCSRTimerId" duration=""/>
          <results >
            <result name="Default" link="95" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bWaitCSRTimerSet = false;]]></script>
            <script language="javascript" timing="last" ><![CDATA[js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="194" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1955 y=286 ?>
          <!--options-->
          <results >
            <result name="Default" link="186" stubbed="1"/>
            <result name="!CR &amp;&amp; !RC &amp;&amp; !ACD" link="186" stubbed="0" >f_bConfRecordON == false

AND f_bRecordON == false

AND f_bACDON == false</result>
            <result name="!CR &amp;&amp; !RC &amp;&amp; ACD" link="187" stubbed="0" >f_bConfRecordON == false

AND f_bRecordON == false

AND f_bACDON == true</result>
            <result name="!CR &amp;&amp; RC &amp;&amp; !ACD" link="178" stubbed="0" >f_bConfRecordON == false

AND f_bRecordON == true

AND f_bACDON == false</result>
            <result name="!CR &amp;&amp; RC &amp;&amp; ACD" link="16" stubbed="0" >f_bConfRecordON == false

AND f_bRecordON == true

AND f_bACDON == true</result>
            <result name="CR &amp;&amp; !RC &amp;&amp; !ACD" link="197" stubbed="0" >f_bConfRecordON == true

AND f_bRecordON == false

AND f_bACDON == false</result>
            <result name="CR &amp;&amp; !RC &amp;&amp; ACD" link="195" stubbed="0" >f_bConfRecordON == true

AND f_bRecordON == false

AND f_bACDON == true</result>
            <result name="CR &amp;&amp; RC &amp;&amp; !ACD" link="196" stubbed="0" >f_bConfRecordON == true

AND f_bRecordON == true

AND f_bACDON == false</result>
            <result name="CR &amp;&amp; RC &amp;&amp; ACD" link="198" stubbed="0" >f_bConfRecordON == true

AND f_bRecordON == true

AND f_bACDON == true</result>
          </results>
        </action>
        <action id="195" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2373 y=946 ?>
          <!--record flag OFF, ACD ON-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="60" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;([0-8]|9x|9.T|9.#|00|*0|*.T|#)&quot;" language="g_strLanguage" digits="f_strDigit" retry-count="3" clear-digits="1" terminating-digit="g_strTerminationDigit" quick-collect="0" digit-timer="" >
            <audio type="index" >518</audio>
            <audio type="index" >320</audio>
            <audio type="index" >905</audio>
            <audio type="index" >311</audio>
            <audio type="index" >855</audio>
            <audio type="index" >312</audio>
            <audio type="index" >856</audio>
            <audio type="index" >313</audio>
            <audio type="index" >861</audio>
            <audio type="index" >22</audio>
            <audio type="index" >309</audio>
            <audio type="index" >314</audio>
            <audio type="index" >g_nPromptLockUnLock</audio>
            <audio type="index" >315</audio>
            <audio type="index" >g_nPromptMuteUnMute</audio>
            <audio type="index" >316</audio>
            <audio type="index" >862</audio>
            <audio type="index" >f_nPromptPressX</audio>
            <audio type="index" >f_nPromptAllowDisallow</audio>
            <audio type="index" >f_nPromptWithoutMod</audio>
            <audio type="index" >318</audio>
            <audio type="index" >g_nPromptSelfMuteUnMute</audio>
            <audio type="index" >319</audio>
            <audio type="index" >906</audio>
            <audio type="index" >310</audio>
            <audio type="digits" >91</audio>
            <audio type="index" >947</audio>
            <audio type="index" >310</audio>
            <audio type="digits" >92</audio>
            <audio type="index" >521</audio>
            <audio type="index" >310</audio>
            <audio type="digits" >93</audio>
            <audio type="index" >g_nPROMPT_CONF_RECORD</audio>
            <audio type="index" >321</audio>
            <audio type="index" >889</audio>
            <audio type="index" >966</audio>
            <audio type="index" >963</audio>
            <audio type="index" >964</audio>
            <audio type="index" >962</audio>
            <timeout-prompt type="index" >s_nPromptNoResponse</timeout-prompt>
          </play>
          <results >
            <result name="Default" link="95" stubbed="1"/>
            <result name="Success" link="2" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="196" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2373 y=1118 ?>
          <!--record flag ON, ACD OFF-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="60" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;([0-8]|9x|9.T|9.#|*|#)&quot;" language="g_strLanguage" digits="f_strDigit" retry-count="3" clear-digits="1" terminating-digit="g_strTerminationDigit" quick-collect="0" digit-timer="" >
            <audio type="index" >518</audio>
            <audio type="index" >320</audio>
            <audio type="index" >905</audio>
            <audio type="index" >311</audio>
            <audio type="index" >855</audio>
            <audio type="index" >312</audio>
            <audio type="index" >856</audio>
            <audio type="index" >313</audio>
            <audio type="index" >861</audio>
            <audio type="index" >22</audio>
            <audio type="index" >309</audio>
            <audio type="index" >314</audio>
            <audio type="index" >g_nPromptLockUnLock</audio>
            <audio type="index" >315</audio>
            <audio type="index" >g_nPromptMuteUnMute</audio>
            <audio type="index" >316</audio>
            <audio type="index" >862</audio>
            <audio type="index" >940</audio>
            <audio type="index" >f_nPromptPressX</audio>
            <audio type="index" >f_nPromptAllowDisallow</audio>
            <audio type="index" >f_nPromptWithoutMod</audio>
            <audio type="index" >318</audio>
            <audio type="index" >g_nPromptSelfMuteUnMute</audio>
            <audio type="index" >319</audio>
            <audio type="index" >906</audio>
            <audio type="index" >310</audio>
            <audio type="digits" >91</audio>
            <audio type="index" >947</audio>
            <audio type="index" >310</audio>
            <audio type="digits" >92</audio>
            <audio type="index" >521</audio>
            <audio type="index" >310</audio>
            <audio type="digits" >93</audio>
            <audio type="index" >g_nPROMPT_CONF_RECORD</audio>
            <audio type="index" >321</audio>
            <audio type="index" >889</audio>
            <timeout-prompt type="index" >s_nPromptNoResponse</timeout-prompt>
          </play>
          <results >
            <result name="Default" link="95" stubbed="1"/>
            <result name="Success" link="255" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="197" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2383 y=790 ?>
          <!--record flag OFF, ACD OFF-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="60" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;([0-8]|9x|9.T|9.#|*|#)&quot;" language="g_strLanguage" digits="f_strDigit" retry-count="3" clear-digits="1" terminating-digit="g_strTerminationDigit" quick-collect="0" digit-timer="" >
            <audio type="index" >518</audio>
            <audio type="index" >320</audio>
            <audio type="index" >905</audio>
            <audio type="index" >311</audio>
            <audio type="index" >855</audio>
            <audio type="index" >312</audio>
            <audio type="index" >856</audio>
            <audio type="index" >313</audio>
            <audio type="index" >861</audio>
            <audio type="index" >22</audio>
            <audio type="index" >309</audio>
            <audio type="index" >314</audio>
            <audio type="index" >g_nPromptLockUnLock</audio>
            <audio type="index" >315</audio>
            <audio type="index" >g_nPromptMuteUnMute</audio>
            <audio type="index" >316</audio>
            <audio type="index" >862</audio>
            <audio type="index" >f_nPromptPressX</audio>
            <audio type="index" >f_nPromptAllowDisallow</audio>
            <audio type="index" >f_nPromptWithoutMod</audio>
            <audio type="index" >318</audio>
            <audio type="index" >g_nPromptSelfMuteUnMute</audio>
            <audio type="index" >319</audio>
            <audio type="index" >906</audio>
            <audio type="index" >310</audio>
            <audio type="digits" >91</audio>
            <audio type="index" >947</audio>
            <audio type="index" >310</audio>
            <audio type="digits" >92</audio>
            <audio type="index" >521</audio>
            <audio type="index" >310</audio>
            <audio type="digits" >93</audio>
            <audio type="index" >g_nPROMPT_CONF_RECORD</audio>
            <audio type="index" >321</audio>
            <audio type="index" >889</audio>
            <timeout-prompt type="index" >s_nPromptNoResponse</timeout-prompt>
          </play>
          <results >
            <result name="Default" link="95" stubbed="1"/>
            <result name="Success" link="255" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="198" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2356 y=1302 ?>
          <!--record flag ON, ACD ON-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="60" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;([0-8]|9x|9.T|9.#|00|*0|*.T|#)&quot;" language="g_strLanguage" digits="f_strDigit" retry-count="3" clear-digits="1" terminating-digit="g_strTerminationDigit" quick-collect="0" digit-timer="" >
            <audio type="index" >518</audio>
            <audio type="index" >320</audio>
            <audio type="index" >905</audio>
            <audio type="index" >311</audio>
            <audio type="index" >855</audio>
            <audio type="index" >312</audio>
            <audio type="index" >856</audio>
            <audio type="index" >313</audio>
            <audio type="index" >861</audio>
            <audio type="index" >22</audio>
            <audio type="index" >309</audio>
            <audio type="index" >314</audio>
            <audio type="index" >g_nPromptLockUnLock</audio>
            <audio type="index" >315</audio>
            <audio type="index" >g_nPromptMuteUnMute</audio>
            <audio type="index" >316</audio>
            <audio type="index" >862</audio>
            <audio type="index" >940</audio>
            <audio type="index" >f_nPromptPressX</audio>
            <audio type="index" >f_nPromptAllowDisallow</audio>
            <audio type="index" >f_nPromptWithoutMod</audio>
            <audio type="index" >318</audio>
            <audio type="index" >g_nPromptSelfMuteUnMute</audio>
            <audio type="index" >319</audio>
            <audio type="index" >906</audio>
            <audio type="index" >310</audio>
            <audio type="digits" >91</audio>
            <audio type="index" >947</audio>
            <audio type="index" >310</audio>
            <audio type="digits" >92</audio>
            <audio type="index" >521</audio>
            <audio type="index" >310</audio>
            <audio type="digits" >93</audio>
            <audio type="index" >g_nPROMPT_CONF_RECORD</audio>
            <audio type="index" >321</audio>
            <audio type="index" >889</audio>
            <audio type="index" >966</audio>
            <audio type="index" >963</audio>
            <audio type="index" >964</audio>
            <audio type="index" >962</audio>
            <timeout-prompt type="index" >s_nPromptNoResponse</timeout-prompt>
          </play>
          <results >
            <result name="Default" link="95" stubbed="1"/>
            <result name="Success" link="2" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="199" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2800 y=402 ?>
          <!--options-->
          <results >
            <result name="Default" link="188" stubbed="1"/>
            <result name="!CR &amp;&amp; !RC &amp;&amp; !ACD" link="188" stubbed="0" >f_bConfRecordON == false

AND f_bRecordON == false

AND f_bACDON == false</result>
            <result name="!CR &amp;&amp; !RC &amp;&amp; ACD" link="189" stubbed="0" >f_bConfRecordON == false

AND f_bRecordON == false

AND f_bACDON == true</result>
            <result name="!CR &amp;&amp; RC &amp;&amp; !ACD" link="185" stubbed="0" >f_bConfRecordON == false

AND f_bRecordON == true

AND f_bACDON == false</result>
            <result name="!CR &amp;&amp; RC &amp;&amp; ACD" link="184" stubbed="0" >f_bConfRecordON == false

AND f_bRecordON == true

AND f_bACDON == true</result>
            <result name="CR &amp;&amp; !RC &amp;&amp; !ACD" link="202" stubbed="0" >f_bConfRecordON == true

AND f_bRecordON == false

AND f_bACDON == false</result>
            <result name="CR &amp;&amp; !RC &amp;&amp; ACD" link="203" stubbed="0" >f_bConfRecordON == true

AND f_bRecordON == false

AND f_bACDON == true</result>
            <result name="CR &amp;&amp; RC &amp;&amp; !ACD" link="201" stubbed="0" >f_bConfRecordON == true

AND f_bRecordON == true

AND f_bACDON == false</result>
            <result name="CR &amp;&amp; RC &amp;&amp; ACD" link="200" stubbed="0" >f_bConfRecordON == true

AND f_bRecordON == true

AND f_bACDON == true</result>
          </results>
        </action>
        <action id="200" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=3133 y=1201 ?>
          <!--record flag ON, ACD ON-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="60" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;([0-8]|9x|9.T|#|9.#|00|*0|*.T)&quot;" language="g_strLanguage" digits="f_strDigit" retry-count="3" clear-digits="1" terminating-digit="g_strTerminationDigit" quick-collect="0" digit-timer="" >
            <audio type="index" >518</audio>
            <audio type="index" >320</audio>
            <audio type="index" >905</audio>
            <audio type="index" >311</audio>
            <audio type="index" >855</audio>
            <audio type="index" >312</audio>
            <audio type="index" >856</audio>
            <audio type="index" >nPromptPress3</audio>
            <audio type="index" >nPromptExtConfBy</audio>
            <audio type="index" >nPrompt30</audio>
            <audio type="index" >nPromptMinutes</audio>
            <audio type="index" >314</audio>
            <audio type="index" >g_nPromptLockUnLock</audio>
            <audio type="index" >315</audio>
            <audio type="index" >g_nPromptMuteUnMute</audio>
            <audio type="index" >316</audio>
            <audio type="index" >862</audio>
            <audio type="index" >940</audio>
            <audio type="index" >f_nPromptPressX</audio>
            <audio type="index" >f_nPromptAllowDisallow</audio>
            <audio type="index" >f_nPromptWithoutMod</audio>
            <audio type="index" >318</audio>
            <audio type="index" >g_nPromptSelfMuteUnMute</audio>
            <audio type="index" >319</audio>
            <audio type="index" >906</audio>
            <audio type="index" >310</audio>
            <audio type="digits" >93</audio>
            <audio type="index" >g_nPROMPT_CONF_RECORD</audio>
            <audio type="index" >321</audio>
            <audio type="index" >889</audio>
            <audio type="index" >966</audio>
            <audio type="index" >963</audio>
            <audio type="index" >964</audio>
            <audio type="index" >962</audio>
            <timeout-prompt type="index" >s_nPromptNoResponse</timeout-prompt>
          </play>
          <results >
            <result name="Default" link="95" stubbed="1"/>
            <result name="Success" link="2" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="201" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=3138 y=1057 ?>
          <!--record flag ON, ACD OFF-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="60" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;([0-8]|9x|9.T|#|9.#|*)&quot;" language="g_strLanguage" digits="f_strDigit" retry-count="3" clear-digits="1" terminating-digit="g_strTerminationDigit" quick-collect="0" digit-timer="" >
            <audio type="index" >518</audio>
            <audio type="index" >320</audio>
            <audio type="index" >905</audio>
            <audio type="index" >311</audio>
            <audio type="index" >855</audio>
            <audio type="index" >312</audio>
            <audio type="index" >856</audio>
            <audio type="index" >nPromptPress3</audio>
            <audio type="index" >nPromptExtConfBy</audio>
            <audio type="index" >nPrompt30</audio>
            <audio type="index" >nPromptMinutes</audio>
            <audio type="index" >314</audio>
            <audio type="index" >g_nPromptLockUnLock</audio>
            <audio type="index" >315</audio>
            <audio type="index" >g_nPromptMuteUnMute</audio>
            <audio type="index" >316</audio>
            <audio type="index" >862</audio>
            <audio type="index" >940</audio>
            <audio type="index" >f_nPromptPressX</audio>
            <audio type="index" >f_nPromptAllowDisallow</audio>
            <audio type="index" >f_nPromptWithoutMod</audio>
            <audio type="index" >318</audio>
            <audio type="index" >g_nPromptSelfMuteUnMute</audio>
            <audio type="index" >319</audio>
            <audio type="index" >906</audio>
            <audio type="index" >310</audio>
            <audio type="digits" >93</audio>
            <audio type="index" >g_nPROMPT_CONF_RECORD</audio>
            <audio type="index" >321</audio>
            <audio type="index" >889</audio>
            <timeout-prompt type="index" >s_nPromptNoResponse</timeout-prompt>
          </play>
          <results >
            <result name="Default" link="95" stubbed="1"/>
            <result name="Success" link="255" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="202" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=3157 y=755 ?>
          <!--record flag OFF, ACD OFF-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="60" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;([0-8]|9x|9.T|#|9.#|*)&quot;" language="g_strLanguage" digits="f_strDigit" retry-count="3" clear-digits="1" terminating-digit="g_strTerminationDigit" quick-collect="0" digit-timer="" >
            <audio type="index" >518</audio>
            <audio type="index" >320</audio>
            <audio type="index" >905</audio>
            <audio type="index" >311</audio>
            <audio type="index" >855</audio>
            <audio type="index" >312</audio>
            <audio type="index" >856</audio>
            <audio type="index" >nPromptPress3</audio>
            <audio type="index" >nPromptExtConfBy</audio>
            <audio type="index" >nPrompt30</audio>
            <audio type="index" >nPromptMinutes</audio>
            <audio type="index" >314</audio>
            <audio type="index" >g_nPromptLockUnLock</audio>
            <audio type="index" >315</audio>
            <audio type="index" >g_nPromptMuteUnMute</audio>
            <audio type="index" >316</audio>
            <audio type="index" >862</audio>
            <audio type="index" >f_nPromptPressX</audio>
            <audio type="index" >f_nPromptAllowDisallow</audio>
            <audio type="index" >f_nPromptWithoutMod</audio>
            <audio type="index" >318</audio>
            <audio type="index" >g_nPromptSelfMuteUnMute</audio>
            <audio type="index" >319</audio>
            <audio type="index" >906</audio>
            <audio type="index" >310</audio>
            <audio type="digits" >93</audio>
            <audio type="index" >g_nPROMPT_CONF_RECORD</audio>
            <audio type="index" >321</audio>
            <audio type="index" >889</audio>
            <timeout-prompt type="index" >s_nPromptNoResponse</timeout-prompt>
          </play>
          <results >
            <result name="Default" link="95" stubbed="1"/>
            <result name="Success" link="255" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="203" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=3136 y=907 ?>
          <!--record flag OFF, ACD ON-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="60" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;([0-8]|9x|9.T|9.#|00|*0|*.T|#)&quot;" language="g_strLanguage" digits="f_strDigit" retry-count="3" clear-digits="1" terminating-digit="g_strTerminationDigit" quick-collect="0" digit-timer="" >
            <audio type="index" >518</audio>
            <audio type="index" >320</audio>
            <audio type="index" >905</audio>
            <audio type="index" >311</audio>
            <audio type="index" >855</audio>
            <audio type="index" >312</audio>
            <audio type="index" >856</audio>
            <audio type="index" >nPromptPress3</audio>
            <audio type="index" >nPromptExtConfBy</audio>
            <audio type="index" >nPrompt30</audio>
            <audio type="index" >nPromptMinutes</audio>
            <audio type="index" >314</audio>
            <audio type="index" >g_nPromptLockUnLock</audio>
            <audio type="index" >315</audio>
            <audio type="index" >g_nPromptMuteUnMute</audio>
            <audio type="index" >316</audio>
            <audio type="index" >862</audio>
            <audio type="index" >f_nPromptPressX</audio>
            <audio type="index" >f_nPromptAllowDisallow</audio>
            <audio type="index" >f_nPromptWithoutMod</audio>
            <audio type="index" >318</audio>
            <audio type="index" >g_nPromptSelfMuteUnMute</audio>
            <audio type="index" >319</audio>
            <audio type="index" >906</audio>
            <audio type="index" >310</audio>
            <audio type="digits" >93</audio>
            <audio type="index" >g_nPROMPT_CONF_RECORD</audio>
            <audio type="index" >321</audio>
            <audio type="index" >889</audio>
            <audio type="index" >966</audio>
            <audio type="index" >963</audio>
            <audio type="index" >964</audio>
            <audio type="index" >962</audio>
            <timeout-prompt type="index" >s_nPromptNoResponse</timeout-prompt>
          </play>
          <results >
            <result name="Default" link="95" stubbed="1"/>
            <result name="Success" link="2" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="204" plug-in="Pactolus.Branch.1" ><?xtml-editor x=94 y=3096 ?>
          <!--prepaid conference-->
          <results >
            <result name="Default" link="95" stubbed="1"/>
            <result name="billing type == 1?" link="180" stubbed="0" >g_nBillingType == 1</result>
          </results>
        </action>
        <action id="205" plug-in="Pactolus.Branch.1" ><?xtml-editor x=95 y=3222 ?>
          <!--prepaid conference-->
          <results >
            <result name="Default" link="95" stubbed="1"/>
            <result name="billing type == 1?" link="181" stubbed="0" >g_nBillingType == 1</result>
          </results>
        </action>
        <action id="206" plug-in="Pactolus.Branch.1" ><?xtml-editor x=594 y=3647 ?>
          <!--conf rec ON-->
          <results >
            <result name="Default" link="95" stubbed="1"/>
            <result name="confRecordOn" link="207" stubbed="0" >f_bConfRecordON == true</result>
          </results>
        </action>
        <action id="207" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=853 y=3645 ?>
          <!--START_RECORD_REQUEST-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="s_strStartRecordRequest" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace=""/>
          <results >
            <result name="Default" link="208" stubbed="0"/>
            <result name="Success" link="213" stubbed="1"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)

{

	Server.logError("ERROR: FAIL TO SEND START RECORD REQUEST TO CONF CONTROLLER.");

	Server.logError("ERROR: CONF CONTROLLER IP: " + Session.g_strConfControllerIP);

	Server.logError("ERROR: CONF CONTROLLER PORT: " + Session.g_nConfControllerPort);

}]]></script>
          </scripts>
        </action>
        <action id="208" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1100 y=3643 ?>
          <!--fail to start record-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >957</audio>
          </play>
          <results >
            <result name="Default" link="259" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="209" plug-in="Pactolus.Branch.1" ><?xtml-editor x=359 y=3548 ?>
          <!--start or stop-->
          <results >
            <result name="Default" link="211" stubbed="0"/>
            <result name="start" link="206" stubbed="0"/>
          </results>
        </action>
        <action id="210" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=815 y=3473 ?>
          <!--fail to stop record-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >958</audio>
          </play>
          <results >
            <result name="Default" link="259" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="211" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=568 y=3475 ?>
          <!--STOP_RECORD_REQUEST-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="s_strStopRecordRequest" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace=""/>
          <results >
            <result name="Default" link="210" stubbed="0"/>
            <result name="Success" link="215" stubbed="1"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)

{

	Server.logError("ERROR: FAIL TO SEND STOP RECORD REQUEST TO CONF CONTROLLER.");

	Server.logError("ERROR: CONF CONTROLLER IP: " + Session.g_strConfControllerIP);

	Server.logError("ERROR: CONF CONTROLLER PORT: " + Session.g_nConfControllerPort);

}]]></script>
          </scripts>
        </action>
        <action id="212" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1666 y=3639 ?>
          <!--record started-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >955</audio>
          </play>
          <results >
            <result name="Default" link="95" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="213" plug-in="Standard.WaitEvent.1" ><?xtml-editor x=1366 y=3646 ?>
          <wait xmlns="urn:www.pactolus.com:xtml:communication" timeout="10" recv-name="g_strEventReceived" >
            <msg name="StartRecordResponse" >
              <parameter >f_nReturnCode</parameter>
              <parameter >g_strReturnMsg</parameter>
            </msg>
          </wait>
          <results >
            <result name="Default" link="208" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
            <result name="SUCCESS" link="212" stubbed="0" >'Result'  == 'Success'

AND f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_nReturnCode = -50;

Session.g_strReturnMsg = "";]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 5)

{

	Server.logError("ERROR: FAIL TO WAIT FOR START RECORD RESPONSE");

	Server.logError("ERROR: EXIT ON: " + Result.name);

	Server.logError("ERROR: RETURN CODE: " + Session.f_nReturnCode);

	Server.logError("ERROR: RETURN MESSAGE: " + Session.g_strReturnMsg);

}]]></script>
          </scripts>
        </action>
        <action id="214" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1399 y=3499 ?>
          <!--record stopped-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >956</audio>
          </play>
          <results >
            <result name="Default" link="95" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="215" plug-in="Standard.WaitEvent.1" ><?xtml-editor x=1099 y=3506 ?>
          <wait xmlns="urn:www.pactolus.com:xtml:communication" timeout="10" recv-name="g_strEventReceived" >
            <msg name="StopRecordResponse" >
              <parameter >f_nReturnCode</parameter>
              <parameter >g_strReturnMsg</parameter>
            </msg>
          </wait>
          <results >
            <result name="Default" link="95" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
            <result name="SUCCESS" link="214" stubbed="0" >'Result'  == 'Success'

AND f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_nReturnCode = -50;

Session.g_strReturnMsg = "";]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 5)

{

	Server.logError("ERROR: FAIL TO WAIT FOR STOP RECORD RESPONSE");

	Server.logError("ERROR: EXIT ON: " + Result.name);

	Server.logError("ERROR: RETURN CODE: " + Session.f_nReturnCode);

	Server.logError("ERROR: RETURN MESSAGE: " + Session.g_strReturnMsg);

}]]></script>
          </scripts>
        </action>
        <action id="216" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=879 y=2915 ?>
          <!--Are you sure want the conference to end?-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="13" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;(x|*|#)&quot;" language="g_strLanguage" digits="f_strDigit" retry-count="1" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >916</audio>
            <audio type="index" >311</audio>
            <audio type="index" >582</audio>
            <timeout-prompt type="index" >s_nPromptNoResponse</timeout-prompt>
          </play>
          <results >
            <result name="Default" link="95" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
            <result name="strDigit = 1" link="4" stubbed="0" >f_strDigit match "1"</result>
          </results>
        </action>
        <action id="218" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=307 y=563 ?>
          <!--Main Menu with CSR-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="f_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;(00|99|*1|*5|*6|*8|*0|*#|**|##|x.T|*.T|#.T)&quot;" language="g_strLanguage" digits="f_strDigit" retry-count="" clear-digits="1" terminating-digit="g_strTerminationDigit" quick-collect="0" digit-timer="" >
            <audio type="index" >518</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >f_nPromptOne</audio>
            <audio type="index" >f_nPromptTwo</audio>
            <audio type="silence" >.3</audio>
            <audio type="index" >354</audio>
            <audio type="index" >g_nPromptLockUnLock</audio>
            <audio type="silence" >.3</audio>
            <audio type="index" >355</audio>
            <audio type="index" >g_nPromptSelfMuteUnMute</audio>
            <audio type="silence" >.4</audio>
            <audio type="index" >f_nPromptPressX</audio>
            <audio type="index" >f_nPromptAllowDisallow</audio>
            <audio type="index" >f_nPromptWithoutMod</audio>
            <audio type="silence" >.3</audio>
            <audio type="index" >965</audio>
            <audio type="index" >859</audio>
            <audio type="silence" >.3</audio>
            <audio type="index" >967</audio>
            <audio type="index" >860</audio>
            <audio type="silence" >.3</audio>
            <audio type="index" >360</audio>
            <audio type="index" >862</audio>
            <audio type="silence" >0.4</audio>
            <audio type="index" >964</audio>
            <audio type="index" >962</audio>
            <audio type="silence" >0.4</audio>
            <audio type="index" >966</audio>
            <audio type="index" >963</audio>
            <audio type="silence" >0.4</audio>
            <audio type="index" >359</audio>
            <audio type="index" >968</audio>
          </play>
          <results >
            <result name="Default" link="95" stubbed="1"/>
            <result name="Success" link="220" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout" link="258" stubbed="1"/>
          </results>
        </action>
        <action id="219" plug-in="Pactolus.Branch.1" ><?xtml-editor x=554 y=208 ?>
          <results >
            <result name="Default" link="257" stubbed="1"/>
            <result name="1- hear participant count" link="252" stubbed="1" >f_strDigit match "^1$"</result>
            <result name="2- hear recorded name" link="155" stubbed="1" >f_strDigit match "^2$"</result>
            <result name="3- add party" link="99" stubbed="1" >f_strDigit match "^3$"</result>
            <result name="4-lock/unlock conf" link="61" stubbed="1" >f_strDigit match "^4$"</result>
            <result name="5-mute/unmute all" link="62" stubbed="1" >f_strDigit match "^5$"</result>
            <result name="6-allow/disallow conf continue" link="256" stubbed="1" >f_strDigit match "^6$"</result>
            <result name="#- return to conf" link="95" stubbed="1" >f_strDigit match "^\#$"

OR g_strTerminationDigit match "#"</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[Session.g_strTerminationDigit = "";]]></script>
          </scripts>
        </action>
        <action id="220" plug-in="Pactolus.Branch.1" ><?xtml-editor x=573 y=725 ?>
          <!--what digit?-->
          <results >
            <result name="Default" link="95" stubbed="1"/>
            <result name="*1 Add Participant" link="254" stubbed="1" >f_strDigit match "^\*{1}1{1}$"</result>
            <result name="*5 Lock/Unlock" link="61" stubbed="1" >f_strDigit match "^\*{1}5{1}$"</result>
            <result name="*6 Mute/Unmute Self" link="67" stubbed="1" >f_strDigit match "^\*{1}6{1}$"</result>
            <result name="*8 Allow/Disallow to continue" link="256" stubbed="1" >f_strDigit match "^\*{1}8{1}$"</result>
            <result name="## Mute All" link="18" stubbed="1" >f_strDigit match "^\#{2}$"</result>
            <result name="99 UnMute All" link="19" stubbed="1" >f_strDigit match "9{2}$"</result>
            <result name="*# Participant Count" link="252" stubbed="1" >f_strDigit match "^\*{1}\#{1}$"</result>
            <result name="*0 Private Talk CSR" link="222" stubbed="0" >f_strDigit match "^\*{1}0{1}$"
AND g_bTalkingWithCSR == false
AND g_bWaitForCSR == false</result>
            <result name="00 CSR" link="174" stubbed="1" >f_strDigit match "^0{2}$"
AND g_bTalkingWithCSR == false
AND g_bWaitForCSR == false</result>
            <result name="** Main Menu" link="248" stubbed="1" >f_strDigit match "^\*{2}$"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("Collected digits : " + Session.f_strDigit);
Server.logInfo("Terminated digit: " + Session.g_strTerminationDigit);]]></script>
            <script language="javascript" timing="last" ><![CDATA[Session.g_strTerminationDigit = "";
if (9 == Result.id)
{
	Session.g_nRequestCSRType = 1;
	Session.g_strRequestCSRPrivateTalkFlag = "T";
}
else if (10 == Result.id)
{
	Session.g_nRequestCSRType = 1;
	Session.g_strRequestCSRPrivateTalkFlag = "F";	
}]]></script>
          </scripts>
        </action>
        <action id="221" plug-in="Pactolus.Branch.1" ><?xtml-editor x=54 y=910 ?>
          <!--operator assist type-->
          <results >
            <result name="Default" link="246" stubbed="1"/>
            <result name="(type 0 and mod) or type 1" link="253" stubbed="0" >(g_nOperatorAssistType == 0
AND f_bModeratorFlag == true)
OR g_nOperatorAssistType == 1</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if ("T" == Session.g_strModeratorFlag)
{
	Session.f_bModeratorFlag = true;
}
else
{
	Session.f_bModeratorFlag = false;
}

if ("eng" == Session.g_strLanguage)
{
	if ( ( (0 == Session.g_nOperatorAssistType && Session.f_bModeratorFlag) || Session.g_nOperatorAssistType == 1 ) && "T" == Session.g_strACDEnable )
	{
		if (1 == Session.g_nOutdialOption)
		{
			Session.f_nPromptOne = 99;
			Session.f_nPromptTwo = 99;
			Session.f_nTimeout = 32;
		}
		else
		{
			Session.f_nTimeout = 36;
		}
	}
	else
	{
		if (1 == Session.g_nOutdialOption)
		{
			Session.f_nPromptOne = 99;
			Session.f_nPromptTwo = 99;
			Session.f_nTimeout = 26;
		}
		else
		{
			Session.f_nTimeout = 30;
		}	
	}
}
else
{
	if ( ( (0 == Session.g_nOperatorAssistType && Session.f_bModeratorFlag) || Session.g_nOperatorAssistType == 1 ) && "T" == Session.g_strACDEnable )
	{
		if (1 == Session.g_nOutdialOption)
		{
			Session.f_nPromptOne = 99;
			Session.f_nPromptTwo = 99;
			Session.f_nTimeout = 100;
		}
		else
		{
			Session.f_nTimeout = 104;
		}
	}
	else
	{
		if (1 == Session.g_nOutdialOption)
		{
			Session.f_nPromptOne = 99;
			Session.f_nPromptTwo = 99;
			Session.f_nTimeout = 80;
		}
		else
		{
			Session.f_nTimeout = 84;
		}	
	}
}]]></script>
          </scripts>
        </action>
        <action id="222" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=843 y=723 ?>
          <!--"SideBarOperatorRequest"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;SideBarOperatorRequest&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="95" stubbed="1"/>
            <result name="SUCCESS" link="95" stubbed="1" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_disable_event();
Session.f_nReturnCode = -1;
Server.logInfo("SidebarOperatorRequest disable events...");
]]></script>
          </scripts>
        </action>
        <action id="225" plug-in="Pactolus.Branch.1" ><?xtml-editor x=555 y=412 ?>
          <!--what digit?-->
          <results >
            <result name="Default" link="95" stubbed="1"/>
            <result name="*1 Add Participant" link="254" stubbed="1" >f_strDigit match "^\*{1}1{1}$"</result>
            <result name="*5 Lock/Unlock" link="61" stubbed="1" >f_strDigit match "^\*{1}5{1}$"</result>
            <result name="*6 Mute/Unmute Self" link="67" stubbed="1" >f_strDigit match "^\*{1}6{1}$"</result>
            <result name="*8 Allow/Disallow to continue" link="256" stubbed="1" >f_strDigit match "^\*{1}8{1}$"</result>
            <result name="## Mute All" link="18" stubbed="1" >f_strDigit match "^\#{2}$"</result>
            <result name="99 UnMute All" link="19" stubbed="1" >f_strDigit match "9{2}$"</result>
            <result name="*# Participant Count" link="252" stubbed="1" >f_strDigit match "^\*{1}\#{1}$"</result>
            <result name="** Main Menu" link="246" stubbed="1" >f_strDigit match "^\*{2}$"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("Collected digits : " + Session.f_strDigit);
Server.logInfo("Terminated digit: " + Session.g_strTerminationDigit);]]></script>
            <script language="javascript" timing="last" ><![CDATA[Session.g_strTerminationDigit = "";]]></script>
          </scripts>
        </action>
        <action id="226" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=303 y=1200 ?>
          <!--UnmutePartyRequest-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="s_strUnmutePartyRequest" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;callerPassCode&quot;" value="g_strCCGeneratedPassCode"/>
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="229" stubbed="1"/>
            <result name="Success" link="227" stubbed="0"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_disable_event();

Server.logInfo("INFO: **** UNMUTE PARTY REQUEST ****");]]></script>
          </scripts>
        </action>
        <action id="227" plug-in="Standard.WaitEvent.1" ><?xtml-editor x=550 y=1196 ?>
          <!--UnmutePartyResponse-->
          <wait xmlns="urn:www.pactolus.com:xtml:communication" timeout="5" recv-name="g_strEventReceived" >
            <msg name="UnmutePartyResponse" >
              <parameter >f_strConfControllerIP</parameter>
              <parameter >f_nConfControllerPort</parameter>
              <parameter >f_strTransactionId</parameter>
              <parameter >f_nReturnCode</parameter>
              <parameter >f_strReturnMsg</parameter>
            </msg>
          </wait>
          <results >
            <result name="Default" link="229" stubbed="1"/>
            <result name="Success" link="228" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_nReturnCode = -1;]]></script>
            <script language="javascript" timing="last" ><![CDATA[js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="228" plug-in="Pactolus.Branch.1" ><?xtml-editor x=787 y=1225 ?>
          <!--success?-->
          <results >
            <result name="Default" link="229" stubbed="0"/>
            <result name="f_nReturnCode == 0" link="231" stubbed="0" >f_nReturnCode == 0</result>
          </results>
        </action>
        <action id="229" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=777 y=1050 ?>
          <!--can't unmute-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >933</audio>
          </play>
          <results >
            <result name="Default" link="95" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="230" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=330 y=1535 ?>
          <!--SELF UNMUTE PARTY-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="g_strResponseTransactionId" message-name="s_strConfUnmutePartyEvent" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;callerPassCode&quot;" value="g_strCCGeneratedPassCode"/>
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="232" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: **** SELF UNMUTE ****");]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)

{

	Server.logError("ERROR: FAIL TO SEND SOAP MESSAGE UNMUTE YOUR OWN LINE.");

}]]></script>
          </scripts>
        </action>
        <action id="231" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=82 y=1364 ?>
          <!--"ChangeToConferenceMode"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ChangeToConferenceMode&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="229" stubbed="1"/>
            <result name="SUCCESS" link="235" stubbed="0" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: MODIFY MEMBER TO UNMUTE.");

Session.g_oMS.bMuteFlag = false;]]></script>
          </scripts>
        </action>
        <action id="232" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=585 y=1534 ?>
          <!--your line unmuted-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >s_nPromptUnmuted</audio>
          </play>
          <results >
            <result name="Default" link="95" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nPromptSelfMuteUnMute = 907;
Session.g_bMutedState = false;
Server.logInfo("CURRENT MUTE STATE IS: " + Session.g_bMutedState);]]></script>
          </scripts>
        </action>
        <action id="233" plug-in="Pactolus.Branch.1" ><?xtml-editor x=61 y=1086 ?>
          <!--CallPartyFlag==T?-->
          <results >
            <result name="Default" link="234" stubbed="0"/>
            <result name="g_strPartyPasscodeFlag==T" link="226" stubbed="0" >g_strPartyPasscodeFlag match "T"</result>
          </results>
        </action>
        <action id="234" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=287 y=1061 ?>
          <!--UnmutePartyRequest-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="s_strUnmutePartyRequest" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;callerPassCode&quot;" value="g_strCCGeneratedPassCode"/>
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="229" stubbed="1"/>
            <result name="Success" link="227" stubbed="1"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_disable_event();

Server.logInfo("INFO: **** UNMUTE PARTY REQUEST ****");]]></script>
          </scripts>
        </action>
        <action id="235" plug-in="Pactolus.Branch.1" ><?xtml-editor x=319 y=1362 ?>
          <!--CallPartyFlag==T?-->
          <results >
            <result name="Default" link="236" stubbed="0"/>
            <result name="g_strPartyPasscodeFlag==T" link="230" stubbed="0" >g_strPartyPasscodeFlag match "T"</result>
          </results>
        </action>
        <action id="236" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=562 y=1352 ?>
          <!--SELF UNMUTE PARTY-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="g_strResponseTransactionId" message-name="s_strConfUnmutePartyEvent" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;callerPassCode&quot;" value="g_strCCGeneratedPassCode"/>
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="232" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: **** SELF UNMUTE ****");]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)

{

	Server.logError("ERROR: FAIL TO SEND SOAP MESSAGE UNMUTE YOUR OWN LINE.");

}]]></script>
          </scripts>
        </action>
        <action id="241" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=288 y=416 ?>
          <!--Main Menu no CSR-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="f_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;(00|99|*1|*5|*6|*8|*0|*#|**|##|x.T|*.T|#.T)&quot;" language="g_strLanguage" digits="f_strDigit" retry-count="" clear-digits="1" terminating-digit="g_strTerminationDigit" quick-collect="0" digit-timer="" >
            <audio type="index" >518</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >f_nPromptOne</audio>
            <audio type="index" >f_nPromptTwo</audio>
            <audio type="silence" >.3</audio>
            <audio type="index" >354</audio>
            <audio type="index" >g_nPromptLockUnLock</audio>
            <audio type="silence" >.3</audio>
            <audio type="index" >355</audio>
            <audio type="index" >g_nPromptSelfMuteUnMute</audio>
            <audio type="silence" >.4</audio>
            <audio type="index" >f_nPromptPressX</audio>
            <audio type="index" >f_nPromptAllowDisallow</audio>
            <audio type="index" >f_nPromptWithoutMod</audio>
            <audio type="silence" >.3</audio>
            <audio type="index" >965</audio>
            <audio type="index" >859</audio>
            <audio type="silence" >.3</audio>
            <audio type="index" >967</audio>
            <audio type="index" >860</audio>
            <audio type="silence" >.3</audio>
            <audio type="index" >360</audio>
            <audio type="index" >862</audio>
            <audio type="silence" >0.3</audio>
            <audio type="index" >359</audio>
            <audio type="index" >968</audio>
          </play>
          <results >
            <result name="Default" link="95" stubbed="1"/>
            <result name="Success" link="225" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout" link="258" stubbed="1"/>
          </results>
        </action>
        <action id="242" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1067 y=3194 ?>
          <!--"ChangeToMutedMode"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ChangeToMutedMode&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="109" stubbed="1"/>
          </results>
        </action>
        <action id="243" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1636 y=483 ?>
          <!--mute state?-->
          <results >
            <result name="Default" link="244" stubbed="0"/>
            <result name="g_bMutedState" link="242" stubbed="1" >g_bMutedState == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("CURRENT MUTE STATE IS: " + Session.g_bMutedState);

Server.logInfo("CURRENT HOLD STATE IS: " + Session.g_bHoldState);

if (Session.g_bHoldState)

{

	Session.g_oMS.bMuteFlag = true;

	Session.g_oMS.bDeafFlag = true;

}

else if (Session.g_bMutedState)

{

	Session.g_oMS.bMuteFlag = true;

	Session.g_oMS.bDeafFlag = false;

}

else

{

	Session.g_oMS.bMuteFlag = false;

	Session.g_oMS.bDeafFlag = false;

}]]></script>
          </scripts>
        </action>
        <action id="244" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1873 y=477 ?>
          <!--"ChangeToConferenceMode"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ChangeToConferenceMode&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="54" stubbed="1"/>
            <result name="SUCCESS" link="109" stubbed="1" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: MOD MAIN MENU MODIFY MEMBER RETURN TO CONFERENCE.");]]></script>
          </scripts>
        </action>
        <action id="246" plug-in="Pactolus.Branch.1" ><?xtml-editor x=44 y=333 ?>
          <!--eng-->
          <results >
            <result name="Default" link="247" stubbed="0"/>
            <result name="g_strLanguage==eng" link="241" stubbed="0" >g_strLanguage match "eng"</result>
          </results>
        </action>
        <action id="247" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=284 y=272 ?>
          <!--Main Menu no CSR-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="f_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;(00|99|*1|*5|*6|*8|*0|*#|**|##|x.T|*.T|#.T)&quot;" language="g_strLanguage" digits="f_strDigit" retry-count="" clear-digits="1" terminating-digit="g_strTerminationDigit" quick-collect="0" digit-timer="" >
            <audio type="index" >518</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >f_nPromptOne</audio>
            <audio type="index" >f_nPromptTwo</audio>
            <audio type="silence" >.3</audio>
            <audio type="index" >354</audio>
            <audio type="index" >g_nPromptLockUnLock</audio>
            <audio type="silence" >.3</audio>
            <audio type="index" >355</audio>
            <audio type="index" >g_nPromptSelfMuteUnMute</audio>
            <audio type="silence" >.4</audio>
            <audio type="index" >f_nPromptPressX</audio>
            <audio type="index" >f_nPromptAllowDisallow</audio>
            <audio type="index" >f_nPromptWithoutMod</audio>
            <audio type="silence" >.3</audio>
            <audio type="index" >965</audio>
            <audio type="index" >859</audio>
            <audio type="silence" >.3</audio>
            <audio type="index" >967</audio>
            <audio type="index" >860</audio>
            <audio type="silence" >.3</audio>
            <audio type="index" >360</audio>
            <audio type="index" >862</audio>
            <audio type="silence" >0.3</audio>
            <audio type="index" >359</audio>
            <audio type="index" >968</audio>
          </play>
          <results >
            <result name="Default" link="95" stubbed="1"/>
            <result name="Success" link="225" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout" link="258" stubbed="1"/>
          </results>
        </action>
        <action id="248" plug-in="Pactolus.Branch.1" ><?xtml-editor x=61 y=652 ?>
          <!--eng-->
          <results >
            <result name="Default" link="218" stubbed="0"/>
            <result name="g_strLanguage==eng" link="249" stubbed="0" >g_strLanguage match "eng"</result>
          </results>
        </action>
        <action id="249" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=326 y=745 ?>
          <!--Main Menu with CSR-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="f_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;(00|99|*1|*5|*6|*8|*0|*#|**|##|x.T|*.T|#.T)&quot;" language="g_strLanguage" digits="f_strDigit" retry-count="" clear-digits="1" terminating-digit="g_strTerminationDigit" quick-collect="0" digit-timer="" >
            <audio type="index" >518</audio>
            <audio type="silence" >.2</audio>
            <audio type="index" >f_nPromptOne</audio>
            <audio type="index" >f_nPromptTwo</audio>
            <audio type="silence" >.3</audio>
            <audio type="index" >354</audio>
            <audio type="index" >g_nPromptLockUnLock</audio>
            <audio type="silence" >.3</audio>
            <audio type="index" >355</audio>
            <audio type="index" >g_nPromptSelfMuteUnMute</audio>
            <audio type="silence" >.4</audio>
            <audio type="index" >f_nPromptPressX</audio>
            <audio type="index" >f_nPromptAllowDisallow</audio>
            <audio type="index" >f_nPromptWithoutMod</audio>
            <audio type="silence" >.3</audio>
            <audio type="index" >965</audio>
            <audio type="index" >859</audio>
            <audio type="silence" >.3</audio>
            <audio type="index" >967</audio>
            <audio type="index" >860</audio>
            <audio type="silence" >.3</audio>
            <audio type="index" >360</audio>
            <audio type="index" >862</audio>
            <audio type="silence" >0.4</audio>
            <audio type="index" >964</audio>
            <audio type="index" >962</audio>
            <audio type="silence" >0.4</audio>
            <audio type="index" >966</audio>
            <audio type="index" >963</audio>
            <audio type="silence" >0.4</audio>
            <audio type="index" >359</audio>
            <audio type="index" >968</audio>
          </play>
          <results >
            <result name="Default" link="95" stubbed="1"/>
            <result name="Success" link="220" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout" link="258" stubbed="1"/>
          </results>
        </action>
        <action id="250" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1964 y=1944 ?>
          <results >
            <result name="Default" link="95" stubbed="1"/>
            <result name="==1" link="22" stubbed="1" >g_nCurrentNbrCallegs == 1</result>
            <result name="&gt;=2" link="82" stubbed="0" >g_nCurrentNbrCallegs &gt;= 2</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.enableEvents(true);]]></script>
          </scripts>
        </action>
        <action id="251" plug-in="Standard.WaitEvent.1" ><?xtml-editor x=1745 y=1946 ?>
          <!--ConfGetCallerCountResponse-->
          <wait xmlns="urn:www.pactolus.com:xtml:communication" timeout="5" recv-name="g_strEventReceived" >
            <msg name="ConfGetCallerCountResponse" >
              <parameter >f_strConfControllerIP</parameter>
              <parameter >f_nConfControllerPort</parameter>
              <parameter >f_strTransactionId</parameter>
              <parameter >f_strConfScheduleId</parameter>
              <parameter >g_nCurrentNbrCallegs</parameter>
            </msg>
          </wait>
          <results >
            <result name="Default" link="250" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nCurrentNbrCallegs = 0;]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)
{
	Server.logError("NO RESPONSE FOR ConfGetCallerCountRequest, exit on: " + Result.name);
}]]></script>
          </scripts>
        </action>
        <action id="252" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1491 y=1949 ?>
          <!--ConfGetCallerCountRequest-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="s_strConfGetCallerCountRequest" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="95" stubbed="1"/>
            <result name="Success" link="251" stubbed="0"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.enableEvents(false);
Server.logInfo("INFO: **** ConfGetCallerCountRequest ****");]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)
{
	Server.logError("ERROR: FAIL TO SEND SOAP MESSAGE ConfGetCallerCountRequest.");
}]]></script>
          </scripts>
        </action>
        <action id="253" plug-in="Pactolus.Branch.1" ><?xtml-editor x=300 y=908 ?>
          <!--operator assist type-->
          <results >
            <result name="Default" link="246" stubbed="1"/>
            <result name="ACDEnable" link="248" stubbed="1" >g_strACDEnable match "T"</result>
          </results>
        </action>
        <action id="254" plug-in="Pactolus.Branch.1" ><?xtml-editor x=557 y=622 ?>
          <results >
            <result name="Default" link="99" stubbed="1"/>
            <result name="g_nOutdialOption==1" link="95" stubbed="1" >g_nOutdialOption == 1</result>
          </results>
        </action>
        <action id="255" plug-in="Pactolus.Branch.1" ><?xtml-editor x=785 y=88 ?>
          <!--NO CSR-->
          <results >
            <result name="Default" link="257" stubbed="0"/>
            <result name="1-add party" link="99" stubbed="1" >f_strDigit match "^1$"</result>
            <result name="2-drop last party" link="85" stubbed="1" >f_strDigit match "^2$"</result>
            <result name="3-extent by 30 mins" link="153" stubbed="1" >f_strDigit match "^3$"
AND g_bReservationlessConf == false</result>
            <result name="4-lock/unlock conf" link="61" stubbed="1" >f_strDigit match "^4$"</result>
            <result name="5-mute/unmute all" link="62" stubbed="1" >f_strDigit match "^5$"</result>
            <result name="6-count party" link="252" stubbed="1" >f_strDigit match "^6$"</result>
            <result name="7-allow/disallow conf continue" link="256" stubbed="1" >f_strDigit match "^7$"</result>
            <result name="8-self mute/unmute" link="67" stubbed="1" >f_strDigit match "^8$"</result>
            <result name="91 time remaining" link="204" stubbed="1" >f_strDigit match "^9{1}1{1}$"</result>
            <result name="92 balance remaining" link="205" stubbed="1" >f_strDigit match "^9{1}2{1}$"</result>
            <result name="93 conf record" link="206" stubbed="1" >f_strDigit match "^9{1}3{1}$"</result>
            <result name="9-repeat main menu" link="182" stubbed="1" >f_strDigit match "^9{1}$"</result>
            <result name="#-end conf" link="216" stubbed="1" >f_strDigit match "^\#$"

OR g_strTerminationDigit match "#"</result>
            <result name="*-return to conf" link="95" stubbed="1" >f_strDigit match "^\*$"</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[Session.g_strTerminationDigit = "";]]></script>
          </scripts>
        </action>
        <action id="256" plug-in="Pactolus.Branch.1" ><?xtml-editor x=652 y=2390 ?>
          <!--mod required?-->
          <results >
            <result name="Default" link="95" stubbed="1"/>
            <result name="f_bModRequired" link="63" stubbed="0" >f_bModRequired == true</result>
          </results>
        </action>
        <action id="257" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1072 y=80 ?>
          <!--invalid choice-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >337</audio>
          </play>
          <results >
            <result name="Default" link="95" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="258" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=557 y=56 ?>
          <!--no response-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >552</audio>
          </play>
          <results >
            <result name="Default" link="95" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="259" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1089 y=3416 ?>
          <!--HangUp Caller-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpCaller&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="116" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 40;
Session.g_nConfLeaveReason = 7;
Session.g_strConfLeaveMsg = "FAIL TO SEND START/STOP RECORD CONFERENCE TO CC";]]></script>
          </scripts>
        </action>
      </actions>
    </function>
    <function name="RemoveOldAddNew" start="51" event="RemoveOldAddNew" returns="i4" >
      <local-vars >
        <var name="f_nReturnCode" type="i4" >-1</var>
        <var name="f_oConfMS" type="object" ></var>
        <var name="f_bCreateNewConf" type="boolean" >0</var>
      </local-vars>
      <actions >
        <action id="51" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=27 y=455 ?>
          <!--"StopTimer"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;StopTimer&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="45" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: RemoveOldAddNew");]]></script>
          </scripts>
        </action>
        <action id="3" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1190 y=113 ?>
          <!--s_nFailure-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nReturnCode"/>
        </action>
        <action id="15" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=504 y=402 ?>
          <!--Remove member from conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;RemoveMemberFromConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="16" stubbed="0"/>
          </results>
        </action>
        <action id="16" plug-in="Pactolus.Branch.1" ><?xtml-editor x=727 y=398 ?>
          <!--success?-->
          <results >
            <result name="Default" link="57" stubbed="0"/>
            <result name="success?" link="19" stubbed="0" >f_nReturnCode == s_nSuccess</result>
          </results>
        </action>
        <action id="19" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=961 y=634 ?>
          <!--Create a temp Conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;CreateConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
          </function>
          <results >
            <result name="Default" link="40" stubbed="0"/>
            <result name="SUCCESS" link="36" stubbed="1" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: FROM MAIN MENU, CREATE TEMP CONFERENCE TO OUTDIAL PARTY.");
Session.g_oTempConf.strConferenceId = "";]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Session.f_nReturnCode == Session.s_nSuccess)

{

	Session.g_bCreatedTempConf = true;

}]]></script>
          </scripts>
        </action>
        <action id="22" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=665 y=882 ?>
          <!--AddMemberToTempConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
            <parameter >g_oCallLegA</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="23" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: FROM MAIN MENU, ADD MEMBER TO TEMP CONFERENCE TO OUTDIAL PARTY.");]]></script>
          </scripts>
        </action>
        <action id="23" plug-in="Pactolus.Branch.1" ><?xtml-editor x=903 y=878 ?>
          <!--success?-->
          <results >
            <result name="Default" link="64" stubbed="0"/>
            <result name="FAILURE" link="27" stubbed="0" >f_nReturnCode == s_nFailure</result>
            <result name="CALLERHUNGUP" link="29" stubbed="0" >f_nReturnCode == s_nCallerHungup</result>
          </results>
        </action>
        <action id="27" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1156 y=868 ?>
          <!--delete temp conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DeleteConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
          </function>
          <results >
            <result name="Default" link="40" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[Session.g_bCreatedTempConf = false;]]></script>
          </scripts>
        </action>
        <action id="28" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1621 y=466 ?>
          <!--put back to old conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
            <parameter >g_oCallLegA</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="65" stubbed="0"/>
            <result name="FAILURE" link="66" stubbed="0" >f_nReturnCode == s_nFailure</result>
            <result name="CALLER HUNGUP" link="44" stubbed="1" >f_nReturnCode == s_nCallerHungup</result>
          </results>
        </action>
        <action id="29" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1153 y=994 ?>
          <!--delete temp conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DeleteConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
          </function>
          <results >
            <result name="Default" link="44" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[Session.g_bCreatedTempConf = false;]]></script>
          </scripts>
        </action>
        <action id="30" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1399 y=1098 ?>
          <!--s_nSuccess-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nReturnCode"/>
        </action>
        <action id="36" plug-in="Pactolus.Branch.1" ><?xtml-editor x=432 y=941 ?>
          <!--Dial In?-->
          <results >
            <result name="Default" link="22" stubbed="0"/>
            <result name="g_strOutdialFlag = &quot;T&quot;;" link="37" stubbed="0" >g_strOutdialFlag match "T"</result>
          </results>
        </action>
        <action id="37" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=680 y=1058 ?>
          <!--AddMemberToTempConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
            <parameter >g_oCallLegB</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="23" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: FROM MAIN MENU, ADD MEMBER TO TEMP CONFERENCE TO OUTDIAL PARTY.");]]></script>
          </scripts>
        </action>
        <action id="40" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1182 y=633 ?>
          <!--Dial In?-->
          <results >
            <result name="Default" link="48" stubbed="0"/>
            <result name="g_strOutdialFlag = &quot;T&quot;;" link="47" stubbed="0" >g_strOutdialFlag match "T"</result>
          </results>
        </action>
        <action id="42" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1656 y=744 ?>
          <!--put B back to old conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
            <parameter >g_oCallLegB</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="65" stubbed="1"/>
            <result name="FAILURE" link="66" stubbed="1" >f_nReturnCode == s_nFailure</result>
            <result name="CALLER HUNGUP" link="44" stubbed="1" >f_nReturnCode == s_nCallerHungup</result>
          </results>
        </action>
        <action id="44" plug-in="Standard.EndSession.1" ><?xtml-editor x=1899 y=663 ?></action>
        <action id="45" plug-in="Pactolus.Branch.1" ><?xtml-editor x=243 y=450 ?>
          <!--in sub conf?-->
          <results >
            <result name="Default" link="15" stubbed="0"/>
            <result name="g_bCurrentlyInSubConf" link="46" stubbed="0" >g_bCurrentlyInSubConf == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: FROM MAIN MENU, REMOVE MEMBER FROM CONFERENCE.");]]></script>
          </scripts>
        </action>
        <action id="46" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=506 y=537 ?>
          <!--Remove member from conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;RemoveMemberFromConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oSubConfMS</parameter>
          </function>
          <results >
            <result name="Default" link="16" stubbed="1"/>
          </results>
        </action>
        <action id="47" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1422 y=793 ?>
          <!--in sub conf?-->
          <results >
            <result name="Default" link="42" stubbed="0"/>
            <result name="g_bCurrentlyInSubConf" link="50" stubbed="0" >g_bCurrentlyInSubConf == true</result>
          </results>
        </action>
        <action id="48" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1406 y=514 ?>
          <!--in sub conf?-->
          <results >
            <result name="Default" link="28" stubbed="0"/>
            <result name="g_bCurrentlyInSubConf" link="49" stubbed="0" >g_bCurrentlyInSubConf == true</result>
          </results>
        </action>
        <action id="49" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1640 y=618 ?>
          <!--put back to old conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oSubConfMS</parameter>
            <parameter >g_oCallLegA</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="57" stubbed="1"/>
            <result name="FAILURE" link="66" stubbed="1" >f_nReturnCode == s_nFailure</result>
            <result name="CALLER HUNGUP" link="44" stubbed="1" >f_nReturnCode == s_nCallerHungup</result>
          </results>
        </action>
        <action id="50" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1675 y=884 ?>
          <!--put B back to old conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oSubConfMS</parameter>
            <parameter >g_oCallLegB</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="57" stubbed="1"/>
            <result name="FAILURE" link="66" stubbed="1" >f_nReturnCode == s_nFailure</result>
            <result name="CALLER HUNGUP" link="44" stubbed="1" >f_nReturnCode == s_nCallerHungup</result>
          </results>
        </action>
        <action id="52" plug-in="Standard.Timer.1" ><?xtml-editor x=1666 y=169 ?>
          <!--ck reInvite timer-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lCkReInviteTimerIdA" duration="g_nCkReInviteTime"/>
          <results >
            <result name="Default" link="3" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bCkReInviteTimerFlagA = true;
Server.logInfo("SET TIMER TO CHECK FOR REINVITE A LEG");]]></script>
          </scripts>
        </action>
        <action id="53" plug-in="Standard.Timer.1" ><?xtml-editor x=1684 y=285 ?>
          <!--ck reInvite timer B-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lCkReInviteTimerIdB" duration="g_nCkReInviteTime"/>
          <results >
            <result name="Default" link="3" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bCkReInviteTimerFlagB = true;
Server.logInfo("SET TIMER TO CHECK FOR REINVITE B LEG");]]></script>
          </scripts>
        </action>
        <action id="54" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1195 y=202 ?>
          <!--Dial In?-->
          <results >
            <result name="Default" link="55" stubbed="0"/>
            <result name="g_strOutdialFlag = &quot;T&quot;" link="56" stubbed="0" >g_strOutdialFlag match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("REMOVE FROM OLD CONF ADD TO NEW CONF, RESET TIMER TO CHECK FOR REINVITE");]]></script>
          </scripts>
        </action>
        <action id="55" plug-in="Standard.Timer.1" ><?xtml-editor x=1437 y=169 ?>
          <!--stop ck reInvite timer-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="0" id="g_lCkReInviteTimerIdA" duration=""/>
          <results >
            <result name="Default" link="52" stubbed="0"/>
          </results>
        </action>
        <action id="56" plug-in="Standard.Timer.1" ><?xtml-editor x=1451 y=286 ?>
          <!--stop ck reInvite timer B-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="0" id="g_lCkReInviteTimerIdB" duration=""/>
          <results >
            <result name="Default" link="53" stubbed="0"/>
          </results>
        </action>
        <action id="57" plug-in="Pactolus.Branch.1" ><?xtml-editor x=947 y=147 ?>
          <results >
            <result name="Default" link="3" stubbed="0"/>
            <result name="Time &gt; 0" link="54" stubbed="0" >g_nCkReInviteTime &gt; 0</result>
          </results>
        </action>
        <action id="59" plug-in="Standard.Timer.1" ><?xtml-editor x=1871 y=1204 ?>
          <!--ck reInvite timer-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lCkReInviteTimerIdA" duration="g_nCkReInviteTime"/>
          <results >
            <result name="Default" link="30" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bCkReInviteTimerFlagA = true;
Server.logInfo("SET TIMER TO CHECK FOR REINVITE A LEG");]]></script>
          </scripts>
        </action>
        <action id="60" plug-in="Standard.Timer.1" ><?xtml-editor x=1891 y=1354 ?>
          <!--ck reInvite timer B-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lCkReInviteTimerIdB" duration="g_nCkReInviteTime"/>
          <results >
            <result name="Default" link="30" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bCkReInviteTimerFlagB = true;
Server.logInfo("SET TIMER TO CHECK FOR REINVITE B LEG");]]></script>
          </scripts>
        </action>
        <action id="61" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1402 y=1271 ?>
          <!--Dial In?-->
          <results >
            <result name="Default" link="62" stubbed="0"/>
            <result name="g_strOutdialFlag = &quot;T&quot;" link="63" stubbed="0" >g_strOutdialFlag match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("CSRCallerOffHold, RESET TIMER TO CHECK FOR REINVITE");]]></script>
          </scripts>
        </action>
        <action id="62" plug-in="Standard.Timer.1" ><?xtml-editor x=1642 y=1204 ?>
          <!--stop ck reInvite timer-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="0" id="g_lCkReInviteTimerIdA" duration=""/>
          <results >
            <result name="Default" link="59" stubbed="0"/>
          </results>
        </action>
        <action id="63" plug-in="Standard.Timer.1" ><?xtml-editor x=1658 y=1355 ?>
          <!--stop ck reInvite timer B-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="0" id="g_lCkReInviteTimerIdB" duration=""/>
          <results >
            <result name="Default" link="60" stubbed="0"/>
          </results>
        </action>
        <action id="64" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1169 y=1197 ?>
          <results >
            <result name="Default" link="30" stubbed="0"/>
            <result name="Time &gt; 0" link="61" stubbed="0" >g_nCkReInviteTime &gt; 0</result>
          </results>
        </action>
        <action id="65" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1886 y=462 ?>
          <!--ConfMSConnectionIDChangedNotify-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ConfMSConnectionIDChangedNotify&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="57" stubbed="1"/>
          </results>
        </action>
        <action id="66" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1893 y=560 ?>
          <!--Hang up caller-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpCaller&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="44" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 35;
Session.g_nConfLeaveReason = 9;
Session.g_strConfLeaveMsg = "FAIL TO ADD PARTY TO CONFERENCE";]]></script>
          </scripts>
        </action>
      </actions>
    </function>
    <function name="psAPISceConfCleanup" start="1" event="psAPISceConfCleanup" returns="i4" >
      <local-vars >
        <var name="f_nReturnCode" type="i4" >-50</var>
        <var name="f_lCurrentTime" type="i8" >0</var>
      </local-vars>
      <actions >
        <action id="1" plug-in="Pactolus.JavaStaticMethod.1" ><?xtml-editor x=257 y=292 ?>
          <!--confCleanUp-->
          <java xmlns="urn:www.pactolus.com:xtml:application" class="&quot;com.pactolus.conferencing.psAPISceConfCleanup&quot;" method="&quot;cleanup&quot;" timeout="s_nTimeout" return="" method-return-var="f_nReturnCode" method-return-type="0" >
            <parameter type="in" var-type="i8" >f_lCurrentTime</parameter>
            <parameter type="in" var-type="string" >s_strLocalHost</parameter>
          </java>
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="Success" link="3" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: psAPISceConfCleanup");
Server.logInfo("INFO: ********JAVA CALLING psAPISceConfCleanup *********");

Session.f_lCurrentTime = Server.getUTCTime();]]></script>
            <script language="javascript" timing="last" ><![CDATA[Server.logInfo("INFO: ********** iJavaReturnCode " + Session.f_nReturnCode);

if (Result.id == 2)

{

	Server.logInfo("INFO: SUCCESS CALL CONF CLEAN UP.");

	if (-99 == Session.f_nReturnCode)

		Session.g_nErrorMsgNumber = 1001; //db error

	else

		Session.g_nErrorMsgNumber = 0;

}

else

{

	Server.logError("ERROR: FAIL TO CALL psAPISceConfCleanup, EXIT ON: " + Result.name);

	Session.g_nErrorMsgNumber = 1000; //jvm server error

}]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=500 y=248 ?>
          <!--FAILURE-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nFailure"/>
        </action>
        <action id="3" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=516 y=432 ?>
          <!--return code from java-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nReturnCode"/>
        </action>
      </actions>
    </function>
    <function name="psAPISceEncrypt" start="1" event="psAPISceEncrypt" returns="i4" >
      <local-vars >
        <var name="f_nReturnCode" type="i4" >-50</var>
      </local-vars>
      <actions >
        <action id="1" plug-in="Pactolus.JavaStaticMethod.1" ><?xtml-editor x=113 y=272 ?>
          <!--encrypt Tag-->
          <java xmlns="urn:www.pactolus.com:xtml:application" class="&quot;com.pactolus.Utilities&quot;" method="&quot;encrypt&quot;" timeout="s_nTimeout" return="f_nReturnCode" method-return-var="" method-return-type="0" >
            <parameter type="inout" var-type="string" >g_strTag</parameter>
          </java>
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="Success" link="4" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: psAPISceEncrypt");
var currentTime = new Date();

var strTag = new String(currentTime.getTime());

Session.g_strTag = strTag;]]></script>
            <script language="javascript" timing="last" ><![CDATA[Server.logInfo("INFO: THE ENCRYPED TAG IS: " + Session.g_strTag);

if (Result.id == 2)

{

	Server.logInfo("INFO: SUCCESS ENCRYPTED TAG.");

	Session.g_strTag = Session.g_strTag.substring(Session.g_strTag.length-32, Session.g_strTag.length);

	Server.logInfo("INFO: THE ENCRYPED TAG IS: " + Session.g_strTag);

}

else

{

	Server.logError("ERROR: FAIL TO ENCRYPT TAG, EXIT ON: " + Result.name);

}	]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=353 y=267 ?>
          <!--s_nFailure-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nFailure"/>
        </action>
        <action id="4" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=355 y=354 ?>
          <!--s_nSuccess-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nSuccess"/>
        </action>
      </actions>
    </function>
    <function name="ConnectToMOH" start="35" event="ConnectToMOH" returns="i4" >
      <local-vars >
        <var name="f_nReturnCode" type="i4" >-1</var>
        <var name="f_nMOHTimeout" type="i4" >45</var>
        <var name="f_strEvtReceive" type="string" ></var>
        <var name="f_strReturnMsg" type="string" ></var>
        <var name="strRequestNotify" type="string" ></var>
        <var name="strSignal" type="string" ></var>
      </local-vars>
      <actions >
        <action id="35" plug-in="Pactolus.Branch.1" ><?xtml-editor x=268 y=160 ?>
          <!--MOH?-->
          <results >
            <result name="Default" link="27" stubbed="0"/>
            <result name="g_strMusicOnHoldFlag==&quot;T&quot;" link="6" stubbed="0" >g_strMusicOnHoldFlag match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: ConnectToMOH");]]></script>
          </scripts>
        </action>
        <action id="1" plug-in="Standard.WaitEvent.1" ><?xtml-editor x=785 y=147 ?>
          <!--for ConnectToMusicResponse-->
          <wait xmlns="urn:www.pactolus.com:xtml:communication" timeout="f_nMOHTimeout" recv-name="f_strEvtReceive" >
            <msg name="ConnectToMusicResponse" >
              <parameter >f_nReturnCode</parameter>
              <parameter >f_strReturnMsg</parameter>
              <parameter >g_nMusicOnHoldConfIndex</parameter>
              <parameter >g_strMusicOnHoldConfId</parameter>
            </msg>
          </wait>
          <results >
            <result name="Default" link="27" stubbed="1"/>
            <result name="Success" link="4" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[Server.logInfo("INFO: RECEIVE RESPONSE: " + Session.f_strEvtReceive);
Server.logInfo("INFO: RECEIVE REPLY CODE: " + Session.f_nReturnCode);
Server.logInfo("INFO: RECEIVE REPLY MSG: " + Session.f_strReturnMsg);
Server.logInfo("INFO: RECEIVE CONF INDEX: " + Session.g_nMusicOnHoldConfIndex);
Server.logInfo("INFO: RECEIVE CONF Id: " + Session.g_strMusicOnHoldConfId);

if (Result.id != 2)
{
	Server.logError("NO RESPONSE FROM MUSIC ON HOLD APP, EXIT ON BRANCH: " + Result.name);
}]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1251 y=274 ?>
          <!--s_nSuccess-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nSuccess"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bConnectToMOH = true;]]></script>
          </scripts>
        </action>
        <action id="4" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1036 y=144 ?>
          <!--success?-->
          <results >
            <result name="Default" link="27" stubbed="1"/>
            <result name="ReturnCode==0?" link="25" stubbed="1" >f_nReturnCode == s_nSuccess</result>
          </results>
        </action>
        <action id="6" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=528 y=157 ?>
          <!--send ConnectToMusic-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="" transaction="" message-name="&quot;ConnectToMusic&quot;" destination-port="" destination-type="1" destination-session="" waiting-session-selected="g_strMusicOnHoldSessionId" xml-namespace="" >
            <parameter tag="&quot;session_id&quot;" value="g_strSessionId"/>
            <parameter tag="&quot;service_provider_id&quot;" value="g_lServiceProviderId"/>
          </SOAP>
          <results >
            <result name="Default" link="27" stubbed="1"/>
            <result name="Success" link="1" stubbed="0"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strMusicOnHoldConfId = "";
Session.g_nMusicOnHoldConfIndex = 0;
Session.g_strMusicOnHoldSessionId = "";
Server.logInfo("INFO: SEND TO MOH FROM session Id is: " + Session.g_strSessionId);
Server.logInfo("INFO: SEND TO MOH FROM service provider Id is: " + Session.g_lServiceProviderId);
Server.logInfo("INFO: SEND CONNECT TO MOH session Id is: " + Session.g_strMusicOnHoldSessionId);]]></script>
            <script language="javascript" timing="last" ><![CDATA[Server.logInfo("AFTER SENT CONNECT TO MOH session Id is: " + Session.g_strMusicOnHoldSessionId);]]></script>
          </scripts>
        </action>
        <action id="7" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=459 y=449 ?>
          <!--AddMemberToConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMOH_MS</parameter>
            <parameter >g_oCallLegA</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="39" stubbed="0"/>
            <result name="FAILURE" link="13" stubbed="0" >f_nReturnCode == s_nFailure</result>
            <result name="CALLERHUNGUP" link="44" stubbed="1" >f_nReturnCode == s_nCallerHungup</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (2 == Result.id)
	Session.g_nTerminationReason = 35;]]></script>
          </scripts>
        </action>
        <action id="13" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=741 y=508 ?>
          <!--send DisconnectToMusic-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="" transaction="" message-name="&quot;DisconnectFromMusic&quot;" destination-port="" destination-type="3" destination-session="g_strMusicOnHoldSessionId" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;conference_index&quot;" value="g_nMusicOnHoldConfIndex"/>
            <parameter tag="&quot;session_id&quot;" value="g_strSessionId"/>
          </SOAP>
          <results >
            <result name="Default" link="27" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logError("FAIL TO ADD PARTY TO MOH CONFERENCE : " + Session.g_oMOH_MS.strConferenceId);
Server.logInfo("INFO: SEND DISCONNECT MOH FROM session Id is: " + Session.g_strSessionId + ", TO session Id: " + Session.g_strMusicOnHoldSessionId);]]></script>
            <script language="javascript" timing="last" ><![CDATA[Server.logInfo("INFO: SENT DISCONNECT MOH TO session Id is: " + Session.g_strMusicOnHoldSessionId);]]></script>
          </scripts>
        </action>
        <action id="15" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=475 y=616 ?>
          <!--AddMemberToConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMOH_MS</parameter>
            <parameter >g_oCallLegB</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="39" stubbed="1"/>
            <result name="FAILURE" link="13" stubbed="0" >f_nReturnCode == s_nFailure</result>
            <result name="CALLERHUNGUP" link="44" stubbed="0" >f_nReturnCode == s_nCallerHungup</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (2 == Result.id)
	Session.g_nTerminationReason = 35;]]></script>
          </scripts>
        </action>
        <action id="25" plug-in="Pactolus.Branch.1" ><?xtml-editor x=208 y=502 ?>
          <!--Dial In?-->
          <results >
            <result name="Default" link="7" stubbed="0"/>
            <result name="g_strOutdialFlag = &quot;T&quot;;" link="15" stubbed="0" >g_strOutdialFlag match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_oMOH_MS.bMuteFlag = true;
Session.g_oMOH_MS.strConferenceId = Session.g_strMusicOnHoldConfId;]]></script>
          </scripts>
        </action>
        <action id="26" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=402 y=989 ?>
          <!--"MSOutdialParty"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;MSOutdialParty&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oCallLegB</parameter>
            <parameter >g_oMOH_MS</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="33" stubbed="1"/>
            <result name="SUCCESS" link="32" stubbed="0" >f_nReturnCode == s_nSuccess</result>
            <result name="CALLER HUNGUP" link="44" stubbed="1" >f_nReturnCode == s_nCallerHungup</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (1 == Result.id)
	Session.g_nTerminationReason = 34;]]></script>
          </scripts>
        </action>
        <action id="27" plug-in="Pactolus.Branch.1" ><?xtml-editor x=138 y=887 ?>
          <!--Dial In?-->
          <results >
            <result name="Default" link="31" stubbed="0"/>
            <result name="g_strOutdialFlag = &quot;T&quot;;" link="26" stubbed="0" >g_strOutdialFlag match "T"</result>
          </results>
        </action>
        <action id="31" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=388 y=815 ?>
          <!--"MSOutdialParty"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;MSOutdialParty&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oCallLegA</parameter>
            <parameter >g_oMOH_MS</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="33" stubbed="1"/>
            <result name="SUCCESS" link="39" stubbed="1" >f_nReturnCode == s_nSuccess</result>
            <result name="CALLER HUNGUP" link="44" stubbed="1" >f_nReturnCode == s_nCallerHungup</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (1 == Result.id)
	Session.g_nTerminationReason = 34;]]></script>
          </scripts>
        </action>
        <action id="32" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=673 y=982 ?>
          <!--please hold-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMOH_MS.strConnectionId" endpoint="g_oMOH_MS.strEndPoint" callid="g_oMOH_MS.strCallId" repeat="1" timeout="10" ms-type="g_oMOH_MS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >898</audio>
          </play>
          <results >
            <result name="Default" link="39" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="33" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=650 y=810 ?>
          <!--Hang up caller-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpCaller&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="43" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nConfLeaveReason = 16;
Session.g_strConfLeaveMsg = "FAIL TO CONNECT TO MEDIA SERVER";]]></script>
          </scripts>
        </action>
        <action id="34" plug-in="Standard.EndSession.1" ><?xtml-editor x=1007 y=637 ?>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 1;]]></script>
          </scripts>
        </action>
        <action id="37" plug-in="Standard.Timer.1" ><?xtml-editor x=1495 y=486 ?>
          <!--ck reInvite timer-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lCkReInviteTimerIdA" duration="g_nCkReInviteTime"/>
          <results >
            <result name="Default" link="46" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bCkReInviteTimerFlagA = true;
Server.logInfo("SET TIMER TO CHECK FOR REINVITE A LEG");]]></script>
          </scripts>
        </action>
        <action id="38" plug-in="Standard.Timer.1" ><?xtml-editor x=1513 y=602 ?>
          <!--ck reInvite timer B-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lCkReInviteTimerIdB" duration="g_nCkReInviteTime"/>
          <results >
            <result name="Default" link="46" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bCkReInviteTimerFlagB = true;
Server.logInfo("SET TIMER TO CHECK FOR REINVITE B LEG");]]></script>
          </scripts>
        </action>
        <action id="39" plug-in="Pactolus.Branch.1" ><?xtml-editor x=734 y=419 ?>
          <results >
            <result name="Default" link="46" stubbed="0"/>
            <result name="Time &gt; 0" link="40" stubbed="0" >g_nCkReInviteTime &gt; 0</result>
          </results>
        </action>
        <action id="40" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1024 y=519 ?>
          <!--Dial In?-->
          <results >
            <result name="Default" link="41" stubbed="0"/>
            <result name="g_strOutdialFlag = &quot;T&quot;" link="42" stubbed="0" >g_strOutdialFlag match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("CONNECT TO MOH, RESET TIMER TO CHECK FOR REINVITE");]]></script>
          </scripts>
        </action>
        <action id="41" plug-in="Standard.Timer.1" ><?xtml-editor x=1266 y=486 ?>
          <!--stop ck reInvite timer-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="0" id="g_lCkReInviteTimerIdA" duration=""/>
          <results >
            <result name="Default" link="37" stubbed="0"/>
          </results>
        </action>
        <action id="42" plug-in="Standard.Timer.1" ><?xtml-editor x=1280 y=603 ?>
          <!--stop ck reInvite timer B-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="0" id="g_lCkReInviteTimerIdB" duration=""/>
          <results >
            <result name="Default" link="38" stubbed="0"/>
          </results>
        </action>
        <action id="43" plug-in="Standard.EndSession.1" ><?xtml-editor x=863 y=807 ?></action>
        <action id="44" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=767 y=637 ?>
          <!--Party Leave-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;PartyLeave&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="34" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nConfLeaveReason = 0;
Session.g_strConfLeaveMsg = "PARTY HANGUP";]]></script>
          </scripts>
        </action>
        <action id="45" plug-in="Pactolus.MGCPNotifyRequest.1" ><?xtml-editor x=1268 y=372 ?>
          <rqnt xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMOH_MS.strConnectionId" endpoint="g_oMOH_MS.strEndPoint" callid="g_oMOH_MS.strCallId" timeout="s_nTimeout" returns="" ms-type="g_oMOH_MS.strType" >
            <parameters >
              <quarantine step="1" loop="0" process="0" discard="1"/>
              <events ><![CDATA[strRequestNotify]]></events>
              <signals ><![CDATA[strSignal]]></signals>
              <digit-map ><![CDATA["(*0|00)"]]></digit-map>
            </parameters>
          </rqnt>
          <results >
            <result name="Default" link="2" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("TURN ON DTMF COLLECTION WHILE IN MOH");
Server.logInfo("INFO: RQNT MS call id = " + Session.g_oMOH_MS.strCallId);
Server.logInfo("INFO: RQNT MS connection id = " + Session.g_oMOH_MS.strConnectionId);
Server.logInfo("INFO: RQNT MS end point = " + Session.g_oMOH_MS.strEndPoint);
Session.strRequestNotify = "D/[0-9#*T]@" + Session.g_oMOH_MS.strConnectionId + "(D)";
Session.strSignal = "D/cc@" + Session.g_oMOH_MS.strConnectionId + "(sit=1)";]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)
{
	Server.logError("ERROR: FAIL TO TURN DTMF COLLECTION ON, EXIT BRANCH: " + Result.name);
}]]></script>
          </scripts>
        </action>
        <action id="46" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1020 y=303 ?>
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="turn DTMF collection ON" link="45" stubbed="0" >g_bCurrentlyInSubConf == false
AND g_bEBCRequestCSR == false
AND g_bEBCRequestPrivateCSR == false
AND g_bPrivateTalkInConference == false
AND g_bTalkingWithCSR == false
AND g_bDtmfCollectionOnHold == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: In sub conference flag: " + Session.g_bCurrentlyInSubConf);
Server.logInfo("INFO: Request CSR flag: " + Session.g_bEBCRequestCSR);
Server.logInfo("INFO: Private talk request CSR flag: " + Session.g_bEBCRequestPrivateCSR);
Server.logInfo("INFO: In private talk flag: " + Session.g_bPrivateTalkInConference);
Server.logInfo("INFO: Talking with CSR flag: " + Session.g_bTalkingWithCSR);
Server.logInfo("INFO: Turn on DTMF collection ON flag: " + Session.g_bDtmfCollectionOnHold);]]></script>
          </scripts>
        </action>
      </actions>
    </function>
    <function name="DisconnectFromMOH" start="18" event="DisconnectFromMOH" returns="i4" >
      <local-vars >
        <var name="f_nReturnCode" type="i4" >-1</var>
      </local-vars>
      <actions >
        <action id="18" plug-in="Pactolus.Branch.1" ><?xtml-editor x=107 y=213 ?>
          <!--Temp Conf?-->
          <results >
            <result name="Default" link="6" stubbed="1"/>
            <result name="connect to end point" link="19" stubbed="0" >g_oMOH_MS.bCurrentlyConnected == true</result>
            <result name="In MOH Conf == true" link="8" stubbed="0" >g_oMOH_MS.bCurrentlyInConf == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: DisconnectFromMOH");

Session.g_oMOH_MS.bMuteFlag = false;]]></script>
          </scripts>
        </action>
        <action id="6" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=583 y=207 ?>
          <!--s_nSuccess-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nSuccess"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bConnectToMOH = false;
Session.g_bDtmfCollectionOnHold = false;]]></script>
          </scripts>
        </action>
        <action id="7" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=600 y=345 ?>
          <!--"SendDisconnectToMOH"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;SendDisconnectToMOH&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="6" stubbed="1"/>
          </results>
        </action>
        <action id="8" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=364 y=349 ?>
          <!--Remove Member From Conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;RemoveMemberFromConference&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMOH_MS</parameter>
          </function>
          <results >
            <result name="Default" link="7" stubbed="0"/>
          </results>
        </action>
        <action id="19" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=349 y=205 ?>
          <!--DeleteMOHMSConnection-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DeleteMSConnection&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMOH_MS</parameter>
          </function>
          <results >
            <result name="Default" link="6" stubbed="0"/>
          </results>
        </action>
      </actions>
    </function>
    <function name="SendDisconnectToMOH" start="3" event="SendDisconnectToMOH" returns="void" >
      <local-vars >
        <var name="bNoDestination" type="boolean" >0</var>
      </local-vars>
      <actions >
        <action id="3" plug-in="Pactolus.Branch.1" ><?xtml-editor x=137 y=235 ?>
          <!--No destination?-->
          <results >
            <result name="Default" link="1" stubbed="0"/>
            <result name="bNoDestination" link="2" stubbed="1" >bNoDestination == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: SendDisconnectMOH");
if (Session.g_strMusicOnHoldSessionId.length > 0)
{
	Server.logInfo("Has destination, MOH session id is: " + Session.g_strMusicOnHoldSessionId);
	Session.bNoDestination = false;
}
else
{
	Server.logInfo("Has NO destination, MOH session id is: " + Session.g_strMusicOnHoldSessionId);
	Session.bNoDestination = true;
}]]></script>
          </scripts>
        </action>
        <action id="1" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=388 y=231 ?>
          <!--send DisconnectToMusic-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="" transaction="" message-name="&quot;DisconnectFromMusic&quot;" destination-port="" destination-type="3" destination-session="g_strMusicOnHoldSessionId" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;conference_index&quot;" value="g_nMusicOnHoldConfIndex"/>
            <parameter tag="&quot;session_id&quot;" value="g_strSessionId"/>
          </SOAP>
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: SEND DISCONNECT MOH FROM session Id is: " + Session.g_strSessionId);]]></script>
            <script language="javascript" timing="last" ><![CDATA[Server.logInfo("INFO: SENT DISCONNECT MOH TO session Id is: " + Session.g_strMusicOnHoldSessionId);]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=623 y=230 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bConnectToMOH = false;]]></script>
          </scripts>
        </action>
      </actions>
    </function>
    <function name="OnForceDisconnectFromMusic" start="1" event="OnForceDisconnectFromMusic" returns="void" >
      <actions >
        <action id="1" plug-in="Pactolus.Branch.1" ><?xtml-editor x=137 y=165 ?>
          <!--connect to MOH?-->
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="g_bConnectToMOH==true?" link="3" stubbed="0" >g_bConnectToMOH == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: OnForceDisconnectFromMusic");]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=419 y=161 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: GOT A FORCE DISCONNECT FROM MOH, BUT NOT CONNECT TO MOH");]]></script>
          </scripts>
        </action>
        <action id="3" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=422 y=249 ?>
          <!--"DisconnectFromMOH"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DisconnectFromMOH&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="4" stubbed="0"/>
          </results>
        </action>
        <action id="4" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=671 y=251 ?>
          <!--HangUp Caller-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpCaller&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="5" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nConfLeaveReason = 17;
Session.g_strConfLeaveMsg = "EXCEED TIME IN MUSIC ON HOLD, FORCE TO DISCONNECT";]]></script>
          </scripts>
        </action>
        <action id="5" plug-in="Standard.EndSession.1" ><?xtml-editor x=424 y=405 ?></action>
      </actions>
    </function>
    <function name="RecordCallerName" start="5" event="RecordCallerName" returns="void" >
      <local-vars >
        <var name="f_nReturnCode" type="i4" >0</var>
        <var name="f_nCounter" type="i4" >0</var>
        <var name="f_nMAXRETRY" type="i4" >2</var>
        <var name="strTempString1" type="string" ></var>
        <var name="strTempString2" type="string" ></var>
      </local-vars>
      <actions >
        <action id="5" plug-in="Pactolus.Branch.1" ><?xtml-editor x=112 y=224 ?>
          <!--record name?-->
          <results >
            <result name="Default" link="6" stubbed="0"/>
            <result name="RecordNameFlag==&quot;T&quot;" link="2" stubbed="0" >g_strRecordNamesFlag match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: RecordCallerName");]]></script>
          </scripts>
        </action>
        <action id="1" plug-in="Pactolus.MGCPRecord.1" ><?xtml-editor x=587 y=370 ?>
          <!--869: please say your name-->
          <record xmlns="urn:www.pactolus.com:xtml:media" op-mode="0" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" timeout="10" returns="f_nReturnCode" return-immediate="0" ms-type="g_oMS.strType" rid="g_strCallerRecordedName" eik="&quot;#&quot;" rlt="80" prt="30" pst="30" rl="g_nRecordNameLength" dc="" rc="f_nReturnCode" id-cleanup="1" play-beep="1" ef="&quot;ULAW&quot;" agc="0" agcta="" ga="" sla="" bpf="" bpa="" bpd="0"/>
          <results >
            <result name="Default" link="6" stubbed="1"/>
            <result name="Success" link="12" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout"/>
            <result name="No Speech Detected" link="3" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("RECORDING CALLER NAME");]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=349 y=370 ?>
          <!--869: please say your name-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >369</audio>
            <audio type="index" >934</audio>
            <audio type="index" >935</audio>
            <audio type="index" >321</audio>
          </play>
          <results >
            <result name="Default" link="1" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="3" plug-in="Pactolus.Branch.1" ><?xtml-editor x=853 y=474 ?>
          <!--retry?-->
          <results >
            <result name="Default" link="6" stubbed="1"/>
            <result name="counter &lt;2" link="4" stubbed="0" >f_nCounter &lt; 2</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_nCounter++;]]></script>
          </scripts>
        </action>
        <action id="4" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1114 y=473 ?>
          <!--sorry, didn't hear response-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >301</audio>
            <audio type="index" >552</audio>
          </play>
          <results >
            <result name="Default" link="2" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="6" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=355 y=217 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
        </action>
        <action id="7" plug-in="Pactolus.MGCPRecord.1" ><?xtml-editor x=602 y=690 ?>
          <!--869: please say your name-->
          <record xmlns="urn:www.pactolus.com:xtml:media" op-mode="0" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" timeout="10" returns="f_nReturnCode" return-immediate="0" ms-type="g_oMS.strType" rid="g_strCallerRecordedName" eik="&quot;#&quot;" rlt="80" prt="30" pst="30" rl="g_nRecordNameLength" dc="" rc="f_nReturnCode" id-cleanup="1" play-beep="0" ef="&quot;ULAW&quot;" agc="0" agcta="" ga="" sla="" bpf="" bpa="" bpd="0"/>
          <results >
            <result name="Default" link="6" stubbed="1"/>
            <result name="Success" link="12" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
            <result name="No Speech Detected" link="8" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("RECORDING CALLER NAME");]]></script>
          </scripts>
        </action>
        <action id="8" plug-in="Pactolus.Branch.1" ><?xtml-editor x=868 y=794 ?>
          <!--retry?-->
          <results >
            <result name="Default" link="6" stubbed="1"/>
            <result name="counter &lt;2" link="9" stubbed="0" >f_nCounter &lt; 2</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_nCounter++;]]></script>
          </scripts>
        </action>
        <action id="9" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1129 y=793 ?>
          <!--sorry, didn't hear response-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >301</audio>
            <audio type="index" >552</audio>
          </play>
          <results >
            <result name="Default" link="10" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="10" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=364 y=690 ?>
          <!--869: please say your name-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >369</audio>
            <audio type="index" >934</audio>
            <audio type="index" >935</audio>
            <audio type="index" >321</audio>
          </play>
          <results >
            <result name="Default" link="7" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="11" plug-in="Pactolus.Branch.1" ><?xtml-editor x=108 y=558 ?>
          <!--IVR dial out?-->
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="g_bIVRDialOut == true" link="10" stubbed="0" >g_bIVRDialOut == true</result>
          </results>
        </action>
        <action id="12" plug-in="Pactolus.Branch.1" ><?xtml-editor x=356 y=943 ?>
          <results >
            <result name="Default" link="6" stubbed="1"/>
            <result name="bRecordToConfBlade" link="13" stubbed="1" >bRecordToConfBlade == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[var i = Session.g_oMS.strEndPoint.toString().indexOf("@");
Session.g_strCallerRecordedNameMS = Session.strTempString1 = Session.g_oMS.strEndPoint.toString().substr((i+1));

if ( 0 < Session.g_strConfResource.length ) {
	
	var	j = Session.g_strConfResource.indexOf("@");
	Session.strTempString2 = Session.g_strConfResource.substr((j+1));
	
	Server.logInfo("Caller's media server: " + Session.strTempString1);
	Server.logInfo("Conference media server: " + Session.strTempString2);
	
	if ( Session.strTempString1 != Session.strTempString2 ) {
		Session.bRecordToConfBlade = true;
		Server.logInfo("Caller is on a different ms blade than the conference.");
	}
}



]]></script>
          </scripts>
        </action>
        <action id="13" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=623 y=940 ?>
          <!--RecordToMS-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;RecordToMS&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
            <parameter >g_strLanguage</parameter>
            <parameter >g_strCallerRecordedName</parameter>
            <parameter >g_strConfResource</parameter>
          </function>
          <results >
            <result name="Default" link="6" stubbed="1"/>
          </results>
        </action>
      </actions>
    </function>
    <function name="psAPISceConfGetNewCC" start="1" event="psAPISceConfGetNewCC" returns="i4" >
      <local-vars >
        <var name="f_nReturnCode" type="i4" >-50</var>
        <var name="f_strBadCCIP" type="string" ></var>
        <var name="f_nBadCCPort" type="i4" >0</var>
      </local-vars>
      <actions >
        <action id="1" plug-in="Pactolus.JavaStaticMethod.1" ><?xtml-editor x=168 y=242 ?>
          <!--"getNewConfController"-->
          <java xmlns="urn:www.pactolus.com:xtml:application" class="&quot;com.pactolus.conferencing.psAPISceConfCleanup&quot;" method="&quot;getNewConfController&quot;" timeout="s_nTimeout" return="" method-return-var="f_nReturnCode" method-return-type="0" >
            <parameter type="in" var-type="string" >g_strDBNAME</parameter>
            <parameter type="in" var-type="string" >g_strSessionId</parameter>
            <parameter type="in" var-type="string" >g_strConfEventId</parameter>
            <parameter type="in" var-type="string" >f_strBadCCIP</parameter>
            <parameter type="in" var-type="i4" >f_nBadCCPort</parameter>
            <parameter type="in" var-type="i4" >s_nSiteId</parameter>
            <parameter type="inout" var-type="string" >g_strConfControllerIP</parameter>
            <parameter type="inout" var-type="i4" >g_nConfControllerPort</parameter>
          </java>
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="Success" link="3" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: psAPISceConfGetNewCC");
Session.f_strBadCCIP = Session.g_strConfControllerIP;

Session.f_nBadCCPort = Session.g_nConfControllerPort;

Server.logInfo("INFO: ********JAVA CALLING getNewConfController *********");

Server.logInfo("INFO: session Id = " + Session.g_strSessionId);

Server.logInfo("INFO: f_strBadCCIP = " + Session.f_strBadCCIP);

Server.logInfo("INFO: f_nBadCCPort = " + Session.f_nBadCCPort);]]></script>
            <script language="javascript" timing="last" ><![CDATA[Server.logInfo("INFO: ********** iJavaReturnCode " + Session.f_nReturnCode);

if (Result.id != 2)
{
	Server.logError("ERROR: FAIL TO GET NEW CONFERENCE CONTROLLER, EXIT ON: " + Result.name);
	Session.g_nTerminationReason = 39;
}
else if (Session.f_nReturnCode < 0)
{
	Session.g_nTerminationReason = 39;
}]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=435 y=234 ?>
          <!--FAILURE-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nFailure"/>
        </action>
        <action id="3" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=444 y=325 ?>
          <!--return code from java-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nReturnCode"/>
        </action>
      </actions>
    </function>
    <function name="OnConferencePing" start="4" event="OnConferencePing" returns="void" >
      <parameters >
        <parameter name="strPingSessionId" type="string" pass="byref"/>
        <parameter name="strPasscode" type="string" pass="byref"/>
      </parameters>
      <actions >
        <action id="4" plug-in="Pactolus.Branch.1" ><?xtml-editor x=182 y=407 ?>
          <!--match call id?-->
          <results >
            <result name="Default" link="1" stubbed="0"/>
            <result name="same passcode" link="6" stubbed="0" >strPasscode match g_strPassCode</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: OnConferencePing");
Server.logInfo("RECEIVING CONFERENCE PING FROM SESSION: " + Session.strPingSessionId);]]></script>
          </scripts>
        </action>
        <action id="1" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=435 y=348 ?>
          <!--NOT INUSED-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="" transaction="" message-name="&quot;ConferencePong&quot;" destination-port="" destination-type="3" destination-session="strPingSessionId" waiting-session-selected="" xml-namespace="" >
            <parameter tag="" value="s_nPasscodeNotInUsed"/>
          </SOAP>
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="Success" link="3" stubbed="0"/>
            <result name="Error"/>
          </results>
        </action>
        <action id="2" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=703 y=350 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logError("ERROR: FAIL TO REPLY A PONG TO CONFERENCE PING WITH PONG SESSION Id: " + Session.g_strSessionId);]]></script>
          </scripts>
        </action>
        <action id="3" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=704 y=407 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: SUCCESS REPLY A PONG TO CONFERENCE PING WITH PONG SESSION Id: " + Session.g_strSessionId);]]></script>
          </scripts>
        </action>
        <action id="6" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=441 y=495 ?>
          <!--INUSED-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="" transaction="" message-name="&quot;ConferencePong&quot;" destination-port="" destination-type="3" destination-session="strPingSessionId" waiting-session-selected="" xml-namespace="" >
            <parameter tag="" value="s_nPasscodeInUsed"/>
          </SOAP>
          <results >
            <result name="Default" link="2" stubbed="1"/>
            <result name="Success" link="3" stubbed="1"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("WARNING: PASSCODE INUSED");]]></script>
          </scripts>
        </action>
      </actions>
    </function>
    <function name="psAPISceSetBillingCode" start="1" event="psAPISceSetBillingCode" returns="i4" >
      <local-vars >
        <var name="f_nReturnCode" type="i4" >-50</var>
      </local-vars>
      <actions >
        <action id="1" plug-in="Pactolus.JavaStaticMethod.1" ><?xtml-editor x=179 y=308 ?>
          <!--set billing code-->
          <java xmlns="urn:www.pactolus.com:xtml:application" class="&quot;com.pactolus.conferencing.psAPISceConfMisc&quot;" method="&quot;setBillingCode&quot;" timeout="s_nTimeout" return="" method-return-var="f_nReturnCode" method-return-type="0" >
            <parameter type="in" var-type="string" >g_strDBNAME</parameter>
            <parameter type="in" var-type="string" >g_strSessionId</parameter>
            <parameter type="in" var-type="string" >g_strConfSessionId</parameter>
            <parameter type="in" var-type="string" >g_strConfScheduleId</parameter>
            <parameter type="in" var-type="string" >g_strCallLegId</parameter>
            <parameter type="in" var-type="string" >g_strBillingCodeNumber</parameter>
          </java>
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="Success" link="3" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: psAPISceSetBillingCode");
Server.logInfo("INFO: *********JAVA CALLING SetConfResource *********");

Server.logInfo("INFO: BEFORE DB name = " + Session.g_strDBNAME);

Server.logInfo("INFO: BEFORE Session Id = " + Session.g_strSessionId);

Server.logInfo("INFO: BEFORE sched Id = " + Session.g_strConfScheduleId);

Server.logInfo("INFO: BEFORE CallLeg Id = " + Session.g_strCallLegId);

Server.logInfo("INFO: BEFORE Billing Code Number = " + Session.g_strBillingCodeNumber);]]></script>
            <script language="javascript" timing="last" ><![CDATA[Server.logInfo("INFO: ********* SetConfResource returns " + Session.f_nReturnCode);

if (Result.id == 2)

{

	Server.logInfo("INFO: SUCCESS CALL SET CONF RESOURCE.");

	if (-99 == Session.f_nReturnCode)
	{
		Session.g_nErrorMsgNumber = 1001; //db error
		Session.g_nTerminationReason = 39;
	}
	else

		Session.g_nErrorMsgNumber = 0;

}

else

{

	Server.logError("ERROR: FAIL TO CALL SET CONF RESOURCE, EXIT ON: " + Result.name);

	Session.g_nTerminationReason = 39;

	Session.g_nErrorMsgNumber = 1000; //jvm server error

}]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=415 y=299 ?>
          <!--return FAILED_JAVA-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nFailure"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logError("ERROR: FAIL TO SET BILLING CODE");]]></script>
          </scripts>
        </action>
        <action id="3" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=420 y=389 ?>
          <!--return JAVA_SUCCESS-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nReturnCode"/>
        </action>
      </actions>
    </function>
    <function name="RouteToCSR" start="44" event="RouteToCSR" returns="i4" >
      <local-vars >
        <var name="f_nReturnCode" type="i4" >-1</var>
      </local-vars>
      <actions >
        <action id="44" plug-in="Pactolus.Branch.1" ><?xtml-editor x=129 y=243 ?>
          <!--event base conf?-->
          <results >
            <result name="Default" link="24" stubbed="1"/>
            <result name="g_nDnisIdentifiedConfFlag == 1" link="47" stubbed="0" >g_nDnisIdentifiedConfFlag == 1
AND g_bFirstTimeGetPasscode == true</result>
            <result name="not first time" link="2" stubbed="1" >g_nDnisIdentifiedConfFlag == 1
AND g_bFirstTimeGetPasscode == false</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: RouteToCSR");]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Pactolus.Branch.1" ><?xtml-editor x=376 y=518 ?>
          <!--MOH?-->
          <results >
            <result name="Default" link="13" stubbed="0"/>
            <result name="g_strMusicOnHoldFlag==&quot;T&quot;" link="5" stubbed="0" >g_strMusicOnHoldFlag match "T"</result>
          </results>
        </action>
        <action id="5" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=623 y=634 ?>
          <!--Delete MS Connection-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DeleteMSConnection&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="19" stubbed="0"/>
          </results>
        </action>
        <action id="13" plug-in="Standard.Timer.1" ><?xtml-editor x=614 y=514 ?>
          <!--set max wait time for CSR-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lWaitCSRTimerId" duration="s_nCsrHoldTime"/>
          <results >
            <result name="Default" link="14" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bWaitCSRTimerSet = true;]]></script>
          </scripts>
        </action>
        <action id="14" plug-in="Standard.Timer.1" ><?xtml-editor x=832 y=511 ?>
          <!--play please hold every 10 secs-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lHoldTimerId" duration="s_nSleepTime"/>
          <results >
            <result name="Default" link="19" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bHoldTimerFlag = true;]]></script>
          </scripts>
        </action>
        <action id="15" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1081 y=956 ?>
          <!--s_nStateWait-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nStateWait"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nCallerCurrentState = Session.s_nStateRouteToCsr;

js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="19" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=131 y=803 ?>
          <!--Create a temp Conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;CreateConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
          </function>
          <results >
            <result name="Default" link="40" stubbed="0"/>
            <result name="SUCCESS" link="23" stubbed="0" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("g_oTempConf.bPersistentFlag: " + Session.g_oTempConf.bPersistentFlag);
Server.logInfo("g_oTempConf.nConferenceMaxParties: " + Session.g_oTempConf.nConferenceMaxParties);
Server.logInfo("g_oTempConf.nConferenceMaxTalkers: " + Session.g_oTempConf.nConferenceMaxTalkers);
Session.g_oTempConf.strConferenceId = "";]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Session.f_nReturnCode == Session.s_nSuccess)

{

	Session.g_bCreatedTempConf = true;

}]]></script>
          </scripts>
        </action>
        <action id="23" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=372 y=875 ?>
          <!--"CSRBeginRequest"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;CSRBeginRequest&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="43" stubbed="0"/>
            <result name="SUCCESS" link="38" stubbed="0" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_disable_event();

Session.g_strCSRRequestEndPoint = Session.g_oTempConf.strConferenceId;]]></script>
          </scripts>
        </action>
        <action id="24" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=153 y=530 ?>
          <!--please hold for CSR-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >1501</audio>
          </play>
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="37" plug-in="Standard.Timer.1" ><?xtml-editor x=846 y=956 ?>
          <!--5 secs to connect MOH-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lMOHTimerId" duration="s_nPreMohTime"/>
          <results >
            <result name="Default" link="15" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bMOHTimerFlag = true;]]></script>
          </scripts>
        </action>
        <action id="38" plug-in="Pactolus.Branch.1" ><?xtml-editor x=617 y=960 ?>
          <!--MOH?-->
          <results >
            <result name="Default" link="15" stubbed="1"/>
            <result name="g_strMusicOnHoldFlag==&quot;T&quot;" link="37" stubbed="0" >g_strMusicOnHoldFlag match "T"</result>
          </results>
        </action>
        <action id="39" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=568 y=783 ?>
          <!--s_nStateEndCall-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nStateEndCall"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nCallerCurrentState = Session.s_nStateEndCall;

js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="40" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=353 y=782 ?>
          <!--Hang up caller-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpCaller&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="39" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 37;]]></script>
          </scripts>
        </action>
        <action id="43" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=608 y=874 ?>
          <!--Hang up caller-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpCaller&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="39" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 39;]]></script>
          </scripts>
        </action>
        <action id="45" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=893 y=346 ?>
          <!--Welcome prompt Index-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="50" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="silence" >s_fConfStartCallDelay</audio>
            <audio type="index" >g_nWelcomePromptIndex</audio>
          </play>
          <results >
            <result name="Default" link="2" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="46" plug-in="Pactolus.Branch.1" ><?xtml-editor x=637 y=356 ?>
          <!--Welcome prompt?-->
          <results >
            <result name="Default" link="45" stubbed="0"/>
            <result name="IWelcomePromptIndex &lt;= 0" link="24" stubbed="1" >g_nWelcomePromptIndex &lt;= 0</result>
          </results>
        </action>
        <action id="47" plug-in="Pactolus.Branch.1" ><?xtml-editor x=366 y=236 ?>
          <!--strWelcomePromptType = U or I-->
          <results >
            <result name="Default" link="49" stubbed="0"/>
            <result name="strWelcomePromptType==U" link="48" stubbed="0" >g_strWelcomePromptType match "U"</result>
            <result name="strWelcomePromptType==I" link="46" stubbed="0" >g_strWelcomePromptType match "I"</result>
          </results>
        </action>
        <action id="48" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=628 y=216 ?>
          <!--Welcome prompt URL-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="40" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="silence" >s_fConfStartCallDelay</audio>
            <audio type="url" >g_strWelcomePromptUrl</audio>
          </play>
          <results >
            <result name="Default" link="2" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="49" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=537 y=59 ?>
          <!--4138: hold for CSR generic-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="15" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >4138</audio>
          </play>
          <results >
            <result name="Default" link="2" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
      </actions>
    </function>
    <function name="psAPISceBeginRequest" start="1" event="psAPISceBeginRequest" returns="i4" >
      <local-vars >
        <var name="f_nReturnCode" type="i4" >-50</var>
      </local-vars>
      <actions >
        <action id="1" plug-in="Pactolus.JavaStaticMethod.1" ><?xtml-editor x=211 y=245 ?>
          <!--BeginRequest-->
          <java xmlns="urn:www.pactolus.com:xtml:application" class="&quot;com.pactolus.acd.psAPISceBeginRequest&quot;" method="&quot;logBeginRequest&quot;" timeout="s_nTimeout" return="" method-return-var="f_nReturnCode" method-return-type="0" >
            <parameter type="in" var-type="string" >g_strDBNAME</parameter>
            <parameter type="in" var-type="string" >g_strSessionId</parameter>
            <parameter type="in" var-type="string" >s_strApplicationName</parameter>
            <parameter type="in" var-type="string" >g_strSoapAddress</parameter>
            <parameter type="in" var-type="i4" >g_nSoapPort</parameter>
            <parameter type="in" var-type="i4" >g_nAccessNumberId</parameter>
            <parameter type="in" var-type="i4" >g_nCSRRouteReasonCode</parameter>
            <parameter type="in" var-type="string" >g_strLanguage</parameter>
            <parameter type="in" var-type="i8" >g_lCSRRequestSkillId</parameter>
            <parameter type="in" var-type="i8" >g_lRequestStartTime</parameter>
            <parameter type="in" var-type="i4" >g_nCSRRequestGroupId</parameter>
            <parameter type="in" var-type="i8" >g_lSubscriberId</parameter>
            <parameter type="in" var-type="string" >g_strConfEventId</parameter>
            <parameter type="inout" var-type="i8" >g_lCSRRequestId</parameter>
            <parameter type="inout" var-type="i8" >g_lCSRRequestLanguageId</parameter>
          </java>
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="Success" link="3" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: psAPISceBeginRequest");
Session.g_lRequestStartTime = Server.getUTCTime();

Server.logInfo("INFO: *********JAVA CALLING psAPISceBeginRequest *********");

Server.logInfo("INFO: BEFORE DB name = " + Session.g_strDBNAME);

Server.logInfo("INFO: BEFORE session Id = " + Session.g_strSessionId);

Server.logInfo("INFO: BEFORE application name = " + Session.s_strApplicationName);

Server.logInfo("INFO: BEFORE request server ip = " + Session.s_strLocalHost);

Server.logInfo("INFO: BEFORE access number id = " + Session.g_nAccessNumberId);

Server.logInfo("INFO: BEFORE route reason code = " + Session.g_nCSRRouteReasonCode);

Server.logInfo("INFO: BEFORE language = " + Session.g_strLanguage);

Server.logInfo("INFO: BEFORE request skill id = " + Session.g_lCSRRequestSkillId);

Server.logInfo("INFO: BEFORE request time = " + Session.g_lRequestStartTime);

Server.logInfo("INFO: BEFORE subscriber id = " + Session.g_lSubscriberId);

Server.logInfo("INFO: BEFORE conf event id = " + Session.g_strConfEventId);]]></script>
            <script language="javascript" timing="last" ><![CDATA[Server.logInfo("INFO: ********* iJavaReturnCode " + Session.f_nReturnCode);

if (Result.id == 2)

{

	Server.logInfo("INFO: SUCCESS LOG BEGIN REQUEST.");

	if (-99 == Session.f_nReturnCode)
	{
		Session.g_nErrorMsgNumber = 1001; //db error
		Session.g_nTerminationReason = 39;
	}
	else

		Session.g_nErrorMsgNumber = 0;

}

else

{

	Server.logError("ERROR: FAIL TO CALL BEGIN REQUEST, EXIT ON: " + Result.name);

	Session.g_nTerminationReason = 39;

	Session.g_nErrorMsgNumber = 1000; //jvm server error

}

Session.g_bSentAPIBeginRequest = true;]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=471 y=210 ?>
          <!--FAILURE-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nFailure"/>
        </action>
        <action id="3" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=484 y=326 ?>
          <!--return code from java-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nReturnCode"/>
        </action>
      </actions>
    </function>
    <function name="psAPISceGetRequestDisplayInfo " start="1" event="psAPISceGetRequestDisplayInfo " returns="i4" >
      <local-vars >
        <var name="f_nReturnCode" type="i4" >-50</var>
      </local-vars>
      <actions >
        <action id="1" plug-in="Pactolus.JavaStaticMethod.1" ><?xtml-editor x=143 y=189 ?>
          <!--"getDisplayInfo"-->
          <java xmlns="urn:www.pactolus.com:xtml:application" class="&quot;com.pactolus.acd.psAPISceGetRequestDisplayInfo&quot;" method="&quot;getDisplayInfo&quot;" timeout="s_nTimeout" return="" method-return-var="f_nReturnCode" method-return-type="0" >
            <parameter type="in" var-type="string" >g_strDBNAME</parameter>
            <parameter type="in" var-type="string" >g_strSessionId</parameter>
            <parameter type="in" var-type="i8" >g_lCSRRequestSkillId</parameter>
            <parameter type="in" var-type="unknown" >g_lCSRRequestLanguageId</parameter>
            <parameter type="in" var-type="unknown" >g_lCSRRequestOfferingId</parameter>
            <parameter type="in" var-type="unknown" >g_lCSRRequestServiceId</parameter>
            <parameter type="in" var-type="i4" >g_nCSRRouteReasonCode</parameter>
            <parameter type="in" var-type="i4" >g_nAccessNumberId</parameter>
            <parameter type="in" var-type="i8" >g_lServiceProviderId</parameter>
            <parameter type="in" var-type="i8" >g_lSubscriberId</parameter>
            <parameter type="inout" var-type="string" >g_strCSRRequestSkillName</parameter>
            <parameter type="inout" var-type="string" >g_strCSRRequestLanguageName</parameter>
            <parameter type="inout" var-type="string" >g_strCSRRequestOfferingName</parameter>
            <parameter type="inout" var-type="string" >g_strCSRRequestServiceName</parameter>
            <parameter type="inout" var-type="string" >g_strCSRRequestTypeName</parameter>
            <parameter type="inout" var-type="string" >g_strCSRAccessNbrName</parameter>
            <parameter type="inout" var-type="string" >g_strCSRServiceProviderName</parameter>
            <parameter type="inout" var-type="string" >g_strCallerFirstName</parameter>
            <parameter type="inout" var-type="string" >g_strCallerLastName</parameter>
          </java>
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="Success" link="3" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: psAPISceGetRequestDisplayInfo");
Server.logInfo("INFO: *********JAVA CALLING psAPISceGetRequestDisplayInfo *********");

Server.logInfo("INFO: BEFORE DB name = " + Session.g_strDBNAME);

Server.logInfo("INFO: BEFORE session Id = " + Session.g_strSessionId);

Server.logInfo("INFO: BEFORE application name = " + Session.s_strApplicationName);

Server.logInfo("INFO: BEFORE skill id = " + Session.g_lCSRRequestSkillId);

Server.logInfo("INFO: BEFORE language id = " + Session.g_lCSRRequestLanguageId);

Server.logInfo("INFO: BEFORE offering id = " + Session.g_lCSRRequestOfferingId);

Server.logInfo("INFO: BEFORE service id = " + Session.g_lCSRRequestServiceId);

Server.logInfo("INFO: BEFORE request id = " + Session.g_lCSRRequestId);

Server.logInfo("INFO: BEFORE access number id = " + Session.g_nAccessNumberId);

Server.logInfo("INFO: BEFORE service provider id = " + Session.g_lServiceProviderId);]]></script>
            <script language="javascript" timing="last" ><![CDATA[Server.logInfo("INFO: ********* iJavaReturnCode " + Session.f_nReturnCode);

if (Result.id == 2)

{

	Server.logInfo("INFO: SUCCESS GET DISPLAY INFO.");

	if (-99 == Session.f_nReturnCode)
	{
		Session.g_nErrorMsgNumber = 1001; //db error
		Session.g_nTerminationReason = 39;
	}
	else

		Session.g_nErrorMsgNumber = 0;

}

else

{

	Server.logError("ERROR: FAIL TO GET DISPLAY INFO, EXIT ON: " + Result.name);

	Session.g_nTerminationReason = 39;

	Session.g_nErrorMsgNumber = 1000; //jvm server error

}]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=420 y=168 ?>
          <!--FAILURE-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nFailure"/>
        </action>
        <action id="3" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=433 y=284 ?>
          <!--return code from java-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nReturnCode"/>
        </action>
      </actions>
    </function>
    <function name="OnCSRBeginAssignment" start="52" event="OnCSRBeginAssignment" returns="void" >
      <parameters >
        <parameter name="strACDControllerIP" type="string" pass="byref"/>
        <parameter name="nACDControllerPort" type="i4" pass="byref"/>
        <parameter name="strTransactionId" type="string" pass="byref"/>
        <parameter name="lAssignmentId" type="i8" pass="byref"/>
        <parameter name="lRequestId" type="i8" pass="byref"/>
        <parameter name="lACDUserId" type="i8" pass="byref"/>
        <parameter name="lAssignmentSkillId" type="i8" pass="byref"/>
        <parameter name="strAssignmentSkillName" type="string" pass="byref"/>
        <parameter name="lAssignmentLanguageId" type="i8" pass="byref"/>
        <parameter name="strAssignmentLanguageName" type="string" pass="byref"/>
        <parameter name="lAssignmentGroupId" type="i8" pass="byref"/>
        <parameter name="strAssignmentGroupName" type="string" pass="byref"/>
        <parameter name="nRequestType" type="i4" pass="byref"/>
        <parameter name="strRequestTypeName" type="string" pass="byref"/>
        <parameter name="lServiceProviderId" type="i8" pass="byref"/>
        <parameter name="strServiceProviderName" type="string" pass="byref"/>
        <parameter name="lOfferingId" type="i8" pass="byref"/>
        <parameter name="strOfferingName" type="string" pass="byref"/>
        <parameter name="strConfEventId" type="string" pass="byref"/>
        <parameter name="strModPasscode" type="string" pass="byref"/>
        <parameter name="strSubscriberAccount" type="string" pass="byref"/>
        <parameter name="strSubscriberFirstName" type="string" pass="byref"/>
        <parameter name="strSubscriberLastName" type="string" pass="byref"/>
        <parameter name="strCSRAppServerIP" type="string" pass="byref"/>
        <parameter name="strAssignmentType" type="string" pass="byref"/>
        <parameter name="lAssignmentDuration" type="i8" pass="byref"/>
        <parameter name="strSubscriberPin" type="string" pass="byref"/>
        <parameter name="strCSRAssignmentAction" type="string" pass="byref"/>
      </parameters>
      <local-vars >
        <var name="f_nReturnCode" type="i4" >-1</var>
        <var name="bValidDest" type="boolean" >0</var>
        <var name="lCSRRequestId" type="i8" >0</var>
      </local-vars>
      <actions >
        <action id="52" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=120 y=41 ?>
          <!--"setDTMFOff"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;setDTMFOff&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="48" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: OnCSRBeginAssignment");
js_disable_event();
Session.g_lCSRAssignmentStartTime = Server.getUTCTime();
Session.g_bWaitForCSR = false;]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Pactolus.Branch.1" ><?xtml-editor x=109 y=411 ?>
          <!--in MOH-->
          <results >
            <result name="Default" link="5" stubbed="0"/>
            <result name="SideBarRequestOperator" link="47" stubbed="0" >g_bSideBarOperatorRequest == true</result>
            <result name="WFCSR zero out?" link="15" stubbed="0" >g_nCallerCurrentState == s_nStateZeroOutToCsr
OR (g_nCallerCurrentState == s_nStateRequeue
AND g_bZeroOutToCSR == true)</result>
            <result name="ConnectToMOH==true" link="28" stubbed="0" >g_bConnectToMOH == true</result>
            <result name="Wait to connect to MOH" link="27" stubbed="0" >g_bMOHTimerFlag == true</result>
          </results>
        </action>
        <action id="3" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=910 y=492 ?>
          <!--"DisconnectFromMOH"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DisconnectFromMOH&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="11" stubbed="0"/>
            <result name="SUCCESS" link="24" stubbed="0" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (1 == Result.id)
	Session.g_nTerminationReason = 40;]]></script>
          </scripts>
        </action>
        <action id="5" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=384 y=243 ?>
          <!--stop timers-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;StopTimer&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="6" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nCallerCurrentState = Session.s_nStateBeginAssignment;]]></script>
          </scripts>
        </action>
        <action id="6" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=621 y=239 ?>
          <!--Delete MS Connection-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DeleteMSConnection&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="24" stubbed="1"/>
          </results>
        </action>
        <action id="9" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1381 y=556 ?>
          <!--AddMemberToTempConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
            <parameter >g_oCallLegA</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="13" stubbed="0"/>
          </results>
        </action>
        <action id="11" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1130 y=435 ?>
          <!--Hang up caller-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpCaller&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="12" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nConfLeaveReason = 19;
Session.g_strConfLeaveMsg = "FAIL TO DISCONNECT FROM MOH";]]></script>
          </scripts>
        </action>
        <action id="12" plug-in="Standard.EndSession.1" ><?xtml-editor x=1356 y=434 ?></action>
        <action id="13" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1608 y=549 ?>
          <!--success?-->
          <results >
            <result name="Default" link="51" stubbed="0"/>
            <result name="f_nReturnCode==s_nSuccess" link="55" stubbed="0" >f_nReturnCode == s_nSuccess</result>
            <result name="CALLER HUNGUP" link="58" stubbed="0" >f_nReturnCode == s_nCallerHungup</result>
          </results>
        </action>
        <action id="15" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=438 y=392 ?>
          <!--stop timers-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;StopTimer&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="42" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nCallerCurrentState = Session.s_nStateBeginAssignment;]]></script>
          </scripts>
        </action>
        <action id="16" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=2073 y=864 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_enable_event();
Session.g_bTalkingWithCSR = true;]]></script>
          </scripts>
        </action>
        <action id="19" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2120 y=472 ?>
          <!--Play Join Tone to conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;PlayPromptToConference&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
            <parameter >g_strLanguage</parameter>
            <parameter >s_nPromptArrivalTone</parameter>
          </function>
          <results >
            <result name="Default" link="42" stubbed="1"/>
          </results>
        </action>
        <action id="20" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1385 y=715 ?>
          <!--AddMemberToTempConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
            <parameter >g_oCallLegB</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="21" stubbed="0"/>
          </results>
        </action>
        <action id="21" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1612 y=708 ?>
          <!--success?-->
          <results >
            <result name="Default" link="51" stubbed="1"/>
            <result name="f_nReturnCode==s_nSuccess" link="56" stubbed="0" >f_nReturnCode == s_nSuccess</result>
            <result name="CALLER HUNGUP" link="58" stubbed="1" >f_nReturnCode == s_nCallerHungup</result>
          </results>
        </action>
        <action id="24" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1149 y=573 ?>
          <!--Dial In?-->
          <results >
            <result name="Default" link="9" stubbed="0"/>
            <result name="g_strOutdialFlag = &quot;T&quot;;" link="20" stubbed="0" >g_strOutdialFlag match "T"</result>
          </results>
        </action>
        <action id="27" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=438 y=796 ?>
          <!--stop timers-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;StopTimer&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="24" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nCallerCurrentState = Session.s_nStateBeginAssignment;]]></script>
          </scripts>
        </action>
        <action id="28" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=422 y=500 ?>
          <!--stop timers-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;StopTimer&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="3" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nCallerCurrentState = Session.s_nStateBeginAssignment;]]></script>
          </scripts>
        </action>
        <action id="32" plug-in="Pactolus.JavaStaticMethod.1" ><?xtml-editor x=890 y=31 ?>
          <!--BeginAssignment-->
          <java xmlns="urn:www.pactolus.com:xtml:application" class="&quot;com.pactolus.acd.psAPISceBeginAssignment&quot;" method="&quot;beginAssignment&quot;" timeout="s_nTimeout" return="" method-return-var="f_nReturnCode" method-return-type="0" >
            <parameter type="in" var-type="string" >g_strDBNAME</parameter>
            <parameter type="in" var-type="string" >g_strSessionId</parameter>
            <parameter type="in" var-type="i8" >g_lCSRRequestId</parameter>
            <parameter type="in" var-type="string" >g_strSoapAddress</parameter>
            <parameter type="in" var-type="i8" >g_lCSRAssignmentId</parameter>
            <parameter type="in" var-type="i8" >g_lCSRAssignmentUserId</parameter>
            <parameter type="in" var-type="i8" >g_lCSRAssignmentStartTime</parameter>
          </java>
          <results >
            <result name="Default" link="57" stubbed="0"/>
            <result name="Success" link="2" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: *********JAVA CALLING psAPISceAssignment *********");

Session.g_strACDControllerIP = Session.strACDControllerIP;

Session.g_nACDControllerPort = Session.nACDControllerPort;

Server.logInfo("RECEIVE CSRBeginAssignment");

Server.logInfo("Assignment Id: " + Session.lAssignmentId);

Session.g_lCSRAssignmentId = new String(Session.lAssignmentId);

Server.logInfo("LONG ASSIGNMENT Id: " + Session.g_lCSRAssignmentId);

//Session.g_lCSRRequestId = Session.lCSRRequestId; 
Session.g_lCSRRequestId = Session.lRequestId;
Server.logInfo("Request Id: " + Session.g_lCSRRequestId);

Server.logInfo("ACD User Id: " + Session.lACDUserId);

Session.g_lCSRAssignmentUserId = Session.lACDUserId;

Server.logInfo("Assignment skill Id: " + Session.lAssignmentSkillId);

Session.g_nCSRAssignmentSkillId = Session.lAssignmentSkillId;

Server.logInfo("Assignment skill name: " + Session.strAssignmentSkillName);

Session.g_strCSRAssignmentSkillName = Session.strAssignmentSkillName;

Server.logInfo("Assignment language Id: " + Session.lAssignmentLanguageId);

Session.g_nCSRAssignmentLanguageId = Session.lAssignmentLanguageId;

Server.logInfo("Assignment language name: " + Session.strAssignmentLanguageName);

Session.g_strCSRAssignmentLanguageName = Session.strAssignmentLanguageName;

Server.logInfo("Assignment group Id: " + Session.lAssignmentGroupId);

Session.g_nCSRAssignmentGroupId = Session.lAssignmentGroupId;

Server.logInfo("Assignment group name: " + Session.strAssignmentGroupName);

Session.g_strCSRAssignmentGroupName = Session.strAssignmentGroupName;

Server.logInfo("Request type: " + Session.nRequestType);

Server.logInfo("Request type name: " + Session.strRequestTypeName);

Session.g_strCSRRequestTypeName = Session.strRequestTypeName;

Server.logInfo("strAssignmentType: " + Session.strAssignmentType);

Session.g_strCSRAssignmentType = Session.strAssignmentType;

Server.logInfo("strCSRAppServerIP: " + Session.strCSRAppServerIP);

Session.g_strCSRAppServerIP = Session.strCSRAppServerIP;

Server.logInfo("Service Provider Id: " + Session.lServiceProviderId);

Server.logInfo("Service Provider name: " + Session.strServiceProviderName);

Server.logInfo("Offering Id: " + Session.lOfferingId);

Server.logInfo("Offering name: " + Session.strOfferingName);

Server.logInfo("Conf Event Id: " + Session.strConfEventId);

Server.logInfo("Mod passcode: " + Session.strModPasscode);

Server.logInfo("Subscriber Account: " + Session.strSubscriberAccount);

Server.logInfo("Subscriber First Name: " + Session.strSubscriberFirstName);

Server.logInfo("Subscriber Last Name: " + Session.strSubscriberLastName);

Server.logInfo("lAssignmentDuration: " + Session.lAssignmentDuration);]]></script>
            <script language="javascript" timing="last" ><![CDATA[Server.logInfo("INFO: ********* iJavaReturnCode " + Session.f_nReturnCode);

Session.g_bSentAPIBeginAssignment = true;

if (Result.id != 2 || Session.f_nReturnCode < 0)
	Session.g_nTerminationReason = 39;]]></script>
          </scripts>
        </action>
        <action id="34" plug-in="Standard.Timer.1" ><?xtml-editor x=590 y=1092 ?>
          <!--stop max wait time for CSR-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="0" id="g_lWaitCSRTimerId" duration=""/>
          <results >
            <result name="Default" link="38" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bWaitCSRTimerSet = false;]]></script>
          </scripts>
        </action>
        <action id="36" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=819 y=837 ?>
          <!--Remove member from conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;RemoveMemberFromConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="24" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: SIDEBAR OPERATOR REQUEST, BEGIN ASSIGNMENT, REMOVE MEMBER FROM CONFERENCE.");]]></script>
          </scripts>
        </action>
        <action id="37" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=636 y=33 ?>
          <!--ConfBeginAssignmentNotify-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="s_strBeginAssignmentNotify" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;ThirdPartyConfId&quot;" value="g_strCustomerConferenceId"/>
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
            <parameter tag="&quot;callerPasscode&quot;" value="g_strCCGeneratedPassCode"/>
            <parameter tag="&quot;beginTime&quot;" value="g_lCSRAssignmentStartTime"/>
            <parameter tag="&quot;privateTalkFlag&quot;" value="g_strRequestCSRPrivateTalkFlag"/>
            <parameter tag="&quot;requestType&quot;" value="g_nRequestCSRType"/>
          </SOAP>
          <results >
            <result name="Default" link="32" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)
{
	Server.logError("FAIL TO SEND CONF BEGIN ASSIGNMENT NOTIFY TO CONF CONTROLLER, EXIT ON: " + Result.name);
}]]></script>
          </scripts>
        </action>
        <action id="38" plug-in="Pactolus.Branch.1" ><?xtml-editor x=584 y=932 ?>
          <!--in sub conf?-->
          <results >
            <result name="Default" link="36" stubbed="0"/>
            <result name="MOH" link="59" stubbed="0" >g_bDtmfCollectionOnHold == true
OR g_bConnectToMOH == true</result>
            <result name="g_bCurrentlyInSubConf" link="39" stubbed="0" >g_bCurrentlyInSubConf == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (Session.g_strCSRRequestEndPoint.length > 0 && (Session.g_oTempConf.strConferenceId != Session.g_strCSRRequestEndPoint) )
{
	Server.logInfo("TEMP CONFERENCE ID GOT OVERWRITTEN, GET BACK FROM CSR REQUEST ENDPOINT");
	Session.g_oTempConf.strConferenceId = Session.g_strCSRRequestEndPoint;
}]]></script>
          </scripts>
        </action>
        <action id="39" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=856 y=1159 ?>
          <!--Remove member from conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;RemoveMemberFromConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oSubConfMS</parameter>
          </function>
          <results >
            <result name="Default" link="24" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: CONF HOLD PARTY REQUEST, REMOVE MEMBER FROM SUB CONFERENCE.");]]></script>
          </scripts>
        </action>
        <action id="40" plug-in="Standard.Timer.1" ><?xtml-editor x=1852 y=861 ?>
          <!--ck reInvite timer-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lCkReInviteTimerIdA" duration="g_nCkReInviteTime"/>
          <results >
            <result name="Default" link="16" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bCkReInviteTimerFlagA = true;
Server.logInfo("SET TIMER TO CHECK FOR REINVITE A LEG");]]></script>
          </scripts>
        </action>
        <action id="41" plug-in="Standard.Timer.1" ><?xtml-editor x=1870 y=977 ?>
          <!--ck reInvite timer B-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lCkReInviteTimerIdB" duration="g_nCkReInviteTime"/>
          <results >
            <result name="Default" link="16" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bCkReInviteTimerFlagB = true;
Server.logInfo("SET TIMER TO CHECK FOR REINVITE B LEG");]]></script>
          </scripts>
        </action>
        <action id="42" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1393 y=900 ?>
          <results >
            <result name="Default" link="16" stubbed="1"/>
            <result name="Time &gt; 0" link="43" stubbed="0" >g_nCkReInviteTime &gt; 0</result>
          </results>
        </action>
        <action id="43" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1629 y=894 ?>
          <!--Dial In?-->
          <results >
            <result name="Default" link="40" stubbed="0"/>
            <result name="g_strOutdialFlag = &quot;T&quot;" link="41" stubbed="0" >g_strOutdialFlag match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("BEGIN ASSIGNMENT, RESET TIMER TO CHECK FOR REINVITE");]]></script>
          </scripts>
        </action>
        <action id="46" plug-in="Standard.Timer.1" ><?xtml-editor x=370 y=1090 ?>
          <!--stop beep beep-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="0" id="g_lBeepBeepTimerId" duration=""/>
          <results >
            <result name="Default" link="34" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bBeepBeepTimerFlag = false;]]></script>
          </scripts>
        </action>
        <action id="47" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=364 y=937 ?>
          <!--stop timers-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;StopTimer&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="38" stubbed="0"/>
          </results>
        </action>
        <action id="48" plug-in="Pactolus.Branch.1" ><?xtml-editor x=357 y=41 ?>
          <results >
            <result name="Default" link="32" stubbed="1"/>
            <result name="bValidDest" link="37" stubbed="0" >bValidDest == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (Session.g_strConfControllerIP.length <= 0 || Session.g_nConfControllerPort <= 0)
{
	Session.bValidDest = false;
}
else if (!Session.g_bSentPartyJoin)
{
	Session.bValidDest = false;
}
else
{
	Session.bValidDest = true;
}]]></script>
          </scripts>
        </action>
        <action id="49" plug-in="Standard.EndSession.1" ><?xtml-editor x=2137 y=624 ?>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 1;]]></script>
          </scripts>
        </action>
        <action id="50" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=913 y=619 ?>
          <!--Hang up caller-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpCaller&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="12" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 36;
Session.g_nConfLeaveReason = 4;
Session.g_strConfLeaveMsg = "FAIL TO INVITE PARTY TO HOLD";]]></script>
          </scripts>
        </action>
        <action id="51" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1758 y=356 ?>
          <!--Hang up caller-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpCaller&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="12" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 35;
Session.g_nConfLeaveReason = 9;
Session.g_strConfLeaveMsg = "FAIL TO ADD PARTY TO CONFERENCE";]]></script>
          </scripts>
        </action>
        <action id="55" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1877 y=470 ?>
          <!--acd-play-bridge-tone-->
          <results >
            <result name="Default" link="42" stubbed="1"/>
            <result name="acd-play-bridge-tone" link="19" stubbed="0" >s_strPlayBridgeTone match "T"</result>
          </results>
        </action>
        <action id="56" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1849 y=708 ?>
          <!--acd-play-bridge-tone-->
          <results >
            <result name="Default" link="42" stubbed="1"/>
            <result name="acd-play-bridge-tone" link="19" stubbed="1" >s_strPlayBridgeTone match "T"</result>
          </results>
        </action>
        <action id="57" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1092 y=24 ?>
          <!--Hang up caller-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpCaller&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="12" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nConfLeaveReason = 18;
Session.g_strConfLeaveMsg = "FAIL TO CALL JAVA API";]]></script>
          </scripts>
        </action>
        <action id="58" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1884 y=625 ?>
          <!--Party Leave-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;PartyLeave&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="49" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nConfLeaveReason = 0;
Session.g_strConfLeaveMsg = "PARTY HANG UP";]]></script>
          </scripts>
        </action>
        <action id="59" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=867 y=992 ?>
          <!--"DisconnectFromMOH"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DisconnectFromMOH&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="11" stubbed="1"/>
            <result name="SUCCESS" link="24" stubbed="1" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bDtmfCollectionOnHold = false;]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (1 == Result.id)
	Session.g_nTerminationReason = 40;]]></script>
          </scripts>
        </action>
      </actions>
    </function>
    <function name="CSRBeginRequest" start="1" event="CSRBeginRequest" returns="i4" >
      <local-vars >
        <var name="f_nReturnCode" type="i4" >-1</var>
        <var name="f_strACDControllerIP" type="string" ></var>
        <var name="f_nACDControllerPort" type="i4" >0</var>
        <var name="f_strTransactionId" type="string" ></var>
        <var name="f_strReturnMsg" type="string" ></var>
        <var name="f_strModPassCode" type="string" ></var>
        <var name="bValidDest" type="boolean" >0</var>
      </local-vars>
      <actions >
        <action id="1" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=144 y=102 ?>
          <!--"psAPISceBeginRequest"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceBeginRequest&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="5" stubbed="0"/>
            <result name="SUCCESS" link="3" stubbed="0" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: CSRBeginRequest");

Session.g_lCSRAssignmentId = 0;

//Session.g_lCSRAssignmentUserId = 0;

//Session.g_lCSRRequestId = 0;

//Session.g_lCSRAssignmentUserId = 0;

//Session.g_lCSRAssignmentStartTime = 0;

//Session.g_lCSRAssignmentEndTime = 0;]]></script>
          </scripts>
        </action>
        <action id="3" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=391 y=172 ?>
          <!--psAPISceGetRequestDisplayInfo-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceGetRequestDisplayInfo &quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="5" stubbed="1"/>
            <result name="SUCCESS" link="12" stubbed="0" >f_nReturnCode == s_nSuccess</result>
          </results>
        </action>
        <action id="4" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1092 y=161 ?>
          <!--s_strMSG_BEGIN_REQUEST_CSR-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strACDControllerIP" transaction="s_strZeroTransactionId" message-name="&quot;BeginRequestCSR&quot;" destination-port="g_nACDControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;RequestId&quot;" value="g_lCSRRequestId"/>
            <parameter tag="&quot;RequestType&quot;" value="g_nCSRRouteReasonCode"/>
            <parameter tag="&quot;RequestTypeName&quot;" value="g_strCSRRequestTypeName"/>
            <parameter tag="&quot;LanguageId&quot;" value="g_lCSRRequestLanguageId"/>
            <parameter tag="&quot;Language&quot;" value="g_strCSRRequestLanguageName"/>
            <parameter tag="&quot;OfferingId&quot;" value="g_lCSRRequestOfferingId"/>
            <parameter tag="&quot;OfferingName&quot;" value="g_strCSRRequestOfferingName"/>
            <parameter tag="&quot;ServiceId&quot;" value="g_lCSRRequestServiceId"/>
            <parameter tag="&quot;ServiceName&quot;" value="g_strCSRRequestServiceName"/>
            <parameter tag="&quot;SkillId&quot;" value="g_lCSRRequestSkillId"/>
            <parameter tag="&quot;SkillName&quot;" value="g_strCSRRequestSkillName"/>
            <parameter tag="&quot;AccessNumber&quot;" value="g_strOrigAccessNbr"/>
            <parameter tag="&quot;AccessNumberType&quot;" value="g_nEventDnisType"/>
            <parameter tag="&quot;BackupFlag&quot;" value="g_bSecondaryDnisNumberFlag"/>
            <parameter tag="&quot;DialedNumber&quot;" value="g_strDialedNumberFromDB"/>
            <parameter tag="&quot;CountryName&quot;" value="g_strOrigCountryName"/>
            <parameter tag="&quot;ConferenceEventId&quot;" value="g_strConfEventId"/>
            <parameter tag="&quot;ConferenceScheduleId&quot;" value="g_strConfScheduleId"/>
            <parameter tag="&quot;ServiceProviderId&quot;" value="g_lServiceProviderId"/>
            <parameter tag="&quot;ServiceProviderName&quot;" value="g_strCSRServiceProviderName"/>
            <parameter tag="&quot;ConferenceEndPoint&quot;" value="g_strCSRRequestEndPoint"/>
            <parameter tag="&quot;SoapAgentPort&quot;" value="g_nSoapPort"/>
            <parameter tag="&quot;ConfModPasscode&quot;" value="f_strModPassCode"/>
            <parameter tag="&quot;SubscriberAccount&quot;" value="g_strSubscriberAccount"/>
            <parameter tag="&quot;SubscriberFirstName&quot;" value="g_strCallerFirstName"/>
            <parameter tag="&quot;SubscriberLastName&quot;" value="g_strCallerLastName"/>
            <parameter tag="&quot;GroupId&quot;" value="g_lCSRRequestGroupId"/>
            <parameter tag="&quot;GroupName&quot;" value="g_strCSRRequestGroupName"/>
            <parameter tag="&quot;SubscriberPin&quot;" value="g_strSubscriberPin"/>
            <parameter tag="&quot;RequestorANI&quot;" value="g_strOrigNbr"/>
            <parameter tag="&quot;AccessNumberType&quot;" value="g_nEventDnisType"/>
            <parameter tag="&quot;ConferenceStartTime&quot;" value="g_strScheduleStartTime"/>
            <parameter tag="&quot;AutoAssign&quot;" value="g_strAutoAssign"/>
            <parameter tag="&quot;Passcode&quot;" value="g_strCCGeneratedPassCode"/>
            <parameter tag="&quot;reservationCode&quot;" value="g_strReservationCode"/>
            <parameter tag="&quot;invalidConferenceCode&quot;" value="g_nInvalidConferenceCode"/>
            <parameter tag="&quot;invalidConferenceMessage&quot;" value="g_strInvalidConferenceMsg"/>
            <parameter tag="&quot;partyDetail&quot;" value="g_strPartyDetail"/>
          </SOAP>
          <results >
            <result name="Default" link="5" stubbed="1"/>
            <result name="Success" link="9" stubbed="1"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_strModPassCode = Session.g_strPassCode;
Server.logInfo("SERVER SOAP PORT IS: " + Server.soapPort);
Session.g_nSoapPort = Clib.atoi(Server.soapPort);
if (0 == Session.g_nSoapPort)
{
	Server.logError("ERROR: Server.soapPort IS ZERO");
	Server.logInfo("SET DEFAULT SOAP PORT TO 7581");
	Session.g_nSoapPort = 7581;
}]]></script>
            <script language="javascript" timing="last" ><![CDATA[Session.g_bSentACDBeginRequest = true;]]></script>
          </scripts>
        </action>
        <action id="5" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=377 y=82 ?>
          <!--s_nFailure-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nFailure"/>
        </action>
        <action id="7" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=844 y=345 ?>
          <!--s_nSuccess-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nSuccess"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bWaitForCSR = true;

Session.g_nCallerCurrentState = Session.s_nStateBeginRequest;]]></script>
          </scripts>
        </action>
        <action id="8" plug-in="Standard.Timer.1" ><?xtml-editor x=620 y=348 ?>
          <!--set timer to check heartbeat with ACD controller-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lHeartbeatRequestTimerId" duration="s_nHeartBeatTime"/>
          <results >
            <result name="Default" link="7" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bHeartbeatTimerFlag = true;]]></script>
          </scripts>
        </action>
        <action id="9" plug-in="Standard.WaitEvent.1" ><?xtml-editor x=154 y=355 ?>
          <!--wait for begin request response-->
          <wait xmlns="urn:www.pactolus.com:xtml:communication" timeout="10" recv-name="g_strEventReceived" >
            <msg name="RequestCSRResponse" >
              <parameter >f_strACDControllerIP</parameter>
              <parameter >f_nACDControllerPort</parameter>
              <parameter >f_strTransactionId</parameter>
              <parameter >f_nReturnCode</parameter>
              <parameter >f_strReturnMsg</parameter>
            </msg>
          </wait>
          <results >
            <result name="Default" link="5" stubbed="1"/>
            <result name="Success" link="10" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="10" plug-in="Pactolus.Branch.1" ><?xtml-editor x=392 y=352 ?>
          <!--return code = -1-->
          <results >
            <result name="Default" link="8" stubbed="0"/>
            <result name="f_nReturnCode == -1" link="5" stubbed="1" >f_nReturnCode == -1</result>
          </results>
        </action>
        <action id="12" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=630 y=167 ?>
          <!--"psAPISceConfGetPartyDetail"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceConfGetPartyDetail&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="13" stubbed="0"/>
          </results>
        </action>
        <action id="13" plug-in="Pactolus.Branch.1" ><?xtml-editor x=857 y=166 ?>
          <!--valid dest?-->
          <results >
            <result name="Default" link="5" stubbed="1"/>
            <result name="bValidDest" link="4" stubbed="0" >bValidDest == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (0 == Session.g_nACDControllerPort || 0 == Session.g_strACDControllerIP.length)
{
	Session.bValidDest = false;
	Server.logError("NO ACD CONTROLLER IP OR PORT: " + Session.g_strACDControllerIP + "  : " + Session.g_nACDControllerPort);
}
else
{
	Session.bValidDest = true;
}]]></script>
          </scripts>
        </action>
      </actions>
    </function>
    <function name="psAPISceEndRequest" start="3" event="psAPISceEndRequest" returns="i4" >
      <local-vars >
        <var name="f_nReturnCode" type="i4" >-50</var>
        <var name="f_nRequestDuration" type="i4" >0</var>
      </local-vars>
      <actions >
        <action id="3" plug-in="Pactolus.JavaStaticMethod.1" ><?xtml-editor x=219 y=206 ?>
          <!--EndRequest-->
          <java xmlns="urn:www.pactolus.com:xtml:application" class="&quot;com.pactolus.acd.psAPISceEndRequest&quot;" method="&quot;logEndRequest&quot;" timeout="s_nTimeout" return="" method-return-var="f_nReturnCode" method-return-type="0" >
            <parameter type="in" var-type="string" >g_strDBNAME</parameter>
            <parameter type="in" var-type="i8" >g_lCSRRequestId</parameter>
            <parameter type="in" var-type="boolean" >g_bCSRAssignmentFlag</parameter>
            <parameter type="in" var-type="string" >g_strSessionId</parameter>
            <parameter type="in" var-type="string" >g_strSessionId</parameter>
            <parameter type="in" var-type="string" >s_strLocalHost</parameter>
            <parameter type="in" var-type="i8" >g_lCSRAssignmentId</parameter>
            <parameter type="in" var-type="i8" >g_lCSRAssignmentUserId</parameter>
            <parameter type="in" var-type="i4" >g_nCSRAssignmentGroupId</parameter>
            <parameter type="in" var-type="string" >g_strCSRAssignmentType</parameter>
            <parameter type="in" var-type="i4" >g_nCSRAssignmentSkillId</parameter>
            <parameter type="in" var-type="i4" >g_nCSRAssignmentLanguageId</parameter>
            <parameter type="in" var-type="i8" >g_lCSRAssignmentStartTime</parameter>
            <parameter type="in" var-type="i8" >g_lRequestStartTime</parameter>
            <parameter type="in" var-type="i8" >g_lRequestEndTime</parameter>
            <parameter type="in" var-type="i8" >g_lSubscriberId</parameter>
            <parameter type="in" var-type="string" >g_strConfEventId</parameter>
            <parameter type="in" var-type="i4" >g_nTerminationReason</parameter>
            <parameter type="in" var-type="i8" >g_lCSRRequestOfferingId</parameter>
            <parameter type="in" var-type="i8" >g_lCSRRequestServiceId</parameter>
            <parameter type="in" var-type="i8" >g_lServiceProviderId</parameter>
            <parameter type="in" var-type="i4" >f_nRequestDuration</parameter>
          </java>
          <results >
            <result name="Default" link="1" stubbed="0"/>
            <result name="Success" link="2" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: psAPISceEndRequest");
Session.g_lRequestEndTime = Server.getUTCTime();

Session.f_nRequestDuration = Session.g_lRequestEndTime - Session.g_lRequestStartTime;

Server.logInfo("INFO: *********JAVA CALLING psAPISceEndRequest *********");

Server.logInfo("INFO: BEFORE DB name = " + Session.g_strDBNAME);

Server.logInfo("INFO: BEFORE session Id = " + Session.g_strSessionId);

Server.logInfo("INFO: BEFORE application name = " + Session.s_strApplicationName);

Server.logInfo("INFO: BEFORE request server ip = " + Session.s_strLocalHost);

Server.logInfo("INFO: BEFORE access number id = " + Session.g_nAccessNumberId);

Server.logInfo("INFO: BEFORE route reason code = " + Session.g_nCSRRouteReasonCode);

Server.logInfo("INFO: BEFORE language = " + Session.g_strLanguage);

Server.logInfo("INFO: BEFORE request skill id = " + Session.g_lCSRRequestSkillId);

Server.logInfo("INFO: BEFORE request end time = " + Session.g_lRequestStartTime);

Server.logInfo("INFO: BEFORE subscriber id = " + Session.g_lSubscriberId);

Server.logInfo("INFO: BEFORE conf event id = " + Session.g_strConfEventId);]]></script>
            <script language="javascript" timing="last" ><![CDATA[Server.logInfo("INFO: ********* iJavaReturnCode " + Session.f_nReturnCode);
if (Result.id == 2)
{
	Server.logInfo("INFO: SUCCESS LOG BEGIN REQUEST.");
	if (-99 == Session.f_nReturnCode)
		Session.g_nErrorMsgNumber = 1001; //db error
	else
		Session.g_nErrorMsgNumber = 0;
}
else
{
	Server.logError("ERROR: FAIL TO CALL psAPISceEndRequest, EXIT ON: " + Result.name);
	Session.g_nTerminationReason = 39;
	Session.g_nErrorMsgNumber = 1000; //jvm server error
}
Session.g_nCallerCurrentState = Session.s_nStateEndRequest;
Session.g_bWaitForCSR = false;
Session.g_bSideBarOperatorRequest = false;
Session.g_bSentAPIBeginRequest = false;
Session.g_bSentACDBeginRequest = false;]]></script>
          </scripts>
        </action>
        <action id="1" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=479 y=171 ?>
          <!--FAILURE-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nFailure"/>
        </action>
        <action id="2" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=492 y=287 ?>
          <!--return code from java-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nReturnCode"/>
        </action>
      </actions>
    </function>
    <function name="OnCSRAddCallerToConf" start="64" event="OnCSRAddCallerToConf" returns="void" >
      <parameters >
        <parameter name="strACDControllerIP" type="string" pass="byref"/>
        <parameter name="nACDControllerPort" type="i4" pass="byref"/>
        <parameter name="strTransactionId" type="string" pass="byref"/>
        <parameter name="strConfPasscode" type="string" pass="byref"/>
      </parameters>
      <local-vars >
        <var name="f_nReturnCode" type="i4" >-50</var>
        <var name="f_sCounter" type="i2" >0</var>
        <var name="f_nPromptToPlay" type="i4" >99</var>
        <var name="f_lCurrentTime" type="i8" >0</var>
        <var name="f_strPongSessionId" type="string" ></var>
        <var name="f_nPassCodeStatus" type="i4" >0</var>
        <var name="f_nWaitForResCounter" type="i4" >0</var>
        <var name="f_bPlayPleaseHold" type="boolean" >0</var>
        <var name="f_strReturnMsg" type="string" ></var>
        <var name="f_sMaxRetry" type="i2" >0</var>
        <var name="f_strTerminationDigit" type="string" ></var>
      </local-vars>
      <actions >
        <action id="64" plug-in="Pactolus.Branch.1" ><?xtml-editor x=40 y=2081 ?>
          <!--SidebarOperatorRequest-->
          <results >
            <result name="Default" link="59" stubbed="0"/>
            <result name="SideBarOp" link="70" stubbed="0" >g_bSideBarOperatorRequest == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: OnCSRAddCallerToConf");]]></script>
          </scripts>
        </action>
        <action id="1" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=543 y=394 ?>
          <!--authenticate pass code-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceAuthConfPassCode&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="44" stubbed="0"/>
            <result name="0 - Non First Caller" link="13" stubbed="1" >f_nReturnCode == s_nNonFirstCaller</result>
            <result name="1 - First Caller" link="18" stubbed="1" >f_nReturnCode == s_nFirstCaller</result>
            <result name="2 - Wait for Conf Resource" link="26" stubbed="0" >f_nReturnCode == 2</result>
            <result name="-2 - Too early" link="27" stubbed="0" >f_nReturnCode == -2</result>
            <result name="-8 - Passcode inused" link="50" stubbed="0" >f_nReturnCode == -8</result>
            <result name="-11 - WFM" link="31" stubbed="1" >f_nReturnCode == s_nWaitForMod</result>
            <result name="-14 - WRONG DAY" link="46" stubbed="0" >f_nReturnCode == -14</result>
            <result name="-18 - CANCELLED" link="47" stubbed="0" >f_nReturnCode == -18</result>
            <result name="-19 INVALID ACCESS NUMBER" link="63" stubbed="0" >f_nReturnCode == -19</result>
            <result name="3 Special FirstCaller" link="13" stubbed="1" >f_nReturnCode == 3</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strPassCode = Session.strConfPasscode;

js_disable_event();]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Session.g_strConfResource.length <= 0)

{

	Session.g_bNullString = true;

}

else

{

	Session.g_bNullString = false;

}

switch (Session.f_nReturnCode)

{

	case -3:

		Server.logInfo("INFO: TOO LATE PASSCODE");

		Session.g_nTerminationReason = 20;

		Session.f_nPromptToPlay = Session.s_nPromptTooLate;

		break;

	case -4:

		Server.logInfo("INFO: DISABLE SUBSCRIBER");

		Session.g_nTerminationReason = 4;

		Session.f_nPromptToPlay = Session.s_nPromptDisableSub;

		break;

	case -5:

		Server.logInfo("INFO: MAX ATTENDEES");

		Session.g_nTerminationReason = 15;

		Session.f_nPromptToPlay = Session.s_nPromptMaxAttendeesReach;

		break;

	case -6:

		Server.logInfo("INFO: CONF LOCKED");

		Session.g_nTerminationReason = 16;

		Session.f_nPromptToPlay = Session.s_nPromptConfLocked;

		break;

	case -7:

		Server.logInfo("INFO: CONF ALREADY ENDED");

		Session.g_nTerminationReason = 2;

		Session.f_nPromptToPlay = Session.s_nPromptConfEnded;

		break;

	case -9:

		Server.logInfo("INFO: MOD NOT IN");

		Session.g_nTerminationReason = 22;

		Session.f_nPromptToPlay = Session.s_nPromptModNotArrive;

		break;

	case -10:

		Server.logError("ERROR: NO CONF CONTROLLER");

		Session.g_nTerminationReason = 39;

		Session.f_nPromptToPlay = Session.s_nPromptNoConfController;

		break;

	case -13:

		Server.logInfo("INFO: CONFERENCE DISABLED");

		Session.g_nTerminationReason = 29;

		Session.f_nPromptToPlay = 853;

		break;

	case -17:

			Session.g_nErrorMsgNumber = 0; //conf no rate

			Session.f_nPromptToPlay = 99;

			break;

	case -18:

			Session.g_nErrorMsgNumber = 0; //conf cancelled

			Session.f_nPromptToPlay = 99;

			Session.g_nTerminationReason = 25;

			break;

	case -19:

			Session.g_nErrorMsgNumber = 1021; //conf invalid access number

			Session.f_nPromptToPlay = 99;

			Session.g_nTerminationReason = 28;

			break;

	case -20:

			Server.logInfo("INFO: INVALID SUBSCRIBER ACCESS NUMBER");

			Session.g_nErrorMsgNumber = 4016; //conf subscriber invalid access number

			Session.f_nPromptToPlay = 99;

			Session.g_nTerminationReason = 28;

			break;

	case -22:

		Server.logError("ERROR: INSUFFICIENT MS RESOURCE");
		
		Session.g_nErrorMsgNumber = 4018; //insufficient ms resource

		Session.g_nTerminationReason = 30;
		
		Session.f_nPromptToPlay = 99;

		break;

	case -98:

		Server.logError("ERROR: DB RESTARTED:" + Session.g_strPassCode);

		Session.g_nTerminationReason = 39;

		Session.f_nPromptToPlay = Session.s_nPromptSystemUnavailable;

		break;

	case -99:

		Server.logError("ERROR: DB ERROR PASSCODE:" + Session.g_strPassCode);

		Session.g_nTerminationReason = 39;

		Session.f_nPromptToPlay = Session.s_nPromptDBError;

		break;

	default:

		Session.g_nTerminationReason = 39;

		Session.f_nPromptToPlay = 305;  //system error

		break;

}

js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="4" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=554 y=126 ?>
          <!--Remove member from temp conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;RemoveMemberFromConference&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
          </function>
          <results >
            <result name="Default" link="5" stubbed="0"/>
          </results>
        </action>
        <action id="5" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=784 y=125 ?>
          <!--delete temp conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DeleteConference&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
          </function>
          <results >
            <result name="Default" link="55" stubbed="0"/>
          </results>
        </action>
        <action id="9" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1300 y=120 ?>
          <!--"MSOutdialParty"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;MSOutdialParty&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oCallLegA</parameter>
            <parameter >g_oMS</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="83" stubbed="0"/>
            <result name="SUCCESS" link="42" stubbed="1" >f_nReturnCode == s_nSuccess</result>
            <result name="CALLER HUNGUP" link="39" stubbed="1" >f_nReturnCode == s_nCallerHungup</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (1 == Result.id)
{
	Server.logError("FAIL TO OUTDIAL PARTY TO MS.");
	Session.g_nTerminationReason = 34;
}
else if (3 == Result.id)
{
	Server.logInfo("CALLER HUNGUP");
	Session.g_nTerminationReason = 1;
}]]></script>
          </scripts>
        </action>
        <action id="10" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2006 y=729 ?>
          <!--first caller?-->
          <results >
            <result name="Default" link="21" stubbed="0"/>
            <result name="g_bFirstCaller==true &amp;&amp; create conf" link="20" stubbed="0" >g_bFirstCaller == true
AND g_bNoCreateConfFirstCaller == false</result>
            <result name="g_bFirstCaller==true &amp;&amp; no create conf" link="21" stubbed="1" >g_bFirstCaller == true
AND g_bNoCreateConfFirstCaller == true</result>
          </results>
        </action>
        <action id="11" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=2472 y=813 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
        </action>
        <action id="13" plug-in="Pactolus.Branch.1" ><?xtml-editor x=996 y=459 ?>
          <!--conferenceResource == null?-->
          <results >
            <result name="Default" link="18" stubbed="0"/>
            <result name="conferenceResource == null" link="22" stubbed="1" >g_bNullString == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (2 == Result.id)
{
	Session.g_nErrorMsgNumber = 4014; //null conf resource
	Session.g_nTerminationReason = 39;
	if (3 == Session.f_nReturnCode)
		Server.logError("ERROR: THE FIRST CALLER and NO NEED TO GET CONFERENCE ENDPOINT, BUT CONF RESOURCE IS NULL: " + Session.g_strConfResource);
	else
		Server.logError("ERROR: NOT THE FIRST CALLER, BUT CONF RESOURCE IS NULL: " + Session.g_strConfResource);
}
else
{
	Session.g_bNullString = false;
	Session.g_oMS.strConferenceId = Session.g_strConfResource;
}]]></script>
          </scripts>
        </action>
        <action id="16" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1946 y=537 ?>
          <!--"RecordCallerName"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;RecordCallerName&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="40" stubbed="0"/>
          </results>
        </action>
        <action id="17" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1478 y=540 ?>
          <!--Collect billing code-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;(xxxxxxxxxx|x.T|x.#)&quot;" language="g_strLanguage" digits="g_strBillingCodeNumber" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >943</audio>
          </play>
          <results >
            <result name="Default" link="19" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="18" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1230 y=453 ?>
          <!--get billing code?-->
          <results >
            <result name="Default" link="16" stubbed="0"/>
            <result name="g_strBillingCodeFlag==T" link="17" stubbed="0" >g_strBillingCodeFlag match "T"</result>
          </results>
        </action>
        <action id="19" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1720 y=540 ?>
          <!--set billing code-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceSetBillingCode&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="16" stubbed="0"/>
          </results>
        </action>
        <action id="20" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2255 y=818 ?>
          <!--go to main, create conf-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;Main&quot;" return="" external-function="0" library="" >
            <parameter >s_nStateCreateConference</parameter>
          </function>
          <results >
            <result name="Default" link="11" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nCallerCurrentState = Session.s_nStateAddCallerToConf;]]></script>
          </scripts>
        </action>
        <action id="21" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2241 y=703 ?>
          <!--go to main, add to conf-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;Main&quot;" return="" external-function="0" library="" >
            <parameter >s_nStateAddToConference</parameter>
          </function>
          <results >
            <result name="Default" link="11" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_oMS.strConferenceId = Session.g_strConfResource;

Session.g_nCallerCurrentState = Session.s_nStateAddCallerToConf;]]></script>
          </scripts>
        </action>
        <action id="22" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1654 y=1056 ?>
          <!--Hang up caller-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpCaller&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="39" stubbed="0"/>
          </results>
        </action>
        <action id="23" plug-in="Standard.EndSession.1" ><?xtml-editor x=2344 y=1047 ?></action>
        <action id="25" plug-in="Pactolus.Sleep.1" ><?xtml-editor x=1489 y=751 ?>
          <!--5 secs-->
          <sleep xmlns="urn:www.pactolus.com:xtml:application" duration="5"/>
          <results >
            <result name="Default" link="1" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (Session.f_bPlayPleaseHold == true)

{

	Session.f_bPlayPleaseHold = false;

}

else if(Session.f_bPlayPleaseHold == false)

{

	Session.f_bPlayPleaseHold = true;

}]]></script>
          </scripts>
        </action>
        <action id="26" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1005 y=807 ?>
          <!--exceed max retry?-->
          <results >
            <result name="Default" link="60" stubbed="0"/>
            <result name="Counter &gt; MaxRetry?" link="49" stubbed="0" >f_sCounter &gt; s_nMaxRetryWaitConfRes</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_nWaitForResCounter++;

Session.g_strRetryFlag = "T";]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (2 == Result.id)

{

	Session.g_nTerminationReason = 2;

	Session.g_nErrorMsgNumber = 4012;  //exceed max wait for conf resource

	Server.logError("ERROR: EXCEED MAX WAIT FOR CONFERENCE RESOURCE.");

}]]></script>
          </scripts>
        </action>
        <action id="27" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=992 y=1118 ?>
          <!--TOO EARLY-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >s_nPromptTooEarly</audio>
            <audio type="time" >g_strScheduleStartTime</audio>
            <audio type="index" >873</audio>
          </play>
          <results >
            <result name="Default" link="22" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 19;]]></script>
          </scripts>
        </action>
        <action id="30" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1740 y=1526 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
        </action>
        <action id="31" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1247 y=1530 ?>
          <!--"RecordCallerName"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;RecordCallerName&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="37" stubbed="0"/>
          </results>
        </action>
        <action id="32" plug-in="Pactolus.JavaStaticMethod.1" ><?xtml-editor x=1975 y=1337 ?>
          <!--"psAPISceConfCleanup"-->
          <java xmlns="urn:www.pactolus.com:xtml:application" class="&quot;com.pactolus.conferencing.psAPISceConfCleanup&quot;" method="&quot;cleanupCallLeg&quot;" timeout="s_nTimeout" return="" method-return-var="f_nReturnCode" method-return-type="0" >
            <parameter type="in" var-type="unknown" >g_strDBNAME</parameter>
            <parameter type="in" var-type="unknown" >g_strExistingCallLegId</parameter>
            <parameter type="in" var-type="unknown" >f_lCurrentTime</parameter>
          </java>
          <results >
            <result name="Default" link="48" stubbed="1"/>
            <result name="Success" link="45" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: ********JAVA CALLING psAPISceConfCleanupCallLeg *********");

Session.f_lCurrentTime = Server.getUTCTime();]]></script>
            <script language="javascript" timing="last" ><![CDATA[Server.logInfo("INFO: ********** iJavaReturnCode " + Session.f_nReturnCode);

if (Result.id == 2)

{

	Server.logInfo("INFO: SUCCESS CALL psAPISceConfCleanupCallLeg.");

}

else

{

	Server.logError("ERROR: FAIL TO CALL psAPISceConfCleanupCallLeg, EXIT ON: " + Result.name);

}]]></script>
          </scripts>
        </action>
        <action id="33" plug-in="Standard.WaitEvent.1" ><?xtml-editor x=1470 y=1344 ?>
          <!--for PONG-->
          <wait xmlns="urn:www.pactolus.com:xtml:communication" timeout="10" recv-name="g_strEventReceived" >
            <msg name="ConferencePong" >
              <parameter >f_nPassCodeStatus</parameter>
            </msg>
          </wait>
          <results >
            <result name="Default" link="32" stubbed="1"/>
            <result name="Success" link="51" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="34" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1220 y=1348 ?>
          <!--PING to session-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="" transaction="" message-name="&quot;ConferencePing&quot;" destination-port="" destination-type="3" destination-session="g_strExistingSessionId" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;PingSessionId&quot;" value="g_strSessionId"/>
            <parameter tag="&quot;CallLegId&quot;" value="g_strPassCode"/>
          </SOAP>
          <results >
            <result name="Default" link="32" stubbed="1"/>
            <result name="Success" link="33" stubbed="0"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_disable_event();]]></script>
          </scripts>
        </action>
        <action id="37" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1493 y=1522 ?>
          <!--go to main, wait for mod-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;Main&quot;" return="" external-function="0" library="" >
            <parameter >s_nStateWaitForMod</parameter>
          </function>
          <results >
            <result name="Default" link="30" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nCallerCurrentState = Session.s_nStateAddCallerToConf;

Session.g_bWaitForModerator = true;]]></script>
          </scripts>
        </action>
        <action id="39" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1888 y=1053 ?>
          <!--Delete MS Connection-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DeleteMSConnection&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="79" stubbed="0"/>
          </results>
        </action>
        <action id="40" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1751 y=735 ?>
          <!--Delete MS Connection-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DeleteMSConnection&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="10" stubbed="0"/>
          </results>
        </action>
        <action id="42" plug-in="Pactolus.Sleep.1" ><?xtml-editor x=298 y=397 ?>
          <!--2 secs-->
          <sleep xmlns="urn:www.pactolus.com:xtml:application" duration="2"/>
          <results >
            <result name="Default" link="1" stubbed="0"/>
          </results>
        </action>
        <action id="44" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=914 y=312 ?>
          <!--f_nPromptToPlay-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >f_nPromptToPlay</audio>
          </play>
          <results >
            <result name="Default" link="22" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="45" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2223 y=1336 ?>
          <!--exceed max retry?-->
          <results >
            <result name="Default" link="62" stubbed="0"/>
            <result name="Counter &gt;= MaxRetry?" link="48" stubbed="1" >f_sCounter &gt;= g_nMaxRetryAllowed</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_sCounter++;

Session.g_strRetryFlag = "T";]]></script>
          </scripts>
        </action>
        <action id="46" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=918 y=1648 ?>
          <!--WRONG DAY-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >948</audio>
          </play>
          <results >
            <result name="Default" link="22" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 26; //wrong day]]></script>
          </scripts>
        </action>
        <action id="47" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=888 y=1793 ?>
          <!--CONF CANCEL-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >949</audio>
          </play>
          <results >
            <result name="Default" link="22" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 25; //conf cancelled]]></script>
          </scripts>
        </action>
        <action id="48" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1995 y=1523 ?>
          <!--could not be add-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >301</audio>
            <audio type="index" >874</audio>
          </play>
          <results >
            <result name="Default" link="22" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 21;

Session.g_nErrorMsgNumber = 4007;  //passcode in used

Server.logError("ERROR: PASSCODE IN USED.");]]></script>
          </scripts>
        </action>
        <action id="49" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1271 y=1022 ?>
          <!--could not be add-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >301</audio>
            <audio type="index" >874</audio>
            <audio type="index" >361</audio>
          </play>
          <results >
            <result name="Default" link="22" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 2;

Session.g_nErrorMsgNumber = 4012;  //exceed max wait for conf resource

Server.logError("ERROR: EXCEED MAX WAIT FOR CONFERENCE RESOURCE.")]]></script>
          </scripts>
        </action>
        <action id="50" plug-in="Pactolus.Branch.1" ><?xtml-editor x=969 y=1354 ?>
          <!--same session-->
          <results >
            <result name="Default" link="34" stubbed="0"/>
            <result name="same session" link="32" stubbed="1" >g_strExistingSessionId match g_strSessionId</result>
          </results>
        </action>
        <action id="51" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1729 y=1337 ?>
          <!--passcode inused?-->
          <results >
            <result name="Default" link="32" stubbed="0"/>
            <result name="passcode inused" link="48" stubbed="0" >f_nPassCodeStatus == s_nPasscodeInUsed</result>
          </results>
        </action>
        <action id="55" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1044 y=121 ?>
          <!--Dial In?-->
          <results >
            <result name="Default" link="9" stubbed="0"/>
            <result name="g_strOutdialFlag = &quot;T&quot;;" link="56" stubbed="0" >g_strOutdialFlag match "T"</result>
          </results>
        </action>
        <action id="56" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1307 y=244 ?>
          <!--"MSOutdialParty"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;MSOutdialParty&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oCallLegB</parameter>
            <parameter >g_oMS</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="83" stubbed="1"/>
            <result name="SUCCESS" link="42" stubbed="1" >f_nReturnCode == s_nSuccess</result>
            <result name="CALLER HUNGUP" link="39" stubbed="1" >f_nReturnCode == s_nCallerHungup</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (1 == Result.id)
{
	Server.logError("FAIL TO OUTDIAL PARTY TO MS.");
	Session.g_nTerminationReason = 34;
}
else if (3 == Result.id)
{
	Server.logInfo("CALLER HUNGUP");
	Session.g_nTerminationReason = 1;
}]]></script>
          </scripts>
        </action>
        <action id="59" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=327 y=131 ?>
          <!--stop timers-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;StopTimer&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="4" stubbed="0"/>
          </results>
        </action>
        <action id="60" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1252 y=724 ?>
          <!--play hold?-->
          <results >
            <result name="Default" link="25" stubbed="0"/>
            <result name="f_bPlayPleaseHold == true" link="61" stubbed="0" >f_bPlayPleaseHold == true</result>
          </results>
        </action>
        <action id="61" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1509 y=898 ?>
          <!--please hold-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >898</audio>
          </play>
          <results >
            <result name="Default" link="25" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_bPlayPleaseHold = false;]]></script>
          </scripts>
        </action>
        <action id="62" plug-in="Pactolus.Sleep.1" ><?xtml-editor x=2485 y=1323 ?>
          <!--1 sec-->
          <sleep xmlns="urn:www.pactolus.com:xtml:application" duration="1"/>
          <results >
            <result name="Default" link="1" stubbed="1"/>
          </results>
        </action>
        <action id="63" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=838 y=1953 ?>
          <!--message number 1021-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >365</audio>
            <audio type="number" >g_nErrorMsgNumber</audio>
          </play>
          <results >
            <result name="Default" link="22" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="67" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1016 y=2220 ?>
          <!--AddMemberToMainConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
            <parameter >g_oCallLegA</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="71" stubbed="0"/>
            <result name="SUCCESS" link="80" stubbed="0" >f_nReturnCode == s_nSuccess</result>
          </results>
        </action>
        <action id="68" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1011 y=2509 ?>
          <!--AddMemberToMainConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
            <parameter >g_oCallLegB</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="73" stubbed="0"/>
            <result name="SUCCESS" link="80" stubbed="1" >f_nReturnCode == s_nSuccess</result>
          </results>
        </action>
        <action id="69" plug-in="Pactolus.Branch.1" ><?xtml-editor x=784 y=2318 ?>
          <!--Dial In?-->
          <results >
            <result name="Default" link="67" stubbed="0"/>
            <result name="g_strOutdialFlag = &quot;T&quot;;" link="68" stubbed="0" >g_strOutdialFlag match "T"</result>
          </results>
        </action>
        <action id="70" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=523 y=2328 ?>
          <!--Remove member from temp conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;RemoveMemberFromConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
          </function>
          <results >
            <result name="Default" link="69" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: SIDEBAR OPERATOR REQUEST, CSR ADD CALLER BACK TO MAIN CONFERENCE, REMOVE MEMBER FROM TEMP CONFERENCE.");]]></script>
          </scripts>
        </action>
        <action id="71" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1195 y=2072 ?>
          <!--AddMemberToTempConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
            <parameter >g_oCallLegA</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="81" stubbed="0"/>
            <result name="SUCCESS" link="74" stubbed="0" >f_nReturnCode == s_nSuccess</result>
          </results>
        </action>
        <action id="73" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1304 y=2504 ?>
          <!--AddMemberToTempConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
            <parameter >g_oCallLegB</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="81" stubbed="1"/>
            <result name="SUCCESS" link="74" stubbed="1" >f_nReturnCode == s_nSuccess</result>
          </results>
        </action>
        <action id="74" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1464 y=2157 ?>
          <!--RESPONSE FAIL-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strACDControllerIP" transaction="strTransactionId" message-name="s_strAddCallerToConfResponse" destination-port="nACDControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;returnCode&quot;" value="s_nFailure"/>
            <parameter tag="&quot;returnMsg&quot;" value="f_strReturnMsg"/>
          </SOAP>
          <results >
            <result name="Default" link="30" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_strReturnMsg = "FAIL TO PUT CALLER IN MAIN CONFERENCE, SO PUT CALLER BACK TO TEMP CONFERENCE";]]></script>
          </scripts>
        </action>
        <action id="75" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1464 y=2336 ?>
          <!--RESPONSE SUCCESS-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strACDControllerIP" transaction="strTransactionId" message-name="s_strAddCallerToConfResponse" destination-port="nACDControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;returnCode&quot;" value="s_nSuccess"/>
            <parameter tag="&quot;returnMsg&quot;" value="f_strReturnMsg"/>
          </SOAP>
          <results >
            <result name="Default" link="30" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_nReturnCode = 0;

Session.f_strReturnMsg = "";

Session.g_bCallerBackInMainConf = true;]]></script>
          </scripts>
        </action>
        <action id="79" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=2126 y=1050 ?>
          <!--RESPONSE FAIL-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strACDControllerIP" transaction="strTransactionId" message-name="s_strAddCallerToConfResponse" destination-port="nACDControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;returnCode&quot;" value="s_nFailure"/>
            <parameter tag="&quot;returnMsg&quot;" value="f_strReturnMsg"/>
          </SOAP>
          <results >
            <result name="Default" link="23" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_strReturnMsg = "FAIL TO TO ADD CALLER TO CONFERENCE";]]></script>
          </scripts>
        </action>
        <action id="80" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1250 y=2345 ?>
          <!--ConfMSConnectionIDChangedNotify-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ConfMSConnectionIDChangedNotify&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="75" stubbed="0"/>
          </results>
        </action>
        <action id="81" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1439 y=2060 ?>
          <!--Hang up caller-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpCaller&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="39" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nConfLeaveReason = 9;
Session.g_strConfLeaveMsg = "FAIL TO ADD PARTY TO CONFERENCE";]]></script>
          </scripts>
        </action>
        <action id="82" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=557 y=237 ?>
          <!--Hang up caller-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpCaller&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="39" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nConfLeaveReason = 4;
Session.g_strConfLeaveMsg = "FAIL TO SEND INVITE PARTY TO HOLD";]]></script>
          </scripts>
        </action>
        <action id="83" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1531 y=116 ?>
          <!--Hang up caller-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpCaller&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="39" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nConfLeaveReason = 16;
Session.g_strConfLeaveMsg = "FAIL TO CONNECT TO MEDIA SERVER";]]></script>
          </scripts>
        </action>
      </actions>
    </function>
    <function name="OnCSREndAssignment" start="194" event="OnCSREndAssignment" returns="void" >
      <parameters >
        <parameter name="strACDControllerIP" type="string" pass="byref"/>
        <parameter name="nACDControllerPort" type="i4" pass="byref"/>
        <parameter name="strTransactionId" type="string" pass="byref"/>
        <parameter name="strAssignmentId" type="string" pass="byref"/>
        <parameter name="lRequestId" type="i8" pass="byref"/>
        <parameter name="lACDUserId" type="i8" pass="byref"/>
        <parameter name="strAssignmentAction" type="string" pass="byref"/>
        <parameter name="strPasscode" type="string" pass="byref"/>
        <parameter name="strPrepaidPin" type="string" pass="byref"/>
        <parameter name="strPostpaidPin" type="string" pass="byref"/>
        <parameter name="strPostpaidAccountNumber" type="string" pass="byref"/>
        <parameter name="strOutdialPhoneNumber" type="string" pass="byref"/>
        <parameter name="nCSRAvailabilityState" type="i4" pass="byref"/>
        <parameter name="strBillableFlag" type="string" pass="byref"/>
        <parameter name="nReleaseToConfStatus" type="i4" pass="byref"/>
        <parameter name="lPartySchedId" type="i8" pass="byref"/>
        <parameter name="strPartyDetail" type="string" pass="byref"/>
        <parameter name="nDefaultAudioMode" type="i4" pass="byref"/>
        <parameter name="strSubConferenceId" type="string" pass="byref"/>
        <parameter name="strRequeueFlag" type="string" pass="byref"/>
      </parameters>
      <local-vars >
        <var name="f_nReturnCode" type="i4" >-1</var>
        <var name="f_nPromptToPlay" type="i4" >99</var>
        <var name="f_sCounter" type="i2" >0</var>
        <var name="f_lCurrentTime" type="i8" >0</var>
        <var name="f_strPongSessionId" type="string" ></var>
        <var name="f_nPassCodeStatus" type="i4" >0</var>
        <var name="f_strReturnMsg" type="string" ></var>
        <var name="f_nValidatePassCode" type="i4" >0</var>
        <var name="f_nWaitForResCounter" type="i4" >0</var>
        <var name="f_bPlayPleaseHold" type="boolean" >0</var>
        <var name="f_strTerminationDigit" type="string" ></var>
        <var name="f_sMaxRetry" type="i2" >0</var>
        <var name="f_strConfControllerIP" type="string" >0</var>
        <var name="f_nConfControllerPort" type="i4" >0</var>
        <var name="f_strTransactionId" type="string" ></var>
      </local-vars>
      <actions >
        <action id="194" plug-in="Pactolus.Branch.1" ><?xtml-editor x=48 y=932 ?>
          <!--sidebar operator request-->
          <results >
            <result name="Default" link="1" stubbed="0"/>
            <result name="SideBarRequestOperator" link="236" stubbed="0" >g_bSideBarOperatorRequest == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: OnCSREndAssignment");
Server.logInfo("Party Schedule ID is: " + Session.lPartySchedId);
Server.logInfo("Party detail is: " + Session.strPartyDetail);
Server.logInfo("Default Audio Mode is: " + Session.nDefaultAudioMode);
Session.g_strPartyDetail = Session.strPartyDetail;
Session.g_strBillableFlag = Session.strBillableFlag;
Session.g_nReleaseToConfStatus = Session.nReleaseToConfStatus;
Session.g_nDefaultAudioMode = Session.nDefaultAudioMode;]]></script>
          </scripts>
        </action>
        <action id="1" plug-in="Pactolus.Branch.1" ><?xtml-editor x=317 y=467 ?>
          <!--what action?-->
          <results >
            <result name="Default" link="153" stubbed="1"/>
            <result name="put back in queue (6)" link="148" stubbed="1" >strAssignmentAction match "6"</result>
            <result name="hangup caller (8)" link="153" stubbed="1" >strAssignmentAction match "8"</result>
            <result name="transfer to supervisor (7)" link="148" stubbed="1" >strAssignmentAction match "7"</result>
            <result name="IVR (9)" link="139" stubbed="0" >strAssignmentAction match "9"</result>
            <result name="bridge to conference (5)" link="140" stubbed="0" >strAssignmentAction match "5"</result>
            <result name="queue request (13)" link="148" stubbed="1" >strAssignmentAction match "13"</result>
            <result name="do nothing (10)" link="136" stubbed="0" >strAssignmentAction match "10"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_disable_event();

Server.logInfo("RECEIVE CSREndAssignment");

Server.logInfo("Assignment Id: " + Session.strAssignmentId);

Server.logInfo("Request Id: " + Session.lRequestId);

Server.logInfo("ACD User Id: " + Session.lACDUserId);

Server.logInfo("Assignment action: " + Session.strAssignmentAction);

Server.logInfo("Conf passcode: " + Session.strPasscode);

if ("6" == Session.strAssignmentAction || "7" == Session.strAssignmentAction || "13" == Session.strAssignmentAction)

{

	Session.g_nCallerCurrentState = Session.s_nStateRequeue;

}]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (1 == Result.id)
	Session.g_nTerminationReason = 43
else if (3 == Result.id)
	Session.g_nTerminationReason = 44;]]></script>
          </scripts>
        </action>
        <action id="4" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1610 y=803 ?>
          <!--Hang up caller-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpCaller&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="5" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nConfLeaveReason = 20;
Session.g_strConfLeaveMsg = "CSR RELEASE HANG UP";]]></script>
          </scripts>
        </action>
        <action id="5" plug-in="Standard.EndSession.1" ><?xtml-editor x=1857 y=799 ?></action>
        <action id="6" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1357 y=805 ?>
          <!--"psAPISceEndRequest"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceEndRequest&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="4" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 2;]]></script>
          </scripts>
        </action>
        <action id="7" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2672 y=723 ?>
          <!--delete temp conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DeleteConference&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
          </function>
          <results >
            <result name="Default" link="108" stubbed="0"/>
          </results>
        </action>
        <action id="8" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2431 y=724 ?>
          <!--Remove member from temp conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;RemoveMemberFromConference&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
          </function>
          <results >
            <result name="Default" link="7" stubbed="0"/>
          </results>
        </action>
        <action id="9" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=3158 y=665 ?>
          <!--"MSOutdialParty"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;MSOutdialParty&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oCallLegA</parameter>
            <parameter >g_oMS</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="4" stubbed="1"/>
            <result name="SUCCESS" link="14" stubbed="0" >f_nReturnCode == s_nSuccess</result>
            <result name="CALLER HUNGUP" link="224" stubbed="0" >f_nReturnCode == s_nCallerHungup</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (1 == Result.id)
	Session.g_nTerminationReason = 34;]]></script>
          </scripts>
        </action>
        <action id="14" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=3400 y=667 ?>
          <!--go to main, get passcode-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;Main&quot;" return="" external-function="0" library="" >
            <parameter >s_nStateGetPasscode</parameter>
          </function>
          <results >
            <result name="Default" link="88" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nCallerCurrentState = Session.s_nStateEndAssignment;

js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="15" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=792 y=1602 ?>
          <!--"psAPISceEndRequest"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceEndRequest&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="19" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 4;]]></script>
          </scripts>
        </action>
        <action id="16" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2232 y=1020 ?>
          <!--authenticate pass code-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceAuthConfPassCode&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="85" stubbed="0"/>
            <result name="0 - Non First Caller" link="24" stubbed="1" >f_nReturnCode == s_nNonFirstCaller</result>
            <result name="1 - First Caller" link="27" stubbed="1" >f_nReturnCode == s_nFirstCaller</result>
            <result name="2 - Wait For Conf Resource" link="41" stubbed="1" >f_nReturnCode == 2</result>
            <result name="-2 - Too early" link="42" stubbed="0" >f_nReturnCode == -2</result>
            <result name="-8 - Passcode inused" link="93" stubbed="0" >f_nReturnCode == -8</result>
            <result name="-11- WFM" link="44" stubbed="1" >f_nReturnCode == s_nWaitForMod</result>
            <result name="-14 - WRONG DAY" link="90" stubbed="0" >f_nReturnCode == -14</result>
            <result name="-18 - CANCELLED" link="91" stubbed="0" >f_nReturnCode == -18</result>
            <result name="-19 - INVALID ACCESS NUMBER" link="192" stubbed="0" >f_nReturnCode == -19</result>
            <result name="3 - Special FirstCaller" link="24" stubbed="1" >f_nReturnCode == 3</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strPassCode = Session.strPasscode;]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Session.g_strConfResource.length <= 0)

{

	Session.g_bNullString = true;

}

else

{

	Session.g_bNullString = false;

}

switch (Session.f_nReturnCode)

{
	case -1:

		Server.logInfo("INFO: INVALID PASSCODE");

		Session.g_nTerminationReason = 2;

		Session.f_strReturnMsg = "INVALID PASSCODE";

		break;

	case -2:

		Server.logInfo("INFO: TOO EARLY PASSCODE");

		Session.f_strReturnMsg = "TOO EARLY PASSCODE";

		Session.g_nTerminationReason = 19;

		Session.f_nPromptToPlay = Session.s_nPromptTooEarly;

		break;

	case -3:

		Server.logInfo("INFO: TOO LATE PASSCODE");

		Session.f_strReturnMsg = "TOO LATE PASSCODE";

		Session.g_nTerminationReason = 20;

		Session.f_nPromptToPlay = Session.s_nPromptTooLate;

		break;

	case -4:

		Server.logInfo("INFO: DISABLE SUBSCRIBER");

		Session.f_strReturnMsg = "DISABLE SUBSCRIBER";

		Session.g_nTerminationReason = 4;

		Session.f_nPromptToPlay = Session.s_nPromptDisableSub;

		break;

	case -5:

		Server.logInfo("INFO: MAX ATTENDEES");

		Session.f_strReturnMsg = "MAX ATTENDEES";

		Session.g_nTerminationReason = 15;

		Session.f_nPromptToPlay = Session.s_nPromptMaxAttendeesReach;

		break;

	case -6:

		Server.logInfo("INFO: CONFERRENCE LOCKED");

		Session.f_strReturnMsg = "CONFERRENCE LOCKED";

		Session.g_nTerminationReason = 16;

		Session.f_nPromptToPlay = Session.s_nPromptConfLocked;

		break;

	case -7:

		Server.logInfo("INFO: CONFERENCE ALREADY ENDED");

		Session.f_strReturnMsg = "CONFERENCE ALREADY ENDED";

		Session.g_nTerminationReason = 2;

		Session.f_nPromptToPlay = Session.s_nPromptConfEnded;

		break;

	case -8:

		Server.logInfo("INFO: PASSCODE INSUED");

		Session.f_strReturnMsg = "PASSCODE INUSED";

		Session.g_nTerminationReason = 21;

		Session.f_nPromptToPlay = 853;

		break;

	case -10:

		Server.logError("ERROR: NO CONFERENCE CONTROLLER");

		Session.f_strReturnMsg = "NO CONFERENCE CONTROLLER";

		Session.g_nTerminationReason = 39;

		Session.f_nPromptToPlay = Session.s_nPromptNoConfController;

		break;

	case -12:

		Server.logError("ERROR: DISABLE CORPORATE ACCOUNT");

		Session.f_strReturnMsg = "DISABLE CORPORATE ACCOUNT";

		Session.g_nTerminationReason = 4;

		Session.f_nPromptToPlay = Session.s_nPromptDisableSub;

		break;

	case -13:

		Server.logInfo("INFO: CONFERENCE DISABLED");

		Session.f_strReturnMsg = "CONFERENCE DISABLED";

		Session.g_nTerminationReason = 29;

		Session.f_nPromptToPlay = 853;

		break;

	case -14:

		Server.logError("ERROR: RECURRING WRONG DAY");

		Session.f_strReturnMsg = "RECURRING WRONG DAY";

		Session.g_nTerminationReason = 26;

		Session.f_nPromptToPlay = 853;

		break;

	case -15:

		Server.logError("ERROR: INSUFFICIENT BALANCE");

		Session.f_strReturnMsg = "INSUFFICIENT BALANCE";

		Session.g_nTerminationReason = 23;

		Session.f_nPromptToPlay = 853;

		break;

	case -16:

		Server.logError("ERROR: PIN LOCKED");

		Session.f_strReturnMsg = "PIN LOCKED";

		Session.g_nTerminationReason = 24;

		Session.f_nPromptToPlay = 853;

		break;

	case -17:

		Server.logError("ERROR: NO RATE");

		Session.f_strReturnMsg = "NO RATE";

		Session.g_nTerminationReason = 46;

		Session.f_nPromptToPlay = 853;

		break;

	case -18:

		Server.logError("ERROR: CONFERENCE CANCELLED");

		Session.f_strReturnMsg = "CONFERENCE CANCELLED";

		Session.g_nTerminationReason = 25;

		Session.f_nPromptToPlay = 853;

		break;

	case -19:

		Server.logInfo("INFO: INVALID ACCESS NUMBER");

		Session.f_strReturnMsg = "INVALID ACCESS NUMBER";

		Session.g_nTerminationReason = 28;

		Session.f_nPromptToPlay = 99;

		break;

	case -20:

		Server.logInfo("INFO: INVALID SUBSCRIBER ACCESS NUMBER");

		Session.g_nErrorMsgNumber = 4016; //conf subscriber invalid access number

		Session.g_nTerminationReason = 28;

		Session.f_nPromptToPlay = 99;

		break;

	case -22:

		Server.logError("ERROR: INSUFFICIENT MS RESOURCE");
		
		Session.g_nErrorMsgNumber = 4018; //insufficient ms resource

		Session.g_nTerminationReason = 30;
		
		Session.f_nPromptToPlay = 99;

		break;
		
	case -98:

		Server.logError("ERROR: DB RESTARTING:" + Session.g_strPassCode);

		Session.f_strReturnMsg = "DB RESTARTING";

		Session.g_nTerminationReason = 39;

		Session.f_nPromptToPlay = Session.s_nPromptSystemUnavailable;

		break;

	case -99:

		Server.logError("ERROR: DB ERROR PASSCODE:" + Session.g_strPassCode);

		Session.f_strReturnMsg = "DB ERROR";

		Session.g_nTerminationReason = 39;

		Session.f_nPromptToPlay = Session.s_nPromptDBError;

		break;

	default:

		Session.g_nTerminationReason = 39;

		Session.f_nPromptToPlay = 305;  //system error
		
		Session.f_strReturnMsg = "GENERAL ERROR";

		break;

}]]></script>
          </scripts>
        </action>
        <action id="19" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=337 y=1892 ?>
          <!--Remove member from temp conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;RemoveMemberFromConference&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
          </function>
          <results >
            <result name="Default" link="20" stubbed="0"/>
          </results>
        </action>
        <action id="20" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=562 y=1898 ?>
          <!--delete temp conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DeleteConference&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
          </function>
          <results >
            <result name="Default" link="193" stubbed="0"/>
          </results>
        </action>
        <action id="23" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1215 y=1864 ?>
          <!--"MSOutdialParty"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;MSOutdialParty&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oCallLegA</parameter>
            <parameter >g_oMS</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="37" stubbed="1"/>
            <result name="SUCCESS" link="132" stubbed="0" >f_nReturnCode == s_nSuccess</result>
            <result name="CALLER HUNGUP" link="225" stubbed="0" >f_nReturnCode == s_nCallerHungup</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (1 == Result.id)

{

	Server.logError("FAIL TO OUTDIAL PARTY TO MS.");

	Session.g_nTerminationReason = 34;

}]]></script>
          </scripts>
        </action>
        <action id="24" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2560 y=1043 ?>
          <!--conferenceResource == null?-->
          <results >
            <result name="Default" link="27" stubbed="0"/>
            <result name="conferenceResource == null" link="37" stubbed="1" >g_bNullString == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (Session.g_strConfResource.length <= 0)
{
	Session.g_bNullString = true;
	Session.g_nErrorMsgNumber = 4014;
	Session.g_strReturnMsg = "NULL CONFERENCE RESOURCE, UNABLE TO ADD PARTY TO THE CONFERENCE";
	if (3 == Session.f_nReturnCode)
		Server.logError("ERROR: THE FIRST CALLER and NO NEED TO GET CONFERENCE ENDPOINT, BUT CONF RESOURCE IS NULL: " + Session.g_strConfResource);
	else
		Server.logError("ERROR: NOT THE FIRST CALLER, BUT CONF RESOURCE IS NULL: " + Session.g_strConfResource);
}
else
{
	Session.g_bNullString = false;
	Session.g_oMS.strConferenceId = Session.g_strConfResource;
}]]></script>
          </scripts>
        </action>
        <action id="25" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=3515 y=1072 ?>
          <!--"RecordCallerName"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;RecordCallerName&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="78" stubbed="0"/>
          </results>
        </action>
        <action id="26" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=3056 y=1036 ?>
          <!--Collect billing code-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;(xxxxxxxxxx|x.T|x.#)&quot;" language="g_strLanguage" digits="g_strBillingCodeNumber" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >943</audio>
          </play>
          <results >
            <result name="Default" link="28" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="27" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2810 y=1038 ?>
          <!--get billing code?-->
          <results >
            <result name="Default" link="25" stubbed="1"/>
            <result name="g_strBillingCodeFlag==T" link="26" stubbed="0" >g_strBillingCodeFlag match "T"</result>
          </results>
        </action>
        <action id="28" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=3277 y=1036 ?>
          <!--set billing code-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceSetBillingCode&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="25" stubbed="0"/>
          </results>
        </action>
        <action id="30" plug-in="Pactolus.Branch.1" ><?xtml-editor x=3481 y=1220 ?>
          <!--first caller?-->
          <results >
            <result name="Default" link="35" stubbed="0"/>
            <result name="g_bFirstCaller==true &amp;&amp; create conf" link="34" stubbed="0" >g_bFirstCaller == true
AND g_bNoCreateConfFirstCaller == false</result>
            <result name="g_bFirstCaller==true &amp;&amp; no create conf" link="35" stubbed="1" >g_bFirstCaller == true
AND g_bNoCreateConfFirstCaller == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("g_strSubConferenceId IS: " + Session.g_strSubConferenceId);
Server.logInfo("strSubConferenceId IS: " + Session.strSubConferenceId);
Server.logInfo("strSubConferenceId.length IS: " + Session.strSubConferenceId.length);
Session.g_strSubConferenceId = Session.strSubConferenceId;

if (Session.strSubConferenceId.length > 0)
{
	Server.logInfo("strSubConferenceId.length IS GREATER THAN ZERO");
	Session.g_bMoveDirectlyInSubConf = true;
}
else
{
	Server.logInfo("strSubConferenceId.length IS LESS THAN ZERO");
	Session.g_bMoveDirectlyInSubConf = false;
}
Server.logInfo("MOVE DIRECTLY TO SUB CONF FLAG IS: " + Session.g_bMoveDirectlyInSubConf);

js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="34" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=3730 y=1309 ?>
          <!--go to main, create conf-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;Main&quot;" return="" external-function="0" library="" >
            <parameter >s_nStateCreateConference</parameter>
          </function>
          <results >
            <result name="Default" link="88" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nCallerCurrentState = Session.s_nStateAddCallerToConf;]]></script>
          </scripts>
        </action>
        <action id="35" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=3716 y=1194 ?>
          <!--go to main, add to conf-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;Main&quot;" return="" external-function="0" library="" >
            <parameter >s_nStateAddToConference</parameter>
          </function>
          <results >
            <result name="Default" link="88" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_oMS.strConferenceId = Session.g_strConfResource;

Session.g_nCallerCurrentState = Session.s_nStateAddCallerToConf;]]></script>
          </scripts>
        </action>
        <action id="37" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=3057 y=1729 ?>
          <!--Hang up caller-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpCaller&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="77" stubbed="0"/>
          </results>
        </action>
        <action id="40" plug-in="Pactolus.Sleep.1" ><?xtml-editor x=3083 y=1437 ?>
          <!--2 secs-->
          <sleep xmlns="urn:www.pactolus.com:xtml:application" duration="2"/>
          <results >
            <result name="Default" link="16" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (Session.f_bPlayPleaseHold == true)

{

	Session.f_bPlayPleaseHold = false;

}

else if(Session.f_bPlayPleaseHold == false)

{

	Session.f_bPlayPleaseHold = true;

}]]></script>
          </scripts>
        </action>
        <action id="41" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2567 y=1484 ?>
          <!--exceed max retry?-->
          <results >
            <result name="Default" link="155" stubbed="0"/>
            <result name="Counter &gt; MaxRetry?" link="92" stubbed="0" >f_nWaitForResCounter &gt; s_nMaxRetryWaitConfRes</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_nWaitForResCounter++;

Session.g_strRetryFlag = "T";]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (2 == Result.id)

{

	Session.g_nTerminationReason = 2;

	Session.g_nErrorMsgNumber = 4012;  //exceed max wait for conf resource

	Server.logError("ERROR: EXCEED MAX WAIT FOR CONFERENCE RESOURCE.");

}]]></script>
          </scripts>
        </action>
        <action id="42" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2620 y=1740 ?>
          <!--TOO EARLY-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >s_nPromptTooEarly</audio>
            <audio type="time" >g_strScheduleStartTime</audio>
            <audio type="index" >873</audio>
          </play>
          <results >
            <result name="Default" link="37" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 19;]]></script>
          </scripts>
        </action>
        <action id="44" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2807 y=2030 ?>
          <!--"RecordCallerName"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;RecordCallerName&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="49" stubbed="0"/>
          </results>
        </action>
        <action id="45" plug-in="Pactolus.JavaStaticMethod.1" ><?xtml-editor x=3264 y=2007 ?>
          <!--"psAPISceConfCleanup"-->
          <java xmlns="urn:www.pactolus.com:xtml:application" class="&quot;com.pactolus.conferencing.psAPISceConfCleanup&quot;" method="&quot;cleanupCallLeg&quot;" timeout="s_nTimeout" return="" method-return-var="f_nReturnCode" method-return-type="0" >
            <parameter type="in" var-type="unknown" >g_strDBNAME</parameter>
            <parameter type="in" var-type="unknown" >g_strExistingCallLegId</parameter>
            <parameter type="in" var-type="unknown" >f_lCurrentTime</parameter>
          </java>
          <results >
            <result name="Default" link="86" stubbed="1"/>
            <result name="Success" link="89" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: ********JAVA CALLING psAPISceConfCleanupCallLeg *********");

Session.f_lCurrentTime = Server.getUTCTime();]]></script>
            <script language="javascript" timing="last" ><![CDATA[Server.logInfo("INFO: ********** iJavaReturnCode " + Session.f_nReturnCode);

if (Result.id == 2)

{

	Server.logInfo("INFO: SUCCESS CALL psAPISceConfCleanupCallLeg.");

}

else

{

	Server.logError("ERROR: FAIL TO CALL psAPISceConfCleanupCallLeg, EXIT ON: " + Result.name);

}]]></script>
          </scripts>
        </action>
        <action id="46" plug-in="Standard.WaitEvent.1" ><?xtml-editor x=3066 y=1885 ?>
          <!--for PONG-->
          <wait xmlns="urn:www.pactolus.com:xtml:communication" timeout="10" recv-name="g_strEventReceived" >
            <msg name="ConferencePong" >
              <parameter >f_nPassCodeStatus</parameter>
            </msg>
          </wait>
          <results >
            <result name="Default" link="45" stubbed="1"/>
            <result name="Success" link="94" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="47" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=2849 y=1886 ?>
          <!--PING to session-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="" transaction="" message-name="&quot;ConferencePing&quot;" destination-port="" destination-type="3" destination-session="g_strExistingSessionId" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;PingSessionId&quot;" value="g_strSessionId"/>
            <parameter tag="&quot;CallLegId&quot;" value="g_strPassCode"/>
          </SOAP>
          <results >
            <result name="Default" link="45" stubbed="1"/>
            <result name="Success" link="46" stubbed="0"/>
            <result name="Error"/>
          </results>
        </action>
        <action id="49" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=3053 y=2022 ?>
          <!--go to main, wait for mod-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;Main&quot;" return="" external-function="0" library="" >
            <parameter >s_nStateWaitForMod</parameter>
          </function>
          <results >
            <result name="Default" link="88" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nCallerCurrentState = Session.s_nStateAddCallerToConf;

Session.g_bWaitForModerator = true;

js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="50" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1076 y=1489 ?>
          <!--"psAPISceEndRequest"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceEndRequest&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="246" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 2;]]></script>
          </scripts>
        </action>
        <action id="51" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1877 y=155 ?>
          <!--Remove member from temp conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;RemoveMemberFromConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
          </function>
          <results >
            <result name="Default" link="187" stubbed="1"/>
            <result name="SUCCESS" link="134" stubbed="0" >f_nReturnCode == s_nSuccess</result>
          </results>
        </action>
        <action id="77" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=3271 y=1721 ?>
          <!--Delete MS Connection-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DeleteMSConnection&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="5" stubbed="1"/>
          </results>
        </action>
        <action id="78" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=3239 y=1225 ?>
          <!--Delete MS Connection-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DeleteMSConnection&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="30" stubbed="0"/>
          </results>
        </action>
        <action id="85" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2436 y=835 ?>
          <!--f_nPromptToPlay-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >f_nPromptToPlay</audio>
          </play>
          <results >
            <result name="Default" link="37" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="86" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2826 y=1726 ?>
          <!--could not be added-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >301</audio>
            <audio type="index" >874</audio>
          </play>
          <results >
            <result name="Default" link="37" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 21;

Session.g_nErrorMsgNumber = 4007;  //passcode in used

Server.logError("ERROR: PASSCODE IN USED.");]]></script>
          </scripts>
        </action>
        <action id="88" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=2336 y=316 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_enable_event();
Session.g_bTalkingWithCSR = false;]]></script>
          </scripts>
        </action>
        <action id="89" plug-in="Pactolus.Branch.1" ><?xtml-editor x=3503 y=1999 ?>
          <!--exceed max retry?-->
          <results >
            <result name="Default" link="154" stubbed="0"/>
            <result name="Counter &gt;= MaxRetry?" link="86" stubbed="1" >f_sCounter &gt;= g_nMaxRetryAllowed</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_sCounter++;

Session.g_strRetryFlag = "T";]]></script>
          </scripts>
        </action>
        <action id="90" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2590 y=2161 ?>
          <!--WRONG DAY-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >948</audio>
          </play>
          <results >
            <result name="Default" link="37" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 26; //wrong day]]></script>
          </scripts>
        </action>
        <action id="91" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2572 y=2319 ?>
          <!--CONF CANCEL-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >949</audio>
          </play>
          <results >
            <result name="Default" link="37" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 25; //conf cancelled]]></script>
          </scripts>
        </action>
        <action id="92" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2838 y=1592 ?>
          <!--could not be add-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >301</audio>
            <audio type="index" >874</audio>
            <audio type="index" >361</audio>
          </play>
          <results >
            <result name="Default" link="37" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 2;

Session.g_nErrorMsgNumber = 4012;  //exceed max wait for conf resource

Server.logError("ERROR: EXCEED MAX WAIT FOR CONFERENCE RESOURCE.")]]></script>
          </scripts>
        </action>
        <action id="93" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2604 y=1887 ?>
          <!--same session-->
          <results >
            <result name="Default" link="47" stubbed="0"/>
            <result name="same session" link="45" stubbed="1" >g_strExistingSessionId match g_strSessionId</result>
          </results>
        </action>
        <action id="94" plug-in="Pactolus.Branch.1" ><?xtml-editor x=3298 y=1884 ?>
          <!--passcode inused?-->
          <results >
            <result name="Default" link="45" stubbed="0"/>
            <result name="passcode inused" link="86" stubbed="1" >f_nPassCodeStatus == s_nPasscodeInUsed</result>
          </results>
        </action>
        <action id="108" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2906 y=711 ?>
          <!--Dial In?-->
          <results >
            <result name="Default" link="9" stubbed="0"/>
            <result name="g_strOutdialFlag = &quot;T&quot;;" link="109" stubbed="0" >g_strOutdialFlag match "T"</result>
          </results>
        </action>
        <action id="109" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=3174 y=809 ?>
          <!--"MSOutdialParty"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;MSOutdialParty&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oCallLegB</parameter>
            <parameter >g_oMS</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="4" stubbed="1"/>
            <result name="SUCCESS" link="14" stubbed="1" >f_nReturnCode == s_nSuccess</result>
            <result name="CALLER HUNGUP" link="224" stubbed="1" >f_nReturnCode == s_nCallerHungup</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (1 == Result.id)
	Session.g_nTerminationReason = 34;]]></script>
          </scripts>
        </action>
        <action id="112" plug-in="Pactolus.Branch.1" ><?xtml-editor x=977 y=1888 ?>
          <!--Dial In?-->
          <results >
            <result name="Default" link="23" stubbed="0"/>
            <result name="g_strOutdialFlag = &quot;T&quot;;" link="113" stubbed="0" >g_strOutdialFlag match "T"</result>
          </results>
        </action>
        <action id="113" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1237 y=2008 ?>
          <!--"MSOutdialParty"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;MSOutdialParty&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oCallLegB</parameter>
            <parameter >g_oMS</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="37" stubbed="1"/>
            <result name="SUCCESS" link="132" stubbed="1" >f_nReturnCode == s_nSuccess</result>
            <result name="CALLER HUNGUP" link="225" stubbed="1" >f_nReturnCode == s_nCallerHungup</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (1 == Result.id)

{

	Server.logError("FAIL TO OUTDIAL PARTY TO MS.");

	Session.g_nTerminationReason = 34;

}]]></script>
          </scripts>
        </action>
        <action id="116" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=825 y=1175 ?>
          <!--authenticate pass code-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceAuthConfPassCode&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="325" stubbed="1"/>
            <result name="0 - Non First Caller" link="245" stubbed="0" >f_nReturnCode == s_nNonFirstCaller</result>
            <result name="1 - First Caller" link="245" stubbed="0" >f_nReturnCode == s_nFirstCaller</result>
            <result name="2 - Wait For Conf Resource" link="245" stubbed="0" >f_nReturnCode == 2</result>
            <result name="-8 - Passcode inused" link="326" stubbed="1" >f_nReturnCode == -8</result>
            <result name="-11- WFM" link="245" stubbed="0" >f_nReturnCode == s_nWaitForMod</result>
            <result name="3 - SpecialFirstCaller" link="245" stubbed="0" >f_nReturnCode == 3</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strPassCode = Session.strPasscode;]]></script>
            <script language="javascript" timing="last" ><![CDATA[Session.f_nValidatePassCode = Session.f_nReturnCode;

if (Session.g_strConfResource.length <= 0)

{

	Session.g_bNullString = true;

}

else

{

	Session.g_bNullString = false;

}

switch (Session.f_nReturnCode)

{
	case -1:

		Server.logInfo("INFO: INVALID PASSCODE");

		Session.g_nTerminationReason = 2;

		Session.f_strReturnMsg = "INVALID PASSCODE";

		break;

	case -2:

		Server.logInfo("INFO: TOO EARLY PASSCODE");

		Session.f_strReturnMsg = "TOO EARLY PASSCODE";

		Session.g_nTerminationReason = 19;

		Session.f_nPromptToPlay = Session.s_nPromptTooEarly;

		break;

	case -3:

		Server.logInfo("INFO: TOO LATE PASSCODE");

		Session.f_strReturnMsg = "TOO LATE PASSCODE";

		Session.g_nTerminationReason = 20;

		Session.f_nPromptToPlay = Session.s_nPromptTooLate;

		break;

	case -4:

		Server.logInfo("INFO: DISABLE SUBSCRIBER");

		Session.f_strReturnMsg = "DISABLE SUBSCRIBER";

		Session.g_nTerminationReason = 4;

		Session.f_nPromptToPlay = Session.s_nPromptDisableSub;

		break;

	case -5:

		Server.logInfo("INFO: MAX ATTENDEES");

		Session.f_strReturnMsg = "MAX ATTENDEES";

		Session.g_nTerminationReason = 15;

		Session.f_nPromptToPlay = Session.s_nPromptMaxAttendeesReach;

		break;

	case -6:

		Server.logInfo("INFO: CONFERRENCE LOCKED");

		Session.f_strReturnMsg = "CONFERRENCE LOCKED";

		Session.g_nTerminationReason = 16;

		Session.f_nPromptToPlay = Session.s_nPromptConfLocked;

		break;

	case -7:

		Server.logInfo("INFO: CONFERENCE ALREADY ENDED");

		Session.f_strReturnMsg = "CONFERENCE ALREADY ENDED";

		Session.g_nTerminationReason = 2;

		Session.f_nPromptToPlay = Session.s_nPromptConfEnded;

		break;

	case -8:

		Server.logInfo("INFO: PASSCODE INSUED");

		Session.f_strReturnMsg = "PASSCODE INUSED";

		Session.g_nTerminationReason = 21;

		Session.f_nPromptToPlay = 853;

		break;

	case -10:

		Server.logError("ERROR: NO CONFERENCE CONTROLLER");

		Session.f_strReturnMsg = "NO CONFERENCE CONTROLLER";

		Session.g_nTerminationReason = 39;

		Session.f_nPromptToPlay = Session.s_nPromptNoConfController;

		break;

	case -12:

		Server.logError("ERROR: DISABLE CORPORATE ACCOUNT");

		Session.f_strReturnMsg = "DISABLE CORPORATE ACCOUNT";

		Session.g_nTerminationReason = 4;

		Session.f_nPromptToPlay = Session.s_nPromptDisableSub;

		break;

	case -13:

		Server.logInfo("INFO: CONFERENCE DISABLED");

		Session.f_strReturnMsg = "CONFERENCE DISABLED";

		Session.g_nTerminationReason = 29;

		Session.f_nPromptToPlay = 853;

		break;

	case -14:

		Server.logError("ERROR: RECURRING WRONG DAY");

		Session.f_strReturnMsg = "RECURRING WRONG DAY";

		Session.g_nTerminationReason = 26;

		Session.f_nPromptToPlay = 853;

		break;

	case -15:

		Server.logError("ERROR: INSUFFICIENT BALANCE");

		Session.f_strReturnMsg = "INSUFFICIENT BALANCE";

		Session.g_nTerminationReason = 23;

		Session.f_nPromptToPlay = 853;

		break;

	case -16:

		Server.logError("ERROR: PIN LOCKED");

		Session.f_strReturnMsg = "PIN LOCKED";

		Session.g_nTerminationReason = 24;

		Session.f_nPromptToPlay = 853;

		break;

	case -17:

		Server.logError("ERROR: NO RATE");

		Session.f_strReturnMsg = "NO RATE";

		Session.g_nTerminationReason = 46;

		Session.f_nPromptToPlay = 853;

		break;

	case -18:

		Server.logError("ERROR: CONFERENCE CANCELLED");

		Session.f_strReturnMsg = "CONFERENCE CANCELLED";

		Session.g_nTerminationReason = 25;

		Session.f_nPromptToPlay = 853;

		break;

	case -19:

		Server.logInfo("INFO: INVALID ACCESS NUMBER");

		Session.f_strReturnMsg = "INVALID ACCESS NUMBER";

		Session.g_nTerminationReason = 28;

		Session.f_nPromptToPlay = 99;

		break;

	case -20:

		Server.logInfo("INFO: INVALID SUBSCRIBER ACCESS NUMBER");

		Session.g_nErrorMsgNumber = 4016; //conf subscriber invalid access number

		Session.g_nTerminationReason = 28;

		Session.f_nPromptToPlay = 99;

		break;

	case -22:

		Server.logError("ERROR: INSUFFICIENT MS RESOURCE");
		
		Session.g_nErrorMsgNumber = 4018; //insufficient ms resource

		Session.g_nTerminationReason = 30;
		
		Session.f_nPromptToPlay = 99;

		break;
		
	case -98:

		Server.logError("ERROR: DB RESTARTING:" + Session.g_strPassCode);

		Session.f_strReturnMsg = "DB RESTARTING";

		Session.g_nTerminationReason = 39;

		Session.f_nPromptToPlay = Session.s_nPromptSystemUnavailable;

		break;

	case -99:

		Server.logError("ERROR: DB ERROR PASSCODE:" + Session.g_strPassCode);

		Session.f_strReturnMsg = "DB ERROR";

		Session.g_nTerminationReason = 39;

		Session.f_nPromptToPlay = Session.s_nPromptDBError;

		break;

	default:

		Session.g_nTerminationReason = 39;

		Session.f_nPromptToPlay = 305;  //system error
		Session.f_strReturnMsg = "GENERAL ERROR";
		break;

}]]></script>
          </scripts>
        </action>
        <action id="117" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1094 y=1131 ?>
          <!--RESPONSE FAIL-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strACDControllerIP" transaction="strTransactionId" message-name="s_strEndAssignmentResponse" destination-port="nACDControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;returnCode&quot;" value="s_nFailure"/>
            <parameter tag="&quot;reason&quot;" value="f_nReturnCode"/>
            <parameter tag="&quot;returnMsg&quot;" value="f_strReturnMsg"/>
          </SOAP>
          <results >
            <result name="Default" link="88" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
        </action>
        <action id="118" plug-in="Standard.WaitEvent.1" ><?xtml-editor x=1312 y=1114 ?>
          <!--for PONG-->
          <wait xmlns="urn:www.pactolus.com:xtml:communication" timeout="10" recv-name="g_strEventReceived" >
            <msg name="ConferencePong" >
              <parameter >f_nPassCodeStatus</parameter>
            </msg>
          </wait>
          <results >
            <result name="Default" link="122" stubbed="1"/>
            <result name="Success" link="121" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="119" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1335 y=1278 ?>
          <!--PING to session-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="" transaction="" message-name="&quot;ConferencePing&quot;" destination-port="" destination-type="3" destination-session="g_strExistingSessionId" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;PingSessionId&quot;" value="g_strSessionId"/>
            <parameter tag="&quot;CallLegId&quot;" value="g_strPassCode"/>
          </SOAP>
          <results >
            <result name="Default" link="122" stubbed="1"/>
            <result name="Success" link="118" stubbed="0"/>
            <result name="Error"/>
          </results>
        </action>
        <action id="120" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1090 y=1279 ?>
          <!--same session-->
          <results >
            <result name="Default" link="119" stubbed="0"/>
            <result name="same session" link="122" stubbed="1" >g_strExistingSessionId match g_strSessionId</result>
          </results>
        </action>
        <action id="121" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1544 y=1113 ?>
          <!--passcode inused?-->
          <results >
            <result name="Default" link="122" stubbed="1"/>
            <result name="passcode inused" link="117" stubbed="1" >f_nPassCodeStatus == s_nPasscodeInUsed</result>
          </results>
        </action>
        <action id="122" plug-in="Pactolus.JavaStaticMethod.1" ><?xtml-editor x=1741 y=1106 ?>
          <!--"psAPISceConfCleanup"-->
          <java xmlns="urn:www.pactolus.com:xtml:application" class="&quot;com.pactolus.conferencing.psAPISceConfCleanup&quot;" method="&quot;cleanupCallLeg&quot;" timeout="s_nTimeout" return="" method-return-var="f_nReturnCode" method-return-type="0" >
            <parameter type="in" var-type="unknown" >g_strDBNAME</parameter>
            <parameter type="in" var-type="unknown" >g_strExistingCallLegId</parameter>
            <parameter type="in" var-type="unknown" >f_lCurrentTime</parameter>
          </java>
          <results >
            <result name="Default" link="117" stubbed="1"/>
            <result name="Success" link="123" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: ********JAVA CALLING psAPISceConfCleanupCallLeg *********");

Session.f_lCurrentTime = Server.getUTCTime();]]></script>
            <script language="javascript" timing="last" ><![CDATA[Server.logInfo("INFO: ********** iJavaReturnCode " + Session.f_nReturnCode);

if (Result.id == 2)

{

	Server.logInfo("INFO: SUCCESS CALL psAPISceConfCleanupCallLeg.");

}

else

{

	Server.logError("ERROR: FAIL TO CALL psAPISceConfCleanupCallLeg, EXIT ON: " + Result.name);

}]]></script>
          </scripts>
        </action>
        <action id="123" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1991 y=1098 ?>
          <!--exceed max retry?-->
          <results >
            <result name="Default" link="116" stubbed="1"/>
            <result name="Counter &gt;= MaxRetry?" link="117" stubbed="1" >f_sCounter &gt;= g_nMaxRetryAllowed</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_sCounter++;

Session.g_strRetryFlag = "T";]]></script>
          </scripts>
        </action>
        <action id="124" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=2318 y=152 ?>
          <!--RESPONSE SUCCESS-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strACDControllerIP" transaction="strTransactionId" message-name="s_strEndAssignmentResponse" destination-port="nACDControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;returnCode&quot;" value="s_nSuccess"/>
            <parameter tag="&quot;reason&quot;" value="f_nReturnCode"/>
            <parameter tag="&quot;returnMsg&quot;" value="f_strReturnMsg"/>
          </SOAP>
          <results >
            <result name="Default" link="88" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_nReturnCode = 0;

Session.f_strReturnMsg = "";

Session.g_lCSRAssignmentId = 0;]]></script>
          </scripts>
        </action>
        <action id="126" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1621 y=626 ?>
          <!--RESPONSE SUCCESS-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strACDControllerIP" transaction="strTransactionId" message-name="s_strEndAssignmentResponse" destination-port="nACDControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;returnCode&quot;" value="s_nSuccess"/>
            <parameter tag="&quot;reason&quot;" value="f_nReturnCode"/>
            <parameter tag="&quot;returnMsg&quot;" value="f_strReturnMsg"/>
          </SOAP>
          <results >
            <result name="Default" link="4" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_nReturnCode = 0;

Session.f_strReturnMsg = "";]]></script>
          </scripts>
        </action>
        <action id="128" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1144 y=964 ?>
          <!--RESPONSE SUCCESS-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strACDControllerIP" transaction="strTransactionId" message-name="s_strEndAssignmentResponse" destination-port="nACDControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;returnCode&quot;" value="s_nSuccess"/>
            <parameter tag="&quot;reason&quot;" value="f_nReturnCode"/>
            <parameter tag="&quot;returnMsg&quot;" value="f_strReturnMsg"/>
          </SOAP>
          <results >
            <result name="Default" link="152" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_nReturnCode = 0;

Session.f_strReturnMsg = "";]]></script>
          </scripts>
        </action>
        <action id="130" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=349 y=1602 ?>
          <!--RESPONSE SUCCESS-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strACDControllerIP" transaction="strTransactionId" message-name="s_strEndAssignmentResponse" destination-port="nACDControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;returnCode&quot;" value="s_nSuccess"/>
            <parameter tag="&quot;reason&quot;" value="f_nReturnCode"/>
            <parameter tag="&quot;returnMsg&quot;" value="f_strReturnMsg"/>
          </SOAP>
          <results >
            <result name="Default" link="135" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_nReturnCode = 0;

Session.f_strReturnMsg = "";]]></script>
          </scripts>
        </action>
        <action id="132" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1455 y=1866 ?>
          <!--validate passcode-->
          <results >
            <result name="Default" link="86" stubbed="1"/>
            <result name="0 - Non First Caller" link="24" stubbed="1" >f_nValidatePassCode == s_nNonFirstCaller</result>
            <result name="1 - First Caller" link="27" stubbed="1" >f_nValidatePassCode == s_nFirstCaller</result>
            <result name="2 - Wait For Conf Resource" link="41" stubbed="1" >f_nValidatePassCode == 2</result>
            <result name="-11 - Wait For Moderator" link="44" stubbed="1" >f_nValidatePassCode == s_nWaitForMod</result>
            <result name="3 - Special FirstCaller" link="24" stubbed="1" >f_nValidatePassCode == 3</result>
          </results>
        </action>
        <action id="133" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1605 y=967 ?>
          <!--"psAPISceEndRequest"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceEndRequest&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="8" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 4;]]></script>
          </scripts>
        </action>
        <action id="134" plug-in="Standard.Timer.1" ><?xtml-editor x=2097 y=153 ?>
          <!--5 secs to connect MOH-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lMOHTimerId" duration="s_nPreMohTime"/>
          <results >
            <result name="Default" link="124" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bMOHTimerFlag = true;]]></script>
          </scripts>
        </action>
        <action id="135" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=557 y=1604 ?>
          <!--"psAPISceEndAssignment"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceEndAssignment&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="15" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_lCSRAssignmentEndTime = Server.getUTCTime();]]></script>
          </scripts>
        </action>
        <action id="136" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=567 y=1492 ?>
          <!--stop timers-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;StopTimer&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="149" stubbed="0"/>
          </results>
        </action>
        <action id="138" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1500 y=1370 ?>
          <!--"SetDTMFOn"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;SetDTMFOn&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="232" stubbed="0"/>
          </results>
        </action>
        <action id="139" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=908 y=965 ?>
          <!--stop timers-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;StopTimer&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="128" stubbed="0"/>
          </results>
        </action>
        <action id="140" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=612 y=1176 ?>
          <!--stop timers-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;StopTimer&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="116" stubbed="0"/>
          </results>
        </action>
        <action id="141" plug-in="Standard.Timer.1" ><?xtml-editor x=2099 y=311 ?>
          <!--set max wait time for CSR-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lWaitCSRTimerId" duration="s_nCsrHoldTime"/>
          <results >
            <result name="Default" link="88" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bWaitCSRTimerSet = true;]]></script>
            <script language="javascript" timing="last" ><![CDATA[js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="143" plug-in="Standard.Timer.1" ><?xtml-editor x=1874 y=314 ?>
          <!--play beep beep every 10 secs-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lBeepBeepTimerId" duration="s_nSleepTime"/>
          <results >
            <result name="Default" link="141" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bBeepBeepTimerFlag = true;]]></script>
          </scripts>
        </action>
        <action id="144" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1050 y=226 ?>
          <!--zero out to CSR-->
          <results >
            <result name="Default" link="145" stubbed="0"/>
            <result name="zero out to CSR, 13" link="242" stubbed="0" >g_bZeroOutToCSR == true

AND strAssignmentAction match "13"</result>
            <result name="zero out to CSR" link="190" stubbed="0" >g_bZeroOutToCSR == true</result>
            <result name="13" link="342" stubbed="0" >strAssignmentAction match "13"</result>
          </results>
        </action>
        <action id="145" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1311 y=115 ?>
          <!--Please hold-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oTempConf.strConnectionId" endpoint="g_oTempConf.strEndPoint" callid="g_oTempConf.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oTempConf.strType" returns="" start-play="1" interrupt="0" return-immediate="1" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >898</audio>
          </play>
          <results >
            <result name="Default" link="188" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nCallerCurrentState = Session.s_nStateRequeue;]]></script>
          </scripts>
        </action>
        <action id="147" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1635 y=317 ?>
          <!--1510: The CSR was disconnected. Please wait...-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="0" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >1510</audio>
          </play>
          <results >
            <result name="Default" link="143" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="148" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=598 y=232 ?>
          <!--stop timers-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;StopTimer&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="150" stubbed="0"/>
          </results>
        </action>
        <action id="149" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=819 y=1491 ?>
          <!--"psAPISceEndAssignment"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceEndAssignment&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="50" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_lCSRAssignmentEndTime = Server.getUTCTime();]]></script>
          </scripts>
        </action>
        <action id="150" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=833 y=230 ?>
          <!--"psAPISceEndAssignment"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceEndAssignment&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="144" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_lCSRAssignmentEndTime = Server.getUTCTime();]]></script>
          </scripts>
        </action>
        <action id="151" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1107 y=810 ?>
          <!--"psAPISceEndAssignment"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceEndAssignment&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="6" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_lCSRAssignmentEndTime = Server.getUTCTime();]]></script>
          </scripts>
        </action>
        <action id="152" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1379 y=969 ?>
          <!--"psAPISceEndAssignment"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceEndAssignment&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="133" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_lCSRAssignmentEndTime = Server.getUTCTime();]]></script>
          </scripts>
        </action>
        <action id="153" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=894 y=809 ?>
          <!--stop timers-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;StopTimer&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="151" stubbed="0"/>
          </results>
        </action>
        <action id="154" plug-in="Pactolus.Sleep.1" ><?xtml-editor x=3713 y=1991 ?>
          <!--1 sec-->
          <sleep xmlns="urn:www.pactolus.com:xtml:application" duration="1"/>
          <results >
            <result name="Default" link="16" stubbed="1"/>
          </results>
        </action>
        <action id="155" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2818 y=1442 ?>
          <!--play hold?-->
          <results >
            <result name="Default" link="40" stubbed="0"/>
            <result name="f_bPlayPleaseHold == true" link="156" stubbed="0" >f_bPlayPleaseHold == true</result>
          </results>
        </action>
        <action id="156" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=3098 y=1570 ?>
          <!--please hold-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >898</audio>
          </play>
          <results >
            <result name="Default" link="40" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_bPlayPleaseHold = false;]]></script>
          </scripts>
        </action>
        <action id="187" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=2114 y=25 ?>
          <!--RESPONSE FAIL-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strACDControllerIP" transaction="strTransactionId" message-name="s_strEndAssignmentResponse" destination-port="nACDControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;returnCode&quot;" value="s_nFailure"/>
            <parameter tag="&quot;reason&quot;" value="s_nFailure"/>
            <parameter tag="&quot;returnMsg&quot;" value="f_strReturnMsg"/>
          </SOAP>
          <results >
            <result name="Default" link="241" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
        </action>
        <action id="188" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1663 y=159 ?>
          <!--"DisconnectFromMOH"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DisconnectFromMOH&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="51" stubbed="0"/>
          </results>
        </action>
        <action id="190" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1396 y=474 ?>
          <!--340: (Beep, Beep)-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="0" return-immediate="1" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >340</audio>
          </play>
          <results >
            <result name="Default" link="143" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="191" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1385 y=629 ?>
          <!--1510: The CSR was disconnected. Please wait...-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oTempConf.strConnectionId" endpoint="g_oTempConf.strEndPoint" callid="g_oTempConf.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oTempConf.strType" returns="" start-play="1" interrupt="0" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >1510</audio>
          </play>
          <results >
            <result name="Default" link="188" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nCallerCurrentState = Session.s_nStateRequeue;]]></script>
          </scripts>
        </action>
        <action id="192" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2557 y=2457 ?>
          <!--message number 1021-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >365</audio>
            <audio type="number" >g_nErrorMsgNumber</audio>
          </play>
          <results >
            <result name="Default" link="37" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="193" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=767 y=1890 ?>
          <!--"DisconnectFromMOH"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DisconnectFromMOH&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="327" stubbed="0"/>
          </results>
        </action>
        <action id="195" plug-in="Pactolus.Branch.1" ><?xtml-editor x=552 y=2241 ?>
          <!--sidebar conference

what action?-->
          <results >
            <result name="Default" link="212" stubbed="1"/>
            <result name="put back in queue (6)" link="221" stubbed="1" >strAssignmentAction match "6"</result>
            <result name="transfer to supervisor (7)" link="221" stubbed="1" >strAssignmentAction match "7"</result>
            <result name="requeue due to csr drop (13)" link="197" stubbed="0" >strAssignmentAction match "13"</result>
            <result name="bridge to conference (5)" link="212" stubbed="1" >strAssignmentAction match "5"</result>
            <result name="do nothing (10)" link="219" stubbed="0" >strAssignmentAction match "10"</result>
            <result name="hangup (8)" link="153" stubbed="1" >strAssignmentAction match "8"</result>
          </results>
        </action>
        <action id="196" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=331 y=2245 ?>
          <!--"psAPISceEndAssignment"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceEndAssignment&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="195" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_disable_event();

Server.logInfo("RECEIVE CSREndAssignment");

Server.logInfo("Assignment Id: " + Session.strAssignmentId);

Server.logInfo("Request Id: " + Session.lRequestId);

Server.logInfo("ACD User Id: " + Session.lACDUserId);

Server.logInfo("Assignment action: " + Session.strAssignmentAction);

Server.logInfo("Conf passcode: " + Session.strPasscode);



Session.g_lCSRAssignmentEndTime = Server.getUTCTime();]]></script>
          </scripts>
        </action>
        <action id="197" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=850 y=2358 ?>
          <!--1510: The CSR was disconnected. Please wait...-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oTempConf.strConnectionId" endpoint="g_oTempConf.strEndPoint" callid="g_oTempConf.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oTempConf.strType" returns="" start-play="1" interrupt="0" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >1510</audio>
          </play>
          <results >
            <result name="Default" link="221" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nCallerCurrentState = Session.s_nStateRequeue;]]></script>
          </scripts>
        </action>
        <action id="199" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1293 y=2164 ?>
          <!--Remove member from temp conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;RemoveMemberFromConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
          </function>
          <results >
            <result name="Default" link="201" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: SIDEBAR OPERATOR REQUEST, END ASSIGNMENT, REMOVE MEMBER FROM TEMP CONFERENCE.");]]></script>
          </scripts>
        </action>
        <action id="200" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1314 y=2278 ?>
          <!--AddMemberToTempConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
            <parameter >g_oCallLegA</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="206" stubbed="0"/>
            <result name="SUCCESS" link="237" stubbed="1" >f_nReturnCode == s_nSuccess</result>
          </results>
        </action>
        <action id="201" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1063 y=2340 ?>
          <!--Dial In?-->
          <results >
            <result name="Default" link="200" stubbed="0"/>
            <result name="g_strOutdialFlag = &quot;T&quot;;" link="202" stubbed="0" >g_strOutdialFlag match "T"</result>
          </results>
        </action>
        <action id="202" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1329 y=2454 ?>
          <!--AddMemberToTempConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
            <parameter >g_oCallLegB</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="206" stubbed="1"/>
            <result name="SUCCESS" link="237" stubbed="1" >f_nReturnCode == s_nSuccess</result>
          </results>
        </action>
        <action id="203" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=2050 y=2447 ?>
          <!--RESPONSE SUCCESS-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strACDControllerIP" transaction="strTransactionId" message-name="s_strEndAssignmentResponse" destination-port="nACDControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;returnCode&quot;" value="s_nSuccess"/>
            <parameter tag="&quot;reason&quot;" value="f_nReturnCode"/>
            <parameter tag="&quot;returnMsg&quot;" value="f_strReturnMsg"/>
          </SOAP>
          <results >
            <result name="Default" link="88" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_nReturnCode = 0;

Session.f_strReturnMsg = "";]]></script>
          </scripts>
        </action>
        <action id="204" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1981 y=2275 ?>
          <!--RESPONSE FAIL-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strACDControllerIP" transaction="strTransactionId" message-name="s_strEndAssignmentResponse" destination-port="nACDControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;returnCode&quot;" value="s_nFailure"/>
            <parameter tag="&quot;reason&quot;" value="f_nReturnCode"/>
            <parameter tag="&quot;returnMsg&quot;" value="f_strReturnMsg"/>
          </SOAP>
          <results >
            <result name="Default" link="207" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "FAIL TO PUT CALLER BACK TO CONFERENCE";]]></script>
          </scripts>
        </action>
        <action id="205" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1770 y=2279 ?>
          <!--Hang up caller-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpCaller&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="204" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nConfLeaveReason = 9;
Session.g_strConfLeaveMsg = "FAIL TO ADD PARTY TO CONFERENCE";]]></script>
          </scripts>
        </action>
        <action id="206" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1559 y=2278 ?>
          <!--Delete temp conf-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DeleteConference&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
          </function>
          <results >
            <result name="Default" link="205" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[Session.g_bCreatedTempConf = false;]]></script>
          </scripts>
        </action>
        <action id="207" plug-in="Standard.EndSession.1" ><?xtml-editor x=2211 y=2272 ?></action>
        <action id="208" plug-in="Standard.Timer.1" ><?xtml-editor x=1578 y=2452 ?>
          <!--play beep beep every 10 secs-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lBeepBeepTimerId" duration="s_nSleepTime"/>
          <results >
            <result name="Default" link="209" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bBeepBeepTimerFlag = true;]]></script>
          </scripts>
        </action>
        <action id="209" plug-in="Standard.Timer.1" ><?xtml-editor x=1824 y=2452 ?>
          <!--set max wait time for CSR-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lWaitCSRTimerId" duration="s_nCsrHoldTime"/>
          <results >
            <result name="Default" link="203" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bWaitCSRTimerSet = true;]]></script>
          </scripts>
        </action>
        <action id="211" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1302 y=2555 ?>
          <!--Remove member from temp conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;RemoveMemberFromConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
          </function>
          <results >
            <result name="Default" link="213" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: SIDEBAR OPERATOR REQUEST, END ASSIGNMENT, REMOVE MEMBER FROM TEMP CONFERENCE.");]]></script>
          </scripts>
        </action>
        <action id="212" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=836 y=2561 ?>
          <!--"psAPISceEndRequest"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceEndRequest&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="211" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 4;]]></script>
          </scripts>
        </action>
        <action id="213" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1547 y=2558 ?>
          <!--Delete temp conf-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DeleteConference&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
          </function>
          <results >
            <result name="Default" link="278" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[Session.g_bCreatedTempConf = false;]]></script>
          </scripts>
        </action>
        <action id="214" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2313 y=2564 ?>
          <!--AddMemberToMainConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
            <parameter >g_oCallLegA</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="205" stubbed="1"/>
            <result name="SUCCESS" link="238" stubbed="0" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[// Server.logInfo("ADD CALLER BACK TO CONF WITH MUTED FIRST");
// Session.g_oMS.bMuteFlag = true;]]></script>
          </scripts>
        </action>
        <action id="215" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2316 y=2787 ?>
          <!--AddMemberToMainConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
            <parameter >g_oCallLegB</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="205" stubbed="1"/>
            <result name="SUCCESS" link="238" stubbed="1" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[// Server.logInfo("ADD CALLER BACK TO CONF WITH MUTED FIRST");
// Session.g_oMS.bMuteFlag = true;]]></script>
          </scripts>
        </action>
        <action id="216" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1789 y=2551 ?>
          <!--Dial In?-->
          <results >
            <result name="Default" link="226" stubbed="0"/>
            <result name="g_strOutdialFlag = &quot;T&quot;;" link="227" stubbed="0" >g_strOutdialFlag match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[// if (true == Session.g_bMuteThisParty || Session.g_strMuteFlag == "T")

if (Session.g_bCurrentlyInSubConf)
{
	if (0 == Session.nDefaultAudioMode)
	{
		Session.g_oSubConfMS.bMuteFlag = false;
		Session.g_oSubConfMS.bDeafFlag = false;
		Session.g_bMutedState = false;
		Session.g_bHoldState = false;
	}
	else if (2 == Session.nDefaultAudioMode)
	{
		Session.g_oSubConfMS.bMuteFlag = true;
		Session.g_oSubConfMS.bDeafFlag = false;
		Session.g_bMutedState = true;
		Session.g_bHoldState = false;
	}
	else if (1 == Session.nDefaultAudioMode)
	{
		Session.g_oSubConfMS.bMuteFlag = true;
		Session.g_oSubConfMS.bDeafFlag = true;
		Session.g_bMutedState = false;
		Session.g_bHoldState = true;
	}
}
else
{
	if (0 == Session.nDefaultAudioMode)
	{
		Session.g_oMS.bMuteFlag = false;
		Session.g_oMS.bDeafFlag = false;
		Session.g_bMutedState = false;
		Session.g_bHoldState = false;
	}
	else if (2 == Session.nDefaultAudioMode)
	{
		Session.g_oMS.bMuteFlag = true;
		Session.g_oMS.bDeafFlag = false;
		Session.g_bMutedState = true;
		Session.g_bHoldState = false;
	}
	else if (1 == Session.nDefaultAudioMode)
	{
		Session.g_oMS.bMuteFlag = true;
		Session.g_oMS.bDeafFlag = true;
		Session.g_bMutedState = false;
		Session.g_bHoldState = true;
	}
}]]></script>
          </scripts>
        </action>
        <action id="217" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=2568 y=2679 ?>
          <!--RESPONSE SUCCESS-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strACDControllerIP" transaction="strTransactionId" message-name="s_strEndAssignmentResponse" destination-port="nACDControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;returnCode&quot;" value="s_nSuccess"/>
            <parameter tag="&quot;reason&quot;" value="f_nReturnCode"/>
            <parameter tag="&quot;returnMsg&quot;" value="f_strReturnMsg"/>
          </SOAP>
          <results >
            <result name="Default" link="274" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_nReturnCode = 0;
Session.f_strReturnMsg = "";
if (Session.g_bEBCRequestPrivateCSR)
{
	Server.logInfo("REQUESTED PRIVATE TALK CSR, GOT RELEASE.  SET g_bEBCRequestPrivateCSR = false");
	Session.g_bEBCRequestPrivateCSR = false;
}]]></script>
          </scripts>
        </action>
        <action id="219" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=822 y=2682 ?>
          <!--"psAPISceEndRequest"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceEndRequest&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="240" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 4;]]></script>
          </scripts>
        </action>
        <action id="220" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1341 y=2681 ?>
          <!--Delete temp conf-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DeleteConference&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
          </function>
          <results >
            <result name="Default" link="244" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[Session.g_bCreatedTempConf = false;]]></script>
          </scripts>
        </action>
        <action id="221" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1064 y=2163 ?>
          <!--caller back in main conference?-->
          <results >
            <result name="Default" link="199" stubbed="0"/>
            <result name="g_bCallerBackInMainConf" link="208" stubbed="1" >g_bCallerBackInMainConf == true</result>
          </results>
        </action>
        <action id="224" plug-in="Pactolus.Branch.1" ><?xtml-editor x=3405 y=760 ?>
          <results >
            <result name="Default" link="5" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 1;

//caller hangup]]></script>
          </scripts>
        </action>
        <action id="225" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1461 y=2029 ?>
          <results >
            <result name="Default" link="77" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 1;

//caller hangup]]></script>
          </scripts>
        </action>
        <action id="226" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2089 y=2568 ?>
          <!--in sub conf?-->
          <results >
            <result name="Default" link="214" stubbed="0"/>
            <result name="g_bCurrentlyInSubConf" link="228" stubbed="0" >g_bCurrentlyInSubConf == true</result>
          </results>
        </action>
        <action id="227" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2093 y=2796 ?>
          <!--in sub conf?-->
          <results >
            <result name="Default" link="215" stubbed="0"/>
            <result name="g_bCurrentlyInSubConf" link="229" stubbed="0" >g_bCurrentlyInSubConf == true</result>
          </results>
        </action>
        <action id="228" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2327 y=2690 ?>
          <!--AddMemberToMainConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oSubConfMS</parameter>
            <parameter >g_oCallLegA</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="205" stubbed="1"/>
            <result name="SUCCESS" link="217" stubbed="0" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[// Server.logInfo("ADD CALLER BACK TO SUB CONF WITH MUTED FIRST");
// Session.g_oSubConfMS.bMuteFlag = true;]]></script>
          </scripts>
        </action>
        <action id="229" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2332 y=2879 ?>
          <!--AddMemberToMainConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oSubConfMS</parameter>
            <parameter >g_oCallLegB</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="205" stubbed="1"/>
            <result name="SUCCESS" link="217" stubbed="1" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[// Server.logInfo("ADD CALLER BACK TO SUB CONF WITH MUTED FIRST");
// Session.g_oSubConfMS.bMuteFlag = true;]]></script>
          </scripts>
        </action>
        <action id="230" plug-in="Standard.Timer.1" ><?xtml-editor x=2234 y=1448 ?>
          <!--ck reInvite timer-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lCkReInviteTimerIdA" duration="g_nCkReInviteTime"/>
          <results >
            <result name="Default" link="243" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bCkReInviteTimerFlagA = true;
Server.logInfo("SET TIMER TO CHECK FOR REINVITE A LEG");]]></script>
          </scripts>
        </action>
        <action id="231" plug-in="Standard.Timer.1" ><?xtml-editor x=2252 y=1564 ?>
          <!--ck reInvite timer B-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lCkReInviteTimerIdB" duration="g_nCkReInviteTime"/>
          <results >
            <result name="Default" link="243" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bCkReInviteTimerFlagB = true;
Server.logInfo("SET TIMER TO CHECK FOR REINVITE B LEG");]]></script>
          </scripts>
        </action>
        <action id="232" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1506 y=1487 ?>
          <results >
            <result name="Default" link="243" stubbed="1"/>
            <result name="Time &gt; 0" link="233" stubbed="0" >g_nCkReInviteTime &gt; 0</result>
          </results>
        </action>
        <action id="233" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1763 y=1481 ?>
          <!--Dial In?-->
          <results >
            <result name="Default" link="234" stubbed="0"/>
            <result name="g_strOutdialFlag = &quot;T&quot;" link="235" stubbed="0" >g_strOutdialFlag match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("END ASSIGNMENT , RESET TIMER TO CHECK FOR REINVITE");]]></script>
          </scripts>
        </action>
        <action id="234" plug-in="Standard.Timer.1" ><?xtml-editor x=2005 y=1448 ?>
          <!--stop ck reInvite timer-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="0" id="g_lCkReInviteTimerIdA" duration=""/>
          <results >
            <result name="Default" link="230" stubbed="0"/>
          </results>
        </action>
        <action id="235" plug-in="Standard.Timer.1" ><?xtml-editor x=2019 y=1565 ?>
          <!--stop ck reInvite timer B-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="0" id="g_lCkReInviteTimerIdB" duration=""/>
          <results >
            <result name="Default" link="231" stubbed="0"/>
          </results>
        </action>
        <action id="236" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=110 y=2246 ?>
          <!--stop timers-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;StopTimer&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="196" stubbed="0"/>
          </results>
        </action>
        <action id="237" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1561 y=2366 ?>
          <!--ConfMSConnectionIDChangedNotify-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ConfMSConnectionIDChangedNotify&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="208" stubbed="1"/>
          </results>
        </action>
        <action id="238" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2553 y=2560 ?>
          <!--ConfMSConnectionIDChangedNotify-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ConfMSConnectionIDChangedNotify&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="217" stubbed="1"/>
          </results>
        </action>
        <action id="240" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1081 y=2684 ?>
          <!--Remove member from temp conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;RemoveMemberFromConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
          </function>
          <results >
            <result name="Default" link="220" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: SIDEBAR OPERATOR REQUEST, END ASSIGNMENT, REMOVE MEMBER FROM TEMP CONFERENCE.");]]></script>
          </scripts>
        </action>
        <action id="241" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2323 y=26 ?>
          <!--Hang up caller-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpCaller&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="5" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 36;
Session.g_nConfLeaveReason = 4;
Session.g_strConfLeaveMsg = "FAIL TO SEND INVITE PARTY TO HOLD";]]></script>
          </scripts>
        </action>
        <action id="242" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1415 y=323 ?>
          <!--RESPONSE SUCCESS-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strACDControllerIP" transaction="strTransactionId" message-name="s_strEndAssignmentResponse" destination-port="nACDControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;returnCode&quot;" value="s_nSuccess"/>
            <parameter tag="&quot;reason&quot;" value="f_nReturnCode"/>
            <parameter tag="&quot;returnMsg&quot;" value="f_strReturnMsg"/>
          </SOAP>
          <results >
            <result name="Default" link="343" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_nReturnCode = 0;

Session.f_strReturnMsg = "";

Session.g_lCSRAssignmentId = 0;]]></script>
          </scripts>
        </action>
        <action id="243" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1996 y=1365 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_enable_event();
Session.g_bTalkingWithCSR = false;
if (Session.g_bEBCRequestCSR)
{
	Server.logInfo("REQUESTED CSR, GOT RELEASE.  SET g_bEBCRequestCSR = false");
	Session.g_bEBCRequestCSR = false;
}]]></script>
          </scripts>
        </action>
        <action id="244" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1563 y=2677 ?>
          <!--RESPONSE SUCCESS-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strACDControllerIP" transaction="strTransactionId" message-name="s_strEndAssignmentResponse" destination-port="nACDControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;returnCode&quot;" value="s_nSuccess"/>
            <parameter tag="&quot;reason&quot;" value="f_nReturnCode"/>
            <parameter tag="&quot;returnMsg&quot;" value="f_strReturnMsg"/>
          </SOAP>
          <results >
            <result name="Default" link="138" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_nReturnCode = 0;

Session.f_strReturnMsg = "";]]></script>
          </scripts>
        </action>
        <action id="245" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=136 y=1605 ?>
          <!--"psAPISceConfSetPartyDetail"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceConfSetPartyDetail&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="130" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_lPartySchedId = Session.lPartySchedId;
Session.g_strPartyDetail = Session.strPartyDetail;]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Session.f_nReturnCode != Session.s_nSuccess)
{
	Server.logError("ERROR: FAIL TO SET PARTY DETAIL, RESET PARTY SCHEDULE ID");
	Session.g_lPartySchedId = Session.lPartySchedId;
	Session.g_strPartyDetail = Session.strPartyDetail;
}]]></script>
          </scripts>
        </action>
        <action id="246" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1299 y=1484 ?>
          <!--speak, mute, moh?-->
          <results >
            <result name="Default" link="138" stubbed="0"/>
            <result name="0 - speak" link="292" stubbed="0" >g_nDefaultAudioMode == 0</result>
            <result name="1 - moh" link="293" stubbed="0" >g_nDefaultAudioMode == 1</result>
            <result name="2 - mute" link="291" stubbed="0" >g_nDefaultAudioMode == 2</result>
          </results>
        </action>
        <action id="249" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1944 y=1818 ?>
          <!--"ChangeToConferenceMode"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ChangeToConferenceMode&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="344" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (2 == Session.nDefaultAudioMode)
{
	Server.logInfo("CHANGE TO MUTE MODE IN MAIN CONF");
	Session.g_oMS.bMuteFlag = true;
	Session.g_oMS.bDeafFlag = false;
	Session.g_bMutedState = true;
	Session.g_bHoldState = false;
}
else if (0 == Session.nDefaultAudioMode)
{
	Server.logInfo("CHANGE TO SPEAK MODE IN MAIN CONF");
	Session.g_oMS.bMuteFlag = false;
	Session.g_oMS.bDeafFlag = false;
	Session.g_bMutedState = false;
	Session.g_bHoldState = false;
}
else
{
	Server.logError("SHOULD NOT GET HERE, MOH EARLIER");
}]]></script>
          </scripts>
        </action>
        <action id="251" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1712 y=1939 ?>
          <!--were muted?-->
          <results >
            <result name="Default" link="249" stubbed="1"/>
            <result name="g_bMutedState" link="254" stubbed="1" >g_bMutedState == true</result>
          </results>
        </action>
        <action id="252" plug-in="Standard.WaitEvent.1" ><?xtml-editor x=1946 y=1658 ?>
          <!--UnmutePartyResponse-->
          <wait xmlns="urn:www.pactolus.com:xtml:communication" timeout="5" recv-name="g_strEventReceived" >
            <msg name="UnmutePartyResponse" >
              <parameter >f_strConfControllerIP</parameter>
              <parameter >f_nConfControllerPort</parameter>
              <parameter >f_strTransactionId</parameter>
              <parameter >f_nReturnCode</parameter>
              <parameter >f_strReturnMsg</parameter>
            </msg>
          </wait>
          <results >
            <result name="Default" link="138" stubbed="1"/>
            <result name="Success" link="253" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_nReturnCode = -1;]]></script>
            <script language="javascript" timing="last" ><![CDATA[js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="253" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2173 y=1660 ?>
          <!--success?-->
          <results >
            <result name="Default" link="138" stubbed="1"/>
            <result name="f_nReturnCode == 0" link="249" stubbed="1" >f_nReturnCode == 0</result>
          </results>
        </action>
        <action id="254" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1731 y=1664 ?>
          <!--UnmutePartyRequest-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="s_strUnmutePartyRequest" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;callerPassCode&quot;" value="g_strCCGeneratedPassCode"/>
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="252" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_disable_event();
Server.logInfo("INFO: **** UNMUTE PARTY REQUEST ****");]]></script>
          </scripts>
        </action>
        <action id="255" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1714 y=2049 ?>
          <!--were unmuted?-->
          <results >
            <result name="Default" link="138" stubbed="1"/>
            <result name="!g_bMutedState" link="258" stubbed="0" >g_bMutedState == false</result>
          </results>
        </action>
        <action id="258" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1959 y=2040 ?>
          <!--MutePartyRequest-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="s_strMutePartyRequest" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;callerPassCode&quot;" value="g_strCCGeneratedPassCode"/>
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="138" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: **** MUTE PARTY REQUEST ****");]]></script>
          </scripts>
        </action>
        <action id="260" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1717 y=2153 ?>
          <!--HoldPartyRequest-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="s_strHoldPartyRequest" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;callerPassCode&quot;" value="g_strCCGeneratedPassCode"/>
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="232" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: **** MUTE PARTY REQUEST ****");]]></script>
          </scripts>
        </action>
        <action id="263" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2621 y=3274 ?>
          <!--were muted?-->
          <results >
            <result name="Default" link="275" stubbed="0"/>
            <result name="g_bMutedState" link="273" stubbed="0" >g_bMutedState == true</result>
          </results>
        </action>
        <action id="264" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2626 y=3461 ?>
          <!--were unmuted?-->
          <results >
            <result name="Default" link="138" stubbed="1"/>
            <result name="!g_bMutedState" link="267" stubbed="0" >g_bMutedState == false</result>
          </results>
        </action>
        <action id="267" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=2863 y=3458 ?>
          <!--MutePartyRequest-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="s_strMutePartyRequest" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;callerPassCode&quot;" value="g_strCCGeneratedPassCode"/>
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="138" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: **** MUTE PARTY REQUEST ****");]]></script>
          </scripts>
        </action>
        <action id="269" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=2451 y=3279 ?>
          <!--HoldPartyRequest-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="s_strHoldPartyRequest" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;callerPassCode&quot;" value="g_strCCGeneratedPassCode"/>
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="243" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: **** MUTE PARTY REQUEST ****");]]></script>
          </scripts>
        </action>
        <action id="270" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=3104 y=3064 ?>
          <!--"ChangeToConferenceMode"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ChangeToConferenceMode&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="346" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (Session.g_oMS.bMuteFlag)
	Session.g_oMS.bMuteFlag = false;]]></script>
          </scripts>
        </action>
        <action id="271" plug-in="Standard.WaitEvent.1" ><?xtml-editor x=3087 y=3331 ?>
          <!--UnmutePartyResponse-->
          <wait xmlns="urn:www.pactolus.com:xtml:communication" timeout="5" recv-name="g_strEventReceived" >
            <msg name="UnmutePartyResponse" >
              <parameter >f_strConfControllerIP</parameter>
              <parameter >f_nConfControllerPort</parameter>
              <parameter >f_strTransactionId</parameter>
              <parameter >f_nReturnCode</parameter>
              <parameter >f_strReturnMsg</parameter>
            </msg>
          </wait>
          <results >
            <result name="Default" link="138" stubbed="1"/>
            <result name="Success" link="272" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_nReturnCode = -1;]]></script>
            <script language="javascript" timing="last" ><![CDATA[js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="272" plug-in="Pactolus.Branch.1" ><?xtml-editor x=3314 y=3333 ?>
          <!--success?-->
          <results >
            <result name="Default" link="138" stubbed="1"/>
            <result name="f_nReturnCode == 0" link="275" stubbed="1" >f_nReturnCode == 0</result>
          </results>
        </action>
        <action id="273" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=2872 y=3337 ?>
          <!--UnmutePartyRequest-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="s_strUnmutePartyRequest" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;callerPassCode&quot;" value="g_strCCGeneratedPassCode"/>
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="271" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_disable_event();
Server.logInfo("INFO: **** UNMUTE PARTY REQUEST ****");]]></script>
          </scripts>
        </action>
        <action id="274" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2771 y=2671 ?>
          <!--speak, mute, moh?-->
          <results >
            <result name="Default" link="138" stubbed="1"/>
            <result name="0 - speak" link="263" stubbed="1" >g_nDefaultAudioMode == 0</result>
            <result name="1 - moh" link="279" stubbed="1" >g_nDefaultAudioMode == 1</result>
            <result name="2 - mute" link="138" stubbed="1" >g_nDefaultAudioMode == 2</result>
          </results>
        </action>
        <action id="275" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2843 y=3120 ?>
          <!--in sub conf?-->
          <results >
            <result name="Default" link="346" stubbed="0"/>
            <result name="g_bCurrentlyInSubConf" link="347" stubbed="0" >g_bCurrentlyInSubConf == true</result>
          </results>
        </action>
        <action id="277" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=3116 y=3252 ?>
          <!--"ChangeToConferenceMode"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ChangeToConferenceMode&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oSubConfMS</parameter>
          </function>
          <results >
            <result name="Default" link="347" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (Session.g_oSubConfMS.bMuteFlag)
	Session.g_oSubConfMS.bMuteFlag = false;]]></script>
          </scripts>
        </action>
        <action id="278" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1813 y=2908 ?>
          <!--speak, mute, moh?-->
          <results >
            <result name="Default" link="216" stubbed="0"/>
            <result name="1 - moh" link="358" stubbed="0" >nDefaultAudioMode == 1</result>
          </results>
        </action>
        <action id="279" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2789 y=3667 ?>
          <!--MOH?-->
          <results >
            <result name="Default" link="287" stubbed="0"/>
            <result name="g_strMusicOnHoldFlag==&quot;T&quot;" link="289" stubbed="0" >g_strMusicOnHoldFlag match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: **** MUTE PARTY REQUEST ****");
Session.f_nCurrentState = Session.s_nStateWait;
Session.g_bDontPlayContinueToHold = true;
Session.g_bHoldState = true;
Session.g_bMutedState = false;]]></script>
          </scripts>
        </action>
        <action id="280" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=3005 y=3659 ?>
          <!--please hold-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >898</audio>
          </play>
          <results >
            <result name="Default" link="281" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="281" plug-in="Standard.Timer.1" ><?xtml-editor x=3243 y=3657 ?>
          <!--play please hold every 10 secs-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lHoldTimerId" duration="s_nSleepTime"/>
          <results >
            <result name="Default" link="243" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bHoldTimerFlag = true;]]></script>
          </scripts>
        </action>
        <action id="283" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=3223 y=3813 ?>
          <!--Remove member from conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;RemoveMemberFromConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oSubConfMS</parameter>
          </function>
          <results >
            <result name="Default" link="284" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: CONF HOLD PARTY REQUEST, REMOVE MEMBER FROM CONFERENCE.");]]></script>
          </scripts>
        </action>
        <action id="284" plug-in="Standard.Timer.1" ><?xtml-editor x=3427 y=3812 ?>
          <!--5 secs to connect MOH-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lMOHTimerId" duration="s_nPreMohTime"/>
          <results >
            <result name="Default" link="243" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bMOHTimerFlag = true;
Session.g_bDtmfCollectionOnHold = true;]]></script>
          </scripts>
        </action>
        <action id="286" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1951 y=1915 ?>
          <!--"ChangeToMutedMode"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ChangeToMutedMode&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="345" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (2 == Session.nDefaultAudioMode)
{
	Server.logInfo("CHANGE TO MUTE MODE IN MAIN CONF");
	Session.g_oMS.bMuteFlag = true;
	Session.g_oMS.bDeafFlag = false;
	Session.g_bMutedState = true;
	Session.g_bHoldState = false;
}
else if (0 == Session.nDefaultAudioMode)
{
	Server.logInfo("CHANGE TO SPEAK MODE IN MAIN CONF");
	Session.g_oMS.bMuteFlag = false;
	Session.g_oMS.bDeafFlag = false;
	Session.g_bMutedState = false;
	Session.g_bHoldState = false;
}
else
{
	Server.logError("SHOULD NOT GET HERE, MOH EARLIER");
}]]></script>
          </scripts>
        </action>
        <action id="287" plug-in="Pactolus.Branch.1" ><?xtml-editor x=3001 y=3549 ?>
          <!--in sub conf?-->
          <results >
            <result name="Default" link="280" stubbed="1"/>
            <result name="g_bCurrentlyInSubConf" link="288" stubbed="0" >g_bCurrentlyInSubConf == true</result>
          </results>
        </action>
        <action id="288" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=3249 y=3505 ?>
          <!--please hold-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oSubConfMS.strConnectionId" endpoint="g_oSubConfMS.strEndPoint" callid="g_oSubConfMS.strCallId" repeat="1" timeout="10" ms-type="g_oSubConfMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >898</audio>
          </play>
          <results >
            <result name="Default" link="281" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="289" plug-in="Pactolus.Branch.1" ><?xtml-editor x=3017 y=3809 ?>
          <!--in sub conf?-->
          <results >
            <result name="Default" link="290" stubbed="1"/>
            <result name="g_bCurrentlyInSubConf" link="283" stubbed="1" >g_bCurrentlyInSubConf == true</result>
          </results>
        </action>
        <action id="290" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=3480 y=3515 ?>
          <!--Remove member from conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;RemoveMemberFromConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="284" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: CONF HOLD PARTY REQUEST, REMOVE MEMBER FROM CONFERENCE.");]]></script>
          </scripts>
        </action>
        <action id="291" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1547 y=1777 ?>
          <results >
            <result name="Default" link="286" stubbed="1"/>
            <result name="currently muted" link="138" stubbed="1" >g_bMutedState == true</result>
            <result name="currently hold" link="324" stubbed="1" >g_bHoldState == true</result>
          </results>
        </action>
        <action id="292" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1544 y=1568 ?>
          <results >
            <result name="Default" link="138" stubbed="1"/>
            <result name="currently muted" link="249" stubbed="1" >g_bMutedState == true</result>
            <result name="currently hold" link="324" stubbed="1" >g_bHoldState == true</result>
          </results>
        </action>
        <action id="293" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1545 y=1672 ?>
          <results >
            <result name="Default" link="279" stubbed="1"/>
            <result name="currently hold" link="232" stubbed="1" >g_bHoldState == true</result>
          </results>
        </action>
        <action id="294" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=970 y=2797 ?>
          <!--"ChangeToConferenceMode"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ChangeToConferenceMode&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="232" stubbed="1"/>
            <result name="SUCCESS" link="138" stubbed="1" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (1 == Result.id)
{
	Session.g_strReturnMsg = "FAILURE TO CHANGE AUDIO MODE, ModifyConferenceMember returns failure.";
}]]></script>
          </scripts>
        </action>
        <action id="295" plug-in="Pactolus.Branch.1" ><?xtml-editor x=277 y=2873 ?>
          <!--MOH?-->
          <results >
            <result name="Default" link="305" stubbed="0"/>
            <result name="g_strMusicOnHoldFlag==&quot;T&quot;" link="296" stubbed="0" >g_strMusicOnHoldFlag match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bDontPlayContinueToHold = true;
Server.logInfo("CURRENTLY ON HOLD");

if (Session.g_bCurrentlyInSubConf)
{
	if (2 == Session.nDefaultAudioMode)
	{
		Server.logInfo("CHANGE TO MUTE MODE IN SUB CONF");
		Session.g_oSubConfMS.bMuteFlag = true;
		Session.g_oSubConfMS.bDeafFlag = false;
		Session.g_bMutedState = true;
		Session.g_bHoldState = false;

	}
	else
	{
		Server.logInfo("CHANGE TO SPEAK MODE IN SUB CONF");
		Session.g_oSubConfMS.bMuteFlag = false;
		Session.g_oSubConfMS.bDeafFlag = false;
		Session.g_bMutedState = false;
		Session.g_bHoldState = false;
	}
}
else if (Session.g_bTalkingWithCSR && Session.g_bSideBarOperatorRequest)
{
	if (2 == Session.nDefaultAudioMode)
	{
		Server.logInfo("CHANGE TO MUTE MODE IN TEMP CONF");
		Session.g_oTempConf.bMuteFlag = true;
		Session.g_oTempConf.bDeafFlag = false;
		Session.g_bMutedState = true;
		Session.g_bHoldState = false;
	}
	else
	{
		Server.logInfo("CHANGE TO SPEAK MODE IN TEMP CONF");
		Session.g_oTempConf.bMuteFlag = false;
		Session.g_oTempConf.bDeafFlag = false;
		Session.g_bMutedState = false;
		Session.g_bHoldState = false;
	}
}
else
{
	if (2 == Session.nDefaultAudioMode)
	{
		Server.logInfo("CHANGE TO MUTE MODE IN MAIN CONF");
		Session.g_oMS.bMuteFlag = true;
		Session.g_oMS.bDeafFlag = false;
		Session.g_bMutedState = true;
		Session.g_bHoldState = false;
	}
	else
	{
		Server.logInfo("CHANGE TO SPEAK MODE IN MAIN CONF");
		Session.g_oMS.bMuteFlag = false;
		Session.g_oMS.bDeafFlag = false;
		Session.g_bMutedState = false;
		Session.g_bHoldState = false;
	}
}]]></script>
          </scripts>
        </action>
        <action id="296" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=499 y=3218 ?>
          <!--"DisconnectFromMOH"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DisconnectFromMOH&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="297" stubbed="0"/>
          </results>
        </action>
        <action id="297" plug-in="Pactolus.Branch.1" ><?xtml-editor x=973 y=3214 ?>
          <!--Dial In?-->
          <results >
            <result name="Default" link="307" stubbed="0"/>
            <result name="g_strOutdialFlag = &quot;T&quot;;" link="308" stubbed="0" >g_strOutdialFlag match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("CURRENTLY IN MUSIC ON HOLD");
if (Session.g_bCurrentlyInSubConf)
{
	if (2 == Session.nToMode)
	{
		Server.logInfo("CHANGE TO MUTE MODE IN SUB CONF");
		Session.g_oSubConfMS.bMuteFlag = true;
		Session.g_oSubConfMS.bDeafFlag = false;
	}
	else
	{
		Server.logInfo("CHANGE TO SPEAK MODE IN SUB CONF");
		Session.g_oSubConfMS.bMuteFlag = false;
		Session.g_oSubConfMS.bDeafFlag = false;
	}
}
else if (Session.g_bTalkingWithCSR && Session.g_bSideBarOperatorRequest)
{
	if (2 == Session.nToMode)
	{
		Server.logInfo("CHANGE TO MUTE MODE IN TEMP CONF");
		Session.g_oTempConf.bMuteFlag = true;
		Session.g_oTempConf.bDeafFlag = false;
	}
	else
	{
		Server.logInfo("CHANGE TO SPEAK MODE IN TEMP CONF");
		Session.g_oTempConf.bMuteFlag = false;
		Session.g_oTempConf.bDeafFlag = false;
	}
}
else
{
	if (2 == Session.nToMode)
	{
		Server.logInfo("CHANGE TO MUTE MODE IN MAIN CONF");
		Session.g_oMS.bMuteFlag = true;
		Session.g_oMS.bDeafFlag = false;
	}
	else
	{
		Server.logInfo("CHANGE TO SPEAK MODE IN MAIN CONF");
		Session.g_oMS.bMuteFlag = false;
		Session.g_oMS.bDeafFlag = false;
	}
}]]></script>
          </scripts>
        </action>
        <action id="298" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1468 y=3022 ?>
          <!--AddMemberToConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
            <parameter >g_oCallLegA</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="317" stubbed="0"/>
            <result name="FAILURE" link="302" stubbed="1" >f_nReturnCode == s_nFailure</result>
            <result name="CALLERHUNGUP" link="301" stubbed="1" >f_nReturnCode == s_nCallerHungup</result>
          </results>
        </action>
        <action id="299" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1480 y=3407 ?>
          <!--AddMemberToConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
            <parameter >g_oCallLegB</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="317" stubbed="1"/>
            <result name="FAILURE" link="302" stubbed="1" >f_nReturnCode == s_nFailure</result>
            <result name="CALLERHUNGUP" link="301" stubbed="1" >f_nReturnCode == s_nCallerHungup</result>
          </results>
        </action>
        <action id="300" plug-in="Standard.EndSession.1" ><?xtml-editor x=1941 y=3149 ?></action>
        <action id="301" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1746 y=3409 ?>
          <!--"PartyLeave"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;PartyLeave&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="300" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nConfLeaveReason = 0;
Session.g_strConfLeaveMsg = "PARTY HANGUP WHILE TRYING TO ADD MEMBER TO CONFERENCE";]]></script>
          </scripts>
        </action>
        <action id="302" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1725 y=3153 ?>
          <!--HangUp Caller-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpCaller&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="300" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 35;
Session.g_nConfLeaveReason = 9;
Session.g_strConfLeaveMsg = "FAIL TO ADD PARTY TO CONFERENCE";]]></script>
          </scripts>
        </action>
        <action id="305" plug-in="Pactolus.Branch.1" ><?xtml-editor x=482 y=2868 ?>
          <!--in sub conf?-->
          <results >
            <result name="Default" link="348" stubbed="0"/>
            <result name="g_bCurrentlyInSubConf" link="350" stubbed="0" >g_bCurrentlyInSubConf == true</result>
            <result name="g_bTalkingToCSR" link="351" stubbed="0" >g_bTalkingWithCSR == true
AND g_bSideBarOperatorRequest == true</result>
          </results>
        </action>
        <action id="307" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1183 y=3019 ?>
          <!--in sub conf?-->
          <results >
            <result name="Default" link="298" stubbed="0"/>
            <result name="g_bCurrentlyInSubConf" link="309" stubbed="0" >g_bCurrentlyInSubConf == true</result>
            <result name="g_bTalkingToCSR" link="318" stubbed="0" >g_bSideBarOperatorRequest == true
AND g_bTalkingWithCSR == true</result>
          </results>
        </action>
        <action id="308" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1199 y=3460 ?>
          <!--in sub conf?-->
          <results >
            <result name="Default" link="299" stubbed="0"/>
            <result name="g_bCurrentlyInSubConf" link="310" stubbed="0" >g_bCurrentlyInSubConf == true</result>
            <result name="g_bTalkingToCSR" link="319" stubbed="0" >g_bSideBarOperatorRequest == true
AND g_bTalkingWithCSR == true</result>
          </results>
        </action>
        <action id="309" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1480 y=3148 ?>
          <!--AddMemberToConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oSubConfMS</parameter>
            <parameter >g_oCallLegA</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="232" stubbed="1"/>
            <result name="FAILURE" link="302" stubbed="1" >f_nReturnCode == s_nFailure</result>
            <result name="CALLERHUNGUP" link="301" stubbed="1" >f_nReturnCode == s_nCallerHungup</result>
          </results>
        </action>
        <action id="310" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1489 y=3517 ?>
          <!--AddMemberToConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oSubConfMS</parameter>
            <parameter >g_oCallLegB</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="232" stubbed="1"/>
            <result name="FAILURE" link="302" stubbed="1" >f_nReturnCode == s_nFailure</result>
            <result name="CALLERHUNGUP" link="301" stubbed="1" >f_nReturnCode == s_nCallerHungup</result>
          </results>
        </action>
        <action id="317" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1675 y=3016 ?>
          <!--ConfMSConnectionIDChangedNotify-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ConfMSConnectionIDChangedNotify&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="138" stubbed="1"/>
          </results>
        </action>
        <action id="318" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1485 y=3281 ?>
          <!--AddMemberToConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
            <parameter >g_oCallLegA</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="232" stubbed="1"/>
            <result name="FAILURE" link="302" stubbed="1" >f_nReturnCode == s_nFailure</result>
            <result name="CALLERHUNGUP" link="301" stubbed="1" >f_nReturnCode == s_nCallerHungup</result>
          </results>
        </action>
        <action id="319" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1511 y=3632 ?>
          <!--AddMemberToConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
            <parameter >g_oCallLegB</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="232" stubbed="1"/>
            <result name="FAILURE" link="302" stubbed="1" >f_nReturnCode == s_nFailure</result>
            <result name="CALLERHUNGUP" link="301" stubbed="1" >f_nReturnCode == s_nCallerHungup</result>
          </results>
        </action>
        <action id="324" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=25 y=2887 ?>
          <!--"StopTimer"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;StopTimer&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="295" stubbed="0"/>
          </results>
        </action>
        <action id="325" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=827 y=1073 ?>
          <!--"psAPISceConfSetPartyDetail"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceConfSetPartyDetail&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="117" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_lPartySchedId = Session.lPartySchedId;]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Session.f_nReturnCode != Session.s_nSuccess)
{
	Server.logError("ERROR: FAIL TO SET PARTY DETAIL, RESET PARTY SCHEDULE ID");
	Session.g_lPartySchedId = Session.lPartySchedId;
	Session.g_strPartyDetail = Session.strPartyDetail;
}]]></script>
          </scripts>
        </action>
        <action id="326" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=825 y=1374 ?>
          <!--"psAPISceConfSetPartyDetail"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceConfSetPartyDetail&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="120" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_lPartySchedId = Session.lPartySchedId;]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Session.f_nReturnCode != Session.s_nSuccess)
{
	Server.logError("ERROR: FAIL TO SET PARTY DETAIL, RESET PARTY SCHEDULE ID");
	Session.g_lPartySchedId = Session.lPartySchedId;
	Session.g_strPartyDetail = Session.strPartyDetail;
}]]></script>
          </scripts>
        </action>
        <action id="327" plug-in="Pactolus.Branch.1" ><?xtml-editor x=981 y=1985 ?>
          <!--validate passcode-->
          <results >
            <result name="Default" link="112" stubbed="1"/>
            <result name="0 - Non First Caller" link="328" stubbed="1" >f_nValidatePassCode == s_nNonFirstCaller</result>
            <result name="1 - First Caller" link="329" stubbed="1" >f_nValidatePassCode == s_nFirstCaller</result>
            <result name="3 - Special FirstCaller" link="328" stubbed="0" >f_nValidatePassCode == 3</result>
          </results>
        </action>
        <action id="328" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2816 y=2156 ?>
          <!--conferenceResource == null?-->
          <results >
            <result name="Default" link="329" stubbed="0"/>
            <result name="conferenceResource == null" link="330" stubbed="0" >g_bNullString == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (Session.g_strConfResource.length <= 0)
{
	Session.g_bNullString = true;
	Session.g_nErrorMsgNumber = 4014;
	Session.g_nTerminationReason = 39;
	Session.g_strReturnMsg = "NULL CONFERENCE RESOURCE, UNABLE TO ADD PARTY TO THE CONFERENCE";
	if (3 == Session.f_nReturnCode)
		Server.logError("ERROR: THE FIRST CALLER and NO NEED TO GET CONFERENCE ENDPOINT, BUT CONF RESOURCE IS NULL: " + Session.g_strConfResource);
	else
		Server.logError("ERROR: NOT THE FIRST CALLER, BUT CONF RESOURCE IS NULL: " + Session.g_strConfResource);
}
else
{
	Session.g_bNullString = false;
	Session.g_oMS.strConferenceId = Session.g_strConfResource;
}]]></script>
          </scripts>
        </action>
        <action id="329" plug-in="Pactolus.Branch.1" ><?xtml-editor x=3062 y=2155 ?>
          <!--get billing code?-->
          <results >
            <result name="Default" link="335" stubbed="0"/>
            <result name="g_strBillingCodeFlag==T" link="336" stubbed="0" >g_strBillingCodeFlag match "T"</result>
          </results>
        </action>
        <action id="330" plug-in="Pactolus.Branch.1" ><?xtml-editor x=3071 y=2608 ?>
          <!--Dial In?-->
          <results >
            <result name="Default" link="333" stubbed="0"/>
            <result name="g_strOutdialFlag = &quot;T&quot;;" link="331" stubbed="0" >g_strOutdialFlag match "T"</result>
          </results>
        </action>
        <action id="331" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=3321 y=2721 ?>
          <!--"MSOutdialParty"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;MSOutdialParty&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oCallLegB</parameter>
            <parameter >g_oMS</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="37" stubbed="1"/>
            <result name="SUCCESS" link="86" stubbed="1" >f_nReturnCode == s_nSuccess</result>
            <result name="CALLER HUNGUP" link="334" stubbed="1" >f_nReturnCode == s_nCallerHungup</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (1 == Result.id)

{

	Server.logError("FAIL TO OUTDIAL PARTY TO MS.");

	Session.g_nTerminationReason = 34;

}]]></script>
          </scripts>
        </action>
        <action id="333" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=3309 y=2584 ?>
          <!--"MSOutdialParty"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;MSOutdialParty&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oCallLegA</parameter>
            <parameter >g_oMS</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="37" stubbed="1"/>
            <result name="SUCCESS" link="86" stubbed="1" >f_nReturnCode == s_nSuccess</result>
            <result name="CALLER HUNGUP" link="334" stubbed="0" >f_nReturnCode == s_nCallerHungup</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (1 == Result.id)

{

	Server.logError("FAIL TO OUTDIAL PARTY TO MS.");

	Session.g_nTerminationReason = 34;

}]]></script>
          </scripts>
        </action>
        <action id="334" plug-in="Pactolus.Branch.1" ><?xtml-editor x=3547 y=2578 ?>
          <results >
            <result name="Default" link="77" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 1;

//caller hangup]]></script>
          </scripts>
        </action>
        <action id="335" plug-in="Pactolus.Branch.1" ><?xtml-editor x=3293 y=2152 ?>
          <!--record name?-->
          <results >
            <result name="Default" link="30" stubbed="1"/>
            <result name="RecordNameFlag==&quot;T&quot;" link="339" stubbed="0" >g_strRecordNamesFlag match "T"</result>
          </results>
        </action>
        <action id="336" plug-in="Pactolus.Branch.1" ><?xtml-editor x=3303 y=2357 ?>
          <!--Dial In?-->
          <results >
            <result name="Default" link="338" stubbed="0"/>
            <result name="g_strOutdialFlag = &quot;T&quot;;" link="337" stubbed="0" >g_strOutdialFlag match "T"</result>
          </results>
        </action>
        <action id="337" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=3553 y=2470 ?>
          <!--"MSOutdialParty"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;MSOutdialParty&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oCallLegB</parameter>
            <parameter >g_oMS</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="37" stubbed="1"/>
            <result name="SUCCESS" link="28" stubbed="1" >f_nReturnCode == s_nSuccess</result>
            <result name="CALLER HUNGUP" link="334" stubbed="1" >f_nReturnCode == s_nCallerHungup</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (1 == Result.id)

{

	Server.logError("FAIL TO OUTDIAL PARTY TO MS.");

	Session.g_nTerminationReason = 34;

}]]></script>
          </scripts>
        </action>
        <action id="338" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=3541 y=2333 ?>
          <!--"MSOutdialParty"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;MSOutdialParty&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oCallLegA</parameter>
            <parameter >g_oMS</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="37" stubbed="1"/>
            <result name="SUCCESS" >f_nReturnCode == s_nSuccess</result>
            <result name="CALLER HUNGUP" link="334" stubbed="1" >f_nReturnCode == s_nCallerHungup</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (1 == Result.id)

{

	Server.logError("FAIL TO OUTDIAL PARTY TO MS.");

	Session.g_nTerminationReason = 34;

}]]></script>
          </scripts>
        </action>
        <action id="339" plug-in="Pactolus.Branch.1" ><?xtml-editor x=3529 y=2148 ?>
          <!--Dial In?-->
          <results >
            <result name="Default" link="341" stubbed="0"/>
            <result name="g_strOutdialFlag = &quot;T&quot;;" link="340" stubbed="0" >g_strOutdialFlag match "T"</result>
          </results>
        </action>
        <action id="340" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=3779 y=2261 ?>
          <!--"MSOutdialParty"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;MSOutdialParty&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oCallLegB</parameter>
            <parameter >g_oMS</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="37" stubbed="1"/>
            <result name="SUCCESS" link="25" stubbed="1" >f_nReturnCode == s_nSuccess</result>
            <result name="CALLER HUNGUP" link="334" stubbed="1" >f_nReturnCode == s_nCallerHungup</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (1 == Result.id)

{

	Server.logError("FAIL TO OUTDIAL PARTY TO MS.");

	Session.g_nTerminationReason = 34;

}]]></script>
          </scripts>
        </action>
        <action id="341" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=3767 y=2124 ?>
          <!--"MSOutdialParty"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;MSOutdialParty&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oCallLegA</parameter>
            <parameter >g_oMS</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="37" stubbed="1"/>
            <result name="SUCCESS" link="25" stubbed="1" >f_nReturnCode == s_nSuccess</result>
            <result name="CALLER HUNGUP" link="334" stubbed="1" >f_nReturnCode == s_nCallerHungup</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (1 == Result.id)

{

	Server.logError("FAIL TO OUTDIAL PARTY TO MS.");

	Session.g_nTerminationReason = 34;

}]]></script>
          </scripts>
        </action>
        <action id="342" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1042 y=655 ?>
          <results >
            <result name="Default" link="191" stubbed="0"/>
            <result name="RequeueFlag == T" link="188" stubbed="1" >strRequeueFlag match "T"</result>
          </results>
        </action>
        <action id="343" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1642 y=461 ?>
          <results >
            <result name="Default" link="147" stubbed="1"/>
            <result name="RequeueFlag == T" link="188" stubbed="1" >strRequeueFlag match "T"</result>
          </results>
        </action>
        <action id="344" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2184 y=1812 ?>
          <results >
            <result name="Default" link="138" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "SUCCESSFUL UNMUTE A PARTY";
Session.g_nPromptSelfMuteUnMute = 907;
Session.g_bMutedState = false;
Session.g_bHoldState = false;]]></script>
          </scripts>
        </action>
        <action id="345" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2190 y=1921 ?>
          <results >
            <result name="Default" link="138" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "SUCCESSFUL UNMUTE A PARTY";
Session.g_nPromptSelfMuteUnMute = 908;
Session.g_bMutedState = true;
Session.g_bHoldState = false;]]></script>
          </scripts>
        </action>
        <action id="346" plug-in="Pactolus.Branch.1" ><?xtml-editor x=3331 y=3114 ?>
          <results >
            <result name="Default" link="138" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "SUCCESSFUL UNMUTE A PARTY";
Session.g_nPromptSelfMuteUnMute = 907;
Session.g_bMutedState = false;]]></script>
          </scripts>
        </action>
        <action id="347" plug-in="Pactolus.Branch.1" ><?xtml-editor x=3342 y=3248 ?>
          <results >
            <result name="Default" link="138" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "SUCCESSFUL UNMUTE A PARTY";
Session.g_nPromptSelfMuteUnMute = 907;
Session.g_bMutedState = false;]]></script>
          </scripts>
        </action>
        <action id="348" plug-in="Pactolus.Branch.1" ><?xtml-editor x=717 y=2809 ?>
          <!--mute?-->
          <results >
            <result name="Default" link="294" stubbed="0"/>
            <result name="2 == default audio mode?" link="349" stubbed="0" >nDefaultAudioMode == 2</result>
          </results>
        </action>
        <action id="349" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=983 y=2916 ?>
          <!--"ChangeToMutedMode"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ChangeToMutedMode&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="232" stubbed="1"/>
            <result name="SUCCESS" link="138" stubbed="1" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (1 == Result.id)
{
	Session.g_strReturnMsg = "FAILURE TO CHANGE AUDIO MODE, ModifyConferenceMember returns failure.";
}]]></script>
          </scripts>
        </action>
        <action id="350" plug-in="Pactolus.Branch.1" ><?xtml-editor x=733 y=2935 ?>
          <!--mute?-->
          <results >
            <result name="Default" link="352" stubbed="0"/>
            <result name="2 == default audio mode?" link="353" stubbed="0" >nDefaultAudioMode == 2</result>
          </results>
        </action>
        <action id="351" plug-in="Pactolus.Branch.1" ><?xtml-editor x=727 y=3343 ?>
          <!--mute?-->
          <results >
            <result name="Default" link="354" stubbed="0"/>
            <result name="2 == default audio mode?" link="355" stubbed="0" >nDefaultAudioMode == 2</result>
          </results>
        </action>
        <action id="352" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=972 y=3010 ?>
          <!--"ChangeToConferenceMode"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ChangeToConferenceMode&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oSubConfMS</parameter>
          </function>
          <results >
            <result name="Default" link="232" stubbed="1"/>
            <result name="SUCCESS" link="138" stubbed="1" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (1 == Result.id)
{
	Session.g_strReturnMsg = "FAILURE TO CHANGE AUDIO MODE, ModifyConferenceMember returns failure.";
}]]></script>
          </scripts>
        </action>
        <action id="353" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=978 y=3112 ?>
          <!--"ChangeToMutedMode"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ChangeToMutedMode&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oSubConfMS</parameter>
          </function>
          <results >
            <result name="Default" link="232" stubbed="1"/>
            <result name="SUCCESS" link="138" stubbed="1" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (1 == Result.id)
{
	Session.g_strReturnMsg = "FAILURE TO CHANGE AUDIO MODE, ModifyConferenceMember returns failure.";
}]]></script>
          </scripts>
        </action>
        <action id="354" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=975 y=3321 ?>
          <!--"ChangeToConferenceMode"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ChangeToConferenceMode&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
          </function>
          <results >
            <result name="Default" link="232" stubbed="1"/>
            <result name="SUCCESS" link="138" stubbed="1" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (1 == Result.id)
{
	Session.g_strReturnMsg = "FAILURE TO CHANGE AUDIO MODE, ModifyConferenceMember returns failure.";
}]]></script>
          </scripts>
        </action>
        <action id="355" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=981 y=3423 ?>
          <!--"ChangeToMutedMode"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ChangeToMutedMode&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
          </function>
          <results >
            <result name="Default" link="232" stubbed="1"/>
            <result name="SUCCESS" link="138" stubbed="1" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (1 == Result.id)
{
	Session.g_strReturnMsg = "FAILURE TO CHANGE AUDIO MODE, ModifyConferenceMember returns failure.";
}]]></script>
          </scripts>
        </action>
        <action id="357" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=2337 y=3004 ?>
          <!--RESPONSE SUCCESS-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strACDControllerIP" transaction="strTransactionId" message-name="s_strEndAssignmentResponse" destination-port="nACDControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;returnCode&quot;" value="s_nSuccess"/>
            <parameter tag="&quot;reason&quot;" value="f_nReturnCode"/>
            <parameter tag="&quot;returnMsg&quot;" value="f_strReturnMsg"/>
          </SOAP>
          <results >
            <result name="Default" link="279" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_nReturnCode = 0;
Session.f_strReturnMsg = "";
if (Session.g_bEBCRequestPrivateCSR)
{
	Server.logInfo("REQUESTED PRIVATE TALK CSR, GOT RELEASE.  SET g_bEBCRequestPrivateCSR = false");
	Session.g_bEBCRequestPrivateCSR = false;
}
// if (true == Session.g_bMuteThisParty || Session.g_strMuteFlag == "T")

if (Session.g_bCurrentlyInSubConf)
{
	if (0 == Session.nDefaultAudioMode)
	{
		Session.g_oSubConfMS.bMuteFlag = false;
		Session.g_oSubConfMS.bDeafFlag = false;
		Session.g_bMutedState = false;
		Session.g_bHoldState = false;
	}
	else if (2 == Session.nDefaultAudioMode)
	{
		Session.g_oSubConfMS.bMuteFlag = true;
		Session.g_oSubConfMS.bDeafFlag = false;
		Session.g_bMutedState = true;
		Session.g_bHoldState = false;
	}
	else if (1 == Session.nDefaultAudioMode)
	{
		Session.g_oSubConfMS.bMuteFlag = true;
		Session.g_oSubConfMS.bDeafFlag = true;
		Session.g_bMutedState = false;
		Session.g_bHoldState = true;
	}
}
else
{
	if (0 == Session.nDefaultAudioMode)
	{
		Session.g_oMS.bMuteFlag = false;
		Session.g_oMS.bDeafFlag = false;
		Session.g_bMutedState = false;
		Session.g_bHoldState = false;
	}
	else if (2 == Session.nDefaultAudioMode)
	{
		Session.g_oMS.bMuteFlag = true;
		Session.g_oMS.bDeafFlag = false;
		Session.g_bMutedState = true;
		Session.g_bHoldState = false;
	}
	else if (1 == Session.nDefaultAudioMode)
	{
		Session.g_oMS.bMuteFlag = true;
		Session.g_oMS.bDeafFlag = true;
		Session.g_bMutedState = false;
		Session.g_bHoldState = true;
	}
}]]></script>
          </scripts>
        </action>
        <action id="358" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2058 y=2912 ?>
          <!--MOH?-->
          <results >
            <result name="Default" link="216" stubbed="1"/>
            <result name="g_strMusicOnHoldFlag==&quot;T&quot;" link="357" stubbed="1" >g_strMusicOnHoldFlag match "T"</result>
          </results>
        </action>
      </actions>
    </function>
    <function name="OnCSRPutCallerOnHold" start="14" event="OnCSRPutCallerOnHold" returns="void" >
      <parameters >
        <parameter name="strACDControllerIP" type="string" pass="byref"/>
        <parameter name="nACDControllerPort" type="i4" pass="byref"/>
        <parameter name="strTransactionId" type="string" pass="byref"/>
      </parameters>
      <local-vars >
        <var name="f_nReturnCode" type="i4" >-1</var>
      </local-vars>
      <actions >
        <action id="14" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=168 y=340 ?>
          <!--"setDTMFOff"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;setDTMFOff&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="12" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: OnCSRPutCallerOnHold");]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.Timer.1" ><?xtml-editor x=1224 y=138 ?>
          <!--play please hold every 10 secs-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lHoldTimerId" duration="s_nSleepTime"/>
          <results >
            <result name="Default" link="3" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bHoldTimerFlag = true;]]></script>
          </scripts>
        </action>
        <action id="3" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1452 y=137 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="4" plug-in="Pactolus.Branch.1" ><?xtml-editor x=676 y=100 ?>
          <!--Temp Conf?-->
          <results >
            <result name="Default" link="6" stubbed="0"/>
            <result name="InTempConf==true" link="7" stubbed="0" >g_oTempConf.bCurrentlyInConf == true</result>
            <result name="InSubConf==true" link="19" stubbed="0" >g_bCurrentlyInSubConf == true</result>
          </results>
        </action>
        <action id="6" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=921 y=16 ?>
          <!--please hold for CSR-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >898</audio>
          </play>
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="7" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=936 y=198 ?>
          <!--please hold for CSR-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oTempConf.strConnectionId" endpoint="g_oTempConf.strEndPoint" callid="g_oTempConf.strCallId" repeat="1" timeout="10" ms-type="g_oTempConf.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >898</audio>
          </play>
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="11" plug-in="Standard.Timer.1" ><?xtml-editor x=1154 y=514 ?>
          <!--5 secs to connect MOH-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lMOHTimerId" duration="s_nPreMohTime"/>
          <results >
            <result name="Default" link="3" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bMOHTimerFlag = true;]]></script>
          </scripts>
        </action>
        <action id="12" plug-in="Pactolus.Branch.1" ><?xtml-editor x=419 y=335 ?>
          <!--MOH?-->
          <results >
            <result name="Default" link="4" stubbed="0"/>
            <result name="g_strMusicOnHoldFlag==&quot;T&quot;" link="17" stubbed="0" >g_strMusicOnHoldFlag match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nCallerCurrentState = Session.s_nStateCsrPutOnHold;

if (true == Session.g_oTempConf.bCurrentlyInConf)

	Session.g_bOnHoldFromTConf = true;

	

js_disable_event();]]></script>
          </scripts>
        </action>
        <action id="16" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=925 y=522 ?>
          <!--Remove member from conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;RemoveMemberFromConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
          </function>
          <results >
            <result name="Default" link="11" stubbed="0"/>
          </results>
        </action>
        <action id="17" plug-in="Pactolus.Branch.1" ><?xtml-editor x=691 y=527 ?>
          <!--in sub conf?-->
          <results >
            <result name="Default" link="16" stubbed="0"/>
            <result name="g_bCurrentlyInSubConf" link="18" stubbed="0" >g_bCurrentlyInSubConf == true</result>
          </results>
        </action>
        <action id="18" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=938 y=642 ?>
          <!--Remove member from conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;RemoveMemberFromConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oSubConfMS</parameter>
          </function>
          <results >
            <result name="Default" link="11" stubbed="1"/>
          </results>
        </action>
        <action id="19" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=941 y=352 ?>
          <!--please hold for CSR-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oSubConfMS.strConnectionId" endpoint="g_oSubConfMS.strEndPoint" callid="g_oSubConfMS.strCallId" repeat="1" timeout="10" ms-type="g_oSubConfMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >898</audio>
          </play>
          <results >
            <result name="Default" link="2" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
      </actions>
    </function>
    <function name="OnCSRCallerOffHold" start="1" event="OnCSRCallerOffHold" returns="void" >
      <parameters >
        <parameter name="strACDControllerIP" type="string" pass="byref"/>
        <parameter name="nACDControllerPort" type="i4" pass="byref"/>
        <parameter name="strTransactionId" type="string" pass="byref"/>
      </parameters>
      <local-vars >
        <var name="f_nReturnCode" type="i4" >-1</var>
      </local-vars>
      <actions >
        <action id="1" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=111 y=252 ?>
          <!--"StopTimer"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;StopTimer&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="4" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: OnCSRCallerOffHold");
js_disable_event();]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=330 y=450 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nCallerCurrentState = Session.s_nStateCsrPutOffHold;

js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="4" plug-in="Pactolus.Branch.1" ><?xtml-editor x=108 y=503 ?>
          <!--MOH?-->
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="g_strMusicOnHoldFlag==&quot;T&quot;" link="12" stubbed="0" >g_strMusicOnHoldFlag match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("RECEIVE CSRCallerOffHold");]]></script>
          </scripts>
        </action>
        <action id="5" plug-in="Pactolus.Branch.1" ><?xtml-editor x=830 y=604 ?>
          <!--Temp Conf?-->
          <results >
            <result name="Default" link="9" stubbed="0"/>
            <result name="OnHoldFromTConf" link="7" stubbed="0" >g_bOnHoldFromTConf == true</result>
            <result name="InSubConf" link="29" stubbed="0" >g_bCurrentlyInSubConf == true</result>
          </results>
        </action>
        <action id="6" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1340 y=963 ?>
          <!--AddMemberToConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
            <parameter >g_oCallLegB</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="33" stubbed="1"/>
            <result name="FAILURE" link="18" stubbed="1" >f_nReturnCode == s_nFailure</result>
            <result name="CALLERHUNGUP" link="27" stubbed="0" >f_nReturnCode == s_nCallerHungup</result>
          </results>
        </action>
        <action id="7" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1076 y=840 ?>
          <!--Dial In?-->
          <results >
            <result name="Default" link="8" stubbed="0"/>
            <result name="g_strOutdialFlag = &quot;T&quot;;" link="6" stubbed="0" >g_strOutdialFlag match "T"</result>
          </results>
        </action>
        <action id="8" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1324 y=775 ?>
          <!--AddMemberToConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
            <parameter >g_oCallLegA</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="33" stubbed="1"/>
            <result name="FAILURE" link="18" stubbed="1" >f_nReturnCode == s_nFailure</result>
            <result name="CALLERHUNGUP" link="27" stubbed="1" >f_nReturnCode == s_nCallerHungup</result>
          </results>
        </action>
        <action id="9" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1061 y=503 ?>
          <!--Dial In?-->
          <results >
            <result name="Default" link="11" stubbed="0"/>
            <result name="g_strOutdialFlag = &quot;T&quot;;" link="10" stubbed="0" >g_strOutdialFlag match "T"</result>
          </results>
        </action>
        <action id="10" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1325 y=626 ?>
          <!--AddMemberToConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
            <parameter >g_oCallLegB</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="33" stubbed="1"/>
            <result name="FAILURE" link="18" stubbed="1" >f_nReturnCode == s_nFailure</result>
            <result name="CALLERHUNGUP" link="27" stubbed="1" >f_nReturnCode == s_nCallerHungup</result>
          </results>
        </action>
        <action id="11" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1309 y=438 ?>
          <!--AddMemberToConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
            <parameter >g_oCallLegA</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="37" stubbed="0"/>
            <result name="FAILURE" link="18" stubbed="1" >f_nReturnCode == s_nFailure</result>
            <result name="CALLERHUNGUP" link="27" stubbed="1" >f_nReturnCode == s_nCallerHungup</result>
          </results>
        </action>
        <action id="12" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=604 y=604 ?>
          <!--"DisconnectFromMOH"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DisconnectFromMOH&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="5" stubbed="0"/>
          </results>
        </action>
        <action id="14" plug-in="Standard.EndSession.1" ><?xtml-editor x=1814 y=376 ?></action>
        <action id="18" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1597 y=381 ?>
          <!--HangUp Caller-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpCaller&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="14" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 6;
Session.g_nConfLeaveReason = 9;
Session.g_strConfLeaveMsg = "FAIL TO ADD PARTY TO CONFERENCE";]]></script>
          </scripts>
        </action>
        <action id="23" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2288 y=574 ?>
          <!--stop timer if needed-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;StopTimer&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="38" stubbed="0"/>
          </results>
        </action>
        <action id="24" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2064 y=572 ?>
          <!--"psAPISceEndRequest"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceEndRequest&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="23" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 1;]]></script>
          </scripts>
        </action>
        <action id="25" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1835 y=579 ?>
          <!--"psAPISceEndAssignment"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceEndAssignment&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="24" stubbed="0"/>
          </results>
        </action>
        <action id="27" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1606 y=580 ?>
          <!--s_strMSG_END_REQUEST_CSR-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strACDControllerIP" transaction="s_strZeroTransactionId" message-name="s_strMsgEndRequestCSR" destination-port="g_nACDControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;RequestId&quot;" value="g_lCSRRequestId"/>
            <parameter tag="&quot;AssignmentId&quot;" value="g_lCSRAssignmentId"/>
          </SOAP>
          <results >
            <result name="Default" link="25" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[Session.g_bSentACDBeginRequest = false;]]></script>
          </scripts>
        </action>
        <action id="28" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1319 y=1285 ?>
          <!--AddMemberToConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oSubConfMS</parameter>
            <parameter >g_oCallLegB</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="33" stubbed="1"/>
            <result name="FAILURE" link="18" stubbed="1" >f_nReturnCode == s_nFailure</result>
            <result name="CALLERHUNGUP" link="27" stubbed="1" >f_nReturnCode == s_nCallerHungup</result>
          </results>
        </action>
        <action id="29" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1055 y=1162 ?>
          <!--Dial In?-->
          <results >
            <result name="Default" link="30" stubbed="0"/>
            <result name="g_strOutdialFlag = &quot;T&quot;;" link="28" stubbed="0" >g_strOutdialFlag match "T"</result>
          </results>
        </action>
        <action id="30" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1303 y=1097 ?>
          <!--AddMemberToConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oSubConfMS</parameter>
            <parameter >g_oCallLegA</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="33" stubbed="1"/>
            <result name="FAILURE" link="18" stubbed="1" >f_nReturnCode == s_nFailure</result>
            <result name="CALLERHUNGUP" link="27" stubbed="1" >f_nReturnCode == s_nCallerHungup</result>
          </results>
        </action>
        <action id="31" plug-in="Standard.Timer.1" ><?xtml-editor x=1061 y=216 ?>
          <!--ck reInvite timer-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lCkReInviteTimerIdA" duration="g_nCkReInviteTime"/>
          <results >
            <result name="Default" link="2" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bCkReInviteTimerFlagA = true;
Server.logInfo("SET TIMER TO CHECK FOR REINVITE A LEG");]]></script>
          </scripts>
        </action>
        <action id="32" plug-in="Standard.Timer.1" ><?xtml-editor x=1079 y=332 ?>
          <!--ck reInvite timer B-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lCkReInviteTimerIdB" duration="g_nCkReInviteTime"/>
          <results >
            <result name="Default" link="2" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bCkReInviteTimerFlagB = true;
Server.logInfo("SET TIMER TO CHECK FOR REINVITE B LEG");]]></script>
          </scripts>
        </action>
        <action id="33" plug-in="Pactolus.Branch.1" ><?xtml-editor x=354 y=255 ?>
          <results >
            <result name="Default" link="2" stubbed="1"/>
            <result name="Time &gt; 0" link="34" stubbed="0" >g_nCkReInviteTime &gt; 0</result>
          </results>
        </action>
        <action id="34" plug-in="Pactolus.Branch.1" ><?xtml-editor x=590 y=249 ?>
          <!--Dial In?-->
          <results >
            <result name="Default" link="35" stubbed="0"/>
            <result name="g_strOutdialFlag = &quot;T&quot;" link="36" stubbed="0" >g_strOutdialFlag match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("CSRCallerOffHold, RESET TIMER TO CHECK FOR REINVITE");]]></script>
          </scripts>
        </action>
        <action id="35" plug-in="Standard.Timer.1" ><?xtml-editor x=832 y=216 ?>
          <!--stop ck reInvite timer-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="0" id="g_lCkReInviteTimerIdA" duration=""/>
          <results >
            <result name="Default" link="31" stubbed="0"/>
          </results>
        </action>
        <action id="36" plug-in="Standard.Timer.1" ><?xtml-editor x=846 y=333 ?>
          <!--stop ck reInvite timer B-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="0" id="g_lCkReInviteTimerIdB" duration=""/>
          <results >
            <result name="Default" link="32" stubbed="0"/>
          </results>
        </action>
        <action id="37" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1600 y=482 ?>
          <!--ConfMSConnectionIDChangedNotify-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ConfMSConnectionIDChangedNotify&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="33" stubbed="1"/>
          </results>
        </action>
        <action id="38" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2526 y=574 ?>
          <!--Party Leave-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;PartyLeave&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="14" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nConfLeaveReason = 0;
Session.g_strConfLeaveMsg = "PARTY HANG UP";]]></script>
          </scripts>
        </action>
      </actions>
    </function>
    <function name="psAPISceEndAssignment" start="5" event="psAPISceEndAssignment" returns="i4" >
      <local-vars >
        <var name="f_nReturnCode" type="i4" >-50</var>
        <var name="bValidDest" type="boolean" >0</var>
      </local-vars>
      <actions >
        <action id="5" plug-in="Pactolus.Branch.1" ><?xtml-editor x=58 y=323 ?>
          <results >
            <result name="Default" link="1" stubbed="1"/>
            <result name="bValidDest" link="4" stubbed="0" >bValidDest == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: psAPISceEndAssignment");
Session.g_lCSRAssignmentEndTime = Server.getUTCTime();
if (Session.g_strConfControllerIP.length <= 0 || Session.g_nConfControllerPort <= 0)
{
	Session.bValidDest = false;
}
else if (!Session.g_bSentPartyJoin)
{
	Session.bValidDest = false;
}
else
{
	Session.bValidDest = true;
}]]></script>
          </scripts>
        </action>
        <action id="1" plug-in="Pactolus.JavaStaticMethod.1" ><?xtml-editor x=546 y=310 ?>
          <!--psAPISceEndAssignment-->
          <java xmlns="urn:www.pactolus.com:xtml:application" class="&quot;com.pactolus.acd.psAPISceEndAssignment&quot;" method="&quot;endAssignment&quot;" timeout="s_nTimeout" return="" method-return-var="f_nReturnCode" method-return-type="0" >
            <parameter type="in" var-type="string" >g_strDBNAME</parameter>
            <parameter type="in" var-type="string" >g_strSessionId</parameter>
            <parameter type="in" var-type="i8" >g_lCSRRequestId</parameter>
            <parameter type="in" var-type="string" >g_strCSRAppServerIP</parameter>
            <parameter type="in" var-type="i8" >g_lCSRAssignmentId</parameter>
            <parameter type="in" var-type="i8" >g_lCSRAssignmentUserId</parameter>
            <parameter type="in" var-type="i8" >g_lCSRAssignmentStartTime</parameter>
            <parameter type="in" var-type="i8" >g_lCSRAssignmentEndTime</parameter>
            <parameter type="in" var-type="string" >g_strConfSessionId</parameter>
            <parameter type="in" var-type="string" >g_strCallLegId</parameter>
            <parameter type="in" var-type="string" >g_strRequestCSRPrivateTalkFlag</parameter>
          </java>
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="Success" link="3" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: *********JAVA CALLING psAPISceEndAssignment *********");

Server.logInfo("INFO: BEFORE DB name = " + Session.g_strDBNAME);

Server.logInfo("INFO: BEFORE CSR request Id = " + Session.g_lCSRRequestId);

Server.logInfo("INFO: BEFORE CSR appserver ip = " + Session.g_strCSRAppServerIP);

Server.logInfo("INFO: BEFORE CSR assignment Id = " + Session.g_lCSRAssignmentId);

Server.logInfo("INFO: BEFORE CSR user Id = " + Session.g_lCSRAssignmentUserId);

Server.logInfo("INFO: BEFORE CSR assignment start time = " + Session.g_lCSRAssignmentStartTime);

Server.logInfo("INFO: BEFORE CSR assignment end time = " + Session.g_lCSRAssignmentEndTime);

Server.logInfo("INFO: BEFORE CSR assignment time zone = " + Session.g_strCSRAssignmentTimeZone);]]></script>
            <script language="javascript" timing="last" ><![CDATA[Server.logInfo("INFO: ********* iJavaReturnCode " + Session.f_nReturnCode);

if (Result.id == 2)

{

	Server.logInfo("INFO: SUCCESS LOG BEGIN REQUEST.");

	if (-99 == Session.f_nReturnCode)
	{
		Session.g_nErrorMsgNumber = 1001; //db error
		Session.g_nTerminationReason = 39
	}
	else

		Session.g_nErrorMsgNumber = 0;

}

else

{

	Server.logError("ERROR: FAIL TO VALIDATE DESTINATION, EXIT ON: " + Result.name);

	Session.g_nTerminationReason = 39;

	Session.g_nErrorMsgNumber = 1000; //jvm server error

}

Session.g_bSentAPIBeginAssignment = false;]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=820 y=319 ?>
          <!--FAILURE-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nFailure"/>
        </action>
        <action id="3" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=833 y=435 ?>
          <!--return code from java-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nReturnCode"/>
        </action>
        <action id="4" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=307 y=320 ?>
          <!--ConfEndAssignmentNotify-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="s_strEndAssignmentNotify" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;ThirdPartyConfId&quot;" value="g_strCustomerConferenceId"/>
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
            <parameter tag="&quot;callerPasscode&quot;" value="g_strCCGeneratedPassCode"/>
            <parameter tag="&quot;endTime&quot;" value="g_lCSRAssignmentEndTime"/>
          </SOAP>
          <results >
            <result name="Default" link="1" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)

{

	Server.logError("FAIL TO SEND CONF END ASSIGNMENT NOTIFY TO CONF CONTROLLER, EXIT ON: " + Result.name);

}]]></script>
          </scripts>
        </action>
      </actions>
    </function>
    <function name="GetAndPlayBalance" start="1" event="GetAndPlayBalance" returns="void" >
      <local-vars >
        <var name="f_strHostIP" type="string" ></var>
        <var name="f_nHostPort" type="i4" >0</var>
        <var name="f_strTransactionId" type="string" ></var>
      </local-vars>
      <actions >
        <action id="1" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=162 y=326 ?>
          <!--GET BALANCE-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="s_strConfGetBalanceRequest" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;callerPassCode&quot;" value="g_strCCGeneratedPassCode"/>
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: GetAndPlayBalance");

Server.logInfo("INFO: SEND CONF GET BALANCE AND TIME REMAINING ****");

Server.logInfo("INFO: CONF CON IP = " + Session.g_strConfControllerIP);

Server.logInfo("INFO: CONF CON PORT = " + Session.g_nConfControllerPort);

Server.logInfo("INFO: CONF CON TRANS ID = " + Session.g_strResponseTransactionId);

Server.logInfo("INFO: CONF CON MSG NAME = " + Session.s_strConfGetBalanceRequest);

Server.logInfo("INFO: CONF SCHED Id =  " + Session.g_strConfScheduleId);]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.WaitEvent.1" ><?xtml-editor x=423 y=322 ?>
          <!--ConfRemainingBalanceResponse-->
          <wait xmlns="urn:www.pactolus.com:xtml:communication" timeout="5" recv-name="g_strEventReceived" >
            <msg name="ConfRemainingBalanceResponse" >
              <parameter >f_strHostIP</parameter>
              <parameter >f_nHostPort</parameter>
              <parameter >f_strTransactionId</parameter>
              <parameter >g_nRemainingHours</parameter>
              <parameter >g_nRemainingMinutes</parameter>
              <parameter >g_nRemainingSeconds</parameter>
              <parameter >g_fRemainingBalance</parameter>
            </msg>
          </wait>
          <results >
            <result name="Default" link="5" stubbed="1"/>
            <result name="Success" link="3" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)

{

	Server.logError("ERROR: FAIL TO GET REMAINING BALANCE AND TIME");

}]]></script>
          </scripts>
        </action>
        <action id="3" plug-in="Pactolus.Branch.1" ><?xtml-editor x=686 y=314 ?>
          <!--balance > 0-->
          <results >
            <result name="Default" link="5" stubbed="1"/>
            <result name="remainingBalance &gt; 0" link="4" stubbed="0" >g_fRemainingBalance &gt; 0</result>
          </results>
        </action>
        <action id="4" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=940 y=312 ?>
          <!--502: Your account balance is ...-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >503</audio>
            <audio type="currency" unit="" >g_fRemainingBalance</audio>
          </play>
          <results >
            <result name="Default" link="5" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="5" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1175 y=318 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
        </action>
      </actions>
    </function>
    <function name="GetAndPlayTime" start="1" event="GetAndPlayTime" returns="void" >
      <local-vars >
        <var name="f_strHostIP" type="string" ></var>
        <var name="f_nHostPort" type="i4" >0</var>
        <var name="f_strTransactionId" type="string" ></var>
      </local-vars>
      <actions >
        <action id="1" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=104 y=253 ?>
          <!--GET TIME AND BALANCE-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="s_strConfGetBalanceRequest" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;callerPassCode&quot;" value="g_strCCGeneratedPassCode"/>
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: GetAndPlayTime");

Server.logInfo("INFO: SEND CONF GET BALANCE AND TIME REMAINING ****");

Server.logInfo("INFO: CONF CON IP = " + Session.g_strConfControllerIP);

Server.logInfo("INFO: CONF CON PORT = " + Session.g_nConfControllerPort);

Server.logInfo("INFO: CONF CON TRANS Id = " + Session.g_strResponseTransactionId);

Server.logInfo("INFO: CONF CON MSG NAME = " + Session.s_strConfGetBalanceRequest);

Server.logInfo("INFO: CONF SCHED Id =  " + Session.g_strConfScheduleId);]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.WaitEvent.1" ><?xtml-editor x=365 y=249 ?>
          <!--ConfRemainingBalanceResponse-->
          <wait xmlns="urn:www.pactolus.com:xtml:communication" timeout="5" recv-name="g_strEventReceived" >
            <msg name="ConfRemainingBalanceResponse" >
              <parameter >f_strHostIP</parameter>
              <parameter >f_nHostPort</parameter>
              <parameter >f_strTransactionId</parameter>
              <parameter >g_nRemainingHours</parameter>
              <parameter >g_nRemainingMinutes</parameter>
              <parameter >g_nRemainingSeconds</parameter>
              <parameter >g_fRemainingBalance</parameter>
            </msg>
          </wait>
          <results >
            <result name="Default" link="5" stubbed="0"/>
            <result name="Success" link="6" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)

{

	Server.logError("ERROR: FAIL TO GET REMAINING BALANCE AND TIME");

}]]></script>
          </scripts>
        </action>
        <action id="5" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=660 y=251 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
        </action>
        <action id="6" plug-in="Pactolus.Branch.1" ><?xtml-editor x=101 y=467 ?>
          <!--hours remaining-->
          <results >
            <result name="Default" link="5" stubbed="1"/>
            <result name="0 hour" link="7" stubbed="0" >g_nRemainingHours == 0</result>
            <result name="1 hour" link="8" stubbed="0" >g_nRemainingHours == 1</result>
            <result name="2 or more hours" link="9" stubbed="0" >g_nRemainingHours &gt;= 2</result>
          </results>
        </action>
        <action id="7" plug-in="Pactolus.Branch.1" ><?xtml-editor x=359 y=476 ?>
          <!--minutes remaining-->
          <results >
            <result name="Default" link="5" stubbed="1"/>
            <result name="0 minute" link="5" stubbed="1" >g_nRemainingMinutes == 0</result>
            <result name="1 minute" link="10" stubbed="0" >g_nRemainingMinutes == 1</result>
            <result name="2 or more minutes" link="11" stubbed="0" >g_nRemainingMinutes &gt;= 2</result>
          </results>
        </action>
        <action id="8" plug-in="Pactolus.Branch.1" ><?xtml-editor x=409 y=783 ?>
          <!--minutes remaining-->
          <results >
            <result name="Default" link="5" stubbed="1"/>
            <result name="0 minute" link="5" stubbed="1" >g_nRemainingMinutes == 0</result>
            <result name="1 minute" link="12" stubbed="0" >g_nRemainingMinutes == 1</result>
            <result name="2 or more minutes" link="13" stubbed="0" >g_nRemainingMinutes &gt;= 2</result>
          </results>
        </action>
        <action id="9" plug-in="Pactolus.Branch.1" ><?xtml-editor x=403 y=1106 ?>
          <!--minutes remaining-->
          <results >
            <result name="Default" link="5" stubbed="1"/>
            <result name="0 minute" link="5" stubbed="1" >g_nRemainingMinutes == 0</result>
            <result name="1 minute" link="14" stubbed="0" >g_nRemainingMinutes == 1</result>
            <result name="2 or more minutes" link="15" stubbed="0" >g_nRemainingMinutes &gt;= 2</result>
          </results>
        </action>
        <action id="10" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=668 y=468 ?>
          <!--1 minute-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="number" >g_nRemainingMinutes</audio>
            <audio type="index" >308</audio>
          </play>
          <results >
            <result name="Default" link="5" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="11" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=680 y=619 ?>
          <!--2 or more minutes-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="number" >g_nRemainingMinutes</audio>
            <audio type="index" >309</audio>
          </play>
          <results >
            <result name="Default" link="5" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="12" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=706 y=778 ?>
          <!--1 hour and 1 minute-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="number" >g_nRemainingHours</audio>
            <audio type="index" >88</audio>
            <audio type="number" >g_nRemainingMinutes</audio>
            <audio type="index" >308</audio>
          </play>
          <results >
            <result name="Default" link="5" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="13" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=704 y=915 ?>
          <!--1 hour and 2 or more minutes-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="number" >g_nRemainingHours</audio>
            <audio type="index" >88</audio>
            <audio type="number" >g_nRemainingMinutes</audio>
            <audio type="index" >309</audio>
          </play>
          <results >
            <result name="Default" link="5" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="14" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=709 y=1096 ?>
          <!--2 or  more hours and 1 minute-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="number" >g_nRemainingHours</audio>
            <audio type="index" >89</audio>
            <audio type="number" >g_nRemainingMinutes</audio>
            <audio type="index" >308</audio>
          </play>
          <results >
            <result name="Default" link="5" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="15" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=714 y=1284 ?>
          <!--2 or more  hours and 2 or more minutes-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="number" >g_nRemainingHours</audio>
            <audio type="index" >89</audio>
            <audio type="number" >g_nRemainingMinutes</audio>
            <audio type="index" >309</audio>
          </play>
          <results >
            <result name="Default" link="5" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
      </actions>
    </function>
    <function name="OnInfo" start="2" event="OnInfo" returns="void" >
      <parameters >
        <parameter name="strAccept" type="string" pass="byref"/>
        <parameter name="strAcceptEncoding" type="string" pass="byref"/>
        <parameter name="strAcceptLanguage" type="string" pass="byref"/>
        <parameter name="strAuthorization" type="string" pass="byref"/>
        <parameter name="strCallId" type="string" pass="byref"/>
        <parameter name="strContact" type="string" pass="byref"/>
        <parameter name="strContent" type="string" pass="byref"/>
        <parameter name="strContentDisposition" type="string" pass="byref"/>
        <parameter name="strContentType" type="string" pass="byref"/>
        <parameter name="strCSeq" type="string" pass="byref"/>
        <parameter name="strDate" type="string" pass="byref"/>
        <parameter name="strEncryption" type="string" pass="byref"/>
        <parameter name="strFrom" type="string" pass="byref"/>
        <parameter name="strMaxForwards" type="string" pass="byref"/>
        <parameter name="strMIMEVersion" type="string" pass="byref"/>
        <parameter name="strOrganization" type="string" pass="byref"/>
        <parameter name="strPriority" type="string" pass="byref"/>
        <parameter name="strProxyAuthorization" type="string" pass="byref"/>
        <parameter name="strProxyRequire" type="string" pass="byref"/>
        <parameter name="strRecordRoute" type="string" pass="byref"/>
        <parameter name="strRequestUri" type="string" pass="byref"/>
        <parameter name="strRequire" type="string" pass="byref"/>
        <parameter name="strResponseKey" type="string" pass="byref"/>
        <parameter name="strRoute" type="string" pass="byref"/>
        <parameter name="strSupported" type="string" pass="byref"/>
        <parameter name="strTimestamp" type="string" pass="byref"/>
        <parameter name="strTo" type="string" pass="byref"/>
        <parameter name="strUserAgent" type="string" pass="byref"/>
        <parameter name="strVia" type="string" pass="byref"/>
      </parameters>
      <actions >
        <action id="2" plug-in="Pactolus.SipResponse.1" ><?xtml-editor x=254 y=241 ?>
          <sip-response xmlns="urn:www.pactolus.com:xtml:sip" remove-via="0" reliable="0" increment-cseq-first="0" increment-cseq-last="0" >
            <call-id >strCallId</call-id>
            <contact >g_strContact</contact>
            <cseq >strCSeq</cseq>
            <from >strFrom</from>
            <status >"SIP/2.0 200 OK"</status>
            <to >strTo</to>
            <via >strVia</via>
          </sip-response>
          <results >
            <result name="Default" link="1" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: OnInfo");
js_disable_event();

var newCSeq = new SipCSeq(Session.strCSeq);

var oldCSeq = new SipCSeq(Session.g_oCallLegA.strCSeq);



if(newCSeq.value >= oldCSeq.value) 

{

	newCSeq.increment() ;

	Session.g_oCallLegA.strCSeq = newCSeq.encode() ;

}]]></script>
          </scripts>
        </action>
        <action id="1" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=549 y=238 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_enable_event();]]></script>
          </scripts>
        </action>
      </actions>
    </function>
    <function name="setDTMFOff" start="4" event="setDTMFOff" returns="i4" >
      <local-vars >
        <var name="f_strRequestNotify" type="string" ></var>
      </local-vars>
      <actions >
        <action id="4" plug-in="Pactolus.Branch.1" ><?xtml-editor x=68 y=407 ?>
          <!--in sub conf?-->
          <results >
            <result name="Default" link="6" stubbed="0"/>
            <result name="g_bCurrentlyInSubConf" link="7" stubbed="0" >g_bCurrentlyInSubConf == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: setDTMFOff");]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Pactolus.MGCPNotifyRequest.1" ><?xtml-editor x=549 y=314 ?>
          <rqnt xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" timeout="s_nTimeout" returns="" ms-type="g_oMS.strType" >
            <parameters >
              <quarantine step="0" loop="0" process="0" discard="0"/>
              <events ><![CDATA[]]></events>
              <signals ><![CDATA[f_strRequestNotify]]></signals>
              <digit-map ><![CDATA[]]></digit-map>
            </parameters>
          </rqnt>
          <results >
            <result name="Default" link="3" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: TURN COLLECT DTMF OFF");

Server.logInfo("INFO: RQNT MS call id = " + Session.g_oMS.strCallId);

Server.logInfo("INFO: RQNT MS connection id = " + Session.g_oMS.strConnectionId);

Server.logInfo("INFO: RQNT MS end point = " + Session.g_oMS.strEndPoint);

Session.f_strRequestNotify = "A/null@" + Session.g_oMS.strConnectionId;]]></script>
          </scripts>
        </action>
        <action id="3" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=821 y=310 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
        </action>
        <action id="5" plug-in="Pactolus.MGCPNotifyRequest.1" ><?xtml-editor x=566 y=561 ?>
          <rqnt xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oSubConfMS.strConnectionId" endpoint="g_oSubConfMS.strEndPoint" callid="g_oSubConfMS.strCallId" timeout="s_nTimeout" returns="" ms-type="g_oSubConfMS.strType" >
            <parameters >
              <quarantine step="0" loop="0" process="0" discard="0"/>
              <events ><![CDATA[]]></events>
              <signals ><![CDATA[f_strRequestNotify]]></signals>
              <digit-map ><![CDATA[]]></digit-map>
            </parameters>
          </rqnt>
          <results >
            <result name="Default" link="3" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: TURN COLLECT DTMF OFF");

Server.logInfo("INFO: RQNT MS call id = " + Session.g_oSubConfMS.strCallId);

Server.logInfo("INFO: RQNT MS connection id = " + Session.g_oSubConfMS.strConnectionId);

Server.logInfo("INFO: RQNT MS end point = " + Session.g_oSubConfMS.strEndPoint);

Session.f_strRequestNotify = "A/null@" + Session.g_oSubConfMS.strConnectionId;]]></script>
          </scripts>
        </action>
        <action id="6" plug-in="Pactolus.Branch.1" ><?xtml-editor x=300 y=316 ?>
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="blank endpoint" link="3" stubbed="1" >g_oMS.strEndPoint.length &lt;= 0</result>
          </results>
        </action>
        <action id="7" plug-in="Pactolus.Branch.1" ><?xtml-editor x=317 y=568 ?>
          <results >
            <result name="Default" link="5" stubbed="0"/>
            <result name="blank endpoint" link="3" stubbed="1" >g_oSubConfMS.strEndPoint.length &lt;= 0</result>
          </results>
        </action>
      </actions>
    </function>
    <function name="OnPing" start="1" event="OnPing" returns="void" >
      <parameters >
        <parameter name="strACDControllerIP" type="string" pass="byref"/>
        <parameter name="nACDControllerPort" type="i4" pass="byref"/>
        <parameter name="strTransactionId" type="string" pass="byref"/>
        <parameter name="strHostIP" type="string" pass="byref"/>
        <parameter name="nHostPort" type="i4" pass="byref"/>
      </parameters>
      <actions >
        <action id="1" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=177 y=212 ?>
          <!--RESPONSE SUCCESS-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strACDControllerIP" transaction="strTransactionId" message-name="&quot;PingResponse&quot;" destination-port="nACDControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace=""/>
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: OnPing");]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=434 y=213 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
        </action>
      </actions>
    </function>
    <function name="OnConfPrivateTalkRequest" start="13" event="OnConfPrivateTalkRequest" returns="void" >
      <parameters >
        <parameter name="strConferenceControllerIP" type="string" pass="byref"/>
        <parameter name="nConferenceControllerPort" type="i4" pass="byref"/>
        <parameter name="strTransactionId" type="string" pass="byref"/>
      </parameters>
      <local-vars >
        <var name="f_nReturnCode" type="i4" >-1</var>
      </local-vars>
      <actions >
        <action id="13" plug-in="Pactolus.Branch.1" ><?xtml-editor x=73 y=136 ?>
          <results >
            <result name="Default" link="1" stubbed="0"/>
            <result name="g_bPartyHandRaised" link="11" stubbed="0" >g_bPartyHandRaised == true</result>
          </results>
        </action>
        <action id="1" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=330 y=242 ?>
          <!--remove from conference

add to new conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;RemoveOldAddNew&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="SUCCESS" link="3" stubbed="0" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: OnConfPrivateTalkRequest");
Session.g_oTempConf.bDTMFClampFlag = false;]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=580 y=187 ?>
          <!--response FAILURE-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strConferenceControllerIP" transaction="strTransactionId" message-name="s_strConfPrivateTalkResponse" destination-port="nConferenceControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="s_nFailure"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
            <parameter tag="&quot;tempConferenceId&quot;" value="g_oTempConf.strConferenceId"/>
          </SOAP>
          <results >
            <result name="Default" link="4" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "FAIL TO MOVE MODERATOR FROM MAIN CONFERENCE TO TEMP CONFERENCE";]]></script>
          </scripts>
        </action>
        <action id="3" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=596 y=363 ?>
          <!--response SUCCESS-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strConferenceControllerIP" transaction="strTransactionId" message-name="s_strConfPrivateTalkResponse" destination-port="nConferenceControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="s_nSuccess"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
            <parameter tag="&quot;tempConferenceId&quot;" value="g_oTempConf.strConferenceId"/>
          </SOAP>
          <results >
            <result name="Default" link="4" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "SUCCESS MOVE MODERATOR FROM MAIN CONFERENCE TO TEMP CONFERENCE";

Server.logInfo("TEMP CONFERENCE Id IS: " + Session.g_oTempConf.strConferenceId);]]></script>
          </scripts>
        </action>
        <action id="4" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=836 y=182 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
        </action>
        <action id="5" plug-in="Standard.Timer.1" ><?xtml-editor x=846 y=481 ?>
          <!--ck reInvite timer-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lCkReInviteTimerIdA" duration="g_nCkReInviteTime"/>
          <results >
            <result name="Default" link="4" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bCkReInviteTimerFlagA = true;
Server.logInfo("SET TIMER TO CHECK FOR REINVITE A LEG");]]></script>
          </scripts>
        </action>
        <action id="6" plug-in="Standard.Timer.1" ><?xtml-editor x=864 y=597 ?>
          <!--ck reInvite timer B-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lCkReInviteTimerIdB" duration="g_nCkReInviteTime"/>
          <results >
            <result name="Default" link="4" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bCkReInviteTimerFlagB = true;
Server.logInfo("SET TIMER TO CHECK FOR REINVITE B LEG");]]></script>
          </scripts>
        </action>
        <action id="7" plug-in="Pactolus.Branch.1" ><?xtml-editor x=139 y=520 ?>
          <results >
            <result name="Default" link="4" stubbed="1"/>
            <result name="Time &gt; 0" link="8" stubbed="0" >g_nCkReInviteTime &gt; 0</result>
          </results>
        </action>
        <action id="8" plug-in="Pactolus.Branch.1" ><?xtml-editor x=375 y=514 ?>
          <!--Dial In?-->
          <results >
            <result name="Default" link="9" stubbed="0"/>
            <result name="g_strOutdialFlag = &quot;T&quot;" link="10" stubbed="0" >g_strOutdialFlag match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("BEGIN PRIVATE TALK, RESET TIMER TO CHECK FOR REINVITE");]]></script>
          </scripts>
        </action>
        <action id="9" plug-in="Standard.Timer.1" ><?xtml-editor x=617 y=481 ?>
          <!--stop ck reInvite timer-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="0" id="g_lCkReInviteTimerIdA" duration=""/>
          <results >
            <result name="Default" link="5" stubbed="0"/>
          </results>
        </action>
        <action id="10" plug-in="Standard.Timer.1" ><?xtml-editor x=631 y=598 ?>
          <!--stop ck reInvite timer B-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="0" id="g_lCkReInviteTimerIdB" duration=""/>
          <results >
            <result name="Default" link="6" stubbed="0"/>
          </results>
        </action>
        <action id="11" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=328 y=52 ?>
          <!--s_strCancelQandARequest-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="s_strCancelQandARequest" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
            <parameter tag="&quot;CCGeneratedPasscode&quot;" value="g_strCCGeneratedPassCode"/>
          </SOAP>
          <results >
            <result name="Default" link="12" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: **** CONF Cancel Q&A Request ****");]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)
{
	Server.logError("ERROR: FAIL TO SEND SOAP MESSAGE CONF Cancel Q and A Request.");
}
else
{
	Server.logInfo("SUCCESSFUL SEND SOAP MESSAGE TO CONF: CANCEL Q AND A REQUEST");
}]]></script>
          </scripts>
        </action>
        <action id="12" plug-in="Standard.WaitEvent.1" ><?xtml-editor x=575 y=45 ?>
          <!--ConfCancelQandAResponse-->
          <wait xmlns="urn:www.pactolus.com:xtml:communication" timeout="s_nTimeout" recv-name="g_strEventReceived" >
            <msg name="ConfCancelQandAResponse" >
              <parameter ></parameter>
              <parameter ></parameter>
              <parameter ></parameter>
              <parameter >f_nReturnCode</parameter>
              <parameter ></parameter>
            </msg>
          </wait>
          <results >
            <result name="Default" link="1" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
            <result name="" ><?xtml-editor visible=no?></result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (2 == Result.id && 0 == Session.f_nReturnCode)
{
	Session.g_bPartyHandRaised = false;
	Server.logInfo("SUCCESS CANCEL Q AND A");
}
else
{
	Server.logError("FAIL TO CANCEL Q AND A, EXIT ON BRANCH: " + Result.name);
	Server.logError("FAIL TO CANCEL Q AND A, RETURN CODE: " + Session.f_nReturnCode);
}]]></script>
          </scripts>
        </action>
      </actions>
    </function>
    <function name="OnConfEndPrivateTalkRequest" start="13" event="OnConfEndPrivateTalkRequest" returns="void" >
      <parameters >
        <parameter name="strConferenceControllerIP" type="string" pass="byref"/>
        <parameter name="nConferenceControllerPort" type="i4" pass="byref"/>
        <parameter name="strTransactionId" type="string" pass="byref"/>
        <parameter name="nActionCode" type="i4" pass="byref"/>
        <parameter name="strSendResponseBackFlag" type="string" pass="byref"/>
      </parameters>
      <local-vars >
        <var name="f_nReturnCode" type="i4" >-1</var>
        <var name="f_bNullString" type="boolean" >0</var>
        <var name="f_strConfControllerIP" type="string" ></var>
        <var name="f_nConfControllerPort" type="i4" >0</var>
        <var name="f_strTransactionId" type="string" ></var>
        <var name="f_strReturnMsg" type="string" ></var>
      </local-vars>
      <actions >
        <action id="13" plug-in="Pactolus.Branch.1" ><?xtml-editor x=63 y=304 ?>
          <!--Dial In?-->
          <results >
            <result name="Default" link="70" stubbed="0"/>
            <result name="g_strOutdialFlag = &quot;T&quot;;" link="71" stubbed="0" >g_strOutdialFlag match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: OnConfEndPrivateTalkRequest");
js_disable_event();

Session.g_bPrivateTalkInConference = false;

if ("T" == Session.g_strPrivateTalkFlag)

{

	Session.g_lPrivateTalkEndTime = Server.getUTCTime();

}]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1600 y=194 ?>
          <!--party leave-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;PartyLeave&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="12" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nConfLeaveReason = 4;
Session.g_strConfLeaveMsg = "FAIL TO SEND SIP INVITE PARTY TO HOLD";]]></script>
          </scripts>
        </action>
        <action id="3" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=606 y=123 ?>
          <!--HangUp Caller-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpCaller&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="42" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nConfLeaveReason = 4;
Session.g_strConfLeaveMsg = "FAIL TO SEND SIP INVITE PARTY TO HOLD";]]></script>
          </scripts>
        </action>
        <action id="5" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=544 y=400 ?>
          <!--Remove member from temp conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;RemoveMemberFromConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
          </function>
          <results >
            <result name="Default" link="18" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: ADD PARTY, RETURN TO CONF, REMOVE FROM TEMP CONF.");]]></script>
          </scripts>
        </action>
        <action id="6" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1992 y=356 ?>
          <!--AddMemberToOldConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
            <parameter >g_oCallLegA</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="74" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: ADD PARTY, ADD MEMBER BACK TO OLD CONF.");]]></script>
          </scripts>
        </action>
        <action id="7" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=948 y=535 ?>
          <!--delete temp conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DeleteConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
          </function>
          <results >
            <result name="Default" link="39" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: ADD PARTY, RETURN TO CONF, DELETE TEMP CONF.");]]></script>
            <script language="javascript" timing="last" ><![CDATA[Session.g_bCreatedTempConf = false;]]></script>
          </scripts>
        </action>
        <action id="8" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=3210 y=296 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="9" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2240 y=352 ?>
          <!--success?-->
          <results >
            <result name="Default" link="20" stubbed="0"/>
            <result name="FAILURE" link="3" stubbed="1" >f_nReturnCode == s_nFailure</result>
            <result name="CALLERHUNGUP" link="42" stubbed="1" >f_nReturnCode == s_nCallerHungup</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Result.id == 2)

{

	Session.g_nTerminationReason = 35;

}

else if (Result.id == 3)

{

	Session.g_nTerminationReason = 1;

}]]></script>
          </scripts>
        </action>
        <action id="10" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=134 y=124 ?>
          <!--Remove member from temp conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;RemoveMemberFromConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
          </function>
          <results >
            <result name="Default" link="11" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 36;]]></script>
          </scripts>
        </action>
        <action id="11" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=366 y=124 ?>
          <!--delete temp conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DeleteConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
          </function>
          <results >
            <result name="Default" link="3" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: ADD PARTY, RETURN TO CONF, DELETE TEMP CONF.");]]></script>
            <script language="javascript" timing="last" ><![CDATA[Session.g_bCreatedTempConf = false;]]></script>
          </scripts>
        </action>
        <action id="12" plug-in="Standard.EndSession.1" ><?xtml-editor x=1599 y=127 ?></action>
        <action id="15" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1529 y=489 ?>
          <!--Dial In?-->
          <results >
            <result name="Default" link="43" stubbed="0"/>
            <result name="g_strOutdialFlag = &quot;T&quot;;" link="44" stubbed="0" >g_strOutdialFlag match "T"</result>
          </results>
        </action>
        <action id="16" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1767 y=865 ?>
          <!--"AddMemberToConference"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
            <parameter >g_oCallLegB</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="37" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: ADD PARTY, ADD MEMBER BACK TO OLD CONF.");

Session.g_oMS.bMuteFlag = true;

Session.g_oMS.bDeafFlag = true;]]></script>
          </scripts>
        </action>
        <action id="18" plug-in="Pactolus.Branch.1" ><?xtml-editor x=168 y=547 ?>
          <!--bridge?-->
          <results >
            <result name="Default" link="22" stubbed="0"/>
            <result name="0 or 5 -  bridge" link="21" stubbed="0" >nActionCode == 0
OR nActionCode == 5</result>
          </results>
        </action>
        <action id="19" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=2752 y=465 ?>
          <!--response SUCCESS-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strConferenceControllerIP" transaction="strTransactionId" message-name="&quot;ConfEndPrivateTalkResponse&quot;" destination-port="nConferenceControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="s_nSuccess"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
          </SOAP>
          <results >
            <result name="Default" link="63" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "SUCCESS CONF END PRIVATE TALK";]]></script>
          </scripts>
        </action>
        <action id="20" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2497 y=352 ?>
          <!--send response back?-->
          <results >
            <result name="Default" link="63" stubbed="0"/>
            <result name="strSendResponseBackFlag" link="19" stubbed="0" >strSendResponseBackFlag match "T"</result>
          </results>
        </action>
        <action id="21" plug-in="Pactolus.Branch.1" ><?xtml-editor x=424 y=546 ?>
          <!--private talk?-->
          <results >
            <result name="Default" link="7" stubbed="0"/>
            <result name="strPrivateTalkFlag" link="39" stubbed="0" >g_strPrivateTalkFlag match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (2 == Result.id)

{

	Session.g_oMS.strConferenceId = Session.g_strConfResource;

}]]></script>
          </scripts>
        </action>
        <action id="22" plug-in="Pactolus.Branch.1" ><?xtml-editor x=184 y=810 ?>
          <!--private talk?-->
          <results >
            <result name="Default" link="24" stubbed="0"/>
            <result name="strPrivateTalkFlag" link="23" stubbed="0" >g_strPrivateTalkFlag match "T"</result>
          </results>
        </action>
        <action id="23" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=448 y=812 ?>
          <!--HangUpPartyB-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpParty&quot;" return="f_nReturnCode" external-function="1" library="lib_callcontrol.xml" >
            <parameter >g_oCallLegB</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="26" stubbed="0"/>
          </results>
        </action>
        <action id="24" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=443 y=946 ?>
          <!--"HangUpCaller"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpCaller&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="26" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nConfLeaveReason = 20;
Session.g_strConfLeaveMsg = "CSR RELEASE HANG UP";]]></script>
          </scripts>
        </action>
        <action id="25" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=976 y=800 ?>
          <!--response SUCCESS-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strConferenceControllerIP" transaction="strTransactionId" message-name="&quot;ConfEndPrivateTalkResponse&quot;" destination-port="nConferenceControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="s_nSuccess"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
          </SOAP>
          <results >
            <result name="Default" link="12" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "SUCCESS CONF END PRIVATE TALK";]]></script>
          </scripts>
        </action>
        <action id="26" plug-in="Pactolus.Branch.1" ><?xtml-editor x=715 y=806 ?>
          <!--send response back?-->
          <results >
            <result name="Default" link="12" stubbed="1"/>
            <result name="strSendResponseBackFlag" link="25" stubbed="0" >strSendResponseBackFlag match "T"</result>
          </results>
        </action>
        <action id="28" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2971 y=465 ?>
          <!--set DTMF detection ON-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;SetDTMFOn&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="20" stubbed="1"/>
          </results>
        </action>
        <action id="29" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2300 y=897 ?>
          <!--play tone or name?-->
          <results >
            <result name="Default" link="20" stubbed="1"/>
            <result name="play tone - 1" link="32" stubbed="0" >g_nArriveDepartOption == 1</result>
            <result name="play name - 3" link="30" stubbed="0" >g_nArriveDepartOption == 3</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_disable_event();

Session.g_lMSConnectTime = Server.getUTCTime();]]></script>
          </scripts>
        </action>
        <action id="30" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2553 y=1059 ?>
          <!--null string-->
          <results >
            <result name="Default" link="31" stubbed="0"/>
            <result name="f_bNullString == true" link="32" stubbed="1" >f_bNullString == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("RECORDED NAME IS:  " + Session.g_strCallerRecordedName);

Server.logInfo("RECORDED NAME LENGTH IS:  " + Session.g_nRecordNameLength);

if (Session.g_nRecordNameLength <= 0)

{

	Session.f_bNullString = true;

}

else

{

	Session.f_bNullString = false;

}]]></script>
          </scripts>
        </action>
        <action id="31" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2779 y=1049 ?>
          <!--xxx has joined-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="&quot;*&quot;" endpoint="g_oMS.strConferenceId" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="url" >g_strCallerRecordedName</audio>
            <audio type="index" >938</audio>
          </play>
          <results >
            <result name="Default" link="20" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="32" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2538 y=956 ?>
          <!--Play Join Tone to conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;PlayPromptToConference&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
            <parameter >g_strLanguage</parameter>
            <parameter >s_nPromptArrivalTone</parameter>
          </function>
          <results >
            <result name="Default" link="20" stubbed="1"/>
          </results>
        </action>
        <action id="33" plug-in="Pactolus.Branch.1" ><?xtml-editor x=3022 y=762 ?>
          <!--subscriber?-->
          <results >
            <result name="Default" link="29" stubbed="1"/>
            <result name="g_strIsSubscriberFlag== &quot;T&quot;" link="34" stubbed="0" >g_strIsSubscriberFlag match "T"</result>
          </results>
        </action>
        <action id="34" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=3278 y=760 ?>
          <!--GetAndPlayBalance-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;GetAndPlayBalance&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="29" stubbed="1"/>
          </results>
        </action>
        <action id="35" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2751 y=759 ?>
          <!--prepaid conference-->
          <results >
            <result name="Default" link="29" stubbed="1"/>
            <result name="billing type == 1?" link="33" stubbed="0" >g_nBillingType == 1</result>
          </results>
        </action>
        <action id="36" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2451 y=737 ?>
          <!--party join to conf controller-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;PartyJoin&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="35" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[js_disable_event();]]></script>
          </scripts>
        </action>
        <action id="37" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1986 y=856 ?>
          <!--success?-->
          <results >
            <result name="Default" link="73" stubbed="0"/>
            <result name="FAILURE" link="3" stubbed="1" >f_nReturnCode == s_nFailure</result>
            <result name="CALLERHUNGUP" link="41" stubbed="1" >f_nReturnCode == s_nCallerHungup</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Result.id == 2)

{

	Session.g_nTerminationReason = 35;

}

else if (Result.id == 3)

{

	Session.g_nTerminationReason = 1;

}]]></script>
          </scripts>
        </action>
        <action id="38" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2006 y=577 ?>
          <!--AddMemberToOldConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
            <parameter >g_oCallLegB</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="74" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: ADD PARTY, ADD MEMBER BACK TO OLD CONF.");]]></script>
          </scripts>
        </action>
        <action id="39" plug-in="Pactolus.Branch.1" ><?xtml-editor x=961 y=668 ?>
          <!--private talk?-->
          <results >
            <result name="Default" link="15" stubbed="0"/>
            <result name="strPrivateTalkFlag" link="75" stubbed="0" >g_strPrivateTalkFlag match "T"</result>
          </results>
        </action>
        <action id="40" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1333 y=114 ?>
          <!--private talk?-->
          <results >
            <result name="Default" link="12" stubbed="0"/>
            <result name="strPrivateTalkFlag" link="2" stubbed="0" >g_strPrivateTalkFlag match "T"</result>
          </results>
        </action>
        <action id="41" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1093 y=116 ?>
          <!--response s_nFailure-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strConferenceControllerIP" transaction="strTransactionId" message-name="&quot;ConfEndPrivateTalkResponse&quot;" destination-port="nConferenceControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="s_nFailure"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
          </SOAP>
          <results >
            <result name="Default" link="40" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "FAILS CONF END PRIVATE TALK";]]></script>
          </scripts>
        </action>
        <action id="42" plug-in="Pactolus.Branch.1" ><?xtml-editor x=844 y=116 ?>
          <!--send response back?-->
          <results >
            <result name="Default" link="40" stubbed="1"/>
            <result name="strSendResponseBackFlag" link="41" stubbed="0" >strSendResponseBackFlag match "T"</result>
          </results>
        </action>
        <action id="43" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1737 y=383 ?>
          <!--in sub conf?-->
          <results >
            <result name="Default" link="6" stubbed="0"/>
            <result name="g_bCurrentlyInSubConf" link="45" stubbed="0" >g_bCurrentlyInSubConf == true</result>
          </results>
        </action>
        <action id="44" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1752 y=580 ?>
          <!--in sub conf?-->
          <results >
            <result name="Default" link="38" stubbed="0"/>
            <result name="g_bCurrentlyInSubConf" link="46" stubbed="0" >g_bCurrentlyInSubConf == true</result>
          </results>
        </action>
        <action id="45" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2013 y=467 ?>
          <!--AddMemberToOldConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oSubConfMS</parameter>
            <parameter >g_oCallLegA</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="9" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: ADD PARTY, ADD MEMBER BACK TO OLD CONF.");]]></script>
          </scripts>
        </action>
        <action id="46" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2022 y=685 ?>
          <!--AddMemberToOldConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oSubConfMS</parameter>
            <parameter >g_oCallLegB</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="9" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: ADD PARTY, ADD MEMBER BACK TO OLD CONF.");]]></script>
          </scripts>
        </action>
        <action id="49" plug-in="Pactolus.Branch.1" ><?xtml-editor x=3039 y=909 ?>
          <!--muted?-->
          <results >
            <result name="Default" link="72" stubbed="0"/>
            <result name="g_bMuteThisParty" link="87" stubbed="0" >g_bMuteThisParty == true</result>
          </results>
        </action>
        <action id="50" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=2572 y=1351 ?>
          <!--UnmutePartyRequest-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="s_strUnmutePartyRequest" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;callerPassCode&quot;" value="g_strCCGeneratedPassCode"/>
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="53" stubbed="0"/>
            <result name="Success" link="51" stubbed="0"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_disable_event();

Server.logInfo("INFO: **** UNMUTE PARTY REQUEST ****");]]></script>
          </scripts>
        </action>
        <action id="51" plug-in="Standard.WaitEvent.1" ><?xtml-editor x=2805 y=1489 ?>
          <!--UnmutePartyResponse-->
          <wait xmlns="urn:www.pactolus.com:xtml:communication" timeout="5" recv-name="g_strEventReceived" >
            <msg name="UnmutePartyResponse" >
              <parameter >f_strConfControllerIP</parameter>
              <parameter >f_nConfControllerPort</parameter>
              <parameter >f_strTransactionId</parameter>
              <parameter >f_nReturnCode</parameter>
              <parameter >f_strReturnMsg</parameter>
            </msg>
          </wait>
          <results >
            <result name="Default" link="53" stubbed="1"/>
            <result name="Success" link="52" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_nReturnCode = -1;]]></script>
            <script language="javascript" timing="last" ><![CDATA[js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="52" plug-in="Pactolus.Branch.1" ><?xtml-editor x=3038 y=1487 ?>
          <!--success?-->
          <results >
            <result name="Default" link="53" stubbed="1"/>
            <result name="f_nReturnCode == 0" link="56" stubbed="0" >f_nReturnCode == 0</result>
          </results>
        </action>
        <action id="53" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2790 y=1350 ?>
          <!--can't unmute-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >933</audio>
          </play>
          <results >
            <result name="Default" link="88" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="54" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2352 y=1244 ?>
          <!--CallPartyFlag==T?-->
          <results >
            <result name="Default" link="60" stubbed="0"/>
            <result name="g_strPartyPasscodeFlag==T" link="50" stubbed="0" >g_strPartyPasscodeFlag match "T"</result>
          </results>
        </action>
        <action id="55" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=3290 y=1750 ?>
          <!--SELF UNMUTE PARTY-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="g_strResponseTransactionId" message-name="s_strConfUnmutePartyEvent" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;callerPassCode&quot;" value="g_strCCGeneratedPassCode"/>
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="57" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: **** SELF UNMUTE ****");]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)

{

	Server.logError("ERROR: FAIL TO SEND SOAP MESSAGE UNMUTE YOUR OWN LINE.");

}]]></script>
          </scripts>
        </action>
        <action id="56" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=3271 y=1483 ?>
          <!--"ChangeToConferenceMode"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ChangeToConferenceMode&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="53" stubbed="1"/>
            <result name="SUCCESS" link="58" stubbed="0" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: MODIFY MEMBER TO UNMUTE.");

Session.g_oMS.bMuteFlag = false;]]></script>
          </scripts>
        </action>
        <action id="57" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=3536 y=1746 ?>
          <!--your line unmuted-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >s_nPromptUnmuted</audio>
          </play>
          <results >
            <result name="Default" link="88" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nPromptSelfMuteUnMute = 907;

Session.g_bMutedState = false;]]></script>
          </scripts>
        </action>
        <action id="58" plug-in="Pactolus.Branch.1" ><?xtml-editor x=3028 y=1635 ?>
          <!--CallPartyFlag==T?-->
          <results >
            <result name="Default" link="59" stubbed="0"/>
            <result name="g_strPartyPasscodeFlag==T" link="55" stubbed="0" >g_strPartyPasscodeFlag match "T"</result>
          </results>
        </action>
        <action id="59" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=3271 y=1617 ?>
          <!--SELF UNMUTE PARTY-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="g_strResponseTransactionId" message-name="s_strConfUnmutePartyEvent" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;callerPassCode&quot;" value="g_strCCGeneratedPassCode"/>
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="57" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: **** SELF UNMUTE ****");]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)

{

	Server.logError("ERROR: FAIL TO SEND SOAP MESSAGE UNMUTE YOUR OWN LINE.");

}]]></script>
          </scripts>
        </action>
        <action id="60" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=2556 y=1200 ?>
          <!--UnmutePartyRequest-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="s_strUnmutePartyRequest" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;callerPassCode&quot;" value="g_strCCGeneratedPassCode"/>
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="53" stubbed="1"/>
            <result name="Success" link="51" stubbed="1"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_disable_event();

Server.logInfo("INFO: **** UNMUTE PARTY REQUEST ****");]]></script>
          </scripts>
        </action>
        <action id="61" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1884 y=1254 ?>
          <!--your line has been muted-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="6" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;(*1)&quot;" language="g_strLanguage" digits="g_strUnmuteDigits" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >900</audio>
            <audio type="index" >355</audio>
            <audio type="index" >908</audio>
          </play>
          <results >
            <result name="Default" link="88" stubbed="1"/>
            <result name="Success" link="62" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="62" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2124 y=1251 ?>
          <!--what digit?-->
          <results >
            <result name="Default" link="88" stubbed="1"/>
            <result name="*6" link="54" stubbed="0" >g_strUnmuteDigits match "^\*{1}6{1}$"</result>
          </results>
        </action>
        <action id="63" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2737 y=300 ?>
          <!--set DTMF detection ON-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;SetDTMFOn&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="64" stubbed="0"/>
          </results>
        </action>
        <action id="64" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2960 y=300 ?>
          <results >
            <result name="Default" link="8" stubbed="0"/>
            <result name="Time &gt; 0" link="65" stubbed="0" >g_nCkReInviteTime &gt; 0</result>
          </results>
        </action>
        <action id="65" plug-in="Pactolus.Branch.1" ><?xtml-editor x=3208 y=400 ?>
          <!--Dial In?-->
          <results >
            <result name="Default" link="68" stubbed="0"/>
            <result name="g_strOutdialFlag = &quot;T&quot;" link="69" stubbed="0" >g_strOutdialFlag match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("END PRIVATE TALK, RESET TIMER TO CHECK FOR REINVITE");]]></script>
          </scripts>
        </action>
        <action id="68" plug-in="Standard.Timer.1" ><?xtml-editor x=3463 y=364 ?>
          <!--ck reInvite timer-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lCkReInviteTimerIdA" duration="g_nCkReInviteTime"/>
          <results >
            <result name="Default" link="8" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bCkReInviteTimerFlagA = true;
Server.logInfo("SET TIMER TO CHECK FOR REINVITE A LEG");]]></script>
          </scripts>
        </action>
        <action id="69" plug-in="Standard.Timer.1" ><?xtml-editor x=3481 y=480 ?>
          <!--ck reInvite timer B-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lCkReInviteTimerIdB" duration="g_nCkReInviteTime"/>
          <results >
            <result name="Default" link="8" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bCkReInviteTimerFlagB = true;
Server.logInfo("SET TIMER TO CHECK FOR REINVITE B LEG");]]></script>
          </scripts>
        </action>
        <action id="70" plug-in="Standard.Timer.1" ><?xtml-editor x=293 y=284 ?>
          <!--stop ck reInvite timer-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="0" id="g_lCkReInviteTimerIdA" duration=""/>
          <results >
            <result name="Default" link="5" stubbed="1"/>
          </results>
        </action>
        <action id="71" plug-in="Standard.Timer.1" ><?xtml-editor x=310 y=401 ?>
          <!--stop ck reInvite timer B-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="0" id="g_lCkReInviteTimerIdB" duration=""/>
          <results >
            <result name="Default" link="5" stubbed="0"/>
          </results>
        </action>
        <action id="72" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=3246 y=907 ?>
          <!--"ChangeToConferenceMode"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ChangeToConferenceMode&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="3" stubbed="1"/>
            <result name="SUCCESS" link="88" stubbed="0" >f_nReturnCode == s_nSuccess</result>
          </results>
        </action>
        <action id="73" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2207 y=745 ?>
          <!--play join as prompt-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;PlayJoinAsPrompt&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="36" stubbed="0"/>
          </results>
        </action>
        <action id="74" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2231 y=244 ?>
          <!--ConfMSConnectionIDChangedNotify-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ConfMSConnectionIDChangedNotify&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="9" stubbed="0"/>
          </results>
        </action>
        <action id="75" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1259 y=1519 ?>
          <!--get billing code?-->
          <results >
            <result name="Default" link="79" stubbed="0"/>
            <result name="g_strBillingCodeFlag==T" link="81" stubbed="0" >g_strBillingCodeFlag match "T"</result>
          </results>
        </action>
        <action id="76" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1774 y=1611 ?>
          <!--Collect billing code-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;(xxxxxxxxxx|x.T|x.#)&quot;" language="g_strLanguage" digits="g_strBillingCodeNumber" retry-count="g_nMaxRetryAllowed" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >943</audio>
            <audio type="index" >580</audio>
            <timeout-prompt type="index" >552</timeout-prompt>
          </play>
          <results >
            <result name="Default" link="77" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="77" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2026 y=1604 ?>
          <!--set billing code-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceSetBillingCode&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="78" stubbed="0"/>
          </results>
        </action>
        <action id="78" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2265 y=1601 ?>
          <!--"RecordCallerName"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;RecordCallerName&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="83" stubbed="0"/>
          </results>
        </action>
        <action id="79" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1514 y=1478 ?>
          <!--record name?-->
          <results >
            <result name="Default" link="16" stubbed="1"/>
            <result name="RecordNameFlag==&quot;T&quot;" link="80" stubbed="0" >g_strRecordNamesFlag match "T"</result>
          </results>
        </action>
        <action id="80" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1761 y=1473 ?>
          <!--"MSOutdialParty"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;MSOutdialParty&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oCallLegB</parameter>
            <parameter >g_oMS</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="16" stubbed="1"/>
            <result name="SUCCESS" link="78" stubbed="1" >f_nReturnCode == s_nSuccess</result>
            <result name="CALLER HUNGUP" link="42" stubbed="1" >f_nReturnCode == s_nCallerHungup</result>
          </results>
        </action>
        <action id="81" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1531 y=1620 ?>
          <!--"MSOutdialParty"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;MSOutdialParty&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oCallLegB</parameter>
            <parameter >g_oMS</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="16" stubbed="1"/>
            <result name="SUCCESS" link="76" stubbed="0" >f_nReturnCode == s_nSuccess</result>
            <result name="CALLER HUNGUP" link="42" stubbed="1" >f_nReturnCode == s_nCallerHungup</result>
          </results>
        </action>
        <action id="83" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2477 y=1599 ?>
          <!--DeleteMSConnection-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DeleteMSConnection&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="16" stubbed="1"/>
          </results>
        </action>
        <action id="84" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1653 y=1147 ?>
          <!--ModMutedThisParty?-->
          <results >
            <result name="Default" link="61" stubbed="0"/>
            <result name="g_strModeratorMutedFlag" link="85" stubbed="0" >g_strModeratorMutedFlag match "T"
OR g_strMuteFlag match "T"</result>
          </results>
        </action>
        <action id="85" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1883 y=1081 ?>
          <!--your line has been muted-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="6" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;(*1)&quot;" language="g_strLanguage" digits="g_strUnmuteDigits" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >900</audio>
          </play>
          <results >
            <result name="Default" link="88" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="87" plug-in="Pactolus.Branch.1" ><?xtml-editor x=3263 y=1033 ?>
          <!--event base conf?-->
          <results >
            <result name="Default" link="84" stubbed="1"/>
            <result name="g_nDnisIdentifiedConfFlag == 1" link="88" stubbed="1" >g_nDnisIdentifiedConfFlag == 1</result>
          </results>
        </action>
        <action id="88" plug-in="Pactolus.Branch.1" ><?xtml-editor x=3505 y=899 ?>
          <results >
            <result name="Default" link="29" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[// if (true == Session.g_bMuteThisParty || Session.g_strMuteFlag == "T")
if (true == Session.g_bMuteThisParty)
{
	Session.g_oMS.bMuteFlag = true;
	Session.g_bMutedState = true;
	Session.g_nPromptSelfMuteUnMute = 908;
	if ("T" == Session.g_strMuteFlag)
	{
		Session.g_bMutedByMod = true;
	}
	else
	{
		Session.g_bMutedByMod = false;
	}
}
else
{
	Session.g_oMS.bMuteFlag = false;
}
Session.g_oMS.bDeafFlag = false;]]></script>
          </scripts>
        </action>
      </actions>
      <text-objects >
        <text-object x-coord="217" y-coord="702" width="313" height="47" text="if private talk party, just remove from conf, hangup, and either repsone or not depend on flag" font-name="Times New Roman" size="-16" red="0" green="0" blue="0" weight="0" underline="0" strikeout="0" point-size="12" italic="0"/>
      </text-objects>
    </function>
    <function name="OnConfOperatorRequest" start="19" event="OnConfOperatorRequest" returns="void" >
      <parameters >
        <parameter name="strConferenceControllerIP" type="string" pass="byref"/>
        <parameter name="nConferenceControllerPort" type="i4" pass="byref"/>
        <parameter name="strTransactionId" type="string" pass="byref"/>
        <parameter name="nRequestType" type="i4" pass="byref"/>
      </parameters>
      <local-vars >
        <var name="f_nReturnCode" type="i4" >-50</var>
        <var name="f_bModeratorFlag" type="boolean" >0</var>
        <var name="f_oMSObject" type="object" ></var>
      </local-vars>
      <actions >
        <action id="19" plug-in="Pactolus.Branch.1" ><?xtml-editor x=115 y=118 ?>
          <!--operator assist type-->
          <results >
            <result name="Default" link="20" stubbed="0"/>
            <result name="(type 0 and mod) or type 1" link="17" stubbed="0" >((g_nOperatorAssistType == 0
AND g_strModeratorFlag == "T")
OR g_nOperatorAssistType == 1)
AND g_strACDEnable match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: OnConfOperatorRequest");]]></script>
          </scripts>
        </action>
        <action id="1" plug-in="Standard.Timer.1" ><?xtml-editor x=1154 y=472 ?>
          <!--play beep beep every 10 secs-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lBeepBeepTimerId" duration="s_nSleepTime"/>
          <results >
            <result name="Default" link="2" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bBeepBeepTimerFlag = true;]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.Timer.1" ><?xtml-editor x=162 y=655 ?>
          <!--set max wait time for CSR-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lWaitCSRTimerId" duration="s_nCsrHoldTime"/>
          <results >
            <result name="Default" link="11" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bWaitCSRTimerSet = true;]]></script>
          </scripts>
        </action>
        <action id="3" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=189 y=967 ?>
          <!--"CSRBeginRequest"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;CSRBeginRequest&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="10" stubbed="0"/>
            <result name="SUCCESS" link="8" stubbed="0" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_disable_event();

// Session.g_nCSRRouteReasonCode = Session.nRequestType;

if (1 == Session.nRequestType)

{

	Session.g_nCSRRouteReasonCode = 4;  //private talk with csr

	Session.g_strCSRRequestEndPoint = Session.g_oTempConf.strConferenceId;

}

else

{

	Session.g_nCSRRouteReasonCode = 3;  //mod zero out

	if (true == Session.g_bCurrentlyInSubConf)

	{

		Session.g_strCSRRequestEndPoint = Session.g_oSubConfMS.strConferenceId;

	}

	else

	{

		Session.g_strCSRRequestEndPoint = Session.g_oMS.strConferenceId;

	}

}]]></script>
          </scripts>
        </action>
        <action id="4" plug-in="Standard.Timer.1" ><?xtml-editor x=606 y=826 ?>
          <!--stop beep beep-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="0" id="g_lBeepBeepTimerId" duration=""/>
          <results >
            <result name="Default" link="5" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bBeepBeepTimerFlag = false;]]></script>
          </scripts>
        </action>
        <action id="5" plug-in="Standard.Timer.1" ><?xtml-editor x=823 y=822 ?>
          <!--stop max wait time for CSR-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="0" id="g_lWaitCSRTimerId" duration=""/>
          <results >
            <result name="Default" link="13" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bWaitCSRTimerSet = false;]]></script>
          </scripts>
        </action>
        <action id="6" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=916 y=428 ?>
          <!--CSR will join you shortly-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="f_oMSObject.strConnectionId" endpoint="f_oMSObject.strEndPoint" callid="f_oMSObject.strCallId" repeat="1" timeout="10" ms-type="f_oMSObject.strType" returns="" start-play="1" interrupt="0" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >1506</audio>
            <audio type="silence" >0.2</audio>
            <audio type="index" >340</audio>
          </play>
          <results >
            <result name="Default" link="1" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (true == Session.g_bCurrentlyInSubConf)

{

	Session.f_oMSObject = Session.g_oSubConfMS;

}

else

{

	Session.f_oMSObject = Session.g_oMS;

}]]></script>
          </scripts>
        </action>
        <action id="7" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1315 y=818 ?>
          <!--FAILURE request operator-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="strTransactionId" message-name="&quot;ConfOperatorResponse&quot;" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="s_nFailure"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
          </SOAP>
          <results >
            <result name="Default" link="9" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "FAIL TO REQUEST OPERATOR";]]></script>
          </scripts>
        </action>
        <action id="8" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=382 y=1064 ?>
          <!--SUCCESS request operator-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strConferenceControllerIP" transaction="strTransactionId" message-name="&quot;ConfOperatorResponse&quot;" destination-port="nConferenceControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="s_nSuccess"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
          </SOAP>
          <results >
            <result name="Default" link="9" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "SUCCESSFUL REQUEST OPERATOR";

if (1 == Session.nRequestType)

{

	Session.g_bSideBarOperatorRequest = true;

}

else

{

	Session.g_nCallerCurrentState = Session.s_nStateZeroOutToCsr;

	Session.g_bZeroOutToCSR = true;

}]]></script>
          </scripts>
        </action>
        <action id="9" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=618 y=1060 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="10" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=363 y=828 ?>
          <!--CSR can't be reach-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="f_oMSObject.strConnectionId" endpoint="f_oMSObject.strEndPoint" callid="f_oMSObject.strCallId" repeat="1" timeout="10" ms-type="f_oMSObject.strType" returns="" start-play="1" interrupt="0" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >1503</audio>
          </play>
          <results >
            <result name="Default" link="4" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="11" plug-in="Pactolus.Branch.1" ><?xtml-editor x=388 y=648 ?>
          <!--private talk-->
          <results >
            <result name="Default" link="3" stubbed="1"/>
            <result name="RequestType == 1" link="12" stubbed="0" >nRequestType == 1</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (1 == Session.nRequestType)

{

	Session.g_strRequestCSRPrivateTalkFlag = "T";

}

else

{

	Session.g_strRequestCSRPrivateTalkFlag = "F";

}]]></script>
          </scripts>
        </action>
        <action id="12" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=631 y=642 ?>
          <!--Create a temp Conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;CreateConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
          </function>
          <results >
            <result name="Default" link="10" stubbed="1"/>
            <result name="SUCCESS" link="3" stubbed="0" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_oTempConf.strConferenceId = "";]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Session.f_nReturnCode == Session.s_nSuccess)

{

	Session.g_bCreatedTempConf = true;

}]]></script>
          </scripts>
        </action>
        <action id="13" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1064 y=822 ?>
          <!--Delete a temp Conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DeleteConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
          </function>
          <results >
            <result name="Default" link="7" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[Session.g_bCreatedTempConf = false;]]></script>
          </scripts>
        </action>
        <action id="14" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=901 y=302 ?>
          <!--FAILURE request operator-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="strTransactionId" message-name="&quot;ConfOperatorResponse&quot;" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="s_nFailure"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
          </SOAP>
          <results >
            <result name="Default" link="16" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "FAIL TO REQUEST OPERATOR -- PARTICIPANT DOES NOT HAVE PRIVILEDGES OR CONFERENCE IS NOT PROVISIONED FOR OPERATOR ASSISTANCE";]]></script>
          </scripts>
        </action>
        <action id="15" plug-in="Pactolus.Branch.1" ><?xtml-editor x=679 y=340 ?>
          <!--operator assist type-->
          <results >
            <result name="Default" link="14" stubbed="0"/>
            <result name="(type 0 and mod) or type 1" link="6" stubbed="0" >(g_nOperatorAssistType == 0

AND f_bModeratorFlag == true)

OR g_nOperatorAssistType == 1</result>
            <result name="(type 0 and !mod) or type 2" link="14" stubbed="1" >(g_nOperatorAssistType == 0

AND f_bModeratorFlag == false)

OR g_nOperatorAssistType == 2</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if ("T" == Session.g_strModeratorFlag)

{

	Session.f_bModeratorFlag = true;

}

else

{

	Session.f_bModeratorFlag = false;

}

//request csr via API

Session.g_nRequestCSRType = 2;]]></script>
          </scripts>
        </action>
        <action id="16" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1110 y=301 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
        </action>
        <action id="17" plug-in="Pactolus.Branch.1" ><?xtml-editor x=378 y=215 ?>
          <!--currently in sub conf?-->
          <results >
            <result name="Default" link="15" stubbed="0"/>
            <result name="g_bCurrentlyInSubConf" link="18" stubbed="0" >g_bCurrentlyInSubConf == true</result>
          </results>
        </action>
        <action id="18" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=673 y=186 ?>
          <!--FAILURE request operator-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="strTransactionId" message-name="&quot;ConfOperatorResponse&quot;" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="s_nFailure"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
          </SOAP>
          <results >
            <result name="Default" link="16" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "FAIL TO REQUEST OPERATOR -- PARTICIPANT CURRENTLY IN SUB CONF";]]></script>
          </scripts>
        </action>
        <action id="20" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=364 y=80 ?>
          <!--FAILURE request operator-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="strTransactionId" message-name="&quot;ConfOperatorResponse&quot;" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="s_nFailure"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
          </SOAP>
          <results >
            <result name="Default" link="16" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("g_nOperatorAssistType IS: " + Session.g_nOperatorAssistType);
Server.logInfo("g_strModeratorFlag IS: " + Session.g_strModeratorFlag);
Server.logInfo("g_strACDEnable IS: " + Session.g_strACDEnable);

Session.g_strReturnMsg = "FAIL TO REQUEST OPERATOR -- EITHER ACD NOT ENABLE, OR USER IS NOT ALLOWED";]]></script>
          </scripts>
        </action>
      </actions>
    </function>
    <function name="OnConfCancelOperatorRequest" start="18" event="OnConfCancelOperatorRequest" returns="void" >
      <parameters >
        <parameter name="strConferenceControllerIP" type="string" pass="byref"/>
        <parameter name="nConferenceControllerPort" type="i4" pass="byref"/>
        <parameter name="strTransactionId" type="string" pass="byref"/>
      </parameters>
      <actions >
        <action id="18" plug-in="Pactolus.Branch.1" ><?xtml-editor x=230 y=686 ?>
          <!--BeginPrivateTalkAssignment-->
          <results >
            <result name="Default" link="6" stubbed="0"/>
            <result name="SideBarOp &amp;&amp; APIBeginAssignment" link="19" stubbed="0" >g_bSideBarOperatorRequest == true

AND g_bSentAPIBeginAssignment == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: OnConfCancelOperatorRequest");]]></script>
          </scripts>
        </action>
        <action id="3" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1132 y=623 ?>
          <!--"psAPISceEndRequest"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceEndRequest&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="9" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 1;]]></script>
          </scripts>
        </action>
        <action id="4" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1147 y=744 ?>
          <!--"psAPISceEndAssignment"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceEndAssignment&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="3" stubbed="1"/>
          </results>
        </action>
        <action id="5" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=906 y=620 ?>
          <!--s_strMSG_END_REQUEST_CSR-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strACDControllerIP" transaction="s_strZeroTransactionId" message-name="s_strMsgEndRequestCSR" destination-port="g_nACDControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;RequestId&quot;" value="g_lCSRRequestId"/>
            <parameter tag="&quot;AssignmentId&quot;" value="0"/>
          </SOAP>
          <results >
            <result name="Default" link="3" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[Session.g_bSentACDBeginRequest = false;]]></script>
          </scripts>
        </action>
        <action id="6" plug-in="Pactolus.Branch.1" ><?xtml-editor x=529 y=581 ?>
          <results >
            <result name="Default" link="9" stubbed="0"/>
            <result name="BeginRequest" link="5" stubbed="0" >g_nCallerCurrentState == s_nStateBeginRequest

OR g_nCallerCurrentState == s_nStateRouteToCsr

OR g_nCallerCurrentState == s_nStateZeroOutToCsr</result>
            <result name="BeginAssignment" link="7" stubbed="0" >g_nCallerCurrentState == s_nStateBeginAssignment

OR g_nCallerCurrentState == s_nStateCsrPutOnHold

OR g_nCallerCurrentState == s_nStateCsrPutOffHold</result>
            <result name="Requeue" link="8" stubbed="0" >g_nCallerCurrentState == s_nStateRequeue</result>
            <result name="ACDSendBeginRequest" link="17" stubbed="0" >g_bSentACDBeginRequest == true</result>
          </results>
        </action>
        <action id="7" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=906 y=752 ?>
          <!--s_strMSG_END_REQUEST_CSR-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strACDControllerIP" transaction="s_strZeroTransactionId" message-name="s_strMsgEndRequestCSR" destination-port="g_nACDControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;RequestId&quot;" value="g_lCSRRequestId"/>
            <parameter tag="&quot;AssignmentId&quot;" value="g_lCSRAssignmentId"/>
          </SOAP>
          <results >
            <result name="Default" link="4" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[Session.g_bSentACDBeginRequest = false;]]></script>
          </scripts>
        </action>
        <action id="8" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=900 y=902 ?>
          <!--s_strMSG_END_REQUEST_CSR-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strACDControllerIP" transaction="s_strZeroTransactionId" message-name="s_strMsgEndRequestCSR" destination-port="g_nACDControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;RequestId&quot;" value="g_lCSRRequestId"/>
            <parameter tag="&quot;AssignmentId&quot;" value="0"/>
          </SOAP>
          <results >
            <result name="Default" link="3" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[Session.g_bSentACDBeginRequest = false;]]></script>
          </scripts>
        </action>
        <action id="9" plug-in="Standard.Timer.1" ><?xtml-editor x=888 y=508 ?>
          <!--stop beep beep-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="0" id="g_lBeepBeepTimerId" duration=""/>
          <results >
            <result name="Default" link="10" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bBeepBeepTimerFlag = false;]]></script>
          </scripts>
        </action>
        <action id="10" plug-in="Standard.Timer.1" ><?xtml-editor x=1105 y=504 ?>
          <!--stop max wait time for CSR-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="0" id="g_lWaitCSRTimerId" duration=""/>
          <results >
            <result name="Default" link="12" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bWaitCSRTimerSet = false;]]></script>
          </scripts>
        </action>
        <action id="11" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1913 y=487 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
        </action>
        <action id="12" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1360 y=501 ?>
          <!--SUCCESS CANCEL request operator-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strConferenceControllerIP" transaction="strTransactionId" message-name="&quot;ConfCancelOperatorResponse&quot;" destination-port="nConferenceControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="s_nSuccess"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
          </SOAP>
          <results >
            <result name="Default" link="20" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "SUCCESSFUL CANCEL REQUEST OPERATOR";]]></script>
          </scripts>
        </action>
        <action id="13" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1397 y=1067 ?>
          <!--"psAPISceEndAssignment"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceEndAssignment&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="15" stubbed="0"/>
          </results>
        </action>
        <action id="14" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1135 y=1065 ?>
          <!--sent APIBeginAssignment?-->
          <results >
            <result name="Default" link="15" stubbed="1"/>
            <result name="g_bSentAPIBeginAssignment" link="13" stubbed="0" >g_bSentAPIBeginAssignment == true</result>
          </results>
        </action>
        <action id="15" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1616 y=1062 ?>
          <!--sent APIBeginRequest?-->
          <results >
            <result name="Default" link="9" stubbed="1"/>
            <result name="g_bSentAPIBeginRequest" link="16" stubbed="0" >g_bSentAPIBeginRequest == true</result>
          </results>
        </action>
        <action id="16" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1858 y=1056 ?>
          <!--"psAPISceEndRequest"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceEndRequest&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="9" stubbed="1"/>
          </results>
        </action>
        <action id="17" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=886 y=1070 ?>
          <!--s_strMSG_END_REQUEST_CSR-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strACDControllerIP" transaction="s_strZeroTransactionId" message-name="s_strMsgEndRequestCSR" destination-port="g_nACDControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;RequestId&quot;" value="g_lCSRRequestId"/>
            <parameter tag="&quot;AssignmentId&quot;" value="g_lCSRAssignmentId"/>
          </SOAP>
          <results >
            <result name="Default" link="14" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[Session.g_bSentACDBeginRequest = false;]]></script>
          </scripts>
        </action>
        <action id="19" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=547 y=848 ?>
          <!--FAILURE CANCEL request operator-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strConferenceControllerIP" transaction="strTransactionId" message-name="&quot;ConfCancelOperatorResponse&quot;" destination-port="nConferenceControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="s_nFailure"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
          </SOAP>
          <results >
            <result name="Default" link="11" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "FAIL TO CANCEL REQUEST OPERATOR BECAUSE ALREADY IN ASSIGNMENT FOR PRIVATE TALK WITH OPERATOR";]]></script>
          </scripts>
        </action>
        <action id="20" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1641 y=490 ?>
          <!--set DTMF Detection ON-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;SetDTMFOn&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="11" stubbed="0"/>
          </results>
        </action>
      </actions>
    </function>
    <function name="OnMediaserverDisconnected" start="1" event="OnMediaserverDisconnected" returns="void" >
      <parameters >
        <parameter name="strEndPoint" type="string" pass="byref"/>
        <parameter name="strConnectionId" type="string" pass="byref"/>
      </parameters>
      <actions >
        <action id="1" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=201 y=215 ?>
          <!--MediaServerFailure-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="&quot;MediaServerFailure&quot;" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;ConferenceId&quot;" value="g_strConfScheduleId"/>
          </SOAP>
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: OnMediaServerDisconnected");

Server.logError("RECEIVED Pactolus.MediaserverDisconnected.1");

Server.logError("End Point: " + Session.strEndPoint);

Server.logError("Connection Id: " + Session.strConnectionId);]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=536 y=217 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
        </action>
      </actions>
    </function>
    <function name="OnpsConfRemovePartyRequest" start="1" event="OnpsConfRemovePartyRequest" returns="void" >
      <parameters >
        <parameter name="strConfControllerIpAddress" type="string" pass="byref"/>
        <parameter name="nConfControllerPort" type="i4" pass="byref"/>
        <parameter name="strTransactionId" type="string" pass="byref"/>
        <parameter name="nTerminationReason" type="i4" pass="byref"/>
        <parameter name="lDisconnectTime" type="i8" pass="byref"/>
        <parameter name="strSendResponseBackFlag" type="string" pass="byref"/>
        <parameter name="strNotifyMS" type="string" pass="byref"/>
      </parameters>
      <local-vars >
        <var name="f_nReturnCode" type="i4" >-1</var>
        <var name="f_bAttemptDialOut" type="boolean" >0</var>
      </local-vars>
      <actions >
        <action id="1" plug-in="Pactolus.Branch.1" ><?xtml-editor x=68 y=358 ?>
          <!--attempt to dialout-->
          <results >
            <result name="Default" link="11" stubbed="0"/>
            <result name="27 &amp;&amp; sent conf join" link="8" stubbed="0" >nTerminationReason == 27
AND g_bSentPartyJoin == true</result>
            <result name="attempt to dialout == false" link="9" stubbed="0" >nTerminationReason == 27
AND f_bAttemptDialOut == false</result>
            <result name="g_bConfAlreadyRemoved == true" link="8" stubbed="1" >g_bConfAlreadyRemoved == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: OnpsConfRemovePartyRequest");
js_disable_event();

if (Session.g_bConfAlreadyRemoved == true)
{
	Server.logInfo("INFO: Conference has already been removed");
}

Session.g_nTerminationReason = Session.nTerminationReason;
Session.g_lEndTime = Session.lDisconnectTime;
Server.logInfo("INFO: RECEIVE REMOVE PARTY REQUEST FROM CONF CONTROLLER.");
Server.logInfo("INFO: Termination Reason: " + Session.nTerminationReason);
Server.logInfo("INFO: Conf Controller Port: " + Session.nConfControllerPort);
Server.logInfo("INFO: Conf Controller IP: " + Session.strConfControllerIpAddress);
Server.logInfo("INFO: Transaction Id: " + Session.strTransactionId);
Server.logInfo("INFO: Disconnect Time: " + Session.g_lEndTime);
Server.logInfo("INFO: Notify MS: " + Session.strNotifyMS);
if ("T" == Session.strNotifyMS)
{
	Session.g_bNotifyMS = true;
}
else
{
	Session.g_bNotifyMS = false;
}

Session.g_strConfControllerIP = Session.strConfControllerIpAddress;
Session.g_nConfControllerPort = Session.nConfControllerPort;
if ( true == Session.g_oCallLegB.bCurrentlyDialing || true == Session.g_oCallLegB.bAttemptedToOutdial )
{
	Session.f_bAttemptDialOut = true;
}
else
{
	Session.f_bAttemptDialOut = false;
}
if ("T" == Session.strSendResponseBackFlag || "t" == Session.strSendResponseBackFlag)
{
	Session.g_bSendMsgToCC = true;
}
else
{
	Session.g_bSendMsgToCC = false;
}]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1303 y=143 ?>
          <!--hangup caller-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpCaller&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="6" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nConfLeaveReason = 21;
Session.g_strConfLeaveMsg = "CC HANGUP PARTY";]]></script>
          </scripts>
        </action>
        <action id="4" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=639 y=463 ?>
          <!--SUCCESS to remove a call party-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="strTransactionId" message-name="s_strConfRemoveResponse" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="s_nSuccess"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
          </SOAP>
          <results >
            <result name="Default" link="6" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "SUCCESSFUL REMOVE PARTY FROM CONFERENCE";]]></script>
          </scripts>
        </action>
        <action id="5" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=614 y=303 ?>
          <!--FAILURE to remove a call party-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="strTransactionId" message-name="s_strConfRemoveResponse" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="s_nFailure"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
          </SOAP>
          <results >
            <result name="Default" link="7" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "FAILURE REMOVE PARTY FROM CONFERENCE";
if (Session.g_bConfAlreadyRemoved == true)
{
	Session.g_strReturnMsg = "Error: Conference has already been removed";
	Session.s_nFailure = Session.s_nConfAlreadyRemoved;
}
]]></script>
          </scripts>
        </action>
        <action id="6" plug-in="Standard.EndSession.1" ><?xtml-editor x=901 y=461 ?>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bConfAlreadyRemoved = true;
]]></script>
          </scripts>
        </action>
        <action id="7" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=831 y=303 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bConfAlreadyRemoved = true;
]]></script>
            <script language="javascript" timing="last" ><![CDATA[js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="8" plug-in="Pactolus.Branch.1" ><?xtml-editor x=360 y=310 ?>
          <!--send response back?-->
          <results >
            <result name="Default" link="7" stubbed="1"/>
            <result name="strSendResponseBackFlag" link="5" stubbed="0" >strSendResponseBackFlag match "T"</result>
          </results>
        </action>
        <action id="9" plug-in="Pactolus.Branch.1" ><?xtml-editor x=376 y=471 ?>
          <!--send response back?-->
          <results >
            <result name="Default" link="6" stubbed="1"/>
            <result name="strSendResponseBackFlag" link="4" stubbed="0" >strSendResponseBackFlag match "T"</result>
          </results>
        </action>
        <action id="10" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=536 y=159 ?>
          <!--Outdial canceled-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="g_strResponseTransactionId" message-name="s_strConfAddResponse" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="s_nOutdialCanceled"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
            <parameter tag="&quot;dialOutRequestId&quot;" value="g_lDialOutRequestId"/>
            <parameter tag="&quot;SIPCallId&quot;" value="g_oCallLegB.strCallId"/>
          </SOAP>
          <results >
            <result name="Default" link="13" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "Outdial canceled";]]></script>
          </scripts>
        </action>
        <action id="11" plug-in="Pactolus.Branch.1" ><?xtml-editor x=310 y=164 ?>
          <!--Dial In?-->
          <results >
            <result name="Default" link="13" stubbed="1"/>
            <result name="g_strOutdialFlag = &quot;T&quot;;" link="10" stubbed="0" >g_strOutdialFlag match "T"
AND nTerminationReason == 27</result>
          </results>
        </action>
        <action id="12" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1053 y=150 ?>
          <!--SUCCESS to remove a call party-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="strTransactionId" message-name="s_strConfRemoveResponse" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="s_nSuccess"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
          </SOAP>
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "SUCCESSFUL REMOVE PARTY FROM CONFERENCE";]]></script>
          </scripts>
        </action>
        <action id="13" plug-in="Pactolus.Branch.1" ><?xtml-editor x=790 y=158 ?>
          <!--send response back?-->
          <results >
            <result name="Default" link="2" stubbed="1"/>
            <result name="strSendResponseBackFlag" link="12" stubbed="0" >strSendResponseBackFlag match "T"</result>
          </results>
        </action>
      </actions>
      <text-objects >
        <text-object x-coord="49" y-coord="54" width="179" height="80" text="cancel (27) and outdialed, but not send a join" font-name="Times New Roman" size="-16" red="0" green="0" blue="0" weight="0" underline="0" strikeout="0" point-size="12" italic="0"/>
      </text-objects>
    </function>
    <function name="SideBarOperatorRequest" start="15" event="SideBarOperatorRequest" returns="i4" >
      <local-vars >
        <var name="f_nReturnCode" type="i4" >-1</var>
        <var name="f_oMSObject" type="object" ></var>
      </local-vars>
      <actions >
        <action id="15" plug-in="Pactolus.Branch.1" ><?xtml-editor x=151 y=250 ?>
          <!--event base conf?-->
          <results >
            <result name="Default" link="6" stubbed="0"/>
            <result name="g_nDnisIdentifiedConfFlag == 1" link="1" stubbed="1" >g_nDnisIdentifiedConfFlag == 1</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: SideBarOperatorRequest");
if (true == Session.g_bCurrentlyInSubConf)

{

	Session.f_oMSObject = Session.g_oSubConfMS;

}

else

{

	Session.f_oMSObject = Session.g_oMS;

}]]></script>
          </scripts>
        </action>
        <action id="1" plug-in="Standard.Timer.1" ><?xtml-editor x=631 y=244 ?>
          <!--play beep beep every 10 secs-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lBeepBeepTimerId" duration="s_nSleepTime"/>
          <results >
            <result name="Default" link="2" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bBeepBeepTimerFlag = true;]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.Timer.1" ><?xtml-editor x=877 y=243 ?>
          <!--set max wait time for CSR-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lWaitCSRTimerId" duration="s_nCsrHoldTime"/>
          <results >
            <result name="Default" link="11" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bWaitCSRTimerSet = true;]]></script>
          </scripts>
        </action>
        <action id="4" plug-in="Standard.Timer.1" ><?xtml-editor x=619 y=489 ?>
          <!--stop beep beep-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="0" id="g_lBeepBeepTimerId" duration=""/>
          <results >
            <result name="Default" link="5" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bBeepBeepTimerFlag = false;]]></script>
          </scripts>
        </action>
        <action id="5" plug-in="Standard.Timer.1" ><?xtml-editor x=836 y=485 ?>
          <!--stop max wait time for CSR-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="0" id="g_lWaitCSRTimerId" duration=""/>
          <results >
            <result name="Default" link="14" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bWaitCSRTimerSet = false;]]></script>
          </scripts>
        </action>
        <action id="6" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=387 y=247 ?>
          <!--CSR will join you shortly-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="f_oMSObject.strConnectionId" endpoint="f_oMSObject.strEndPoint" callid="f_oMSObject.strCallId" repeat="1" timeout="10" ms-type="f_oMSObject.strType" returns="" start-play="1" interrupt="0" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >962</audio>
            <audio type="silence" >0.2</audio>
            <audio type="index" >340</audio>
          </play>
          <results >
            <result name="Default" link="1" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="9" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=397 y=718 ?>
          <!--s_nSuccess-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nSuccess"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[//js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="10" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=379 y=490 ?>
          <!--CSR can't be reach-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="f_oMSObject.strConnectionId" endpoint="f_oMSObject.strEndPoint" callid="f_oMSObject.strCallId" repeat="1" timeout="10" ms-type="f_oMSObject.strType" returns="" start-play="1" interrupt="0" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >1503</audio>
          </play>
          <results >
            <result name="Default" link="4" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="11" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1091 y=287 ?>
          <!--Create a temp Conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;CreateConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
          </function>
          <results >
            <result name="Default" link="10" stubbed="1"/>
            <result name="SUCCESS" link="12" stubbed="0" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_oTempConf.strConferenceId = "";]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Session.f_nReturnCode == Session.s_nSuccess)

{

	Session.g_bCreatedTempConf = true;

}]]></script>
          </scripts>
        </action>
        <action id="12" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=139 y=582 ?>
          <!--"CSRBeginRequest"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;CSRBeginRequest&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="10" stubbed="0"/>
            <result name="SUCCESS" link="9" stubbed="0" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_disable_event();
Session.g_nCSRRouteReasonCode = 4;  //private talk with csr
Session.g_strCSRRequestEndPoint = Session.g_oTempConf.strConferenceId;]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (2 == Result.id)

{

	Session.g_bSideBarOperatorRequest = true;

}]]></script>
          </scripts>
        </action>
        <action id="13" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1372 y=475 ?>
          <!--s_nFailure-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nFailure"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="14" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1091 y=482 ?>
          <!--Delete a temp Conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DeleteConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
          </function>
          <results >
            <result name="Default" link="13" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[Session.g_bCreatedTempConf = false;]]></script>
          </scripts>
        </action>
      </actions>
    </function>
    <function name="TreatAsBye" start="23" event="TreatAsBye" returns="i4" >
      <parameters >
        <parameter name="p_strCallerId" type="string"/>
      </parameters>
      <local-vars >
        <var name="f_nReturnCode" type="i4" >-1</var>
      </local-vars>
      <actions >
        <action id="23" plug-in="Pactolus.Branch.1" ><?xtml-editor x=124 y=419 ?>
          <!--call id?-->
          <results >
            <result name="Default" link="5" stubbed="0"/>
            <result name="callid A, dial in" link="24" stubbed="0" >p_strCallerId match g_oCallLegA.strCallId</result>
            <result name="callid B, dial out" link="25" stubbed="0" >p_strCallerId match g_oCallLegB.strCallId</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: TreatAsBye");
js_disable_event();

Session.g_nTerminationReason = 1;

Session.g_lEndTime = Server.getUTCTime();]]></script>
          </scripts>
        </action>
        <action id="1" plug-in="Standard.EndSession.1" ><?xtml-editor x=1547 y=113 ?>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nCallerCurrentState = Session.s_nStateEndCall;]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1104 y=113 ?>
          <!--PARTY LEAVE-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;PartyLeave&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="7" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nConfLeaveReason = 0;
Session.g_strConfLeaveMsg = "PARTY HANGUP";]]></script>
          </scripts>
        </action>
        <action id="3" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=884 y=114 ?>
          <!--stop timer if needed-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;StopTimer&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="2" stubbed="0"/>
          </results>
        </action>
        <action id="4" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=950 y=1149 ?>
          <!--party declined to IVR-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="" transaction="" message-name="s_strIvrConfDeclineResponse" destination-port="" destination-type="3" destination-session="g_strIVRAddPartySessionId" waiting-session-selected="" xml-namespace=""/>
          <results >
            <result name="Default" link="7" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
        </action>
        <action id="5" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=331 y=386 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logError("ERROR: TREAT AS BYE, BUT NEITHER FROM A OR B");

Server.logError("ERROR: CALL Id : " + Session.p_strCallerId);

js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="6" plug-in="Pactolus.Branch.1" ><?xtml-editor x=635 y=899 ?>
          <!--dial out-->
          <results >
            <result name="Default" link="13" stubbed="1"/>
            <result name="g_bCurrentlyInSubConf" link="2" stubbed="1" >g_bCurrentlyInSubConf== true</result>
            <result name="g_bPrivateTalkInConference" link="16" stubbed="0" >g_bPrivateTalkInConference == true</result>
            <result name="web dial out and in ms" link="9" stubbed="0" >g_bWebDialOut == true

AND g_oMS.bCurrentlyConnected == true

AND g_bSentPartyJoin == false</result>
            <result name="IVR dial out and in temp conf" link="4" stubbed="0" >g_bIVRDialOut == true

AND g_oTempConf.bCurrentlyInConf == true

AND g_bSentPartyJoin == false</result>
          </results>
        </action>
        <action id="7" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1334 y=113 ?>
          <!--adding party?-->
          <results >
            <result name="Default" link="1" stubbed="0"/>
            <result name="adding party == true" link="8" stubbed="0" >g_bAddingParty == true</result>
          </results>
        </action>
        <action id="8" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1566 y=190 ?>
          <!--send IVRConfRemoveAddParty-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="" transaction="" message-name="s_strIvrConfRemovePartyRequest" destination-port="" destination-type="3" destination-session="g_strAddPartySessionId" waiting-session-selected="" xml-namespace=""/>
          <results >
            <result name="Default" link="1" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("SEND TO session Id is: " + Session.g_strAddPartySessionId);]]></script>
          </scripts>
        </action>
        <action id="9" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=946 y=988 ?>
          <!--party declined to WEB-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="g_strResponseTransactionId" message-name="s_strConfAddResponse" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="902"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
            <parameter tag="&quot;dialOutRequestId&quot;" value="g_lDialOutRequestId"/>
            <parameter tag="&quot;SIPCallId&quot;" value="g_oCallLegB.strCallId"/>
          </SOAP>
          <results >
            <result name="Default" link="7" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "OUTDIAL: PARTY DECLINED";]]></script>
          </scripts>
        </action>
        <action id="10" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1181 y=231 ?>
          <!--"psAPISceEndRequest"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceEndRequest&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="3" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 1;]]></script>
          </scripts>
        </action>
        <action id="11" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1192 y=373 ?>
          <!--"psAPISceEndAssignment"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceEndAssignment&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="10" stubbed="1"/>
          </results>
        </action>
        <action id="12" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=949 y=231 ?>
          <!--s_strMSG_END_REQUEST_CSR-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strACDControllerIP" transaction="s_strZeroTransactionId" message-name="s_strMsgEndRequestCSR" destination-port="g_nACDControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;RequestId&quot;" value="g_lCSRRequestId"/>
            <parameter tag="&quot;AssignmentId&quot;" value="0"/>
          </SOAP>
          <results >
            <result name="Default" link="10" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[Session.g_bSentACDBeginRequest = false;]]></script>
          </scripts>
        </action>
        <action id="13" plug-in="Pactolus.Branch.1" ><?xtml-editor x=633 y=263 ?>
          <results >
            <result name="Default" link="3" stubbed="0"/>
            <result name="BeginRequest" link="12" stubbed="0" >g_nCallerCurrentState == s_nStateBeginRequest

OR g_nCallerCurrentState == s_nStateRouteToCsr

OR g_nCallerCurrentState == s_nStateZeroOutToCsr</result>
            <result name="BeginAssignment" link="14" stubbed="0" >g_nCallerCurrentState == s_nStateBeginAssignment

OR g_nCallerCurrentState == s_nStateCsrPutOnHold

OR g_nCallerCurrentState == s_nStateCsrPutOffHold</result>
            <result name="Requeue" link="15" stubbed="0" >g_nCallerCurrentState == s_nStateRequeue</result>
            <result name="SentACDBeginRequest" link="22" stubbed="0" >g_bSentACDBeginRequest == true</result>
          </results>
        </action>
        <action id="14" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=964 y=376 ?>
          <!--s_strMSG_END_REQUEST_CSR-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strACDControllerIP" transaction="s_strZeroTransactionId" message-name="s_strMsgEndRequestCSR" destination-port="g_nACDControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;RequestId&quot;" value="g_lCSRRequestId"/>
            <parameter tag="&quot;AssignmentId&quot;" value="g_lCSRAssignmentId"/>
          </SOAP>
          <results >
            <result name="Default" link="11" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[Session.g_bSentACDBeginRequest = false;]]></script>
          </scripts>
        </action>
        <action id="15" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=958 y=526 ?>
          <!--s_strMSG_END_REQUEST_CSR-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strACDControllerIP" transaction="s_strZeroTransactionId" message-name="s_strMsgEndRequestCSR" destination-port="g_nACDControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;RequestId&quot;" value="g_lCSRRequestId"/>
            <parameter tag="&quot;AssignmentId&quot;" value="0"/>
          </SOAP>
          <results >
            <result name="Default" link="10" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[Session.g_bSentACDBeginRequest = false;]]></script>
          </scripts>
        </action>
        <action id="16" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=914 y=864 ?>
          <!--PrivateTalkHangup-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="&quot;PrivateTalkHangup&quot;" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;ConferenceId&quot;" value="g_strConfScheduleId"/>
            <parameter tag="&quot;moderatorKey&quot;" value="g_strModeratorKey"/>
          </SOAP>
          <results >
            <result name="Default" link="17" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "PRIVATE TALK HANGUP";

Server.logInfo("SENDING PrivateTalkHangup TO CONFERENCE CONTROLLER");]]></script>
            <script language="javascript" timing="last" ><![CDATA[Session.g_bPrivateTalkInConference = false;]]></script>
          </scripts>
        </action>
        <action id="17" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1170 y=866 ?>
          <!--Remove member from temp conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;RemoveMemberFromConference&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
          </function>
          <results >
            <result name="Default" link="7" stubbed="1"/>
          </results>
        </action>
        <action id="18" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1458 y=667 ?>
          <!--"psAPISceEndAssignment"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceEndAssignment&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="20" stubbed="0"/>
          </results>
        </action>
        <action id="19" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1196 y=665 ?>
          <!--sent APIBeginAssignment?-->
          <results >
            <result name="Default" link="20" stubbed="1"/>
            <result name="g_bSentAPIBeginAssignment" link="18" stubbed="0" >g_bSentAPIBeginAssignment == true</result>
          </results>
        </action>
        <action id="20" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1677 y=662 ?>
          <!--sent APIBeginRequest?-->
          <results >
            <result name="Default" link="3" stubbed="1"/>
            <result name="g_bSentAPIBeginRequest" link="21" stubbed="0" >g_bSentAPIBeginRequest == true</result>
          </results>
        </action>
        <action id="21" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1901 y=657 ?>
          <!--"psAPISceEndRequest"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceEndRequest&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="3" stubbed="1"/>
          </results>
        </action>
        <action id="22" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=947 y=670 ?>
          <!--s_strMSG_END_REQUEST_CSR-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strACDControllerIP" transaction="s_strZeroTransactionId" message-name="s_strMsgEndRequestCSR" destination-port="g_nACDControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;RequestId&quot;" value="g_lCSRRequestId"/>
            <parameter tag="&quot;AssignmentId&quot;" value="g_lCSRAssignmentId"/>
          </SOAP>
          <results >
            <result name="Default" link="19" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[Session.g_bSentACDBeginRequest = false;]]></script>
          </scripts>
        </action>
        <action id="24" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=355 y=478 ?>
          <!--HangUpPartyA-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpParty&quot;" return="f_nReturnCode" external-function="1" library="lib_callcontrol.xml" >
            <parameter >g_oCallLegA</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="13" stubbed="0"/>
          </results>
        </action>
        <action id="25" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=364 y=599 ?>
          <!--HangUpPartyB-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpParty&quot;" return="f_nReturnCode" external-function="1" library="lib_callcontrol.xml" >
            <parameter >g_oCallLegB</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="6" stubbed="0"/>
          </results>
        </action>
      </actions>
    </function>
    <function name="OnConfAddToSubConfRequest" start="53" event="OnConfAddToSubConfRequest" returns="void" >
      <parameters >
        <parameter name="p_strConfControllerIP" type="string" pass="byref"/>
        <parameter name="p_nConfControllerPort" type="i4" pass="byref"/>
        <parameter name="p_strTransactionId" type="string" pass="byref"/>
        <parameter name="p_strCallerPassCode" type="string" pass="byref"/>
        <parameter name="p_strSubConfId" type="string" pass="byref"/>
        <parameter name="p_strSubConfModeratorFlag" type="string" pass="byref"/>
        <parameter name="p_strSubConferenceEndPoint" type="string" pass="byref"/>
        <parameter name="p_nAudioMode" type="i4" pass="byref"/>
      </parameters>
      <local-vars >
        <var name="f_nReturnCode" type="i4" >-1</var>
        <var name="f_bCreateSubConference" type="boolean" >0</var>
        <var name="strEndpointPlusConnectionId" type="string" ></var>
        <var name="nEndCall" type="i4" >-4</var>
      </local-vars>
      <actions >
        <action id="53" plug-in="Pactolus.Branch.1" ><?xtml-editor x=107 y=283 ?>
          <results >
            <result name="Default" link="1" stubbed="0"/>
            <result name="HandRaised?" link="52" stubbed="0" >g_bPartyHandRaised == true</result>
            <result name="Request private talk with CSR?" link="58" stubbed="0" >g_bEBCRequestPrivateCSR == true</result>
            <result name="Request CSR into conference?" link="74" stubbed="0" >g_bEBCRequestCSR == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: OnConfAddToSubConfRequest");
js_disable_event();

Server.logInfo("CONF ADD PARTY TO SUB CONFERENCE");
Server.logInfo("p_strSubConfId  : " + Session.p_strSubConfId);
Server.logInfo("p_strSubConfModeratorFlag  : " + Session.p_strSubConfModeratorFlag);
Server.logInfo("p_strSubConferenceEndPoint  : " + Session.p_strSubConferenceEndPoint);
Server.logInfo("p_nAudioMode  : " + Session.p_nAudioMode);
Session.g_strSubConfModeratorFlag = Session.p_strSubConfModeratorFlag;
Server.logInfo("INIT SUB CONFERENCE OBJECT");
Session.g_oSubConfMS = js_initMS(Session.g_oSubConfMS, Session.s_strConfMsType);
Session.g_oSubConfMS.bPersistentFlag = true;
//ASN
Session.g_oSubConfMS.nNbrActiveSpeakers = Session.s_nNbrActiveSpeakers;
Session.g_oSubConfMS.nReportingInterval = Session.s_nReportingInterval;
Session.g_oSubConfMS.nDBThreshold = Session.s_nDBThreshold;
//AGC
Session.g_oSubConfMS.nAGCTargetLevelIn = Session.s_nAGCTargetLevelIn;
Session.g_oSubConfMS.nAGCMaxLevelIn = Session.s_nAGCMaxLevelIn;
Session.g_oSubConfMS.nAGCTargetLevelOut = Session.s_nAGCTargetLevelOut;
Session.g_oSubConfMS.nAGCMaxLevelOut = Session.s_nAGCMaxLevelOut;

if (0 == Session.p_strSubConferenceEndPoint.length)
{
	Session.g_bNullString = true;
	Session.f_bCreateSubConference = true;
}
else
{
	Session.g_oSubConfMS.strConferenceId = Session.p_strSubConferenceEndPoint;
	Session.g_bNullString = false;
	Session.f_bCreateSubConference = false;
}
Server.logInfo("Party raise hand flag  : " + Session.g_bPartyHandRaised);
Server.logInfo("Party request private talk with CSR flag  : " + Session.g_bEBCRequestPrivateCSR);
Server.logInfo("Party request to bring CSR into conference flag  : " + Session.g_bEBCRequestCSR);]]></script>
          </scripts>
        </action>
        <action id="1" plug-in="Pactolus.Branch.1" ><?xtml-editor x=471 y=285 ?>
          <results >
            <result name="Default" link="6" stubbed="0"/>
            <result name="g_bHoldState" link="42" stubbed="1" >g_bHoldState == true</result>
            <result name="g_bCurrentlyInMMenu" link="20" stubbed="0" >g_bCurrentlyInMMenu == true</result>
          </results>
        </action>
        <action id="2" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=785 y=384 ?>
          <!--fail to add to sub conf-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="p_strConfControllerIP" transaction="p_strTransactionId" message-name="s_strConfAddToSubConfResponse" destination-port="p_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;Status&quot;" value="s_nFailure"/>
            <parameter tag="&quot;StatusMessage&quot;" value="g_strReturnMsg"/>
            <parameter tag="&quot;Endpoint&quot;" value="p_strSubConferenceEndPoint"/>
            <parameter tag="&quot;CallerPassCode&quot;" value="p_strCallerPassCode"/>
            <parameter tag="&quot;ConnectionId&quot;" value="g_oSubConfMS.strConnectionId"/>
          </SOAP>
          <results >
            <result name="Default" link="16" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "NOT FIRST PARTICIPANT, BUT THERE IS NO ENDPOINT";]]></script>
          </scripts>
        </action>
        <action id="3" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1277 y=577 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="4" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1265 y=116 ?>
          <!--"MoveFromMainConfToSubConf"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;MoveFromMainConfToSubConf&quot;" return="f_nReturnCode" external-function="1" library="lib_utils.xml" >
            <parameter >f_bCreateSubConference</parameter>
            <parameter >g_oMS</parameter>
            <parameter >g_oSubConfMS</parameter>
            <parameter >g_oCallLegA</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="5" stubbed="0"/>
            <result name="CALLER HUNGUP" link="9" stubbed="0" >f_nReturnCode == s_nCallerHungup</result>
            <result name="SUCCESS" link="8" stubbed="1" >f_nReturnCode == s_nSuccess</result>
            <result name="EndCall" link="78" stubbed="1" >f_nReturnCode == nEndCall</result>
          </results>
        </action>
        <action id="5" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1505 y=84 ?>
          <!--fail to add to sub conf-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="p_strConfControllerIP" transaction="p_strTransactionId" message-name="s_strConfAddToSubConfResponse" destination-port="p_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;Status&quot;" value="s_nFailure"/>
            <parameter tag="&quot;StatusMessage&quot;" value="g_strReturnMsg"/>
            <parameter tag="&quot;Endpoint&quot;" value="p_strSubConferenceEndPoint"/>
            <parameter tag="&quot;CallerPassCode&quot;" value="p_strCallerPassCode"/>
            <parameter tag="&quot;ConnectionId&quot;" value="g_oMS.strConnectionId"/>
          </SOAP>
          <results >
            <result name="Default" link="16" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "UNABLE TO ADD PARTICIPANT INTO SUB CONFERENCE";]]></script>
          </scripts>
        </action>
        <action id="6" plug-in="Pactolus.Branch.1" ><?xtml-editor x=777 y=239 ?>
          <!--Dial In?-->
          <results >
            <result name="Default" link="14" stubbed="0"/>
            <result name="g_strOutdialFlag = &quot;T&quot;;" link="19" stubbed="0" >g_strOutdialFlag match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (0 == Session.p_nAudioMode)
{
	Session.g_oSubConfMS.bMuteFlag = false;
	Session.g_oSubConfMS.bDeafFlag = false;
}
else if (2 == Session.p_nAudioMode)
{
	Session.g_oSubConfMS.bMuteFlag = true;
	Session.g_oSubConfMS.bDeafFlag = false;
}
else if (1 == Session.p_nAudioMode)
{
	Session.g_oSubConfMS.bMuteFlag = true;
	Session.g_oSubConfMS.bDeafFlag = true;
}]]></script>
          </scripts>
        </action>
        <action id="7" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1281 y=349 ?>
          <!--"MoveFromMainConfToSubConf"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;MoveFromMainConfToSubConf&quot;" return="f_nReturnCode" external-function="1" library="lib_utils.xml" >
            <parameter >f_bCreateSubConference</parameter>
            <parameter >g_oMS</parameter>
            <parameter >g_oSubConfMS</parameter>
            <parameter >g_oCallLegB</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="5" stubbed="1"/>
            <result name="CALLER HUNGUP" link="9" stubbed="1" >f_nReturnCode == s_nCallerHungup</result>
            <result name="SUCCESS" link="8" stubbed="0" >f_nReturnCode == s_nSuccess</result>
            <result name="EndCall" link="78" stubbed="1" >f_nReturnCode == nEndCall</result>
          </results>
        </action>
        <action id="8" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1538 y=344 ?>
          <!--success to add to sub conf-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="p_strConfControllerIP" transaction="p_strTransactionId" message-name="s_strConfAddToSubConfResponse" destination-port="p_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;Status&quot;" value="s_nSuccess"/>
            <parameter tag="&quot;StatusMessage&quot;" value="g_strReturnMsg"/>
            <parameter tag="&quot;Endpoint&quot;" value="g_oSubConfMS.strConferenceId"/>
            <parameter tag="&quot;CallerPassCode&quot;" value="p_strCallerPassCode"/>
            <parameter tag="&quot;ConnectionId&quot;" value="strEndpointPlusConnectionId"/>
          </SOAP>
          <results >
            <result name="Default" link="21" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "SUCCESS ADD PARTICIPANT INTO SUB CONFERENCE";
Session.g_strSubConferenceId = Session.p_strSubConfId;
Session.g_bCurrentlyInSubConf = true;
Session.g_lSubConferenceJoinTime = Server.getUTCTime();
Session.strEndpointPlusConnectionId = Session.g_oSubConfMS.strEndPoint + "#" + Session.g_oSubConfMS.strConnectionId;
if (0 == Session.p_nAudioMode)
{
	Session.g_bHoldState = false;
	Session.g_bMutedState = false;
}
else if (2 == Session.p_nAudioMode)
{
	Session.g_bHoldState = false;
	Session.g_bMutedState = true;
}
else if (1 == Session.p_nAudioMode)
{
	Session.g_bHoldState = true;
	Session.g_bMutedState = false;
}]]></script>
          </scripts>
        </action>
        <action id="9" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1524 y=206 ?>
          <!--fail to add to sub conf-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="p_strConfControllerIP" transaction="p_strTransactionId" message-name="s_strConfAddToSubConfResponse" destination-port="p_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;Status&quot;" value="s_nFailure"/>
            <parameter tag="&quot;StatusMessage&quot;" value="g_strReturnMsg"/>
            <parameter tag="&quot;Endpoint&quot;" value="p_strSubConferenceEndPoint"/>
            <parameter tag="&quot;CallerPassCode&quot;" value="p_strCallerPassCode"/>
            <parameter tag="&quot;ConnectionId&quot;" value="g_oMS.strConnectionId"/>
          </SOAP>
          <results >
            <result name="Default" link="10" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "UNABLE TO ADD PARTICIPANT INTO SUB CONFERENCE, CALLER HUNG UP";]]></script>
          </scripts>
        </action>
        <action id="10" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1746 y=202 ?>
          <!--Send party leave-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;PartyLeave&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="11" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nConfLeaveReason = 0;
Session.g_strConfLeaveMsg = "PARTY HANGUP WHILE TRYING TO MOVE FROM MAIN TO SUB";]]></script>
          </scripts>
        </action>
        <action id="11" plug-in="Standard.EndSession.1" ><?xtml-editor x=1975 y=201 ?></action>
        <action id="12" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1978 y=329 ?>
          <!--"SetDTMFOn"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;SetDTMFOn&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="16" stubbed="1"/>
          </results>
        </action>
        <action id="13" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=955 y=726 ?>
          <!--fail to add to sub conf-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="p_strConfControllerIP" transaction="p_strTransactionId" message-name="s_strConfAddToSubConfResponse" destination-port="p_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;Status&quot;" value="s_nFailure"/>
            <parameter tag="&quot;StatusMessage&quot;" value="g_strReturnMsg"/>
            <parameter tag="&quot;Endpoint&quot;" value="p_strSubConferenceEndPoint"/>
            <parameter tag="&quot;CallerPassCode&quot;" value="p_strCallerPassCode"/>
            <parameter tag="&quot;ConnectionId&quot;" value="g_oSubConfMS.strConnectionId"/>
          </SOAP>
          <results >
            <result name="Default" link="16" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "PARTICIPANT CURRENTLY ON HOLD, CURRENTLY IN SUB CONF OR IN PRIVATE TALK, CAN'T MOVE HIM TO SUB";]]></script>
          </scripts>
        </action>
        <action id="14" plug-in="Standard.Timer.1" ><?xtml-editor x=1011 y=115 ?>
          <!--stop ck reInvite timer-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="0" id="g_lCkReInviteTimerIdA" duration=""/>
          <results >
            <result name="Default" link="4" stubbed="0"/>
          </results>
        </action>
        <action id="15" plug-in="Standard.Timer.1" ><?xtml-editor x=1540 y=642 ?>
          <!--ck reInvite timer-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lCkReInviteTimerIdA" duration="g_nCkReInviteTime"/>
          <results >
            <result name="Default" link="3" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bCkReInviteTimerFlagA = true;
Server.logInfo("SET TIMER TO CHECK FOR REINVITE A LEG");]]></script>
          </scripts>
        </action>
        <action id="16" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1022 y=606 ?>
          <results >
            <result name="Default" link="3" stubbed="0"/>
            <result name="Time &gt; 0" link="17" stubbed="0" >g_nCkReInviteTime &gt; 0</result>
          </results>
        </action>
        <action id="17" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1294 y=687 ?>
          <!--Dial In?-->
          <results >
            <result name="Default" link="15" stubbed="0"/>
            <result name="g_strOutdialFlag = &quot;T&quot;" link="18" stubbed="0" >g_strOutdialFlag match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("MOVED TO SUB CONF, RESET TIMER TO CHECK FOR REINVITE");]]></script>
          </scripts>
        </action>
        <action id="18" plug-in="Standard.Timer.1" ><?xtml-editor x=1557 y=773 ?>
          <!--ck reInvite timer B-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lCkReInviteTimerIdB" duration="g_nCkReInviteTime"/>
          <results >
            <result name="Default" link="3" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bCkReInviteTimerFlagB = true;
Server.logInfo("SET TIMER TO CHECK FOR REINVITE B LEG");]]></script>
          </scripts>
        </action>
        <action id="19" plug-in="Standard.Timer.1" ><?xtml-editor x=1029 y=348 ?>
          <!--stop ck reInvite timer B-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="0" id="g_lCkReInviteTimerIdB" duration=""/>
          <results >
            <result name="Default" link="7" stubbed="0"/>
          </results>
        </action>
        <action id="20" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=781 y=517 ?>
          <!--fail to add to sub conf while in main menu-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="p_strConfControllerIP" transaction="p_strTransactionId" message-name="s_strConfAddToSubConfResponse" destination-port="p_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;Status&quot;" value="s_nFailure"/>
            <parameter tag="&quot;StatusMessage&quot;" value="g_strReturnMsg"/>
            <parameter tag="&quot;Endpoint&quot;" value="p_strSubConferenceEndPoint"/>
            <parameter tag="&quot;CallerPassCode&quot;" value="p_strCallerPassCode"/>
            <parameter tag="&quot;ConnectionId&quot;" value="g_oSubConfMS.strConnectionId"/>
          </SOAP>
          <results >
            <result name="Default" link="16" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "CAN NOT JOIN SUBCONFERENCE WHILE IN IVR MAIN MENU";]]></script>
          </scripts>
        </action>
        <action id="21" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1761 y=331 ?>
          <!--AudioMode == Hold-->
          <results >
            <result name="Default" link="12" stubbed="0"/>
            <result name="p_nAudioMode == 1" link="22" stubbed="0" >p_nAudioMode == 1</result>
          </results>
        </action>
        <action id="22" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1993 y=436 ?>
          <!--MOH?-->
          <results >
            <result name="Default" link="23" stubbed="0"/>
            <result name="g_strMusicOnHoldFlag==&quot;T&quot;" link="26" stubbed="0" >g_strMusicOnHoldFlag match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bDontPlayContinueToHold = true;]]></script>
          </scripts>
        </action>
        <action id="23" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2233 y=431 ?>
          <!--please hold-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oSubConfMS.strConnectionId" endpoint="g_oSubConfMS.strEndPoint" callid="g_oSubConfMS.strCallId" repeat="1" timeout="10" ms-type="g_oSubConfMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >898</audio>
          </play>
          <results >
            <result name="Default" link="24" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="24" plug-in="Standard.Timer.1" ><?xtml-editor x=2471 y=429 ?>
          <!--play please hold every 10 secs-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lHoldTimerId" duration="s_nSleepTime"/>
          <results >
            <result name="Default" link="3" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bHoldTimerFlag = true;]]></script>
          </scripts>
        </action>
        <action id="26" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2249 y=593 ?>
          <!--Remove member from conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;RemoveMemberFromConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oSubConfMS</parameter>
          </function>
          <results >
            <result name="Default" link="27" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: CONF HOLD PARTY REQUEST, REMOVE MEMBER FROM CONFERENCE.");]]></script>
          </scripts>
        </action>
        <action id="27" plug-in="Standard.Timer.1" ><?xtml-editor x=2469 y=591 ?>
          <!--5 secs to connect MOH-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lMOHTimerId" duration="s_nPreMohTime"/>
          <results >
            <result name="Default" link="3" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bMOHTimerFlag = true;]]></script>
          </scripts>
        </action>
        <action id="28" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=495 y=929 ?>
          <!--"StopTimer"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;StopTimer&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="29" stubbed="0"/>
          </results>
        </action>
        <action id="29" plug-in="Pactolus.Branch.1" ><?xtml-editor x=722 y=927 ?>
          <!--MOH?-->
          <results >
            <result name="Default" link="6" stubbed="1"/>
            <result name="g_strMusicOnHoldFlag==&quot;T&quot;" link="46" stubbed="0" >g_strMusicOnHoldFlag match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bDontPlayContinueToHold = true;]]></script>
          </scripts>
        </action>
        <action id="30" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1147 y=920 ?>
          <!--Dial In?-->
          <results >
            <result name="Default" link="31" stubbed="0"/>
            <result name="g_strOutdialFlag = &quot;T&quot;;" link="32" stubbed="0" >g_strOutdialFlag match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_oMS.bMuteFlag = true;
Session.g_oMS.bDeafFlag = true;]]></script>
          </scripts>
        </action>
        <action id="31" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1391 y=888 ?>
          <!--AddMemberToConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
            <parameter >g_oCallLegA</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="6" stubbed="1"/>
            <result name="FAILURE" link="48" stubbed="0" >f_nReturnCode == s_nFailure</result>
            <result name="CALLERHUNGUP" link="49" stubbed="0" >f_nReturnCode == s_nCallerHungup</result>
          </results>
        </action>
        <action id="32" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1408 y=1085 ?>
          <!--AddMemberToConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
            <parameter >g_oCallLegB</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="6" stubbed="1"/>
            <result name="FAILURE" link="48" stubbed="1" >f_nReturnCode == s_nFailure</result>
            <result name="CALLERHUNGUP" link="49" stubbed="0" >f_nReturnCode == s_nCallerHungup</result>
          </results>
        </action>
        <action id="33" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1908 y=1079 ?>
          <!--"PartyLeave"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;PartyLeave&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="47" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nConfLeaveReason = 0;
Session.g_strConfLeaveMsg = "PARTY HANGUP WHILE TRYING TO ADD MEMBER TO CONFERENCE";]]></script>
          </scripts>
        </action>
        <action id="41" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1890 y=882 ?>
          <!--HangUp Caller-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpCaller&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="47" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 35;
Session.g_nConfLeaveReason = 9;
Session.g_strConfLeaveMsg = "FAIL TO ADD PARTY TO CONFERENCE";]]></script>
          </scripts>
        </action>
        <action id="42" plug-in="Pactolus.Branch.1" ><?xtml-editor x=705 y=731 ?>
          <!--in sub conf?-->
          <results >
            <result name="Default" link="28" stubbed="0"/>
            <result name="g_bCurrentlyInSubConf" link="13" stubbed="0" >g_bCurrentlyInSubConf == true</result>
            <result name="g_bSideBarOperatorRequest" link="13" stubbed="1" >g_bSideBarOperatorRequest == true
AND g_bTalkingWithCSR == true</result>
          </results>
        </action>
        <action id="43" plug-in="Pactolus.Branch.1" ><?xtml-editor x=500 y=732 ?>
          <!--already on hold
add to sub audio mode == hold-->
          <results >
            <result name="Default" link="42" stubbed="0"/>
            <result name="p_nAudioMode == 1" link="28" stubbed="1" >p_nAudioMode == 1</result>
          </results>
        </action>
        <action id="46" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=938 y=924 ?>
          <!--"DisconnectFromMOH"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DisconnectFromMOH&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="30" stubbed="0"/>
          </results>
        </action>
        <action id="47" plug-in="Standard.EndSession.1" ><?xtml-editor x=2123 y=880 ?></action>
        <action id="48" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1653 y=883 ?>
          <!--fail to add to sub conf-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="p_strConfControllerIP" transaction="p_strTransactionId" message-name="s_strConfAddToSubConfResponse" destination-port="p_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;Status&quot;" value="s_nFailure"/>
            <parameter tag="&quot;StatusMessage&quot;" value="g_strReturnMsg"/>
            <parameter tag="&quot;Endpoint&quot;" value="p_strSubConferenceEndPoint"/>
            <parameter tag="&quot;CallerPassCode&quot;" value="p_strCallerPassCode"/>
            <parameter tag="&quot;ConnectionId&quot;" value="g_oSubConfMS.strConnectionId"/>
          </SOAP>
          <results >
            <result name="Default" link="41" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "FAIL TO ADD PARTY TO SUB CONFERENCE";]]></script>
          </scripts>
        </action>
        <action id="49" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1685 y=1084 ?>
          <!--fail to add to sub conf-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="p_strConfControllerIP" transaction="p_strTransactionId" message-name="s_strConfAddToSubConfResponse" destination-port="p_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;Status&quot;" value="s_nFailure"/>
            <parameter tag="&quot;StatusMessage&quot;" value="g_strReturnMsg"/>
            <parameter tag="&quot;Endpoint&quot;" value="p_strSubConferenceEndPoint"/>
            <parameter tag="&quot;CallerPassCode&quot;" value="p_strCallerPassCode"/>
            <parameter tag="&quot;ConnectionId&quot;" value="g_oSubConfMS.strConnectionId"/>
          </SOAP>
          <results >
            <result name="Default" link="33" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "FAIL TO ADD PARTY TO SUB CONFERENCE, PARTY HUNG UP";]]></script>
          </scripts>
        </action>
        <action id="51" plug-in="Standard.WaitEvent.1" ><?xtml-editor x=748 y=1170 ?>
          <!--ConfCancelQandAResponse-->
          <wait xmlns="urn:www.pactolus.com:xtml:communication" timeout="s_nTimeout" recv-name="g_strEventReceived" >
            <msg name="ConfCancelQandAResponse" >
              <parameter ></parameter>
              <parameter ></parameter>
              <parameter ></parameter>
              <parameter >f_nReturnCode</parameter>
              <parameter ></parameter>
            </msg>
          </wait>
          <results >
            <result name="Default" link="1" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
            <result name="" ><?xtml-editor visible=no?></result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (2 == Result.id && 0 == Session.f_nReturnCode)
{
	Session.g_bPartyHandRaised = false;
	Server.logInfo("SUCCESS CANCEL Q AND A");
}
else
{
	Server.logError("FAIL TO CANCEL Q AND A, EXIT ON BRANCH: " + Result.name);
	Server.logError("FAIL TO CANCEL Q AND A, RETURN CODE: " + Session.f_nReturnCode);
}]]></script>
          </scripts>
        </action>
        <action id="52" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=501 y=1177 ?>
          <!--s_strCancelQandARequest-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="s_strCancelQandARequest" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
            <parameter tag="&quot;CCGeneratedPasscode&quot;" value="g_strCCGeneratedPassCode"/>
          </SOAP>
          <results >
            <result name="Default" link="51" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: **** CONF Cancel Q&A Request ****");]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)
{
	Server.logError("ERROR: FAIL TO SEND SOAP MESSAGE CONF Cancel Q and A Request.");
}
else
{
	Server.logInfo("SUCCESSFUL SEND SOAP MESSAGE TO CONF: CANCEL Q AND A REQUEST");
}]]></script>
          </scripts>
        </action>
        <action id="58" plug-in="Pactolus.Branch.1" ><?xtml-editor x=481 y=1350 ?>
          <!--in private talk?-->
          <results >
            <result name="Default" link="74" stubbed="1"/>
            <result name="g_bPrivateTalkInConference" link="67" stubbed="0" >g_bPrivateTalkInConference == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("REQUESTED PRIVATE TALK, NEED TO REMOVE REQUEST");]]></script>
          </scripts>
        </action>
        <action id="62" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=990 y=1515 ?>
          <!--"psAPISceEndRequest"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceEndRequest&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="1" stubbed="1"/>
          </results>
        </action>
        <action id="63" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1000 y=1617 ?>
          <!--"psAPISceEndAssignment"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceEndAssignment&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="62" stubbed="1"/>
          </results>
        </action>
        <action id="64" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=758 y=1515 ?>
          <!--s_strMSG_END_REQUEST_CSR-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strACDControllerIP" transaction="s_strZeroTransactionId" message-name="s_strMsgEndRequestCSR" destination-port="g_nACDControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;RequestId&quot;" value="g_lCSRRequestId"/>
            <parameter tag="&quot;AssignmentId&quot;" value="0"/>
          </SOAP>
          <results >
            <result name="Default" link="62" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[Session.g_bSentACDBeginRequest = false;]]></script>
          </scripts>
        </action>
        <action id="65" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=772 y=1643 ?>
          <!--s_strMSG_END_REQUEST_CSR-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strACDControllerIP" transaction="s_strZeroTransactionId" message-name="s_strMsgEndRequestCSR" destination-port="g_nACDControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;RequestId&quot;" value="g_lCSRRequestId"/>
            <parameter tag="&quot;AssignmentId&quot;" value="g_lCSRAssignmentId"/>
          </SOAP>
          <results >
            <result name="Default" link="63" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[Session.g_bSentACDBeginRequest = false;]]></script>
          </scripts>
        </action>
        <action id="66" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=766 y=1793 ?>
          <!--s_strMSG_END_REQUEST_CSR-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strACDControllerIP" transaction="s_strZeroTransactionId" message-name="s_strMsgEndRequestCSR" destination-port="g_nACDControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;RequestId&quot;" value="g_lCSRRequestId"/>
            <parameter tag="&quot;AssignmentId&quot;" value="0"/>
          </SOAP>
          <results >
            <result name="Default" link="62" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[Session.g_bSentACDBeginRequest = false;]]></script>
          </scripts>
        </action>
        <action id="67" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=733 y=1343 ?>
          <!--PrivateTalkHangup-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="&quot;PrivateTalkHangup&quot;" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;ConferenceId&quot;" value="g_strConfScheduleId"/>
            <parameter tag="&quot;moderatorKey&quot;" value="g_strModeratorKey"/>
          </SOAP>
          <results >
            <result name="Default" link="68" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("CURRENTLY IN PRIVATE TALK");
Session.g_strReturnMsg = "PRIVATE TALK HANGUP";
Server.logInfo("SENDING PrivateTalkHangup TO CONFERENCE CONTROLLER");
Session.g_lPrivateTalkEndTime = Server.getUTCTime();]]></script>
            <script language="javascript" timing="last" ><![CDATA[Session.g_bPrivateTalkInConference = false;]]></script>
          </scripts>
        </action>
        <action id="68" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=967 y=1342 ?>
          <!--Remove member from temp conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;RemoveMemberFromConference&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
          </function>
          <results >
            <result name="Default" link="74" stubbed="1"/>
          </results>
        </action>
        <action id="69" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1266 y=1954 ?>
          <!--"psAPISceEndAssignment"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceEndAssignment&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="71" stubbed="0"/>
          </results>
        </action>
        <action id="70" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1004 y=1952 ?>
          <!--sent APIBeginAssignment?-->
          <results >
            <result name="Default" link="71" stubbed="1"/>
            <result name="g_bSentAPIBeginAssignment" link="69" stubbed="0" >g_bSentAPIBeginAssignment == true</result>
          </results>
        </action>
        <action id="71" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1485 y=1949 ?>
          <!--sent APIBeginRequest?-->
          <results >
            <result name="Default" link="1" stubbed="1"/>
            <result name="g_bSentAPIBeginRequest" link="72" stubbed="0" >g_bSentAPIBeginRequest == true</result>
          </results>
        </action>
        <action id="72" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1713 y=1944 ?>
          <!--"psAPISceEndRequest"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceEndRequest&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="1" stubbed="1"/>
          </results>
        </action>
        <action id="73" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=755 y=1957 ?>
          <!--s_strMSG_END_REQUEST_CSR-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strACDControllerIP" transaction="s_strZeroTransactionId" message-name="s_strMsgEndRequestCSR" destination-port="g_nACDControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;RequestId&quot;" value="g_lCSRRequestId"/>
            <parameter tag="&quot;AssignmentId&quot;" value="g_lCSRAssignmentId"/>
          </SOAP>
          <results >
            <result name="Default" link="70" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[Session.g_bSentACDBeginRequest = false;]]></script>
          </scripts>
        </action>
        <action id="74" plug-in="Pactolus.Branch.1" ><?xtml-editor x=440 y=1548 ?>
          <results >
            <result name="Default" link="1" stubbed="1"/>
            <result name="BeginRequest" link="64" stubbed="0" >g_nCallerCurrentState == s_nStateBeginRequest

OR g_nCallerCurrentState == s_nStateRouteToCsr

OR g_nCallerCurrentState == s_nStateZeroOutToCsr</result>
            <result name="BeginAssignment" link="65" stubbed="0" >g_nCallerCurrentState == s_nStateBeginAssignment

OR g_nCallerCurrentState == s_nStateCsrPutOnHold

OR g_nCallerCurrentState == s_nStateCsrPutOffHold</result>
            <result name="Requeue" link="66" stubbed="0" >g_nCallerCurrentState == s_nStateRequeue</result>
            <result name="SentACDBeginRequest" link="73" stubbed="0" >g_bSentACDBeginRequest == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (Session.g_bEBCRequestPrivateCSR)
{
	Server.logInfo("REQUESTED PRIVATE TALK CSR, MOVE TO SUB, CANCEL REQUEST.  SET g_bEBCRequestPrivateCSR = false");
	Session.g_bEBCRequestPrivateCSR = false;
}
if (Session.g_bEBCRequestCSR)
{
	Server.logInfo("REQUESTED CSR INTO CONFERENCE, MOVE TO SUB.  SET g_bEBCRequestCSR = false");
	Session.g_bEBCRequestCSR = false;
}]]></script>
          </scripts>
        </action>
        <action id="75" plug-in="Standard.EndSession.1" ><?xtml-editor x=2210 y=80 ?></action>
        <action id="77" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1977 y=82 ?>
          <!--HangUp Caller-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpCaller&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="75" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 35;
Session.g_nConfLeaveReason = 9;
Session.g_strConfLeaveMsg = "FAIL TO PUT BACK TO MAIN CONFERENCE";]]></script>
          </scripts>
        </action>
        <action id="78" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1755 y=76 ?>
          <!--fail to add to sub conf-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="p_strConfControllerIP" transaction="p_strTransactionId" message-name="s_strConfAddToSubConfResponse" destination-port="p_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;Status&quot;" value="s_nFailure"/>
            <parameter tag="&quot;StatusMessage&quot;" value="g_strReturnMsg"/>
            <parameter tag="&quot;Endpoint&quot;" value="p_strSubConferenceEndPoint"/>
            <parameter tag="&quot;CallerPassCode&quot;" value="p_strCallerPassCode"/>
            <parameter tag="&quot;ConnectionId&quot;" value="g_oMS.strConnectionId"/>
          </SOAP>
          <results >
            <result name="Default" link="77" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "UNABLE TO ADD PARTICIPANT INTO SUB CONFERENCE, NOT ABLE TO PUT BACK TO MAIN CONFERENCE";]]></script>
          </scripts>
        </action>
      </actions>
    </function>
    <function name="OnConfRemoveFromSubConfRequest" start="13" event="OnConfRemoveFromSubConfRequest" returns="void" >
      <parameters >
        <parameter name="p_strConfControllerIP" type="string" pass="byref"/>
        <parameter name="p_nConfControllerPort" type="i4" pass="byref"/>
        <parameter name="p_strTransactionId" type="string" pass="byref"/>
        <parameter name="p_strCallerPassCode" type="string" pass="byref"/>
        <parameter name="p_strDeleteSubConferenceFlag" type="string" pass="byref"/>
        <parameter name="p_nAudioMode" type="i4" pass="byref"/>
      </parameters>
      <local-vars >
        <var name="f_nReturnCode" type="i4" >-1</var>
        <var name="strEndpointPlusConnectionId" type="string" ></var>
      </local-vars>
      <actions >
        <action id="13" plug-in="Pactolus.Branch.1" ><?xtml-editor x=98 y=261 ?>
          <!--in sub?-->
          <results >
            <result name="Default" link="14" stubbed="0"/>
            <result name="g_bCurrentlyInSub" link="50" stubbed="0" >g_bCurrentlyInSubConf == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: OnConfRemoveSubConfRequest");]]></script>
          </scripts>
        </action>
        <action id="1" plug-in="Pactolus.Branch.1" ><?xtml-editor x=360 y=440 ?>
          <!--Dial In?-->
          <results >
            <result name="Default" link="15" stubbed="0"/>
            <result name="g_strOutdialFlag = &quot;T&quot;;" link="16" stubbed="0" >g_strOutdialFlag match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (0 == Session.p_nAudioMode)
{
	Session.g_oMS.bMuteFlag = false;
	Session.g_oMS.bDeafFlag = false;
}
else if (2 == Session.p_nAudioMode)
{
	Session.g_oMS.bMuteFlag = true;
	Session.g_oMS.bDeafFlag = false;
}
else if (1 == Session.p_nAudioMode)
{
	Session.g_oMS.bMuteFlag = true;
	Session.g_oMS.bDeafFlag = true;
}]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=920 y=209 ?>
          <!--"MoveFromSubConfToMainConf"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;MoveFromSubConfToMainConf&quot;" return="f_nReturnCode" external-function="1" library="lib_utils.xml" >
            <parameter >g_oSubConfMS</parameter>
            <parameter >g_oMS</parameter>
            <parameter >g_oCallLegA</parameter>
            <parameter >g_strContact</parameter>
            <parameter >p_strDeleteSubConferenceFlag</parameter>
          </function>
          <results >
            <result name="Default" link="5" stubbed="1"/>
            <result name="FAILURE" link="4" stubbed="0" >f_nReturnCode == s_nFailure</result>
            <result name="CALLER HUNGUP" link="9" stubbed="1" >f_nReturnCode == s_nCallerHungup</result>
          </results>
        </action>
        <action id="3" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=2801 y=148 ?>
          <!--SUCCESS-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nSuccess"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="4" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1155 y=360 ?>
          <!--fail to add to sub main-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="p_strConfControllerIP" transaction="p_strTransactionId" message-name="s_strConfRemoveFromSubResponse" destination-port="p_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;Status&quot;" value="s_nFailure"/>
            <parameter tag="&quot;StatusMessage&quot;" value="g_strReturnMsg"/>
            <parameter tag="&quot;CallerPassCode&quot;" value="p_strCallerPassCode"/>
            <parameter tag="&quot;ConnectionId&quot;" value="g_oMS.strConnectionId"/>
          </SOAP>
          <results >
            <result name="Default" link="6" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "FAIL TO MOVE PARTICIPANT FROM SUB INTO MAIN CONFERENCE";]]></script>
          </scripts>
        </action>
        <action id="5" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1140 y=206 ?>
          <!--success to add to main-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="p_strConfControllerIP" transaction="p_strTransactionId" message-name="s_strConfRemoveFromSubResponse" destination-port="p_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;Status&quot;" value="s_nSuccess"/>
            <parameter tag="&quot;StatusMessage&quot;" value="g_strReturnMsg"/>
            <parameter tag="&quot;CallerPassCode&quot;" value="p_strCallerPassCode"/>
            <parameter tag="&quot;ConnectionId&quot;" value="strEndpointPlusConnectionId"/>
          </SOAP>
          <results >
            <result name="Default" link="27" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "SUCCESS MOVE PARTICIPANT FROM SUB INTO MAIN CONFERENCE";
Session.g_bCurrentlyInSubConf = false;
Session.g_strSubConferenceId = "";
Session.g_strSubConfModeratorFlag = "";
Session.strEndpointPlusConnectionId = Session.g_oMS.strEndPoint + "#" + Session.g_oMS.strConnectionId;
if (0 == Session.p_nAudioMode)
{
	Session.g_bHoldState = false;
	Session.g_bMutedState = false;
}
else if (2 == Session.p_nAudioMode)
{
	Session.g_bHoldState = false;
	Session.g_bMutedState = true;
}
else if (1 == Session.p_nAudioMode)
{
	Session.g_bHoldState = true;
	Session.g_bMutedState = false;
}]]></script>
          </scripts>
        </action>
        <action id="6" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1392 y=354 ?>
          <!--"HangUpCaller"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpCaller&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="7" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nConfLeaveReason = 9;
Session.g_strConfLeaveMsg = "FAIL TO ADD PARTY TO CONFERENCE";]]></script>
          </scripts>
        </action>
        <action id="7" plug-in="Standard.EndSession.1" ><?xtml-editor x=1613 y=352 ?></action>
        <action id="8" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=806 y=539 ?>
          <!--"MoveFromSubConfToMainConf"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;MoveFromSubConfToMainConf&quot;" return="f_nReturnCode" external-function="1" library="lib_utils.xml" >
            <parameter >g_oSubConfMS</parameter>
            <parameter >g_oMS</parameter>
            <parameter >g_oCallLegB</parameter>
            <parameter >g_strContact</parameter>
            <parameter >p_strDeleteSubConferenceFlag</parameter>
          </function>
          <results >
            <result name="Default" link="5" stubbed="1"/>
            <result name="FAILURE" link="4" stubbed="1" >f_nReturnCode == s_nFailure</result>
            <result name="CALLER HUNGUP" link="9" stubbed="1" >f_nReturnCode == s_nCallerHungup</result>
          </results>
        </action>
        <action id="9" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1150 y=498 ?>
          <!--fail to add to sub main-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="p_strConfControllerIP" transaction="p_strTransactionId" message-name="s_strConfRemoveFromSubResponse" destination-port="p_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;Status&quot;" value="s_nFailure"/>
            <parameter tag="&quot;StatusMessage&quot;" value="g_strReturnMsg"/>
            <parameter tag="&quot;CallerPassCode&quot;" value="p_strCallerPassCode"/>
            <parameter tag="&quot;ConnectionId&quot;" value="g_oMS.strConnectionId"/>
          </SOAP>
          <results >
            <result name="Default" link="54" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "FAIL TO MOVE PARTICIPANT FROM SUB INTO MAIN CONFERENCE";]]></script>
          </scripts>
        </action>
        <action id="10" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1607 y=199 ?>
          <!--set DTMF Detection ON-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;SetDTMFOn&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="24" stubbed="0"/>
          </results>
        </action>
        <action id="11" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=595 y=669 ?>
          <!--fail to add to sub main-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="p_strConfControllerIP" transaction="p_strTransactionId" message-name="s_strConfRemoveFromSubResponse" destination-port="p_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;Status&quot;" value="s_nFailure"/>
            <parameter tag="&quot;StatusMessage&quot;" value="g_strReturnMsg"/>
            <parameter tag="&quot;CallerPassCode&quot;" value="p_strCallerPassCode"/>
            <parameter tag="&quot;ConnectionId&quot;" value="g_oMS.strConnectionId"/>
          </SOAP>
          <results >
            <result name="Default" link="12" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "PARTICIPANT CURRENTLY ON HOLD, FAIL TO MOVE PARTICIPANT FROM SUB INTO MAIN CONFERENCE";]]></script>
          </scripts>
        </action>
        <action id="12" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=836 y=666 ?>
          <!--s_nFailure-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nFailure"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="14" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=360 y=175 ?>
          <!--fail to add to sub main, not in sub conf-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="p_strConfControllerIP" transaction="p_strTransactionId" message-name="s_strConfRemoveFromSubResponse" destination-port="p_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;Status&quot;" value="s_nFailure"/>
            <parameter tag="&quot;StatusMessage&quot;" value="g_strReturnMsg"/>
            <parameter tag="&quot;CallerPassCode&quot;" value="p_strCallerPassCode"/>
            <parameter tag="&quot;ConnectionId&quot;" value="g_oMS.strConnectionId"/>
          </SOAP>
          <results >
            <result name="Default" link="12" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "NOT CURRENTLY IN SUB CONFERENCE, CAN'T MOVE TO MAIN CONFERENCE";]]></script>
          </scripts>
        </action>
        <action id="15" plug-in="Standard.Timer.1" ><?xtml-editor x=691 y=220 ?>
          <!--stop ck reInvite timer-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="0" id="g_lCkReInviteTimerIdA" duration=""/>
          <results >
            <result name="Default" link="2" stubbed="0"/>
          </results>
        </action>
        <action id="16" plug-in="Standard.Timer.1" ><?xtml-editor x=587 y=543 ?>
          <!--stop ck reInvite timer B-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="0" id="g_lCkReInviteTimerIdB" duration=""/>
          <results >
            <result name="Default" link="8" stubbed="0"/>
          </results>
        </action>
        <action id="23" plug-in="Standard.Timer.1" ><?xtml-editor x=2327 y=157 ?>
          <!--ck reInvite timer-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lCkReInviteTimerIdA" duration="g_nCkReInviteTime"/>
          <results >
            <result name="Default" link="56" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bCkReInviteTimerFlagA = true;
Server.logInfo("SET TIMER TO CHECK FOR REINVITE A LEG");]]></script>
          </scripts>
        </action>
        <action id="24" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1844 y=192 ?>
          <results >
            <result name="Default" link="56" stubbed="1"/>
            <result name="Time &gt; 0" link="26" stubbed="0" >g_nCkReInviteTime &gt; 0</result>
          </results>
        </action>
        <action id="25" plug-in="Standard.Timer.1" ><?xtml-editor x=2345 y=273 ?>
          <!--ck reInvite timer B-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lCkReInviteTimerIdB" duration="g_nCkReInviteTime"/>
          <results >
            <result name="Default" link="56" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bCkReInviteTimerFlagB = true;
Server.logInfo("SET TIMER TO CHECK FOR REINVITE B LEG");]]></script>
          </scripts>
        </action>
        <action id="26" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2095 y=185 ?>
          <!--Dial In?-->
          <results >
            <result name="Default" link="23" stubbed="0"/>
            <result name="g_strOutdialFlag = &quot;T&quot;" link="25" stubbed="0" >g_strOutdialFlag match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("MOVED BACK TO MAIN CONF, RESET TIMER TO CHECK FOR REINVITE");]]></script>
          </scripts>
        </action>
        <action id="27" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1383 y=202 ?>
          <!--ConfMSConnectionIDChangedNotify-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ConfMSConnectionIDChangedNotify&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="43" stubbed="1"/>
          </results>
        </action>
        <action id="28" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=629 y=950 ?>
          <!--"DisconnectFromMOH"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DisconnectFromMOH&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="1" stubbed="1"/>
          </results>
        </action>
        <action id="30" plug-in="Pactolus.Branch.1" ><?xtml-editor x=392 y=950 ?>
          <!--MOH?-->
          <results >
            <result name="Default" link="1" stubbed="1"/>
            <result name="g_strMusicOnHoldFlag==&quot;T&quot;" link="28" stubbed="0" >g_strMusicOnHoldFlag match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bDontPlayContinueToHold = true;]]></script>
          </scripts>
        </action>
        <action id="31" plug-in="Pactolus.Branch.1" ><?xtml-editor x=748 y=1141 ?>
          <!--Dial In?-->
          <results >
            <result name="Default" link="32" stubbed="0"/>
            <result name="g_strOutdialFlag = &quot;T&quot;;" link="33" stubbed="0" >g_strOutdialFlag match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_oSubConfMS.bMuteFlag = true;
Session.g_oSubConfMS.bDeafFlag = true;]]></script>
          </scripts>
        </action>
        <action id="32" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=985 y=1128 ?>
          <!--AddMemberToConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oSubConfMS</parameter>
            <parameter >g_oCallLegA</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="1" stubbed="1"/>
            <result name="FAILURE" link="51" stubbed="0" >f_nReturnCode == s_nFailure</result>
            <result name="CALLERHUNGUP" link="53" stubbed="1" >f_nReturnCode == s_nCallerHungup</result>
          </results>
        </action>
        <action id="33" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1003 y=1278 ?>
          <!--AddMemberToConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oSubConfMS</parameter>
            <parameter >g_oCallLegB</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="1" stubbed="1"/>
            <result name="FAILURE" link="51" stubbed="1" >f_nReturnCode == s_nFailure</result>
            <result name="CALLERHUNGUP" link="53" stubbed="0" >f_nReturnCode == s_nCallerHungup</result>
          </results>
        </action>
        <action id="34" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1479 y=1271 ?>
          <!--"PartyLeave"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;PartyLeave&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="52" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nConfLeaveReason = 0;
Session.g_strConfLeaveMsg = "PARTY HANGUP WHILE TRYING TO ADD MEMBER TO CONFERENCE";]]></script>
          </scripts>
        </action>
        <action id="35" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1474 y=1124 ?>
          <!--HangUp Caller-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpCaller&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="52" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 35;
Session.g_nConfLeaveReason = 9;
Session.g_strConfLeaveMsg = "FAIL TO ADD PARTY TO CONFERENCE";]]></script>
          </scripts>
        </action>
        <action id="43" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1840 y=419 ?>
          <!--AudioMode == Hold-->
          <results >
            <result name="Default" link="10" stubbed="1"/>
            <result name="p_nAudioMode == 1" link="44" stubbed="0" >p_nAudioMode == 1</result>
          </results>
        </action>
        <action id="44" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2062 y=416 ?>
          <!--MOH?-->
          <results >
            <result name="Default" link="45" stubbed="0"/>
            <result name="g_strMusicOnHoldFlag==&quot;T&quot;" link="48" stubbed="0" >g_strMusicOnHoldFlag match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bDontPlayContinueToHold = true;]]></script>
          </scripts>
        </action>
        <action id="45" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2302 y=411 ?>
          <!--please hold-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >898</audio>
          </play>
          <results >
            <result name="Default" link="46" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="46" plug-in="Standard.Timer.1" ><?xtml-editor x=2540 y=409 ?>
          <!--play please hold every 10 secs-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lHoldTimerId" duration="s_nSleepTime"/>
          <results >
            <result name="Default" link="56" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bHoldTimerFlag = true;]]></script>
          </scripts>
        </action>
        <action id="48" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2317 y=574 ?>
          <!--Remove member from conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;RemoveMemberFromConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="49" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: CONF HOLD PARTY REQUEST, REMOVE MEMBER FROM CONFERENCE.");]]></script>
          </scripts>
        </action>
        <action id="49" plug-in="Standard.Timer.1" ><?xtml-editor x=2537 y=572 ?>
          <!--5 secs to connect MOH-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lMOHTimerId" duration="s_nPreMohTime"/>
          <results >
            <result name="Default" link="56" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bMOHTimerFlag = true;
Session.g_bDtmfCollectionOnHold = true;]]></script>
          </scripts>
        </action>
        <action id="50" plug-in="Pactolus.Branch.1" ><?xtml-editor x=97 y=743 ?>
          <!--Dial In?-->
          <results >
            <result name="Default" link="1" stubbed="0"/>
            <result name="g_bHoldState &amp;&amp; AudioMode==1" link="55" stubbed="0" >g_bHoldState == true
AND p_nAudioMode == 1</result>
            <result name="g_bHoldState &amp;&amp; AudioMode!=1" link="30" stubbed="0" >g_bHoldState == true
AND p_nAudioMode != 1</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_disable_event();]]></script>
          </scripts>
        </action>
        <action id="51" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1249 y=1124 ?>
          <!--fail to add to sub main-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="p_strConfControllerIP" transaction="p_strTransactionId" message-name="s_strConfRemoveFromSubResponse" destination-port="p_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;Status&quot;" value="s_nFailure"/>
            <parameter tag="&quot;StatusMessage&quot;" value="g_strReturnMsg"/>
            <parameter tag="&quot;CallerPassCode&quot;" value="p_strCallerPassCode"/>
            <parameter tag="&quot;ConnectionId&quot;" value="g_oMS.strConnectionId"/>
          </SOAP>
          <results >
            <result name="Default" link="35" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "FAIL TO MOVE PARTICIPANT FROM SUB TO MAIN";]]></script>
          </scripts>
        </action>
        <action id="52" plug-in="Standard.EndSession.1" ><?xtml-editor x=1705 y=1124 ?></action>
        <action id="53" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1252 y=1275 ?>
          <!--fail to add to sub main-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="p_strConfControllerIP" transaction="p_strTransactionId" message-name="s_strConfRemoveFromSubResponse" destination-port="p_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;Status&quot;" value="s_nFailure"/>
            <parameter tag="&quot;StatusMessage&quot;" value="g_strReturnMsg"/>
            <parameter tag="&quot;CallerPassCode&quot;" value="p_strCallerPassCode"/>
            <parameter tag="&quot;ConnectionId&quot;" value="g_oMS.strConnectionId"/>
          </SOAP>
          <results >
            <result name="Default" link="34" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "FAIL TO MOVE PARTICIPANT FROM SUB TO MAIN, PARTY HUNG UP";]]></script>
          </scripts>
        </action>
        <action id="54" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1400 y=490 ?>
          <!--"PartyLeave"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;PartyLeave&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="7" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nConfLeaveReason = 0;
Session.g_strConfLeaveMsg = "PARTY HANGUP WHILE TRYING TO ADD MEMBER TO CONFERENCE";]]></script>
          </scripts>
        </action>
        <action id="55" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=404 y=801 ?>
          <!--success to add to main-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="p_strConfControllerIP" transaction="p_strTransactionId" message-name="s_strConfRemoveFromSubResponse" destination-port="p_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;Status&quot;" value="s_nSuccess"/>
            <parameter tag="&quot;StatusMessage&quot;" value="g_strReturnMsg"/>
            <parameter tag="&quot;CallerPassCode&quot;" value="p_strCallerPassCode"/>
            <parameter tag="&quot;ConnectionId&quot;" value="strEndpointPlusConnectionId"/>
          </SOAP>
          <results >
            <result name="Default" link="57" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "SUCCESS MOVE PARTICIPANT FROM SUB INTO MAIN CONFERENCE";
Session.g_bCurrentlyInSubConf = false;
Session.g_strSubConferenceId = "";
Session.g_strSubConfModeratorFlag = "";
Session.strEndpointPlusConnectionId = Session.g_oMS.strEndPoint + "#" + Session.g_oMS.strConnectionId;
if (0 == Session.p_nAudioMode)
{
	Session.g_bHoldState = false;
	Session.g_bMutedState = false;
}
else if (2 == Session.p_nAudioMode)
{
	Session.g_bHoldState = false;
	Session.g_bMutedState = true;
}
else if (1 == Session.p_nAudioMode)
{
	Session.g_bHoldState = true;
	Session.g_bMutedState = false;
}]]></script>
          </scripts>
        </action>
        <action id="56" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2566 y=154 ?>
          <!--clear out sub conf type-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceSetSubConfType&quot;" return="" external-function="0" library="" >
            <parameter >0</parameter>
          </function>
          <results >
            <result name="Default" link="3" stubbed="0"/>
          </results>
        </action>
        <action id="57" plug-in="Pactolus.Branch.1" ><?xtml-editor x=646 y=802 ?>
          <!--delete sub conf?-->
          <results >
            <result name="Default" link="10" stubbed="1"/>
            <result name="p_strDeleteSubConf==&quot;T&quot;" link="58" stubbed="0" >p_strDeleteSubConferenceFlag match "T"</result>
          </results>
        </action>
        <action id="58" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=883 y=798 ?>
          <!--"DeleteConference"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DeleteConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oSubConfMS</parameter>
          </function>
          <results >
            <result name="Default" link="10" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bDtmfCollectionOnHold = true;]]></script>
          </scripts>
        </action>
      </actions>
    </function>
    <function name="OnConfAuditRequest" start="1" event="OnConfAuditRequest" returns="void" >
      <parameters >
        <parameter name="strConfControllerIP" type="string" pass="byref"/>
        <parameter name="nConfControllerPort" type="i4" pass="byref"/>
        <parameter name="strTransactionId" type="string" pass="byref"/>
      </parameters>
      <local-vars >
        <var name="f_strAnonymousCaller" type="string" >F</var>
        <var name="f_strWaitForModFlag" type="string" >F</var>
        <var name="f_strMutedByModFlag" type="string" >F</var>
        <var name="f_strCurrentlyOnHoldFlag" type="string" >F</var>
        <var name="f_strCurrentlyFullDuplexFlag" type="string" >T</var>
        <var name="f_strCCGeneratedPCode" type="string" >F</var>
        <var name="strCurrentlyInAssignment" type="string" >F</var>
        <var name="strQandARequested" type="string" >F</var>
        <var name="strMSEndpoint" type="string" ></var>
        <var name="strConnectionIdPlusEndpoint" type="string" ></var>
      </local-vars>
      <actions >
        <action id="1" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=292 y=267 ?>
          <!--ConfAuditResponse-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strConfControllerIP" transaction="strTransactionId" message-name="s_strConfAuditResponse" destination-port="nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;CallerPassCode&quot;" value="g_strCCGeneratedPassCode"/>
            <parameter tag="&quot;CCGeneratedPassCodeFlag&quot;" value="f_strCCGeneratedPCode"/>
            <parameter tag="&quot;SubConferenceId&quot;" value="g_strSubConferenceId"/>
            <parameter tag="&quot;CallerFirstName&quot;" value="g_strCallerFirstName"/>
            <parameter tag="&quot;CallerLastName&quot;" value="g_strCallerLastName"/>
            <parameter tag="&quot;Organization&quot;" value="g_strCallerOrg"/>
            <parameter tag="&quot;CallingNumber&quot;" value="g_strOrigNbr"/>
            <parameter tag="&quot;DialOutExtNbr&quot;" value="g_strDialOutExtNbr"/>
            <parameter tag="&quot;ModeratorFlag&quot;" value="g_strModeratorFlag"/>
            <parameter tag="&quot;SubscriberFlag&quot;" value="g_strIsSubscriberFlag"/>
            <parameter tag="&quot;RecordedNameURL&quot;" value="g_strCallerRecordedName"/>
            <parameter tag="&quot;DialOutRequestId&quot;" value="g_lDialOutRequestId"/>
            <parameter tag="&quot;CurrentlyFullDuplexFlag&quot;" value="f_strCurrentlyFullDuplexFlag"/>
            <parameter tag="&quot;MutedByModFlag&quot;" value="f_strMutedByModFlag"/>
            <parameter tag="&quot;CurrentlyOnHoldFlag&quot;" value="f_strCurrentlyOnHoldFlag"/>
            <parameter tag="&quot;WFMFlag&quot;" value="f_strWaitForModFlag"/>
            <parameter tag="&quot;SubConferenceJoinTime&quot;" value="g_lSubConferenceJoinTime"/>
            <parameter tag="&quot;MediaServerConnectTime&quot;" value="g_lPartyJoinTime"/>
            <parameter tag="&quot;ConferenceContinue&quot;" value="g_strConfContinueNoMod"/>
            <parameter tag="&quot;MutedParticipantPasscode&quot;" value="g_strMutedPartyPassCode"/>
            <parameter tag="&quot;msConnectionId&quot;" value="strConnectionIdPlusEndpoint"/>
            <parameter tag="&quot;AnonymousCallerFlag&quot;" value="f_strAnonymousCaller"/>
            <parameter tag="&quot;SIPCallId&quot;" value="g_oCallLegA.strCallId"/>
            <parameter tag="&quot;AccessNumber&quot;" value="g_strAccessNumber"/>
            <parameter tag="&quot;AttendeeId&quot;" value="g_nAttendeeId"/>
            <parameter tag="&quot;CustomerConferenceId&quot;" value="g_strCustomerConferenceId"/>
            <parameter tag="&quot;PartyScheduleId&quot;" value="g_lPartySchedId"/>
            <parameter tag="&quot;PartyDetail&quot;" value="g_strPartyDetail"/>
            <parameter tag="&quot;AccessNumberType&quot;" value="g_nEventDnisType"/>
            <parameter tag="&quot;ConfStatus&quot;" value="g_nReleaseToConfStatus"/>
            <parameter tag="&quot;InAssignment&quot;" value="strCurrentlyInAssignment"/>
            <parameter tag="&quot;AssignmentPrivateTalk&quot;" value="g_strRequestCSRPrivateTalkFlag"/>
            <parameter tag="&quot;QandARequested&quot;" value="strQandARequested"/>
            <parameter tag="&quot;msEndpoint&quot;" value="strMSEndpoint"/>
          </SOAP>
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: OnConfAuditRequest");
if (Session.g_bConfControllerGeneratedPCode)
{
	Server.logInfo("CC generated passcode");
	Session.f_strCCGeneratedPCode = "T";

}

if (Session.g_bAnonymousCaller)
{
	Session.f_strAnonymousCaller = "T";
}
if (Session.g_bWaitForModerator)
{
	Session.f_strWaitForModFlag = "T";
}
if (Session.g_bMutedState)
{
	Session.f_strCurrentlyFullDuplexFlag = "F";
}
if (Session.g_bMutedByMod)
{
	Session.f_strMutedByModFlag = "T";
}
if (Session.g_bHoldState)
{
	Session.f_strCurrentlyOnHoldFlag = "T";
}
if (Session.g_bSentAPIBeginAssignment)
{
	Session.strCurrentlyInAssignment = "T";
}
if (Session.g_bPartyHandRaised)
{
	Session.strQandARequested = "T";
}

if (Session.g_oMOH_MS.bCurrentlyInConf)
{
	Session.strConnectionIdPlusEndpoint = Session.g_oMOH_MS.strEndPoint + "#" + Session.g_oMOH_MS.strConnectionId;
	Session.strMSEndpoint = Session.g_oMOH_MS.strConferenceId;
	Server.logInfo("CURRENTLY IN MOH");
}
else if (Session.g_oSubConfMS.bCurrentlyInConf)
{
	Session.strConnectionIdPlusEndpoint = Session.g_oSubConfMS.strEndPoint + "#" + Session.g_oSubConfMS.strConnectionId;
	Session.strMSEndpoint = Session.g_oSubConfMS.strConferenceId;
	Server.logInfo("CURRENTLY IN SUB CONF");
}
else
{
	Session.strConnectionIdPlusEndpoint = Session.g_oMS.strEndPoint + "#" + Session.g_oMS.strConnectionId;
	Session.strMSEndpoint = Session.g_oMS.strConferenceId;
	Server.logInfo("CURRENTLY IN MAIN CONF");
}]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)

{

	Server.logError("ERROR: FAIL TO SEND CONF AUDIT RESPONSE");

	Server.logError("ERROR: CONF CONTROLLER IP: " + Session.strConfControllerIP);

	Server.logError("ERROR: CONF CONTROLLER PORT: " + Session.nConfControllerPort);

	Server.logError("ERROR: CONF TRANSACTION Id: " + Session.strTransactionId);

}]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=527 y=262 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
        </action>
      </actions>
    </function>
    <function name="psAPISceGetAccessNumberType" start="1" event="psAPISceGetAccessNumberType" returns="i4" >
      <local-vars >
        <var name="f_nReturnCode" type="i4" >-50</var>
      </local-vars>
      <actions >
        <action id="1" plug-in="Pactolus.JavaStaticMethod.1" ><?xtml-editor x=199 y=120 ?>
          <!--"getAccessNumberType"-->
          <java xmlns="urn:www.pactolus.com:xtml:application" class="&quot;com.pactolus.conferencing.psAPISceGetAccessNumberType&quot;" method="&quot;getAccessNumberType&quot;" timeout="s_nTimeout" return="" method-return-var="f_nReturnCode" method-return-type="0" >
            <parameter type="in" var-type="string" >g_strDBNAME</parameter>
            <parameter type="in" var-type="string" >g_strSessionId</parameter>
            <parameter type="in" var-type="string" >g_strAccessNumber</parameter>
            <parameter type="inout" var-type="string" >g_strTollFreeAccessNumberFlag</parameter>
          </java>
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="Success" link="3" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: psAPISceGetAccessNumberType");
Server.logInfo("INFO: *********JAVA CALLING getAccessNumberType *********");

Server.logInfo("INFO: BEFORE DB name = " + Session.g_strDBNAME);

Server.logInfo("INFO: BEFORE session Id = " + Session.g_strSessionId);

Server.logInfo("INFO: BEFORE access number = " + Session.g_strAccessNumber);]]></script>
            <script language="javascript" timing="last" ><![CDATA[Server.logInfo("INFO: ********* iJavaReturnCode " + Session.f_nReturnCode);

if (Result.id == 2)

{

	Server.logInfo("INFO: SUCCESS getAccessNumberType.");

	if (-99 == Session.f_nReturnCode)
	{
			Session.g_nErrorMsgNumber = 1001; //db error
			Server.logError("ERROR: DB FAILURE GET ACCESS NUMBER TYPE");
			Session.g_nTerminationReason = 39;
	}

	else if (-2 == Session.f_nReturnCode)

		Server.logInfo("WARNING: ACCESS NUMBER NOT FOUND");		

	else

		Session.g_nErrorMsgNumber = 0;

}

else

{

	Server.logError("ERROR: FAIL TO GET ACCESS NUMBER TYPE, EXIT ON: " + Result.name);

	Session.g_nTerminationReason = 39;

	Session.g_nErrorMsgNumber = 1000; //jvm server error

}]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=459 y=85 ?>
          <!--FAILURE-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nFailure"/>
        </action>
        <action id="3" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=472 y=201 ?>
          <!--return code from java-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nReturnCode"/>
        </action>
      </actions>
    </function>
    <function name="psAPISceEnableMS" start="1" event="psAPISceEnableMS" returns="i4" >
      <local-vars >
        <var name="f_nReturnCode" type="i4" >-50</var>
      </local-vars>
      <actions >
        <action id="1" plug-in="Pactolus.JavaStaticMethod.1" ><?xtml-editor x=92 y=99 ?>
          <!--"enableMS"-->
          <java xmlns="urn:www.pactolus.com:xtml:application" class="&quot;com.pactolus.conferencing.psAPISceUpdateMSStatus&quot;" method="&quot;enableMS&quot;" timeout="s_nTimeout" return="" method-return-var="f_nReturnCode" method-return-type="0" >
            <parameter type="in" var-type="string" >g_strDBNAME</parameter>
            <parameter type="in" var-type="string" >g_strSessionId</parameter>
            <parameter type="in" var-type="i4" >s_nSiteId</parameter>
          </java>
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="Success" link="3" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: psAPISceEnableMS");
Server.logInfo("INFO: *********JAVA CALLING enableMS *********");

Server.logInfo("INFO: BEFORE DB name = " + Session.g_strDBNAME);

Server.logInfo("INFO: BEFORE session Id = " + Session.g_strSessionId);

Server.logInfo("INFO: BEFORE site id = " + Session.s_nSiteId);]]></script>
            <script language="javascript" timing="last" ><![CDATA[Server.logInfo("INFO: ********* iJavaReturnCode " + Session.f_nReturnCode);

if (Result.id == 2)

{

	Server.logInfo("INFO: SUCCESS enableMS.");

	if (-99 == Session.f_nReturnCode)
	{
		Session.g_nErrorMsgNumber = 1001; //db error
		Server.logError("ERROR: DB FAILURE TO ENABLE MS");
		Session.g_nTerminationReason = 39;
	}

	else if (-2 == Session.f_nReturnCode)

		Server.logInfo("WARNING: MS NOT FOUND");		

	else

		Session.g_nErrorMsgNumber = 0;

}

else

{

	Server.logError("ERROR: FAIL TO ENABLE MS, EXIT ON: " + Result.name);

	Session.g_nTerminationReason = 39;

	Session.g_nErrorMsgNumber = 1000; //jvm server error

}]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=352 y=64 ?>
          <!--FAILURE-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nFailure"/>
        </action>
        <action id="3" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=365 y=180 ?>
          <!--return code from java-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nReturnCode"/>
        </action>
      </actions>
    </function>
    <function name="psAPISceDisableMS" start="3" event="psAPISceDisableMS" returns="i4" >
      <local-vars >
        <var name="f_nReturnCode" type="i4" >-50</var>
      </local-vars>
      <actions >
        <action id="3" plug-in="Pactolus.JavaStaticMethod.1" ><?xtml-editor x=231 y=184 ?>
          <!--"disableMS"-->
          <java xmlns="urn:www.pactolus.com:xtml:application" class="&quot;com.pactolus.conferencing.psAPISceUpdateMSStatus&quot;" method="&quot;disableMS&quot;" timeout="s_nTimeout" return="" method-return-var="f_nReturnCode" method-return-type="0" >
            <parameter type="in" var-type="string" >g_strDBNAME</parameter>
            <parameter type="in" var-type="string" >g_strSessionId</parameter>
            <parameter type="in" var-type="i4" >s_nSiteId</parameter>
          </java>
          <results >
            <result name="Default" link="1" stubbed="0"/>
            <result name="Success" link="2" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: psAPISceDisableMS");
Server.logInfo("INFO: *********JAVA CALLING disableMS *********");

Server.logInfo("INFO: BEFORE DB name = " + Session.g_strDBNAME);

Server.logInfo("INFO: BEFORE session Id = " + Session.g_strSessionId);

Server.logInfo("INFO: BEFORE site id = " + Session.s_nSiteId);]]></script>
            <script language="javascript" timing="last" ><![CDATA[Server.logInfo("INFO: ********* iJavaReturnCode " + Session.f_nReturnCode);

if (Result.id == 2)

{

	Server.logInfo("INFO: SUCCESS disableMS.");

	if (-99 == Session.f_nReturnCode)
	{
		Session.g_nErrorMsgNumber = 1001; //db error
		Server.logError("ERROR: DB FAILURE TO DISABLE MS");
		Session.g_nTerminationReason = 39;
	}

	else if (-2 == Session.f_nReturnCode)

		Server.logInfo("WARNING: MS NOT FOUND");		

	else

		Session.g_nErrorMsgNumber = 0;

}

else

{

	Server.logError("ERROR: FAIL TO DISABLE MS, EXIT ON: " + Result.name);

	Session.g_nTerminationReason = 39;

	Session.g_nErrorMsgNumber = 1000; //jvm server error

}]]></script>
          </scripts>
        </action>
        <action id="1" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=491 y=149 ?>
          <!--FAILURE-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nFailure"/>
        </action>
        <action id="2" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=504 y=265 ?>
          <!--return code from java-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nReturnCode"/>
        </action>
      </actions>
    </function>
    <function name="psAPISceGetBackupSite" start="1" event="psAPISceGetBackupSite" returns="i4" >
      <local-vars >
        <var name="f_nReturnCode" type="i4" >-50</var>
      </local-vars>
      <actions >
        <action id="1" plug-in="Pactolus.JavaStaticMethod.1" ><?xtml-editor x=217 y=284 ?>
          <!--"getBackupSite"-->
          <java xmlns="urn:www.pactolus.com:xtml:application" class="&quot;com.pactolus.conferencing.psAPISceGetBackupSite&quot;" method="&quot;getBackupSite&quot;" timeout="s_nTimeout" return="" method-return-var="f_nReturnCode" method-return-type="0" >
            <parameter type="in" var-type="string" >g_strDBNAME</parameter>
            <parameter type="in" var-type="string" >g_strSessionId</parameter>
            <parameter type="in" var-type="i4" >s_nSiteId</parameter>
            <parameter type="inout" var-type="i4" >g_nAlternateSiteId</parameter>
            <parameter type="inout" var-type="string" >g_strAlternateSitePrefix</parameter>
          </java>
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="Success" link="3" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: psAPISceGetBackupSite");
Server.logInfo("INFO: *********JAVA CALLING getBackupSite *********");

Server.logInfo("INFO: BEFORE DB name = " + Session.g_strDBNAME);

Server.logInfo("INFO: BEFORE session Id = " + Session.g_strSessionId);

Server.logInfo("INFO: BEFORE site Id = " + Session.s_nSiteId);]]></script>
            <script language="javascript" timing="last" ><![CDATA[Server.logInfo("INFO: ********* iJavaReturnCode " + Session.f_nReturnCode);

if (Result.id == 2)

{

	Server.logInfo("INFO: SUCCESS getBackupSite.");

	if (-99 == Session.f_nReturnCode)
	{
		Session.g_nErrorMsgNumber = 1001; //db error
		Server.logError("ERROR: DB FAILURE GET BACKUP SITE");
		Session.g_nTerminationReason = 39;
	}

	else if (-2 == Session.f_nReturnCode)

		Server.logInfo("WARNING: SITE NOT FOUND");		

	else

		Session.g_nErrorMsgNumber = 0;

}

else

{

	Server.logError("ERROR: FAIL TO GET BACKUP SITE, EXIT ON: " + Result.name);

	Session.g_nTerminationReason = 39;

	Session.g_nErrorMsgNumber = 1000; //jvm server error

}]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=477 y=249 ?>
          <!--FAILURE-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nFailure"/>
        </action>
        <action id="3" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=490 y=365 ?>
          <!--return code from java-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nReturnCode"/>
        </action>
      </actions>
    </function>
    <function name="psAPISceMoveConfToBackupSite" start="1" event="psAPISceMoveConfToBackupSite" returns="i4" >
      <local-vars >
        <var name="f_nReturnCode" type="i4" >-50</var>
      </local-vars>
      <actions >
        <action id="1" plug-in="Pactolus.JavaStaticMethod.1" ><?xtml-editor x=218 y=254 ?>
          <!--"moveConference"-->
          <java xmlns="urn:www.pactolus.com:xtml:application" class="&quot;com.pactolus.conferencing.psAPISceMoveConfToBackupSite&quot;" method="&quot;moveConference&quot;" timeout="s_nTimeout" return="" method-return-var="f_nReturnCode" method-return-type="0" >
            <parameter type="in" var-type="string" >g_strDBNAME</parameter>
            <parameter type="in" var-type="string" >g_strSessionId</parameter>
            <parameter type="in" var-type="string" >g_strConfScheduleId</parameter>
            <parameter type="in" var-type="i4" >s_nSiteId</parameter>
            <parameter type="inout" var-type="i4" >g_nAlternateSiteId</parameter>
            <parameter type="inout" var-type="string" >g_strCCIPMovedFrom</parameter>
            <parameter type="inout" var-type="i4" >g_nCCPortMovedFrom</parameter>
            <parameter type="inout" var-type="string" >g_strCCIPMovedTo</parameter>
            <parameter type="inout" var-type="i4" >g_nCCPortMovedTo</parameter>
          </java>
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="Success" link="3" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: psAPISceMoveConfToBackupSite");
Server.logInfo("INFO: *********JAVA CALLING psAPISceMoveConfToBackupSite  *********");

Server.logInfo("INFO: BEFORE DB name = " + Session.g_strDBNAME);

Server.logInfo("INFO: BEFORE session Id = " + Session.g_strSessionId);

Server.logInfo("INFO: BEFORE conf schedule Id = " + Session.g_strConfScheduleId);

Server.logInfo("INFO: BEFORE site Id = " + Session.s_nSiteId);]]></script>
            <script language="javascript" timing="last" ><![CDATA[Server.logInfo("INFO: ********* iJavaReturnCode " + Session.f_nReturnCode);

if (Result.id == 2)

{

	if (-99 == Session.f_nReturnCode)
	{
		Session.g_nErrorMsgNumber = 1001; //db error
		Server.logError("psAPISceMoveConfToBackupSite returns DB ERROR");
		Session.g_nTerminationReason = 39;
	}
	else if (-1 == Session.f_nReturnCode)
	{
		Session.g_nErrorMsgNumber = 0;
		Server.logError("psAPISceMoveConfToBackupSite returns INVALID CONFERENCE");
		Session.g_nTerminationReason = 39;
	}
	else

		Session.g_nErrorMsgNumber = 0;

	Server.logInfo("Alternate Site Id: " + Session.g_nAlternateSiteId);
	Session.g_strCCIPMovedFrom = Session.g_strConfControllerIP;
	Server.logInfo("CC IP Moved From: " + Session.g_strCCIPMovedFrom);
	Server.logInfo("CC Port Moved From: " + Session.g_nCCPortMovedFrom);
	Session.g_nCCPortMovedFrom = Session.g_nConfControllerPort;
	Server.logInfo("CC IP Moved To: " + Session.g_strCCIPMovedTo);
	Server.logInfo("CC Port Moved To: " + Session.g_nCCPortMovedTo);
}

else

{

	Server.logError("ERROR: FAIL TO CALL psAPISceMoveConfToBackupSite , EXIT ON: " + Result.name);

	Session.g_nTerminationReason = 39;

	Session.g_nErrorMsgNumber = 1000; //jvm server error

}]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=507 y=210 ?>
          <!--FAILURE-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nFailure"/>
        </action>
        <action id="3" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=520 y=326 ?>
          <!--return code from java-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nReturnCode"/>
        </action>
      </actions>
    </function>
    <function name="ConfMSConnectionIDChangedNotify" start="1" event="ConfMSConnectionIDChangedNotify" returns="i4" >
      <local-vars >
        <var name="strEndpointPlusConnectionId" type="string" ></var>
      </local-vars>
      <actions >
        <action id="1" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=208 y=178 ?>
          <!--ConfMSConnectionIDChangedNotify-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="&quot;ConfMSConnectionIDChangedNotify&quot;" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
            <parameter tag="&quot;callerPassCode&quot;" value="g_strCCGeneratedPassCode"/>
            <parameter tag="&quot;msConnectionId&quot;" value="strEndpointPlusConnectionId"/>
          </SOAP>
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="Success" link="3" stubbed="0"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: ConfMSConnectionIDChangedNotify");
Session.strEndpointPlusConnectionId = Session.g_oMS.strEndPoint + "#" + Session.g_oMS.strConnectionId;]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=441 y=177 ?>
          <!--s_nFailure-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nFailure"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("FAIL TO SEND ConfMSConnectionIDChangedNotify TO CC");]]></script>
          </scripts>
        </action>
        <action id="3" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=454 y=254 ?>
          <!--s_nSuccess-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nSuccess"/>
        </action>
      </actions>
    </function>
    <function name="PlayTooEarly" start="2" event="PlayTooEarly" returns="i4" >
      <local-vars >
        <var name="f_nMinsAvailable" type="i4" >0</var>
        <var name="f_nHoursAvailable" type="i4" >0</var>
        <var name="f_nMinsPrompt" type="i4" >0</var>
        <var name="f_nHoursPrompt" type="i4" >0</var>
      </local-vars>
      <actions >
        <action id="2" plug-in="Pactolus.Branch.1" ><?xtml-editor x=92 y=156 ?>
          <!--calculation hours and mins-->
          <results >
            <result name="Default" link="3" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: PlayTooEarly");
Session.f_nHoursAvailable = Session.g_nMinutesTooEarly / 60;

if (Session.f_nHoursAvailable > 1)
{
	Session.f_nHoursPrompt = 89; //hours
}
else if (1 == Session.f_nHoursAvailable)
{
	Session.f_nHoursPrompt = 88; //hour
}
else
{
	Session.f_nHoursPrompt = 99; //silence
}

Session.f_nMinsAvailable = Session.g_nMinutesTooEarly % 60;

if (Session.f_nMinsAvailable > 1)
{
	Session.f_nMinsPrompt = 309; //minutes
}
else if (1== Session.f_nMinsAvailable)
{
	Session.f_nMinsPrompt = 308; //minute
}
else if (Session.f_nHoursAvailable > 0)
{
	Session.f_nMinsPrompt = 99; //silence
}
else
{
	Session.f_nMinsAvailable = 1;
	Session.f_nMinsPrompt = 308; //minute
}]]></script>
          </scripts>
        </action>
        <action id="1" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=841 y=186 ?>
          <!--TOO EARLY-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >972</audio>
            <audio type="number" >f_nMinsAvailable</audio>
            <audio type="index" >f_nMinsPrompt</audio>
            <audio type="index" >873</audio>
          </play>
          <results >
            <result name="Default" link="7" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="3" plug-in="Pactolus.Branch.1" ><?xtml-editor x=322 y=154 ?>
          <results >
            <result name="Default" link="6" stubbed="0"/>
            <result name="1 or more  Hours" link="5" stubbed="0" >f_nHoursAvailable &gt;= 1</result>
          </results>
        </action>
        <action id="5" plug-in="Pactolus.Branch.1" ><?xtml-editor x=578 y=369 ?>
          <results >
            <result name="Default" link="8" stubbed="0"/>
            <result name="1 or more Mins" link="9" stubbed="0" >f_nMinsAvailable &gt;= 1</result>
          </results>
        </action>
        <action id="6" plug-in="Pactolus.Branch.1" ><?xtml-editor x=562 y=117 ?>
          <results >
            <result name="Default" link="7" stubbed="0"/>
            <result name="1 or more Mins" link="1" stubbed="0" >f_nMinsAvailable &gt;= 1</result>
          </results>
        </action>
        <action id="7" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=827 y=110 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
        </action>
        <action id="8" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=853 y=326 ?>
          <!--TOO EARLY-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >972</audio>
            <audio type="number" >f_nHoursAvailable</audio>
            <audio type="index" >f_nHoursPrompt</audio>
            <audio type="index" >873</audio>
          </play>
          <results >
            <result name="Default" link="7" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="9" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=870 y=498 ?>
          <!--TOO EARLY-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >972</audio>
            <audio type="number" >f_nHoursAvailable</audio>
            <audio type="index" >f_nHoursPrompt</audio>
            <audio type="number" >f_nMinsAvailable</audio>
            <audio type="index" >f_nMinsPrompt</audio>
            <audio type="index" >873</audio>
          </play>
          <results >
            <result name="Default" link="7" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
      </actions>
    </function>
    <function name="RouteToTPCSR" start="1" event="RouteToTPCSR" returns="i4" >
      <local-vars >
        <var name="g_lWaitTPCSRTimerId" type="i8" >0</var>
        <var name="f_nReturnCode" type="i4" >-1</var>
        <var name="f_nRINGNOANSWER" type="i4" >1</var>
        <var name="f_nBUSY" type="i4" >2</var>
        <var name="f_nDTMFINTERRUPT" type="i4" >3</var>
      </local-vars>
      <actions >
        <action id="1" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=109 y=206 ?>
          <!--please hold for CSR-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >1501</audio>
          </play>
          <results >
            <result name="Default" link="3" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: RouteToTPCSR");
Session.g_bTPCSRRouteInProgress = true ]]></script>
          </scripts>
        </action>
        <action id="3" plug-in="Standard.Timer.1" ><?xtml-editor x=311 y=202 ?>
          <!--set max wait time for TP CSR-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lWaitTPCSRTimerId" duration="g_nThirdPartyAcdOutdialDur"/>
          <results >
            <result name="Default" link="5" stubbed="0"/>
          </results>
        </action>
        <action id="5" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=527 y=199 ?>
          <!--Delete MS Connection-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DeleteMSConnection&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="15" stubbed="1"/>
            <result name="s_nSuccess" link="10" stubbed="0" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: IN RouteToTPCSR FUNCTION DeletingMSConnection");
Session.g_nTerminationReason = 40;]]></script>
          </scripts>
        </action>
        <action id="10" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=306 y=410 ?>
          <!--TPCSROutdial-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;TPCSROutdial&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="14" stubbed="0"/>
            <result name="f_nReturnCode == s_nSuccess" link="16" stubbed="0" >f_nReturnCode == s_nSuccess</result>
            <result name="f_nReturnCode == s_nFailure" link="17" stubbed="0" >f_nReturnCode &lt;= s_nFailure
OR f_nReturnCode == 1
OR f_nReturnCode == 2
OR f_nReturnCode == 3</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: IN RouteToTPCSR FUNCTION TPCSROutDial");]]></script>
            <script language="javascript" timing="last" ><![CDATA[Session.f_nRINGNOANSWER = 1;
Session.f_nBUSY = 2;
Session.f_nDTMFINTERRUPT = 3;

if (Session.f_nReturnCode == Session.s_nSuccess)
{
	Server.logInfo("INFO: RouteToTPCSR Returned SUCCESS");
}
if (Session.f_nReturnCode == Session.s_nFailure)
{
	Server.logInfo("INFO: RouteToTPCSR Returned FAILURE");
}
if (Session.f_nReturnCode == Session.f_nRINGNOANSWER)
{
	Server.logInfo("INFO: RouteToTPCSR Returned RINGNOANSWER");
}
if (Session.f_nReturnCode == Session.f_nBUSY)
{
	Server.logInfo("INFO: RouteToTPCSR Returned BUSY");
}
if (Session.f_nReturnCode == Session.f_nDTMFINTERRUPT)
{
	Server.logInfo("INFO: RouteToTPCSR Returned DTMFINTERRUPT");
}
Server.logInfo("INFO: RouteToTPCSR code=" + Session.f_nReturnCode);]]></script>
          </scripts>
        </action>
        <action id="14" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=573 y=357 ?>
          <!--s_nStateDefault-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nStateDefault"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: Leaving RouteToTPCSR with " + Session.s_nStateDefault);
Session.g_nCallerCurrentState = Session.s_nStateDefault

js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="15" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=842 y=604 ?>
          <!--s_nStateEndCall-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nStateEndCall"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: Leaving RouteToTPCSR with " + Session.s_nStateEndCall);
Session.g_nCallerCurrentState = Session.s_nStateEndCall

js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="16" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=597 y=469 ?>
          <!--TPCSR Write CDR Record-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;TPCSRWriteCDR&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="14" stubbed="1"/>
          </results>
        </action>
        <action id="17" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=596 y=602 ?>
          <!--HangupParty-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpParty&quot;" return="" external-function="1" library="lib_callcontrol.xml" >
            <parameter >g_oCallLegA</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="15" stubbed="0"/>
          </results>
        </action>
      </actions>
    </function>
    <function name="TPCSROutdial" start="3" event="TPCSROutdial" returns="i4" >
      <local-vars >
        <var name="f_nReturnCode" type="i4" >-1</var>
        <var name="f_bNullDest" type="boolean" >0</var>
        <var name="p_oAPI" type="object" >0</var>
        <var name="bPlayRingBackTone" type="boolean" >0</var>
      </local-vars>
      <actions >
        <action id="3" plug-in="Pactolus.Branch.1" ><?xtml-editor x=41 y=154 ?>
          <!--setup for conf party B Leg-->
          <results >
            <result name="Default" link="1" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: TPCSROutdial");
Session.g_strThirdPartyAcdOutdialNumber;
Server.logInfo("BEFORE g_strThirdPartyAcdOutdialNumber prepend : <" + Session.g_strThirdPartyAcdOutdialNumber + ">");

Session.g_strThirdPartyAcdOutdialNumber = js_prepend_digits(Session.g_strThirdPartyAcdOutdialNumber, Session.s_strDigitPrependToOutdial);

Server.logInfo("AFTER g_strThirdPartyAcdOutdialNumber prepend : <" + Session.g_strThirdPartyAcdOutdialNumber + ">");



// Phone B object

js_initCallLeg(Session.g_oCallLegB);

Session.g_oCallLegB.strSessionTimerFlag = Session.s_strSessionTimerFlag;
Session.g_oCallLegB.nSessionTimer = Session.s_nSessionTimerInterval;
Session.g_oCallLegB.nRingNoAnswerTime = Session.s_nRingNoAnswerTime;
Session.g_oCallLegB.strCalledNumber = Session.g_strThirdPartyAcdOutdialNumber;
Session.g_oCallLegB.strRequestUri = Session.s_strPrimaryPSX;
Session.g_oCallLegB.strBackupRequestUri = Session.s_strBackupPSX;
Session.g_strContact = "sip:" + Session.s_strLocalHost;
if( Server.sipPort != 5060 )
{
  Session.g_strContact += ":" + Server.sipPort;
}

js_logInfoCallLeg(Session.g_oCallLegB);
js_initAPI(Session.p_oAPI);]]></script>
          </scripts>
        </action>
        <action id="1" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=291 y=151 ?>
          <!--OutdialParty-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;OutdialParty&quot;" return="f_nReturnCode" external-function="1" library="lib_callcontrol.xml" >
            <parameter >g_oCallLegA</parameter>
            <parameter >g_oCallLegB</parameter>
            <parameter >g_lStartTime</parameter>
            <parameter >g_lTimeAnswered</parameter>
            <parameter >g_strSIPStatus</parameter>
            <parameter >g_strContact</parameter>
            <parameter >p_oAPI</parameter>
            <parameter >bPlayRingBackTone</parameter>
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="2" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: IN FUNCTION TPCSROutDial");
Server.logInfo("INFO: Parameter g_lStartTime=" + Session.g_lStartTime);
Server.logInfo("INFO: Parameter g_lTimeAnswered=" + Session.g_lTimeAnswered);
Server.logInfo("INFO: Parameter g_strSIPStatus=" + Session.g_strSIPStatus);
Session.g_lStartTime = Server.getUTCTime();

js_logInfoCallLeg(Session.g_oCallLegA);]]></script>
            <script language="javascript" timing="last" ><![CDATA[Session.g_lEndTime = Server.getUTCTime();
Session.g_lOutdialConnectTime = Session.g_lEndTime - Session.g_lStartTime;]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=524 y=145 ?>
          <!--f_nReturnCode-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nReturnCode"/>
        </action>
      </actions>
    </function>
    <function name="TPCSRWriteCDR" start="1" event="TPCSRWriteCDR" returns="i4" >
      <local-vars >
        <var name="f_nReturnCode" type="i4" >-1</var>
      </local-vars>
      <actions >
        <action id="1" plug-in="Pactolus.JavaStaticMethod.1" ><?xtml-editor x=192 y=132 ?>
          <!--psAPISceWriteThirdPartyCDRRecord-->
          <java xmlns="urn:www.pactolus.com:xtml:application" class="&quot;com.pactolus.conferencing.psAPISceWriteThirdPartyCDRRecord&quot;" method="&quot;writeEvtConfCallLeg&quot;" timeout="s_nTimeout" return="" method-return-var="f_nReturnCode" method-return-type="0" >
            <parameter type="in" var-type="string" >g_strSessionId</parameter>
            <parameter type="in" var-type="string" >g_strThirdPartyAcdOutdialNumber</parameter>
            <parameter type="in" var-type="i8" >g_lStartTime</parameter>
            <parameter type="in" var-type="i8" >g_lOutdialConnectTime</parameter>
            <parameter type="in" var-type="i8" >g_lEndTime</parameter>
          </java>
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: TPCSRWriteCDR");
Server.logInfo("INFO: ********** JAVA CALLING psAPISceWriteThirdPartyCDRRecord *********");

Server.logInfo("INFO: BEFORE sessionId = " + Session._sessionId);

Server.logInfo("INFO: BEFORE outdial Number = " + Session.g_strThirdPartyAcdOutdialNumber);

Server.logInfo("INFO: BEFORE outdial Start Time = " + Session.g_lStartTime);

Server.logInfo("INFO: BEFORE outdial Connect Time = " + Session.g_lOutdialConnectTime);

Server.logInfo("INFO: BEFORE outdial End Time = " + Session.g_lEndTime);

]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=438 y=166 ?>
          <!--f_nReturnCode-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nReturnCode"/>
        </action>
      </actions>
    </function>
    <function name="CancelSideBarOperatorRequest" start="14" event="SideBarOperatorRequest" returns="i4" >
      <local-vars >
        <var name="f_nReturnCode" type="i4" >0</var>
        <var name="f_oMSObject" type="object" ></var>
      </local-vars>
      <actions >
        <action id="14" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=32 y=242 ?>
          <!--s_strMSG_END_REQUEST_CSR-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strACDControllerIP" transaction="s_strZeroTransactionId" message-name="s_strMsgEndRequestCSR" destination-port="g_nACDControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;RequestId&quot;" value="g_lCSRRequestId"/>
            <parameter tag="&quot;AssignmentId&quot;" value="0"/>
          </SOAP>
          <results >
            <result name="Default" link="9" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: CancelSideBarOperatorRequest");
]]></script>
            <script language="javascript" timing="last" ><![CDATA[Session.g_bSentACDBeginRequest = false;
if (Result.id != 2)
	Server.logError("ERROR: FAIL TO SEND END REQUEST CSR TO ACD CONTROLLER");]]></script>
          </scripts>
        </action>
        <action id="3" plug-in="Standard.Timer.1" ><?xtml-editor x=535 y=285 ?>
          <!--stop beep beep-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="0" id="g_lBeepBeepTimerId" duration=""/>
          <results >
            <result name="Default" link="4" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bBeepBeepTimerFlag = false;]]></script>
          </scripts>
        </action>
        <action id="4" plug-in="Standard.Timer.1" ><?xtml-editor x=26 y=458 ?>
          <!--stop max wait time for CSR-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="0" id="g_lWaitCSRTimerId" duration=""/>
          <results >
            <result name="Default" link="11" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bWaitCSRTimerSet = false;]]></script>
          </scripts>
        </action>
        <action id="6" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=526 y=457 ?>
          <!--s_nSuccess-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nSuccess"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bSideBarOperatorRequest = false;
js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="9" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=307 y=240 ?>
          <!--"psAPISceEndRequest"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceEndRequest&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="3" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_disable_event();
Session.g_nTerminationReason = 1;]]></script>
          </scripts>
        </action>
        <action id="11" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=281 y=455 ?>
          <!--Delete a temp Conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DeleteConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
          </function>
          <results >
            <result name="Default" link="6" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[Session.g_bCreatedTempConf = false;]]></script>
          </scripts>
        </action>
      </actions>
    </function>
    <function name="EventBaseMainMenu" start="2" event="" returns="i4" >
      <actions >
        <action id="2" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=155 y=188 ?>
          <!--set DTMF Detection ON-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;SetDTMFOn&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="1" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: EventBaseMainMenu");]]></script>
          </scripts>
        </action>
        <action id="1" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=403 y=182 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
        </action>
      </actions>
      <text-objects >
        <text-object x-coord="121" y-coord="41" width="345" height="78" text="For now, just return
Need prompts to request/cancel private talk with CSR
Need prompts to request/cancel Q &amp; A" font-name="Times New Roman" size="-16" red="0" green="0" blue="0" weight="0" underline="0" strikeout="0" point-size="12" italic="0"/>
      </text-objects>
    </function>
    <function name="OnConfQandAResponse" start="1" event="ConfQandAResponse" returns="void" >
      <parameters >
        <parameter name="strCCIP" type="string" pass="byref"/>
        <parameter name="nCCPort" type="i4" pass="byref"/>
        <parameter name="strTransactionId" type="string" pass="byref"/>
        <parameter name="nResultCode" type="i4" pass="byref"/>
        <parameter name="strResultMsg" type="string" pass="byref"/>
      </parameters>
      <actions >
        <action id="1" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=66 y=81 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: OnConfQandAResponse");
Server.logInfo("Return code is: " + Session.nResultCode);
Server.logInfo("Return msg is: " + Session.strResultMsg);]]></script>
          </scripts>
        </action>
      </actions>
    </function>
    <function name="CancelOperatorRequest" start="7" event="SideBarOperatorRequest" returns="i4" >
      <local-vars >
        <var name="f_nReturnCode" type="i4" >0</var>
        <var name="f_oMSObject" type="object" ></var>
      </local-vars>
      <actions >
        <action id="7" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=50 y=257 ?>
          <!--s_strMSG_END_REQUEST_CSR-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strACDControllerIP" transaction="s_strZeroTransactionId" message-name="s_strMsgEndRequestCSR" destination-port="g_nACDControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;RequestId&quot;" value="g_lCSRRequestId"/>
            <parameter tag="&quot;AssignmentId&quot;" value="0"/>
          </SOAP>
          <results >
            <result name="Default" link="4" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: CancelOperatorRequest");]]></script>
            <script language="javascript" timing="last" ><![CDATA[Session.g_bSentACDBeginRequest = false;
if (Result.id != 2)
	Server.logError("ERROR: FAIL TO SEND END REQUEST CSR TO ACD CONTROLLER");]]></script>
          </scripts>
        </action>
        <action id="1" plug-in="Standard.Timer.1" ><?xtml-editor x=520 y=246 ?>
          <!--stop beep beep-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="0" id="g_lBeepBeepTimerId" duration=""/>
          <results >
            <result name="Default" link="2" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bBeepBeepTimerFlag = false;]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.Timer.1" ><?xtml-editor x=737 y=242 ?>
          <!--stop max wait time for CSR-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="0" id="g_lWaitCSRTimerId" duration=""/>
          <results >
            <result name="Default" link="3" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bWaitCSRTimerSet = false;]]></script>
          </scripts>
        </action>
        <action id="3" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=958 y=244 ?>
          <!--s_nSuccess-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nSuccess"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="4" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=310 y=252 ?>
          <!--"psAPISceEndRequest"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceEndRequest&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="1" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_disable_event();
Session.g_nTerminationReason = 1;]]></script>
          </scripts>
        </action>
      </actions>
    </function>
    <function name="OnCSREndPrivateTalkRequest" start="12" event="OnConfEndPrivateTalkRequest" returns="void" >
      <parameters >
        <parameter name="strConferenceControllerIP" type="string" pass="byref"/>
        <parameter name="nConferenceControllerPort" type="i4" pass="byref"/>
        <parameter name="strTransactionId" type="string" pass="byref"/>
        <parameter name="nActionCode" type="i4" pass="byref"/>
        <parameter name="strSendResponseBackFlag" type="string" pass="byref"/>
        <parameter name="nConfStatus" type="i4" pass="byref"/>
        <parameter name="lPartySchedId" type="i8" pass="byref"/>
        <parameter name="strPartyDetail" type="string" pass="byref"/>
        <parameter name="p_nAudioMode" type="i4" pass="byref"/>
        <parameter name="strSubConferenceId" type="string" pass="byref"/>
      </parameters>
      <local-vars >
        <var name="f_nReturnCode" type="i4" >0</var>
        <var name="f_bNullString" type="boolean" >0</var>
        <var name="f_strConfControllerIP" type="string" ></var>
        <var name="f_nConfControllerPort" type="i4" >0</var>
        <var name="f_strTransactionId" type="string" ></var>
        <var name="f_strReturnMsg" type="string" ></var>
        <var name="nPromptFirstCaller" type="i4" >0</var>
        <var name="nCallLegCount" type="i4" >0</var>
      </local-vars>
      <actions >
        <action id="12" plug-in="Pactolus.Branch.1" ><?xtml-editor x=28 y=423 ?>
          <!--Dial In?-->
          <results >
            <result name="Default" link="64" stubbed="0"/>
            <result name="g_strOutdialFlag = &quot;T&quot;;" link="65" stubbed="0" >g_strOutdialFlag match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: OnConfEndPrivateTalkRequest");
Server.logInfo("Party Schedule ID is: " + Session.lPartySchedId);
Server.logInfo("Party detail is: " + Session.strPartyDetail);
Session.g_lPartySchedId = Session.lPartySchedId;
Session.g_strPartyDetail = Session.strPartyDetail;
js_disable_event();

Session.g_bPrivateTalkInConference = false;

if ("T" == Session.g_strPrivateTalkFlag)

{

	Session.g_lPrivateTalkEndTime = Server.getUTCTime();

}
Session.g_nReleaseToConfStatus = Session.nConfStatus;
Session.g_nDefaultAudioMode = Session.p_nAudioMode;]]></script>
          </scripts>
        </action>
        <action id="1" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1608 y=195 ?>
          <!--party leave-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;PartyLeave&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="11" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nConfLeaveReason = 4;
Session.g_strConfLeaveMsg = "FAIL TO SEND SIP INVITE PARTY TO HOLD";]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=606 y=123 ?>
          <!--HangUp Caller-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpCaller&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="39" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nConfLeaveReason = 4;
Session.g_strConfLeaveMsg = "FAIL TO SEND SIP INVITE PARTY TO HOLD";]]></script>
          </scripts>
        </action>
        <action id="4" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=473 y=395 ?>
          <!--Remove member from temp conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;RemoveMemberFromConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
          </function>
          <results >
            <result name="Default" link="16" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: ADD PARTY, RETURN TO CONF, REMOVE FROM TEMP CONF.");]]></script>
          </scripts>
        </action>
        <action id="5" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1992 y=356 ?>
          <!--AddMemberToOldConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
            <parameter >g_oCallLegA</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="68" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: ADD PARTY, ADD MEMBER BACK TO OLD CONF.");]]></script>
          </scripts>
        </action>
        <action id="6" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1291 y=491 ?>
          <!--delete temp conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DeleteConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
          </function>
          <results >
            <result name="Default" link="36" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: ADD PARTY, RETURN TO CONF, DELETE TEMP CONF.");]]></script>
            <script language="javascript" timing="last" ><![CDATA[Session.g_bCreatedTempConf = false;]]></script>
          </scripts>
        </action>
        <action id="7" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=3198 y=41 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="8" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2240 y=352 ?>
          <!--success?-->
          <results >
            <result name="Default" link="18" stubbed="0"/>
            <result name="FAILURE" link="2" stubbed="1" >f_nReturnCode == s_nFailure</result>
            <result name="CALLERHUNGUP" link="39" stubbed="1" >f_nReturnCode == s_nCallerHungup</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Result.id == 2)

{

	Session.g_nTerminationReason = 35;

}

else if (Result.id == 3)

{

	Session.g_nTerminationReason = 1;

}]]></script>
          </scripts>
        </action>
        <action id="9" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=134 y=124 ?>
          <!--Remove member from temp conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;RemoveMemberFromConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
          </function>
          <results >
            <result name="Default" link="10" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 36;]]></script>
          </scripts>
        </action>
        <action id="10" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=366 y=124 ?>
          <!--delete temp conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DeleteConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
          </function>
          <results >
            <result name="Default" link="2" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: ADD PARTY, RETURN TO CONF, DELETE TEMP CONF.");]]></script>
            <script language="javascript" timing="last" ><![CDATA[Session.g_bCreatedTempConf = false;]]></script>
          </scripts>
        </action>
        <action id="11" plug-in="Standard.EndSession.1" ><?xtml-editor x=1599 y=127 ?></action>
        <action id="14" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1529 y=489 ?>
          <!--Dial In?-->
          <results >
            <result name="Default" link="40" stubbed="0"/>
            <result name="g_strOutdialFlag = &quot;T&quot;;" link="41" stubbed="0" >g_strOutdialFlag match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (Session.g_bCurrentlyInSubConf)
{
	if (0 == Session.p_nAudioMode)
	{
		Session.g_oSubConfMS.bMuteFlag = false;
		Session.g_oSubConfMS.bDeafFlag = false;
	}
	else if (2 == Session.p_nAudioMode)
	{
		Session.g_oSubConfMS.bMuteFlag = true;
		Session.g_oSubConfMS.bDeafFlag = false;
	}
	else if (1 == Session.p_nAudioMode)
	{
		Session.g_oSubConfMS.bMuteFlag = true;
		Session.g_oSubConfMS.bDeafFlag = true;
	}
}
else
{
	if (0 == Session.p_nAudioMode)
	{
		Session.g_oMS.bMuteFlag = false;
		Session.g_oMS.bDeafFlag = false;
	}
	else if (2 == Session.p_nAudioMode)
	{
		Session.g_oMS.bMuteFlag = true;
		Session.g_oMS.bDeafFlag = false;
	}
	else if (1 == Session.p_nAudioMode)
	{
		Session.g_oMS.bMuteFlag = true;
		Session.g_oMS.bDeafFlag = true;
	}
}]]></script>
          </scripts>
        </action>
        <action id="15" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1767 y=865 ?>
          <!--"AddMemberToConference"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
            <parameter >g_oCallLegB</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="34" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: ADD PARTY, ADD MEMBER BACK TO OLD CONF.");
Session.g_oMS.bMuteFlag = true;
Session.g_oMS.bDeafFlag = true;]]></script>
          </scripts>
        </action>
        <action id="16" plug-in="Pactolus.Branch.1" ><?xtml-editor x=816 y=571 ?>
          <!--bridge?-->
          <results >
            <result name="Default" link="20" stubbed="0"/>
            <result name="0 or 5 -  bridge" link="19" stubbed="0" >nActionCode == 0
OR nActionCode == 5</result>
          </results>
        </action>
        <action id="17" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=2752 y=465 ?>
          <!--response SUCCESS-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strConferenceControllerIP" transaction="strTransactionId" message-name="s_strCSREndPrivateTalkResponse" destination-port="nConferenceControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="s_nSuccess"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
          </SOAP>
          <results >
            <result name="Default" link="82" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "SUCCESS CONF END PRIVATE TALK";]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (0 == Session.p_nAudioMode)
{
	Session.g_bHoldState = false;
	Session.g_bMutedState = false;
}
else if (2 == Session.p_nAudioMode)
{
	Session.g_bHoldState = false;
	Session.g_bMutedState = true;
}
else if (1 == Session.p_nAudioMode)
{
	Session.g_bHoldState = true;
	Session.g_bMutedState = false;
}]]></script>
          </scripts>
        </action>
        <action id="18" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2497 y=352 ?>
          <!--send response back?-->
          <results >
            <result name="Default" link="59" stubbed="0"/>
            <result name="strSendResponseBackFlag" link="17" stubbed="0" >strSendResponseBackFlag match "T"</result>
          </results>
        </action>
        <action id="19" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1043 y=493 ?>
          <!--private talk?-->
          <results >
            <result name="Default" link="6" stubbed="0"/>
            <result name="strPrivateTalkFlag" link="36" stubbed="1" >g_strPrivateTalkFlag match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (2 == Result.id)

{

	Session.g_oMS.strConferenceId = Session.g_strConfResource;

}]]></script>
          </scripts>
        </action>
        <action id="20" plug-in="Pactolus.Branch.1" ><?xtml-editor x=184 y=810 ?>
          <!--private talk?-->
          <results >
            <result name="Default" link="22" stubbed="0"/>
            <result name="strPrivateTalkFlag" link="21" stubbed="0" >g_strPrivateTalkFlag match "T"</result>
          </results>
        </action>
        <action id="21" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=420 y=910 ?>
          <!--HangUpPartyB-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpParty&quot;" return="f_nReturnCode" external-function="1" library="lib_callcontrol.xml" >
            <parameter >g_oCallLegB</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="24" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nConfLeaveReason = 20;
Session.g_strConfLeaveMsg = "CSR RELEASE HANG UP";]]></script>
          </scripts>
        </action>
        <action id="22" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=407 y=785 ?>
          <!--"HangUpCaller"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpCaller&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="24" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nConfLeaveReason = 20;
Session.g_strConfLeaveMsg = "CSR RELEASE HANG UP";]]></script>
          </scripts>
        </action>
        <action id="23" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=948 y=898 ?>
          <!--response SUCCESS-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strConferenceControllerIP" transaction="strTransactionId" message-name="s_strCSREndPrivateTalkResponse" destination-port="nConferenceControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="s_nSuccess"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
          </SOAP>
          <results >
            <result name="Default" link="11" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "SUCCESS CONF END PRIVATE TALK";]]></script>
          </scripts>
        </action>
        <action id="24" plug-in="Pactolus.Branch.1" ><?xtml-editor x=687 y=904 ?>
          <!--send response back?-->
          <results >
            <result name="Default" link="11" stubbed="1"/>
            <result name="strSendResponseBackFlag" link="23" stubbed="0" >strSendResponseBackFlag match "T"</result>
          </results>
        </action>
        <action id="26" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2937 y=1054 ?>
          <!--play tone or name?-->
          <results >
            <result name="Default" link="103" stubbed="1"/>
            <result name="play tone - 1" link="108" stubbed="0" >g_nArriveDepartOption == 1</result>
            <result name="play name - 3" link="27" stubbed="0" >g_nArriveDepartOption == 3</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_disable_event();

Session.g_lMSConnectTime = Server.getUTCTime();]]></script>
          </scripts>
        </action>
        <action id="27" plug-in="Pactolus.Branch.1" ><?xtml-editor x=3056 y=1261 ?>
          <!--null string-->
          <results >
            <result name="Default" link="109" stubbed="0"/>
            <result name="f_bNullString == true" link="108" stubbed="0" >f_bNullString == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("RECORDED NAME IS:  " + Session.g_strCallerRecordedName);

Server.logInfo("RECORDED NAME LENGTH IS:  " + Session.g_nRecordNameLength);

if (Session.g_nRecordNameLength <= 0)

{

	Session.f_bNullString = true;

}

else

{

	Session.f_bNullString = false;

}]]></script>
          </scripts>
        </action>
        <action id="28" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=3428 y=1269 ?>
          <!--xxx has joined-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="&quot;*&quot;" endpoint="g_oMS.strConferenceId" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="url" >g_strCallerRecordedName</audio>
            <audio type="index" >938</audio>
          </play>
          <results >
            <result name="Default" link="103" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="29" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=3299 y=1155 ?>
          <!--Play Join Tone to conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;PlayPromptToConference&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
            <parameter >g_strLanguage</parameter>
            <parameter >s_nPromptArrivalTone</parameter>
          </function>
          <results >
            <result name="Default" link="103" stubbed="1"/>
          </results>
        </action>
        <action id="30" plug-in="Pactolus.Branch.1" ><?xtml-editor x=3400 y=895 ?>
          <!--subscriber?-->
          <results >
            <result name="Default" link="45" stubbed="1"/>
            <result name="g_strIsSubscriberFlag== &quot;T&quot;" link="31" stubbed="0" >g_strIsSubscriberFlag match "T"</result>
          </results>
        </action>
        <action id="31" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=3656 y=893 ?>
          <!--GetAndPlayBalance-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;GetAndPlayBalance&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="45" stubbed="1"/>
          </results>
        </action>
        <action id="32" plug-in="Pactolus.Branch.1" ><?xtml-editor x=3168 y=895 ?>
          <!--prepaid conference-->
          <results >
            <result name="Default" link="45" stubbed="1"/>
            <result name="billing type == 1?" link="30" stubbed="0" >g_nBillingType == 1</result>
          </results>
        </action>
        <action id="33" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2937 y=898 ?>
          <!--party join to conf controller-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;PartyJoin&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="32" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[js_disable_event();]]></script>
          </scripts>
        </action>
        <action id="34" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1986 y=856 ?>
          <!--success?-->
          <results >
            <result name="Default" link="101" stubbed="0"/>
            <result name="FAILURE" link="2" stubbed="1" >f_nReturnCode == s_nFailure</result>
            <result name="CALLERHUNGUP" link="38" stubbed="1" >f_nReturnCode == s_nCallerHungup</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Result.id == 2)

{

	Session.g_nTerminationReason = 35;

}

else if (Result.id == 3)

{

	Session.g_nTerminationReason = 1;

}]]></script>
          </scripts>
        </action>
        <action id="35" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2006 y=577 ?>
          <!--AddMemberToOldConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
            <parameter >g_oCallLegB</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="68" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: ADD PARTY, ADD MEMBER BACK TO OLD CONF.");]]></script>
          </scripts>
        </action>
        <action id="36" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1536 y=675 ?>
          <!--private talk?-->
          <results >
            <result name="Default" link="14" stubbed="0"/>
            <result name="strPrivateTalkFlag" link="81" stubbed="0" >g_strPrivateTalkFlag match "T"</result>
          </results>
        </action>
        <action id="37" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1333 y=114 ?>
          <!--private talk?-->
          <results >
            <result name="Default" link="11" stubbed="0"/>
            <result name="strPrivateTalkFlag" link="1" stubbed="0" >g_strPrivateTalkFlag match "T"</result>
          </results>
        </action>
        <action id="38" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1093 y=116 ?>
          <!--response s_nFailure-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strConferenceControllerIP" transaction="strTransactionId" message-name="s_strCSREndPrivateTalkResponse" destination-port="nConferenceControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="s_nFailure"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
          </SOAP>
          <results >
            <result name="Default" link="37" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "FAILS CONF END PRIVATE TALK";]]></script>
          </scripts>
        </action>
        <action id="39" plug-in="Pactolus.Branch.1" ><?xtml-editor x=844 y=116 ?>
          <!--send response back?-->
          <results >
            <result name="Default" link="37" stubbed="1"/>
            <result name="strSendResponseBackFlag" link="38" stubbed="0" >strSendResponseBackFlag match "T"</result>
          </results>
        </action>
        <action id="40" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1737 y=383 ?>
          <!--in sub conf?-->
          <results >
            <result name="Default" link="5" stubbed="0"/>
            <result name="g_bCurrentlyInSubConf" link="42" stubbed="0" >g_bCurrentlyInSubConf == true</result>
          </results>
        </action>
        <action id="41" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1752 y=580 ?>
          <!--in sub conf?-->
          <results >
            <result name="Default" link="35" stubbed="0"/>
            <result name="g_bCurrentlyInSubConf" link="43" stubbed="0" >g_bCurrentlyInSubConf == true</result>
          </results>
        </action>
        <action id="42" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2013 y=467 ?>
          <!--AddMemberToOldConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oSubConfMS</parameter>
            <parameter >g_oCallLegA</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="8" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: ADD PARTY, ADD MEMBER BACK TO OLD CONF.");]]></script>
          </scripts>
        </action>
        <action id="43" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2022 y=685 ?>
          <!--AddMemberToOldConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oSubConfMS</parameter>
            <parameter >g_oCallLegB</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="8" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: ADD PARTY, ADD MEMBER BACK TO OLD CONF.");]]></script>
          </scripts>
        </action>
        <action id="44" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=3641 y=1159 ?>
          <!--"ChangeToMutedMode"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ChangeToMutedMode&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="2" stubbed="1"/>
            <result name="SUCCESS" link="26" stubbed="1" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[// if (true == Session.g_bMuteThisParty || Session.g_strMuteFlag == "T")

if (true == Session.g_bMuteThisParty)

{

	Session.g_oMS.bMuteFlag = true;

	Session.g_bMutedState = true;

	Session.g_nPromptSelfMuteUnMute = 908;
	
	if ("T" == Session.g_strMuteFlag)
	{
		Session.g_bMutedByMod = true;
	}
	else
	{
		Session.g_bMutedByMod = false;
	}

}

else

{

	Session.g_oMS.bMuteFlag = false;

}

Session.g_oMS.bDeafFlag = false;]]></script>
          </scripts>
        </action>
        <action id="45" plug-in="Pactolus.Branch.1" ><?xtml-editor x=3393 y=1031 ?>
          <!--muted?-->
          <results >
            <result name="Default" link="66" stubbed="0"/>
            <result name="Hold" link="83" stubbed="1" >p_nAudioMode == 1</result>
            <result name="Mute" link="44" stubbed="0" >g_bMuteThisParty == true
OR p_nAudioMode == 2</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[// if (true == Session.g_bMuteThisParty || Session.g_strMuteFlag == "T")

if (true == Session.g_bMuteThisParty)
{
	Session.g_oMS.bMuteFlag = true;
	Session.g_bMutedState = true;
	if ("T" == Session.g_strMuteFlag)
	{
		Session.g_bMutedByMod = true;
	}
	else
	{
		Session.g_bMutedByMod = false;
	}
	Session.g_nPromptSelfMuteUnMute = 908;
}
else
{
	Session.g_oMS.bMuteFlag = false;
}
Session.g_oMS.bDeafFlag = false;
Server.logInfo("INFO: MODIFY MEMBER TO BACK TO CONFERENCE.");
if (0 == Session.p_nAudioMode)
{
	Session.g_oMS.bMuteFlag = false;
	Session.g_oMS.bDeafFlag = false;
	Session.g_bMutedState = false;
	Session.g_bHoldState = false;
}
else if (2 == Session.p_nAudioMode)
{
	Session.g_oMS.bMuteFlag = true;
	Session.g_oMS.bDeafFlag = false;
	Session.g_bMutedState = true;
	Session.g_bHoldState = false;
}
else if (1 == Session.p_nAudioMode)
{
	Session.g_oMS.bMuteFlag = true;
	Session.g_oMS.bDeafFlag = true;
	Session.g_bHoldState = true;
	Session.g_bMutedState = false;
}]]></script>
          </scripts>
        </action>
        <action id="59" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2737 y=300 ?>
          <!--set DTMF detection ON-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;SetDTMFOn&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="60" stubbed="0"/>
          </results>
        </action>
        <action id="60" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2948 y=45 ?>
          <results >
            <result name="Default" link="7" stubbed="0"/>
            <result name="Time &gt; 0" link="61" stubbed="0" >g_nCkReInviteTime &gt; 0</result>
          </results>
        </action>
        <action id="61" plug-in="Pactolus.Branch.1" ><?xtml-editor x=3196 y=145 ?>
          <!--Dial In?-->
          <results >
            <result name="Default" link="62" stubbed="0"/>
            <result name="g_strOutdialFlag = &quot;T&quot;" link="63" stubbed="0" >g_strOutdialFlag match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("END PRIVATE TALK, RESET TIMER TO CHECK FOR REINVITE");]]></script>
          </scripts>
        </action>
        <action id="62" plug-in="Standard.Timer.1" ><?xtml-editor x=3451 y=109 ?>
          <!--ck reInvite timer-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lCkReInviteTimerIdA" duration="g_nCkReInviteTime"/>
          <results >
            <result name="Default" link="7" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bCkReInviteTimerFlagA = true;
Server.logInfo("SET TIMER TO CHECK FOR REINVITE A LEG");]]></script>
          </scripts>
        </action>
        <action id="63" plug-in="Standard.Timer.1" ><?xtml-editor x=3469 y=225 ?>
          <!--ck reInvite timer B-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lCkReInviteTimerIdB" duration="g_nCkReInviteTime"/>
          <results >
            <result name="Default" link="7" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bCkReInviteTimerFlagB = true;
Server.logInfo("SET TIMER TO CHECK FOR REINVITE B LEG");]]></script>
          </scripts>
        </action>
        <action id="64" plug-in="Standard.Timer.1" ><?xtml-editor x=257 y=399 ?>
          <!--stop ck reInvite timer-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="0" id="g_lCkReInviteTimerIdA" duration=""/>
          <results >
            <result name="Default" link="4" stubbed="0"/>
          </results>
        </action>
        <action id="65" plug-in="Standard.Timer.1" ><?xtml-editor x=222 y=516 ?>
          <!--stop ck reInvite timer B-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="0" id="g_lCkReInviteTimerIdB" duration=""/>
          <results >
            <result name="Default" link="4" stubbed="1"/>
          </results>
        </action>
        <action id="66" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=3623 y=1007 ?>
          <!--"ChangeToConferenceMode"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ChangeToConferenceMode&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="2" stubbed="1"/>
            <result name="SUCCESS" link="26" stubbed="1" >f_nReturnCode == s_nSuccess</result>
          </results>
        </action>
        <action id="67" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2668 y=847 ?>
          <!--play join as prompt-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;PlayJoinAsPrompt&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="100" stubbed="1"/>
          </results>
        </action>
        <action id="68" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2231 y=244 ?>
          <!--ConfMSConnectionIDChangedNotify-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ConfMSConnectionIDChangedNotify&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="8" stubbed="1"/>
          </results>
        </action>
        <action id="69" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1259 y=1519 ?>
          <!--get billing code?-->
          <results >
            <result name="Default" link="73" stubbed="0"/>
            <result name="g_strBillingCodeFlag==T" link="75" stubbed="0" >g_strBillingCodeFlag match "T"</result>
          </results>
        </action>
        <action id="70" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1774 y=1611 ?>
          <!--Collect billing code-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;(xxxxxxxxxx|x.T|x.#)&quot;" language="g_strLanguage" digits="g_strBillingCodeNumber" retry-count="g_nMaxRetryAllowed" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >943</audio>
            <audio type="index" >580</audio>
            <timeout-prompt type="index" >552</timeout-prompt>
          </play>
          <results >
            <result name="Default" link="71" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="71" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2026 y=1604 ?>
          <!--set billing code-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceSetBillingCode&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="72" stubbed="0"/>
          </results>
        </action>
        <action id="72" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2265 y=1601 ?>
          <!--"RecordCallerName"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;RecordCallerName&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="77" stubbed="0"/>
          </results>
        </action>
        <action id="73" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1514 y=1478 ?>
          <!--record name?-->
          <results >
            <result name="Default" link="15" stubbed="1"/>
            <result name="RecordNameFlag==&quot;T&quot;" link="74" stubbed="0" >g_strRecordNamesFlag match "T"</result>
          </results>
        </action>
        <action id="74" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1761 y=1473 ?>
          <!--"MSOutdialParty"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;MSOutdialParty&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oCallLegB</parameter>
            <parameter >g_oMS</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="15" stubbed="1"/>
            <result name="SUCCESS" link="72" stubbed="1" >f_nReturnCode == s_nSuccess</result>
            <result name="CALLER HUNGUP" link="39" stubbed="1" >f_nReturnCode == s_nCallerHungup</result>
          </results>
        </action>
        <action id="75" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1531 y=1620 ?>
          <!--"MSOutdialParty"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;MSOutdialParty&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oCallLegB</parameter>
            <parameter >g_oMS</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="15" stubbed="1"/>
            <result name="SUCCESS" link="70" stubbed="0" >f_nReturnCode == s_nSuccess</result>
            <result name="CALLER HUNGUP" link="39" stubbed="1" >f_nReturnCode == s_nCallerHungup</result>
          </results>
        </action>
        <action id="77" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2287 y=1733 ?>
          <!--DeleteMSConnection-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DeleteMSConnection&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="15" stubbed="1"/>
          </results>
        </action>
        <action id="81" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1761 y=770 ?>
          <!--"psAPISceConfSetPartyDetail"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceConfSetPartyDetail&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="104" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Session.f_nReturnCode != Session.s_nSuccess)
{
	Server.logError("ERROR: FAIL TO SET PARTY DETAIL, RESET PARTY SCHEDULE ID");
	Session.g_lPartySchedId = Session.lPartySchedId;
	Session.g_strPartyDetail = Session.strPartyDetail;
}]]></script>
          </scripts>
        </action>
        <action id="82" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2987 y=478 ?>
          <!--AudioMode == Hold-->
          <results >
            <result name="Default" link="59" stubbed="1"/>
            <result name="p_nAudioMode == 1" link="83" stubbed="0" >p_nAudioMode == 1</result>
          </results>
        </action>
        <action id="83" plug-in="Pactolus.Branch.1" ><?xtml-editor x=3209 y=475 ?>
          <!--MOH?-->
          <results >
            <result name="Default" link="89" stubbed="1"/>
            <result name="g_strMusicOnHoldFlag==&quot;T&quot;" link="91" stubbed="0" >g_strMusicOnHoldFlag match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bDontPlayContinueToHold = true;]]></script>
          </scripts>
        </action>
        <action id="85" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2900 y=712 ?>
          <!--Remove member from conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;RemoveMemberFromConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oSubConfMS</parameter>
          </function>
          <results >
            <result name="Default" link="86" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: CONF HOLD PARTY REQUEST, REMOVE MEMBER FROM CONFERENCE.");]]></script>
          </scripts>
        </action>
        <action id="86" plug-in="Standard.Timer.1" ><?xtml-editor x=3111 y=707 ?>
          <!--5 secs to connect MOH-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lMOHTimerId" duration="s_nPreMohTime"/>
          <results >
            <result name="Default" link="7" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bMOHTimerFlag = true;
Session.g_bDtmfCollectionOnHold = true;]]></script>
          </scripts>
        </action>
        <action id="87" plug-in="Standard.Timer.1" ><?xtml-editor x=3628 y=328 ?>
          <!--play please hold every 10 secs-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lHoldTimerId" duration="s_nSleepTime"/>
          <results >
            <result name="Default" link="7" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bHoldTimerFlag = true;]]></script>
          </scripts>
        </action>
        <action id="88" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=3425 y=323 ?>
          <!--please hold-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >898</audio>
          </play>
          <results >
            <result name="Default" link="87" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="89" plug-in="Pactolus.Branch.1" ><?xtml-editor x=3207 y=335 ?>
          <!--in sub conf?-->
          <results >
            <result name="Default" link="88" stubbed="0"/>
            <result name="g_bCurrentlyInSubConf" link="90" stubbed="0" >g_bCurrentlyInSubConf == true</result>
          </results>
        </action>
        <action id="90" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=3431 y=454 ?>
          <!--please hold-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oSubConfMS.strConnectionId" endpoint="g_oSubConfMS.strEndPoint" callid="g_oSubConfMS.strCallId" repeat="1" timeout="10" ms-type="g_oSubConfMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >898</audio>
          </play>
          <results >
            <result name="Default" link="87" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="91" plug-in="Pactolus.Branch.1" ><?xtml-editor x=3409 y=694 ?>
          <!--in sub conf?-->
          <results >
            <result name="Default" link="92" stubbed="0"/>
            <result name="g_bCurrentlyInSubConf" link="85" stubbed="1" >g_bCurrentlyInSubConf == true</result>
          </results>
        </action>
        <action id="92" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=3633 y=694 ?>
          <!--Remove member from conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;RemoveMemberFromConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="86" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: CONF HOLD PARTY REQUEST, REMOVE MEMBER FROM CONFERENCE.");]]></script>
          </scripts>
        </action>
        <action id="93" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1758 y=1177 ?>
          <!--play current number of participant?-->
          <results >
            <result name="Default" link="33" stubbed="1"/>
            <result name="g_strPlayPartyCountFlag == &quot;T&quot;" link="96" stubbed="0" >g_strPlayPartyCountFlag match "T"</result>
          </results>
        </action>
        <action id="94" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2231 y=1230 ?>
          <!--there is-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >925</audio>
            <audio type="number" >1</audio>
            <audio type="index" >927</audio>
            <audio type="index" >929</audio>
          </play>
          <results >
            <result name="Default" link="33" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="95" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2245 y=1379 ?>
          <!--there are-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >926</audio>
            <audio type="number" >nCallLegCount</audio>
            <audio type="index" >928</audio>
            <audio type="index" >929</audio>
          </play>
          <results >
            <result name="Default" link="33" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.nCallLegCount = Session.g_nCurrentNbrCallegs - 1;]]></script>
          </scripts>
        </action>
        <action id="96" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1986 y=1171 ?>
          <!--participants > 1-->
          <results >
            <result name="Default" link="97" stubbed="0"/>
            <result name="currentNbrCallLeg == 2" link="94" stubbed="0" >g_nCurrentNbrCallegs == 2</result>
            <result name="currentNbrCallLeg &gt; 2" link="95" stubbed="0" >g_nCurrentNbrCallegs &gt; 2</result>
          </results>
        </action>
        <action id="97" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2220 y=1082 ?>
          <!--you are the first one-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >nPromptFirstCaller</audio>
          </play>
          <results >
            <result name="Default" link="33" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="98" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2479 y=1222 ?>
          <!--silence-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="1" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >s_nPromptSilence</audio>
          </play>
          <results >
            <result name="Default" link="33" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="99" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2013 y=973 ?>
          <!--you are the first one-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >nPromptFirstCaller</audio>
          </play>
          <results >
            <result name="Default" link="33" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="100" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1763 y=983 ?>
          <!--1st caller &&
speaker &&
play 1st caller-->
          <results >
            <result name="Default" link="93" stubbed="0"/>
            <result name="play first caller" link="99" stubbed="0" >g_nCurrentNbrCallegs == 1
AND g_strPlayFirstCaller match "T"
AND g_nDefaultAudioMode == 0</result>
            <result name="first caller , don't play" link="33" stubbed="1" >g_nCurrentNbrCallegs == 1
AND (g_nDefaultAudioMode != 0
OR g_strPlayFirstCaller match "F")</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (1 == Session.g_nDnisIdentifiedConfFlag)
{
	Session.nPromptFirstCaller = 4140;
}
else
{
	Session.nPromptFirstCaller = Session.s_nPromptFirstCaller;
}]]></script>
          </scripts>
        </action>
        <action id="101" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2222 y=847 ?>
          <!--send response back?-->
          <results >
            <result name="Default" link="67" stubbed="1"/>
            <result name="strSendResponseBackFlag" link="102" stubbed="0" >strSendResponseBackFlag match "T"</result>
          </results>
        </action>
        <action id="102" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=2449 y=848 ?>
          <!--response SUCCESS-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strConferenceControllerIP" transaction="strTransactionId" message-name="s_strCSREndPrivateTalkResponse" destination-port="nConferenceControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="s_nSuccess"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
          </SOAP>
          <results >
            <result name="Default" link="67" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "SUCCESS CONF END PRIVATE TALK";]]></script>
          </scripts>
        </action>
        <action id="103" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=3650 y=1271 ?>
          <!--set DTMF detection ON-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;SetDTMFOn&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="60" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (0 == Session.p_nAudioMode)
{
	Session.g_bHoldState = false;
	Session.g_bMutedState = false;
}
else if (2 == Session.p_nAudioMode)
{
	Session.g_bHoldState = false;
	Session.g_bMutedState = true;
}
else if (1 == Session.p_nAudioMode)
{
	Session.g_bHoldState = true;
	Session.g_bMutedState = false;
}]]></script>
          </scripts>
        </action>
        <action id="104" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1989 y=763 ?>
          <!--move directly into sub?-->
          <results >
            <result name="Default" link="69" stubbed="1"/>
            <result name="g_bMoveDirectlyInSubConf" link="106" stubbed="0" >g_bMoveDirectlyInSubConf == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("g_strSubConferenceId IS: " + Session.g_strSubConferenceId);
Server.logInfo("strSubConferenceId IS: " + Session.strSubConferenceId);
Server.logInfo("strSubConferenceId.length IS: " + Session.strSubConferenceId.length);
Session.g_strSubConferenceId = Session.strSubConferenceId;

if (Session.strSubConferenceId.length > 0)
{
	Server.logInfo("strSubConferenceId.length IS GREATER THAN ZERO");
	Session.g_bMoveDirectlyInSubConf = true;
}
else
{
	Server.logInfo("strSubConferenceId.length IS LESS THAN ZERO");
	Session.g_bMoveDirectlyInSubConf = false;
}
Server.logInfo("MOVE DIRECTLY TO SUB CONF FLAG IS: " + Session.g_bMoveDirectlyInSubConf);]]></script>
          </scripts>
        </action>
        <action id="105" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2674 y=712 ?>
          <!--Goto MAIN-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;Main&quot;" return="" external-function="0" library="" >
            <parameter >g_nCallerCurrentState</parameter>
          </function>
          <results >
            <result name="Default" link="7" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nCallerCurrentState = Session.s_nStateAddToConference;]]></script>
          </scripts>
        </action>
        <action id="106" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2220 y=715 ?>
          <!--send response back?-->
          <results >
            <result name="Default" link="105" stubbed="1"/>
            <result name="strSendResponseBackFlag" link="107" stubbed="0" >strSendResponseBackFlag match "T"</result>
          </results>
        </action>
        <action id="107" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=2447 y=710 ?>
          <!--response SUCCESS-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strConferenceControllerIP" transaction="strTransactionId" message-name="s_strCSREndPrivateTalkResponse" destination-port="nConferenceControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="s_nSuccess"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
          </SOAP>
          <results >
            <result name="Default" link="105" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "SUCCESS CONF END PRIVATE TALK";]]></script>
          </scripts>
        </action>
        <action id="108" plug-in="Pactolus.Branch.1" ><?xtml-editor x=3148 y=1012 ?>
          <!--Is Global Music On?-->
          <results >
            <result name="Default" link="29" stubbed="0"/>
            <result name="globaMusicFlag==&quot;T&quot;" link="103" stubbed="1" >g_strGlobalMusicOnFlag match "T"</result>
          </results>
        </action>
        <action id="109" plug-in="Pactolus.Branch.1" ><?xtml-editor x=3239 y=1278 ?>
          <!--Is Global Music On?-->
          <results >
            <result name="Default" link="28" stubbed="0"/>
            <result name="globaMusicFlag==&quot;T&quot;" link="103" stubbed="0" >g_strGlobalMusicOnFlag match "T"</result>
          </results>
        </action>
      </actions>
      <text-objects >
        <text-object x-coord="217" y-coord="702" width="313" height="47" text="if private talk party, just remove from conf, hangup, and either repsone or not depend on flag" font-name="Times New Roman" size="-16" red="0" green="0" blue="0" weight="0" underline="0" strikeout="0" point-size="12" italic="0"/>
      </text-objects>
    </function>
    <function name="EventConfGetPasscode" start="76" event="GetPassCode" returns="i4" >
      <local-vars >
        <var name="f_sCounter" type="i2" >0</var>
        <var name="f_nReturnCode" type="i4" >0</var>
        <var name="f_sMaxRetry" type="i2" >0</var>
        <var name="f_nTempInt" type="i4" >0</var>
        <var name="f_lCurrentTime" type="i8" >0</var>
        <var name="f_strPongSessionId" type="string" ></var>
        <var name="f_nPromptToPlay" type="i4" >0</var>
        <var name="f_bRouteToCSR" type="boolean" >0</var>
        <var name="f_strTerminationDigit" type="string" ></var>
        <var name="f_nCallLegCount" type="i4" >0</var>
        <var name="f_nWaitForResCounter" type="i4" >0</var>
        <var name="f_bPlayPleaseHold" type="boolean" >0</var>
        <var name="f_nPassCodeStatus" type="i4" >0</var>
        <var name="f_strTempString" type="string" ></var>
        <var name="f_bEmptyString" type="boolean" >0</var>
        <var name="s_nPromptTooEarly" type="i4" >0</var>
      </local-vars>
      <actions >
        <action id="76" plug-in="Pactolus.Branch.1" ><?xtml-editor x=77 y=521 ?>
          <!--1. Get passcode
2. no passcode, non speaker
3. no passcode, speaker-->
          <results >
            <result name="Default" link="6" stubbed="0"/>
            <result name="g_bTransferParty" link="2" stubbed="0" >g_bTransferParty == true</result>
            <result name="2 == g_nEventDnisType" link="79" stubbed="0" >g_nEventDnisType == 2</result>
            <result name="3 == g_nEventDnisType" link="79" stubbed="1" >g_nEventDnisType == 3</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: EventConfGetPassCode");
Session.g_bFirstTimeGetPasscode = false;]]></script>
          </scripts>
        </action>
        <action id="1" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=869 y=512 ?>
          <!--Collect pass code-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="g_strPassCodeDigitMap" language="g_strLanguage" digits="g_strPassCode" retry-count="" clear-digits="0" terminating-digit="f_strTerminationDigit" quick-collect="0" digit-timer="" >
            <audio type="silence" >s_fConfStartCallDelay</audio>
            <audio type="index" >s_nPromptGetPasscode</audio>
          </play>
          <results >
            <result name="Default" link="21" stubbed="1"/>
            <result name="Success" link="32" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout" link="65" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strPassCode = "";
Session.f_strTerminationDigit = "";]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=238 y=1387 ?>
          <!--authenticate pass code-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceAuthConfPassCode&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="30" stubbed="1"/>
            <result name="0 or 1 or 3 - SUCCESS" link="67" stubbed="1" >f_nReturnCode == 0
OR f_nReturnCode == 1
OR f_nReturnCode == 3</result>
            <result name="!0 or !1 and !2" link="8" stubbed="1" >g_bTransferParty == true
AND f_nReturnCode != 0
AND f_nReturnCode != 1
AND f_nReturnCode != 2</result>
            <result name="2 - WAIT FOR RESOURCE" link="20" stubbed="0" >f_nReturnCode == 2</result>
            <result name="-2 - TOO EARLY" link="30" stubbed="1" >f_nReturnCode == -2</result>
            <result name="-8 - PASSCODE INUSED" link="30" stubbed="1" >f_nReturnCode == -8</result>
            <result name="-11 - WAIT FOR MOD" link="55" stubbed="0" >f_nReturnCode == s_nWaitForMod</result>
            <result name="-1 INVALID" link="3" stubbed="0" >f_nReturnCode == -1</result>
            <result name="-15 INSUFFICIENT BALANCE" link="30" stubbed="1" >f_nReturnCode == -15</result>
            <result name="-16 PIN LOCKED" link="30" stubbed="1" >f_nReturnCode == -16</result>
            <result name="-14 WRONG DAY" link="30" stubbed="1" >f_nReturnCode == -14</result>
            <result name="-18 CANCELLED" link="30" stubbed="1" >f_nReturnCode == -18</result>
            <result name="-21- WRONG SITE" link="67" stubbed="1" >f_nReturnCode == -21</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_nReturnCode = -50;
if (Session.g_bTransferParty)
{
	Session.g_strPassCode = Session.g_strTransferToPasscode;
}
js_disable_event();]]></script>
            <script language="javascript" timing="last" ><![CDATA[switch (Session.f_nReturnCode)

{
	case -2:
		Server.logInfo("INFO: TOO EALRY");
		Session.g_nInvalidConferenceCode = 600;
		Session.g_strInvalidConferenceMsg = "TOO EARLY";
		break;
	case -3:
		Server.logInfo("INFO: TOO LATE PASSCODE");
		Session.g_nTerminationReason = 20;
		Session.f_nPromptToPlay = Session.s_nPromptTooLate;
		Session.g_nInvalidConferenceCode = 601;
		Session.g_strInvalidConferenceMsg = "TOO LATE";
		break;
	case -4:
		Server.logInfo("INFO: DISABLE SUBSCRIBER");
		Session.g_nTerminationReason = 4;
		Session.f_nPromptToPlay = Session.s_nPromptDisableSub;
		Session.g_nInvalidConferenceCode = 602;
		Session.g_strInvalidConferenceMsg = "SUBSCRIBER DISABLED";
		break;
	case -5:
		Server.logInfo("INFO: MAX ATTENDEES");
		Session.g_nTerminationReason = 15;
		Session.f_nPromptToPlay = Session.s_nPromptMaxAttendeesReach;
		Session.g_nInvalidConferenceCode = 603;
		Session.g_strInvalidConferenceMsg = "EXCEED MAX ATTENDEES";
		break;
	case -6:
		Server.logInfo("INFO: CONF LOCKED");
		Session.g_nTerminationReason = 16;
		Session.f_nPromptToPlay = Session.s_nPromptConfLocked;
		Session.g_nInvalidConferenceCode = 604;
		Session.g_strInvalidConferenceMsg = "CONFERENCE IS LOCKED";
		break;
	case -7:
		Server.logInfo("INFO: CONF ALREADY ENDED");
		Session.g_nTerminationReason = 2;
		Session.f_nPromptToPlay = Session.s_nPromptConfEnded;
		Session.g_nInvalidConferenceCode = 605;
		Session.g_strInvalidConferenceMsg = "CONFERENCE IS ALREADY ENDED";
		break;
	case -8:
		Server.logInfo("INFO: PASSCODE IS INUSED");
		Session.g_nInvalidConferenceCode = 606;
		Session.g_strInvalidConferenceMsg = "PASSCODE IS INUSED";
		break;
	case -9:
		Server.logInfo("INFO: MOD NOT IN");
		Session.g_nTerminationReason = 22;
		Session.f_nPromptToPlay = Session.s_nPromptModNotArrive;
		Session.g_nInvalidConferenceCode = 607;
		Session.g_strInvalidConferenceMsg = "MODERATOR IS NOT IN";
		break;
	case -10:
		Server.logError("ERROR: NO CONF CONTROLLER");
		Session.g_nTerminationReason = 39;
		Session.f_nPromptToPlay = Session.s_nPromptNoConfController;
		Session.g_nInvalidConferenceCode = 608;
		Session.g_strInvalidConferenceMsg = "NO CONFERENCE CONTROLLER";
		break;
	case -12:
		Server.logInfo("INFO: CORP ACCOUNT DISABLED");
		Session.g_nInvalidConferenceCode = 609;
		Session.g_strInvalidConferenceMsg = "CORP ACCOUNT DISABLED";
		break;
	case -13:
		Server.logInfo("INFO: CONFERENCE DISABLED");
		Session.g_nInvalidConferenceCode = 610;
		Session.g_strInvalidConferenceMsg = "CONFERENCE IS DISABLED";
		break;
	case -14:
		Server.logInfo("INFO: WRONG DAY");
		Session.g_nInvalidConferenceCode = 611;
		Session.g_strInvalidConferenceMsg = "CONFERENCE IS SCHEDULED FOR A DIFFERENT DAY";
		break;
	case -15:
		Session.g_nInvalidConferenceCode = 612;
		Session.g_strInvalidConferenceMsg = "INSUFFICIENT BALANCE";
		break;
	case -16:
		Server.logInfo("INFO: PIN LOCKED");
		Session.g_nInvalidConferenceCode = 613;
		Session.g_strInvalidConferenceMsg = "PIN IS LOCKED";
		break;
	case -17:
		Server.logInfo("INFO: CONFERENCE HAS NO RATE");
		Session.g_nInvalidConferenceCode = 614;
		Session.g_strInvalidConferenceMsg = "CONFERENCE HAS NO RATE";
		break;
	case -18:
		Server.logInfo("INFO: CONFERENCE ALREADY CANCELED");
		Session.g_nInvalidConferenceCode = 615;
		Session.g_strInvalidConferenceMsg = "CONFERENCE IS CANCELED";
		break;
	case -19:
		Server.logInfo("INFO: INVALID ACCESS NUMBER");
		Session.g_nTerminationReason = 28;
		Session.f_nPromptToPlay = 99;
		Session.g_nInvalidConferenceCode = 616;
		Session.g_strInvalidConferenceMsg = "INVALID ACCESS NUMBER";
		break;
	case -20:
		Server.logInfo("INFO: INVALID SUBSCRIBER ACCESS NUMBER");
		Session.g_nErrorMsgNumber = 4016; //conf invalid subscriber access number
		Session.g_nTerminationReason = 28;
		Session.f_nPromptToPlay = 99;
		Session.g_nInvalidConferenceCode = 617;
		Session.g_strInvalidConferenceMsg = "INVALID SUBSCRIBER ACCESS NUMBER";
		break;
	case -22:
		Server.logError("ERROR: INSUFFICIENT MS RESOURCE");
		Session.g_nErrorMsgNumber = 4018; //insufficient ms resource
		Session.g_nTerminationReason = 30;
		Session.f_nPromptToPlay = 99;
		Session.g_nInvalidConferenceCode = 618;
		Session.g_strInvalidConferenceMsg = "INSUFFICIENT MS RESOURCE RESERVED";
		break;
	case -98:
		Server.logError("ERROR: DB RESTARTED:" + Session.g_strPassCode);
		Session.g_nTerminationReason = 39;
		Session.f_nPromptToPlay = Session.s_nPromptSystemUnavailable;
		Session.g_nInvalidConferenceCode = 619;
		Session.g_strInvalidConferenceMsg = "DB IS RESTARTING";
		break;
	case -99:
		Server.logError("ERROR: DB ERROR PASSCODE:" + Session.g_strPassCode);
		Session.g_nTerminationReason = 39;
		Session.f_nPromptToPlay = Session.s_nPromptDBError;
		Session.g_nInvalidConferenceCode = 620;
		Session.g_strInvalidConferenceMsg = "DB ERROR";
		break;
	default:
		Session.g_nTerminationReason = 39;
		Session.f_nPromptToPlay = 305;
		Session.g_nInvalidConferenceCode = 621;
		Session.g_strInvalidConferenceMsg = "UNKNOWN REASON";
		break;

}

js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="3" plug-in="Pactolus.Branch.1" ><?xtml-editor x=827 y=2126 ?>
          <!--exceed max retry?-->
          <results >
            <result name="Default" link="62" stubbed="0"/>
            <result name="Counter &gt;= MaxRetry?" link="30" stubbed="0" >f_sCounter &gt;= g_nMaxRetryAllowed</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_sCounter++;
Server.logInfo("Session.f_strTempString is: " + Session.f_strTempString);
Server.logInfo("Session.g_strPassCode is: " + Session.g_strPassCode);
Session.f_strTempString = Session.g_strPassCode;]]></script>
          </scripts>
        </action>
        <action id="4" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=856 y=329 ?>
          <!--Welcome prompt Index-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="50" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="g_strPassCodeDigitMap" language="g_strLanguage" digits="g_strPassCode" retry-count="" clear-digits="1" terminating-digit="f_strTerminationDigit" quick-collect="0" digit-timer="" >
            <audio type="silence" >s_fConfStartCallDelay</audio>
            <audio type="index" >g_nWelcomePromptIndex</audio>
          </play>
          <results >
            <result name="Default" link="21" stubbed="1"/>
            <result name="Success" link="32" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout" link="65" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[// Session.f_sMaxRetry = Session.g_nMaxRetryAllowed;

// Session.g_strPassCode = "";]]></script>
          </scripts>
        </action>
        <action id="5" plug-in="Pactolus.Branch.1" ><?xtml-editor x=600 y=339 ?>
          <!--Welcome prompt?-->
          <results >
            <result name="Default" link="4" stubbed="0"/>
            <result name="IWelcomePromptIndex &lt;= 0" link="1" stubbed="0" >g_nWelcomePromptIndex &lt;= 0</result>
          </results>
        </action>
        <action id="6" plug-in="Pactolus.Branch.1" ><?xtml-editor x=327 y=219 ?>
          <!--strWelcomePromptType = U or I-->
          <results >
            <result name="Default" link="1" stubbed="1"/>
            <result name="strWelcomePromptType==U" link="7" stubbed="0" >g_strWelcomePromptType match "U"</result>
            <result name="strWelcomePromptType==I" link="5" stubbed="0" >g_strWelcomePromptType match "I"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_sMaxRetry = Session.g_nMaxRetryAllowed;
Session.g_strPassCode = "";
Server.logInfo("Session ID is: " + Session._sessionId);
Server.logInfo("Welcome Prompt Type is: " + Session.g_strWelcomePromptType);]]></script>
            <script language="javascript" timing="last" ><![CDATA[Server.logInfo("EXIT ON RESULT ID: " + Result.id + "  RESULT NAME: " + Result.name);]]></script>
          </scripts>
        </action>
        <action id="7" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=582 y=143 ?>
          <!--Welcome prompt URL-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="40" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="g_strPassCodeDigitMap" language="g_strLanguage" digits="g_strPassCode" retry-count="" clear-digits="1" terminating-digit="f_strTerminationDigit" quick-collect="0" digit-timer="" >
            <audio type="silence" >s_fConfStartCallDelay</audio>
            <audio type="url" >g_strWelcomePromptUrl</audio>
          </play>
          <results >
            <result name="Default" link="21" stubbed="0"/>
            <result name="Success" link="32" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout" link="65" stubbed="1"/>
          </results>
        </action>
        <action id="8" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1107 y=78 ?>
          <!--FAILURE-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nFailure"/>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[Server.logInfo("RETURN WITH VALUE: " + Session.s_nFailure);]]></script>
          </scripts>
        </action>
        <action id="9" plug-in="Pactolus.Sleep.1" ><?xtml-editor x=1416 y=1295 ?>
          <!--2 secs-->
          <sleep xmlns="urn:www.pactolus.com:xtml:application" duration="2"/>
          <results >
            <result name="Default" link="2" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (Session.f_bPlayPleaseHold == true)

{

	Session.f_bPlayPleaseHold = false;

}

else if(Session.f_bPlayPleaseHold == false)

{

	Session.f_bPlayPleaseHold = true;

}]]></script>
          </scripts>
        </action>
        <action id="10" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1098 y=1477 ?>
          <!--TOO EARLY-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >s_nPromptTooEarly</audio>
            <audio type="time" >g_strScheduleStartTime</audio>
            <audio type="index" >873</audio>
          </play>
          <results >
            <result name="Default" link="8" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: TOO EARLY PASSCODE:" + Session.g_strPassCode);

Session.g_nTerminationReason = 19;]]></script>
          </scripts>
        </action>
        <action id="11" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=2047 y=1880 ?>
          <!--s_nWaitForMod-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nWaitForMod"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bWaitForModerator = true;]]></script>
          </scripts>
        </action>
        <action id="12" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1435 y=1143 ?>
          <!--PostPin prompt?-->
          <results >
            <result name="Default" link="36" stubbed="0"/>
            <result name="PostPinPromptIndex &lt;= 0" link="18" stubbed="1" >g_nPostPinPromptIndex &lt;= 0</result>
          </results>
        </action>
        <action id="13" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1096 y=1055 ?>
          <!--strPostPinPromptType = U or I-->
          <results >
            <result name="Default" link="18" stubbed="1"/>
            <result name="strPostPinPromptType==U" link="14" stubbed="0" >g_strPostPinPromptType match "U"</result>
            <result name="strPostPinPromptType==I" link="12" stubbed="0" >g_strPostPinPromptType match "I"</result>
          </results>
        </action>
        <action id="14" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1360 y=977 ?>
          <!--PostPin prompt URL-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="url" >g_strPostPinPromptUrl</audio>
          </play>
          <results >
            <result name="Default" link="18" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="15" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2942 y=1105 ?>
          <!--first caller?-->
          <results >
            <result name="Default" link="17" stubbed="0"/>
            <result name="g_bFirstCaller==true" link="16" stubbed="0" >g_bFirstCaller == true</result>
          </results>
        </action>
        <action id="16" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=3173 y=1164 ?>
          <!--FIRST CALLER-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nFirstCaller"/>
        </action>
        <action id="17" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=3163 y=1052 ?>
          <!--NOT FIRST CALLER-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nNonFirstCaller"/>
        </action>
        <action id="18" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1941 y=1156 ?>
          <!--conferenceResource == null?-->
          <results >
            <result name="Default" link="58" stubbed="0"/>
            <result name="conferenceResource == null" link="8" stubbed="1" >g_bNullString == true
AND (g_bFirstCaller == false
OR g_bNoCreateConfFirstCaller == true)</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (!Session.g_bFirstCaller || (Session.g_bFirstCaller && Session.g_bNoCreateConfFirstCaller))
{
	if (Session.g_strConfResource.length <= 0)
	{
		Session.g_bNullString = true;
		Session.g_nErrorMsgNumber = 4014;
		Session.g_nTerminationReason = 39;
		Session.g_strReturnMsg = "NULL CONFERENCE RESOURCE, UNABLE TO ADD PARTY TO THE CONFERENCE";
		if (3 == Session.f_nReturnCode)
			Server.logError("ERROR: THE FIRST CALLER and NO NEED TO GET CONFERENCE ENDPOINT, BUT CONF RESOURCE IS NULL: " + Session.g_strConfResource);
		else
			Server.logError("ERROR: NOT THE FIRST CALLER, BUT CONF RESOURCE IS NULL: " + Session.g_strConfResource);
	}
	else
	{
		Session.g_bNullString = false;
		Session.g_oMS.strConferenceId = Session.g_strConfResource;
	}
}]]></script>
          </scripts>
        </action>
        <action id="19" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1131 y=172 ?>
          <!--send ALARM-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="" transaction="" message-name="s_strSendAlarmRequest" destination-port="" destination-type="1" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;calling_number&quot;" value="g_strAlarmType"/>
            <parameter tag="&quot;called_number&quot;" value="g_strAlarmPriority"/>
          </SOAP>
          <results >
            <result name="Default" link="8" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strAlarmType = "MEDIASERVER: play get passcode";

Session.g_strAlarmPriority = "MAJOR";]]></script>
          </scripts>
        </action>
        <action id="20" plug-in="Pactolus.Branch.1" ><?xtml-editor x=553 y=1338 ?>
          <!--exceed max retry?-->
          <results >
            <result name="Default" link="9" stubbed="1"/>
            <result name="WaitForResCounter &gt; s_nMax?" link="8" stubbed="1" >f_nWaitForResCounter &gt; s_nMaxRetryWaitConfRes</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_nWaitForResCounter++;

Session.g_strRetryFlag = "T";]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (2 == Result.id)

{

	Session.g_nTerminationReason = 2;

	Session.g_nErrorMsgNumber = 4012;  //exceed max wait for conf resource

	Server.logError("ERROR: EXCEED MAX WAIT FOR CONFERENCE RESOURCE.");

}]]></script>
          </scripts>
        </action>
        <action id="21" plug-in="Pactolus.Branch.1" ><?xtml-editor x=833 y=98 ?>
          <!--s_strSendAlarmFlag==T-->
          <results >
            <result name="Default" link="8" stubbed="0"/>
            <result name="s_strSendAlarmFlag==T" link="19" stubbed="0" >s_strSendAlarmFlag match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 40;]]></script>
          </scripts>
        </action>
        <action id="22" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1823 y=1878 ?>
          <!--"RecordCallerName"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;RecordCallerName&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="11" stubbed="0"/>
          </results>
        </action>
        <action id="23" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2706 y=1109 ?>
          <!--"RecordCallerName"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;RecordCallerName&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="15" stubbed="0"/>
          </results>
        </action>
        <action id="24" plug-in="Pactolus.JavaStaticMethod.1" ><?xtml-editor x=1923 y=1469 ?>
          <!--"psAPISceConfCleanup"-->
          <java xmlns="urn:www.pactolus.com:xtml:application" class="&quot;com.pactolus.conferencing.psAPISceConfCleanup&quot;" method="&quot;cleanupCallLeg&quot;" timeout="s_nTimeout" return="" method-return-var="f_nReturnCode" method-return-type="0" >
            <parameter type="in" var-type="unknown" >g_strDBNAME</parameter>
            <parameter type="in" var-type="unknown" >g_strExistingCallLegId</parameter>
            <parameter type="in" var-type="unknown" >f_lCurrentTime</parameter>
          </java>
          <results >
            <result name="Default" link="48" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: ********JAVA CALLING psAPISceConfCleanupCallLeg *********");

Session.f_lCurrentTime = Server.getUTCTime();]]></script>
            <script language="javascript" timing="last" ><![CDATA[Server.logInfo("INFO: ********** iJavaReturnCode " + Session.f_nReturnCode);

if (Result.id == 2)

{

	Server.logInfo("INFO: SUCCESS CALL psAPISceConfCleanupCallLeg.");

}

else

{

	Server.logError("ERROR: FAIL TO CALL psAPISceConfCleanupCallLeg, EXIT ON: " + Result.name);

}]]></script>
          </scripts>
        </action>
        <action id="25" plug-in="Standard.WaitEvent.1" ><?xtml-editor x=1395 y=1661 ?>
          <!--for PONG-->
          <wait xmlns="urn:www.pactolus.com:xtml:communication" timeout="5" recv-name="g_strEventReceived" >
            <msg name="ConferencePong" >
              <parameter >f_nPassCodeStatus</parameter>
            </msg>
          </wait>
          <results >
            <result name="Default" link="24" stubbed="1"/>
            <result name="Success" link="53" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="26" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1158 y=1667 ?>
          <!--PING to session-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="" transaction="" message-name="&quot;ConferencePing&quot;" destination-port="" destination-type="3" destination-session="g_strExistingSessionId" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;PingSessionId&quot;" value="g_strSessionId"/>
            <parameter tag="&quot;PassCode&quot;" value="g_strPassCode"/>
          </SOAP>
          <results >
            <result name="Default" link="24" stubbed="1"/>
            <result name="Success" link="25" stubbed="0"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_disable_event();]]></script>
          </scripts>
        </action>
        <action id="27" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2724 y=1241 ?>
          <!--Collect billing code-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;(xxxxxxxxxx|x.T|x.#)&quot;" language="g_strLanguage" digits="g_strBillingCodeNumber" retry-count="g_nMaxRetryAllowed" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >943</audio>
            <audio type="index" >580</audio>
            <timeout-prompt type="index" >552</timeout-prompt>
          </play>
          <results >
            <result name="Default" link="29" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="28" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2461 y=1150 ?>
          <!--get billing code?-->
          <results >
            <result name="Default" link="23" stubbed="0"/>
            <result name="g_strBillingCodeFlag==T" link="27" stubbed="0" >g_strBillingCodeFlag match "T"</result>
          </results>
        </action>
        <action id="29" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2930 y=1240 ?>
          <!--set billing code-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceSetBillingCode&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="23" stubbed="1"/>
          </results>
        </action>
        <action id="30" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1049 y=2370 ?>
          <!--ACD enable?-->
          <results >
            <result name="Default" link="38" stubbed="0"/>
            <result name="routeTPCSR== &quot;T&quot;" link="71" stubbed="0" >g_strThirdPartyAcdOutdialAvail match "T"</result>
            <result name="routeCSR=&quot;T&quot;" link="39" stubbed="0" >g_strACDCSROnMaxLoginsEnabled match "T"</result>
            <result name="ACDenable" link="82" stubbed="0" >g_strACDEnable match "T"</result>
          </results>
        </action>
        <action id="31" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1528 y=2469 ?>
          <!--route to CSR-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nStateRouteToCsr"/>
        </action>
        <action id="32" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1114 y=507 ?>
          <!--call CSR?-->
          <results >
            <result name="Default" link="2" stubbed="1"/>
            <result name="f_bRouteToCSR==true" link="3" stubbed="1" >f_bRouteToCSR == true</result>
            <result name="f_strTerminationDigit = &quot;*&quot;" link="1" stubbed="1" >f_strTerminationDigit match "\*"</result>
            <result name="f_bEmptyString" link="65" stubbed="1" >f_bEmptyString == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (Session.g_strPassCode.length == 1 && Session.g_strPassCode == "0")

{

	Session.f_bRouteToCSR = true;

}

else if (0 == Session.g_strPassCode.length)

{

	Session.f_bEmptyString = true;

}

else

{

	Session.f_bEmptyString = false;

}]]></script>
          </scripts>
        </action>
        <action id="33" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1362 y=414 ?>
          <!--s_nStateRouteToCsr-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nStateRouteToCsr"/>
        </action>
        <action id="35" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=349 y=946 ?>
          <!--play prompt-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >f_nPromptToPlay</audio>
          </play>
          <results >
            <result name="Default" link="8" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="36" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1691 y=1142 ?>
          <!--post pin prompt-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >g_nPostPinPromptIndex</audio>
          </play>
          <results >
            <result name="Default" link="18" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="37" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1543 y=2311 ?>
          <!--invalid passcode-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >853</audio>
            <audio type="index" >s_nPromptGetPasscode</audio>
          </play>
          <results >
            <result name="Default" link="8" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="38" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1271 y=2317 ?>
          <!--silence-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >99</audio>
          </play>
          <results >
            <result name="Default" link="8" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO:  MAX RETRY GETTING PASSCODE.");

Session.g_nTerminationReason = 2;]]></script>
          </scripts>
        </action>
        <action id="39" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1281 y=2474 ?>
          <!--invalid passcode-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >4147</audio>
          </play>
          <results >
            <result name="Default" link="31" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO:  MAX RETRY GETTING PASSCODE.");]]></script>
          </scripts>
        </action>
        <action id="40" plug-in="Pactolus.Branch.1" ><?xtml-editor x=804 y=2861 ?>
          <!--subscriber?-->
          <results >
            <result name="Default" link="41" stubbed="0"/>
            <result name="g_strIsSubscriberFlag== &quot;T&quot;" link="42" stubbed="0" >g_strIsSubscriberFlag match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 23;  //out of money]]></script>
          </scripts>
        </action>
        <action id="41" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1050 y=2771 ?>
          <!--not enough $, call moderator-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >874</audio>
            <audio type="index" >878</audio>
          </play>
          <results >
            <result name="Default" link="8" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="42" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1056 y=2933 ?>
          <!--not enought $, call CSR-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >507</audio>
            <audio type="index" >307</audio>
          </play>
          <results >
            <result name="Default" link="8" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="43" plug-in="Pactolus.Branch.1" ><?xtml-editor x=814 y=3173 ?>
          <!--subscriber?-->
          <results >
            <result name="Default" link="44" stubbed="0"/>
            <result name="g_strIsSubscriberFlag== &quot;T&quot;" link="45" stubbed="0" >g_strIsSubscriberFlag match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 24;  //conf pin locked]]></script>
          </scripts>
        </action>
        <action id="44" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1060 y=3083 ?>
          <!--pin locked, call moderator-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >874</audio>
            <audio type="index" >878</audio>
          </play>
          <results >
            <result name="Default" link="8" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="45" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1066 y=3245 ?>
          <!--pin locked, call CSR-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >338</audio>
            <audio type="index" >307</audio>
          </play>
          <results >
            <result name="Default" link="8" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="46" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1152 y=1304 ?>
          <!--play hold?-->
          <results >
            <result name="Default" link="9" stubbed="0"/>
            <result name="f_bPlayPleaseHold == true" link="47" stubbed="0" >f_bPlayPleaseHold == true</result>
          </results>
        </action>
        <action id="47" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1429 y=1414 ?>
          <!--please hold-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >898</audio>
          </play>
          <results >
            <result name="Default" link="9" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_bPlayPleaseHold = false;]]></script>
          </scripts>
        </action>
        <action id="48" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2145 y=1473 ?>
          <!--exceed max retry?-->
          <results >
            <result name="Default" link="2" stubbed="1"/>
            <result name="Counter &gt;= MaxRetry?" link="51" stubbed="0" >f_sCounter &gt;= g_nMaxRetryAllowed</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_sCounter++;

Session.g_strRetryFlag = "T";]]></script>
          </scripts>
        </action>
        <action id="49" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=776 y=3353 ?>
          <!--WRONG DAY-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >948</audio>
          </play>
          <results >
            <result name="Default" link="8" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 26; //wrong day]]></script>
          </scripts>
        </action>
        <action id="50" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=758 y=3511 ?>
          <!--CONF CANCEL-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >949</audio>
          </play>
          <results >
            <result name="Default" link="8" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 25; //conf cancelled]]></script>
          </scripts>
        </action>
        <action id="51" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2416 y=1467 ?>
          <!--could not be added-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >301</audio>
            <audio type="index" >874</audio>
          </play>
          <results >
            <result name="Default" link="8" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 21;

Session.g_nErrorMsgNumber = 4012;  //max retry]]></script>
          </scripts>
        </action>
        <action id="52" plug-in="Pactolus.Branch.1" ><?xtml-editor x=886 y=1675 ?>
          <!--same session-->
          <results >
            <result name="Default" link="26" stubbed="0"/>
            <result name="same session" link="24" stubbed="1" >g_strExistingSessionId match g_strSessionId</result>
          </results>
        </action>
        <action id="53" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1662 y=1654 ?>
          <!--passcode inused?-->
          <results >
            <result name="Default" link="24" stubbed="0"/>
            <result name="passcode inused" link="61" stubbed="0" >f_nPassCodeStatus == s_nPasscodeInUsed</result>
          </results>
        </action>
        <action id="54" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1350 y=1888 ?>
          <!--Collect billing code-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;(xxxxxxxxxx|x.T|x.#)&quot;" language="g_strLanguage" digits="g_strBillingCodeNumber" retry-count="g_nMaxRetryAllowed" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >943</audio>
            <audio type="index" >580</audio>
            <timeout-prompt type="index" >552</timeout-prompt>
          </play>
          <results >
            <result name="Default" link="56" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="55" plug-in="Pactolus.Branch.1" ><?xtml-editor x=852 y=1899 ?>
          <!--get billing code?-->
          <results >
            <result name="Default" link="22" stubbed="1"/>
            <result name="g_strBillingCodeFlag==T" link="54" stubbed="0" >g_strBillingCodeFlag match "T"</result>
          </results>
        </action>
        <action id="56" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1589 y=1885 ?>
          <!--set billing code-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceSetBillingCode&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="22" stubbed="0"/>
          </results>
        </action>
        <action id="57" plug-in="Pactolus.Branch.1" ><?xtml-editor x=855 y=1113 ?>
          <!--call CSR?-->
          <results >
            <result name="Default" link="13" stubbed="1"/>
            <result name="f_bRouteToCSR==true" link="13" stubbed="1" >f_bRouteToCSR == true</result>
            <result name="f_strTerminationDigit = &quot;*&quot;" link="13" stubbed="1" >f_strTerminationDigit match "\*"</result>
            <result name="wrong site" link="68" stubbed="0" >g_bWrongSiteHangOff == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (Session.g_strAttendeeId.length == 1 && Session.g_strAttendeeId == "0")

{

	Session.f_bRouteToCSR = true;

}

else if (Session.g_strAttendeeId == Session.g_strAnonymousAttendeeId)

{

	Session.g_bAnonymousCaller = true;

}

else

{

	Session.g_bAnonymousCaller = false;

}]]></script>
          </scripts>
        </action>
        <action id="58" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2197 y=1153 ?>
          <!--anonymous caller?-->
          <results >
            <result name="Default" link="28" stubbed="0"/>
            <result name="g_bAnonymousCaller" link="15" stubbed="1" >g_bAnonymousCaller == true</result>
          </results>
        </action>
        <action id="59" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1273 y=2028 ?>
          <!--invalid, get passcode again-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="g_strPassCodeDigitMap" language="g_strLanguage" digits="g_strPassCode" retry-count="" clear-digits="0" terminating-digit="f_strTerminationDigit" quick-collect="0" digit-timer="" >
            <audio type="index" >4143</audio>
          </play>
          <results >
            <result name="Default" link="21" stubbed="1"/>
            <result name="Success" link="32" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout" link="3" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strPassCode = "";
Session.f_strTerminationDigit = "";]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (4 == Result.id)

{

	Session.g_nTerminationReason = 2;

}]]></script>
          </scripts>
        </action>
        <action id="60" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1563 y=2019 ?>
          <!--Collect pass code-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="g_strPassCodeDigitMap" language="g_strLanguage" digits="g_strPassCode" retry-count="" clear-digits="0" terminating-digit="f_strTerminationDigit" quick-collect="0" digit-timer="" >
            <audio type="index" >s_nPromptGetPasscode</audio>
          </play>
          <results >
            <result name="Default" link="21" stubbed="1"/>
            <result name="Success" link="32" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strPassCode = "";
Session.f_strTerminationDigit = "";
Session.g_nErrorMsgNumber = 0;]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (4 == Result.id)

{

	Session.g_nTerminationReason = 2;

}]]></script>
          </scripts>
        </action>
        <action id="61" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2003 y=1713 ?>
          <!--could not be added-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >301</audio>
            <audio type="index" >874</audio>
          </play>
          <results >
            <result name="Default" link="8" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 21;]]></script>
          </scripts>
        </action>
        <action id="62" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1042 y=2035 ?>
          <!--empty string-->
          <results >
            <result name="Default" link="59" stubbed="0"/>
            <result name="f_bEmptyString" link="63" stubbed="0" >f_bEmptyString == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (0 == Session.f_strTempString.length || 0 == Session.g_strPassCode.length)

{

	Server.logError("PASSCODE LENGTH IS ZERO");

	Server.logError("Session.f_strTempString is: " + Session.f_strTempString);

	Server.logError("Session.g_strPassCode is: " + Session.g_strPassCode);

	Session.f_bEmptyString = true;

}

else

{

	Session.f_bEmptyString = false;

}]]></script>
          </scripts>
        </action>
        <action id="63" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1287 y=2175 ?>
          <!--invalid, get passcode again-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="g_strPassCodeDigitMap" language="g_strLanguage" digits="g_strPassCode" retry-count="" clear-digits="0" terminating-digit="f_strTerminationDigit" quick-collect="0" digit-timer="" >
            <audio type="index" >4143</audio>
          </play>
          <results >
            <result name="Default" link="21" stubbed="1"/>
            <result name="Success" link="32" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout" link="60" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strPassCode = "";
Session.f_strTerminationDigit = "";]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (4 == Result.id)

{

	Session.g_nTerminationReason = 2;

}]]></script>
          </scripts>
        </action>
        <action id="64" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1622 y=505 ?>
          <!--invalid, get passcode again-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="g_strPassCodeDigitMap" language="g_strLanguage" digits="g_strPassCode" retry-count="" clear-digits="0" terminating-digit="f_strTerminationDigit" quick-collect="0" digit-timer="" >
            <audio type="index" >4143</audio>
          </play>
          <results >
            <result name="Default" link="32" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strPassCode = "";]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (4 == Result.id)

{

	Session.g_nTerminationReason = 2;

}]]></script>
          </scripts>
        </action>
        <action id="65" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1363 y=507 ?>
          <!--exceed max retry?-->
          <results >
            <result name="Default" link="64" stubbed="0"/>
            <result name="Counter &gt;= MaxRetry?" link="30" stubbed="1" >f_sCounter &gt;= g_nMaxRetryAllowed</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_sCounter++;

Session.f_strTempString = Session.g_strPassCode;]]></script>
          </scripts>
        </action>
        <action id="67" plug-in="Pactolus.Branch.1" ><?xtml-editor x=438 y=1131 ?>
          <!--Come from HandOff?-->
          <results >
            <result name="Default" link="57" stubbed="1"/>
            <result name="g_bHandOff" link="69" stubbed="0" >g_bHandOff == true</result>
            <result name="g_bTransfered" link="81" stubbed="0" >g_bTransferParty == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_sMaxRetry = Session.g_nMaxRetryAllowed;]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (2 == Result.id)

{

	if (Session.g_strAttendeeId == Session.g_strAnonymousAttendeeId)

	{

		Session.g_bAnonymousCaller = true;

	}

	else

	{

		Session.g_bAnonymousCaller = false;

	}

}]]></script>
          </scripts>
        </action>
        <action id="68" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1107 y=1202 ?>
          <!--s_nWrongSite-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nWrongSite"/>
        </action>
        <action id="69" plug-in="Pactolus.Branch.1" ><?xtml-editor x=668 y=1120 ?>
          <!--handback and still get wrong site-->
          <results >
            <result name="Default" link="13" stubbed="1"/>
            <result name="redirect=3&amp;&amp;returncode=-21" link="8" stubbed="1" >g_nRedirectStatus == 3
AND f_nReturnCode == -21</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (2 == Result.id)
{
	Session.g_nErrorMsgNumber = 4017;
}]]></script>
          </scripts>
        </action>
        <action id="70" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=868 y=1442 ?>
          <!--"PlayTooEarly"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;PlayTooEarly&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="8" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: TOO EARLY PASSCODE:" + Session.g_strPassCode);
Session.g_nTerminationReason = 19;
Session.g_nErrorMsgNumber = 0;]]></script>
          </scripts>
        </action>
        <action id="71" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1280 y=2598 ?>
          <!--invalid passcode-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >4147</audio>
          </play>
          <results >
            <result name="Default" link="72" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO:  MAX RETRY GETTING PASSCODE.");]]></script>
          </scripts>
        </action>
        <action id="72" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1533 y=2584 ?>
          <!--route to ThirdParty CSR-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nStateRouteToThirdPartyCsr"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_nCurrentState = Session.s_nStateRouteToThirdPartyCsr;]]></script>
          </scripts>
        </action>
        <action id="77" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=893 y=792 ?>
          <!--Welcome prompt Index-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="50" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="silence" >s_fConfStartCallDelay</audio>
            <audio type="index" >g_nWelcomePromptIndex</audio>
          </play>
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="78" plug-in="Pactolus.Branch.1" ><?xtml-editor x=637 y=802 ?>
          <!--Welcome prompt?-->
          <results >
            <result name="Default" link="77" stubbed="0"/>
            <result name="IWelcomePromptIndex &lt;= 0" link="2" stubbed="1" >g_nWelcomePromptIndex &lt;= 0</result>
          </results>
        </action>
        <action id="79" plug-in="Pactolus.Branch.1" ><?xtml-editor x=346 y=682 ?>
          <!--strWelcomePromptType = U or I-->
          <results >
            <result name="Default" link="2" stubbed="1"/>
            <result name="strWelcomePromptType==U" link="80" stubbed="0" >g_strWelcomePromptType match "U"</result>
            <result name="strWelcomePromptType==I" link="78" stubbed="0" >g_strWelcomePromptType match "I"</result>
          </results>
        </action>
        <action id="80" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=619 y=606 ?>
          <!--Welcome prompt URL-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="40" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="silence" >s_fConfStartCallDelay</audio>
            <audio type="url" >g_strWelcomePromptUrl</audio>
          </play>
          <results >
            <result name="Default" link="2" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="81" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=682 y=1237 ?>
          <!--set transfer party detail-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceConfSetTransferPartyDetail&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="57" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nDefaultAudioMode = Session.g_nReleaseDefaultAudioMode;]]></script>
          </scripts>
        </action>
        <action id="82" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1284 y=2741 ?>
          <!--silence-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >99</audio>
          </play>
          <results >
            <result name="Default" link="31" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
      </actions>
    </function>
    <function name="psAPISceConfSetPartyDetail" start="1" event="" returns="i4" >
      <local-vars >
        <var name="nReturnCode" type="i4" >-1</var>
      </local-vars>
      <actions >
        <action id="1" plug-in="Pactolus.JavaStaticMethod.1" ><?xtml-editor x=233 y=176 ?>
          <!--"setPartyDetail"-->
          <java xmlns="urn:www.pactolus.com:xtml:application" class="&quot;com.pactolus.conferencing.psAPISceConfSetPartyDetail&quot;" method="&quot;setPartyDetail&quot;" timeout="s_nTimeout" return="" method-return-var="nReturnCode" method-return-type="0" >
            <parameter type="in" var-type="string" >g_strSessionId</parameter>
            <parameter type="in" var-type="i8" >g_lPartySchedId</parameter>
            <parameter type="in" var-type="string" >g_strConfScheduleId</parameter>
            <parameter type="in" var-type="string" >g_strCallLegId</parameter>
            <parameter type="in" var-type="string" >g_strPartyDetail</parameter>
            <parameter type="inout" var-type="i8" >g_lPartySchedId</parameter>
          </java>
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="Success" link="3" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: psAPISceSetPartyDetail");
Server.logInfo("INFO: *********JAVA CALLING SetPartyDetail *********");

Server.logInfo("INFO: BEFORE Session Id = " + Session.g_strSessionId);
Server.logInfo("INFO: BEFORE sched Id = " + Session.g_strConfScheduleId);
Server.logInfo("INFO: BEFORE party sched Id = " + Session.g_lPartySchedId);
Server.logInfo("INFO: BEFORE party detail = " + Session.g_strPartyDetail);]]></script>
            <script language="javascript" timing="last" ><![CDATA[Server.logInfo("INFO: ********* Set party detail returns " + Session.nReturnCode);
Server.logInfo("INFO: AFTER: New party sched Id = " + Session.g_lPartySchedId);

if (Result.id != 2)
{
	Server.logError("ERROR: FAIL TO CALL SET PARTY DETAIL, EXIT ON: " + Result.name);
}]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=469 y=167 ?>
          <!--return FAILED_JAVA-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nFailure"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logError("ERROR: FAIL TO SET PARTY DETAIL");]]></script>
          </scripts>
        </action>
        <action id="3" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=474 y=257 ?>
          <!--return JAVA_SUCCESS-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="nReturnCode"/>
        </action>
      </actions>
    </function>
    <function name="OnConfCSRSpeakWithParticipant" start="56" event="ConfCSRSpeakWithParticipantRequest" returns="void" >
      <parameters >
        <parameter name="strConfControllerIP" type="string" pass="byref"/>
        <parameter name="nConfControllerPort" type="i4" pass="byref"/>
        <parameter name="strTransactionId" type="string" pass="byref"/>
        <parameter name="strConferenceEndPoint" type="string" pass="byref"/>
      </parameters>
      <local-vars >
        <var name="nReturnCode" type="i4" >-1</var>
      </local-vars>
      <actions >
        <action id="56" plug-in="Pactolus.Branch.1" ><?xtml-editor x=43 y=253 ?>
          <results >
            <result name="Default" link="27" stubbed="0"/>
          </results>
        </action>
        <action id="3" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=500 y=329 ?>
          <!--Remove member from conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;RemoveMemberFromConference&quot;" return="nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="4" stubbed="0"/>
          </results>
        </action>
        <action id="4" plug-in="Pactolus.Branch.1" ><?xtml-editor x=740 y=325 ?>
          <!--success?-->
          <results >
            <result name="Default" link="33" stubbed="0"/>
            <result name="success?" link="14" stubbed="1" >nReturnCode == s_nSuccess</result>
          </results>
        </action>
        <action id="6" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=678 y=809 ?>
          <!--AddMemberToTempConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
            <parameter >g_oCallLegA</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="7" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: ADD PARTY TO TEMPORARY CONFERENCE WITH CSR.");]]></script>
          </scripts>
        </action>
        <action id="7" plug-in="Pactolus.Branch.1" ><?xtml-editor x=916 y=805 ?>
          <!--success?-->
          <results >
            <result name="Default" link="48" stubbed="0"/>
            <result name="FAILURE" link="47" stubbed="0" >nReturnCode == s_nFailure</result>
            <result name="CALLERHUNGUP" link="46" stubbed="0" >nReturnCode == s_nCallerHungup</result>
          </results>
        </action>
        <action id="14" plug-in="Pactolus.Branch.1" ><?xtml-editor x=445 y=868 ?>
          <!--Dial In?-->
          <results >
            <result name="Default" link="6" stubbed="0"/>
            <result name="g_strOutdialFlag = &quot;T&quot;;" link="15" stubbed="0" >g_strOutdialFlag match "T"</result>
          </results>
        </action>
        <action id="15" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=693 y=985 ?>
          <!--AddMemberToTempConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
            <parameter >g_oCallLegB</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="7" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: ADD PARTY TO TEMPORARY CONFERENCE WITH CSR.");]]></script>
          </scripts>
        </action>
        <action id="17" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1419 y=793 ?>
          <!--Dial In?-->
          <results >
            <result name="Default" link="25" stubbed="0"/>
            <result name="g_strOutdialFlag = &quot;T&quot;;" link="24" stubbed="0" >g_strOutdialFlag match "T"</result>
          </results>
        </action>
        <action id="19" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1908 y=827 ?>
          <!--put B back to old conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
            <parameter >g_oCallLegB</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="42" stubbed="1"/>
            <result name="FAILURE" link="43" stubbed="1" >nReturnCode == s_nFailure</result>
            <result name="CALLER HUNGUP" link="52" stubbed="1" >nReturnCode == s_nCallerHungup</result>
          </results>
        </action>
        <action id="21" plug-in="Standard.EndSession.1" ><?xtml-editor x=2386 y=626 ?></action>
        <action id="22" plug-in="Pactolus.Branch.1" ><?xtml-editor x=256 y=377 ?>
          <!--in sub conf?-->
          <results >
            <result name="Default" link="3" stubbed="0"/>
            <result name="g_bCurrentlyInSubConf" link="23" stubbed="0" >g_bCurrentlyInSubConf == true
AND g_bConnectToMOH == false</result>
            <result name="g_bCurrentlyInMOH" link="51" stubbed="0" >g_bConnectToMOH == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: REMOVE MEMBER FROM CONFERENCE.");
Server.logInfo("INFO: CURRENTLY IN SUB CONFERENCE FLAG IS: " + Session.g_bCurrentlyInSubConf);
Server.logInfo("INFO: CURRENTLY IN MOH FLAG IS: " + Session.g_bConnectToMOH);]]></script>
          </scripts>
        </action>
        <action id="23" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=519 y=464 ?>
          <!--Remove member from conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;RemoveMemberFromConference&quot;" return="nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oSubConfMS</parameter>
          </function>
          <results >
            <result name="Default" link="4" stubbed="1"/>
          </results>
        </action>
        <action id="24" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1674 y=876 ?>
          <!--in sub conf?-->
          <results >
            <result name="Default" link="19" stubbed="0"/>
            <result name="g_bCurrentlyInSubConf" link="26" stubbed="0" >g_bCurrentlyInSubConf == true</result>
          </results>
        </action>
        <action id="25" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1658 y=583 ?>
          <!--in sub conf?-->
          <results >
            <result name="Default" link="40" stubbed="0"/>
            <result name="g_bCurrentlyInSubConf" link="41" stubbed="0" >g_bCurrentlyInSubConf == true</result>
          </results>
        </action>
        <action id="26" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1927 y=967 ?>
          <!--put B back to old conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oSubConfMS</parameter>
            <parameter >g_oCallLegB</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="39" stubbed="1"/>
            <result name="FAILURE" link="43" stubbed="1" >nReturnCode == s_nFailure</result>
            <result name="CALLER HUNGUP" link="52" stubbed="1" >nReturnCode == s_nCallerHungup</result>
          </results>
        </action>
        <action id="27" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=40 y=382 ?>
          <!--"StopTimer"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;StopTimer&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="22" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: OnConfCSRSpeakWithParticipantRequest");
Session.g_oTempConf.strConferenceId = Session.strConferenceEndPoint;
js_disable_event();]]></script>
          </scripts>
        </action>
        <action id="28" plug-in="Standard.Timer.1" ><?xtml-editor x=1693 y=170 ?>
          <!--ck reInvite timer-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lCkReInviteTimerIdA" duration="g_nCkReInviteTime"/>
          <results >
            <result name="Default" link="44" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bCkReInviteTimerFlagA = true;
Server.logInfo("SET TIMER TO CHECK FOR REINVITE A LEG");]]></script>
          </scripts>
        </action>
        <action id="29" plug-in="Standard.Timer.1" ><?xtml-editor x=1711 y=286 ?>
          <!--ck reInvite timer B-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lCkReInviteTimerIdB" duration="g_nCkReInviteTime"/>
          <results >
            <result name="Default" link="44" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bCkReInviteTimerFlagB = true;
Server.logInfo("SET TIMER TO CHECK FOR REINVITE B LEG");]]></script>
          </scripts>
        </action>
        <action id="30" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1222 y=203 ?>
          <!--Dial In?-->
          <results >
            <result name="Default" link="31" stubbed="0"/>
            <result name="g_strOutdialFlag = &quot;T&quot;" link="32" stubbed="0" >g_strOutdialFlag match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("REMOVE FROM OLD CONF ADD TO NEW CONF, RESET TIMER TO CHECK FOR REINVITE");]]></script>
          </scripts>
        </action>
        <action id="31" plug-in="Standard.Timer.1" ><?xtml-editor x=1464 y=170 ?>
          <!--stop ck reInvite timer-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="0" id="g_lCkReInviteTimerIdA" duration=""/>
          <results >
            <result name="Default" link="28" stubbed="0"/>
          </results>
        </action>
        <action id="32" plug-in="Standard.Timer.1" ><?xtml-editor x=1478 y=287 ?>
          <!--stop ck reInvite timer B-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="0" id="g_lCkReInviteTimerIdB" duration=""/>
          <results >
            <result name="Default" link="29" stubbed="0"/>
          </results>
        </action>
        <action id="33" plug-in="Pactolus.Branch.1" ><?xtml-editor x=974 y=148 ?>
          <results >
            <result name="Default" link="44" stubbed="0"/>
            <result name="Time &gt; 0" link="30" stubbed="0" >g_nCkReInviteTime &gt; 0</result>
          </results>
        </action>
        <action id="34" plug-in="Standard.Timer.1" ><?xtml-editor x=2129 y=1197 ?>
          <!--ck reInvite timer-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lCkReInviteTimerIdA" duration="g_nCkReInviteTime"/>
          <results >
            <result name="Default" link="45" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bCkReInviteTimerFlagA = true;
Server.logInfo("SET TIMER TO CHECK FOR REINVITE A LEG");]]></script>
          </scripts>
        </action>
        <action id="35" plug-in="Standard.Timer.1" ><?xtml-editor x=2152 y=1301 ?>
          <!--ck reInvite timer B-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lCkReInviteTimerIdB" duration="g_nCkReInviteTime"/>
          <results >
            <result name="Default" link="45" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bCkReInviteTimerFlagB = true;
Server.logInfo("SET TIMER TO CHECK FOR REINVITE B LEG");]]></script>
          </scripts>
        </action>
        <action id="36" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1663 y=1218 ?>
          <!--Dial In?-->
          <results >
            <result name="Default" link="37" stubbed="0"/>
            <result name="g_strOutdialFlag = &quot;T&quot;" link="38" stubbed="0" >g_strOutdialFlag match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("CSRCallerOffHold, RESET TIMER TO CHECK FOR REINVITE");]]></script>
          </scripts>
        </action>
        <action id="37" plug-in="Standard.Timer.1" ><?xtml-editor x=1900 y=1197 ?>
          <!--stop ck reInvite timer-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="0" id="g_lCkReInviteTimerIdA" duration=""/>
          <results >
            <result name="Default" link="34" stubbed="0"/>
          </results>
        </action>
        <action id="38" plug-in="Standard.Timer.1" ><?xtml-editor x=1919 y=1302 ?>
          <!--stop ck reInvite timer B-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="0" id="g_lCkReInviteTimerIdB" duration=""/>
          <results >
            <result name="Default" link="35" stubbed="0"/>
          </results>
        </action>
        <action id="39" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1427 y=1228 ?>
          <results >
            <result name="Default" link="45" stubbed="1"/>
            <result name="Time &gt; 0" link="36" stubbed="0" >g_nCkReInviteTime &gt; 0</result>
          </results>
        </action>
        <action id="40" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1873 y=535 ?>
          <!--put back to old conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
            <parameter >g_oCallLegA</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="42" stubbed="0"/>
            <result name="FAILURE" link="43" stubbed="0" >nReturnCode == s_nFailure</result>
            <result name="CALLER HUNGUP" link="52" stubbed="1" >nReturnCode == s_nCallerHungup</result>
          </results>
        </action>
        <action id="41" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1892 y=687 ?>
          <!--put back to old conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oSubConfMS</parameter>
            <parameter >g_oCallLegA</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="39" stubbed="1"/>
            <result name="FAILURE" link="43" stubbed="1" >nReturnCode == s_nFailure</result>
            <result name="CALLER HUNGUP" link="52" stubbed="1" >nReturnCode == s_nCallerHungup</result>
          </results>
        </action>
        <action id="42" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2110 y=527 ?>
          <!--ConfMSConnectionIDChangedNotify-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ConfMSConnectionIDChangedNotify&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="39" stubbed="1"/>
          </results>
        </action>
        <action id="43" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2124 y=629 ?>
          <!--Hang up caller-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpCaller&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="21" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 35;
Session.g_nConfLeaveReason = 9;
Session.g_strConfLeaveMsg = "FAIL TO ADD PARTY TO CONFERENCE";]]></script>
          </scripts>
        </action>
        <action id="44" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1206 y=68 ?>
          <!--FAIL to remove from conf-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strConfControllerIP" transaction="strTransactionId" message-name="s_strConfCsrRequestPrivateTalk" destination-port="nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="s_nFailure"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
          </SOAP>
          <results >
            <result name="Default" link="45" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = " FAILURE TO REMOVE PARTY FROM THE MAIN CONFERENCE";]]></script>
          </scripts>
        </action>
        <action id="45" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1466 y=66 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="46" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1206 y=920 ?>
          <!--FAIL to add a call party-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strConfControllerIP" transaction="strTransactionId" message-name="s_strConfCsrRequestPrivateTalk" destination-port="nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="s_nFailure"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
          </SOAP>
          <results >
            <result name="Default" link="21" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "PARTY HANGUP";]]></script>
          </scripts>
        </action>
        <action id="47" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1189 y=796 ?>
          <!--FAIL to add party to temp conf-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strConfControllerIP" transaction="strTransactionId" message-name="s_strConfCsrRequestPrivateTalk" destination-port="nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="s_nFailure"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
          </SOAP>
          <results >
            <result name="Default" link="17" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = " FAILURE TO ADD PARTY TO TEMP CONFERENCE";]]></script>
          </scripts>
        </action>
        <action id="48" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1203 y=1222 ?>
          <!--SUCCESS add to private talk-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strConfControllerIP" transaction="strTransactionId" message-name="s_strConfCsrRequestPrivateTalk" destination-port="nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="s_nSuccess"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
          </SOAP>
          <results >
            <result name="Default" link="39" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "SUCCESS ADD PARTY TO PRIVATE TALK WITH CSR";
Session.g_bHoldState = false;
Session.g_bMutedState = false;]]></script>
          </scripts>
        </action>
        <action id="51" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=511 y=587 ?>
          <!--"DisconnectFromMOH"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DisconnectFromMOH&quot;" return="nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="4" stubbed="1"/>
          </results>
        </action>
        <action id="52" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2396 y=707 ?>
          <!--party leave-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;PartyLeave&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="21" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nConfLeaveReason = 0;
Session.g_strConfLeaveMsg = "PARTY HANG UP";]]></script>
          </scripts>
        </action>
        <action id="53" plug-in="Standard.WaitEvent.1" ><?xtml-editor x=544 y=149 ?>
          <!--ConfCancelQandAResponse-->
          <wait xmlns="urn:www.pactolus.com:xtml:communication" timeout="s_nTimeout" recv-name="g_strEventReceived" >
            <msg name="ConfCancelQandAResponse" >
              <parameter ></parameter>
              <parameter ></parameter>
              <parameter ></parameter>
              <parameter >nReturnCode</parameter>
              <parameter ></parameter>
            </msg>
          </wait>
          <results >
            <result name="Default" link="27" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
            <result name="" ><?xtml-editor visible=no?></result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (2 == Result.id && 0 == Session.nReturnCode)
{
	Session.g_bPartyHandRaised = false;
	Server.logInfo("SUCCESS CANCEL Q AND A");
}
else
{
	Server.logError("FAIL TO CANCEL Q AND A, EXIT ON BRANCH: " + Result.name);
	Server.logError("FAIL TO CANCEL Q AND A, RETURN CODE: " + Session.nReturnCode);
}]]></script>
          </scripts>
        </action>
        <action id="54" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=297 y=156 ?>
          <!--s_strCancelQandARequest-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="s_strZeroTransactionId" message-name="s_strCancelQandARequest" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
            <parameter tag="&quot;CCGeneratedPasscode&quot;" value="g_strCCGeneratedPassCode"/>
          </SOAP>
          <results >
            <result name="Default" link="53" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: **** CONF Cancel Q&A Request ****");]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)
{
	Server.logError("ERROR: FAIL TO SEND SOAP MESSAGE CONF Cancel Q and A Request.");
}
else
{
	Server.logInfo("SUCCESSFUL SEND SOAP MESSAGE TO CONF: CANCEL Q AND A REQUEST");
}]]></script>
          </scripts>
        </action>
        <action id="55" plug-in="Pactolus.Branch.1" ><?xtml-editor x=45 y=163 ?>
          <results >
            <result name="Default" link="27" stubbed="1"/>
            <result name="g_bPartyHandRaised" link="54" stubbed="0" >g_bPartyHandRaised == true</result>
          </results>
        </action>
      </actions>
    </function>
    <function name="OnConfCSREndSpeakWithParticipant" start="17" event="ConfCSREndSpeakWithParticipantRequest" returns="void" >
      <parameters >
        <parameter name="strConfControllerIP" type="string" pass="byref"/>
        <parameter name="nConfControllerPort" type="i4" pass="byref"/>
        <parameter name="strTransactionId" type="string" pass="byref"/>
        <parameter name="lPartySchedId" type="i8" pass="byref"/>
        <parameter name="strPartyDetail" type="string" pass="byref"/>
        <parameter name="nAudioMode" type="i4" pass="byref"/>
        <parameter name="strResponseFlag" type="string" pass="byref"/>
      </parameters>
      <local-vars >
        <var name="nReturnCode" type="i4" >-1</var>
      </local-vars>
      <actions >
        <action id="17" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=95 y=261 ?>
          <!--"psAPISceConfSetPartyDetail"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceConfSetPartyDetail&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="3" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: OnConfCSREndSpeakWithParticipant");
Session.g_lPartySchedId = Session.lPartySchedId;
Session.g_strPartyDetail = Session.strPartyDetail;
js_disable_event();]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=575 y=465 ?>
          <!--Remove member from temp conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;RemoveMemberFromConference&quot;" return="nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
          </function>
          <results >
            <result name="Default" link="103" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: ADD PARTY, RETURN TO CONF, REMOVE FROM TEMP CONF.");]]></script>
          </scripts>
        </action>
        <action id="3" plug-in="Pactolus.Branch.1" ><?xtml-editor x=96 y=377 ?>
          <!--Dial In?-->
          <results >
            <result name="Default" link="5" stubbed="0"/>
            <result name="g_strOutdialFlag = &quot;T&quot;;" link="6" stubbed="0" >g_strOutdialFlag match "T"</result>
          </results>
        </action>
        <action id="5" plug-in="Standard.Timer.1" ><?xtml-editor x=326 y=304 ?>
          <!--stop ck reInvite timer-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="0" id="g_lCkReInviteTimerIdA" duration=""/>
          <results >
            <result name="Default" link="2" stubbed="0"/>
          </results>
        </action>
        <action id="6" plug-in="Standard.Timer.1" ><?xtml-editor x=339 y=467 ?>
          <!--stop ck reInvite timer B-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="0" id="g_lCkReInviteTimerIdB" duration=""/>
          <results >
            <result name="Default" link="2" stubbed="1"/>
          </results>
        </action>
        <action id="7" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=514 y=625 ?>
          <!--AddMemberToOldConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
            <parameter >g_oCallLegA</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="16" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: ADD PARTY, ADD MEMBER BACK TO OLD CONF.");]]></script>
          </scripts>
        </action>
        <action id="8" plug-in="Pactolus.Branch.1" ><?xtml-editor x=93 y=709 ?>
          <!--Dial In?-->
          <results >
            <result name="Default" link="11" stubbed="0"/>
            <result name="g_strOutdialFlag = &quot;T&quot;;" link="12" stubbed="0" >g_strOutdialFlag match "T"</result>
          </results>
        </action>
        <action id="9" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=528 y=784 ?>
          <!--AddMemberToOldConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
            <parameter >g_oCallLegB</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="16" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: ADD PARTY, ADD MEMBER BACK TO OLD CONF.");]]></script>
          </scripts>
        </action>
        <action id="11" plug-in="Pactolus.Branch.1" ><?xtml-editor x=301 y=634 ?>
          <!--in sub conf?-->
          <results >
            <result name="Default" link="7" stubbed="0"/>
            <result name="g_bCurrentlyInSubConf" link="13" stubbed="0" >g_bCurrentlyInSubConf == true</result>
          </results>
        </action>
        <action id="12" plug-in="Pactolus.Branch.1" ><?xtml-editor x=316 y=800 ?>
          <!--in sub conf?-->
          <results >
            <result name="Default" link="9" stubbed="0"/>
            <result name="g_bCurrentlyInSubConf" link="14" stubbed="0" >g_bCurrentlyInSubConf == true</result>
          </results>
        </action>
        <action id="13" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=528 y=705 ?>
          <!--AddMemberToOldConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oSubConfMS</parameter>
            <parameter >g_oCallLegA</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="15" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: ADD PARTY, ADD MEMBER BACK TO OLD CONF.");]]></script>
          </scripts>
        </action>
        <action id="14" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=544 y=892 ?>
          <!--AddMemberToOldConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oSubConfMS</parameter>
            <parameter >g_oCallLegB</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="15" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: ADD PARTY, ADD MEMBER BACK TO OLD CONF.");]]></script>
          </scripts>
        </action>
        <action id="15" plug-in="Pactolus.Branch.1" ><?xtml-editor x=954 y=698 ?>
          <!--success?-->
          <results >
            <result name="Default" link="19" stubbed="0"/>
            <result name="FAILURE" link="105" stubbed="0" >nReturnCode == s_nFailure</result>
            <result name="CALLERHUNGUP" link="109" stubbed="0" >nReturnCode == s_nCallerHungup</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Result.id == 2)
{
	Session.g_nTerminationReason = 35;
}
else if (Result.id == 3)
{
	Session.g_nTerminationReason = 1;
}]]></script>
          </scripts>
        </action>
        <action id="16" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=737 y=623 ?>
          <!--ConfMSConnectionIDChangedNotify-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ConfMSConnectionIDChangedNotify&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="15" stubbed="1"/>
          </results>
        </action>
        <action id="18" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1434 y=682 ?>
          <!--SUCCESS end private talk-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strConfControllerIP" transaction="strTransactionId" message-name="s_strConfCsrEndSpeakWith" destination-port="nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="s_nSuccess"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
            <parameter tag="&quot;confSchedPartyID&quot;" value="g_lPartySchedId"/>
          </SOAP>
          <results >
            <result name="Default" link="28" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "SUCCESS END PRIVATE TALK WITH CSR";]]></script>
          </scripts>
        </action>
        <action id="19" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1185 y=695 ?>
          <!--need to send reponse?-->
          <results >
            <result name="Default" link="28" stubbed="1"/>
            <result name="strResponseFlag==&quot;T&quot;" link="18" stubbed="0" >strResponseFlag match "T"</result>
          </results>
        </action>
        <action id="20" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1716 y=479 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (1 == Session.nAudioMode)
{
	Server.logInfo("CURRENTLY ON HOLD");
	Session.g_bHoldState = true;
	Session.g_bMutedState = false;
}
else if (2 == Session.nAudioMode)
{
	Server.logInfo("CURRENTLY ON MUTED");
	Session.g_bHoldState = false;
	Session.g_bMutedState = true;
}
else
{
	Server.logInfo("CURRENTLY ON SPEAK");
	Session.g_bHoldState = false;
	Session.g_bMutedState = false;
}
js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="21" plug-in="Pactolus.Branch.1" ><?xtml-editor x=784 y=294 ?>
          <!--need to send reponse?-->
          <results >
            <result name="Default" link="20" stubbed="1"/>
            <result name="strResponseFlag==&quot;T&quot;" link="22" stubbed="0" >strResponseFlag match "T"</result>
          </results>
        </action>
        <action id="22" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1054 y=284 ?>
          <!--FAIL end private talk-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strConfControllerIP" transaction="strTransactionId" message-name="s_strConfCsrEndSpeakWith" destination-port="nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="s_nFailure"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
            <parameter tag="&quot;confSchedPartyID&quot;" value="g_lPartySchedId"/>
          </SOAP>
          <results >
            <result name="Default" link="20" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "FAIL TO PUT PARTY ON HOLD";]]></script>
          </scripts>
        </action>
        <action id="23" plug-in="Standard.Timer.1" ><?xtml-editor x=1937 y=875 ?>
          <!--ck reInvite timer-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lCkReInviteTimerIdA" duration="g_nCkReInviteTime"/>
          <results >
            <result name="Default" link="20" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bCkReInviteTimerFlagA = true;
Server.logInfo("SET TIMER TO CHECK FOR REINVITE A LEG");]]></script>
          </scripts>
        </action>
        <action id="24" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1454 y=910 ?>
          <results >
            <result name="Default" link="20" stubbed="1"/>
            <result name="Time &gt; 0" link="26" stubbed="0" >g_nCkReInviteTime &gt; 0</result>
          </results>
        </action>
        <action id="25" plug-in="Standard.Timer.1" ><?xtml-editor x=1955 y=991 ?>
          <!--ck reInvite timer B-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lCkReInviteTimerIdB" duration="g_nCkReInviteTime"/>
          <results >
            <result name="Default" link="20" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bCkReInviteTimerFlagB = true;
Server.logInfo("SET TIMER TO CHECK FOR REINVITE B LEG");]]></script>
          </scripts>
        </action>
        <action id="26" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1705 y=903 ?>
          <!--Dial In?-->
          <results >
            <result name="Default" link="23" stubbed="0"/>
            <result name="g_strOutdialFlag = &quot;T&quot;" link="25" stubbed="0" >g_strOutdialFlag match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("MOVED BACK TO MAIN CONF, RESET TIMER TO CHECK FOR REINVITE");]]></script>
          </scripts>
        </action>
        <action id="28" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1217 y=917 ?>
          <!--set DTMF Detection ON-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;SetDTMFOn&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="24" stubbed="0"/>
          </results>
        </action>
        <action id="103" plug-in="Pactolus.Branch.1" ><?xtml-editor x=804 y=465 ?>
          <!--speak, mute, hold?-->
          <results >
            <result name="Default" link="8" stubbed="0"/>
            <result name="Hold" link="107" stubbed="0" >nAudioMode == 1</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (Session.g_bCurrentlyInSubConf)
{
	if (2 == Session.nAudioMode)
	{
		Server.logInfo("CHANGE TO MUTE MODE IN SUB CONF");
		Session.g_oSubConfMS.bMuteFlag = true;
		Session.g_oSubConfMS.bDeafFlag = false;
		Session.g_bMutedState = true;
		Session.g_bHoldState = false;
	}
	else if (1 == Session.nAudioMode)
	{
		Server.logInfo("CHANGE TO MOH MODE IN SUB CONF");
		Session.g_oSubConfMS.bMuteFlag = true;
		Session.g_oSubConfMS.bDeafFlag = true;
		Session.g_bMutedState = false;
		Session.g_bHoldState = true;
	}
	else
	{
		Server.logInfo("CHANGE TO SPEAK MODE IN SUB CONF");
		Session.g_oSubConfMS.bMuteFlag = false;
		Session.g_oSubConfMS.bDeafFlag = false;
		Session.g_bMutedState = false;
		Session.g_bHoldState = false;
	}
}
else
{
	if (2 == Session.nAudioMode)
	{
		Server.logInfo("CHANGE TO MUTE MODE IN MAIN CONF");
		Session.g_oMS.bMuteFlag = true;
		Session.g_oMS.bDeafFlag = false;
		Session.g_bMutedState = true;
		Session.g_bHoldState = false;
	}
	else if (1 == Session.nAudioMode)
	{
		Server.logInfo("CHANGE TO MOH MODE IN SUB CONF");
		Session.g_oMS.bMuteFlag = true;
		Session.g_oMS.bDeafFlag = true;
		Session.g_bMutedState = false;
		Session.g_bHoldState = true;
	}
	else
	{
		Server.logInfo("CHANGE TO SPEAK MODE IN MAIN CONF");
		Session.g_oMS.bMuteFlag = false;
		Session.g_oMS.bDeafFlag = false;
		Session.g_bMutedState = false;
		Session.g_bHoldState = false;
	}
}]]></script>
          </scripts>
        </action>
        <action id="104" plug-in="Standard.EndSession.1" ><?xtml-editor x=1663 y=1012 ?></action>
        <action id="105" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1213 y=1014 ?>
          <!--HangUp Caller-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpCaller&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="106" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 35;
Session.g_nConfLeaveReason = 9;
Session.g_strConfLeaveMsg = "FAIL TO ADD PARTY TO CONFERENCE";]]></script>
          </scripts>
        </action>
        <action id="106" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1441 y=1008 ?>
          <!--FAIL end private talk-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strConfControllerIP" transaction="strTransactionId" message-name="s_strConfCsrEndSpeakWith" destination-port="nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="s_nFailure"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
            <parameter tag="&quot;confSchedPartyID&quot;" value="g_lPartySchedId"/>
          </SOAP>
          <results >
            <result name="Default" link="104" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "FAIL TO ADD PARTY BACK INTO CONFERENCE";]]></script>
          </scripts>
        </action>
        <action id="107" plug-in="Standard.Timer.1" ><?xtml-editor x=1259 y=489 ?>
          <!--5 secs to connect MOH-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lMOHTimerId" duration="s_nPreMohTime"/>
          <results >
            <result name="Default" link="108" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bDontPlayContinueToHold = true;
Session.g_bMOHTimerFlag = true;
Session.g_bDtmfCollectionOnHold = true;]]></script>
          </scripts>
        </action>
        <action id="108" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1499 y=476 ?>
          <!--SUCCESS end private talk-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strConfControllerIP" transaction="strTransactionId" message-name="s_strConfCsrEndSpeakWith" destination-port="nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="s_nSuccess"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
            <parameter tag="&quot;confSchedPartyID&quot;" value="g_lPartySchedId"/>
          </SOAP>
          <results >
            <result name="Default" link="20" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "SUCCESS END PRIVATE TALK WITH CSR";]]></script>
          </scripts>
        </action>
        <action id="109" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1119 y=1158 ?>
          <!--party leave-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;PartyLeave&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="104" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nConfLeaveReason = 0;
Session.g_strConfLeaveMsg = "PARTY HANG UP";]]></script>
          </scripts>
        </action>
      </actions>
    </function>
    <function name="OnMoveRequestToConference" start="7" event="MoveRequestToConference" returns="void" >
      <parameters >
        <parameter name="strConfControllerIP" type="string" pass="byref"/>
        <parameter name="nConfControllerPort" type="i4" pass="byref"/>
        <parameter name="strTransactionId" type="string" pass="byref"/>
        <parameter name="strConfScheduleId" type="string" pass="byref"/>
        <parameter name="strConferencePasscode" type="string" pass="byref"/>
        <parameter name="nConfStatus" type="i4" pass="byref"/>
        <parameter name="strSubConferenceId" type="string" pass="byref"/>
        <parameter name="nAudioMode" type="i4" pass="byref"/>
      </parameters>
      <local-vars >
        <var name="nReturnCode" type="i4" >-1</var>
        <var name="lCurrentTime" type="i8" >0</var>
        <var name="nPromptToPlay" type="i4" >99</var>
        <var name="nValidatePasscodeReturnCode" type="i4" >0</var>
        <var name="nCounter" type="i4" >0</var>
        <var name="nWaitForResCounter" type="i4" >0</var>
        <var name="bPlayPleaseHold" type="boolean" >0</var>
        <var name="nPassCodeStatus" type="i4" >0</var>
      </local-vars>
      <actions >
        <action id="7" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=78 y=121 ?>
          <!--stop timers-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;StopTimer&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="12" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: OnMoveRequestToConference");
js_disable_event();
Session.g_nReleaseToConfStatus = Session.nConfStatus;
Session.g_nDefaultAudioMode = Session.nAudioMode;]]></script>
          </scripts>
        </action>
        <action id="1" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=89 y=327 ?>
          <!--authenticate pass code-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceAuthConfPassCode&quot;" return="nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="17" stubbed="1"/>
            <result name="0 - Non First Caller" link="56" stubbed="1" >nReturnCode == s_nNonFirstCaller</result>
            <result name="1 - First Caller" link="56" stubbed="1" >nReturnCode == s_nFirstCaller</result>
            <result name="2 - Wait For Conf Resource" link="56" stubbed="1" >nReturnCode == 2</result>
            <result name="-8 - Passcode inused" link="4" stubbed="0" >nReturnCode == -8</result>
            <result name="-11- WFM" link="56" stubbed="1" >nReturnCode == s_nWaitForMod</result>
            <result name="3 - Special FirstCaller" link="56" stubbed="1" >nReturnCode == 3</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strPassCode = Session.strConferencePasscode;
Session.g_strConfScheduleId = Session.strConfScheduleId;]]></script>
            <script language="javascript" timing="last" ><![CDATA[Session.nValidatePasscodeReturnCode = Session.nReturnCode;
if (Session.g_strConfResource.length <= 0)
{
	Session.g_bNullString = true;
}
else
{
	Session.g_bNullString = false;
}
switch (Session.nReturnCode)
{
	case -2:
		Server.logInfo("INFO: TOO EARLY PASSCODE");
		Session.g_nTerminationReason = 19;
		Session.nPromptToPlay = Session.s_nPromptTooEarly;
		break;
	case -3:
		Server.logInfo("INFO: TOO LATE PASSCODE");
		Session.g_nTerminationReason = 20;
		Session.nPromptToPlay = Session.s_nPromptTooLate;
		break;
	case -4:
		Server.logInfo("INFO: DISABLE SUBSCRIBER");
		Session.g_nTerminationReason = 4;
		Session.nPromptToPlay = Session.s_nPromptDisableSub;
		break;
	case -5:
		Server.logInfo("INFO: MAX ATTENDEES");
		Session.g_nTerminationReason = 15;
		Session.nPromptToPlay = Session.s_nPromptMaxAttendeesReach;
		break;
	case -6:
		Server.logInfo("INFO: CONFERRENCE LOCKED");
		Session.g_nTerminationReason = 16;
		Session.nPromptToPlay = Session.s_nPromptConfLocked;
		break;
	case -7:
		Server.logInfo("INFO: CONFERENCE ALREADY ENDED");
		Session.g_nTerminationReason = 2;
		Session.nPromptToPlay = Session.s_nPromptConfEnded;
		break;
	case -8:
		Server.logInfo("INFO: PASSCODE INUSE");
		Session.g_nTerminationReason = 21;
		Session.nPromptToPlay = 853;
		break;
	case -10:
		Server.logError("ERROR: NO CONFERENCE CONTROLLER");
		Session.g_nTerminationReason = 39;
		Session.nPromptToPlay = Session.s_nPromptNoConfController;
		break;
	case -12:
		Server.logError("ERROR: DISABLE CORPORATE ACCOUNT");
		Session.g_nTerminationReason = 4;
		Session.nPromptToPlay = Session.s_nPromptDisableSub;
		break;
	case -13:
		Server.logInfo("INFO: CONFERENCE DISABLED");
		Session.g_nTerminationReason = 29;
		Session.nPromptToPlay = 853;
		break;
	case -14:
		Server.logError("ERROR: RECURRING WRONG DAY");
		Session.g_nTerminationReason = 26;
		Session.nPromptToPlay = 853;
		break;
	case -15:
		Server.logError("ERROR: INSUFFICIENT BALANCE");
		Session.g_nTerminationReason = 23;
		Session.nPromptToPlay = 853;
		break;
	case -16:
		Server.logError("ERROR: PIN LOCKED");
		Session.g_nTerminationReason = 24;
		Session.nPromptToPlay = 853;
		break;
	case -17:
		Server.logError("ERROR: NO RATE");
		Session.g_nTerminationReason = 46;
		Session.nPromptToPlay = 853;
		break;
	case -18:
		Server.logError("ERROR: CONFERENCE CANCELLED");
		Session.g_nTerminationReason = 25;
		Session.nPromptToPlay = 853;
		break;
	case -19:
		Server.logInfo("INFO: INVALID ACCESS NUMBER");
		Session.g_nTerminationReason = 28;
		Session.nPromptToPlay = 99;
		break;
	case -20:
		Server.logInfo("INFO: INVALID SUBSCRIBER ACCESS NUMBER");
		Session.g_nErrorMsgNumber = 4016; //conf subscriber invalid access number
		Session.g_nTerminationReason = 28;
		Session.nPromptToPlay = 99;
		break;
	case -22:
		Server.logError("ERROR: INSUFFICIENT MS RESOURCE");
		Session.g_nErrorMsgNumber = 4018; //insufficient ms resource
		Session.g_nTerminationReason = 30;
		Session.nPromptToPlay = 99;
		break;
	case -98:
		Server.logError("ERROR: DB RESTARTING:" + Session.g_strPassCode);
		Session.g_nTerminationReason = 39;
		Session.nPromptToPlay = Session.s_nPromptSystemUnavailable;
		break;
	case -99:
		Server.logError("ERROR: DB ERROR PASSCODE:" + Session.g_strPassCode);
		Session.g_nTerminationReason = 39;
		Session.nPromptToPlay = Session.s_nPromptDBError;
		break;
	default:
		Session.g_nTerminationReason = 39;
		Session.nPromptToPlay = 305;  //system error
		break;
}]]></script>
          </scripts>
        </action>
        <action id="3" plug-in="Standard.WaitEvent.1" ><?xtml-editor x=806 y=306 ?>
          <!--for PONG-->
          <wait xmlns="urn:www.pactolus.com:xtml:communication" timeout="10" recv-name="g_strEventReceived" >
            <msg name="ConferencePong" >
              <parameter >nPassCodeStatus</parameter>
            </msg>
          </wait>
          <results >
            <result name="Default" link="6" stubbed="1"/>
            <result name="Success" link="5" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="4" plug-in="Pactolus.Branch.1" ><?xtml-editor x=353 y=317 ?>
          <!--same session-->
          <results >
            <result name="Default" link="9" stubbed="0"/>
            <result name="same session" link="6" stubbed="0" >g_strExistingSessionId match g_strSessionId</result>
          </results>
        </action>
        <action id="5" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1038 y=305 ?>
          <!--passcode inused?-->
          <results >
            <result name="Default" link="6" stubbed="1"/>
            <result name="passcode inused" link="26" stubbed="0" >nValidatePasscodeReturnCode == s_nPasscodeInUsed</result>
          </results>
        </action>
        <action id="6" plug-in="Pactolus.JavaStaticMethod.1" ><?xtml-editor x=579 y=441 ?>
          <!--"psAPISceConfCleanup"-->
          <java xmlns="urn:www.pactolus.com:xtml:application" class="&quot;com.pactolus.conferencing.psAPISceConfCleanup&quot;" method="&quot;cleanupCallLeg&quot;" timeout="s_nTimeout" return="" method-return-var="nReturnCode" method-return-type="0" >
            <parameter type="in" var-type="unknown" >g_strDBNAME</parameter>
            <parameter type="in" var-type="unknown" >g_strExistingCallLegId</parameter>
            <parameter type="in" var-type="unknown" >lCurrentTime</parameter>
          </java>
          <results >
            <result name="Default" link="26" stubbed="1"/>
            <result name="Success" link="25" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: ********JAVA CALLING psAPISceConfCleanupCallLeg *********");
Session.lCurrentTime = Server.getUTCTime();]]></script>
            <script language="javascript" timing="last" ><![CDATA[Server.logInfo("INFO: ********** iJavaReturnCode " + Session.nReturnCode);
if (Result.id == 2)
{
	Server.logInfo("INFO: SUCCESS CALL psAPISceConfCleanupCallLeg.");
}
else
{
	Server.logError("ERROR: FAIL TO CALL psAPISceConfCleanupCallLeg, EXIT ON: " + Result.name);
}]]></script>
          </scripts>
        </action>
        <action id="9" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=569 y=315 ?>
          <!--PING to session-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="" transaction="" message-name="&quot;ConferencePing&quot;" destination-port="" destination-type="3" destination-session="g_strExistingSessionId" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;PingSessionId&quot;" value="g_strSessionId"/>
            <parameter tag="&quot;CallLegId&quot;" value="g_strPassCode"/>
          </SOAP>
          <results >
            <result name="Default" link="6" stubbed="1"/>
            <result name="Success" link="3" stubbed="0"/>
            <result name="Error"/>
          </results>
        </action>
        <action id="10" plug-in="Standard.EndSession.1" ><?xtml-editor x=1748 y=298 ?></action>
        <action id="11" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1501 y=302 ?>
          <!--Hang up caller-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpCaller&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="10" stubbed="0"/>
          </results>
        </action>
        <action id="12" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=506 y=116 ?>
          <!--"psAPISceEndRequest"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceEndRequest&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="14" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 4;]]></script>
          </scripts>
        </action>
        <action id="13" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=299 y=65 ?>
          <!--"psAPISceEndAssignment"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceEndAssignment&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="12" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_lCSRAssignmentEndTime = Server.getUTCTime();]]></script>
          </scripts>
        </action>
        <action id="14" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=722 y=113 ?>
          <!--Remove member from temp conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;RemoveMemberFromConference&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
          </function>
          <results >
            <result name="Default" link="15" stubbed="0"/>
          </results>
        </action>
        <action id="15" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=943 y=109 ?>
          <!--delete temp conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DeleteConference&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
          </function>
          <results >
            <result name="Default" link="58" stubbed="0"/>
          </results>
        </action>
        <action id="16" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=542 y=676 ?>
          <!--"MSOutdialParty"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;MSOutdialParty&quot;" return="nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oCallLegA</parameter>
            <parameter >g_oMS</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="11" stubbed="1"/>
            <result name="SUCCESS" link="19" stubbed="0" >nReturnCode == s_nSuccess</result>
            <result name="CALLER HUNGUP" link="21" stubbed="1" >nReturnCode == s_nCallerHungup</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (1 == Result.id)
{
	Server.logError("FAIL TO OUTDIAL PARTY TO MS.");
	Session.g_nTerminationReason = 34;
}]]></script>
          </scripts>
        </action>
        <action id="17" plug-in="Pactolus.Branch.1" ><?xtml-editor x=304 y=700 ?>
          <!--Dial In?-->
          <results >
            <result name="Default" link="16" stubbed="0"/>
            <result name="g_strOutdialFlag = &quot;T&quot;;" link="18" stubbed="0" >g_strOutdialFlag match "T"</result>
          </results>
        </action>
        <action id="18" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=557 y=820 ?>
          <!--"MSOutdialParty"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;MSOutdialParty&quot;" return="nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oCallLegB</parameter>
            <parameter >g_oMS</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="11" stubbed="1"/>
            <result name="SUCCESS" link="19" stubbed="1" >nReturnCode == s_nSuccess</result>
            <result name="CALLER HUNGUP" link="21" stubbed="0" >nReturnCode == s_nCallerHungup</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (1 == Result.id)
{
	Server.logError("FAIL TO OUTDIAL PARTY TO MS.");
	Session.g_nTerminationReason = 34;
}]]></script>
          </scripts>
        </action>
        <action id="19" plug-in="Pactolus.Branch.1" ><?xtml-editor x=772 y=674 ?>
          <!--validate passcode-->
          <results >
            <result name="Default" link="26" stubbed="1"/>
            <result name="0 - Non First Caller" link="27" stubbed="0" >nValidatePasscodeReturnCode == s_nNonFirstCaller</result>
            <result name="1 - First Caller" link="39" stubbed="1" >nValidatePasscodeReturnCode == s_nFirstCaller</result>
            <result name="2 - Wait For Conf Resource" link="42" stubbed="1" >nValidatePasscodeReturnCode == 2</result>
            <result name="-11 - Wait For Moderator" link="54" stubbed="0" >nValidatePasscodeReturnCode == s_nWaitForMod</result>
            <result name="3 - Special FirstCaller" link="27" stubbed="1" >nValidatePasscodeReturnCode == 3</result>
          </results>
        </action>
        <action id="20" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1457 y=204 ?>
          <!--"DisconnectFromMOH"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DisconnectFromMOH&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="1" stubbed="1"/>
          </results>
        </action>
        <action id="21" plug-in="Pactolus.Branch.1" ><?xtml-editor x=764 y=820 ?>
          <results >
            <result name="Default" link="10" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 1;
//caller hangup]]></script>
          </scripts>
        </action>
        <action id="25" plug-in="Pactolus.Branch.1" ><?xtml-editor x=821 y=439 ?>
          <!--exceed max retry?-->
          <results >
            <result name="Default" link="1" stubbed="1"/>
            <result name="Counter &gt;= MaxRetry?" link="26" stubbed="1" >nCounter &gt;= g_nMaxRetryAllowed</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.nCounter++;
Session.g_strRetryFlag = "T";]]></script>
          </scripts>
        </action>
        <action id="26" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1282 y=298 ?>
          <!--could not be added-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oTempConf.strConnectionId" endpoint="g_oTempConf.strEndPoint" callid="g_oTempConf.strCallId" repeat="1" timeout="10" ms-type="g_oTempConf.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >301</audio>
            <audio type="index" >874</audio>
          </play>
          <results >
            <result name="Default" link="11" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 21;

Session.g_nErrorMsgNumber = 4007;  //passcode in used]]></script>
          </scripts>
        </action>
        <action id="27" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1015 y=672 ?>
          <!--conferenceResource == null?-->
          <results >
            <result name="Default" link="39" stubbed="1"/>
            <result name="conferenceResource == null" link="26" stubbed="1" >g_bNullString == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (Session.g_strConfResource.length <= 0)
{
	Session.g_bNullString = true;
	Session.g_nErrorMsgNumber = 4014;
	Session.g_nTerminationReason = 39;
	Session.g_strReturnMsg = "NULL CONFERENCE RESOURCE, UNABLE TO ADD PARTY TO THE CONFERENCE";
	if (3 == Session.f_nReturnCode)
		Server.logError("ERROR: THE FIRST CALLER and NO NEED TO GET CONFERENCE ENDPOINT, BUT CONF RESOURCE IS NULL: " + Session.g_strConfResource);
	else
		Server.logError("ERROR: NOT THE FIRST CALLER, BUT CONF RESOURCE IS NULL: " + Session.g_strConfResource);
}
else
{
	Session.g_bNullString = false;
	Session.g_oMS.strConferenceId = Session.g_strConfResource;
}]]></script>
          </scripts>
        </action>
        <action id="28" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1072 y=1632 ?>
          <!--could not be added-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >301</audio>
            <audio type="index" >874</audio>
          </play>
          <results >
            <result name="Default" link="11" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="29" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=769 y=952 ?>
          <!--"RecordCallerName"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;RecordCallerName&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="35" stubbed="0"/>
          </results>
        </action>
        <action id="30" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=342 y=909 ?>
          <!--Collect billing code-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;(xxxxxxxxxx|x.T|x.#)&quot;" language="g_strLanguage" digits="g_strBillingCodeNumber" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >943</audio>
          </play>
          <results >
            <result name="Default" link="31" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="31" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=557 y=954 ?>
          <!--set billing code-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceSetBillingCode&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="29" stubbed="0"/>
          </results>
        </action>
        <action id="32" plug-in="Pactolus.Branch.1" ><?xtml-editor x=767 y=1093 ?>
          <!--first caller?-->
          <results >
            <result name="Default" link="34" stubbed="0"/>
            <result name="g_bFirstCaller==true &amp;&amp; create conf" link="33" stubbed="0" >g_bFirstCaller == true
AND g_bNoCreateConfFirstCaller == false</result>
            <result name="g_bFirstCaller==true &amp;&amp; no create conf" link="34" stubbed="1" >g_bFirstCaller == true
AND g_bNoCreateConfFirstCaller == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("g_strSubConferenceId IS: " + Session.g_strSubConferenceId);
Server.logInfo("strSubConferenceId IS: " + Session.strSubConferenceId);
Server.logInfo("strSubConferenceId.length IS: " + Session.strSubConferenceId.length);
Session.g_strSubConferenceId = Session.strSubConferenceId;

if (Session.strSubConferenceId.length > 0)
{
	Server.logInfo("strSubConferenceId.length IS GREATER THAN ZERO");
	Session.g_bMoveDirectlyInSubConf = true;
}
else
{
	Server.logInfo("strSubConferenceId.length IS LESS THAN ZERO");
	Session.g_bMoveDirectlyInSubConf = false;
}
Server.logInfo("MOVE DIRECTLY TO SUB CONF FLAG IS: " + Session.g_bMoveDirectlyInSubConf);]]></script>
          </scripts>
        </action>
        <action id="33" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1016 y=1182 ?>
          <!--go to main, create conf-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;Main&quot;" return="" external-function="0" library="" >
            <parameter >s_nStateCreateConference</parameter>
          </function>
          <results >
            <result name="Default" link="40" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nCallerCurrentState = Session.s_nStateAddCallerToConf;
js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="34" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1002 y=1067 ?>
          <!--go to main, add to conf-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;Main&quot;" return="" external-function="0" library="" >
            <parameter >s_nStateAddToConference</parameter>
          </function>
          <results >
            <result name="Default" link="40" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_oMS.strConferenceId = Session.g_strConfResource;
Session.g_nCallerCurrentState = Session.s_nStateAddCallerToConf;
js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="35" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=525 y=1098 ?>
          <!--Delete MS Connection-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DeleteMSConnection&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="32" stubbed="0"/>
          </results>
        </action>
        <action id="39" plug-in="Pactolus.Branch.1" ><?xtml-editor x=72 y=918 ?>
          <!--get billing code?-->
          <results >
            <result name="Default" link="29" stubbed="1"/>
            <result name="g_strBillingCodeFlag==T" link="30" stubbed="0" >g_strBillingCodeFlag match "T"</result>
          </results>
        </action>
        <action id="40" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1223 y=1068 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
        </action>
        <action id="41" plug-in="Pactolus.Sleep.1" ><?xtml-editor x=570 y=1369 ?>
          <!--5 secs-->
          <sleep xmlns="urn:www.pactolus.com:xtml:application" duration="5"/>
          <results >
            <result name="Default" link="47" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (Session.bPlayPleaseHold == true)
{
	Session.bPlayPleaseHold = false;
}
else if(Session.bPlayPleaseHold == false)
{
	Session.bPlayPleaseHold = true;
}]]></script>
          </scripts>
        </action>
        <action id="42" plug-in="Pactolus.Branch.1" ><?xtml-editor x=54 y=1416 ?>
          <!--exceed max retry?-->
          <results >
            <result name="Default" link="44" stubbed="0"/>
            <result name="Counter &gt; MaxRetry?" link="43" stubbed="0" >nWaitForResCounter &gt; s_nMaxRetryWaitConfRes</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.nWaitForResCounter++;
Session.g_strRetryFlag = "T";]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (2 == Result.id)
{
	Session.g_nTerminationReason = 2;
	Session.g_nErrorMsgNumber = 4012;  //exceed max wait for conf resource
	Server.logError("ERROR: EXCEED MAX WAIT FOR CONFERENCE RESOURCE.");
}]]></script>
          </scripts>
        </action>
        <action id="43" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=325 y=1524 ?>
          <!--could not be add-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >301</audio>
            <audio type="index" >874</audio>
            <audio type="index" >361</audio>
          </play>
          <results >
            <result name="Default" link="11" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 2;
Session.g_nErrorMsgNumber = 4012;  //exceed max wait for conf resource
Server.logError("ERROR: EXCEED MAX WAIT FOR CONFERENCE RESOURCE.")]]></script>
          </scripts>
        </action>
        <action id="44" plug-in="Pactolus.Branch.1" ><?xtml-editor x=305 y=1374 ?>
          <!--play hold?-->
          <results >
            <result name="Default" link="41" stubbed="0"/>
            <result name="bPlayPleaseHold == true" link="45" stubbed="0" >bPlayPleaseHold == true</result>
          </results>
        </action>
        <action id="45" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=585 y=1502 ?>
          <!--please hold-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >898</audio>
          </play>
          <results >
            <result name="Default" link="41" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.bPlayPleaseHold = false;]]></script>
          </scripts>
        </action>
        <action id="47" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=833 y=1362 ?>
          <!--authenticate pass code-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceAuthConfPassCode&quot;" return="nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="28" stubbed="0"/>
            <result name="0 - Non First Caller" link="27" stubbed="1" >nReturnCode == s_nNonFirstCaller</result>
            <result name="1 - First Caller" link="39" stubbed="1" >nReturnCode == s_nFirstCaller</result>
            <result name="2 - Wait For Conf Resource" link="42" stubbed="1" >nReturnCode == 2</result>
            <result name="-8 - Passcode inused" link="49" stubbed="0" >nReturnCode == -8</result>
            <result name="-11- WFM" link="54" stubbed="1" >nReturnCode == s_nWaitForMod</result>
            <result name="3 - Special FirstCaller" link="27" stubbed="1" >nReturnCode == 3</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Session.g_strConfResource.length <= 0)
{
	Session.g_bNullString = true;
}
else
{
	Session.g_bNullString = false;
}
switch (Session.nReturnCode)
{
	case -2:
		Server.logInfo("INFO: TOO EARLY PASSCODE");
		Session.g_nTerminationReason = 19;
		Session.nPromptToPlay = Session.s_nPromptTooEarly;
		break;
	case -3:
		Server.logInfo("INFO: TOO LATE PASSCODE");
		Session.g_nTerminationReason = 20;
		Session.nPromptToPlay = Session.s_nPromptTooLate;
		break;
	case -4:
		Server.logInfo("INFO: DISABLE SUBSCRIBER");
		Session.g_nTerminationReason = 4;
		Session.nPromptToPlay = Session.s_nPromptDisableSub;
		break;
	case -5:
		Server.logInfo("INFO: MAX ATTENDEES");
		Session.g_nTerminationReason = 15;
		Session.nPromptToPlay = Session.s_nPromptMaxAttendeesReach;
		break;
	case -6:
		Server.logInfo("INFO: CONFERRENCE LOCKED");
		Session.g_nTerminationReason = 16;
		Session.nPromptToPlay = Session.s_nPromptConfLocked;
		break;
	case -7:
		Server.logInfo("INFO: CONFERENCE ALREADY ENDED");
		Session.g_nTerminationReason = 2;
		Session.nPromptToPlay = Session.s_nPromptConfEnded;
		break;
	case -8:
		Server.logInfo("INFO: PASSCODE INSUED");
		Session.g_nTerminationReason = 21;
		Session.nPromptToPlay = 853;
		break;
	case -10:
		Server.logError("ERROR: NO CONFERENCE CONTROLLER");
		Session.g_nTerminationReason = 39;
		Session.nPromptToPlay = Session.s_nPromptNoConfController;
		break;
	case -12:
		Server.logError("ERROR: DISABLE CORPORATE ACCOUNT");
		Session.g_nTerminationReason = 4;
		Session.nPromptToPlay = Session.s_nPromptDisableSub;
		break;
	case -13:
		Server.logInfo("INFO: CONFERENCE DISABLED");
		Session.g_nTerminationReason = 29;
		Session.nPromptToPlay = 853;
		break;
	case -14:
		Server.logError("ERROR: RECURRING WRONG DAY");
		Session.g_nTerminationReason = 26;
		Session.nPromptToPlay = 853;
		break;
	case -15:
		Server.logError("ERROR: INSUFFICIENT BALANCE");
		Session.g_nTerminationReason = 23;
		Session.nPromptToPlay = 853;
		break;
	case -16:
		Server.logError("ERROR: PIN LOCKED");
		Session.g_nTerminationReason = 24;
		Session.nPromptToPlay = 853;
		break;
	case -17:
		Server.logError("ERROR: NO RATE");
		Session.g_nTerminationReason = 46;
		Session.nPromptToPlay = 853;
		break;
	case -18:
		Server.logError("ERROR: CONFERENCE CANCELLED");
		Session.g_nTerminationReason = 25;
		Session.nPromptToPlay = 853;
		break;
	case -19:
		Server.logInfo("INFO: INVALID ACCESS NUMBER");
		Session.g_nTerminationReason = 28;
		Session.nPromptToPlay = 99;
		break;
	case -20:
		Server.logInfo("INFO: INVALID SUBSCRIBER ACCESS NUMBER");
		Session.g_nErrorMsgNumber = 4016; //conf subscriber invalid access number
		Session.g_nTerminationReason = 28;
		Session.nPromptToPlay = 99;
		break;
	case -22:
		Server.logError("ERROR: INSUFFICIENT MS RESOURCE");
		Session.g_nErrorMsgNumber = 4018; //insufficient ms resource
		Session.g_nTerminationReason = 30;
		Session.nPromptToPlay = 99;
		break;
	case -98:
		Server.logError("ERROR: DB RESTARTING:" + Session.g_strPassCode);
		Session.g_nTerminationReason = 39;
		Session.nPromptToPlay = Session.s_nPromptSystemUnavailable;
		break;
	case -99:
		Server.logError("ERROR: DB ERROR PASSCODE:" + Session.g_strPassCode);
		Session.g_nTerminationReason = 39;
		Session.nPromptToPlay = Session.s_nPromptDBError;
		break;
	default:
		Session.g_nTerminationReason = 39;
		Session.nPromptToPlay = 305;  //system error
		break;
}]]></script>
          </scripts>
        </action>
        <action id="48" plug-in="Standard.WaitEvent.1" ><?xtml-editor x=1510 y=1352 ?>
          <!--for PONG-->
          <wait xmlns="urn:www.pactolus.com:xtml:communication" timeout="10" recv-name="g_strEventReceived" >
            <msg name="ConferencePong" >
              <parameter >nPassCodeStatus</parameter>
            </msg>
          </wait>
          <results >
            <result name="Default" link="50" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="49" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1057 y=1363 ?>
          <!--same session-->
          <results >
            <result name="Default" link="51" stubbed="0"/>
            <result name="same session" link="50" stubbed="0" >g_strExistingSessionId match g_strSessionId</result>
          </results>
        </action>
        <action id="50" plug-in="Pactolus.JavaStaticMethod.1" ><?xtml-editor x=1283 y=1487 ?>
          <!--"psAPISceConfCleanup"-->
          <java xmlns="urn:www.pactolus.com:xtml:application" class="&quot;com.pactolus.conferencing.psAPISceConfCleanup&quot;" method="&quot;cleanupCallLeg&quot;" timeout="s_nTimeout" return="" method-return-var="nReturnCode" method-return-type="0" >
            <parameter type="in" var-type="unknown" >g_strDBNAME</parameter>
            <parameter type="in" var-type="unknown" >g_strExistingCallLegId</parameter>
            <parameter type="in" var-type="unknown" >lCurrentTime</parameter>
          </java>
          <results >
            <result name="Default" link="53" stubbed="1"/>
            <result name="Success" link="52" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: ********JAVA CALLING psAPISceConfCleanupCallLeg *********");
Session.lCurrentTime = Server.getUTCTime();]]></script>
            <script language="javascript" timing="last" ><![CDATA[Server.logInfo("INFO: ********** iJavaReturnCode " + Session.nReturnCode);
if (Result.id == 2)
{
	Server.logInfo("INFO: SUCCESS CALL psAPISceConfCleanupCallLeg.");
}
else
{
	Server.logError("ERROR: FAIL TO CALL psAPISceConfCleanupCallLeg, EXIT ON: " + Result.name);
}]]></script>
          </scripts>
        </action>
        <action id="51" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1273 y=1361 ?>
          <!--PING to session-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="" transaction="" message-name="&quot;ConferencePing&quot;" destination-port="" destination-type="3" destination-session="g_strExistingSessionId" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;PingSessionId&quot;" value="g_strSessionId"/>
            <parameter tag="&quot;CallLegId&quot;" value="g_strPassCode"/>
          </SOAP>
          <results >
            <result name="Default" link="50" stubbed="1"/>
            <result name="Success" link="48" stubbed="0"/>
            <result name="Error"/>
          </results>
        </action>
        <action id="52" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1525 y=1485 ?>
          <!--exceed max retry?-->
          <results >
            <result name="Default" link="47" stubbed="1"/>
            <result name="Counter &gt;= MaxRetry?" link="53" stubbed="0" >nCounter &gt;= g_nMaxRetryAllowed</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.nCounter++;
Session.g_strRetryFlag = "T";]]></script>
          </scripts>
        </action>
        <action id="53" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1760 y=1483 ?>
          <!--could not be added-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >301</audio>
            <audio type="index" >874</audio>
          </play>
          <results >
            <result name="Default" link="11" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 21;
Session.g_nErrorMsgNumber = 4007;  //passcode in used
Server.logError("ERROR: PASSCODE IN USED.");]]></script>
          </scripts>
        </action>
        <action id="54" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1043 y=838 ?>
          <!--"RecordCallerName"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;RecordCallerName&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="55" stubbed="0"/>
          </results>
        </action>
        <action id="55" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1289 y=830 ?>
          <!--go to main, wait for mod-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;Main&quot;" return="" external-function="0" library="" >
            <parameter >s_nStateWaitForMod</parameter>
          </function>
          <results >
            <result name="Default" link="40" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nCallerCurrentState = Session.s_nStateAddCallerToConf;
Session.g_bWaitForModerator = true;
js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="56" plug-in="Pactolus.Branch.1" ><?xtml-editor x=87 y=607 ?>
          <!--get billing code?-->
          <results >
            <result name="Default" link="57" stubbed="0"/>
            <result name="g_strBillingCodeFlag==T" link="17" stubbed="0" >g_strBillingCodeFlag match "T"
OR g_strRecordNamesFlag match "T"</result>
          </results>
        </action>
        <action id="57" plug-in="Pactolus.Branch.1" ><?xtml-editor x=289 y=534 ?>
          <!--validate passcode-->
          <results >
            <result name="Default" link="17" stubbed="1"/>
            <result name="0 - Non First Caller" link="27" stubbed="1" >nValidatePasscodeReturnCode == s_nNonFirstCaller</result>
            <result name="1 - First Caller" link="32" stubbed="1" >nValidatePasscodeReturnCode == s_nFirstCaller</result>
            <result name="2 - Wait For Conf Resource" link="17" stubbed="1" >nValidatePasscodeReturnCode == 2</result>
            <result name="-11 - Wait For Moderator" link="55" stubbed="1" >nValidatePasscodeReturnCode == s_nWaitForMod</result>
            <result name="3 - Special First Caller" link="27" stubbed="1" >nValidatePasscodeReturnCode == 3</result>
          </results>
        </action>
        <action id="58" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1202 y=110 ?>
          <!--MOH?-->
          <results >
            <result name="Default" link="59" stubbed="0"/>
            <result name="g_strMusicOnHoldFlag==&quot;T&quot;" link="20" stubbed="0" >g_strMusicOnHoldFlag match "T"</result>
          </results>
        </action>
        <action id="59" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1443 y=101 ?>
          <!--"DeleteMSConnection"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DeleteMSConnection&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="1" stubbed="1"/>
          </results>
        </action>
      </actions>
      <text-objects >
        <text-object x-coord="841" y-coord="1539" width="412" height="52" text="Wait for conf resource, need to validate again" font-name="Times New Roman" size="-16" red="0" green="0" blue="0" weight="0" underline="0" strikeout="0" point-size="12" italic="0"/>
      </text-objects>
    </function>
    <function name="OnConfAudioModeChangeRequest" start="90" event="ConfAudioModeChangeRequest" returns="void" >
      <parameters >
        <parameter name="strConferenceControllerIP" type="string" pass="byref"/>
        <parameter name="nConferenceControllerPort" type="i4" pass="byref"/>
        <parameter name="strTransactionId" type="string" pass="byref"/>
        <parameter name="nFromMode" type="i4" pass="byref"/>
        <parameter name="nToMode" type="i4" pass="byref"/>
        <parameter name="strNotifyMS" type="string" pass="byref"/>
      </parameters>
      <local-vars >
        <var name="f_nReturnCode" type="i4" >0</var>
      </local-vars>
      <actions >
        <action id="90" plug-in="Pactolus.Branch.1" ><?xtml-editor x=59 y=138 ?>
          <results >
            <result name="Default" link="93" stubbed="0"/>
            <result name="strNotifyMS == &quot;T&quot;" link="1" stubbed="0" >strNotifyMS match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_disable_event();
Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: OnConfAudioModeChangeRequest");
Server.logInfo("From Mode: " + Session.nFromMode);
Server.logInfo("To Mode: " + Session.nToMode);
Server.logInfo("Notify MS: " + Session.strNotifyMS);]]></script>
          </scripts>
        </action>
        <action id="1" plug-in="Pactolus.Branch.1" ><?xtml-editor x=296 y=222 ?>
          <!--speak, mute, hold?-->
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="Mute" link="11" stubbed="0" >nToMode == 2</result>
            <result name="Hold" link="36" stubbed="0" >nToMode == 1</result>
            <result name="Speak" link="41" stubbed="0" >nToMode == 0</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (1 == Result.id)
{
	Session.g_strReturnMsg = "FAILURE TO CHANGE AUDIO MODE, UNKNOWN AUDIO MODE.";
}
else
{
	Session.g_strReturnMsg = "";
}

Server.logInfo("EXIT BRANCH NAME : " + Result.name + "  BRANCH ID " + Result.id);]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=586 y=196 ?>
          <!--"ConfAudioModeChangeResponse"
FAILURE-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strConferenceControllerIP" transaction="strTransactionId" message-name="&quot;ConfAudioModeChangeResponse&quot;" destination-port="nConferenceControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="s_nFailure"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
          </SOAP>
          <results >
            <result name="Default" link="89" stubbed="0"/>
            <result name="Success" link="89" stubbed="1"/>
            <result name="Error"/>
          </results>
        </action>
        <action id="3" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=578 y=96 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("CURRENT MUTE STATE IS: " + Session.g_bMutedState);
Server.logInfo("CURRENT HOLD STATE IS: " + Session.g_bHoldState);

if (Session.g_bCurrentlyInSubConf)
{
	Server.logInfo("CURRENTLY IN SUB CONFERENCE");
}
else if (Session.g_bTalkingWithCSR)
{
	Server.logInfo("CURRENTLY NOT IN SUB CONFERENCE");
}
else
{
	Server.logInfo("CURRENTLY NOT IN SUB CONFERENCE");
}
if (0 == Session.nToMode)
{
	Session.g_bHoldState = false;
	Session.g_bMutedState = false;
}
else if (1 == Session.nToMode)
{
	Session.g_bHoldState = true;
	Session.g_bMutedState = false;
	Session.g_nPromptSelfMuteUnMute = 907;
}
else if (2 == Session.nToMode)
{
	Session.g_bHoldState = false;
	Session.g_bMutedState = true;
	Session.g_nPromptSelfMuteUnMute = 908;
}
Server.logInfo("CURRENT MUTE STATE NOW IS: " + Session.g_bMutedState);
Server.logInfo("CURRENT HOLD STATE NOW IS: " + Session.g_bHoldState);
if (0 == Session.nFromMode && 2 == Session.nToMode && Session.g_bPartyHandRaised)
{
	Server.logInfo("GOES FROM SPEAK TO MUTE AND HAND RAISED, SET HAND RAISED TO FALSE");
	Session.g_bPartyHandRaised = false;
}
js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="4" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1085 y=319 ?>
          <!--"ChangeToMuteMode"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ChangeToMutedMode&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="2" stubbed="1"/>
            <result name="SUCCESS" link="12" stubbed="1" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_oMS.bMuteFlag = true;]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (1 == Result.id)
{
	Session.g_strReturnMsg = "FAILURE TO CHANGE AUDIO MODE, ChangeToMuteMode returns failure.";
}
else
{
	Session.g_strReturnMsg = "";
}]]></script>
          </scripts>
        </action>
        <action id="5" plug-in="Pactolus.Branch.1" ><?xtml-editor x=834 y=320 ?>
          <!--in sub conf?-->
          <results >
            <result name="Default" link="4" stubbed="0"/>
            <result name="g_bCurrentlyInSubConf" link="6" stubbed="0" >g_bCurrentlyInSubConf == true</result>
            <result name="g_bTalkingToCSR" link="9" stubbed="0" >g_bTalkingWithCSR == true
AND g_bSideBarOperatorRequest == true</result>
          </results>
        </action>
        <action id="6" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1101 y=439 ?>
          <!--"ChangeToMuteMode"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ChangeToMutedMode&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oSubConfMS</parameter>
          </function>
          <results >
            <result name="Default" link="2" stubbed="1"/>
            <result name="SUCCESS" link="12" stubbed="1" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_oSubConfMS.bMuteFlag = true;]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (1 == Result.id)
{
	Session.g_strReturnMsg = "FAILURE TO CHANGE AUDIO MODE, ChangeToMuteMode returns failure.";
}
else
{
	Session.g_strReturnMsg = "";
}]]></script>
          </scripts>
        </action>
        <action id="9" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1105 y=560 ?>
          <!--"ChangeToMuteMode"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ChangeToMutedMode&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
          </function>
          <results >
            <result name="Default" link="2" stubbed="1"/>
            <result name="SUCCESS" link="12" stubbed="1" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_oTempConf.bMuteFlag = true;]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (1 == Result.id)
{
	Session.g_strReturnMsg = "FAILURE TO CHANGE AUDIO MODE, ChangeToMuteMode returns failure.";
}
else
{
	Session.g_strReturnMsg = "";
}]]></script>
          </scripts>
        </action>
        <action id="11" plug-in="Pactolus.Branch.1" ><?xtml-editor x=587 y=329 ?>
          <results >
            <result name="Default" link="5" stubbed="0"/>
            <result name="main menu?" link="2" stubbed="1" >g_bCurrentlyInMMenu == true</result>
            <result name="currently muted." link="5" stubbed="1" >g_bMutedState == true</result>
            <result name="currently hold" link="87" stubbed="1" >g_bHoldState == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Session.g_bCurrentlyInMMenu)
{
	Session.g_strReturnMsg = "FAILURE TO CHANGE AUDIO MODE, PARTY IS CURRENTLY IN MAIN MENU.";
}
else if (Session.g_bMutedState)
{
	Session.g_strReturnMsg = "FAILURE TO CHANGE AUDIO MODE, PARTY IS ALREADY MUTED";
}
else
{
	Session.g_strReturnMsg = "";
}
Server.logInfo("EXIT BRANCH NAME : " + Result.name + "  BRANCH ID " + Result.id);]]></script>
          </scripts>
        </action>
        <action id="12" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1578 y=309 ?>
          <!--"ConfAudioModeChangeResponse"-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strConferenceControllerIP" transaction="strTransactionId" message-name="&quot;ConfAudioModeChangeResponse&quot;" destination-port="nConferenceControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="s_nSuccess"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
          </SOAP>
          <results >
            <result name="Default" link="15" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "SUCCESSFUL MUTE A PARTY";]]></script>
          </scripts>
        </action>
        <action id="15" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1858 y=307 ?>
          <!--set DTMF Detection ON-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;SetDTMFOn&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="3" stubbed="1"/>
          </results>
        </action>
        <action id="19" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1608 y=647 ?>
          <!--"ChangeToDataMode"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ChangeToDataMode&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="2" stubbed="1"/>
            <result name="SUCCESS" link="27" stubbed="0" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_oMS.bMuteFlag = true;
Session.g_oMS.bDeafFlag = true;]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (1 == Result.id)
{
	Session.g_strReturnMsg = "FAILURE TO CHANGE AUDIO MODE, ModifyConferenceMember returns failure.";
}
else
{
	Session.g_strReturnMsg = "";
}]]></script>
          </scripts>
        </action>
        <action id="22" plug-in="Standard.Timer.1" ><?xtml-editor x=2101 y=1064 ?>
          <!--5 secs to connect MOH-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lMOHTimerId" duration="s_nPreMohTime"/>
          <results >
            <result name="Default" link="37" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bMOHTimerFlag = true;
Session.g_bDtmfCollectionOnHold = true;]]></script>
          </scripts>
        </action>
        <action id="23" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1863 y=1064 ?>
          <!--Remove member from conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;RemoveMemberFromConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="22" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: CONF HOLD PARTY REQUEST, REMOVE MEMBER FROM CONFERENCE.");]]></script>
          </scripts>
        </action>
        <action id="25" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1123 y=744 ?>
          <!--MOH?-->
          <results >
            <result name="Default" link="38" stubbed="0"/>
            <result name="g_strMusicOnHoldFlag==&quot;T&quot;" link="32" stubbed="0" >g_strMusicOnHoldFlag match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bDontPlayContinueToHold = true;]]></script>
          </scripts>
        </action>
        <action id="26" plug-in="Standard.Timer.1" ><?xtml-editor x=2072 y=636 ?>
          <!--play please hold every 10 secs-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lHoldTimerId" duration="s_nSleepTime"/>
          <results >
            <result name="Default" link="97" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bHoldTimerFlag = true;]]></script>
          </scripts>
        </action>
        <action id="27" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1850 y=637 ?>
          <!--please hold-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >898</audio>
          </play>
          <results >
            <result name="Default" link="26" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="30" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1869 y=793 ?>
          <!--"ChangeToDataMode"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ChangeToDataMode&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oSubConfMS</parameter>
          </function>
          <results >
            <result name="Default" link="2" stubbed="1"/>
            <result name="SUCCESS" link="31" stubbed="0" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_oSubConfMS.bMuteFlag = true;
Session.g_oSubConfMS.bDeafFlag = true;]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (1 == Result.id)
{
	Session.g_strReturnMsg = "FAILURE TO CHANGE AUDIO MODE, ModifyConferenceMember returns failure.";
}
else
{
	Session.g_strReturnMsg = "";
}]]></script>
          </scripts>
        </action>
        <action id="31" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2110 y=787 ?>
          <!--please hold-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oSubConfMS.strConnectionId" endpoint="g_oSubConfMS.strEndPoint" callid="g_oSubConfMS.strCallId" repeat="1" timeout="10" ms-type="g_oSubConfMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >898</audio>
          </play>
          <results >
            <result name="Default" link="26" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="32" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1609 y=1064 ?>
          <!--in sub conf?-->
          <results >
            <result name="Default" link="23" stubbed="0"/>
            <result name="g_bCurrentlyInSubConf" link="33" stubbed="0" >g_bCurrentlyInSubConf == true</result>
            <result name="g_bTalkingToCSR" link="34" stubbed="0" >g_bSideBarOperatorRequest == true
AND g_bTalkingWithCSR == true</result>
          </results>
        </action>
        <action id="33" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1883 y=1176 ?>
          <!--Remove member from conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;RemoveMemberFromConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oSubConfMS</parameter>
          </function>
          <results >
            <result name="Default" link="96" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: CONF HOLD PARTY REQUEST, REMOVE MEMBER FROM SUB CONFERENCE.");]]></script>
          </scripts>
        </action>
        <action id="34" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1864 y=1319 ?>
          <!--Remove member from conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;RemoveMemberFromConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
          </function>
          <results >
            <result name="Default" link="96" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: CONF HOLD PARTY REQUEST, REMOVE MEMBER FROM TEMP CONFERENCE SIDEBAR TALKING WITH CSR");]]></script>
          </scripts>
        </action>
        <action id="35" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=873 y=751 ?>
          <!--"setDTMFOff"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;setDTMFOff&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="25" stubbed="0"/>
          </results>
        </action>
        <action id="36" plug-in="Pactolus.Branch.1" ><?xtml-editor x=583 y=463 ?>
          <results >
            <result name="Default" link="25" stubbed="0"/>
            <result name="currently in main menu" link="2" stubbed="1" >g_bCurrentlyInMMenu == true</result>
            <result name="currently hold" link="2" stubbed="1" >g_bHoldState == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Session.g_bCurrentlyInMMenu)
{
	Session.g_strReturnMsg = "FAILURE TO CHANGE AUDIO MODE, PARTY IS CURRENTLY IN MAIN MENU.";
}
else if (Session.g_bMutedState)
{
	Session.g_strReturnMsg = "FAILURE TO CHANGE AUDIO MODE, PARTY IS ALREADY ON HOLD";
}
else
{
	Session.g_strReturnMsg = "";
}
Server.logInfo("EXIT BRANCH NAME : " + Result.name + "  BRANCH ID " + Result.id);]]></script>
          </scripts>
        </action>
        <action id="37" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=2317 y=1067 ?>
          <!--"ConfAudioModeChangeResponse"-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strConferenceControllerIP" transaction="strTransactionId" message-name="&quot;ConfAudioModeChangeResponse&quot;" destination-port="nConferenceControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="s_nSuccess"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
          </SOAP>
          <results >
            <result name="Default" link="3" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "SUCCESSFUL HOLD A PARTY";]]></script>
          </scripts>
        </action>
        <action id="38" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1340 y=735 ?>
          <!--in sub conf?-->
          <results >
            <result name="Default" link="19" stubbed="0"/>
            <result name="g_bCurrentlyInSubConf" link="95" stubbed="0" >g_bCurrentlyInSubConf == true</result>
            <result name="g_bTalkingToCSR" link="94" stubbed="0" >g_bTalkingWithCSR == true
AND g_bSideBarOperatorRequest == true</result>
          </results>
        </action>
        <action id="39" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1869 y=930 ?>
          <!--"ChangeToDataMode"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ChangeToDataMode&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
          </function>
          <results >
            <result name="Default" link="2" stubbed="1"/>
            <result name="SUCCESS" link="40" stubbed="0" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_oTempConf.bMuteFlag = true;
Session.g_oTempConf.bDeafFlag = true;]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (1 == Result.id)
{
	Session.g_strReturnMsg = "FAILURE TO CHANGE AUDIO MODE, ModifyConferenceMember returns failure.";
}
else
{
	Session.g_strReturnMsg = "";
}]]></script>
          </scripts>
        </action>
        <action id="40" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2112 y=921 ?>
          <!--please hold-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oTempConf.strConnectionId" endpoint="g_oTempConf.strEndPoint" callid="g_oTempConf.strCallId" repeat="1" timeout="10" ms-type="g_oTempConf.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >898</audio>
          </play>
          <results >
            <result name="Default" link="26" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="41" plug-in="Pactolus.Branch.1" ><?xtml-editor x=549 y=1232 ?>
          <results >
            <result name="Default" link="43" stubbed="1"/>
            <result name="currently muted" link="43" stubbed="0" >g_bMutedState == true</result>
            <result name="currently hold" link="87" stubbed="1" >g_bHoldState == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[Server.logInfo("EXIT BRANCH NAME : " + Result.name + "  BRANCH ID " + Result.id);]]></script>
          </scripts>
        </action>
        <action id="42" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1049 y=1233 ?>
          <!--"ChangeToConferenceMode"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ChangeToConferenceMode&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="2" stubbed="1"/>
            <result name="SUCCESS" link="49" stubbed="1" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_oMS.bMuteFlag = false;]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (1 == Result.id)
{
	Session.g_strReturnMsg = "FAILURE TO CHANGE AUDIO MODE, ChangeToConferenceMode returns failure.";
}
else
{
	Session.g_strReturnMsg = "";
}]]></script>
          </scripts>
        </action>
        <action id="43" plug-in="Pactolus.Branch.1" ><?xtml-editor x=798 y=1234 ?>
          <!--in sub conf?-->
          <results >
            <result name="Default" link="42" stubbed="0"/>
            <result name="g_bCurrentlyInSubConf" link="44" stubbed="0" >g_bCurrentlyInSubConf == true</result>
            <result name="g_bTalkingToCSR" link="47" stubbed="0" >g_bTalkingWithCSR == true
AND g_bSideBarOperatorRequest == true</result>
          </results>
        </action>
        <action id="44" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1065 y=1353 ?>
          <!--"ChangeToConferenceMode"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ChangeToConferenceMode&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oSubConfMS</parameter>
          </function>
          <results >
            <result name="Default" link="2" stubbed="1"/>
            <result name="SUCCESS" link="49" stubbed="1" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_oSubConfMS.bMuteFlag = false;]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (1 == Result.id)
{
	Session.g_strReturnMsg = "FAILURE TO CHANGE AUDIO MODE, ChangeToConferenceMode returns failure.";
}
else
{
	Session.g_strReturnMsg = "";
}]]></script>
          </scripts>
        </action>
        <action id="47" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1069 y=1474 ?>
          <!--"ChangeToConferenceMode"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ChangeToConferenceMode&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
          </function>
          <results >
            <result name="Default" link="2" stubbed="1"/>
            <result name="SUCCESS" link="49" stubbed="1" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_oTempConf.bMuteFlag = false;]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (1 == Result.id)
{
	Session.g_strReturnMsg = "FAILURE TO CHANGE AUDIO MODE, ChangeToConferenceMode returns failure.";
}
else
{
	Session.g_strReturnMsg = "";
}]]></script>
          </scripts>
        </action>
        <action id="49" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1534 y=1223 ?>
          <!--"ConfAudioModeChangeResponse"-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strConferenceControllerIP" transaction="strTransactionId" message-name="&quot;ConfAudioModeChangeResponse&quot;" destination-port="nConferenceControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="s_nSuccess"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
          </SOAP>
          <results >
            <result name="Default" link="15" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "SUCCESSFUL UNMUTE A PARTY";]]></script>
          </scripts>
        </action>
        <action id="53" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1057 y=1598 ?>
          <!--"ChangeToConferenceMode"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ChangeToConferenceMode&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="2" stubbed="1"/>
            <result name="SUCCESS" link="85" stubbed="0" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (1 == Result.id)
{
	Session.g_strReturnMsg = "FAILURE TO CHANGE AUDIO MODE, ModifyConferenceMember returns failure.";
}
else
{
	Session.g_strReturnMsg = "";
}]]></script>
          </scripts>
        </action>
        <action id="56" plug-in="Pactolus.Branch.1" ><?xtml-editor x=617 y=1608 ?>
          <!--MOH?-->
          <results >
            <result name="Default" link="98" stubbed="0"/>
            <result name="g_strMusicOnHoldFlag==&quot;T&quot;" link="57" stubbed="0" >g_strMusicOnHoldFlag match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bDontPlayContinueToHold = true;
Server.logInfo("CURRENTLY ON HOLD");

if (Session.g_bCurrentlyInSubConf)
{
	if (2 == Session.nToMode)
	{
		Server.logInfo("CHANGE TO MUTE MODE IN SUB CONF");
		Session.g_oSubConfMS.bMuteFlag = true;
		Session.g_oSubConfMS.bDeafFlag = false;
	}
	else
	{
		Server.logInfo("CHANGE TO SPEAK MODE IN SUB CONF");
		Session.g_oSubConfMS.bMuteFlag = false;
		Session.g_oSubConfMS.bDeafFlag = false;
	}
}
else if (Session.g_bTalkingWithCSR && Session.g_bSideBarOperatorRequest)
{
	if (2 == Session.nToMode)
	{
		Server.logInfo("CHANGE TO MUTE MODE IN TEMP CONF");
		Session.g_oTempConf.bMuteFlag = true;
		Session.g_oTempConf.bDeafFlag = false;
	}
	else
	{
		Server.logInfo("CHANGE TO SPEAK MODE IN TEMP CONF");
		Session.g_oTempConf.bMuteFlag = false;
		Session.g_oTempConf.bDeafFlag = false;
	}
}
else
{
	if (2 == Session.nToMode)
	{
		Server.logInfo("CHANGE TO MUTE MODE IN MAIN CONF");
		Session.g_oMS.bMuteFlag = true;
		Session.g_oMS.bDeafFlag = false;
	}
	else
	{
		Server.logInfo("CHANGE TO SPEAK MODE IN MAIN CONF");
		Session.g_oMS.bMuteFlag = false;
		Session.g_oMS.bDeafFlag = false;
	}
}]]></script>
          </scripts>
        </action>
        <action id="57" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=836 y=2072 ?>
          <!--"DisconnectFromMOH"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DisconnectFromMOH&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="58" stubbed="0"/>
          </results>
        </action>
        <action id="58" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1046 y=2068 ?>
          <!--Dial In?-->
          <results >
            <result name="Default" link="70" stubbed="0"/>
            <result name="g_strOutdialFlag = &quot;T&quot;;" link="71" stubbed="0" >g_strOutdialFlag match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("CURRENTLY IN MUSIC ON HOLD");
if (Session.g_bCurrentlyInSubConf)
{
	if (2 == Session.nToMode)
	{
		Server.logInfo("CHANGE TO MUTE MODE IN SUB CONF");
		Session.g_oSubConfMS.bMuteFlag = true;
		Session.g_oSubConfMS.bDeafFlag = false;
	}
	else
	{
		Server.logInfo("CHANGE TO SPEAK MODE IN SUB CONF");
		Session.g_oSubConfMS.bMuteFlag = false;
		Session.g_oSubConfMS.bDeafFlag = false;
	}
}
else if (Session.g_bTalkingWithCSR && Session.g_bSideBarOperatorRequest)
{
	if (2 == Session.nToMode)
	{
		Server.logInfo("CHANGE TO MUTE MODE IN TEMP CONF");
		Session.g_oTempConf.bMuteFlag = true;
		Session.g_oTempConf.bDeafFlag = false;
	}
	else
	{
		Server.logInfo("CHANGE TO SPEAK MODE IN TEMP CONF");
		Session.g_oTempConf.bMuteFlag = false;
		Session.g_oTempConf.bDeafFlag = false;
	}
}
else
{
	if (2 == Session.nToMode)
	{
		Server.logInfo("CHANGE TO MUTE MODE IN MAIN CONF");
		Session.g_oMS.bMuteFlag = true;
		Session.g_oMS.bDeafFlag = false;
	}
	else
	{
		Server.logInfo("CHANGE TO SPEAK MODE IN MAIN CONF");
		Session.g_oMS.bMuteFlag = false;
		Session.g_oMS.bDeafFlag = false;
	}
}]]></script>
          </scripts>
        </action>
        <action id="59" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1566 y=2002 ?>
          <!--AddMemberToConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
            <parameter >g_oCallLegA</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="80" stubbed="0"/>
            <result name="FAILURE" link="88" stubbed="1" >f_nReturnCode == s_nFailure</result>
            <result name="CALLERHUNGUP" link="62" stubbed="0" >f_nReturnCode == s_nCallerHungup</result>
          </results>
        </action>
        <action id="60" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1584 y=2418 ?>
          <!--AddMemberToConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
            <parameter >g_oCallLegB</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="80" stubbed="1"/>
            <result name="FAILURE" link="88" stubbed="1" >f_nReturnCode == s_nFailure</result>
            <result name="CALLERHUNGUP" link="62" stubbed="0" >f_nReturnCode == s_nCallerHungup</result>
          </results>
        </action>
        <action id="61" plug-in="Standard.EndSession.1" ><?xtml-editor x=2339 y=2118 ?></action>
        <action id="62" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1864 y=2411 ?>
          <!--"PartyLeave"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;PartyLeave&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="61" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nConfLeaveReason = 0;
Session.g_strConfLeaveMsg = "PARTY HANGUP WHILE TRYING TO ADD MEMBER TO CONFERENCE";]]></script>
          </scripts>
        </action>
        <action id="63" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2098 y=2119 ?>
          <!--HangUp Caller-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpCaller&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="61" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 35;
Session.g_nConfLeaveReason = 9;
Session.g_strConfLeaveMsg = "FAIL TO ADD PARTY TO CONFERENCE";]]></script>
          </scripts>
        </action>
        <action id="65" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1513 y=1593 ?>
          <!--"SetDTMFOn"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;SetDTMFOn&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="76" stubbed="0"/>
          </results>
        </action>
        <action id="68" plug-in="Pactolus.Branch.1" ><?xtml-editor x=822 y=1603 ?>
          <!--in sub conf?-->
          <results >
            <result name="Default" link="57" stubbed="1"/>
            <result name="g_bCurrentlyInSubConf" link="69" stubbed="0" >g_bCurrentlyInSubConf == true</result>
            <result name="g_bTalkingToCSR" link="84" stubbed="0" >g_bTalkingWithCSR == true
AND g_bSideBarOperatorRequest == true</result>
            <result name="bCurrentlyInConf" link="53" stubbed="0" >g_oMS.bCurrentlyInConf == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[Server.logInfo("EXIT BRANCH NAME : " + Result.name + "  BRANCH ID " + Result.id);]]></script>
          </scripts>
        </action>
        <action id="69" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1073 y=1729 ?>
          <!--"ChangeToConferenceMode"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ChangeToConferenceMode&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oSubConfMS</parameter>
          </function>
          <results >
            <result name="Default" link="2" stubbed="1"/>
            <result name="SUCCESS" link="86" stubbed="0" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (1 == Result.id)
{
	Session.g_strReturnMsg = "FAILURE TO CHANGE AUDIO MODE, ModifyConferenceMember returns failure.";
}]]></script>
          </scripts>
        </action>
        <action id="70" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1281 y=1999 ?>
          <!--in sub conf?-->
          <results >
            <result name="Default" link="59" stubbed="0"/>
            <result name="g_bCurrentlyInSubConf" link="72" stubbed="0" >g_bCurrentlyInSubConf == true</result>
            <result name="g_bTalkingToCSR" link="81" stubbed="0" >g_bSideBarOperatorRequest == true
AND g_bTalkingWithCSR == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[Server.logInfo("EXIT BRANCH NAME : " + Result.name + "  BRANCH ID " + Result.id);]]></script>
          </scripts>
        </action>
        <action id="71" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1299 y=2464 ?>
          <!--in sub conf?-->
          <results >
            <result name="Default" link="60" stubbed="0"/>
            <result name="g_bCurrentlyInSubConf" link="73" stubbed="0" >g_bCurrentlyInSubConf == true</result>
            <result name="g_bTalkingToCSR" link="82" stubbed="0" >g_bSideBarOperatorRequest == true
AND g_bTalkingWithCSR == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[Server.logInfo("EXIT BRANCH NAME : " + Result.name + "  BRANCH ID " + Result.id);]]></script>
          </scripts>
        </action>
        <action id="72" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1578 y=2128 ?>
          <!--AddMemberToConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oSubConfMS</parameter>
            <parameter >g_oCallLegA</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="37" stubbed="1"/>
            <result name="FAILURE" link="88" stubbed="1" >f_nReturnCode == s_nFailure</result>
            <result name="CALLERHUNGUP" link="62" stubbed="1" >f_nReturnCode == s_nCallerHungup</result>
          </results>
        </action>
        <action id="73" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1603 y=2573 ?>
          <!--AddMemberToConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oSubConfMS</parameter>
            <parameter >g_oCallLegB</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="37" stubbed="1"/>
            <result name="FAILURE" link="88" stubbed="1" >f_nReturnCode == s_nFailure</result>
            <result name="CALLERHUNGUP" link="62" stubbed="1" >f_nReturnCode == s_nCallerHungup</result>
          </results>
        </action>
        <action id="74" plug-in="Standard.Timer.1" ><?xtml-editor x=2436 y=1556 ?>
          <!--ck reInvite timer-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lCkReInviteTimerIdA" duration="g_nCkReInviteTime"/>
          <results >
            <result name="Default" link="3" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bCkReInviteTimerFlagA = true;
Server.logInfo("SET TIMER TO CHECK FOR REINVITE A LEG");]]></script>
          </scripts>
        </action>
        <action id="75" plug-in="Standard.Timer.1" ><?xtml-editor x=2461 y=1675 ?>
          <!--ck reInvite timer B-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lCkReInviteTimerIdB" duration="g_nCkReInviteTime"/>
          <results >
            <result name="Default" link="3" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bCkReInviteTimerFlagB = true;
Server.logInfo("SET TIMER TO CHECK FOR REINVITE B LEG");]]></script>
          </scripts>
        </action>
        <action id="76" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1736 y=1598 ?>
          <results >
            <result name="Default" link="3" stubbed="1"/>
            <result name="Time &gt; 0" link="77" stubbed="0" >g_nCkReInviteTime &gt; 0</result>
          </results>
        </action>
        <action id="77" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1972 y=1592 ?>
          <!--Dial In?-->
          <results >
            <result name="Default" link="78" stubbed="0"/>
            <result name="g_strOutdialFlag = &quot;T&quot;" link="79" stubbed="0" >g_strOutdialFlag match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("ConfOffHoldPartyRequest, RESET TIMER TO CHECK FOR REINVITE");]]></script>
          </scripts>
        </action>
        <action id="78" plug-in="Standard.Timer.1" ><?xtml-editor x=2207 y=1556 ?>
          <!--stop ck reInvite timer-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="0" id="g_lCkReInviteTimerIdA" duration=""/>
          <results >
            <result name="Default" link="74" stubbed="0"/>
          </results>
        </action>
        <action id="79" plug-in="Standard.Timer.1" ><?xtml-editor x=2228 y=1676 ?>
          <!--stop ck reInvite timer B-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="0" id="g_lCkReInviteTimerIdB" duration=""/>
          <results >
            <result name="Default" link="75" stubbed="0"/>
          </results>
        </action>
        <action id="80" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1773 y=1996 ?>
          <!--ConfMSConnectionIDChangedNotify-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ConfMSConnectionIDChangedNotify&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="85" stubbed="1"/>
          </results>
        </action>
        <action id="81" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1583 y=2261 ?>
          <!--AddMemberToConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
            <parameter >g_oCallLegA</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="37" stubbed="1"/>
            <result name="FAILURE" link="88" stubbed="1" >f_nReturnCode == s_nFailure</result>
            <result name="CALLERHUNGUP" link="62" stubbed="1" >f_nReturnCode == s_nCallerHungup</result>
          </results>
        </action>
        <action id="82" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1607 y=2699 ?>
          <!--AddMemberToConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
            <parameter >g_oCallLegB</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="37" stubbed="1"/>
            <result name="FAILURE" link="88" stubbed="1" >f_nReturnCode == s_nFailure</result>
            <result name="CALLERHUNGUP" link="62" stubbed="1" >f_nReturnCode == s_nCallerHungup</result>
          </results>
        </action>
        <action id="84" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1051 y=1866 ?>
          <!--"ChangeToConferenceMode"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ChangeToConferenceMode&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
          </function>
          <results >
            <result name="Default" link="2" stubbed="1"/>
            <result name="SUCCESS" link="86" stubbed="1" >f_nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (1 == Result.id)
{
	Session.g_strReturnMsg = "FAILURE TO CHANGE AUDIO MODE, ModifyConferenceMember returns failure.";
}
else
{
	Session.g_strReturnMsg = "";
}]]></script>
          </scripts>
        </action>
        <action id="85" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1304 y=1591 ?>
          <!--"ConfAudioModeChangeResponse"-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strConferenceControllerIP" transaction="strTransactionId" message-name="&quot;ConfAudioModeChangeResponse&quot;" destination-port="nConferenceControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="s_nSuccess"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
          </SOAP>
          <results >
            <result name="Default" link="65" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (0 == Session.nToMode)
{
	Session.g_strReturnMsg = "SUCCESSFUL CHANGE TO SPEAK MODE";
}
else
{
	Session.g_strReturnMsg = "SUCCESSFUL CHANGE TO MUTE MODE";
}]]></script>
          </scripts>
        </action>
        <action id="86" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1300 y=1721 ?>
          <!--"ConfAudioModeChangeResponse"-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strConferenceControllerIP" transaction="strTransactionId" message-name="&quot;ConfAudioModeChangeResponse&quot;" destination-port="nConferenceControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="s_nSuccess"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
          </SOAP>
          <results >
            <result name="Default" link="3" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (0 == Session.nToMode)
{
	Session.g_strReturnMsg = "SUCCESSFUL CHANGE TO SPEAK MODE";
}
else
{
	Session.g_strReturnMsg = "SUCCESSFUL CHANGE TO MUTE MODE";
}]]></script>
          </scripts>
        </action>
        <action id="87" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=365 y=1622 ?>
          <!--"StopTimer"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;StopTimer&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="56" stubbed="0"/>
          </results>
        </action>
        <action id="88" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1880 y=2122 ?>
          <!--"ConfAudioModeChangeResponse"
FAILURE-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strConferenceControllerIP" transaction="strTransactionId" message-name="&quot;ConfAudioModeChangeResponse&quot;" destination-port="nConferenceControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;Status&quot;" value="s_nFailure"/>
            <parameter tag="&quot;StatusMessage&quot;" value="g_strReturnMsg"/>
          </SOAP>
          <results >
            <result name="Default" link="63" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "FAILURE TO CHANGE AUDIO MODE, CAN'T ADD MEMBER TO CONFERENCE";]]></script>
          </scripts>
        </action>
        <action id="89" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=841 y=191 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="93" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=282 y=104 ?>
          <!--"ConfAudioModeChangeResponse"-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strConferenceControllerIP" transaction="strTransactionId" message-name="&quot;ConfAudioModeChangeResponse&quot;" destination-port="nConferenceControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="s_nSuccess"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
          </SOAP>
          <results >
            <result name="Default" link="3" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: NO NEED TO NOTIFY MS");
if (0 == Session.nToMode)
{
	Session.g_strReturnMsg = "SUCCESSFUL UNMUTE PARTY";
}
else if (2 == Session.nToMode)
{
	Session.g_strReturnMsg = "SUCCESSFUL MUTE PARTY";
}
else
{
	Session.g_strReturnMsg = "SUCCESSFUL HOLD PARTY";
}]]></script>
          </scripts>
        </action>
        <action id="94" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1641 y=934 ?>
          <!--"setDTMFOff"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;setDTMFOff&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="39" stubbed="0"/>
          </results>
        </action>
        <action id="95" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1652 y=798 ?>
          <!--"setDTMFOff"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;setDTMFOff&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="30" stubbed="0"/>
          </results>
        </action>
        <action id="96" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2100 y=1172 ?>
          <!--"setDTMFOff"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;setDTMFOff&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="22" stubbed="1"/>
          </results>
        </action>
        <action id="97" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2343 y=640 ?>
          <!--set DTMF Detection ON-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;SetDTMFOn&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="37" stubbed="1"/>
          </results>
        </action>
        <action id="98" plug-in="Pactolus.Branch.1" ><?xtml-editor x=767 y=1477 ?>
          <!--speak?-->
          <results >
            <result name="Default" link="5" stubbed="1"/>
            <result name="Speak" link="68" stubbed="1" >nToMode == 0</result>
          </results>
        </action>
      </actions>
      <text-objects >
        <text-object x-coord="106" y-coord="30" width="259" height="94" text="nToMode:
0 - Speak (off hold, unmute)
2 - Mute
1 - Hold" font-name="Times New Roman" size="-16" red="0" green="0" blue="0" weight="0" underline="0" strikeout="0" point-size="12" italic="0"/>
      </text-objects>
    </function>
    <function name="OnConfPlayDTMFRequest" start="9" event="ConfPlayDTMFRequest" returns="void" >
      <parameters >
        <parameter name="strConfControllerIP" type="string" pass="byref"/>
        <parameter name="nConfControllerPort" type="i4" pass="byref"/>
        <parameter name="strTransactionId" type="string" pass="byref"/>
        <parameter name="strDTMF" type="string" pass="byref"/>
        <parameter name="nToneDuration" type="i4" pass="byref"/>
        <parameter name="nToneAttenuation" type="i4" pass="byref"/>
        <parameter name="nToneDelay" type="i4" pass="byref"/>
      </parameters>
      <local-vars >
        <var name="nReturnCode" type="i4" >-1</var>
        <var name="strSignal" type="string" ></var>
        <var name="strEvent" type="string" ></var>
        <var name="nFailReason" type="i2" >0</var>
        <var name="strEventReceived" type="string" ></var>
      </local-vars>
      <actions >
        <action id="9" plug-in="Pactolus.Branch.1" ><?xtml-editor x=115 y=556 ?>
          <!--private talk?-->
          <results >
            <result name="Default" link="5" stubbed="0"/>
            <result name="g_strPrivateTalk == &quot;T&quot;" link="10" stubbed="0" >g_strPrivateTalkFlag match "T"

OR g_strPrivateTalkFlag match "t"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_disable_event();
Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: OnConfPlayDTMFRequest");
Server.logInfo("INFO: DTMF: " + Session.strDTMF);
Server.logInfo("INFO: nToneAttenuation: " + Session.nToneAttenuation);
Server.logInfo("INFO: nToneDelay: " + Session.nToneDelay);
Server.logInfo("INFO: nToneDuration: " + Session.nToneDuration);]]></script>
          </scripts>
        </action>
        <action id="1" plug-in="Pactolus.PSDtmfPlay.1" ><?xtml-editor x=76 y=205 ?>
          <dtmf-play xmlns="urn:www.pactolus.com:xtml:media" start-play="1" endpoint="g_oMS.strEndPoint" connection-id="g_oMS.strConnectionId" callid="g_oMS.strCallId" return-immediate="0" repeat="1" returns="nReturnCode" timeout="s_nTimeout" ms-type="g_oMS.strType" dg="strDTMF" di="nToneDelay" dl="nToneDuration" da="nToneAttenuation"/>
          <results >
            <result name="Default" link="4" stubbed="0"/>
            <result name="Success" link="2" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: OnConfPlayDTMFRequest");
Server.logInfo("INFO: DTMF: " + Session.strDTMF);
Server.logInfo("INFO: nToneAttenuation: " + Session.nToneAttenuation);
Server.logInfo("INFO: nToneDelay: " + Session.nToneDelay);
Server.logInfo("INFO: nToneDuration: " + Session.nToneDuration);
Session.strSignal = "A/pd@" + Session.g_oMS.strConnectionId + "(dg='" + Session.strDTMF + " dl=" + Session.nToneDuration + " di=" + Session.nToneDelay + " da=" + Session.nToneAttenuation + ")";]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=339 y=287 ?>
          <!--response SUCCESS-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strConfControllerIP" transaction="strTransactionId" message-name="&quot;ConfPlayDTMFResponse&quot;" destination-port="nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="s_nSuccess"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
          </SOAP>
          <results >
            <result name="Default" link="6" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "SUCCESSFUL PLAY DTMF";]]></script>
          </scripts>
        </action>
        <action id="3" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=537 y=167 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="4" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=322 y=167 ?>
          <!--response FAILURE-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strConfControllerIP" transaction="strTransactionId" message-name="&quot;ConfPlayDTMFResponse&quot;" destination-port="nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="s_nFailure"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
          </SOAP>
          <results >
            <result name="Default" link="3" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "FAIL TO PLAY DTMF";]]></script>
          </scripts>
        </action>
        <action id="5" plug-in="Pactolus.MGCPNotifyRequest.1" ><?xtml-editor x=364 y=452 ?>
          <rqnt xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" timeout="s_nTimeout" returns="nReturnCode" ms-type="g_oMS.strType" >
            <parameters >
              <quarantine step="0" loop="0" process="0" discard="0"/>
              <events ><![CDATA[strEvent]]></events>
              <signals ><![CDATA[strSignal]]></signals>
              <digit-map ><![CDATA[]]></digit-map>
            </parameters>
          </rqnt>
          <results >
            <result name="Default" link="4" stubbed="1"/>
            <result name="Success" link="7" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.strEvent = "A/oc@" + Session.g_oMS.strConnectionId + ",A/of@" + Session.g_oMS.strConnectionId;
if (Session.nToneAttenuation < 0 || Session.nToneAttenuation > 96)
	Session.nToneAttenuation = 10;
if (Session.nToneDelay < 50 || Session.nToneDelay > 30000)
	Session.nToneDelay = 100;
if (Session.nToneDuration < 50 || Session.nToneDuration > 30000)
	Session.nToneDuration = 100;
Session.strSignal = "A/pd@" + Session.g_oMS.strConnectionId + "(dg='" + Session.strDTMF + "' dl=" + Session.nToneDuration + " di=" + Session.nToneDelay + " da=" + Session.nToneAttenuation + ")";]]></script>
          </scripts>
        </action>
        <action id="6" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=574 y=278 ?>
          <!--"SetDTMFOn"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;SetDTMFOn&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="3" stubbed="1"/>
          </results>
        </action>
        <action id="7" plug-in="Standard.WaitEvent.1" ><?xtml-editor x=607 y=449 ?>
          <wait xmlns="urn:www.pactolus.com:xtml:communication" timeout="s_nTimeout" recv-name="strEventReceived" >
            <msg name="Pactolus.MGCPPlayDone.1" >
              <parameter ></parameter>
              <parameter ></parameter>
              <parameter ></parameter>
              <parameter ></parameter>
              <parameter ></parameter>
            </msg>
            <msg name="Pactolus.MGCPPlayFail.1" >
              <parameter ></parameter>
              <parameter ></parameter>
              <parameter >nFailReason</parameter>
            </msg>
          </wait>
          <results >
            <result name="Default" link="4" stubbed="1"/>
            <result name="Success" link="8" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)
{
	Server.logError("FAIL TO PLAY DTMF");
}]]></script>
          </scripts>
        </action>
        <action id="8" plug-in="Pactolus.Branch.1" ><?xtml-editor x=840 y=447 ?>
          <results >
            <result name="Default" link="4" stubbed="1"/>
            <result name="playDone" link="2" stubbed="1" >strEventReceived match "PlayDone"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("EVENT RECEIVED: " + Session.strEventReceived);]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)
{
	Server.logError("FAIL TO PLAY DTMF, FAIL REASON: " + Session.nFailReason);
}]]></script>
          </scripts>
        </action>
        <action id="10" plug-in="Pactolus.MGCPNotifyRequest.1" ><?xtml-editor x=377 y=667 ?>
          <rqnt xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oTempConf.strConnectionId" endpoint="g_oTempConf.strEndPoint" callid="g_oTempConf.strCallId" timeout="s_nTimeout" returns="nReturnCode" ms-type="g_oTempConf.strType" >
            <parameters >
              <quarantine step="0" loop="0" process="0" discard="0"/>
              <events ><![CDATA[strEvent]]></events>
              <signals ><![CDATA[strSignal]]></signals>
              <digit-map ><![CDATA[]]></digit-map>
            </parameters>
          </rqnt>
          <results >
            <result name="Default" link="4" stubbed="1"/>
            <result name="Success" link="7" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.strEvent = "A/oc@" + Session.g_oTempConf.strConnectionId + ",A/of@" + Session.g_oTempConf.strConnectionId;
if (Session.nToneAttenuation < 0 || Session.nToneAttenuation > 96)
	Session.nToneAttenuation = 10;
if (Session.nToneDelay < 50 || Session.nToneDelay > 30000)
	Session.nToneDelay = 100;
if (Session.nToneDuration < 50 || Session.nToneDuration > 30000)
	Session.nToneDuration = 100;
Session.strSignal = "A/pd@" + Session.g_oTempConf.strConnectionId + "(dg='" + Session.strDTMF + "' dl=" + Session.nToneDuration + " di=" + Session.nToneDelay + " da=" + Session.nToneAttenuation + ")";]]></script>
          </scripts>
        </action>
      </actions>
    </function>
    <function name="OnConfTransferPartyRequest" start="25" event="ConfTransferPartyRequest" returns="void" >
      <parameters >
        <parameter name="strConfControllerIP" type="string" pass="byref"/>
        <parameter name="nConfControllerPort" type="i4" pass="byref"/>
        <parameter name="strTransactionId" type="string" pass="byref"/>
        <parameter name="strPasscode" type="string" pass="byref"/>
        <parameter name="strAccessNumber" type="string" pass="byref"/>
        <parameter name="nAudioMode" type="i4" pass="byref"/>
        <parameter name="nConfStatus" type="i4" pass="byref"/>
        <parameter name="lFromPartyScheduleId" type="i8" pass="byref"/>
        <parameter name="strSubConferenceId" type="string" pass="byref"/>
      </parameters>
      <local-vars >
        <var name="nReturnCode" type="i4" >-1</var>
        <var name="nNextState" type="i4" >0</var>
        <var name="strReturnMsg" type="string" >WILL TRY TO TRANSFER PARTY TO ANOTHER CONFERENCE</var>
      </local-vars>
      <actions >
        <action id="25" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=28 y=81 ?>
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strConfControllerIP" transaction="strTransactionId" message-name="&quot;ConfTransferPartyResponse&quot;" destination-port="nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;ResultCode&quot;" value="s_nSuccess"/>
            <parameter tag="&quot;ResultMessage&quot;" value="strReturnMsg"/>
          </SOAP>
          <results >
            <result name="Default" link="6" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_disable_event();
Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: OnConfTransferPartyRequest");
Server.logInfo("Transfer to conference with passcode: " + Session.strPasscode);
Server.logInfo("Transfer to conference with access number: " + Session.strAccessNumber);
Server.logInfo("Transfer to conference with sub conference Id: " + Session.strSubConferenceId);
Server.logInfo("Transfer to conference with default audio mode: " + Session.nAudioMode);
Server.logInfo("Transfer to conference with conf status: " + Session.nConfStatus);
Server.logInfo("Transfer to conference with party schedule id: " + Session.lFromPartyScheduleId);]]></script>
          </scripts>
        </action>
        <action id="6" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=245 y=81 ?>
          <!--Send party leave-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;PartyLeave&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="7" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nConfLeaveReason = 5;
Session.g_strConfLeaveMsg = "PARTY TRANSFER TO ANOTHER CONFERENCE";
Session.g_bSendLeaveWithTransfer = true;]]></script>
          </scripts>
        </action>
        <action id="7" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=462 y=80 ?>
          <!--stop timer if needed-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;StopTimer&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="18" stubbed="0"/>
          </results>
        </action>
        <action id="9" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=905 y=75 ?>
          <!--ConfCallLegCompletion-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceConfCallLegCompletion&quot;" return="nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="14" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strTransferInOutFlag = "O";]]></script>
          </scripts>
        </action>
        <action id="10" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=485 y=264 ?>
          <!--DeleteMSConnection-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DeleteMSConnection&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="17" stubbed="0"/>
          </results>
        </action>
        <action id="11" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=32 y=266 ?>
          <!--Remove member from temp conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;RemoveMemberFromConference&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
          </function>
          <results >
            <result name="Default" link="16" stubbed="0"/>
          </results>
        </action>
        <action id="12" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=495 y=350 ?>
          <!--delete temp conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DeleteConference&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
          </function>
          <results >
            <result name="Default" link="10" stubbed="1"/>
          </results>
        </action>
        <action id="13" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1392 y=67 ?>
          <!--delete conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DeleteConference&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="22" stubbed="0"/>
          </results>
        </action>
        <action id="14" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1138 y=72 ?>
          <!--last caller?-->
          <results >
            <result name="Default" link="11" stubbed="1"/>
            <result name="nReturnCode==1" link="13" stubbed="0" >nReturnCode == 1</result>
            <result name="g_bConnectToMOH==true" link="26" stubbed="0" >g_bConnectToMOH == true</result>
          </results>
        </action>
        <action id="15" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1644 y=206 ?>
          <!--"SendDisconnectToMOH"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;SendDisconnectToMOH&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="11" stubbed="1"/>
          </results>
        </action>
        <action id="16" plug-in="Pactolus.Branch.1" ><?xtml-editor x=275 y=266 ?>
          <!--you created temp conf?-->
          <results >
            <result name="Default" link="10" stubbed="0"/>
            <result name="g_bCreatedTempConf==true" link="12" stubbed="0" >g_bCreatedTempConf == true</result>
          </results>
        </action>
        <action id="17" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=716 y=259 ?>
          <!--DeleteMOHMSConnection-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DeleteMSConnection&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMOH_MS</parameter>
          </function>
          <results >
            <result name="Default" link="23" stubbed="0"/>
          </results>
        </action>
        <action id="18" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=672 y=79 ?>
          <!--Remove member from conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;RemoveMemberFromConference&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="9" stubbed="0"/>
          </results>
        </action>
        <action id="22" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1623 y=60 ?>
          <!--connectToMOH?-->
          <results >
            <result name="Default" link="11" stubbed="1"/>
            <result name="g_bConnectToMOH==true" link="26" stubbed="1" >g_bConnectToMOH == true</result>
          </results>
        </action>
        <action id="23" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=943 y=260 ?>
          <!--Goto MAIN-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;Main&quot;" return="" external-function="0" library="" >
            <parameter >nNextState</parameter>
          </function>
          <results >
            <result name="Default" link="24" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("g_strSubConferenceId IS: " + Session.g_strSubConferenceId);
Server.logInfo("strSubConferenceId IS: " + Session.strSubConferenceId);
Server.logInfo("strSubConferenceId.length IS: " + Session.strSubConferenceId.length);
Session.g_strSubConferenceId = Session.strSubConferenceId;

if (Session.strSubConferenceId.length > 0)
{
	Server.logInfo("strSubConferenceId.length IS GREATER THAN ZERO");
	Session.g_bMoveDirectlyInSubConf = true;
}
else
{
	Server.logInfo("strSubConferenceId.length IS LESS THAN ZERO");
	Session.g_bMoveDirectlyInSubConf = false;
}
Server.logInfo("MOVE DIRECTLY TO SUB CONF FLAG IS: " + Session.g_bMoveDirectlyInSubConf);
Session.g_bSendLeaveWithTransfer = false;
Session.g_nReleaseDefaultAudioMode = Session.nAudioMode;
Session.g_nReleaseToConfStatus = Session.nConfStatus;
Session.g_strAccessNumber = Session.strAccessNumber;
Session.g_strPassCode = Session.strPasscode;
Session.g_strTransferToPasscode = Session.strPasscode;
Session.g_lTransferFromPartySchedId = Session.lFromPartyScheduleId;
Session.nNextState = Session.s_nStateInitializeConf;
Session.g_bTransferParty = true;
Session.g_strTransferInOutFlag = "I";
//Clear out variables
// Session.g_lStartTime = 0;
// Session.g_lMSConnectTime = 0;
Session.g_bAllowSelfMuteUnmuteFlag = false;
Session.g_bDtmfCollectionOnHold = false;
Session.g_bCurrentlyInSubConf = false;
Session.g_strQuickStartFlag = "";
Session.g_strAnonymousAttendeeId = ""
Session.g_nTerminationReason = 0;
Session.g_lEndTime = 0;
Session.g_strConfEventId = "";
Session.g_strCallLegId = "";
Session.g_strModeratorFlag = "";
Session.g_strSPTimeZone = "";
Session.g_nAccessNumberId = 0;
Session.g_strPartyScheduleId = "";
Session.g_strConfScheduleId = "";
Session.g_lPartySchedId = 0;
Session.g_strPartyDetail = "";
Session.g_lServiceProviderId = 0;
Session.g_strOrigDomIntlFlag = "";
Session.g_strDestDomIntlFlag = "";
Session.g_nOrigCountryId = 0;
Session.g_strStrippedOrigNbr = "";
Session.g_strOrigCallingCode = "";
Session.g_strOrigAreaCode = "";
Session.g_nDestCountryId = 0;
Session.g_strDestCallingCountryCode = "";
Session.g_strDestAreaCode = "";
Session.g_nBillingType = 0;
Session.g_nCurrencyId = 0;
Session.g_lSubscriberId = 0;
Session.g_nServiceId = 0;
Session.g_strOperatorFlag = "";
Session.g_iRoundSeconds = 0;
Session.g_iSubExpirationType = 0;
Session.g_nPayphoneSrchgRateId = 0;
Session.g_fPayphoneSrchgRateAmt = 0;
Session.g_nAccessNumberRateId = 0;
Session.g_fAccessNumberRateAmt = 0;
Session.g_nAccessNumberRateType = 0;
Session.g_nMeteredRate1Id = 0;
Session.g_fMeteredRate1Amt = 0;
Session.g_nMeteredRate2Id = 0;
Session.g_fMeteredRate2Amt = 0;
Session.g_nFixedRate1Id = 0;
Session.g_fFixedRate1Amt = 0;
Session.g_nFixedRate2Id = 0;
Session.g_fFixedRate2Amt = 0;
Session.g_fTotalFixedRate = 0;
Session.g_fTotalMeteredRate = 0;
Session.g_strSetStateToGetConfRes = "";
Session.g_strConfSessionId = "";
Session.g_strCustomerConferenceId = ""
Session.g_lPrivateTalkStartTime = 0;
Session.g_lPrivateTalkEndTime = 0;
Session.g_strMediaServerIP = "";
Session.g_strConfResource = "";
Session.g_oMS.strConferenceId = "";
Session.g_oMS.strEndPoint = "";
Session.g_oMS.strCallId = "";
Session.g_oMS.strConnectionId = "";
Session.g_oSubConfMS.strConferenceId = "";
Session.g_oSubConfMS.strEndPoint = "";
Session.g_oSubConfMS.strCallId = "";
Session.g_oSubConfMS.strConnectionId = "";
Session.g_oTempConf.strConferenceId = "";
Session.g_oTempConf.strEndPoint = "";
Session.g_oTempConf.strCallId = "";
Session.g_oTempConf.strConnectionId = "";
js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="24" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1168 y=254 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
        </action>
        <action id="26" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1405 y=206 ?>
          <!--Remove member from MOH-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;RemoveMemberFromConference&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMOH_MS</parameter>
          </function>
          <results >
            <result name="Default" link="15" stubbed="0"/>
          </results>
        </action>
      </actions>
      <text-objects >
        <text-object x-coord="935" y-coord="456" width="469" height="157" text="set flags:
g_bTransferedFlag to CC
some other flags for DB
subConference flag also
" font-name="Times New Roman" size="-16" red="0" green="0" blue="0" weight="0" underline="0" strikeout="0" point-size="12" italic="0"/>
      </text-objects>
    </function>
    <function name="OnACDAuditRequest" start="154" event="ACDAuditRequest" returns="void" >
      <parameters >
        <parameter name="strACDControllerIP" type="string" pass="byref"/>
        <parameter name="nACDControllerPort" type="i4" pass="byref"/>
        <parameter name="strTransactionId" type="string" pass="byref"/>
      </parameters>
      <local-vars >
        <var name="nReturnCode" type="i4" >-1</var>
      </local-vars>
      <actions >
        <action id="154" plug-in="Pactolus.Branch.1" ><?xtml-editor x=153 y=49 ?>
          <!--waiting for CSR?-->
          <results >
            <result name="Default" link="3" stubbed="1"/>
            <result name="g_bWaitForCSR" link="155" stubbed="0" >g_bWaitForCSR == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_disable_event();
Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: OnACDAudiRequest");
]]></script>
          </scripts>
        </action>
        <action id="1" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=2093 y=490 ?>
          <!--"ACDAuditResponse"-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strACDControllerIP" transaction="strTransactionId" message-name="&quot;ACDAuditResponse&quot;" destination-port="nACDControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;RequestID&quot;" value="g_lCSRRequestId"/>
            <parameter tag="&quot;RequestType&quot;" value="g_nCSRRouteReasonCode"/>
            <parameter tag="&quot;RequestTypeName&quot;" value="g_strCSRRequestTypeName"/>
            <parameter tag="&quot;LanguageId&quot;" value="g_lCSRRequestLanguageId"/>
            <parameter tag="&quot;LanguageName&quot;" value="g_strCSRRequestLanguageName"/>
            <parameter tag="&quot;OfferingId&quot;" value="g_lCSRRequestOfferingId"/>
            <parameter tag="&quot;OfferingName&quot;" value="g_strCSRRequestOfferingName"/>
            <parameter tag="&quot;ServiceId&quot;" value="g_lCSRRequestServiceId"/>
            <parameter tag="&quot;ServiceName&quot;" value="g_strCSRRequestServiceName"/>
            <parameter tag="&quot;SkillId&quot;" value="g_lCSRRequestSkillId"/>
            <parameter tag="&quot;SkillName&quot;" value="g_strCSRRequestSkillName"/>
            <parameter tag="&quot;AccessNumber&quot;" value="g_strAccessNumber"/>
            <parameter tag="&quot;ConferenceEventId&quot;" value="g_strConfEventId"/>
            <parameter tag="&quot;ConferenceScheduleId&quot;" value="g_strConfScheduleId"/>
            <parameter tag="&quot;ServiceProviderId&quot;" value="g_lServiceProviderId"/>
            <parameter tag="&quot;ServiceProviderName&quot;" value="g_strCSRServiceProviderName"/>
            <parameter tag="&quot;ConferenceEndPoint&quot;" value="g_strCSRRequestEndPoint"/>
            <parameter tag="&quot;SoapAgentPort&quot;" value="g_nSoapPort"/>
            <parameter tag="&quot;PassCode&quot;" value="g_strPassCode"/>
            <parameter tag="&quot;SubscriberAccount&quot;" value="&quot;SubscriberAccount&quot;"/>
            <parameter tag="&quot;SubscriberFirstName&quot;" value="g_strCallerFirstName"/>
            <parameter tag="&quot;SubscriberLastName&quot;" value="g_strCallerLastName"/>
            <parameter tag="&quot;GroupId&quot;" value="g_lCSRRequestGroupId"/>
            <parameter tag="&quot;GroupName&quot;" value="g_strCSRRequestGroupName"/>
            <parameter tag="&quot;SubscriberPin&quot;" value="g_strSubscriberPin"/>
            <parameter tag="&quot;RequestorANI&quot;" value="g_strOrigNbr"/>
            <parameter tag="&quot;AccessNumberType&quot;" value="g_nEventDnisType"/>
            <parameter tag="&quot;ConferenceStartTime&quot;" value="g_strScheduleStartTime"/>
            <parameter tag="&quot;AutoAssign&quot;" value="g_strAutoAssign"/>
            <parameter tag="&quot;CCGeneratedPasscode&quot;" value="g_strCCGeneratedPassCode"/>
            <parameter tag="&quot;reservationCode&quot;" value="g_strReservationCode"/>
            <parameter tag="&quot;invalidConferenceCode&quot;" value="g_nInvalidConferenceCode"/>
            <parameter tag="&quot;invalidConferenceMessage&quot;" value="g_strInvalidConferenceMsg"/>
            <parameter tag="&quot;PartyDetail&quot;" value="g_strPartyDetail"/>
          </SOAP>
          <results >
            <result name="Default" link="43" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (1 == Result.id)
{
	Server.logError("ERROR: FAIL TO SEND RESPONSE TO ACD AUDIT REQUEST");
}
else
{
	Server.logInfo("SUCCESS SEND RESPONSE TO ACD AUDIT REQUEST");
}]]></script>
          </scripts>
        </action>
        <action id="3" plug-in="Pactolus.Branch.1" ><?xtml-editor x=152 y=323 ?>
          <!--sidebar operator request-->
          <results >
            <result name="Default" link="85" stubbed="0"/>
            <result name="SideBarRequestOperator" link="141" stubbed="0" >g_bSideBarOperatorRequest == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bTalkingWithCSR = false;
Session.g_nCallerCurrentState = Session.s_nStateRequeue;]]></script>
          </scripts>
        </action>
        <action id="37" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1536 y=141 ?>
          <!--Remove member from temp conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;RemoveMemberFromConference&quot;" return="nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
          </function>
          <results >
            <result name="Default" link="148" stubbed="0"/>
            <result name="SUCCESS" link="147" stubbed="0" >nReturnCode == s_nSuccess</result>
          </results>
        </action>
        <action id="43" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1775 y=351 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="74" plug-in="Standard.Timer.1" ><?xtml-editor x=1949 y=241 ?>
          <!--5 secs to connect MOH-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lMOHTimerId" duration="s_nPreMohTime"/>
          <results >
            <result name="Default" link="150" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bMOHTimerFlag = true;]]></script>
          </scripts>
        </action>
        <action id="80" plug-in="Standard.Timer.1" ><?xtml-editor x=1567 y=333 ?>
          <!--set max wait time for CSR-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lWaitCSRTimerId" duration="s_nCsrHoldTime"/>
          <results >
            <result name="Default" link="43" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bWaitCSRTimerSet = true;]]></script>
          </scripts>
        </action>
        <action id="81" plug-in="Standard.Timer.1" ><?xtml-editor x=1352 y=321 ?>
          <!--play beep beep every 10 secs-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lBeepBeepTimerId" duration="s_nSleepTime"/>
          <results >
            <result name="Default" link="80" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bBeepBeepTimerFlag = true;]]></script>
          </scripts>
        </action>
        <action id="82" plug-in="Pactolus.Branch.1" ><?xtml-editor x=864 y=198 ?>
          <!--zero out to CSR-->
          <results >
            <result name="Default" link="83" stubbed="0"/>
            <result name="zero out to CSR" link="99" stubbed="0" >g_bZeroOutToCSR == true</result>
          </results>
        </action>
        <action id="83" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1108 y=120 ?>
          <!--1510: The CSR was disconnected. Please wait...-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oTempConf.strConnectionId" endpoint="g_oTempConf.strEndPoint" callid="g_oTempConf.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oTempConf.strType" returns="" start-play="1" interrupt="0" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >1510</audio>
          </play>
          <results >
            <result name="Default" link="98" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="85" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=412 y=204 ?>
          <!--stop timers-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;StopTimer&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="87" stubbed="0"/>
          </results>
        </action>
        <action id="87" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=647 y=202 ?>
          <!--"psAPISceEndAssignment"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceEndAssignment&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="82" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_lCSRAssignmentEndTime = Server.getUTCTime();]]></script>
          </scripts>
        </action>
        <action id="98" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1334 y=149 ?>
          <!--"DisconnectFromMOH"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DisconnectFromMOH&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="37" stubbed="0"/>
          </results>
        </action>
        <action id="99" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1130 y=300 ?>
          <!--1510: The CSR was disconnected. Please wait...
340: (Beep, Beep)-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="0" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >340</audio>
          </play>
          <results >
            <result name="Default" link="81" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="104" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=659 y=448 ?>
          <!--"psAPISceEndAssignment"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceEndAssignment&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="105" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_lCSRAssignmentEndTime = Server.getUTCTime();]]></script>
          </scripts>
        </action>
        <action id="105" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=898 y=428 ?>
          <!--1510: The CSR was disconnected. Please wait...-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oTempConf.strConnectionId" endpoint="g_oTempConf.strEndPoint" callid="g_oTempConf.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oTempConf.strType" returns="" start-play="1" interrupt="0" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >1510</audio>
          </play>
          <results >
            <result name="Default" link="128" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="107" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=412 y=759 ?>
          <!--Remove member from temp conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;RemoveMemberFromConference&quot;" return="nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
          </function>
          <results >
            <result name="Default" link="109" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: SIDEBAR OPERATOR REQUEST, END ASSIGNMENT, REMOVE MEMBER FROM TEMP CONFERENCE.");]]></script>
          </scripts>
        </action>
        <action id="108" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=880 y=701 ?>
          <!--AddMemberToTempConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
            <parameter >g_oCallLegA</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="114" stubbed="0"/>
            <result name="SUCCESS" link="151" stubbed="0" >nReturnCode == s_nSuccess</result>
          </results>
        </action>
        <action id="109" plug-in="Pactolus.Branch.1" ><?xtml-editor x=629 y=763 ?>
          <!--Dial In?-->
          <results >
            <result name="Default" link="108" stubbed="0"/>
            <result name="g_strOutdialFlag = &quot;T&quot;;" link="110" stubbed="0" >g_strOutdialFlag match "T"</result>
          </results>
        </action>
        <action id="110" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=895 y=877 ?>
          <!--AddMemberToTempConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
            <parameter >g_oCallLegB</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="114" stubbed="1"/>
            <result name="SUCCESS" link="151" stubbed="0" >nReturnCode == s_nSuccess</result>
          </results>
        </action>
        <action id="113" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1323 y=657 ?>
          <!--Hang up caller-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpCaller&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="153" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nConfLeaveReason = 9;
Session.g_strConfLeaveMsg = "FAIL TO ADD PARTY TO CONFERENCE";]]></script>
          </scripts>
        </action>
        <action id="114" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1112 y=656 ?>
          <!--Delete temp conf-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DeleteConference&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
          </function>
          <results >
            <result name="Default" link="113" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[Session.g_bCreatedTempConf = false;]]></script>
          </scripts>
        </action>
        <action id="115" plug-in="Standard.EndSession.1" ><?xtml-editor x=1728 y=673 ?></action>
        <action id="116" plug-in="Standard.Timer.1" ><?xtml-editor x=1347 y=787 ?>
          <!--play beep beep every 10 secs-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lBeepBeepTimerId" duration="s_nSleepTime"/>
          <results >
            <result name="Default" link="117" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bBeepBeepTimerFlag = true;]]></script>
          </scripts>
        </action>
        <action id="117" plug-in="Standard.Timer.1" ><?xtml-editor x=1593 y=787 ?>
          <!--set max wait time for CSR-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lWaitCSRTimerId" duration="s_nCsrHoldTime"/>
          <results >
            <result name="Default" link="150" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bWaitCSRTimerSet = true;]]></script>
          </scripts>
        </action>
        <action id="128" plug-in="Pactolus.Branch.1" ><?xtml-editor x=158 y=755 ?>
          <!--caller back in main conference?-->
          <results >
            <result name="Default" link="107" stubbed="0"/>
            <result name="g_bCallerBackInMainConf" link="116" stubbed="1" >g_bCallerBackInMainConf == true</result>
          </results>
        </action>
        <action id="141" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=427 y=470 ?>
          <!--stop timers-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;StopTimer&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="104" stubbed="0"/>
          </results>
        </action>
        <action id="142" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1127 y=789 ?>
          <!--ConfMSConnectionIDChangedNotify-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ConfMSConnectionIDChangedNotify&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="116" stubbed="0"/>
          </results>
        </action>
        <action id="145" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1955 y=142 ?>
          <!--Hang up caller-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpCaller&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="152" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 36;
Session.g_nConfLeaveReason = 4;
Session.g_strConfLeaveMsg = "FAIL TO SEND INVITE PARTY TO HOLD";]]></script>
          </scripts>
        </action>
        <action id="147" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1739 y=244 ?>
          <!--Delete temp conf-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DeleteConference&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
          </function>
          <results >
            <result name="Default" link="74" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[Session.g_bCreatedTempConf = false;]]></script>
          </scripts>
        </action>
        <action id="148" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1739 y=142 ?>
          <!--Delete temp conf-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DeleteConference&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
          </function>
          <results >
            <result name="Default" link="145" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[Session.g_bCreatedTempConf = false;]]></script>
          </scripts>
        </action>
        <action id="150" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1868 y=479 ?>
          <!--Create a temp Conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;CreateConference&quot;" return="nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
          </function>
          <results >
            <result name="Default" link="1" stubbed="0"/>
            <result name="SUCCESS" >nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_oTempConf.strConferenceId = "";]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Session.nReturnCode == Session.s_nSuccess)

{

	Session.g_bCreatedTempConf = true;
    Session.g_strCSRRequestEndPoint = Session.g_oTempConf.strConferenceId;
}]]></script>
          </scripts>
        </action>
        <action id="151" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1104 y=896 ?>
          <!--Delete temp conf-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DeleteConference&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oTempConf</parameter>
          </function>
          <results >
            <result name="Default" link="142" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[Session.g_bCreatedTempConf = false;]]></script>
          </scripts>
        </action>
        <action id="152" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=2162 y=140 ?>
          <!--"ACDAuditResponse"-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strACDControllerIP" transaction="strTransactionId" message-name="&quot;ACDAuditResponse&quot;" destination-port="nACDControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;RequestID&quot;" value="g_lCSRRequestId"/>
            <parameter tag="&quot;RequestType&quot;" value="g_nCSRRouteReasonCode"/>
            <parameter tag="&quot;RequestTypeName&quot;" value="g_strCSRRequestTypeName"/>
            <parameter tag="&quot;LanguageId&quot;" value="g_lCSRRequestLanguageId"/>
            <parameter tag="&quot;LanguageName&quot;" value="g_strCSRRequestLanguageName"/>
            <parameter tag="&quot;OfferingId&quot;" value="g_lCSRRequestOfferingId"/>
            <parameter tag="&quot;OfferingName&quot;" value="g_strCSRRequestOfferingName"/>
            <parameter tag="&quot;ServiceId&quot;" value="g_lCSRRequestServiceId"/>
            <parameter tag="&quot;ServiceName&quot;" value="g_strCSRRequestServiceName"/>
            <parameter tag="&quot;SkillId&quot;" value="g_lCSRRequestSkillId"/>
            <parameter tag="&quot;SkillName&quot;" value="g_strCSRRequestSkillName"/>
            <parameter tag="&quot;AccessNumber&quot;" value="g_strAccessNumber"/>
            <parameter tag="&quot;ConferenceEventId&quot;" value="g_strConfEventId"/>
            <parameter tag="&quot;ConferenceScheduleId&quot;" value="g_strConfScheduleId"/>
            <parameter tag="&quot;ServiceProviderId&quot;" value="g_lServiceProviderId"/>
            <parameter tag="&quot;ServiceProviderName&quot;" value="g_strCSRServiceProviderName"/>
            <parameter tag="&quot;ConferenceEndPoint&quot;" value="g_strCSRRequestEndPoint"/>
            <parameter tag="&quot;SoapAgentPort&quot;" value="g_nSoapPort"/>
            <parameter tag="&quot;PassCode&quot;" value="g_strPassCode"/>
            <parameter tag="&quot;SubscriberAccount&quot;" value="&quot;SubscriberAccount&quot;"/>
            <parameter tag="&quot;SubscriberFirstName&quot;" value="g_strCallerFirstName"/>
            <parameter tag="&quot;SubscriberLastName&quot;" value="g_strCallerLastName"/>
            <parameter tag="&quot;GroupId&quot;" value="g_lCSRRequestGroupId"/>
            <parameter tag="&quot;GroupName&quot;" value="g_strCSRRequestGroupName"/>
            <parameter tag="&quot;SubscriberPin&quot;" value="g_strSubscriberPin"/>
            <parameter tag="&quot;RequestorANI&quot;" value="g_strOrigNbr"/>
            <parameter tag="&quot;AccessNumberType&quot;" value="g_nEventDnisType"/>
            <parameter tag="&quot;ConferenceStartTime&quot;" value="g_strScheduleStartTime"/>
            <parameter tag="&quot;AutoAssign&quot;" value="g_strAutoAssign"/>
            <parameter tag="&quot;CCGeneratedPasscode&quot;" value="g_strCCGeneratedPassCode"/>
            <parameter tag="&quot;reservationCode&quot;" value="g_strReservationCode"/>
            <parameter tag="&quot;invalidConferenceCode&quot;" value="g_nInvalidConferenceCode"/>
            <parameter tag="&quot;invalidConferenceMessage&quot;" value="g_strInvalidConferenceMsg"/>
            <parameter tag="&quot;PartyDetail&quot;" value="g_strPartyDetail"/>
          </SOAP>
          <results >
            <result name="Default" link="115" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (1 == Result.id)
{
	Server.logError("ERROR: FAIL TO SEND RESPONSE TO ACD AUDIT REQUEST");
}
else
{
	Server.logInfo("SUCCESS SEND RESPONSE TO ACD AUDIT REQUEST");
}]]></script>
          </scripts>
        </action>
        <action id="153" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1530 y=645 ?>
          <!--"ACDAuditResponse"-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strACDControllerIP" transaction="strTransactionId" message-name="&quot;ACDAuditResponse&quot;" destination-port="nACDControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;RequestID&quot;" value="g_lCSRRequestId"/>
            <parameter tag="&quot;RequestType&quot;" value="g_nCSRRouteReasonCode"/>
            <parameter tag="&quot;RequestTypeName&quot;" value="g_strCSRRequestTypeName"/>
            <parameter tag="&quot;LanguageId&quot;" value="g_lCSRRequestLanguageId"/>
            <parameter tag="&quot;LanguageName&quot;" value="g_strCSRRequestLanguageName"/>
            <parameter tag="&quot;OfferingId&quot;" value="g_lCSRRequestOfferingId"/>
            <parameter tag="&quot;OfferingName&quot;" value="g_strCSRRequestOfferingName"/>
            <parameter tag="&quot;ServiceId&quot;" value="g_lCSRRequestServiceId"/>
            <parameter tag="&quot;ServiceName&quot;" value="g_strCSRRequestServiceName"/>
            <parameter tag="&quot;SkillId&quot;" value="g_lCSRRequestSkillId"/>
            <parameter tag="&quot;SkillName&quot;" value="g_strCSRRequestSkillName"/>
            <parameter tag="&quot;AccessNumber&quot;" value="g_strAccessNumber"/>
            <parameter tag="&quot;ConferenceEventId&quot;" value="g_strConfEventId"/>
            <parameter tag="&quot;ConferenceScheduleId&quot;" value="g_strConfScheduleId"/>
            <parameter tag="&quot;ServiceProviderId&quot;" value="g_lServiceProviderId"/>
            <parameter tag="&quot;ServiceProviderName&quot;" value="g_strCSRServiceProviderName"/>
            <parameter tag="&quot;ConferenceEndPoint&quot;" value="g_strCSRRequestEndPoint"/>
            <parameter tag="&quot;SoapAgentPort&quot;" value="g_nSoapPort"/>
            <parameter tag="&quot;PassCode&quot;" value="g_strPassCode"/>
            <parameter tag="&quot;SubscriberAccount&quot;" value="&quot;SubscriberAccount&quot;"/>
            <parameter tag="&quot;SubscriberFirstName&quot;" value="g_strCallerFirstName"/>
            <parameter tag="&quot;SubscriberLastName&quot;" value="g_strCallerLastName"/>
            <parameter tag="&quot;GroupId&quot;" value="g_lCSRRequestGroupId"/>
            <parameter tag="&quot;GroupName&quot;" value="g_strCSRRequestGroupName"/>
            <parameter tag="&quot;SubscriberPin&quot;" value="g_strSubscriberPin"/>
            <parameter tag="&quot;RequestorANI&quot;" value="g_strOrigNbr"/>
            <parameter tag="&quot;AccessNumberType&quot;" value="g_nEventDnisType"/>
            <parameter tag="&quot;ConferenceStartTime&quot;" value="g_strScheduleStartTime"/>
            <parameter tag="&quot;AutoAssign&quot;" value="g_strAutoAssign"/>
            <parameter tag="&quot;CCGeneratedPasscode&quot;" value="g_strCCGeneratedPassCode"/>
            <parameter tag="&quot;reservationCode&quot;" value="g_strReservationCode"/>
            <parameter tag="&quot;invalidConferenceCode&quot;" value="g_nInvalidConferenceCode"/>
            <parameter tag="&quot;invalidConferenceMessage&quot;" value="g_strInvalidConferenceMsg"/>
            <parameter tag="&quot;PartyDetail&quot;" value="g_strPartyDetail"/>
          </SOAP>
          <results >
            <result name="Default" link="115" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (1 == Result.id)
{
	Server.logError("ERROR: FAIL TO SEND RESPONSE TO ACD AUDIT REQUEST");
}
else
{
	Server.logInfo("SUCCESS SEND RESPONSE TO ACD AUDIT REQUEST");
}]]></script>
          </scripts>
        </action>
        <action id="155" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=422 y=48 ?>
          <!--"ACDAuditResponse"-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strACDControllerIP" transaction="strTransactionId" message-name="&quot;ACDAuditResponse&quot;" destination-port="nACDControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;RequestID&quot;" value="g_lCSRRequestId"/>
            <parameter tag="&quot;RequestType&quot;" value="g_nCSRRouteReasonCode"/>
            <parameter tag="&quot;RequestTypeName&quot;" value="g_strCSRRequestTypeName"/>
            <parameter tag="&quot;LanguageId&quot;" value="g_lCSRRequestLanguageId"/>
            <parameter tag="&quot;LanguageName&quot;" value="g_strCSRRequestLanguageName"/>
            <parameter tag="&quot;OfferingId&quot;" value="g_lCSRRequestOfferingId"/>
            <parameter tag="&quot;OfferingName&quot;" value="g_strCSRRequestOfferingName"/>
            <parameter tag="&quot;ServiceId&quot;" value="g_lCSRRequestServiceId"/>
            <parameter tag="&quot;ServiceName&quot;" value="g_strCSRRequestServiceName"/>
            <parameter tag="&quot;SkillId&quot;" value="g_lCSRRequestSkillId"/>
            <parameter tag="&quot;SkillName&quot;" value="g_strCSRRequestSkillName"/>
            <parameter tag="&quot;AccessNumber&quot;" value="g_strAccessNumber"/>
            <parameter tag="&quot;ConferenceEventId&quot;" value="g_strConfEventId"/>
            <parameter tag="&quot;ConferenceScheduleId&quot;" value="g_strConfScheduleId"/>
            <parameter tag="&quot;ServiceProviderId&quot;" value="g_lServiceProviderId"/>
            <parameter tag="&quot;ServiceProviderName&quot;" value="g_strCSRServiceProviderName"/>
            <parameter tag="&quot;ConferenceEndPoint&quot;" value="g_strCSRRequestEndPoint"/>
            <parameter tag="&quot;SoapAgentPort&quot;" value="g_nSoapPort"/>
            <parameter tag="&quot;PassCode&quot;" value="g_strPassCode"/>
            <parameter tag="&quot;SubscriberAccount&quot;" value="&quot;SubscriberAccount&quot;"/>
            <parameter tag="&quot;SubscriberFirstName&quot;" value="g_strCallerFirstName"/>
            <parameter tag="&quot;SubscriberLastName&quot;" value="g_strCallerLastName"/>
            <parameter tag="&quot;GroupId&quot;" value="g_lCSRRequestGroupId"/>
            <parameter tag="&quot;GroupName&quot;" value="g_strCSRRequestGroupName"/>
            <parameter tag="&quot;SubscriberPin&quot;" value="g_strSubscriberPin"/>
            <parameter tag="&quot;RequestorANI&quot;" value="g_strOrigNbr"/>
            <parameter tag="&quot;AccessNumberType&quot;" value="g_nEventDnisType"/>
            <parameter tag="&quot;ConferenceStartTime&quot;" value="g_strScheduleStartTime"/>
            <parameter tag="&quot;AutoAssign&quot;" value="g_strAutoAssign"/>
            <parameter tag="&quot;CCGeneratedPasscode&quot;" value="g_strCCGeneratedPassCode"/>
            <parameter tag="&quot;reservationCode&quot;" value="g_strReservationCode"/>
            <parameter tag="&quot;invalidConferenceCode&quot;" value="g_nInvalidConferenceCode"/>
            <parameter tag="&quot;invalidConferenceMessage&quot;" value="g_strInvalidConferenceMsg"/>
            <parameter tag="&quot;PartyDetail&quot;" value="g_strPartyDetail"/>
          </SOAP>
          <results >
            <result name="Default" link="156" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (1 == Result.id)
{
	Server.logError("ERROR: FAIL TO SEND RESPONSE TO ACD AUDIT REQUEST");
}
else
{
	Server.logInfo("SUCCESS SEND RESPONSE TO ACD AUDIT REQUEST");
}]]></script>
          </scripts>
        </action>
        <action id="156" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=656 y=49 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_enable_event();]]></script>
          </scripts>
        </action>
      </actions>
    </function>
    <function name="psAPISceConfSetTransferPartyDetail" start="1" event="" returns="i4" >
      <local-vars >
        <var name="nReturnCode" type="i4" >-1</var>
      </local-vars>
      <actions >
        <action id="1" plug-in="Pactolus.JavaStaticMethod.1" ><?xtml-editor x=177 y=149 ?>
          <!--"transferPartyDetail"-->
          <java xmlns="urn:www.pactolus.com:xtml:application" class="&quot;com.pactolus.conferencing.psAPISceConfTransferPartyDetail&quot;" method="&quot;transferPartyDetail&quot;" timeout="s_nTimeout" return="" method-return-var="nReturnCode" method-return-type="0" >
            <parameter type="in" var-type="string" >g_strSessionId</parameter>
            <parameter type="in" var-type="i8" >g_lTransferFromPartySchedId</parameter>
            <parameter type="in" var-type="string" >g_strConfScheduleId</parameter>
            <parameter type="in" var-type="string" >g_strCallLegId</parameter>
            <parameter type="inout" var-type="string" >g_strPartyDetail</parameter>
            <parameter type="inout" var-type="i8" >g_lPartySchedId</parameter>
          </java>
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="Success" link="3" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: psAPISceConfSetTransferPartyDetail");
Server.logInfo("INFO: ********JAVA CALLING ConfSetTransferPartyDetail *********");

Server.logInfo("INFO: BEFORE Session Id = " + Session.g_strSessionId);
Server.logInfo("INFO: BEFORE transfer from party sched Id = " + Session.g_lTransferFromPartySchedId);
Server.logInfo("INFO: BEFORE conf sched sched Id = " + Session.g_strConfScheduleId);
Server.logInfo("INFO: BEFORE conf event id = " + Session.g_strConfEventId);]]></script>
            <script language="javascript" timing="last" ><![CDATA[Server.logInfo("INFO: ********** iJavaReturnCode " + Session.nReturnCode);
Server.logInfo("INFO: AFTER party detail = " + Session.g_strPartyDetail);
Server.logInfo("INFO: AFTER party schedule id = " + Session.g_lPartySchedId);

if (Result.id != 2 || Session.nReturnCode != 0)
{
	Server.logError("ERROR: FAIL TO CALL SET PARTY DETAIL, EXIT ON: " + Result.name);
	Server.logError("ERROR: FAIL TO CALL SET PARTY DETAIL, Return Code: " + Session.nReturnCode);
}]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=487 y=132 ?>
          <!--FAILURE-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nFailure"/>
        </action>
        <action id="3" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=496 y=223 ?>
          <!--return code from java-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="nReturnCode"/>
        </action>
      </actions>
    </function>
    <function name="OnConfAllocateMSEndpointRequest" start="1" event="ConfAllocateMSEndpointRequest" returns="void" >
      <parameters >
        <parameter name="strConfControllerIP" type="string" pass="byref"/>
        <parameter name="nConfControllerPort" type="i4" pass="byref"/>
        <parameter name="strTransactionId" type="string" pass="byref"/>
      </parameters>
      <local-vars >
        <var name="nReturnCode" type="i4" >-1</var>
      </local-vars>
      <actions >
        <action id="1" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=107 y=119 ?>
          <!--CreateAConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;CreateConference&quot;" return="nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="SUCCESS" link="3" stubbed="0" >nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: OnConfAllocateMSEndpointRequest");
js_initMS (Session.g_oMS, Session.s_strConfMsType);
Session.g_oMS.nConferenceMaxTalkers = Session.s_nConferenceMaxTalkers;
Session.g_oMS.bPersistentFlag = true;
Session.g_oMS.nConferenceMaxParties = 125;

//ASN
Session.g_oMS.nNbrActiveSpeakers = Session.s_nNbrActiveSpeakers;
Session.g_oMS.nReportingInterval = Session.s_nReportingInterval;
Session.g_oMS.nDBThreshold = Session.s_nDBThreshold;
//AGC
Session.g_oMS.nAGCTargetLevelIn = Session.s_nAGCTargetLevelIn;
Session.g_oMS.nAGCMaxLevelIn = Session.s_nAGCMaxLevelIn;
Session.g_oMS.nAGCTargetLevelOut = Session.s_nAGCTargetLevelOut;
Session.g_oMS.nAGCMaxLevelOut = Session.s_nAGCMaxLevelOut;]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=335 y=79 ?>
          <!--FAIL to create conferece-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strConfControllerIP" transaction="strTransactionId" message-name="&quot;ConfAllocateMSEndpointResponse&quot;" destination-port="nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="-999"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
            <parameter tag="&quot;conferenceEndpoint&quot;" value="g_oMS.strConferenceId"/>
          </SOAP>
          <results >
            <result name="Default" link="4" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "FAIL TO CREATE CONFERENCE";]]></script>
          </scripts>
        </action>
        <action id="3" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=352 y=215 ?>
          <!--SUCCESS create conferece-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strConfControllerIP" transaction="strTransactionId" message-name="&quot;ConfAllocateMSEndpointResponse&quot;" destination-port="nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="nReturnCode"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
            <parameter tag="&quot;conferenceEndpoint&quot;" value="g_oMS.strConferenceId"/>
          </SOAP>
          <results >
            <result name="Default" link="4" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "SUCCESS CREATE CONFERENCE";]]></script>
          </scripts>
        </action>
        <action id="4" plug-in="Standard.EndSession.1" ><?xtml-editor x=606 y=72 ?></action>
      </actions>
    </function>
    <function name="OnConfReleaseMSEndpointRequest" start="1" event="ConfReleaseMSEndpointRequest" returns="void" >
      <parameters >
        <parameter name="strConfControllerIP" type="string" pass="byref"/>
        <parameter name="nConfControllerPort" type="i4" pass="byref"/>
        <parameter name="strTransactionId" type="string" pass="byref"/>
        <parameter name="strConferenceEndpoint" type="string" pass="byref"/>
      </parameters>
      <local-vars >
        <var name="nReturnCode" type="i4" >-1</var>
      </local-vars>
      <actions >
        <action id="1" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=233 y=154 ?>
          <!--"DeleteConference"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DeleteConference&quot;" return="nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="SUCCESS" link="3" stubbed="0" >nReturnCode == s_nSuccess</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: OnConfReleaseMSEndpointRequest");
js_initMS (Session.g_oMS, Session.s_strConfMsType);
Session.g_oMS.strConferenceId = Session.strConferenceEndpoint;
//ASN
Session.g_oMS.nNbrActiveSpeakers = Session.s_nNbrActiveSpeakers;
Session.g_oMS.nReportingInterval = Session.s_nReportingInterval;
Session.g_oMS.nDBThreshold = Session.s_nDBThreshold;
//AGC
Session.g_oMS.nAGCTargetLevelIn = Session.s_nAGCTargetLevelIn;
Session.g_oMS.nAGCMaxLevelIn = Session.s_nAGCMaxLevelIn;
Session.g_oMS.nAGCTargetLevelOut = Session.s_nAGCTargetLevelOut;
Session.g_oMS.nAGCMaxLevelOut = Session.s_nAGCMaxLevelOut;]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=489 y=122 ?>
          <!--FAIL to delete conferece-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strConfControllerIP" transaction="strTransactionId" message-name="&quot;ConfReleaseMSEndpointResponse&quot;" destination-port="nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="-999"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
          </SOAP>
          <results >
            <result name="Default" link="4" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "FAIL TO DELETE CONFERENCE";]]></script>
          </scripts>
        </action>
        <action id="3" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=502 y=258 ?>
          <!--SUCCESS delete conferece-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strConfControllerIP" transaction="strTransactionId" message-name="&quot;ConfReleaseMSEndpointResponse&quot;" destination-port="nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="nReturnCode"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
          </SOAP>
          <results >
            <result name="Default" link="4" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "SUCCESS DELETE CONFERENCE";]]></script>
          </scripts>
        </action>
        <action id="4" plug-in="Standard.EndSession.1" ><?xtml-editor x=756 y=115 ?></action>
      </actions>
    </function>
    <function name="OnConfAddToMainRequest" start="2" event="ConfPlacePartyOnEndpointRequest" returns="void" >
      <parameters >
        <parameter name="strConferenceControllerIP" type="string" pass="byref"/>
        <parameter name="nConferenceControllerPort" type="i4" pass="byref"/>
        <parameter name="strTransactionId" type="string" pass="byref"/>
        <parameter name="strConferenceId" type="string" pass="byref"/>
      </parameters>
      <local-vars >
        <var name="nReturnCode" type="i4" >0</var>
        <var name="bAlreadyInThisConf" type="boolean" >0</var>
      </local-vars>
      <actions >
        <action id="2" plug-in="Pactolus.Branch.1" ><?xtml-editor x=153 y=276 ?>
          <!--muted?-->
          <results >
            <result name="Default" link="13" stubbed="0"/>
            <result name="AlreadyInThisConf" link="12" stubbed="1" >bAlreadyInThisConf == true</result>
            <result name="1 - MOH" link="5" stubbed="0" >g_nDefaultAudioMode == 1</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: ConfPlacePartyOnEndpointRequest");
Server.logInfo("CONFERENCE ENDPOINT IS : " + Session.strConferenceId);
if (Session.g_oMS.strConferenceId == Session.strConferenceId && Session.g_oMS.bCurrentlyInConf == true)
{
	Session.bAlreadyInThisConf = true;
	Server.logInfo("ALREADY IN THIS CONFERENCE, WON'T ADD TO CONFERENCE");
}
else
{
	Session.g_oMS.strConferenceId = Session.strConferenceId;
	Server.logInfo("NOT IN THIS CONFERENCE, WILL ADD TO CONFERENCE");
}

if (0 == Session.g_nDefaultAudioMode)
{
	Session.g_oMS.bMuteFlag = false;
	Session.g_oMS.bDeafFlag = false;
	Session.g_bMutedState = false;
	Session.g_bHoldState = false;
}
else if (2 == Session.g_nDefaultAudioMode)
{
	Session.g_oMS.bMuteFlag = true;
	Session.g_oMS.bDeafFlag = false;
	Session.g_bMutedState = true;
	Session.g_bHoldState = false;
}
else (1 == Session.g_nDefaultAudioMode)
{
	Session.g_oMS.bMuteFlag = true;
	Session.g_oMS.bDeafFlag = true;
	Session.g_bMutedState = false;
	Session.g_bHoldState = true;
}]]></script>
          </scripts>
        </action>
        <action id="3" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=788 y=100 ?>
          <!--"SetDTMFOn"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;SetDTMFOn&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="20" stubbed="1"/>
          </results>
        </action>
        <action id="5" plug-in="Pactolus.Branch.1" ><?xtml-editor x=394 y=507 ?>
          <!--MOH?-->
          <results >
            <result name="Default" link="7" stubbed="0"/>
            <result name="g_strMusicOnHoldFlag==&quot;T&quot;" link="10" stubbed="0" >g_strMusicOnHoldFlag match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bDontPlayContinueToHold = true;]]></script>
          </scripts>
        </action>
        <action id="7" plug-in="Standard.Timer.1" ><?xtml-editor x=610 y=503 ?>
          <!--play please hold every 10 secs-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lHoldTimerId" duration="s_nSleepTime"/>
          <results >
            <result name="Default" link="20" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bHoldTimerFlag = true;]]></script>
          </scripts>
        </action>
        <action id="10" plug-in="Standard.Timer.1" ><?xtml-editor x=627 y=604 ?>
          <!--5 secs to connect MOH-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lMOHTimerId" duration="s_nPreMohTime"/>
          <results >
            <result name="Default" link="20" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bMOHTimerFlag = true;
Session.g_bDtmfCollectionOnHold = true;]]></script>
          </scripts>
        </action>
        <action id="11" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1085 y=590 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
        </action>
        <action id="12" plug-in="Pactolus.Branch.1" ><?xtml-editor x=574 y=122 ?>
          <!--muted?-->
          <results >
            <result name="Default" link="3" stubbed="0"/>
            <result name="2 - Muted" link="14" stubbed="0" >g_nDefaultAudioMode == 2</result>
          </results>
        </action>
        <action id="13" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=359 y=199 ?>
          <!--AddMemberToConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;NewAddMemberToConference&quot;" return="nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
            <parameter >g_oCallLegA</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="12" stubbed="0"/>
            <result name="FAILURE" link="15" stubbed="0" >nReturnCode == s_nFailure</result>
            <result name="CALLER HUNG UP" link="16" stubbed="0" >nReturnCode == s_nCallerHungup</result>
          </results>
        </action>
        <action id="14" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=804 y=209 ?>
          <!--"ChangeToMutedMode"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ChangeToMutedMode&quot;" return="nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="18" stubbed="0"/>
            <result name="SUCCESS" link="3" stubbed="1" >nReturnCode == s_nSuccess</result>
          </results>
        </action>
        <action id="15" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=597 y=258 ?>
          <!--Hang up caller-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpCaller&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="19" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 35;
Session.g_strReturnMsg = "FAIL TO ADD PARTY TO CONFERENCE";]]></script>
          </scripts>
        </action>
        <action id="16" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=604 y=358 ?>
          <!--"PartyLeave"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;PartyLeave&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="19" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nConfLeaveReason = 0;
Session.g_strConfLeaveMsg = "PARTY HANGUP WHILE TRYING TO ADD MEMBER TO CONFERENCE";
Session.g_strReturnMsg = "PARTY HANGUP WHILE TRYING TO ADD MEMBER TO CONFERENCE";]]></script>
          </scripts>
        </action>
        <action id="17" plug-in="Standard.EndSession.1" ><?xtml-editor x=1036 y=351 ?></action>
        <action id="18" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1036 y=209 ?>
          <!--Hang up caller-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpCaller&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="19" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 38;
Session.g_strReturnMsg = "FAIL TO MODIFY CONFERENCE TO MUTED";]]></script>
          </scripts>
        </action>
        <action id="19" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=818 y=354 ?>
          <!--fail to add to conference-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strConferenceControllerIP" transaction="strTransactionId" message-name="&quot;ConfPlacePartyOnEndpointResponse&quot;" destination-port="nConferenceControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="s_nFailure"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
            <parameter tag="&quot;ConnectionId&quot;" value="g_oMS.strConnectionId"/>
          </SOAP>
          <results >
            <result name="Default" link="17" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
        </action>
        <action id="20" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=855 y=594 ?>
          <!--success to add to conference-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strConferenceControllerIP" transaction="strTransactionId" message-name="&quot;ConfPlacePartyOnEndpointResponse&quot;" destination-port="nConferenceControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="s_nSuccess"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
            <parameter tag="&quot;ConnectionId&quot;" value="g_oMS.strConnectionId"/>
          </SOAP>
          <results >
            <result name="Default" link="11" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "SUCCESS TO ADD PARTY TO CONFERENCE";]]></script>
          </scripts>
        </action>
      </actions>
      <text-objects >
        <text-object x-coord="122" y-coord="45" width="322" height="94" text="This is ConfPlacePartyOnEndpointRequest, different name because of SCE limit to 32 chars" font-name="Times New Roman" size="-16" red="0" green="0" blue="0" weight="0" underline="0" strikeout="0" point-size="12" italic="0"/>
      </text-objects>
    </function>
    <function name="psAPISceConfGetPartyDetail" start="1" event="" returns="i4" >
      <local-vars >
        <var name="nReturnCode" type="i4" >-1</var>
        <var name="strPartySchedId" type="string" ></var>
        <var name="strPartyDetail" type="string" ></var>
        <var name="strCallerPasscode" type="string" ></var>
      </local-vars>
      <actions >
        <action id="1" plug-in="Pactolus.JavaStaticMethod.1" ><?xtml-editor x=233 y=176 ?>
          <!--"getPartyDetail"-->
          <java xmlns="urn:www.pactolus.com:xtml:application" class="&quot;com.pactolus.conferencing.psAPISceGetPartyDetailFromCallLegInfo&quot;" method="&quot;getPartyDetailString&quot;" timeout="s_nTimeout" return="" method-return-var="nReturnCode" method-return-type="0" >
            <parameter type="in" var-type="string" >g_strSessionId</parameter>
            <parameter type="in" var-type="string" >g_strCallLegId</parameter>
            <parameter type="inout" var-type="string" >g_strPartyDetail</parameter>
            <parameter type="inout" var-type="i8" >g_lPartySchedId</parameter>
          </java>
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="Success" link="3" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: psAPISceGetPartyDetailFromCallLegInfo");
Server.logInfo("INFO: *********JAVA CALLING GetPartyDetail *********");
Server.logInfo("INFO: BEFORE session Id = " + Session.g_strSessionId);
Server.logInfo("INFO: BEFORE call leg Id = " + Session.g_strCallLegId);
Server.logInfo("INFO: BEFORE party detail = " + Session.g_strPartyDetail);
Server.logInfo("INFO: BEFORE party sched Id = " + Session.g_lPartySchedId);]]></script>
            <script language="javascript" timing="last" ><![CDATA[Server.logInfo("INFO: ********* SetConfResource returns " + Session.nReturnCode);
Server.logInfo("INFO: AFTER session Id = " + Session.g_strSessionId);
Server.logInfo("INFO: AFTER call leg Id = " + Session.g_strCallLegId);
Server.logInfo("INFO: AFTER party detail = " + Session.g_strPartyDetail);
Server.logInfo("INFO: AFTER party sched Id = " + Session.g_lPartySchedId);
if (Result.id != 2)
{
	Server.logError("ERROR: FAIL TO CALL GET PARTY DETAIL, EXIT ON: " + Result.name);
}]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=469 y=167 ?>
          <!--return FAILED_JAVA-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nFailure"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logError("ERROR: FAIL TO GET PARTY DETAIL");]]></script>
          </scripts>
        </action>
        <action id="3" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=474 y=257 ?>
          <!--return JAVA_SUCCESS-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="nReturnCode"/>
        </action>
      </actions>
    </function>
    <function name="GetCustomPasscode" start="75" event="GetPassCode" returns="i4" >
      <local-vars >
        <var name="f_sCounter" type="i2" >0</var>
        <var name="f_nReturnCode" type="i4" >-1</var>
        <var name="f_sMaxRetry" type="i2" >0</var>
        <var name="f_nTempInt" type="i4" >0</var>
        <var name="f_lCurrentTime" type="i8" >0</var>
        <var name="f_strPongSessionId" type="string" ></var>
        <var name="f_nPromptToPlay" type="i4" >99</var>
        <var name="f_bRouteToCSR" type="boolean" >0</var>
        <var name="f_strTerminationDigit" type="string" ></var>
        <var name="f_nCallLegCount" type="i4" >0</var>
        <var name="f_nWaitForResCounter" type="i4" >0</var>
        <var name="f_bPlayPleaseHold" type="boolean" >0</var>
        <var name="f_nPassCodeStatus" type="i4" >0</var>
        <var name="f_strTempString" type="string" ></var>
        <var name="f_bEmptyString" type="boolean" >0</var>
        <var name="s_nPromptTooEarly" type="i4" >972</var>
        <var name="strCollectedDigit" type="string" ></var>
      </local-vars>
      <actions >
        <action id="75" plug-in="Pactolus.Branch.1" ><?xtml-editor x=39 y=534 ?>
          <!--Event conf?-->
          <results >
            <result name="Default" link="66" stubbed="0"/>
            <result name="g_nDnisIdentifyConferenceFlag == 1" link="76" stubbed="0" >g_nDnisIdentifiedConfFlag == 1</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: GetPassCode");]]></script>
          </scripts>
        </action>
        <action id="1" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=930 y=534 ?>
          <!--Collect pass code-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="g_strPassCodeDigitMap" language="g_strLanguage" digits="g_strPassCode" retry-count="" clear-digits="0" terminating-digit="f_strTerminationDigit" quick-collect="0" digit-timer="" >
            <audio type="index" >s_nPromptGetPasscode</audio>
          </play>
          <results >
            <result name="Default" link="21" stubbed="1"/>
            <result name="Success" link="32" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout" link="74" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strPassCode = "";
Session.f_strTerminationDigit = "";]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=215 y=1216 ?>
          <!--authenticate pass code-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceAuthConfPassCode&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="79" stubbed="0"/>
            <result name="0 or 1 or 3 - SUCCESS" link="67" stubbed="0" >f_nReturnCode == 0
OR f_nReturnCode == 1
OR f_nReturnCode == 3</result>
            <result name="2 - WAIT FOR RESOURCE" link="20" stubbed="0" >f_nReturnCode == 2</result>
            <result name="-11 - WAIT FOR MOD" link="80" stubbed="0" >f_nReturnCode == s_nWaitForMod</result>
            <result name="-21- WRONG SITE" link="67" stubbed="1" >f_nReturnCode == -21</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_nReturnCode = -50;

js_disable_event();]]></script>
            <script language="javascript" timing="last" ><![CDATA[switch (Session.f_nReturnCode)

{
	case -3:

		Server.logInfo("INFO: TOO LATE PASSCODE");

		Session.g_nTerminationReason = 20;

		Session.f_nPromptToPlay = Session.s_nPromptTooLate;

		break;

	case -4:

		Server.logInfo("INFO: DISABLE SUBSCRIBER");

		Session.g_nTerminationReason = 4;

		Session.f_nPromptToPlay = Session.s_nPromptDisableSub;

		break;

	case -5:

		Server.logInfo("INFO: MAX ATTENDEES");

		Session.g_nTerminationReason = 15;

		Session.f_nPromptToPlay = Session.s_nPromptMaxAttendeesReach;

		break;

	case -6:

		Server.logInfo("INFO: CONF LOCKED");

		Session.g_nTerminationReason = 16;

		Session.f_nPromptToPlay = Session.s_nPromptConfLocked;

		break;

	case -7:

		Server.logInfo("INFO: CONF ALREADY ENDED");

		Session.g_nTerminationReason = 2;

		Session.f_nPromptToPlay = Session.s_nPromptConfEnded;

		break;

	case -9:

		Server.logInfo("INFO: MOD NOT IN");

		Session.g_nTerminationReason = 22;

		Session.f_nPromptToPlay = Session.s_nPromptModNotArrive;

		break;

	case -10:

		Server.logError("ERROR: NO CONF CONTROLLER");

		Session.g_nTerminationReason = 39;

		Session.f_nPromptToPlay = Session.s_nPromptNoConfController;

		break;

	case -13:

		Server.logInfo("INFO: CONFERENCE DISABLED");

		Session.g_nTerminationReason = 29;

		Session.f_nPromptToPlay = 853;

		break;

	case -19:

		Server.logInfo("INFO: INVALID ACCESS NUMBER");

		Session.g_nTerminationReason = 28;

		Session.f_nPromptToPlay = 99;

		break;

	case -20:

		Server.logInfo("INFO: INVALID SUBSCRIBER ACCESS NUMBER");

		Session.g_nErrorMsgNumber = 4016; //conf invalid subscriber access number

		Session.g_nTerminationReason = 28;

		Session.f_nPromptToPlay = 99;

		break;

	case -22:

		Server.logError("ERROR: INSUFFICIENT MS RESOURCE");
		
		Session.g_nErrorMsgNumber = 4018; //insufficient ms resource

		Session.g_nTerminationReason = 30;
		
		Session.f_nPromptToPlay = 99;

		break;
		
	case -98:

		Server.logError("ERROR: DB RESTARTED:" + Session.g_strPassCode);

		Session.g_nTerminationReason = 39;

		Session.f_nPromptToPlay = Session.s_nPromptSystemUnavailable;

		break;

	case -99:

		Server.logError("ERROR: DB ERROR PASSCODE:" + Session.g_strPassCode);

		Session.g_nTerminationReason = 39;

		Session.f_nPromptToPlay = Session.s_nPromptDBError;

		break;

	default:

		Session.g_nTerminationReason = 39;

		Session.f_nPromptToPlay = 305;

		break;

}

js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="3" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1000 y=1577 ?>
          <!--exceed max retry?-->
          <results >
            <result name="Default" link="62" stubbed="0"/>
            <result name="Counter &gt;= MaxRetry?" link="30" stubbed="0" >f_sCounter &gt;= g_nMaxRetryAllowed</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_sCounter++;

Session.f_strTempString = Session.g_strPassCode;]]></script>
          </scripts>
        </action>
        <action id="4" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=917 y=351 ?>
          <!--Welcome prompt Index-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="50" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="g_strPassCodeDigitMap" language="g_strLanguage" digits="g_strPassCode" retry-count="" clear-digits="1" terminating-digit="f_strTerminationDigit" quick-collect="0" digit-timer="" >
            <audio type="index" >g_nWelcomePromptIndex</audio>
            <audio type="index" >s_nPromptGetPasscode</audio>
          </play>
          <results >
            <result name="Default" link="21" stubbed="1"/>
            <result name="Success" link="32" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[// Session.f_sMaxRetry = Session.g_nMaxRetryAllowed;

// Session.g_strPassCode = "";]]></script>
          </scripts>
        </action>
        <action id="5" plug-in="Pactolus.Branch.1" ><?xtml-editor x=661 y=361 ?>
          <!--Welcome prompt?-->
          <results >
            <result name="Default" link="4" stubbed="0"/>
            <result name="IWelcomePromptIndex &lt;= 0" link="1" stubbed="0" >g_nWelcomePromptIndex &lt;= 0</result>
          </results>
        </action>
        <action id="6" plug-in="Pactolus.Branch.1" ><?xtml-editor x=388 y=241 ?>
          <!--strWelcomePromptType = U or I-->
          <results >
            <result name="Default" link="1" stubbed="1"/>
            <result name="strWelcomePromptType==U" link="7" stubbed="0" >g_strWelcomePromptType match "U"</result>
            <result name="strWelcomePromptType==I" link="5" stubbed="0" >g_strWelcomePromptType match "I"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_sMaxRetry = Session.g_nMaxRetryAllowed;
Session.g_strPassCode = "";
Server.logInfo("Session ID is: " + Session._sessionId);
Server.logInfo("Welcome Prompt Type is: " + Session.g_strWelcomePromptType);]]></script>
            <script language="javascript" timing="last" ><![CDATA[Server.logInfo("EXIT ON RESULT ID: " + Result.id + "  RESULT NAME: " + Result.name);]]></script>
          </scripts>
        </action>
        <action id="7" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=643 y=165 ?>
          <!--Welcome prompt URL-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="40" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="g_strPassCodeDigitMap" language="g_strLanguage" digits="g_strPassCode" retry-count="" clear-digits="1" terminating-digit="f_strTerminationDigit" quick-collect="0" digit-timer="" >
            <audio type="url" >g_strWelcomePromptUrl</audio>
            <audio type="index" >s_nPromptGetPasscode</audio>
          </play>
          <results >
            <result name="Default" link="21" stubbed="0"/>
            <result name="Success" link="32" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout" link="65" stubbed="1"/>
          </results>
        </action>
        <action id="8" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1168 y=100 ?>
          <!--FAILURE-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nFailure"/>
        </action>
        <action id="9" plug-in="Pactolus.Sleep.1" ><?xtml-editor x=761 y=1226 ?>
          <!--2 secs-->
          <sleep xmlns="urn:www.pactolus.com:xtml:application" duration="2"/>
          <results >
            <result name="Default" link="2" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (Session.f_bPlayPleaseHold == true)

{

	Session.f_bPlayPleaseHold = false;

}

else if(Session.f_bPlayPleaseHold == false)

{

	Session.f_bPlayPleaseHold = true;

}]]></script>
          </scripts>
        </action>
        <action id="11" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1696 y=1362 ?>
          <!--s_nWaitForMod-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nWaitForMod"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bWaitForModerator = true;]]></script>
          </scripts>
        </action>
        <action id="12" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1446 y=972 ?>
          <!--PostPin prompt?-->
          <results >
            <result name="Default" link="36" stubbed="0"/>
            <result name="PostPinPromptIndex &lt;= 0" link="84" stubbed="1" >g_nPostPinPromptIndex &lt;= 0</result>
          </results>
        </action>
        <action id="13" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1107 y=884 ?>
          <!--strPostPinPromptType = U or I-->
          <results >
            <result name="Default" link="84" stubbed="1"/>
            <result name="strPostPinPromptType==U" link="14" stubbed="0" >g_strPostPinPromptType match "U"</result>
            <result name="strPostPinPromptType==I" link="12" stubbed="0" >g_strPostPinPromptType match "I"</result>
          </results>
        </action>
        <action id="14" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1371 y=806 ?>
          <!--PostPin prompt URL-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="url" >g_strPostPinPromptUrl</audio>
          </play>
          <results >
            <result name="Default" link="84" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="15" plug-in="Pactolus.Branch.1" ><?xtml-editor x=3495 y=927 ?>
          <!--first caller?-->
          <results >
            <result name="Default" link="17" stubbed="0"/>
            <result name="g_bFirstCaller==true" link="16" stubbed="0" >g_bFirstCaller == true</result>
          </results>
        </action>
        <action id="16" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=3726 y=986 ?>
          <!--FIRST CALLER-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nFirstCaller"/>
        </action>
        <action id="17" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=3716 y=874 ?>
          <!--NOT FIRST CALLER-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nNonFirstCaller"/>
        </action>
        <action id="18" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1952 y=985 ?>
          <!--conferenceResource == null?-->
          <results >
            <result name="Default" link="58" stubbed="0"/>
            <result name="conferenceResource == null" link="8" stubbed="1" >g_bNullString == true
AND (g_bFirstCaller == false
OR g_bNoCreateConfFirstCaller == true)</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (!Session.g_bFirstCaller || (Session.g_bFirstCaller && Session.g_bNoCreateConfFirstCaller))
{
	if (Session.g_strConfResource.length <= 0)
	{
		Session.g_bNullString = true;
		Session.g_nErrorMsgNumber = 4014;
		Session.g_nTerminationReason = 39;
		Session.g_strReturnMsg = "NULL CONFERENCE RESOURCE, UNABLE TO ADD PARTY TO THE CONFERENCE";
		if (3 == Session.f_nReturnCode)
			Server.logError("ERROR: THE FIRST CALLER and NO NEED TO GET CONFERENCE ENDPOINT, BUT CONF RESOURCE IS NULL: " + Session.g_strConfResource);
		else
			Server.logError("ERROR: NOT THE FIRST CALLER, BUT CONF RESOURCE IS NULL: " + Session.g_strConfResource);
	}
	else
	{
		Session.g_bNullString = false;
		Session.g_oMS.strConferenceId = Session.g_strConfResource;
	}
}]]></script>
          </scripts>
        </action>
        <action id="19" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1192 y=194 ?>
          <!--send ALARM-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="" transaction="" message-name="s_strSendAlarmRequest" destination-port="" destination-type="1" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;calling_number&quot;" value="g_strAlarmType"/>
            <parameter tag="&quot;called_number&quot;" value="g_strAlarmPriority"/>
          </SOAP>
          <results >
            <result name="Default" link="8" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strAlarmType = "MEDIASERVER: play get passcode";

Session.g_strAlarmPriority = "MAJOR";]]></script>
          </scripts>
        </action>
        <action id="20" plug-in="Pactolus.Branch.1" ><?xtml-editor x=519 y=1226 ?>
          <!--exceed max retry?-->
          <results >
            <result name="Default" link="9" stubbed="0"/>
            <result name="WaitForResCounter &gt; s_nMax?" link="8" stubbed="1" >f_nWaitForResCounter &gt; s_nMaxRetryWaitConfRes</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_nWaitForResCounter++;

Session.g_strRetryFlag = "T";]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (2 == Result.id)

{

	Session.g_nTerminationReason = 2;

	Session.g_nErrorMsgNumber = 4012;  //exceed max wait for conf resource

	Server.logError("ERROR: EXCEED MAX WAIT FOR CONFERENCE RESOURCE.");

}]]></script>
          </scripts>
        </action>
        <action id="21" plug-in="Pactolus.Branch.1" ><?xtml-editor x=894 y=120 ?>
          <!--s_strSendAlarmFlag==T-->
          <results >
            <result name="Default" link="8" stubbed="0"/>
            <result name="s_strSendAlarmFlag==T" link="19" stubbed="0" >s_strSendAlarmFlag match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 40;]]></script>
          </scripts>
        </action>
        <action id="22" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1472 y=1360 ?>
          <!--"RecordCallerName"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;RecordCallerName&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="11" stubbed="0"/>
          </results>
        </action>
        <action id="23" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2717 y=938 ?>
          <!--"RecordCallerName"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;RecordCallerName&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="98" stubbed="0"/>
          </results>
        </action>
        <action id="27" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2735 y=1070 ?>
          <!--Collect billing code-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;(xxxxxxxxxx|x.T|x.#)&quot;" language="g_strLanguage" digits="g_strBillingCodeNumber" retry-count="g_nMaxRetryAllowed" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >943</audio>
            <audio type="index" >580</audio>
            <timeout-prompt type="index" >552</timeout-prompt>
          </play>
          <results >
            <result name="Default" link="29" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="28" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2472 y=979 ?>
          <!--get billing code?-->
          <results >
            <result name="Default" link="23" stubbed="0"/>
            <result name="g_strBillingCodeFlag==T" link="27" stubbed="0" >g_strBillingCodeFlag match "T"</result>
          </results>
        </action>
        <action id="29" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2941 y=1069 ?>
          <!--set billing code-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceSetBillingCode&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="23" stubbed="1"/>
          </results>
        </action>
        <action id="30" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1222 y=1821 ?>
          <!--ACD enable?-->
          <results >
            <result name="Default" link="38" stubbed="0"/>
            <result name="routeTPCSR== &quot;T&quot;" link="71" stubbed="0" >g_strThirdPartyAcdOutdialAvail match "T"
AND f_bEmptyString == false</result>
            <result name="routeCSR=&quot;T&quot;" link="39" stubbed="0" >g_strACDCSROnMaxLoginsEnabled match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (Session.g_strThirdPartyAcdOutdialNumber.length <= 0)
	Session.f_bEmptyString = true;
else
	Session.f_bEmptyString = false;
if ("T" == Session.g_strThirdPartyAcdOutdialAvail && Session.f_bEmptyString)
{
	Server.logError("ERROR: ROUTE TO THIRD PARTY CSR IS TRUE, BUT THERE IS NO NUMBER TO OUTDIAL")
	Server.logError("ERROR: EXCEED MAX RETRIES TO ENTER PASSCODE, HANGUP")
}]]></script>
          </scripts>
        </action>
        <action id="31" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1701 y=1920 ?>
          <!--route to CSR-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nStateRouteToCsr"/>
        </action>
        <action id="32" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1175 y=529 ?>
          <!--call CSR?-->
          <results >
            <result name="Default" link="2" stubbed="1"/>
            <result name="f_bRouteToCSR==true" link="3" stubbed="1" >f_bRouteToCSR == true</result>
            <result name="f_strTerminationDigit = &quot;*&quot;" link="1" stubbed="1" >f_strTerminationDigit match "\*"</result>
            <result name="f_bEmptyString" link="74" stubbed="0" >f_bEmptyString == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (Session.g_strPassCode.length == 1 && Session.g_strPassCode == "0")

{

	Session.f_bRouteToCSR = true;

}

else if (0 == Session.g_strPassCode.length)

{

	Session.f_bEmptyString = true;

}

else

{

	Session.f_bEmptyString = false;

}]]></script>
          </scripts>
        </action>
        <action id="33" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1417 y=526 ?>
          <!--s_nStateRouteToCsr-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nStateRouteToCsr"/>
        </action>
        <action id="36" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1702 y=971 ?>
          <!--post pin prompt-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >g_nPostPinPromptIndex</audio>
          </play>
          <results >
            <result name="Default" link="84" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="37" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1716 y=1762 ?>
          <!--invalid passcode-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >853</audio>
            <audio type="index" >s_nPromptGetPasscode</audio>
          </play>
          <results >
            <result name="Default" link="8" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="38" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1444 y=1768 ?>
          <!--invalid passcode-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >853</audio>
          </play>
          <results >
            <result name="Default" link="8" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO:  MAX RETRY GETTING PASSCODE.");

Session.g_nTerminationReason = 2;]]></script>
          </scripts>
        </action>
        <action id="39" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1454 y=1925 ?>
          <!--invalid passcode-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >853</audio>
          </play>
          <results >
            <result name="Default" link="31" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO:  MAX RETRY GETTING PASSCODE.");]]></script>
          </scripts>
        </action>
        <action id="54" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=999 y=1370 ?>
          <!--Collect billing code-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;(xxxxxxxxxx|x.T|x.#)&quot;" language="g_strLanguage" digits="g_strBillingCodeNumber" retry-count="g_nMaxRetryAllowed" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >943</audio>
            <audio type="index" >580</audio>
            <timeout-prompt type="index" >552</timeout-prompt>
          </play>
          <results >
            <result name="Default" link="56" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="55" plug-in="Pactolus.Branch.1" ><?xtml-editor x=764 y=1376 ?>
          <!--get billing code?-->
          <results >
            <result name="Default" link="22" stubbed="1"/>
            <result name="g_strBillingCodeFlag==T" link="54" stubbed="0" >g_strBillingCodeFlag match "T"</result>
          </results>
        </action>
        <action id="56" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1238 y=1367 ?>
          <!--set billing code-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceSetBillingCode&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="22" stubbed="0"/>
          </results>
        </action>
        <action id="57" plug-in="Pactolus.Branch.1" ><?xtml-editor x=866 y=942 ?>
          <!--call CSR?-->
          <results >
            <result name="Default" link="13" stubbed="0"/>
            <result name="f_bRouteToCSR==true" link="13" stubbed="1" >f_bRouteToCSR == true</result>
            <result name="f_strTerminationDigit = &quot;*&quot;" link="13" stubbed="1" >f_strTerminationDigit match "\*"</result>
            <result name="wrong site" link="68" stubbed="0" >g_bWrongSiteHangOff == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (Session.g_strAttendeeId.length == 1 && Session.g_strAttendeeId == "0")

{

	Session.f_bRouteToCSR = true;

}

else if (Session.g_strAttendeeId == Session.g_strAnonymousAttendeeId)

{

	Session.g_bAnonymousCaller = true;

}

else

{

	Session.g_bAnonymousCaller = false;

}]]></script>
          </scripts>
        </action>
        <action id="58" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2208 y=982 ?>
          <!--anonymous caller?-->
          <results >
            <result name="Default" link="28" stubbed="0"/>
            <result name="g_bAnonymousCaller" link="15" stubbed="1" >g_bAnonymousCaller == true</result>
          </results>
        </action>
        <action id="59" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1446 y=1479 ?>
          <!--invalid, get passcode again-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="g_strPassCodeDigitMap" language="g_strLanguage" digits="g_strPassCode" retry-count="" clear-digits="0" terminating-digit="f_strTerminationDigit" quick-collect="0" digit-timer="" >
            <audio type="index" >853</audio>
            <audio type="index" >s_nPromptGetPasscode</audio>
          </play>
          <results >
            <result name="Default" link="21" stubbed="1"/>
            <result name="Success" link="32" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout" link="3" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strPassCode = "";
Session.f_strTerminationDigit = "";]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (4 == Result.id)

{

	Session.g_nTerminationReason = 2;

}]]></script>
          </scripts>
        </action>
        <action id="60" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1736 y=1470 ?>
          <!--Collect pass code-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="g_strPassCodeDigitMap" language="g_strLanguage" digits="g_strPassCode" retry-count="" clear-digits="0" terminating-digit="f_strTerminationDigit" quick-collect="0" digit-timer="" >
            <audio type="index" >s_nPromptGetPasscode</audio>
          </play>
          <results >
            <result name="Default" link="21" stubbed="1"/>
            <result name="Success" link="32" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strPassCode = "";
Session.f_strTerminationDigit = "";
Session.g_nErrorMsgNumber = 0;]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (4 == Result.id)

{

	Session.g_nTerminationReason = 2;

}]]></script>
          </scripts>
        </action>
        <action id="62" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1215 y=1486 ?>
          <!--empty string-->
          <results >
            <result name="Default" link="59" stubbed="0"/>
            <result name="f_bEmptyString" link="63" stubbed="0" >f_bEmptyString == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (0 == Session.f_strTempString.length || 0 == Session.g_strPassCode.length)

{

	Server.logError("PASSCODE LENGTH IS ZERO");

	Server.logError("Session.f_strTempString is: " + Session.f_strTempString);

	Server.logError("Session.g_strPassCode is: " + Session.g_strPassCode);

	Session.f_bEmptyString = true;

}

else

{

	Session.f_bEmptyString = false;

}]]></script>
          </scripts>
        </action>
        <action id="63" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1452 y=1631 ?>
          <!--invalid, get passcode again-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="g_strPassCodeDigitMap" language="g_strLanguage" digits="g_strPassCode" retry-count="" clear-digits="0" terminating-digit="f_strTerminationDigit" quick-collect="0" digit-timer="" >
            <audio type="index" >853</audio>
            <audio type="index" >s_nPromptGetPasscode</audio>
          </play>
          <results >
            <result name="Default" link="21" stubbed="1"/>
            <result name="Success" link="32" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout" link="60" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strPassCode = "";
Session.f_strTerminationDigit = "";]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (4 == Result.id)

{

	Session.g_nTerminationReason = 2;

}]]></script>
          </scripts>
        </action>
        <action id="64" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1524 y=348 ?>
          <!--invalid, get passcode again-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="g_strPassCodeDigitMap" language="g_strLanguage" digits="g_strPassCode" retry-count="" clear-digits="0" terminating-digit="f_strTerminationDigit" quick-collect="0" digit-timer="" >
            <audio type="index" >854</audio>
          </play>
          <results >
            <result name="Default" link="21" stubbed="1"/>
            <result name="Success" link="32" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout" link="95" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strPassCode = "";]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (4 == Result.id)

{

	Session.g_nTerminationReason = 2;

}]]></script>
          </scripts>
        </action>
        <action id="65" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1265 y=350 ?>
          <!--exceed max retry?-->
          <results >
            <result name="Default" link="64" stubbed="0"/>
            <result name="Counter &gt;= MaxRetry?" link="8" stubbed="1" >f_sCounter &gt;= g_nMaxRetryAllowed</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_sCounter++;
Session.f_strTempString = Session.g_strPassCode;]]></script>
          </scripts>
        </action>
        <action id="66" plug-in="Pactolus.Branch.1" ><?xtml-editor x=323 y=423 ?>
          <!--HandOff from Proxy or Passcode Provided?-->
          <results >
            <result name="Default" link="6" stubbed="1"/>
            <result name="g_bHandOff" link="2" stubbed="1" >g_bHandOff == true</result>
            <result name="g_bPasscodeProvided" link="2" stubbed="1" >g_bPasscodeProvided == true</result>
          </results>
        </action>
        <action id="67" plug-in="Pactolus.Branch.1" ><?xtml-editor x=449 y=960 ?>
          <!--Come from HandOff?-->
          <results >
            <result name="Default" link="57" stubbed="1"/>
            <result name="g_bHandOff" link="69" stubbed="0" >g_bHandOff == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_sMaxRetry = Session.g_nMaxRetryAllowed;]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (2 == Result.id)

{

	if (Session.g_strAttendeeId == Session.g_strAnonymousAttendeeId)

	{

		Session.g_bAnonymousCaller = true;

	}

	else

	{

		Session.g_bAnonymousCaller = false;

	}

}]]></script>
          </scripts>
        </action>
        <action id="68" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1118 y=1031 ?>
          <!--s_nWrongSite-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nWrongSite"/>
        </action>
        <action id="69" plug-in="Pactolus.Branch.1" ><?xtml-editor x=679 y=949 ?>
          <!--handback and still get wrong site-->
          <results >
            <result name="Default" link="13" stubbed="1"/>
            <result name="redirect=3&amp;&amp;returncode=-21" link="8" stubbed="1" >g_nRedirectStatus == 3
AND f_nReturnCode == -21</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (2 == Result.id)
{
	Session.g_nErrorMsgNumber = 4017;
}]]></script>
          </scripts>
        </action>
        <action id="71" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1453 y=2049 ?>
          <!--invalid passcode-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >853</audio>
          </play>
          <results >
            <result name="Default" link="72" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO:  MAX RETRY GETTING PASSCODE.");]]></script>
          </scripts>
        </action>
        <action id="72" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1706 y=2035 ?>
          <!--route to ThirdParty CSR-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nStateRouteToThirdPartyCsr"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_nCurrentState = Session.s_nStateRouteToThirdPartyCsr;]]></script>
          </scripts>
        </action>
        <action id="74" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1422 y=620 ?>
          <!--invalid-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >853</audio>
          </play>
          <results >
            <result name="Default" link="65" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="76" plug-in="Pactolus.Branch.1" ><?xtml-editor x=336 y=625 ?>
          <!--1. Get passcode
2. no passcode, non speaker
3. no passcode, speaker-->
          <results >
            <result name="Default" link="6" stubbed="1"/>
            <result name="2 == g_nEventDnisType" link="2" stubbed="1" >g_nEventDnisType == 2</result>
            <result name="3 == g_nEventDnisType" link="2" stubbed="1" >g_nEventDnisType == 3</result>
          </results>
        </action>
        <action id="77" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=582 y=804 ?>
          <!--invalid entry-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="0" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >853</audio>
          </play>
          <results >
            <result name="Default" link="78" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="78" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=812 y=801 ?>
          <!--Collect pass code again-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="20" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="g_strPassCodeDigitMap" language="g_strLanguage" digits="g_strPassCode" retry-count="" clear-digits="0" terminating-digit="f_strTerminationDigit" quick-collect="0" digit-timer="" >
            <audio type="index" >854</audio>
          </play>
          <results >
            <result name="Default" link="21" stubbed="1"/>
            <result name="Success" link="32" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout" link="99" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strPassCode = "";
Session.f_strTerminationDigit = "";]]></script>
          </scripts>
        </action>
        <action id="79" plug-in="Pactolus.Branch.1" ><?xtml-editor x=371 y=804 ?>
          <!--exceed max retry?-->
          <results >
            <result name="Default" link="77" stubbed="0"/>
            <result name="Counter &gt;= MaxRetry?" link="8" stubbed="1" >f_sCounter &gt;= g_nMaxRetryAllowed</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_sCounter++;
Session.f_strTempString = Session.g_strPassCode;]]></script>
          </scripts>
        </action>
        <action id="80" plug-in="Pactolus.Branch.1" ><?xtml-editor x=531 y=1381 ?>
          <results >
            <result name="Default" link="55" stubbed="0"/>
            <result name="type1" link="13" stubbed="1" >g_nPasscodeScheme == 1</result>
          </results>
        </action>
        <action id="81" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1933 y=807 ?>
          <!--Collect star-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="8" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;(*)&quot;" language="g_strLanguage" digits="strCollectedDigit" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >974</audio>
          </play>
          <results >
            <result name="Default" link="55" stubbed="1"/>
            <result name="Success" link="83" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="82" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2394 y=668 ?>
          <!--Collect mod passcode-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;(x.T|x.#)&quot;" language="g_strLanguage" digits="g_strPassCode" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >975</audio>
          </play>
          <results >
            <result name="Default" link="55" stubbed="1"/>
            <result name="Success" link="86" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout" link="87" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strPassCode = "";]]></script>
          </scripts>
        </action>
        <action id="83" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2164 y=807 ?>
          <results >
            <result name="Default" link="55" stubbed="1"/>
            <result name="*" link="82" stubbed="0" >strCollectedDigit match "\*"</result>
          </results>
        </action>
        <action id="84" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1693 y=815 ?>
          <results >
            <result name="Default" link="18" stubbed="1"/>
            <result name="type1 and no mod" link="81" stubbed="0" >g_nPasscodeScheme == 1
AND g_nCurrNbrMods == 0</result>
          </results>
        </action>
        <action id="85" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2895 y=597 ?>
          <!--invalid passcode-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;(x.T|x.#)&quot;" language="g_strLanguage" digits="g_strPassCode" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >979</audio>
            <audio type="digits" >f_strTempString</audio>
            <audio type="index" >980</audio>
          </play>
          <results >
            <result name="Default" link="55" stubbed="1"/>
            <result name="Success" link="86" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout" link="85" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_strTempString = Session.g_strPassCode;
Session.g_strPassCode = "";]]></script>
          </scripts>
        </action>
        <action id="86" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2636 y=604 ?>
          <!--authenticate pass code-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceAuthConfPassCode&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="85" stubbed="0"/>
            <result name="0 or 1 or 3 - SUCCESS" link="88" stubbed="1" >f_nReturnCode == 0
OR f_nReturnCode == 1
OR f_nReturnCode == 3</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_nTempInt++;
Session.f_nReturnCode = -50;
Session.g_strModReAuthFlag = "T";
js_disable_event();]]></script>
            <script language="javascript" timing="last" ><![CDATA[js_enable_event();
Server.logInfo("Java returns : " + Session.f_nReturnCode);]]></script>
          </scripts>
        </action>
        <action id="87" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2670 y=790 ?>
          <!--invalid passcode-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;(x.T|x.#)&quot;" language="g_strLanguage" digits="g_strPassCode" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >979</audio>
            <audio type="index" >980</audio>
          </play>
          <results >
            <result name="Default" link="55" stubbed="1"/>
            <result name="Success" link="86" stubbed="1"/>
            <result name="Error"/>
            <result name="Timeout" link="87" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_strTempString = Session.g_strPassCode;
Session.g_strPassCode = "";]]></script>
          </scripts>
        </action>
        <action id="88" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2236 y=1227 ?>
          <!--Collect x-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;(x)&quot;" language="g_strLanguage" digits="strCollectedDigit" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >976</audio>
          </play>
          <results >
            <result name="Default" link="18" stubbed="1"/>
            <result name="Success" link="89" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.strCollectedDigit = "";]]></script>
          </scripts>
        </action>
        <action id="89" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2485 y=1227 ?>
          <results >
            <result name="Default" link="90" stubbed="0"/>
            <result name="digit == 1" link="91" stubbed="1" >strCollectedDigit match "1"</result>
          </results>
        </action>
        <action id="90" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2731 y=1226 ?>
          <!--feature not enable-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="0" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >977</audio>
          </play>
          <results >
            <result name="Default" link="88" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="91" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2243 y=1430 ?>
          <!--Collect *-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="&quot;(*)&quot;" language="g_strLanguage" digits="strCollectedDigit" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >981</audio>
          </play>
          <results >
            <result name="Default" link="18" stubbed="1"/>
            <result name="Success" link="93" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.strCollectedDigit = "";]]></script>
          </scripts>
        </action>
        <action id="92" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2724 y=1415 ?>
          <!--feature not enable-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="0" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >977</audio>
          </play>
          <results >
            <result name="Default" link="91" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="93" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2485 y=1433 ?>
          <results >
            <result name="Default" link="92" stubbed="0"/>
            <result name="*" link="94" stubbed="0" >strCollectedDigit match "\*"</result>
          </results>
        </action>
        <action id="94" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2739 y=1581 ?>
          <!--more options-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="0" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >982</audio>
            <audio type="index" >983</audio>
          </play>
          <results >
            <result name="Default" link="18" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="95" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1786 y=336 ?>
          <!--exceed max retry?-->
          <results >
            <result name="Default" link="96" stubbed="0"/>
            <result name="Counter &gt;= MaxRetry?" link="8" stubbed="1" >f_sCounter &gt;= g_nMaxRetryAllowed</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_sCounter++;
Session.f_strTempString = Session.g_strPassCode;]]></script>
          </scripts>
        </action>
        <action id="96" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=2014 y=335 ?>
          <!--invalid-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >853</audio>
          </play>
          <results >
            <result name="Default" link="64" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="97" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=3227 y=929 ?>
          <!--you now will be place into conference-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >871</audio>
          </play>
          <results >
            <result name="Default" link="15" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="98" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2969 y=939 ?>
          <results >
            <result name="Default" link="97" stubbed="0"/>
            <result name="type1 and no mod" link="15" stubbed="1" >g_nPasscodeScheme == 1
AND g_nCurrNbrMods == 0</result>
          </results>
        </action>
        <action id="99" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1005 y=675 ?>
          <!--exceed max retry?-->
          <results >
            <result name="Default" link="100" stubbed="0"/>
            <result name="Counter &gt;= MaxRetry?" link="8" stubbed="1" >f_sCounter &gt;= g_nMaxRetryAllowed</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_sCounter++;
Session.f_strTempString = Session.g_strPassCode;]]></script>
          </scripts>
        </action>
        <action id="100" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=1233 y=667 ?>
          <!--invalid-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="10" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >853</audio>
          </play>
          <results >
            <result name="Default" link="78" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
      </actions>
    </function>
    <function name="psAPISceSetSubConfType" start="1" event="" returns="i4" >
      <parameters >
        <parameter name="p_nSubConfType" type="i4"/>
      </parameters>
      <local-vars >
        <var name="nReturnCode" type="i4" >-1</var>
        <var name="strSubConfType" type="string" ></var>
      </local-vars>
      <actions >
        <action id="1" plug-in="Pactolus.JavaStaticMethod.1" ><?xtml-editor x=304 y=247 ?>
          <!--"setSubConfType"-->
          <java xmlns="urn:www.pactolus.com:xtml:application" class="&quot;com.pactolus.conferencing.psAPISceConfSetSubConfType&quot;" method="&quot;setSubConfType&quot;" timeout="s_nTimeout" return="" method-return-var="nReturnCode" method-return-type="0" >
            <parameter type="in" var-type="string" >g_strSessionId</parameter>
            <parameter type="in" var-type="string" >g_strCallLegId</parameter>
            <parameter type="in" var-type="string" >strSubConfType</parameter>
          </java>
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="Success" link="3" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: psAPISceSetSubConfType");
Server.logInfo("INFO: *********JAVA CALLING SetSubConfType *********");
if (0 == Session.p_nSubConfType)
	Session.strSubConfType = "NS";
else if (1 == Session.p_nSubConfType)
	Session.strSubConfType = "SP";
else if (2 == Session.p_nSubConfType)
	Session.strSubConfType = "CO";
else if (3 == Session.p_nSubConfType)
	Session.strSubConfType = "CL";
else
	Session.strSubConfType = "";
Server.logInfo("INFO: BEFORE Session Id = " + Session.g_strSessionId);
Server.logInfo("INFO: BEFORE call leg Id = " + Session.g_strCallLegId);
Server.logInfo("INFO: BEFORE sub conferrence type = " + Session.strSubConfType);]]></script>
            <script language="javascript" timing="last" ><![CDATA[Server.logInfo("INFO: ********* Set Sub Conf Type returns " + Session.nReturnCode);
if (Result.id != 2)
{
	Server.logError("ERROR: FAIL TO CALL SET SUB CONF TYPE, EXIT ON: " + Result.name);
}]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=580 y=237 ?>
          <!--return FAILED_JAVA-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nFailure"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logError("ERROR: FAIL TO SET SUB CONF TYPE");]]></script>
          </scripts>
        </action>
        <action id="3" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=585 y=327 ?>
          <!--return JAVA_SUCCESS-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="nReturnCode"/>
        </action>
      </actions>
    </function>
    <function name="OnConfPartyStatusChangeRequest" start="1" event="ConfPartyStatusChangeRequest" returns="void" >
      <parameters >
        <parameter name="strConfControllerIP" type="string" pass="byref"/>
        <parameter name="nConfControllerPort" type="i4" pass="byref"/>
        <parameter name="strTransactionId" type="string" pass="byref"/>
        <parameter name="nStatus" type="i4" pass="byref"/>
      </parameters>
      <actions >
        <action id="1" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=174 y=116 ?>
          <!--response SUCCESS-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strConfControllerIP" transaction="strTransactionId" message-name="s_strConfPartyStatusChangeRs" destination-port="nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="s_nSuccess"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
          </SOAP>
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: OnConfPartyStatusChangeRequest");
Server.logInfo("NEW STATUS: " + Session.nStatus);
Server.logInfo("OLD STATUS: " + Session.g_nReleaseToConfStatus);
Session.g_nReleaseToConfStatus = Session.nStatus;
Session.g_strReturnMsg = "SUCCESS CHANGE CONF PARTY STATUS";]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)
{
	Server.logError("ERROR RESPONSE TO CONF PARTY STATUS CHANGE REQUEST, EXIT ON: " + Result.name);
}]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=447 y=113 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
        </action>
      </actions>
    </function>
    <function name="psAPISceConfCallLegSetMSConnectTime" start="1" event="" returns="i4" >
      <local-vars >
        <var name="nReturnCode" type="i4" >-1</var>
      </local-vars>
      <actions >
        <action id="1" plug-in="Pactolus.JavaStaticMethod.1" ><?xtml-editor x=219 y=179 ?>
          <!--"setCallLegMSConnectTime"-->
          <java xmlns="urn:www.pactolus.com:xtml:application" class="&quot;com.pactolus.conferencing.psAPISceConfCallLegSetMSConnectTime&quot;" method="&quot;setCallLegMSConnectTime&quot;" timeout="s_nTimeout" return="" method-return-var="nReturnCode" method-return-type="0" >
            <parameter type="in" var-type="string" >g_strDBNAME</parameter>
            <parameter type="in" var-type="string" >g_strSessionId</parameter>
            <parameter type="in" var-type="i8" >g_lMSConnectTime</parameter>
            <parameter type="in" var-type="string" >g_strCallLegId</parameter>
          </java>
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="Success" link="3" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: psAPISceConfCallLegSetMSConnectTime");
Server.logInfo("INFO: *********JAVA CALLING setCallLegMSConnectTime *********");

Server.logInfo("INFO: BEFORE Session Id = " + Session.g_strSessionId);
Server.logInfo("INFO: BEFORE call leg Id = " + Session.g_strCallLegId);
Server.logInfo("INFO: BEFORE MS connect time = " + Session.g_lMSConnectTime);]]></script>
            <script language="javascript" timing="last" ><![CDATA[Server.logInfo("INFO: ********* setCallLegMSConnectTime returns " + Session.nReturnCode);
if (Result.id != 2)
{
	Server.logError("ERROR: FAIL TO CALL SET MS CONNECT TIME, EXIT ON: " + Result.name);
}]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=455 y=170 ?>
          <!--return FAILED_JAVA-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nFailure"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logError("ERROR: FAIL TO SET CALL LEG MS CONNECT TIME");]]></script>
          </scripts>
        </action>
        <action id="3" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=460 y=260 ?>
          <!--return JAVA_SUCCESS-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="nReturnCode"/>
        </action>
      </actions>
    </function>
  </functions>
  <script language="javascript" ><![CDATA[#include <javascript_utils.jsh>
#include <dialing_plan_utils.jsh>]]></script>
  <properties >
    <property key="default" value="C:/eclipse/workspace/Applications/InternalProduct/pcs_english.vox"/>
    <property key="disable-logging" value="0"/>
    <property key="js-include-path" value="../Libs"/>
    <property key="library-modules" value="lib_callcontrol.xml;lib_utils.xml;lib_mediaserver.xml"/>
    <property key="library-path" value="../Libs"/>
  </properties>
  <application-version >
    <revision >$Id: conference.xml,v 1.755 2008/01/29 20:38:47 hlam Exp $</revision>
    <label >$Name: PCS-A-4-1-1-1-4-c6 $</label>
  </application-version>
</xtml>
<?xml version="1.0"?>
<xtml version="1.0" xmlns="urn:www.pactolus.com:xtml" >
  <version sce-version="422a4" prev-sce-version="422a4" last-mod-time="Thursday, March 20, 2008 12:28:15"/>
  <events >
    <event name="LoginCSRIVRResponse" display="LoginCSRIVRResponse" >
      <parameter name="strACDControllerIP" type="string"/>
      <parameter name="nACDControllerPort" type="i4"/>
      <parameter name="strTransactionId" type="string"/>
      <parameter name="nReturnCode" type="i4"/>
      <parameter name="strReturnMsg" type="string"/>
    </event>
    <event name="LoginCSRGUINotify" display="LoginCSRGUINotify" >
      <parameter name="strACDControllerIP" type="string"/>
      <parameter name="nACDControllerPort" type="i4"/>
      <parameter name="strTransactionId" type="string"/>
      <parameter name="nACDUserId" type="i4"/>
      <parameter name="strFirstName" type="string"/>
      <parameter name="strLastName" type="string"/>
      <parameter name="strGroupName" type="string"/>
      <parameter name="strPrimaryLanguage" type="string"/>
      <parameter name="strPrimarySkill" type="string"/>
      <parameter name="nInitialState" type="i4"/>
      <parameter name="nCurrentState" type="i4"/>
      <parameter name="strACDUserType" type="string"/>
      <parameter name="strIVRLoginFlag" type="string"/>
      <parameter name="strLoginTime" type="string"/>
      <parameter name="strStateTime" type="string"/>
      <parameter name="nStateDuration" type="i4"/>
      <parameter name="strDialType" type="string"/>
    </event>
    <event name="AddCSRToConf" display="AddCSRToConf" >
      <parameter name="strACDControllerIP" type="string"/>
      <parameter name="nACDControllerPort" type="i4"/>
      <parameter name="strTransactionId" type="string"/>
      <parameter name="strConferenceType" type="string"/>
      <parameter name="strConfEventId" type="string"/>
      <parameter name="strConferenceEndPoint" type="string"/>
      <parameter name="strServiceProviderId" type="string"/>
      <parameter name="strConfPasscode" type="string"/>
      <parameter name="strCSRMuteFlag" type="string"/>
      <parameter name="strSubConferenceId" type="string"/>
    </event>
    <event name="RemoveCSRFromConf" display="RemoveCSRFromConf" >
      <parameter name="strACDControllerIP" type="string"/>
      <parameter name="nACDControllerPort" type="i4"/>
      <parameter name="strTransactionId" type="string"/>
    </event>
    <event name="LogoutCSRGUINotify" display="LogoutCSRGUINotify" >
      <parameter name="strACDControllerIP" type="string"/>
      <parameter name="nACDControllerPort" type="i4"/>
      <parameter name="strTransactionId" type="string"/>
      <parameter name="lACDUserId" type="i8"/>
      <parameter name="strACDUserType" type="string"/>
    </event>
    <event name="CSRBeginAssignment" display="CSRBeginAssignment" >
      <parameter name="strACDControllerIP" type="string"/>
      <parameter name="nACDControllerPort" type="i4"/>
      <parameter name="strTransactionId" type="string"/>
      <parameter name="lAssignmentId" type="i8"/>
      <parameter name="lRequestId" type="i8"/>
      <parameter name="lACDUserId" type="i8"/>
      <parameter name="lAssignmentSkillId" type="i8"/>
      <parameter name="strAssignmentSkillName" type="string"/>
      <parameter name="lAssignmentLanguageId" type="i8"/>
      <parameter name="strAssignmentLanguageName" type="string"/>
      <parameter name="lAssignmentGroupId" type="i8"/>
      <parameter name="strAssignmentGroupName" type="string"/>
      <parameter name="nRequestType" type="i4"/>
      <parameter name="strRequestTypeName" type="string"/>
      <parameter name="lServiceProviderId" type="i8"/>
      <parameter name="strServiceProviderName" type="string"/>
      <parameter name="lOfferingId" type="i8"/>
      <parameter name="strOfferingName" type="string"/>
      <parameter name="strConfEventId" type="string"/>
      <parameter name="strModPasscode" type="string"/>
      <parameter name="strSubscriberAccount" type="string"/>
      <parameter name="strSubscriberFirstName" type="string"/>
      <parameter name="strSubscriberLastName" type="string"/>
      <parameter name="strCSRAppServerIP" type="string"/>
      <parameter name="strAssignmentType" type="string"/>
      <parameter name="lAssignmentDuration" type="i8"/>
      <parameter name="strSubscriberPin" type="string"/>
      <parameter name="strCSRAssignmentAction" type="string"/>
    </event>
    <event name="CSREndAssignment" display="AssignmentAction" >
      <parameter name="strACDControllerIP" type="string"/>
      <parameter name="nACDControllerPort" type="i4"/>
      <parameter name="strTransactionId" type="string"/>
      <parameter name="lAssignmentId" type="i8"/>
      <parameter name="lRequestId" type="i8"/>
      <parameter name="lACDUserId" type="i8"/>
      <parameter name="strActionCode" type="string"/>
      <parameter name="strPasscode" type="string"/>
      <parameter name="strPrepaidPin" type="string"/>
      <parameter name="strPostpaidPin" type="string"/>
      <parameter name="strPostpaidAccountNumber" type="string"/>
      <parameter name="strOutdialPhoneNumber" type="string"/>
      <parameter name="nCSRAvailabilityState" type="i4"/>
      <parameter name="strBillableFlag" type="string"/>
      <parameter name="nReleaseToConfStatus" type="i4"/>
      <parameter name="lPartySchedId" type="i8"/>
      <parameter name="strPartyDetail" type="string"/>
      <parameter name="nDefaultAudioMode" type="i4"/>
      <parameter name="strSubConferenceId" type="string"/>
      <parameter name="strRequeueFlag" type="string"/>
    </event>
    <event name="ModeratorJoinRequest" display="ModeratorJoinRequest" >
      <parameter name="strConfControllerIP" type="string"/>
      <parameter name="nConfControllerPort" type="i4"/>
      <parameter name="strTransactionId" type="string"/>
      <parameter name="strConferenceResource" type="string"/>
    </event>
    <event name="HeartbeatResponse" display="HeartbeatResponse" >
      <parameter name="strACDControllerIP" type="string"/>
      <parameter name="nACDControllerPort" type="i4"/>
      <parameter name="strTransactionId" type="string"/>
    </event>
    <event name="Ping" display="Ping" >
      <parameter name="strACDControllerIP" type="string"/>
      <parameter name="nACDControllerPort" type="i4"/>
      <parameter name="strTransactionId" type="string"/>
      <parameter name="strHostIP" type="string"/>
      <parameter name="nHostPort" type="i4"/>
    </event>
    <event name="DialOutCSR" display="DialOutCSR" >
      <parameter name="strACDControllerIP" type="string"/>
      <parameter name="nACDControllerPort" type="i4"/>
      <parameter name="strTransactionId" type="string"/>
      <parameter name="strPhoneNumber" type="string"/>
      <parameter name="strPassCode" type="string"/>
      <parameter name="lACDUserId" type="i8"/>
      <parameter name="lACDRequestId" type="i8"/>
      <parameter name="strRequestorANI" type="string"/>
    </event>
    <event name="CSRUnavailableNotify" display="CSRUnavailableNotify" >
      <parameter name="strACDControllerIP" type="string"/>
      <parameter name="nACDControllerPort" type="i4"/>
      <parameter name="strTransactionId" type="string"/>
      <parameter name="lCSRUserId" type="i8"/>
      <parameter name="strCSRType" type="string"/>
      <parameter name="strStateTime" type="string"/>
      <parameter name="nResultCode" type="i4"/>
      <parameter name="strResultMsg" type="string"/>
    </event>
    <event name="CancelDialOutCSRRequest" display="CancelDialOutCSRRequest" >
      <parameter name="strACDControllerIP" type="string"/>
      <parameter name="nACDControllerPort" type="i4"/>
      <parameter name="strTransactionId" type="string"/>
    </event>
    <event name="ConfJoinEventResponse" display="ConfJoinEventResponse" >
      <parameter name="strConfControllerIP" type="string"/>
      <parameter name="nConfControllerPort" type="i4"/>
      <parameter name="strTransactionId" type="string"/>
      <parameter name="strWFM" type="string"/>
      <parameter name="strMediaServerEndPoint" type="string"/>
      <parameter name="strCustomerConferenceId" type="string"/>
      <parameter name="strCCGeneratedPassCode" type="string"/>
      <parameter name="strFirstCallerFlag" type="string"/>
    </event>
    <event name="BeginCSRConsultNotify" display="OnBeginCSRConsultNotify" >
      <parameter name="strACDControllerIP" type="string"/>
      <parameter name="nACDControllerPort" type="i4"/>
      <parameter name="strTransactionId" type="string"/>
      <parameter name="strCSRName" type="string"/>
    </event>
    <event name="EndCSRConsultNotify" display="OnEndCSRConsultNotify" >
      <parameter name="strACDControllerIP" type="string"/>
      <parameter name="nACDControllerPort" type="i4"/>
      <parameter name="strTransactionId" type="string"/>
      <parameter name="strHangupNow" type="string"/>
    </event>
    <event name="CSRChangeCoachingModeRequest" display="CSRChangeCoachingModeRequest" >
      <parameter name="strACDControllerIP" type="string"/>
      <parameter name="nACDControllerPort" type="i4"/>
      <parameter name="strTransactionId" type="string"/>
      <parameter name="strCoachingMode" type="string"/>
      <parameter name="strCoacheeConnection" type="string"/>
    </event>
    <event name="CSRBeginPrivateTalkRequest" display="CSRBeginPrivateTalkRequest" >
      <parameter name="strCCIP" type="string"/>
      <parameter name="nCCPort" type="i4"/>
      <parameter name="strTransactionId" type="string"/>
      <parameter name="lConferenceId" type="i8"/>
      <parameter name="strCCGeneratedPasscode" type="string"/>
    </event>
    <event name="CSREndPrivateTalkRequest" display="CSREndPrivateTalkRequest" >
      <parameter name="strCCIP" type="string"/>
      <parameter name="nCCPort" type="i4"/>
      <parameter name="strTransactionId" type="string"/>
      <parameter name="nActionCode" type="i4"/>
      <parameter name="strSendResponseBackFlag" type="string"/>
      <parameter name="nConfStatus" type="i4"/>
      <parameter name="lPartySchedId" type="i8"/>
      <parameter name="strPartyDetail" type="string"/>
      <parameter name="p_nAudioMode" type="i4"/>
      <parameter name="strSubConferenceId" type="string"/>
    </event>
    <event name="ConfLeaveEventResponse" display="ConfLeaveEventResponse" >
      <parameter name="strConferenceControllerIP" type="string"/>
      <parameter name="nConferenceControllerPort" type="i4"/>
      <parameter name="strTransactionId" type="string"/>
      <parameter name="strDeleteSubConfFlag" type="string"/>
    </event>
    <event name="ConfAddToSubConfRequest" display="ConfAddToSubConfRequest" >
      <parameter name="p_strConfControllerIP" type="string"/>
      <parameter name="p_nConfControllerPort" type="i4"/>
      <parameter name="p_strTransactionId" type="string"/>
      <parameter name="p_strCallerPassCode" type="string"/>
      <parameter name="p_strSubConfId" type="string"/>
      <parameter name="p_strSubConfModeratorFlag" type="string"/>
      <parameter name="p_strSubConferenceEndPoint" type="string"/>
      <parameter name="p_nAudioMode" type="i4"/>
    </event>
    <event name="ConfRemoveFromSubConfRequest" display="ConfRemoveFromSubConfRequest" >
      <parameter name="p_strConfControllerIP" type="string"/>
      <parameter name="p_nConfControllerPort" type="i4"/>
      <parameter name="p_strTransactionId" type="string"/>
      <parameter name="p_strCallerPassCode" type="string"/>
      <parameter name="p_strDeleteSubConferenceFlag" type="string"/>
      <parameter name="p_nAudioMode" type="i4"/>
    </event>
    <event name="CSRMicOffRequest" display="CSRMicOffRequest" >
      <parameter name="strAcdControllerIP" type="string"/>
      <parameter name="nAcdControllerPort" type="i4"/>
      <parameter name="strTransactionId" type="string"/>
    </event>
    <event name="CSRMicOnRequest" display="CSRMicOnRequest" >
      <parameter name="strAcdControllerIP" type="string"/>
      <parameter name="nAcdControllerPort" type="i4"/>
      <parameter name="strTransactionId" type="string"/>
    </event>
    <event name="ConfAudioModeChangeRequest" display="ConfAudioModeChangeRequest" >
      <parameter name="strConfControllerIP" type="string"/>
      <parameter name="nConfControllerPort" type="i4"/>
      <parameter name="strTransactionId" type="string"/>
      <parameter name="nFromMode" type="i4"/>
      <parameter name="nToMode" type="i4"/>
      <parameter name="strNotifyMS" type="string"/>
    </event>
    <event name="ConfPartyStatusChangeRequest" display="ConfPartyStatusChangeRequest" >
      <parameter name="strConfControllerIP" type="string"/>
      <parameter name="nConfControllerPort" type="i4"/>
      <parameter name="strTransactionId" type="string"/>
      <parameter name="nStatus" type="i4"/>
    </event>
  </events>
  <global-handlers >
    <handler event="Pactolus.EveSipInvite.1" function="OnInvite" public="1" always-on="0"/>
    <handler event="Pactolus.EveSipBye.1" function="OnBye" public="0" always-on="0"/>
    <handler event="Pactolus.EveSipCancel.1" function="OnCancel" public="0" always-on="0"/>
    <handler event="Standard.OnServiceLoad.1" function="OnServiceLoad" public="0" always-on="0"/>
    <handler event="Standard.OnSessionEnd.1" function="OnSessionEnd" public="0" always-on="0"/>
    <handler event="Standard.OnTimer.1" function="OnTimer" public="0" always-on="0"/>
    <handler event="Pactolus.EveSipInfo.1" function="OnInfo" public="0" always-on="0"/>
    <handler event="Pactolus.EveSipOptions.1" function="OnOptions" public="0" always-on="0"/>
    <handler event="LoginCSRGUINotify" function="OnLoginCSRGUINotify" public="0" always-on="0"/>
    <handler event="AddCSRToConf" function="OnAddCSRToConf" public="0" always-on="0"/>
    <handler event="RemoveCSRFromConf" function="OnRemoveCSRFromConf" public="0" always-on="0"/>
    <handler event="LogoutCSRGUINotify" function="OnLogoutCSRGUINotify" public="0" always-on="0"/>
    <handler event="CSRBeginAssignment" function="OnCSRBeginAssignment" public="0" always-on="0"/>
    <handler event="CSREndAssignment" function="OnCSREndAssignment" public="0" always-on="0"/>
    <handler event="ModeratorJoinRequest" function="OnModeratorJoinRequest" public="0" always-on="0"/>
    <handler event="Ping" function="OnPing" public="0" always-on="0"/>
    <handler event="DialOutCSR" function="OnDialOutCSR" public="1" always-on="0"/>
    <handler event="CSRUnavailableNotify" function="OnCSRUnavailableNotify" public="0" always-on="0"/>
    <handler event="CancelDialOutCSRRequest" function="OnCancelDialOutCSRRequest" public="0" always-on="0"/>
    <handler event="ConfJoinEventResponse" function="OnConfJoinEventResponse" public="0" always-on="0"/>
    <handler event="BeginCSRConsultNotify" function="OnBeginCSRConsultNotify" public="1" always-on="0"/>
    <handler event="EndCSRConsultNotify" function="OnEndCSRConsultNotify" public="1" always-on="0"/>
    <handler event="CSRChangeCoachingModeRequest" function="OnCSRChangeCoachingModeRequest" public="0" always-on="0"/>
    <handler event="CSRBeginPrivateTalkRequest" function="OnCSRBeginPrivateTalkRequest" public="0" always-on="0"/>
    <handler event="CSREndPrivateTalkRequest" function="OnCSREndPrivateTalkRequest" public="0" always-on="0"/>
    <handler event="ConfAddToSubConfRequest" function="OnConfAddToSubConfRequest" public="0" always-on="0"/>
    <handler event="ConfRemoveFromSubConfRequest" function="OnConfRemoveFromSubConfRequest" public="0" always-on="0"/>
    <handler event="CSRMicOffRequest" function="OnCSRMicOffRequest" public="0" always-on="0"/>
    <handler event="CSRMicOnRequest" function="OnCSRMicOnRequest" public="0" always-on="0"/>
    <handler event="ConfAudioModeChangeRequest" function="OnConfAudioModeChangeRequest" public="0" always-on="0"/>
    <handler event="ConfPartyStatusChangeRequest" function="OnConfPartyStatusChangeRequest" public="0" always-on="0"/>
  </global-handlers>
  <global-vars >
    <var name="g_oCallLegA" type="object" ></var>
    <var name="g_bSessionInUsed" type="boolean" >0</var>
    <var name="g_strContact" type="string" ></var>
    <var name="g_nCurrentState" type="i4" >0</var>
    <var name="g_oMS" type="object" ></var>
    <var name="g_strPassword" type="string" ></var>
    <var name="g_strLanguage" type="string" >eng</var>
    <var name="g_bNullString" type="boolean" >0</var>
    <var name="g_strTerminationDigit" type="string" ></var>
    <var name="g_strACDControllerIP" type="string" ></var>
    <var name="g_nACDControllerPort" type="i4" >0</var>
    <var name="g_strTransactionId" type="string" >0</var>
    <var name="g_strDBName" type="string" >pactolusdb</var>
    <var name="g_strSessionId" type="string" ></var>
    <var name="g_strOriginationNumber" type="string" ></var>
    <var name="g_nNbrLoginAttempts" type="i4" >2</var>
    <var name="g_lACDUserId" type="i8" >0</var>
    <var name="g_nGroupId" type="i4" >0</var>
    <var name="g_nInitialState" type="i4" >0</var>
    <var name="g_strCSRType" type="string" ></var>
    <var name="g_strFirstName" type="string" ></var>
    <var name="g_strLastName" type="string" ></var>
    <var name="g_strWorkstationPhoneNbr" type="string" ></var>
    <var name="g_nPrimaryLanguageId" type="i4" >0</var>
    <var name="g_nPrimarySkillId" type="i4" >0</var>
    <var name="g_nTerminationReason" type="i4" >0</var>
    <var name="g_nErrorMsgNumber" type="i4" >0</var>
    <var name="g_strEventReceived" type="string" ></var>
    <var name="g_strConfEventId" type="string" ></var>
    <var name="g_strConferencePasscode" type="string" ></var>
    <var name="g_strOperatorFlag" type="string" >T</var>
    <var name="g_strDestNbr" type="string" ></var>
    <var name="g_nAccessNumberId" type="i4" >0</var>
    <var name="g_lServiceProviderId" type="i8" >0</var>
    <var name="g_strRetryFlag" type="string" >F</var>
    <var name="g_nMaxRetryAllowed" type="i4" >3</var>
    <var name="g_strOrigDomIntlFlag" type="string" >D</var>
    <var name="g_nOrigCountryId" type="i4" >232</var>
    <var name="g_strInfoDigits" type="string" ></var>
    <var name="g_strSIPStatus" type="string" ></var>
    <var name="g_lStartTime" type="i8" >0</var>
    <var name="g_strGWIPIngress" type="string" ></var>
    <var name="g_nGWPortIngress" type="i4" >0</var>
    <var name="g_strGWIPEgress" type="string" ></var>
    <var name="g_nGWPortEgress" type="i4" >0</var>
    <var name="g_nRtpEncoding" type="i4" >0</var>
    <var name="g_nRtpClockRate" type="i4" >0</var>
    <var name="g_nCallMode" type="i4" >1</var>
    <var name="g_strOutdialFlag" type="string" >F</var>
    <var name="g_strOrigCallingCode" type="string" >1</var>
    <var name="g_strOrigAreaCode" type="string" >617</var>
    <var name="g_strDestDomIntlFlag" type="string" ></var>
    <var name="g_nDestCountryId" type="i4" >0</var>
    <var name="g_strDestCallingCode" type="string" ></var>
    <var name="g_strDestAreaCode" type="string" ></var>
    <var name="g_strSPTimeZone" type="string" >-6</var>
    <var name="g_strModOutdialFlag" type="string" >F</var>
    <var name="g_nScheduleDuration" type="i4" >0</var>
    <var name="g_strScheduleStartTime" type="string" ></var>
    <var name="g_lTimeAvailable" type="i8" >0</var>
    <var name="g_strConfScheduleId" type="string" ></var>
    <var name="g_strCallLegId" type="string" ></var>
    <var name="g_strConfResource" type="string" ></var>
    <var name="g_strModeratorFlag" type="string" >F</var>
    <var name="g_strConfControllerIP" type="string" ></var>
    <var name="g_nConfControllerPort" type="i4" >0</var>
    <var name="g_strCallerFirstName" type="string" ></var>
    <var name="g_strCallerLastName" type="string" ></var>
    <var name="g_strCallerOrg" type="string" ></var>
    <var name="g_strPartyPasscodeFlag" type="string" >F</var>
    <var name="g_strMuteFlag" type="string" >F</var>
    <var name="g_nMaxCallerHoldTime" type="i4" >0</var>
    <var name="g_strPostPinPromptType" type="string" ></var>
    <var name="g_nPostPinPromptIndex" type="i4" >0</var>
    <var name="g_strPostPinPromptUrl" type="string" ></var>
    <var name="g_nServiceId" type="i4" >0</var>
    <var name="g_strModeratorRequiredFlag" type="string" >F</var>
    <var name="g_strBillingCodeFlag" type="string" ></var>
    <var name="g_strRecordNamesFlag" type="string" >F</var>
    <var name="g_nArriveDepartOption" type="i4" >0</var>
    <var name="g_nBillingType" type="i4" >0</var>
    <var name="g_fPrepaidBalance" type="float" >0</var>
    <var name="g_nCurrencyId" type="i4" >0</var>
    <var name="g_lSubscriberId" type="i8" >0</var>
    <var name="g_strExistingCallLegId" type="string" ></var>
    <var name="g_strExistingSessionId" type="string" ></var>
    <var name="g_strCallerRecordedName" type="string" ></var>
    <var name="g_lMSConnectTime" type="i8" >0</var>
    <var name="g_bSubscriberConference" type="boolean" >0</var>
    <var name="g_lEndTime" type="i8" >0</var>
    <var name="g_strIntlPrependFlag" type="string" >F</var>
    <var name="g_strAccessNumber" type="string" ></var>
    <var name="g_bFirstCaller" type="boolean" >0</var>
    <var name="g_lHoldTimerId" type="i8" >0</var>
    <var name="g_bHoldTimerFlag" type="boolean" >0</var>
    <var name="g_strHoldBillingFlag" type="string" ></var>
    <var name="g_strRechargeFlag" type="string" ></var>
    <var name="g_nSubExpirationType" type="i4" >0</var>
    <var name="g_nOfferingId" type="i4" >0</var>
    <var name="g_nRoundSeconds" type="i4" >0</var>
    <var name="g_bHearbeatTimerFlag" type="boolean" >0</var>
    <var name="g_lHeartbeatTimerId" type="i8" >0</var>
    <var name="g_strSoapAddress" type="string" ></var>
    <var name="g_strSubscriberAccount" type="string" ></var>
    <var name="g_strPlayPartyCountFlag" type="string" ></var>
    <var name="g_nCurrentNbrCallegs" type="i4" >0</var>
    <var name="g_nDialPlanId" type="i4" >0</var>
    <var name="g_lWaitCSRLoginGUITimerId" type="i8" >0</var>
    <var name="g_strIsSubscriberFlag" type="string" ></var>
    <var name="g_strSetStateToGetConfRes" type="string" >F</var>
    <var name="g_lHoldWFMStartTime" type="i8" >0</var>
    <var name="g_lOutdialConnectTime" type="i8" >0</var>
    <var name="g_lOutdialStartTime" type="i8" >0</var>
    <var name="g_lPartyJoinTime" type="i8" >0</var>
    <var name="g_strConfSessionId" type="string" ></var>
    <var name="g_bGotCSRBeginAssignment" type="boolean" >0</var>
    <var name="g_nPayphoneSrchgRateId" type="i4" >0</var>
    <var name="g_fPayphoneSrchgRateAmt" type="float" >0</var>
    <var name="g_nAccessNumberRateId" type="i4" >0</var>
    <var name="g_fAccessNumberRateAmt" type="float" >0</var>
    <var name="g_nAccessNumberRateType" type="i4" >0</var>
    <var name="g_nMeteredRate1Id" type="i4" >0</var>
    <var name="g_fMeteredRate1Amt" type="float" >0</var>
    <var name="g_nMeteredRate2Id" type="i4" >0</var>
    <var name="g_fMeteredRate2Amt" type="float" >0</var>
    <var name="g_nFixedRate1Id" type="i4" >0</var>
    <var name="g_fFixedRate1Amt" type="float" >0</var>
    <var name="g_nFixedRate2Id" type="i4" >0</var>
    <var name="g_fFixedRate2Amt" type="float" >0</var>
    <var name="g_fTotalMeteredRate" type="float" >0</var>
    <var name="g_fTotalFixedRate" type="float" >0</var>
    <var name="g_strForceModeratorFlag" type="string" >F</var>
    <var name="g_strForceMuteFlag" type="string" >F</var>
    <var name="g_strPromptOnOutdialFlag" type="string" ></var>
    <var name="g_strAutoRecordFlag" type="string" ></var>
    <var name="g_strConfRecordAllowed" type="string" ></var>
    <var name="g_strHomeCallingCode" type="string" ></var>
    <var name="g_nHomeCountryId" type="i4" >0</var>
    <var name="g_nSubTimeZoneId" type="i4" >0</var>
    <var name="g_strOutdialCLI" type="string" ></var>
    <var name="g_strUsedDefaultANIFlag" type="string" >F</var>
    <var name="g_bMustWriteCDR" type="boolean" >0</var>
    <var name="g_strDialOutExtNbr" type="string" ></var>
    <var name="g_lDialOutRequestId" type="i8" >0</var>
    <var name="g_nReturnCode" type="i4" >0</var>
    <var name="g_strReturnMsg" type="string" ></var>
    <var name="g_bOutDialCSR" type="boolean" >0</var>
    <var name="g_strDialType" type="string" >I</var>
    <var name="g_nAttendeeId" type="i4" >0</var>
    <var name="g_strAnonymousAttendeeId" type="string" ></var>
    <var name="g_nOperatorAssistType" type="i4" >0</var>
    <var name="g_strCustomerConferenceId" type="string" ></var>
    <var name="g_bGotCSRCancelOutdial" type="boolean" >0</var>
    <var name="g_strQuickStartFlag" type="string" >F</var>
    <var name="g_lPrivateTalkStartTime" type="i8" >0</var>
    <var name="g_lPrivateTalkEndTime" type="i8" >0</var>
    <var name="g_strMSResourceName" type="string" ></var>
    <var name="g_strResponseTransactionId" type="string" ></var>
    <var name="g_bConfControllerGeneratedPCode" type="boolean" >0</var>
    <var name="g_nRedirectStatus" type="i4" >0</var>
    <var name="g_strAlternateSiteIP" type="string" ></var>
    <var name="g_nAlternateSitePort" type="i4" >0</var>
    <var name="g_strConfSiteMovedFlag" type="string" ></var>
    <var name="g_strCCIPMovedFrom" type="string" ></var>
    <var name="g_nCCPortMovedFrom" type="i4" >0</var>
    <var name="g_strCCIPMovedTo" type="string" ></var>
    <var name="g_nCCPortMovedTo" type="i4" >0</var>
    <var name="g_nPrompt" type="i4" >0</var>
    <var name="g_oTEST" type="object" ></var>
    <var name="g_strPassCode" type="string" ></var>
    <var name="g_strMSResource" type="string" ></var>
    <var name="g_bAlreadyInitMS" type="boolean" >0</var>
    <var name="g_lACDRequestId" type="i8" >0</var>
    <var name="g_bRecordedOutdialAttempt" type="boolean" >0</var>
    <var name="g_strZeroTransactionId" type="string" >0</var>
    <var name="g_bPlayTone" type="boolean" >0</var>
    <var name="g_strModeratorMutedFlag" type="string" ></var>
    <var name="g_nMinutesTooEarly" type="i4" >0</var>
    <var name="g_nOutdialOption" type="i4" >0</var>
    <var name="g_strMutedPartyPassCode" type="string" ></var>
    <var name="g_strReservationlessFlag" type="string" ></var>
    <var name="g_nReleaseToConfStatus" type="i4" >0</var>
    <var name="g_oPrivateTalkMS" type="object" ></var>
    <var name="g_bSentConfJoinEvent" type="boolean" >0</var>
    <var name="g_bBeginPrivateTalk" type="boolean" >0</var>
    <var name="g_lConferenceId" type="i8" >0</var>
    <var name="g_strCCGeneratedPasscode" type="string" ></var>
    <var name="g_nEventDnisType" type="i4" >0</var>
    <var name="g_lPartySchedId" type="i8" >0</var>
    <var name="g_strPartyDetail" type="string" ></var>
    <var name="g_nDefaultAudioMode" type="i4" >0</var>
    <var name="g_strPlayFirstCaller" type="string" ></var>
    <var name="g_oSubConfMS" type="object" ></var>
    <var name="g_bCurrentlyInSubConf" type="boolean" >0</var>
    <var name="g_lSubConferenceJoinTime" type="i8" >0</var>
    <var name="g_strMediaServerIP" type="string" ></var>
    <var name="g_bCSRMicOn" type="boolean" >0</var>
    <var name="g_strHoldFlag" type="string" >F</var>
    <var name="g_nConfLeaveReason" type="i4" >0</var>
    <var name="g_strConfLeaveMsg" type="string" ></var>
    <var name="g_strSubConferenceId" type="string" ></var>
    <var name="g_strTransferInOutFlag" type="string" ></var>
    <var name="g_strModReAuthFlag" type="string" >F</var>
    <var name="g_nPasscodeScheme" type="i4" >0</var>
    <var name="g_nCurrNbrMods" type="i4" >0</var>
    <var name="g_strGlobalMusicOnFlag" type="string" ></var>
    <var name="g_bNoCreateConfFirstCaller" type="boolean" >0</var>
    <var name="g_bNotifyCCAudioModeChange" type="boolean" >0</var>
  </global-vars>
  <shared-vars >
    <var name="s_strLocalHost" type="string" ></var>
    <var name="s_nTIMEOUT" type="i4" >45</var>
    <var name="s_strSIPVERSION" type="string" >SIP/2.0</var>
    <var name="s_nPacketizationPeriod" type="i4" >0</var>
    <var name="s_strMSType" type="string" ></var>
    <var name="s_strMSRetryFlag" type="string" ></var>
    <var name="s_nSTATE_DIRECT_TO_MS" type="i4" >1</var>
    <var name="s_nSTATE_COLLECT_PASSWORD" type="i4" >2</var>
    <var name="s_nSTATE_SEND_LOGIN" type="i4" >3</var>
    <var name="s_nSTATE_WAIT_RESPONSE" type="i4" >4</var>
    <var name="s_nSTATE_SEND_LOGOUT" type="i4" >5</var>
    <var name="s_nSTATE_END_CALL" type="i4" >11</var>
    <var name="s_nSUCCESS" type="i4" >0</var>
    <var name="s_nFAILURE" type="i4" >-1</var>
    <var name="s_nCALLERHUNGUP" type="i4" >-2</var>
    <var name="s_nSTATE_HANGUP_CALLER" type="i4" >10</var>
    <var name="s_nMAXLOGINATTEMPS" type="i4" >3</var>
    <var name="s_nSoapPort" type="i4" >0</var>
    <var name="s_strSoapIP" type="string" ></var>
    <var name="s_strMSG_LOGIN_REQUEST" type="string" >LoginCSRIVR</var>
    <var name="s_strMSG_LOGIN_RESPONSE" type="string" >LoginCSRIVRResponse</var>
    <var name="s_strMSG_LOGOUT_REQUEST" type="string" >LogoutCSRIVR</var>
    <var name="s_strApplicationName" type="string" ></var>
    <var name="s_nSTATE_WAIT_GUI_LOGIN" type="i4" >6</var>
    <var name="s_nGUI_LOGIN" type="i4" >1</var>
    <var name="s_nSTATE_WAIT_ASSIGNMENT" type="i4" >7</var>
    <var name="s_strContentType" type="string" >application/sdp</var>
    <var name="s_strCONF_JOIN" type="string" >ConfJoinEvent</var>
    <var name="s_strEMPTY_STRING" type="string" ></var>
    <var name="s_strCONF_LEAVE" type="string" >ConfLeaveEvent</var>
    <var name="s_nSTATE_ADD_TO_CONF" type="i4" >8</var>
    <var name="s_nSTATE_REMOVE_FROM_CONF" type="i4" >9</var>
    <var name="s_strDEFAULT_ANI" type="string" ></var>
    <var name="s_nFIRSTCALLER" type="i4" >1</var>
    <var name="s_nSLEEPTIME" type="i4" >20</var>
    <var name="s_nHEARTBEATTIME" type="i4" >300</var>
    <var name="s_nPROMPT_JOIN_TONE" type="i4" >228</var>
    <var name="s_nPROMPT_DEPART_TONE" type="i4" >225</var>
    <var name="s_strOutdialDialingPlan" type="string" ></var>
    <var name="s_nWAIT_CSR_LOGIN_GUI" type="i4" >3600</var>
    <var name="s_strADD_CSR_TO_CONF" type="string" >AddCSRToConfResponse</var>
    <var name="s_strEND_ASSIGNMENT_RES" type="string" >CSREndAssignmentResponse</var>
    <var name="s_strSessionTimerFlag" type="string" ></var>
    <var name="s_nSessionTimerInterval" type="i4" >0</var>
    <var name="s_nRING_NO_ANSWER_TIME" type="i4" >0</var>
    <var name="s_strPrimaryPSX" type="string" ></var>
    <var name="s_strBackupPSX" type="string" ></var>
    <var name="s_strCodec" type="string" ></var>
    <var name="s_strDigitPrependToOutdial" type="string" ></var>
    <var name="s_strIVR_MS_Type" type="string" ></var>
    <var name="s_strMOH_MS_Type" type="string" ></var>
    <var name="s_strConf_MS_Type" type="string" ></var>
    <var name="s_nSiteId" type="i4" >0</var>
    <var name="s_nConferenceMaxTalkers" type="i4" >0</var>
    <var name="s_nConferenceMaxParties" type="i4" >0</var>
    <var name="s_strTestModeFlag" type="string" ></var>
    <var name="s_strACDMediaServerType" type="string" ></var>
    <var name="s_nCSRPasscodeLength" type="i4" >0</var>
    <var name="s_strCSRBeginPrivateTalkResponse" type="string" >CSRBeginPrivateTalkResponse</var>
    <var name="s_strCSREndPrivateTalkResponse" type="string" >CSREndPrivateTalkResponse</var>
    <var name="s_strCSRPrivateTalkHangup" type="string" >CSRPrivateTalkHangup</var>
    <var name="s_strPLAY_BRIDGE_TONE" type="string" >T</var>
    <var name="s_strACDCodec" type="string" ></var>
    <var name="s_strConfPartyStatusChangeRs" type="string" >ConfPartyStatusChangeResponse</var>
    <var name="s_nMaxActiveSpeakers" type="i4" >0</var>
    <var name="s_nNbrActiveSpeakers" type="i4" >0</var>
    <var name="s_nReportingInterval" type="i4" >0</var>
    <var name="s_nDBThreshold" type="i4" >-96</var>
    <var name="s_nAGCTargetLevelIn" type="i4" >-9</var>
    <var name="s_nAGCMaxLevelIn" type="i4" >0</var>
    <var name="s_nAGCTargetLevelOut" type="i4" >-9</var>
    <var name="s_nAGCMaxLevelOut" type="i4" >0</var>
  </shared-vars>
  <functions >
    <function name="OnServiceLoad" start="1" event="OnServiceLoad" returns="void" >
      <parameters >
        <parameter name="strAppName" type="string" pass="byref"/>
        <parameter name="nSessionCount" type="i2" pass="byref"/>
        <parameter name="nMaxIterations" type="i2" pass="byref"/>
        <parameter name="nServerId" type="i2" pass="byref"/>
      </parameters>
      <actions >
        <action id="1" plug-in="Pactolus.UserFunction.1" ><?xtml-editor x=151 y=188 ?>
          <!--GET PSX IP from config-->
          <user-function xmlns="urn:www.pactolus.com:xtml:application" process="&quot;PACTOLUS_ps_c_adaptor&quot;" function="&quot;get_property&quot;" timeout="s_nTIMEOUT" return="" async="0" >
            <parameter >"appserver-logical-ip"</parameter>
            <parameter >s_strLocalHost</parameter>
            <parameter >"packetization-period"</parameter>
            <parameter >s_nPacketizationPeriod</parameter>
            <parameter >"media-server-type"</parameter>
            <parameter >s_strMSType</parameter>
            <parameter >"ivr-media-server-type"</parameter>
            <parameter >s_strIVR_MS_Type</parameter>
            <parameter >"music-on-hold-media-server-type"</parameter>
            <parameter >s_strMOH_MS_Type</parameter>
            <parameter >"conferencing-media-server-type"</parameter>
            <parameter >s_strConf_MS_Type</parameter>
            <parameter >"ms-connect-retry"</parameter>
            <parameter >s_strMSRetryFlag</parameter>
            <parameter >"outdial-dialing-plan"</parameter>
            <parameter >s_strOutdialDialingPlan</parameter>
            <parameter >"primary-softswitch"</parameter>
            <parameter >s_strPrimaryPSX</parameter>
            <parameter >"backup-softswitch"</parameter>
            <parameter >s_strBackupPSX</parameter>
            <parameter >"ring-no-answer-time"</parameter>
            <parameter >s_nRING_NO_ANSWER_TIME</parameter>
            <parameter >"session-timer-interval"</parameter>
            <parameter >s_nSessionTimerInterval</parameter>
            <parameter >"session-timer-enabled"</parameter>
            <parameter >s_strSessionTimerFlag</parameter>
            <parameter >"codec"</parameter>
            <parameter >s_strCodec</parameter>
            <parameter >"prepend-to-outdial"</parameter>
            <parameter >s_strDigitPrependToOutdial</parameter>
            <parameter >"site-id"</parameter>
            <parameter >s_nSiteId</parameter>
            <parameter >"csr-default-ani"</parameter>
            <parameter >s_strDEFAULT_ANI</parameter>
            <parameter >"acd-media-server-type"</parameter>
            <parameter >s_strACDMediaServerType</parameter>
            <parameter >"csr-ivr-passcode-length"</parameter>
            <parameter >s_nCSRPasscodeLength</parameter>
            <parameter >"acd-play-bridge-tone"</parameter>
            <parameter >s_strPLAY_BRIDGE_TONE</parameter>
            <parameter >"acd-codec"</parameter>
            <parameter >s_strACDCodec</parameter>
            <parameter >"number-active-speaker-report"</parameter>
            <parameter >s_nMaxActiveSpeakers</parameter>
            <parameter >"asn-max-speakers"</parameter>
            <parameter >s_nNbrActiveSpeakers</parameter>
            <parameter >"asn-reporting-interval"</parameter>
            <parameter >s_nReportingInterval</parameter>
            <parameter >"asn-threshold-db"</parameter>
            <parameter >s_nDBThreshold</parameter>
            <parameter >"conference-max-parties"</parameter>
            <parameter >s_nConferenceMaxParties</parameter>
            <parameter >"conference-max-talkers"</parameter>
            <parameter >s_nConferenceMaxTalkers</parameter>
            <parameter >"target-agc-level-in"</parameter>
            <parameter >s_nAGCTargetLevelIn</parameter>
            <parameter >"max-agc-level-in"</parameter>
            <parameter >s_nAGCMaxLevelIn</parameter>
            <parameter >"target-agc-level-out"</parameter>
            <parameter >s_nAGCTargetLevelOut</parameter>
            <parameter >"max-agc-level-out"</parameter>
            <parameter >s_nAGCMaxLevelOut</parameter>
          </user-function>
          <results >
            <result name="Default" link="4" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: OnServiceLoad");]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Session.s_strLocalHost.length <= 0)
{
	Session.s_strLocalHost = Server.ipAddress;
	Server.logInfo("WARNING:  NO SETTING FOR LOCAL HOST IP ADDRESS.  USE DEFAULT: " + Session.s_strLocalHost);
} else {
	js_resolve_address(Session.s_strLocalHost);
	Server.logInfo("s_strLocalHost after calling js_resolve_address: " + Session.s_strLocalHost);
}



if (Session.s_strMSType.length <= 0 && Session.s_strIVR_MS_Type.length > 0)
{
	Session.s_strMSType = Session.s_strIVR_MS_Type;

}
else if (Session.s_strIVR_MS_Type.length <= 0 && Session.s_strMSType.length > 0)
{
	Session.s_strIVR_MS_Type = Session.s_strMSType;
}
else if (Session.s_strMSType.length <= 0 && Session.s_strIVR_MS_Type.length <= 0)
{
	Session.s_strIVR_MS_Type = "CONV";
	Server.logInfo("WARNING:  NO SETTING FOR IVR MEDIASERVER TYPE.  USE DEFAULT: CONV");
	Session.s_strMSType = "CONV";
	Server.logInfo("WARNING:  NO SETTING FOR MEDIASERVER TYPE.  USE DEFAULT: CONV");
}
if (Session.s_strMOH_MS_Type.length <= 0)
{
	Session.s_strMOH_MS_Type = Session.s_strMSType;
	Server.logInfo("WARNING:  NO SETTING FOR MOH MEDIASERVER TYPE.  USE s_strMSType");
}
if (Session.s_strConf_MS_Type.length <= 0)
{
	Session.s_strConf_MS_Type = Session.s_strMSType;
	Server.logInfo("WARNING:  NO SETTING FOR CONFERENCING MEDIASERVER TYPE.  USE s_strMSType");
}
if (Session.s_strACDMediaServerType.length <= 0)
{
	Session.s_strACDMediaServerType = Session.s_strMSType;
	Server.logInfo("WARNING:  NO SETTING FOR ACD MEDIASERVER TYPE.  USE s_strMSType");
}
if (Session.s_nPacketizationPeriod <= 0)
{
	Session.s_nPacketizationPeriod = 20;
	Server.logInfo("WARNING:  NO SETTING FOR PACKETIZATION PERIOD.  USE DEFAULT: 20");
}
if (Session.s_strMSRetryFlag.length <= 0)
{
	Session.s_strMSRetryFlag = "F";
	Server.logInfo("WARNING:  NO SETTING FOR CONNECT TO MS RETRY.  USE DEFAULT: F");
}
if (Session.s_strOutdialDialingPlan.length <= 0)
{
	Session.s_strOutdialDialingPlan = 1;
	Server.logInfo("WARNING:  NO SETTING FOR DIALING PLAN.  USE DEFAULT: 1");
}
if (Session.s_strCodec.length <= 0)
{
	Session.s_strCodec = "PCMU";
	Server.logInfo("WARNING: NO SETTING FOR CODEC.  USE DEFAULT: PCMU");
}

if (Session.s_strDEFAULT_ANI.length <= 0)
{
	Session.s_strDEFAULT_ANI = "5086160900";
	Server.logError("WARNING: NO SETTING FOR DEFAULT ANI.  USE DEFAULT OF: " + Session.s_strDEFAULT_ANI);
}
if (Session.s_nCSRPasscodeLength <= 0)
{
	Session.s_nCSRPasscodeLength = 10;
	Server.logError("WARNING: NO SETTING FOR DEFAULT CSR IVR PASSCODE LENGTH.  USE DEFAULT OF: " + Session.s_nCSRPasscodeLength);
}
if (Session.s_strPLAY_BRIDGE_TONE.length <= 0)
{
	Session.s_strPLAY_BRIDGE_TONE = "T";
	Server.logError("WARNING: NO SETTING FOR DEFAULT PLAY BRIDGE TONE.  USE DEFAULT OF: " + Session.s_strPLAY_BRIDGE_TONE);
}
if (Session.s_strACDCodec.length <= 0)
{
	Server.logInfo("WARNING: NO SETTING FOR ACD CODEC.  USE DEFAULT CODEC:" + Session.s_strCodec);
}
else
{
	Session.s_strCodec = Session.s_strACDCodec ;
	Server.logInfo("WARNING: OVERRIDING DEFAULT CODEC WITH ACD CODEC:" + Session.s_strACDCodec);
}
Server.logInfo("SERVER SOAP PORT IS: " + Server.soapPort);
Session.s_nSoapPort = Clib.atoi(Server.soapPort);
if (0 == Session.s_nSoapPort)
{
	Server.logError("ERROR: Server.soapPort IS ZERO");
	Server.logInfo("SET DEFAULT SOAP PORT TO 7581");
	Session.s_nSoapPort = 7581;
}
Server.logInfo("SOAP PORT IS : " + Session.s_nSoapPort);
Session.s_strSoapIP = Server.soapAddress;
Server.logInfo("SOAP IP IS: " + Session.s_strSoapIP);
Session.s_strApplicationName = Session._appName;

if (Session.s_nConferenceMaxParties <= 0)
{
	Session.s_nConferenceMaxParties = 125;
	Server.logInfo("WARNING: NO SETTING CONFERENCE MAX PARTIES.  USE DEFAULT: 125");
}
if (Session.s_nConferenceMaxTalkers <= 0)
{
	Session.s_nConferenceMaxTalkers = 16;
	Server.logInfo("WARNING: NO SETTING CONFERENCE MAX TALKERS.  USE DEFAULT: 16");
}
if (Session.s_nMaxActiveSpeakers <= 0)
{
	Session.s_nMaxActiveSpeakers = 3;
	Server.logInfo("WARNING: NO SETTING FOR s_nMaxActiveSpeakers.  USE DEFAULT: 3");
}
if (Session.s_nNbrActiveSpeakers <= 0)
{
	Session.s_nNbrActiveSpeakers = 3;
	Server.logInfo("WARNING: NO SETTING FOR s_NbrActiveSpeakers.  USE DEFAULT: 3");
}
if (Session.s_nDBThreshold <= -96)
{
	Session.s_nDBThreshold = -96;
	Server.logInfo("WARNING: NO SETTING FOR s_nDBThreshold.  USE DEFAULT: -96");
}
if (Session.s_nReportingInterval <= 0)
{
	Session.s_nReportingInterval = 5;
	Server.logInfo("WARNING: NO SETTING FOR s_nReportingInterval.  USE DEFAULT: 5");
}





]]></script>
          </scripts>
        </action>
        <action id="3" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=642 y=184 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value="0"/>
        </action>
        <action id="4" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=385 y=185 ?>
          <!--APIGetTestData-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;APIGetTestData&quot;" return="" external-function="1" library="lib_APISce.xml" >
            <parameter >g_oTEST</parameter>
          </function>
          <results >
            <result name="Default" link="3" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_initTEST(Session.g_oTEST);


]]></script>
            <script language="javascript" timing="last" ><![CDATA[Server.lockSharedVariables();
Session.s_strTestModeFlag = Session.g_oTEST.strConferenceTestFlag;
Server.unlockSharedVariables();]]></script>
          </scripts>
        </action>
      </actions>
    </function>
    <function name="OnInvite" start="3" event="OnInvite" returns="void" >
      <parameters >
        <parameter name="strAccept" type="string" pass="byref"/>
        <parameter name="strAcceptEncoding" type="string" pass="byref"/>
        <parameter name="strAcceptLanguage" type="string" pass="byref"/>
        <parameter name="strAlertInfo" type="string" pass="byref"/>
        <parameter name="strAllow" type="string" pass="byref"/>
        <parameter name="strAllowEvents" type="string" pass="byref"/>
        <parameter name="strAnonymity" type="string" pass="byref"/>
        <parameter name="strAuthorization" type="string" pass="byref"/>
        <parameter name="strCallId" type="string" pass="byref"/>
        <parameter name="strCallInfo" type="string" pass="byref"/>
        <parameter name="strContact" type="string" pass="byref"/>
        <parameter name="strContent" type="string" pass="byref"/>
        <parameter name="strContentDisposition" type="string" pass="byref"/>
        <parameter name="strContentEncoding" type="string" pass="byref"/>
        <parameter name="strContentLanguage" type="string" pass="byref"/>
        <parameter name="strContentType" type="string" pass="byref"/>
        <parameter name="strCSeq" type="string" pass="byref"/>
        <parameter name="strDate" type="string" pass="byref"/>
        <parameter name="strEncryption" type="string" pass="byref"/>
        <parameter name="strErrorInfo" type="string" pass="byref"/>
        <parameter name="strExpires" type="string" pass="byref"/>
        <parameter name="strFrom" type="string" pass="byref"/>
        <parameter name="strInReplyTo" type="string" pass="byref"/>
        <parameter name="strMaxForwards" type="string" pass="byref"/>
        <parameter name="strMIMEVersion" type="string" pass="byref"/>
        <parameter name="strMinSE" type="string" pass="byref"/>
        <parameter name="strOrganization" type="string" pass="byref"/>
        <parameter name="strPriority" type="string" pass="byref"/>
        <parameter name="strProxyAuthorization" type="string" pass="byref"/>
        <parameter name="strProxyRequire" type="string" pass="byref"/>
        <parameter name="strRecordRoute" type="string" pass="byref"/>
        <parameter name="strReferredBy" type="string" pass="byref"/>
        <parameter name="strRemotePartyId" type="string" pass="byref"/>
        <parameter name="strReplaces" type="string" pass="byref"/>
        <parameter name="strRequestUri" type="string" pass="byref"/>
        <parameter name="strRequire" type="string" pass="byref"/>
        <parameter name="strResponseKey" type="string" pass="byref"/>
        <parameter name="strRoute" type="string" pass="byref"/>
        <parameter name="strSessionExpires" type="string" pass="byref"/>
        <parameter name="strSubject" type="string" pass="byref"/>
        <parameter name="strSupported" type="string" pass="byref"/>
        <parameter name="strTimestamp" type="string" pass="byref"/>
        <parameter name="strTo" type="string" pass="byref"/>
        <parameter name="strUserAgent" type="string" pass="byref"/>
        <parameter name="strVia" type="string" pass="byref"/>
      </parameters>
      <actions >
        <action id="3" plug-in="Pactolus.Branch.1" ><?xtml-editor x=158 y=363 ?>
          <!--New Call?-->
          <results >
            <result name="Default" link="6" stubbed="0"/>
            <result name="session in used == true" link="5" stubbed="0" >g_bSessionInUsed == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: OnInvite");]]></script>
          </scripts>
        </action>
        <action id="5" plug-in="Pactolus.Branch.1" ><?xtml-editor x=434 y=219 ?>
          <!--re-INVITE-->
          <results >
            <result name="Default" link="11" stubbed="0"/>
            <result name="in conference or in ms == true" link="9" stubbed="0" >g_oMS.bCurrentlyInConf == true
OR g_oMS.bCurrentlyConnected == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[var newCSeq = new SipCSeq(Session.strCSeq);
var oldCSeq = new SipCSeq(Session.g_oCallLegA.strCSeq);

if(newCSeq.value >= oldCSeq.value) 
{
	newCSeq.increment() ;
	Session.g_oCallLegA.strCSeq = newCSeq.encode() ;
}]]></script>
          </scripts>
        </action>
        <action id="6" plug-in="Pactolus.Branch.1" ><?xtml-editor x=461 y=529 ?>
          <!--New Call
Save INFO-->
          <results >
            <result name="Default" link="12" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bSessionInUsed = true;	//this session is now in use, all invites must be reINVITE
Session.g_nCurrentState = Session.s_nSTATE_DIRECT_TO_MS;	//direct caller to MS
Session.g_strSessionId = Session._sessionId;
Session.g_strSoapAddress = Server.soapAddress;
Session.g_lStartTime = Server.getUTCTime();

// initialize phone A object
js_initCallLeg(Session.g_oCallLegA);

Session.g_oCallLegA.bReverseFromTo = true;
Session.g_oCallLegA.strFrom = Session.strFrom;
Session.g_oCallLegA.strTo = Session.strTo;
Session.g_oCallLegA.strCallId = Session.strCallId;
Session.g_oCallLegA.strContact = Session.strContact;
Session.g_oCallLegA.strContent = Session.strContent;
Session.g_oCallLegA.strOriginalContent = Session.strContent;
Session.g_oCallLegA.strContentType = Session.strContentType;
Session.g_oCallLegA.strCSeq = Session.strCSeq;
Session.g_oCallLegA.strRecordRoute = Session.strRecordRoute;
Session.g_oCallLegA.strRoute = Session.strRoute;
Session.g_oCallLegA.strVia = Session.strVia;
Session.g_oCallLegA.nSessionTimer = Number(Session.strSessionExpires);
Session.g_oCallLegA.nTearDownTime = 0;

//Ingress
var from_uri = new SipFrom( Session.strFrom ) ;
if (from_uri.url.host == undefined)
{
	Session.g_strGWIPIngress = Session.s_strPrimaryPSX;
}
else
{
	Session.g_strGWIPIngress = from_uri.url.host;
}
if (from_uri.url.port == undefined)
{
	Session.g_nGWPortIngress = 5060;
}
else
{
	Session.g_nGWPortIngress = from_uri.url.port;
}

Server.logInfo("CALLER CALL Id: " + Session.strCallId);
Server.logInfo("CALLING js_calculate_uri_and_route");
Server.logInfo("BEFORE contact: " + Session.g_oCallLegA.strContact);
Server.logInfo("BEFORE record route: " + Session.g_oCallLegA.strRecordRoute);
Server.logInfo("BEFORE request Uri: " + Session.g_oCallLegA.strRequestUri);
Server.logInfo("BEFORE route: " + Session.g_oCallLegA.strRoute);
var bDialIn = true;
js_calculate_uri_and_route(bDialIn, Session.s_strSIPVERSION, Session.g_oCallLegA.strFrom, Session.g_oCallLegA.strContact, Session.g_oCallLegA.strRecordRoute, Session.g_oCallLegA.strRequestUri, Session.g_oCallLegA.strRoute);
Server.logInfo("AFTER contact: " + Session.g_oCallLegA.strContact);
Server.logInfo("AFTER record route: " + Session.g_oCallLegA.strRecordRoute);
Server.logInfo("AFTER request Uri: " + Session.g_oCallLegA.strRequestUri);
Server.logInfo("AFTER route: " + Session.g_oCallLegA.strRoute);
Server.logInfo("Call leg A request Uri is: " + Session.g_oCallLegA.strRequestUri);

// if no ANI, use this default
if (from_uri.url.user == undefined)
{
	Session.g_strOriginationNumber = Session.s_strDEFAULT_ANI;
	Session.g_oCallLegA.strCallingNumber = Session.s_strDEFAULT_ANI;
	Session.g_strUsedDefaultANIFlag = "T";
}
else
{
	Session.g_oCallLegA.strCallingNumber = from_uri.url.user;
	Session.g_strOriginationNumber = from_uri.url.user;
	if (Session.g_strOriginationNumber.charAt(0) == "+")
	{
		Session.g_strIntlPrependFlag = "T";
	}
}

//Egress
var contact = new SipNameAddr(Session.strContact);
if (contact.url.host == undefined)
{
	Session.g_strGWIPEgress = Session.s_strPrimaryPSX;
}
else
{
	Session.g_strGWIPEgress = contact.url.host;
}
if (contact.url.port == undefined)
{
	Session.g_nGWPortEgress = 5060;
}
else
{
	Session.g_nGWPortEgress = contact.url.port;
}

Session.g_oCallLegA.strRequestUri = contact.url.toString() + " " + Session.s_strSIPVERSION;

// set server contact
Session.g_strContact = "sip:" + Session.s_strLocalHost;
if( Server.sipPort != 5060 )
{
 Session.g_strContact += ":" + Server.sipPort;
}


var to = new SipTo(Session.strTo);
Session.g_strAccessNumber = to.url.user;

if (false == Session.g_bAlreadyInitMS)
{
	js_initMS(Session.g_oMS, Session.s_strMSType);
	Session.g_oMS.strACDType = Session.s_strACDMediaServerType;
	Session.g_oMS.strConfType = Session.s_strConf_MS_Type;
	Session.g_oMS.nPacketizationPeriod = Session.s_nPacketizationPeriod;
	//ASN
	Session.g_oMS.nMaxActiveSpeakers = Session.s_nMaxActiveSpeakers;
	Session.g_oMS.nNbrActiveSpeakers = Session.s_nNbrActiveSpeakers;
	Session.g_oMS.nReportingInterval = Session.s_nReportingInterval;
	Session.g_oMS.nDBThreshold = Session.s_nDBThreshold;
	//AGC
	Session.g_oMS.nAGCTargetLevelIn = Session.s_nAGCTargetLevelIn;
	Session.g_oMS.nAGCMaxLevelIn = Session.s_nAGCMaxLevelIn;
	Session.g_oMS.nAGCTargetLevelOut = Session.s_nAGCTargetLevelOut;
	Session.g_oMS.nAGCMaxLevelOut = Session.s_nAGCMaxLevelOut;
	Session.g_bAlreadyInitMS = true;
}

//initialize media server object
Session.g_oMS.strEndPoint = "";
Session.g_oMS.strConnectionId = "";
Session.g_oMS.strCallId = "";
Session.g_oMS.strContent = "";
Session.g_oMS.strConferenceId = "";	//use through out
Session.g_oMS.strType = Session.s_strMSType;
Session.g_oMS.bMuteFlag = false;
Session.g_oMS.bDeafFlag = false;
Session.g_oMS.bCurrentlyInConf = false;
Session.g_oMS.bCurrentlyConnected = false;
Session.g_oMS.strCodec = Session.s_strCodec;
Session.g_oMS.bDTMFClampFlag = false;
//ASN
Session.g_oMS.nMaxActiveSpeakers = Session.s_nMaxActiveSpeakers;
Session.g_oMS.nNbrActiveSpeakers = Session.s_nNbrActiveSpeakers;
Session.g_oMS.nReportingInterval = Session.s_nReportingInterval;
Session.g_oMS.nDBThreshold = Session.s_nDBThreshold;
//AGC
Session.g_oMS.nAGCTargetLevelIn = Session.s_nAGCTargetLevelIn;
Session.g_oMS.nAGCMaxLevelIn = Session.s_nAGCMaxLevelIn;
Session.g_oMS.nAGCTargetLevelOut = Session.s_nAGCTargetLevelOut;
Session.g_oMS.nAGCMaxLevelOut = Session.s_nAGCMaxLevelOut;

if (Session.s_strMSRetryFlag == "T")
{
	Session.g_oMS.bRetry = true;
}
else
{
	Session.g_oMS.bRetry = false;
}
Server.logInfo("g_oMS.nMaxActiveSpeakers: " + Session.g_oMS.nMaxActiveSpeakers);
Server.logInfo("g_oMS.nNbrActiveSpeakers: " + Session.g_oMS.nNbrActiveSpeakers);
Server.logInfo("g_oMS.nReportingInterval: " + Session.g_oMS.nReportingInterval);
Server.logInfo("g_oMS.nDBThreshold: " + Session.g_oMS.nDBThreshold);
Server.logInfo("g_oMS.strEndPoint: " + Session.g_oMS.strEndPoint);
Server.logInfo("g_oMS.strConnectionId: " + Session.g_oMS.strConnectionId);
Server.logInfo("g_oMS.strCallId: " + Session.g_oMS.strCallId);
Server.logInfo("g_oMS.bMuteFlag: " + Session.g_oMS.bMuteFlag);
Server.logInfo("g_oMS.bDeafFlag: " + Session.g_oMS.bDeafFlag);
Server.logInfo("g_oMS.strCodec: " + Session.g_oMS.strCodec);
Server.logInfo("g_oMS.strType: " + Session.g_oMS.strType);
Server.logInfo("g_oMS.bDTMFClampFlag: " + Session.g_oMS.bDTMFClampFlag);]]></script>
          </scripts>
        </action>
        <action id="7" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=975 y=544 ?>
          <!--send to main function-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;Main&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="8" stubbed="0"/>
          </results>
        </action>
        <action id="8" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1184 y=547 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
        </action>
        <action id="9" plug-in="Pactolus.SipResponse.1" ><?xtml-editor x=680 y=326 ?>
          <!--200 OK with MS SDP-->
          <sip-response xmlns="urn:www.pactolus.com:xtml:sip" remove-via="0" reliable="0" increment-cseq-first="0" increment-cseq-last="0" >
            <call-id >strCallId</call-id>
            <contact >g_strContact</contact>
            <content >g_oMS.strContent</content>
            <content-type >s_strContentType</content-type>
            <cseq >strCSeq</cseq>
            <from >strFrom</from>
            <status >"SIP/2.0 200 OK"</status>
            <to >strTo</to>
            <via >strVia</via>
          </sip-response>
          <results >
            <result name="Default" link="10" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="10" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=910 y=141 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
        </action>
        <action id="11" plug-in="Pactolus.SipResponse.1" ><?xtml-editor x=665 y=142 ?>
          <!--200 OK with caller SDP-->
          <sip-response xmlns="urn:www.pactolus.com:xtml:sip" remove-via="0" reliable="0" increment-cseq-first="0" increment-cseq-last="0" >
            <call-id >strCallId</call-id>
            <contact >g_strContact</contact>
            <content >strContent</content>
            <content-type >s_strContentType</content-type>
            <cseq >strCSeq</cseq>
            <from >strFrom</from>
            <status >"SIP/2.0 200 OK"</status>
            <to >strTo</to>
            <via >strVia</via>
          </sip-response>
          <results >
            <result name="Default" link="10" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="12" plug-in="Pactolus.Branch.1" ><?xtml-editor x=709 y=540 ?>
          <!--js_utils 
strip non digit off phoneA, ANI, Dnis
strip leading 1 off Dnis-->
          <results >
            <result name="Default" link="7" stubbed="0"/>
            <result name="s_strTestModeFlag" link="13" stubbed="0" >s_strTestModeFlag match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("BEFORE strip non digit off phoneA number: <" + Session.g_strOriginationNumber + " >");
Session.g_strOriginationNumber = js_strip_non_digits(Session.g_strOriginationNumber);
Server.logInfo("AFTER strip non digit off phoneA number: <" + Session.g_strOriginationNumber + " >");

Server.logInfo("BEFORE strip non digit off info digits: <" + Session.g_strInfoDigits + " >");
Session.g_strInfoDigits = js_strip_non_digits(Session.g_strInfoDigits);
Server.logInfo("AFTER strip non digit off info digits: <" + Session.g_strInfoDigits + " >");

Server.logInfo("BEFORE strip non digit off access number: <" + Session.g_strAccessNumber + " >");
Session.g_strAccessNumber = js_strip_non_digits(Session.g_strAccessNumber);
Server.logInfo("AFTER strip non digit off access number: <" + Session.g_strAccessNumber + " >");

Server.logInfo("BEFORE strip leading one off access number: <" + Session.g_strAccessNumber + " >");
Session.g_strAccessNumber = js_strip_one(Session.g_strAccessNumber);
Server.logInfo("AFTER strip leading one off access number: <" + Session.g_strAccessNumber + " >");

Server.logInfo("BEFORE info digits: <" + Session.g_strInfoDigits + " >");
Session.g_strInfoDigits = js_get_info_digits(Session.g_oCallLegA.strFrom);
Server.logInfo("AFTER info digits: <" + Session.g_strInfoDigits + " >");]]></script>
          </scripts>
        </action>
        <action id="13" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=837 y=734 ?>
          <!--APIGetTestData-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;APIGetTestData&quot;" return="g_nReturnCode" external-function="1" library="lib_APISce.xml" >
            <parameter >g_oTEST</parameter>
          </function>
          <results >
            <result name="Default" link="14" stubbed="0"/>
            <result name="Success" link="7" stubbed="0" >g_nReturnCode == 0</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_initTEST(Session.g_oTEST);
Session.g_nReturnCode = -50;]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (0 == Session.g_nReturnCode)
{

	Session.g_strOriginationNumber = Session.g_oTEST.strTestOriginationNumber;
	
	if (Session.g_strOriginationNumber == "undefined" ||
		Session.g_strOriginationNumber == undefined ||
		Session.g_strOriginationNumber.length <= 0 ||
		Session.g_strOriginationNumber.indexOf("restricted") != -1 ||
		Session.g_strOriginationNumber.indexOf("Restricted") != -1	||
		Session.g_strOriginationNumber.indexOf("RESTRICTED")  != -1)
	{
		Session.g_strOriginationNumber = Session.s_strDEFAULT_ANI;
		Session.g_oCallLegA.strCallingNumber = Session.s_strDEFAULT_ANI;
		Session.g_oAPI.strUsedDefaultANIFlag = "T";
	}		
	
	
	

	Server.logInfo("BEFORE strip non digit off original number: <" + 	Session.g_strOriginationNumber + " >");
	Session.g_strOriginationNumber = js_strip_non_digits(Session.g_strOriginationNumber);
	Server.logInfo("AFTER strip non digit off original number: <" + 	Session.g_strOriginationNumber + " >");
}
else
{
	Server.logError("ERROR: FAIL TO GET TEST DATA");
}]]></script>
          </scripts>
        </action>
        <action id="14" plug-in="Pactolus.SipResponse.1" ><?xtml-editor x=1090 y=729 ?>
          <!--500 Server Error-->
          <sip-response xmlns="urn:www.pactolus.com:xtml:sip" remove-via="0" reliable="0" increment-cseq-first="0" increment-cseq-last="0" >
            <call-id >strCallId</call-id>
            <cseq >strCSeq</cseq>
            <from >strFrom</from>
            <status >"SIP/2.0 500 Server Internal Error"</status>
            <to >strTo</to>
            <via >strVia</via>
          </sip-response>
          <results >
            <result name="Default" link="15" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logError("TEST MODE, BUT FAIL TO GET TEST DATA");
Server.logError("RESPONSE WITH 500 Server Error");
Session.g_nTerminationReason = 5;]]></script>
          </scripts>
        </action>
        <action id="15" plug-in="Standard.EndSession.1" ><?xtml-editor x=1310 y=755 ?></action>
      </actions>
      <text-objects >
        <text-object x-coord="128" y-coord="29" width="210" height="119" text="set CSRMicOn = true
EndCSRAssignment
EndCSRPrivateTalk
RemoveCSRFromConf" font-name="Times New Roman" size="-16" red="0" green="0" blue="0" weight="0" underline="0" strikeout="0" point-size="12" italic="0"/>
      </text-objects>
    </function>
    <function name="Main" start="1" event="Main" returns="i4" >
      <local-vars >
        <var name="f_nReturnCode" type="i4" >-1</var>
      </local-vars>
      <actions >
        <action id="1" plug-in="Pactolus.Branch.1" ><?xtml-editor x=212 y=284 ?>
          <!--what to do?-->
          <results >
            <result name="Default" link="5" stubbed="0"/>
            <result name="Direct caller to MS" link="2" stubbed="0" >g_nCurrentState == s_nSTATE_DIRECT_TO_MS</result>
            <result name="Collect Password" link="4" stubbed="0" >g_nCurrentState == s_nSTATE_COLLECT_PASSWORD</result>
            <result name="Send Login" link="6" stubbed="0" >g_nCurrentState == s_nSTATE_SEND_LOGIN</result>
            <result name="Wait for GUI login" link="5" stubbed="1" >g_nCurrentState == s_nSTATE_WAIT_GUI_LOGIN</result>
            <result name="Wait for Assignment" link="8" stubbed="0" >g_nCurrentState == s_nSTATE_WAIT_ASSIGNMENT</result>
            <result name="Hang up caller" link="10" stubbed="0" >g_nCurrentState == s_nSTATE_HANGUP_CALLER</result>
            <result name="End call" link="11" stubbed="0" >g_nCurrentState == s_nSTATE_END_CALL</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: Main");]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=660 y=145 ?>
          <!--direct caller to MS-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DirectCallerToMS&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oCallLegA</parameter>
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="14" stubbed="0"/>
            <result name="SUCCESS" link="1" stubbed="1" >f_nReturnCode == s_nSUCCESS</result>
            <result name="CALLER HUNG UP" link="11" stubbed="1" >f_nReturnCode == s_nCALLERHUNGUP</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("**** BEFORE DIRECT CALLER TO MS ****");
Server.logInfo("g_oCallLegA.strFrom: " + Session.g_oCallLegA.strFrom);
Server.logInfo("g_oCallLegA.strTo: " + Session.g_oCallLegA.strTo);
Server.logInfo("g_oCallLegA.strVia: " + Session.g_oCallLegA.strVia);
Server.logInfo("g_oCallLegA.strCSeq: " + Session.g_oCallLegA.strCSeq);
Server.logInfo("g_oCallLegA.strCallId: " + Session.g_oCallLegA.strCallId);
Server.logInfo("g_oCallLegA.strRequestUri: " + Session.g_oCallLegA.strRequestUri);
Server.logInfo("g_oCallLegA.strContent: " + Session.g_oCallLegA.strContent);
Server.logInfo("g_oCallLegA.strRoute: " + Session.g_oCallLegA.strRoute);
Server.logInfo("g_oCallLegA.strRecordRoute: " + Session.g_oCallLegA.strRecordRoute);]]></script>
            <script language="javascript" timing="last" ><![CDATA[Server.logInfo("**** AFTER DIRECT CALLER TO MS ****");
Server.logInfo("g_oCallLegA.strFrom: " + Session.g_oCallLegA.strFrom);
Server.logInfo("g_oCallLegA.strTo: " + Session.g_oCallLegA.strTo);
Server.logInfo("g_oCallLegA.strVia: " + Session.g_oCallLegA.strVia);
Server.logInfo("g_oCallLegA.strCSeq: " + Session.g_oCallLegA.strCSeq);
Server.logInfo("g_oCallLegA.strCallId: " + Session.g_oCallLegA.strCallId);
Server.logInfo("g_oCallLegA.strRequestUri: " + Session.g_oCallLegA.strRequestUri);
Server.logInfo("g_oCallLegA.strContent: " + Session.g_oCallLegA.strContent);
Server.logInfo("g_oCallLegA.strRoute: " + Session.g_oCallLegA.strRoute);
Server.logInfo("g_oCallLegA.strRecordRoute: " + Session.g_oCallLegA.strRecordRoute);

if (Session.f_nReturnCode == Session.s_nSUCCESS)
{
	Session.g_nCurrentState = Session.s_nSTATE_COLLECT_PASSWORD;
}
else if (Session.f_nReturnCode == Session.s_nCALLERHUNGUP)
{
	Session.g_nCurrentState = Session.s_nSTATE_END_CALL;
}
else
{
	Session.g_nCurrentState = Session.s_nSTATE_HANGUP_CALLER;
}]]></script>
          </scripts>
        </action>
        <action id="4" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=746 y=289 ?>
          <!--Collect and validate Password-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;CollectPassword&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="1" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Session.f_nReturnCode == Session.s_nSUCCESS)
{
	Session.g_nCurrentState = Session.s_nSTATE_SEND_LOGIN;
}
else
{
	Session.g_nCurrentState = Session.s_nSTATE_HANGUP_CALLER;
}]]></script>
          </scripts>
        </action>
        <action id="5" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=618 y=63 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="6" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=763 y=421 ?>
          <!--"SendLogInCSRIVR"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;SendLogInCSRIVR&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="1" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_disable_event();]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Session.f_nReturnCode == Session.s_nSUCCESS)
{
	Session.g_nCurrentState = Session.s_nSTATE_WAIT_GUI_LOGIN;
}
else if (Session.f_nReturnCode == Session.s_nGUI_LOGIN)
{
	Session.g_nCurrentState = Session.s_nSTATE_WAIT_ASSIGNMENT;
}
else
{
	Session.g_nCurrentState = Session.s_nSTATE_HANGUP_CALLER;
}]]></script>
          </scripts>
        </action>
        <action id="8" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=749 y=537 ?>
          <!--DeleteMSConnection-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DeleteMSConnection&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="12" stubbed="0"/>
          </results>
        </action>
        <action id="10" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=737 y=635 ?>
          <!--HangUpPartyA-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpParty&quot;" return="" external-function="1" library="lib_callcontrol.xml" >
            <parameter >g_oCallLegA</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="1" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[Session.g_nCurrentState = Session.s_nSTATE_END_CALL;]]></script>
          </scripts>
        </action>
        <action id="11" plug-in="Standard.EndSession.1" ><?xtml-editor x=714 y=750 ?></action>
        <action id="12" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=977 y=533 ?>
          <!--put caller on hold-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;PutPartyOnHold&quot;" return="f_nReturnCode" external-function="1" library="lib_callcontrol.xml" >
            <parameter >g_oCallLegA</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="1" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("**** BEFORE PUT CALLER ON HOLD ****");
Server.logInfo("g_oCallLegA.strFrom: " + Session.g_oCallLegA.strFrom);
Server.logInfo("g_oCallLegA.strTo: " + Session.g_oCallLegA.strTo);
Server.logInfo("g_oCallLegA.strVia: " + Session.g_oCallLegA.strVia);
Server.logInfo("g_oCallLegA.strCSeq: " + Session.g_oCallLegA.strCSeq);
Server.logInfo("g_oCallLegA.strCallId: " + Session.g_oCallLegA.strCallId);
Server.logInfo("g_oCallLegA.strRequestUri: " + Session.g_oCallLegA.strRequestUri);
Server.logInfo("g_oCallLegA.strContent: " + Session.g_oCallLegA.strContent);
Server.logInfo("g_oCallLegA.strRoute: " + Session.g_oCallLegA.strRoute);
Server.logInfo("g_oCallLegA.strRecordRoute: " + Session.g_oCallLegA.strRecordRoute);]]></script>
            <script language="javascript" timing="last" ><![CDATA[Server.logInfo("**** AFTER PUT CALLER ON HOLD ****");
Server.logInfo("g_oCallLegA.strFrom: " + Session.g_oCallLegA.strFrom);
Server.logInfo("g_oCallLegA.strTo: " + Session.g_oCallLegA.strTo);
Server.logInfo("g_oCallLegA.strVia: " + Session.g_oCallLegA.strVia);
Server.logInfo("g_oCallLegA.strCSeq: " + Session.g_oCallLegA.strCSeq);
Server.logInfo("g_oCallLegA.strCallId: " + Session.g_oCallLegA.strCallId);
Server.logInfo("g_oCallLegA.strRequestUri: " + Session.g_oCallLegA.strRequestUri);
Server.logInfo("g_oCallLegA.strContent: " + Session.g_oCallLegA.strContent);
Server.logInfo("g_oCallLegA.strRoute: " + Session.g_oCallLegA.strRoute);
Server.logInfo("g_oCallLegA.strRecordRoute: " + Session.g_oCallLegA.strRecordRoute);

if (Session.f_nReturnCode != Session.s_nSUCCESS)
{
	Session.g_nCurrentState = Session.s_nSTATE_HANGUP_CALLER;
}
else
{
	Session.g_nCurrentState = 0;  //intial state
}]]></script>
          </scripts>
        </action>
        <action id="13" plug-in="Standard.Timer.1" ><?xtml-editor x=978 y=422 ?>
          <!--start heartbeat timer-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lHeartbeatTimerId" duration="s_nHEARTBEATTIME"/>
          <results >
            <result name="Default" link="12" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bHearbeatTimerFlag = true;]]></script>
          </scripts>
        </action>
        <action id="14" plug-in="Pactolus.SipResponse.1" ><?xtml-editor x=934 y=145 ?>
          <!--503 service unavailable-->
          <sip-response xmlns="urn:www.pactolus.com:xtml:sip" remove-via="0" reliable="0" increment-cseq-first="0" increment-cseq-last="0" >
            <call-id >g_oCallLegA.strCallId</call-id>
            <contact >g_strContact</contact>
            <cseq >g_oCallLegA.strCSeq</cseq>
            <from >g_oCallLegA.strFrom</from>
            <status >"SIP/2.0 503 Service Unavailable"</status>
            <to >g_oCallLegA.strTo</to>
            <via >g_oCallLegA.strVia</via>
          </sip-response>
          <results >
            <result name="Default" link="11" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logError("ERROR: MAIN FAIL TO CONNECT TO MS, RESPONSE 503 SERVICE UNAVAILABLE");
var myTo = new SipTo(Session.g_oCallLegA.strTo);
if (undefined == myTo.tag)
{
	Session.g_oCallLegA.strTo = Session.g_oCallLegA.strTo + ";tag=" + Server.getUTCTime();
}]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)
{
	Server.logError("ERROR: FAIL TO RESPONSE 503 SERVICE UNAVAILABLE");
}]]></script>
          </scripts>
        </action>
      </actions>
    </function>
    <function name="CollectPassword" start="15" event="CollectPassword" returns="i4" >
      <local-vars >
        <var name="f_nReturnCode" type="i4" >-1</var>
        <var name="f_nTimeout" type="i4" >20</var>
        <var name="f_nMsgNbr" type="i4" >0</var>
        <var name="f_nCounter" type="i4" >0</var>
        <var name="strDigitMap" type="string" ></var>
      </local-vars>
      <actions >
        <action id="15" plug-in="Pactolus.Branch.1" ><?xtml-editor x=40 y=40 ?>
          <results >
            <result name="Default" link="16" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: CollectPassword");
Server.logInfo("CSR IVR Passcode length is: " + Session.s_nCSRPasscodeLength);
Session.g_nNbrLoginAttempts = 1;
// Session.strDigitMap = "(xxxxxxxxxx|x.T|x.#|x.*)";
Session.strDigitMap = "(";
for (var i = 0; i < Session.s_nCSRPasscodeLength; i++)
{
	Session.strDigitMap += "x";
}
Session.strDigitMap += "|x.T|x.#|x.*)";]]></script>
          </scripts>
        </action>
        <action id="16" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=70 y=180 ?>
          <!--506: Please enter your card number.-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="f_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="strDigitMap" language="g_strLanguage" digits="g_strPassword" retry-count="" clear-digits="0" terminating-digit="g_strTerminationDigit" quick-collect="0" digit-timer="" >
            <audio type="index" >1508</audio>
          </play>
          <results >
            <result name="Default" link="22" stubbed="1"/>
            <result name="Success" link="17" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout" link="18" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strPassword = "";]]></script>
            <script language="javascript" timing="last" ><![CDATA[if(1 == Result.id | 3 == Result.id) {
	Server.logError("ERROR COLLECTING CSR PASSCODE.");
}]]></script>
          </scripts>
        </action>
        <action id="17" plug-in="Pactolus.Branch.1" ><?xtml-editor x=298 y=167 ?>
          <!--terminationdigit==*-->
          <results >
            <result name="Default" link="18" stubbed="1"/>
            <result name="terminationdigit==*" link="16" stubbed="1" >g_strTerminationDigit match "\*"</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[Session.g_strTerminationDigit = "";
]]></script>
          </scripts>
        </action>
        <action id="18" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=345 y=328 ?>
          <!--"psAPISceAuthCSRPin"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceAuthCSRPin&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="23" stubbed="1"/>
            <result name="-1 - Invalid" link="20" stubbed="0" >f_nReturnCode == -1</result>
            <result name="-2 - Disabled" link="21" stubbed="0" >f_nReturnCode == -2</result>
            <result name="0 - Success" link="19" stubbed="0" >f_nReturnCode == 0</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_disable_event();]]></script>
            <script language="javascript" timing="last" ><![CDATA[js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="19" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=663 y=581 ?>
          <!--s_nSUCCESS-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nSUCCESS"/>
        </action>
        <action id="20" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=668 y=154 ?>
          <!--did not hear | invalid-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="f_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >g_nPrompt</audio>
          </play>
          <results >
            <result name="Default" link="16" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (Session.g_strPassword.length <= 0)
{
	Session.g_nPrompt = 552;
} else {
	Session.g_nPrompt = 950;
}
]]></script>
          </scripts>
        </action>
        <action id="21" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=736 y=355 ?>
          <!--disable-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="f_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >506</audio>
            <audio type="index" >322</audio>
          </play>
          <results >
            <result name="Default" link="22" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="22" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=304 y=548 ?>
          <!--s_nFAILURE-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nFAILURE"/>
        </action>
        <action id="23" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=51 y=517 ?>
          <!--(did not hear | invalid), message number-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="f_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >g_nPrompt</audio>
            <audio type="index" >365</audio>
            <audio type="number" >f_nMsgNbr</audio>
            <audio type="index" >322</audio>
          </play>
          <results >
            <result name="Default" link="22" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (-3 == Session.f_nReturnCode) 
{
	Session.f_nMsgNbr = 5004;
}
else if (-4 == Session.f_nReturnCode)
{
	Session.f_nMsgNbr = 5005;
}
else if (-5 == Session.f_nReturnCode)
{
	Session.f_nMsgNbr = 5001;
}	
else if (Session.g_strDialType == "O") 
{
	Session.f_nMsgNbr = 5008;
} 
else
{
	Session.f_nMsgNbr = 1001;
}


if (Session.g_strPassword.length <= 0)
{
	Session.g_nPrompt = 552;
} else {
	Session.g_nPrompt = 950;
}]]></script>
          </scripts>
        </action>
      </actions>
    </function>
    <function name="SendLogInCSRIVR" start="1" event="SendLogInCSRIVR" returns="i4" >
      <local-vars >
        <var name="f_nReturnCode" type="i4" >-1</var>
        <var name="f_nTimeout" type="i4" >5</var>
        <var name="f_strACDControllerIP" type="string" ></var>
        <var name="f_nACDControllerPort" type="i4" >0</var>
        <var name="f_strTransactionId" type="string" ></var>
        <var name="f_strReturnMsg" type="string" ></var>
        <var name="f_nCSR_ALREADY_LOGIN" type="i4" >-2</var>
        <var name="f_bTryAgain" type="boolean" >1</var>
      </local-vars>
      <actions >
        <action id="1" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=70 y=295 ?>
          <!--s_strMSG_LOGIN_REQUEST-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strACDControllerIP" transaction="g_strZeroTransactionId" message-name="s_strMSG_LOGIN_REQUEST" destination-port="g_nACDControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;ACDUserId&quot;" value="g_lACDUserId"/>
            <parameter tag="&quot;SoapPort&quot;" value="s_nSoapPort"/>
          </SOAP>
          <results >
            <result name="Default" link="12" stubbed="0"/>
            <result name="Success" link="3" stubbed="0"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: SendLogInCSRIVR");]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=538 y=200 ?>
          <!--s_nFAILURE-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nFAILURE"/>
        </action>
        <action id="3" plug-in="Standard.WaitEvent.1" ><?xtml-editor x=305 y=383 ?>
          <!--LoginCSRIVRResponse-->
          <wait xmlns="urn:www.pactolus.com:xtml:communication" timeout="f_nTimeout" recv-name="g_strEventReceived" >
            <msg name="LoginCSRIVRResponse" >
              <parameter >f_strACDControllerIP</parameter>
              <parameter >f_nACDControllerPort</parameter>
              <parameter >f_strTransactionId</parameter>
              <parameter >f_nReturnCode</parameter>
              <parameter >f_strReturnMsg</parameter>
            </msg>
          </wait>
          <results >
            <result name="Default" link="2" stubbed="1"/>
            <result name="Success" link="5" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="4" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=985 y=721 ?>
          <!--f_nReturnCode-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nReturnCode"/>
        </action>
        <action id="5" plug-in="Pactolus.Branch.1" ><?xtml-editor x=541 y=381 ?>
          <!--CSR already login-->
          <results >
            <result name="Default" link="9" stubbed="0"/>
            <result name="f_nReturnCode == -2" link="11" stubbed="0" >f_nReturnCode == f_nCSR_ALREADY_LOGIN
AND f_bTryAgain == true</result>
            <result name="f_nReturnCode == 1" link="13" stubbed="0" >f_nReturnCode == s_nGUI_LOGIN</result>
            <result name="f_nReturnCode == -1" link="12" stubbed="1" >f_nReturnCode == s_nFAILURE</result>
          </results>
        </action>
        <action id="6" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=780 y=90 ?>
          <!--"SendLogoutCSRIVR"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;SendLogoutCSRIVR&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="7" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_bTryAgain = false;]]></script>
          </scripts>
        </action>
        <action id="7" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1014 y=86 ?>
          <!--success?-->
          <results >
            <result name="Default" link="2" stubbed="1"/>
            <result name="f_nReturnCode == 0" link="1" stubbed="1" >f_nReturnCode == s_nSUCCESS</result>
          </results>
        </action>
        <action id="9" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=787 y=257 ?>
          <!--please log in web app-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTIMEOUT" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >1505</audio>
          </play>
          <results >
            <result name="Default" link="10" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="10" plug-in="Standard.Timer.1" ><?xtml-editor x=1040 y=256 ?>
          <!--wait for CSR login GUI-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lWaitCSRLoginGUITimerId" duration="s_nWAIT_CSR_LOGIN_GUI"/>
          <results >
            <result name="Default" link="4" stubbed="1"/>
          </results>
        </action>
        <action id="11" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=803 y=440 ?>
          <!--passcode in used-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="f_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >877</audio>
          </play>
          <results >
            <result name="Default" link="2" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="12" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=296 y=203 ?>
          <!--error, goodbye-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="f_nTimeout" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >365</audio>
            <audio type="number" >1001</audio>
            <audio type="index" >322</audio>
          </play>
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="13" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=748 y=669 ?>
          <!--"PlayOnePrompt"
 1509: You have successfully logged in.-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;PlayOnePrompt&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
            <parameter >g_strLanguage</parameter>
            <parameter >1509</parameter>
          </function>
          <results >
            <result name="Default" link="4" stubbed="0"/>
          </results>
        </action>
      </actions>
    </function>
    <function name="psAPISceAuthCSRPin" start="1" event="psAPISceAuthCSRPin" returns="i4" >
      <local-vars >
        <var name="f_nReturnCode" type="i4" >-1</var>
      </local-vars>
      <actions >
        <action id="1" plug-in="Pactolus.JavaStaticMethod.1" ><?xtml-editor x=185 y=252 ?>
          <!--authenticateCSRPin()-->
          <java xmlns="urn:www.pactolus.com:xtml:application" class="&quot;com.pactolus.acd.psAPISceAuthCSRPin&quot;" method="&quot;validateCSRPin&quot;" timeout="s_nTIMEOUT" return="" method-return-var="f_nReturnCode" method-return-type="0" >
            <parameter type="in" var-type="string" >g_strDBName</parameter>
            <parameter type="in" var-type="string" >g_strSessionId</parameter>
            <parameter type="in" var-type="string" >s_strApplicationName</parameter>
            <parameter type="in" var-type="string" >g_strPassword</parameter>
            <parameter type="in" var-type="string" >g_strOriginationNumber</parameter>
            <parameter type="in" var-type="i4" >g_nNbrLoginAttempts</parameter>
            <parameter type="inout" var-type="i8" >g_lACDUserId</parameter>
            <parameter type="inout" var-type="i4" >g_nGroupId</parameter>
            <parameter type="inout" var-type="i4" >g_nInitialState</parameter>
            <parameter type="inout" var-type="string" >g_strCSRType</parameter>
            <parameter type="inout" var-type="string" >g_strFirstName</parameter>
            <parameter type="inout" var-type="string" >g_strLastName</parameter>
            <parameter type="inout" var-type="string" >g_strWorkstationPhoneNbr</parameter>
            <parameter type="inout" var-type="i4" >g_nPrimaryLanguageId</parameter>
            <parameter type="inout" var-type="i4" >g_nPrimarySkillId</parameter>
            <parameter type="inout" var-type="string" >g_strACDControllerIP</parameter>
            <parameter type="inout" var-type="i4" >g_nACDControllerPort</parameter>
            <parameter type="inout" var-type="string" >g_strDialType</parameter>
          </java>
          <results >
            <result name="Default" link="4" stubbed="0"/>
            <result name="Success" link="5" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: psAPISceAuthCSRPin");
Server.logInfo("Input Parameters");
Server.logInfo("  DB Name : " + Session.g_strDBName);
Server.logInfo("  SessionId : " + Session.g_strSessionId);
Server.logInfo("  AppName : " + Session.s_strApplicationName);
Server.logInfo("  PIN : " + Session.g_strPassword);
Server.logInfo("  Origination Number : " + Session.g_strOriginationNumber);
Server.logInfo("  Number of login attemps: " + Session.g_nNbrLoginAttempts);]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (2 == Result.id)
{
	Server.logInfo("*********JAVA RETURN*********");
	Server.logInfo("AuthenticateCSR returned " + Session.f_nReturnCode);
	Server.logInfo("Output Parameters");
	Server.logInfo("  ACDUserId : " + Session.g_lACDUserId);
	Server.logInfo("  groupId : " + Session.g_nGroupId);
	Server.logInfo("  initialState : " + Session.g_nInitialState);
	Server.logInfo("  CSRType : " + Session.g_strCSRType);
	Server.logInfo("  FirstName : " + Session.g_strFirstName);
	Server.logInfo("  LastName : " + Session.g_strLastName);
	Server.logInfo("  WorkstationPhoneNumber : " + Session.g_strWorkstationPhoneNbr);
	Server.logInfo("  PrimaryLanguageId : " + Session.g_nPrimaryLanguageId);
	Server.logInfo("  PrimarySkill : " + Session.g_nPrimarySkillId);
	Server.logInfo("  ACDControllerIP : " + Session.g_strACDControllerIP);
	Server.logInfo("  ACDControllerPort : " + Session.g_nACDControllerPort);

	if (-99 == Session.f_nReturnCode)
		Session.g_nErrorMsgNumber = 1001; //db error
	else if (-1 == Session.f_nReturnCode)
	{
		Session.g_nErrorMsgNumber = 5002; //invalid CSR pin
		Session.g_nNbrLoginAttempts++;
	}
	else if (-2 == Session.f_nReturnCode)
		Session.g_nErrorMsgNumber = 5003; //disable CSR
	else if (-3 == Session.f_nReturnCode)
		Session.g_nErrorMsgNumber = 5004; //no skill for CSR
	else if (-4 == Session.f_nReturnCode)
		Session.g_nErrorMsgNumber = 5005; //max login attempts
	else if (-5 == Session.f_nReturnCode)
		Session.g_nErrorMsgNumber = 5001; //no ACD settings
	else
		Session.g_nErrorMsgNumber = 0;
}
else
{
	Server.logError("ERROR: FAIL TO AUTHENTICATE CSR, EXIT ON: " + Result.name);
	Session.g_nErrorMsgNumber = 1000; //jvm server error
}]]></script>
          </scripts>
        </action>
        <action id="4" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=449 y=207 ?>
          <!--s_nFAILURE-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nFAILURE"/>
        </action>
        <action id="5" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=453 y=325 ?>
          <!--f_nReturnCode-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nReturnCode"/>
        </action>
      </actions>
    </function>
    <function name="SendLogoutCSRIVR" start="1" event="SendLogoutCSRIVR" returns="i4" >
      <actions >
        <action id="1" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=186 y=220 ?>
          <!--s_strMSG_LOGOUT_REQUEST-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strACDControllerIP" transaction="g_strZeroTransactionId" message-name="s_strMSG_LOGOUT_REQUEST" destination-port="g_nACDControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;ACDUserId&quot;" value="g_lACDUserId"/>
          </SOAP>
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="Success" link="3" stubbed="0"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: SendLogOutCSRIVR");
Session.g_bGotCSRBeginAssignment = false;]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=419 y=177 ?>
          <!--s_nFAILURE-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nFAILURE"/>
        </action>
        <action id="3" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=437 y=305 ?>
          <!--s_nSUCCESS-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nSUCCESS"/>
        </action>
      </actions>
    </function>
    <function name="OnAddCSRToConf" start="3" event="OnAddCSRToConf" returns="void" >
      <parameters >
        <parameter name="strACDControllerIP" type="string" pass="byref"/>
        <parameter name="nACDControllerPort" type="i4" pass="byref"/>
        <parameter name="strTransactionId" type="string" pass="byref"/>
        <parameter name="strConferenceType" type="string" pass="byref"/>
        <parameter name="strConfEventId" type="string" pass="byref"/>
        <parameter name="strConferenceEndPoint" type="string" pass="byref"/>
        <parameter name="strServiceProviderId" type="string" pass="byref"/>
        <parameter name="strConfPasscode" type="string" pass="byref"/>
        <parameter name="strCSRMuteFlag" type="string" pass="byref"/>
        <parameter name="strSubConferenceId" type="string" pass="byref"/>
      </parameters>
      <local-vars >
        <var name="f_nReturnCode" type="i4" >-1</var>
        <var name="f_bNullString" type="boolean" >0</var>
        <var name="f_sCounter" type="i2" >0</var>
        <var name="f_strReturnMsg" type="string" ></var>
        <var name="f_strUniqueId" type="string" ></var>
        <var name="strAnonymousCaller" type="string" ></var>
        <var name="g_bSentConfJoinEvent" type="boolean" >0</var>
        <var name="strEndpointPlusConnectionId" type="string" ></var>
        <var name="nSetResourceRetry" type="i4" >0</var>
      </local-vars>
      <actions >
        <action id="3" plug-in="Pactolus.Branch.1" ><?xtml-editor x=200 y=270 ?>
          <!--Subscriber conference?-->
          <results >
            <result name="Default" link="1" stubbed="0"/>
            <result name="Type == &quot;S&quot; and No Passcode" link="4" stubbed="0" >strConferenceType match "S"
AND f_bNullString == true</result>
            <result name="type S and Passcode == true" link="56" stubbed="0" >strConferenceType match "S"
AND f_bNullString == false</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_disable_event();
Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: OnAddCSRToConf");
Server.logInfo("RECEIVED ADD CSR TO CONF");
Server.logInfo("CONFERENCE EVENT Id: " + Session.strConfEventId);
Server.logInfo("CONFERENCE TYPE: " + Session.strConferenceType);
Server.logInfo("CONFERENCE END POINT: " + Session.strConferenceEndPoint);
Server.logInfo("SERVICE PROVIdER Id: " + Session.strServiceProviderId);
Session.g_lServiceProviderId = Number(Session.strServiceProviderId);
Server.logInfo("SERVICE PROVIDER Id: " + Session.g_lServiceProviderId);
Server.logInfo("Sub Conference Id: " + Session.strSubConferenceId);
Session.g_strSubConferenceId = Session.strSubConferenceId;
if (false == Session.g_bAlreadyInitMS)
{
	js_initMS(Session.g_oMS, Session.s_strMSType);
	Session.g_oMS.strACDType = Session.s_strACDMediaServerType;
	Session.g_oMS.strConfType = Session.s_strConf_MS_Type;
	Session.g_oMS.nPacketizationPeriod = Session.s_nPacketizationPeriod;
	//ASN
	Session.g_oMS.nMaxActiveSpeakers = Session.s_nMaxActiveSpeakers;
	Session.g_oMS.nNbrActiveSpeakers = Session.s_nNbrActiveSpeakers;
	Session.g_oMS.nReportingInterval = Session.s_nReportingInterval;
	Session.g_oMS.nDBThreshold = Session.s_nDBThreshold;
	//AGC
	Session.g_oMS.nAGCTargetLevelIn = Session.s_nAGCTargetLevelIn;
	Session.g_oMS.nAGCMaxLevelIn = Session.s_nAGCMaxLevelIn;
	Session.g_oMS.nAGCTargetLevelOut = Session.s_nAGCTargetLevelOut;
	Session.g_oMS.nAGCMaxLevelOut = Session.s_nAGCMaxLevelOut;
	Session.g_bAlreadyInitMS = true;
}


Session.g_strConfEventId = Session.strConfEventId;
if (Session.strConfPasscode.length <= 0)
{
	Session.f_bNullString = true;
}
else
{
	Session.f_bNullString = false;
}

if (Session.strCSRMuteFlag == "T")
{
	Session.g_oMS.bMuteFlag = true; 
	Session.g_bPlayTone = false;
}
else
{
	Session.g_oMS.bMuteFlag = false; 
	Session.g_bPlayTone = true;
}
if (("S" == Session.strConferenceType) ||
    ("T" == Session.strConferenceType))
{
	Session.g_oMS.bUseForConf = true;
	Session.g_oMS.strType = Session.g_oMS.strConfType ;
}
else
{
	Session.g_oMS.bUseForConf = false;
	Session.g_oMS.bUseForACD = true;
}

Server.logInfo("g_oMS.nMaxActiveSpeakers: " + Session.g_oMS.nMaxActiveSpeakers);
Server.logInfo("g_oMS.nNbrActiveSpeakers: " + Session.g_oMS.nNbrActiveSpeakers);
Server.logInfo("g_oMS.nReportingInterval: " + Session.g_oMS.nReportingInterval);
Server.logInfo("g_oMS.nDBThreshold: " + Session.g_oMS.nDBThreshold);
Server.logInfo("g_oMS.strEndPoint: " + Session.g_oMS.strEndPoint);
Server.logInfo("g_oMS.strConnectionId: " + Session.g_oMS.strConnectionId);
Server.logInfo("g_oMS.strCallId: " + Session.g_oMS.strCallId);
Server.logInfo("g_oMS.bMuteFlag: " + Session.g_oMS.bMuteFlag);
Server.logInfo("g_oMS.bDeafFlag: " + Session.g_oMS.bDeafFlag);
Server.logInfo("g_oMS.strCodec: " + Session.g_oMS.strCodec);
Server.logInfo("g_oMS.strType: " + Session.g_oMS.strType);
Server.logInfo("g_oMS.bDTMFClampFlag: " + Session.g_oMS.bDTMFClampFlag);]]></script>
          </scripts>
        </action>
        <action id="1" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=483 y=127 ?>
          <!--AddMemberToConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;AddMemberToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
            <parameter >g_oCallLegA</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="31" stubbed="1"/>
            <result name="f-intReturnCode = 0" link="30" stubbed="0" >f_nReturnCode == 0</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_oMS.strConferenceId = Session.strConferenceEndPoint;
Server.logInfo("**** BEFORE ADD CALLER TO CONFERENCE ****");
Server.logInfo("g_oCallLegA.strFrom: " + Session.g_oCallLegA.strFrom);
Server.logInfo("g_oCallLegA.strTo: " + Session.g_oCallLegA.strTo);
Server.logInfo("g_oCallLegA.strVia: " + Session.g_oCallLegA.strVia);
Server.logInfo("g_oCallLegA.strCSeq: " + Session.g_oCallLegA.strCSeq);
Server.logInfo("g_oCallLegA.strCallId: " + Session.g_oCallLegA.strCallId);
Server.logInfo("g_oCallLegA.strRequestUri: " + Session.g_oCallLegA.strRequestUri);
Server.logInfo("g_oCallLegA.strContent: " + Session.g_oCallLegA.strContent);
Server.logInfo("g_oCallLegA.strRoute: " + Session.g_oCallLegA.strRoute);
Server.logInfo("g_oCallLegA.strRecordRoute: " + Session.g_oCallLegA.strRecordRoute);]]></script>
            <script language="javascript" timing="last" ><![CDATA[Server.logInfo("**** AFTER ADD CALLER TO CONFERENCE ****");
Server.logInfo("g_oCallLegA.strFrom: " + Session.g_oCallLegA.strFrom);
Server.logInfo("g_oCallLegA.strTo: " + Session.g_oCallLegA.strTo);
Server.logInfo("g_oCallLegA.strVia: " + Session.g_oCallLegA.strVia);
Server.logInfo("g_oCallLegA.strCSeq: " + Session.g_oCallLegA.strCSeq);
Server.logInfo("g_oCallLegA.strCallId: " + Session.g_oCallLegA.strCallId);
Server.logInfo("g_oCallLegA.strRequestUri: " + Session.g_oCallLegA.strRequestUri);
Server.logInfo("g_oCallLegA.strContent: " + Session.g_oCallLegA.strContent);
Server.logInfo("g_oCallLegA.strRoute: " + Session.g_oCallLegA.strRoute);
Server.logInfo("g_oCallLegA.strRecordRoute: " + Session.g_oCallLegA.strRecordRoute);
if (0 == Session.f_nReturnCode)
{
	Session.g_lMSConnectTime = Server.getUTCTime();
} else {
	Server.logError("Error connecting CSR to conference.")
}
if (1 == Result.id)
{
	Session.g_nCurrentState = Session.s_nSTATE_ADD_TO_CONF;  //so when get EndAssignment, we need to hangup the CSR
	Session.f_strReturnMsg = "FAIL TO ADD MEMBER TO CONFERENCE";
}]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1748 y=114 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nCurrentState = Session.s_nSTATE_ADD_TO_CONF;
Session.g_bSentConfJoinEvent = true;
js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="4" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=460 y=329 ?>
          <!--"psAPISceGetConfPassCode"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceGetConfPassCode&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="5" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bSubscriberConference = true;]]></script>
            <script language="javascript" timing="last" ><![CDATA[Session.g_strPassCode = Session.g_strConferencePasscode;]]></script>
          </scripts>
        </action>
        <action id="5" plug-in="Pactolus.Branch.1" ><?xtml-editor x=699 y=327 ?>
          <!--success?-->
          <results >
            <result name="Default" link="7" stubbed="0"/>
            <result name="f_nReturnCode == 0" link="32" stubbed="1" >f_nReturnCode == s_nSUCCESS</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (1 == Result.id)
{
	Session.f_strReturnMsg = "FAIL TO GET PASSCODE";
}]]></script>
          </scripts>
        </action>
        <action id="7" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=926 y=324 ?>
          <!--PlayErrorMsg-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;PlayErrorMsg&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="31" stubbed="0"/>
          </results>
        </action>
        <action id="10" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1209 y=696 ?>
          <!--AddMemberToConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;AddMemberToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
            <parameter >g_oCallLegA</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="11" stubbed="0"/>
          </results>
        </action>
        <action id="11" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1449 y=693 ?>
          <!--success?-->
          <results >
            <result name="Default" link="55" stubbed="0"/>
            <result name="f_nReturnCode == 0" link="33" stubbed="0" >f_nReturnCode == s_nSUCCESS</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (1 == Result.id)
{
	Session.f_strReturnMsg = "FAIL TO ADD MEMBER TO CONFERENCE";
}]]></script>
          </scripts>
        </action>
        <action id="12" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2147 y=692 ?>
          <!--CallPartyFlag==T?-->
          <results >
            <result name="Default" link="37" stubbed="0"/>
            <result name="g_strPartyPasscodeFlag==T" link="38" stubbed="0" >g_strPartyPasscodeFlag match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_lPartyJoinTime = Server.getUTCTime();
Server.logInfo("INFO: conference.PartyJoin.2: SEND PARTY JOIN ****");
Server.logInfo("INFO: conference.PartyJoin.2:  CONF CON IP = " + Session.g_strConfControllerIP);
Server.logInfo("INFO: conference.PartyJoin.2:  CONF CON PORT = " + Session.g_nConfControllerPort);
Server.logInfo("INFO: conference.PartyJoin.2:  CONF CON TRANS Id = " + Session.g_strTransactionId);
Server.logInfo("INFO: conference.PartyJoin.2:  CONF CON MSG NAME = " + Session.s_strCONF_JOIN);
Server.logInfo("INFO: conference.PartyJoin.2:  CONF EVENT Id =  " + Session.g_strConfEventId);
Server.logInfo("INFO: conference.PartyJoin.2:  CONF SCHED Id =  " + Session.g_strConfScheduleId);
Server.logInfo("INFO: conference.PartyJoin.2:  PASSCODE = " + Session.g_strPassCode);
Server.logInfo("INFO: conference.PartyJoin.2:  MODERATOR FLAG = " + Session.g_strModeratorFlag);
Server.logInfo("INFO: conference.PartyJoin.2:  CALLING NUMBER = " + Session.g_strOrigNbr);
Server.logInfo("INFO: conference.PartyJoin.2:  CALLER FIRST NAME = " + Session.g_strCallerFirstName);
Server.logInfo("INFO: conference.PartyJoin.2:  CALLER LAST NAME = " + Session.g_strCallerLastName);
Server.logInfo("INFO: conference.PartyJoin.2:  CALLER ORG = " + Session.g_strCallerOrg);
Server.logInfo("INFO: conference.PartyJoin.2:  SOAP PORT = " + Session.s_nSoapPort);

var myContent = new Sdp(Session.g_oMS.strContent);
Session.g_strMediaServerIP = myContent.connection.address;
Server.logInfo("ADD PARTY TO MEDIASERVER IP: " + Session.g_strMediaServerIP);
Session.strEndpointPlusConnectionId = Session.g_oMS.strEndPoint + "#" + Session.g_oMS.strConnectionId;]]></script>
          </scripts>
        </action>
        <action id="15" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1414 y=316 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="16" plug-in="Pactolus.Branch.1" ><?xtml-editor x=943 y=478 ?>
          <!--set passcode-->
          <results >
            <result name="Default" link="32" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strPassCode = Session.strConfPasscode;
Session.g_strConferencePasscode = Session.strConfPasscode;
Session.g_bSubscriberConference = true;
Session.g_oMS.strCallId = "";
Session.g_oMS.strContent = "";
Session.g_oMS.strEndPoint = "";
Session.g_oMS.strConnectionId = "";]]></script>
          </scripts>
        </action>
        <action id="17" plug-in="Pactolus.Branch.1" ><?xtml-editor x=707 y=701 ?>
          <!--first caller?-->
          <results >
            <result name="Default" link="43" stubbed="0"/>
            <result name="g_bFirstCaller&amp;&amp;!NoCreateConf" link="18" stubbed="0" >g_bFirstCaller == true
AND g_bNoCreateConfFirstCaller == false</result>
            <result name="g_bFirstCaller&amp;&amp;NoCreateConf" link="43" stubbed="1" >g_bFirstCaller == true
AND g_bNoCreateConfFirstCaller == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("ADD CSR INTO SUBSCRIBER CONFERENCE, SET MUTE FLAG TO TRUE");
Session.g_oMS.bMuteFlag = true;]]></script>
          </scripts>
        </action>
        <action id="18" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=990 y=857 ?>
          <!--CreateAConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;CreateConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="22" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_oMS.strConferenceId ="";
Session.g_oMS.bPersistentFlag = true;
Session.g_oMS.nConferenceMaxParties = Session.s_nConferenceMaxParties;]]></script>
          </scripts>
        </action>
        <action id="20" plug-in="Pactolus.Branch.1" ><?xtml-editor x=742 y=1022 ?>
          <!--exceed max retry?-->
          <results >
            <result name="Default" link="21" stubbed="0"/>
            <result name="Counter &gt;= 10" link="36" stubbed="0" >f_sCounter &gt;= 10</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_sCounter++;
Session.g_strRetryFlag = "T";]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (2 == Result.id)
{
	Session.f_strReturnMsg = "FAIL TO AUTHORIZE PASSCODE, MAX WAITING FOR CONF RESOURCE";
}]]></script>
          </scripts>
        </action>
        <action id="21" plug-in="Pactolus.Sleep.1" ><?xtml-editor x=988 y=1015 ?>
          <!--2 secs-->
          <sleep xmlns="urn:www.pactolus.com:xtml:application" duration="2"/>
          <results >
            <result name="Default" link="32" stubbed="1"/>
          </results>
        </action>
        <action id="22" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1214 y=852 ?>
          <!--success?-->
          <results >
            <result name="Default" link="36" stubbed="1"/>
            <result name="f_nReturnCode == 0" link="23" stubbed="0" >f_nReturnCode == s_nSUCCESS</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (1 == Result.id)
{
	Session.f_strReturnMsg = "FAIL TO CREATE CONFERENCE";
}]]></script>
          </scripts>
        </action>
        <action id="23" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1448 y=851 ?>
          <!--set conference resource-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceSetConfResource&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="51" stubbed="0"/>
            <result name="SUCCESS" link="44" stubbed="0" >f_nReturnCode == s_nSUCCESS</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strConfResource = Session.g_oMS.strConferenceId;]]></script>
          </scripts>
        </action>
        <action id="24" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1928 y=839 ?>
          <!--AddMemberToConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;AddMemberToConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
            <parameter >g_oCallLegA</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="11" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_lMSConnectTime = Server.getUTCTime();]]></script>
          </scripts>
        </action>
        <action id="26" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=706 y=482 ?>
          <!--Remove member from conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;RemoveMemberFromConference&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="16" stubbed="0"/>
          </results>
        </action>
        <action id="28" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1510 y=117 ?>
          <!--Play Join Tone to conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;PlayPromptToConference&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
            <parameter >g_strLanguage</parameter>
            <parameter >s_nPROMPT_JOIN_TONE</parameter>
          </function>
          <results >
            <result name="Default" link="2" stubbed="0"/>
          </results>
        </action>
        <action id="29" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1922 y=694 ?>
          <!--Play Join Tone to conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;PlayPromptToConference&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
            <parameter >g_strLanguage</parameter>
            <parameter >s_nPROMPT_JOIN_TONE</parameter>
          </function>
          <results >
            <result name="Default" link="12" stubbed="0"/>
          </results>
        </action>
        <action id="30" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=758 y=123 ?>
          <!--RESPONSE SUCCESS-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strACDControllerIP" transaction="strTransactionId" message-name="s_strADD_CSR_TO_CONF" destination-port="nACDControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;returnCode&quot;" value="s_nSUCCESS"/>
            <parameter tag="&quot;reason&quot;" value="f_nReturnCode"/>
            <parameter tag="&quot;returnMsg&quot;" value="f_strReturnMsg"/>
            <parameter tag="&quot;connectionId&quot;" value="f_strUniqueId"/>
          </SOAP>
          <results >
            <result name="Default" link="39" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_nReturnCode = 0;
Session.f_strReturnMsg = "";
Server.logInfo("MEDIASERVER TYPE: " + Session.g_oMS.strType);
Server.logInfo("MEDIASERVER ENDPOINT: " + Session.g_oMS.strEndPoint);
Server.logInfo("MEDIASERVER CONNECTION Id : " + Session.g_oMS.strConnectionId);
Server.logInfo("MEDIASERVER CALL Id: " + Session.g_oMS.strCallId);
if ("PCS" == Session.g_oMS.strType)
{
	Session.f_strUniqueId = Session.g_oMS.strEndPoint;
	Server.logInfo("PCS MEDIASERVER, strUniqueId is: " + Session.f_strUniqueId);
}
else
{
	Session.f_strUniqueId = Session.g_oMS.strConnectionId;
	Server.logInfo("OTHER MEDIASERVER, strUniqueId is: " + Session.g_oMS.strConnectionId);
}]]></script>
          </scripts>
        </action>
        <action id="31" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1181 y=319 ?>
          <!--RESPONSE FAIL-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strACDControllerIP" transaction="strTransactionId" message-name="s_strADD_CSR_TO_CONF" destination-port="nACDControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;returnCode&quot;" value="s_nFAILURE"/>
            <parameter tag="&quot;reason&quot;" value="f_nReturnCode"/>
            <parameter tag="&quot;returnMsg&quot;" value="f_strReturnMsg"/>
            <parameter tag="&quot;connectionId&quot;" value="f_strUniqueId"/>
          </SOAP>
          <results >
            <result name="Default" link="15" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("MEDIASERVER TYPE: " + Session.g_oMS.strType);
Server.logInfo("MEDIASERVER ENDPOINT: " + Session.g_oMS.strEndPoint);
Server.logInfo("MEDIASERVER CONNECTION Id : " + Session.g_oMS.strConnectionId);
Server.logInfo("MEDIASERVER CALL Id: " + Session.g_oMS.strCallId);
if ("PCS" == Session.g_oMS.strType)
{
	Session.f_strUniqueId = Session.g_oMS.strEndPoint;
	Server.logInfo("PCS MEDIASERVER, strUniqueId is: " + Session.f_strUniqueId);
}
else
{
	Session.f_strUniqueId = Session.g_oMS.strConnectionId;
	Server.logInfo("OTHER MEDIASERVER, strUniqueId is: " + Session.g_oMS.strConnectionId);
}]]></script>
          </scripts>
        </action>
        <action id="32" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1191 y=475 ?>
          <!--authenticate pass code-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceAuthConfPassCode&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="31" stubbed="1"/>
            <result name="0 - Non First Caller" link="35" stubbed="1" >f_nReturnCode == 0</result>
            <result name="1 - First Caller" link="35" stubbed="1" >f_nReturnCode == 1</result>
            <result name="2 - Wait For Conf Resource" link="20" stubbed="1" >f_nReturnCode == 2</result>
            <result name="3 - Special FirstCaller" link="35" stubbed="1" >f_nReturnCode == 3</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[js_disable_event();
if (Session.s_nFIRSTCALLER == Session.f_nReturnCode)
{
	Session.g_bFirstCaller = true;
}
else
{
	Session.g_bFirstCaller = false;
}
if (Session.g_strConfResource.length <= 0)
{
	Session.g_bNullString = true;
}
else
{
	Session.g_bNullString = false;
}
switch (Session.f_nReturnCode)
{
	case -2:
		Server.logInfo("INFO: TOO EARLY PASSCODE");
		Session.f_strReturnMsg = "TOO EARLY PASSCODE";
		Session.g_nTerminationReason = 19;
		break;
	case -3:
		Server.logInfo("INFO: TOO LATE PASSCODE");
		Session.f_strReturnMsg = "TOO LATE PASSCODE";
		Session.g_nTerminationReason = 20;
		break;
	case -4:
		Server.logInfo("INFO: DISABLE SUBSCRIBER");
		Session.f_strReturnMsg = "DISABLE SUBSCRIBER";
		Session.g_nTerminationReason = 4;
		break;
	case -5:
		Server.logInfo("INFO: MAX ATTENDEES");
		Session.f_strReturnMsg = "MAX ATTENDEES";
		Session.g_nTerminationReason = 15;
		break;
	case -6:
		Server.logInfo("INFO: CONFERRENCE LOCKED");
		Session.f_strReturnMsg = "CONFERRENCE LOCKED";
		Session.g_nTerminationReason = 16;
		break;
	case -7:
		Server.logInfo("INFO: CONFERENCE ALREADY ENDED");
		Session.f_strReturnMsg = "CONFERENCE ALREADY ENDED";
		Session.g_nTerminationReason = 2;
		break;
	case -8:
		Server.logInfo("INFO: PASSCODE INSUED");
		Session.f_strReturnMsg = "PASSCODE INUSED";
		Session.g_nTerminationReason = 21;
		break;
	case -10:
		Server.logError("ERROR: NO CONFERENCE CONTROLLER");
		Session.f_strReturnMsg = "NO CONFERENCE CONTROLLER";
		Session.g_nTerminationReason = 6;
		break;
	case -11:
		Server.logError("ERROR: MODERATOR IS NOT IN CONFERENCE");
		Session.f_strReturnMsg = "MODERATOR IS NOT IN CONFERENCE";
		Session.g_nTerminationReason = 17;
		break;
	case -12:
		Server.logError("ERROR: DISABLE CORPORATE ACCOUNT");
		Session.f_strReturnMsg = "DISABLE CORPORATE ACCOUNT";
		Session.g_nTerminationReason = 6;
		break;
	case -13:
		Server.logError("ERROR: CONFERENCE DISABLED");
		Session.f_strReturnMsg = "CONFERENCE DISABLED";
		Session.g_nTerminationReason = 4;
		break;
	case -14:
		Server.logError("ERROR: RECURRING WRONG DAY");
		Session.f_strReturnMsg = "RECURRING WRONG DAY";
		Session.g_nTerminationReason = 26;
		break;
	case -15:
		Server.logError("ERROR: INSUFFICIENT BALANCE");
		Session.f_strReturnMsg = "INSUFFICIENT BALANCE";
		Session.g_nTerminationReason = 23;
		break;
	case -16:
		Server.logError("ERROR: PIN LOCKED");
		Session.f_strReturnMsg = "PIN LOCKED";
		Session.g_nTerminationReason = 24;
		break;
	case -17:
		Server.logError("ERROR: NO RATE");
		Session.f_strReturnMsg = "NO RATE";
		Session.g_nTerminationReason = 17;
		break;
	case -18:
		Server.logError("ERROR: CONFERENCE CANCELLED");
		Session.f_strReturnMsg = "CONFERENCE CANCELLED";
		Session.g_nTerminationReason = 25;
		break;
	case -98:
		Server.logError("ERROR: DB RESTARTING:" + Session.g_strPassCode);
		Session.f_strReturnMsg = "DB RESTARTING";
		Session.g_nTerminationReason = 6;
		break;
	case -99:
		Server.logError("ERROR: DB ERROR PASSCODE:" + Session.g_strPassCode);
		Session.f_strReturnMsg = "DB ERROR";
		Session.g_nTerminationReason = 6;
		break;
	default:
		Session.g_nTerminationReason = 6;
		break;
}
if (1 == Result.id)
{
	Session.f_strReturnMsg = "FAIL TO AUTHORIZE PASSCODE, RETURN CODE IS: " + Session.f_nReturnCode;
}
else if (4 == Result.id)
{
	Session.f_strReturnMsg = "FAIL TO AUTHORIZE PASSCODE, EXIT ON WAIT FOR CONF RESOURCE";
}]]></script>
          </scripts>
        </action>
        <action id="33" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1709 y=689 ?>
          <!--RESPONSE SUCCESS-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strACDControllerIP" transaction="strTransactionId" message-name="s_strADD_CSR_TO_CONF" destination-port="nACDControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;returnCode&quot;" value="s_nSUCCESS"/>
            <parameter tag="&quot;reason&quot;" value="f_nReturnCode"/>
            <parameter tag="&quot;returnMsg&quot;" value="f_strReturnMsg"/>
            <parameter tag="&quot;connectionId&quot;" value="f_strUniqueId"/>
          </SOAP>
          <results >
            <result name="Default" link="40" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_nReturnCode = 0;
Session.f_strReturnMsg = "";
Server.logInfo("MEDIASERVER TYPE: " + Session.g_oMS.strType);
Server.logInfo("MEDIASERVER ENDPOINT: " + Session.g_oMS.strEndPoint);
Server.logInfo("MEDIASERVER CONNECTION Id : " + Session.g_oMS.strConnectionId);
Server.logInfo("MEDIASERVER CALL Id: " + Session.g_oMS.strCallId);
if ("PCS" == Session.g_oMS.strType)
{
	Session.f_strUniqueId = Session.g_oMS.strEndPoint;
	Server.logInfo("PCS MEDIASERVER, strUniqueId is: " + Session.f_strUniqueId);
}
else
{
	Session.f_strUniqueId = Session.g_oMS.strConnectionId;
	Server.logInfo("OTHER MEDIASERVER, strUniqueId is: " + Session.g_oMS.strConnectionId);
}]]></script>
          </scripts>
        </action>
        <action id="35" plug-in="Pactolus.Branch.1" ><?xtml-editor x=431 y=756 ?>
          <results >
            <result name="Default" link="31" stubbed="1"/>
            <result name="0 - Non First Caller" link="17" stubbed="1" >f_nReturnCode == 0</result>
            <result name="1 - First Caller" link="17" stubbed="1" >f_nReturnCode == 1</result>
            <result name="2 - Wait For Conf Resource" link="20" stubbed="0" >f_nReturnCode == 2</result>
            <result name="3 - Special FirstCaller" link="17" stubbed="1" >f_nReturnCode == 3</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (1 == Result.id)
{
	Session.f_strReturnMsg = "FAIL TO AUTHORIZE PASSCODE, RETURN CODE IS: " + Session.f_nReturnCode;
}]]></script>
          </scripts>
        </action>
        <action id="36" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1005 y=1114 ?>
          <!--"psAPISceConfCallLegCompletion"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceConfCallLegCompletion&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="7" stubbed="1"/>
          </results>
        </action>
        <action id="37" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=2396 y=660 ?>
          <!--PARTY JOIN CONF-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="g_strZeroTransactionId" message-name="s_strCONF_JOIN" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
            <parameter tag="&quot;callerPassCode&quot;" value="s_strEMPTY_STRING"/>
            <parameter tag="&quot;moderatorFlag&quot;" value="g_strModeratorFlag"/>
            <parameter tag="&quot;callingNumber&quot;" value="g_strOriginationNumber"/>
            <parameter tag="&quot;callerFirstName&quot;" value="g_strFirstName"/>
            <parameter tag="&quot;callerLastName&quot;" value="g_strLastName"/>
            <parameter tag="&quot;callerOrganization&quot;" value="g_strCallerOrg"/>
            <parameter tag="&quot;soapPort&quot;" value="s_nSoapPort"/>
            <parameter tag="&quot;muteFlag&quot;" value="strCSRMuteFlag"/>
            <parameter tag="&quot;holdFlag&quot;" value="g_strHoldFlag"/>
            <parameter tag="&quot;mediaServerEndpoint&quot;" value="g_oMS.strConferenceId"/>
            <parameter tag="&quot;moderatorRequiredFlag&quot;" value="g_strModeratorRequiredFlag"/>
            <parameter tag="&quot;nameURL&quot;" value="g_strCallerRecordedName"/>
            <parameter tag="&quot;prepaidBalance&quot;" value="g_fPrepaidBalance"/>
            <parameter tag="&quot;MSConnectTime&quot;" value="g_lPartyJoinTime"/>
            <parameter tag="&quot;totalMeteredRate&quot;" value="g_fTotalMeteredRate"/>
            <parameter tag="&quot;totalFixedRate&quot;" value="g_fTotalFixedRate"/>
            <parameter tag="&quot;operatorFlag&quot;" value="g_strOperatorFlag"/>
            <parameter tag="&quot;dialOutExtNbr&quot;" value="g_strDialOutExtNbr"/>
            <parameter tag="&quot;dialOutRequestId&quot;" value="g_lDialOutRequestId"/>
            <parameter tag="&quot;confSessionId&quot;" value="g_strConfSessionId"/>
            <parameter tag="&quot;callLegId&quot;" value="g_strCallLegId"/>
            <parameter tag="&quot;subscriberFlag&quot;" value="&quot;F&quot;"/>
            <parameter tag="&quot;attendeeId&quot;" value="0"/>
            <parameter tag="&quot;accessNumber&quot;" value="g_strAccessNumber"/>
            <parameter tag="&quot;SIPCallId&quot;" value="g_oCallLegA.strCallId"/>
            <parameter tag="&quot;msConnectionId&quot;" value="strEndpointPlusConnectionId"/>
            <parameter tag="&quot;quickStartFlag&quot;" value="&quot;F&quot;"/>
            <parameter tag="&quot;anonymousCaller&quot;" value="strAnonymousCaller"/>
            <parameter tag="&quot;CSRRequestId&quot;" value="g_lACDRequestId"/>
            <parameter tag="&quot;ConfStatus&quot;" value="g_nReleaseToConfStatus"/>
            <parameter tag="&quot;AccessNumberType&quot;" value="g_nEventDnisType"/>
            <parameter tag="&quot;PartySchedId&quot;" value="g_lPartySchedId"/>
            <parameter tag="&quot;PartyDetailString&quot;" value="g_strPartyDetail"/>
            <parameter tag="&quot;SubConferenceId&quot;" value="g_strSubConferenceId"/>
            <parameter tag="&quot;ACDUserId&quot;" value="g_lACDUserId"/>
          </SOAP>
          <results >
            <result name="Default" link="2" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
        </action>
        <action id="38" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=2406 y=813 ?>
          <!--PARTY JOIN CONF-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="g_strZeroTransactionId" message-name="s_strCONF_JOIN" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
            <parameter tag="&quot;callerPassCode&quot;" value="g_strConferencePasscode"/>
            <parameter tag="&quot;moderatorFlag&quot;" value="g_strModeratorFlag"/>
            <parameter tag="&quot;callingNumber&quot;" value="g_strOriginationNumber"/>
            <parameter tag="&quot;callerFirstName&quot;" value="g_strFirstName"/>
            <parameter tag="&quot;callerLastName&quot;" value="g_strLastName"/>
            <parameter tag="&quot;callerOrganization&quot;" value="g_strCallerOrg"/>
            <parameter tag="&quot;soapPort&quot;" value="s_nSoapPort"/>
            <parameter tag="&quot;muteFlag&quot;" value="strCSRMuteFlag"/>
            <parameter tag="&quot;holdFlag&quot;" value="g_strHoldFlag"/>
            <parameter tag="&quot;mediaServerEndpoint&quot;" value="g_oMS.strConferenceId"/>
            <parameter tag="&quot;moderatorRequiredFlag&quot;" value="g_strModeratorRequiredFlag"/>
            <parameter tag="&quot;nameURL&quot;" value="g_strCallerRecordedName"/>
            <parameter tag="&quot;prepaidBalance&quot;" value="g_fPrepaidBalance"/>
            <parameter tag="&quot;MSConnectTime&quot;" value="g_lPartyJoinTime"/>
            <parameter tag="&quot;totalMeteredRate&quot;" value="g_fTotalMeteredRate"/>
            <parameter tag="&quot;totalFixedRate&quot;" value="g_fTotalFixedRate"/>
            <parameter tag="&quot;operatorFlag&quot;" value="g_strOperatorFlag"/>
            <parameter tag="&quot;dialOutExtNbr&quot;" value="g_strDialOutExtNbr"/>
            <parameter tag="&quot;dialOutRequestId&quot;" value="g_lDialOutRequestId"/>
            <parameter tag="&quot;confSessionId&quot;" value="g_strConfSessionId"/>
            <parameter tag="&quot;callLegId&quot;" value="g_strCallLegId"/>
            <parameter tag="&quot;subscriberFlag&quot;" value="&quot;F&quot;"/>
            <parameter tag="&quot;attendeeId&quot;" value="0"/>
            <parameter tag="&quot;accessNumber&quot;" value="g_strAccessNumber"/>
            <parameter tag="&quot;SIPCallId&quot;" value="g_oCallLegA.strCallId"/>
            <parameter tag="&quot;msConnectionId&quot;" value="strEndpointPlusConnectionId"/>
            <parameter tag="&quot;quickStartFlag&quot;" value="&quot;F&quot;"/>
            <parameter tag="&quot;anonymousCaller&quot;" value="strAnonymousCaller"/>
            <parameter tag="&quot;CSRRequestId&quot;" value="g_lACDRequestId"/>
            <parameter tag="&quot;ConfStatus&quot;" value="g_nReleaseToConfStatus"/>
            <parameter tag="&quot;AccessNumberType&quot;" value="g_nEventDnisType"/>
            <parameter tag="&quot;PartySchedId&quot;" value="g_lPartySchedId"/>
            <parameter tag="&quot;PartyDetailString&quot;" value="g_strPartyDetail"/>
            <parameter tag="&quot;SubConferenceId&quot;" value="g_strSubConferenceId"/>
            <parameter tag="&quot;ACDUserId&quot;" value="g_lACDUserId"/>
          </SOAP>
          <results >
            <result name="Default" link="2" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
        </action>
        <action id="39" plug-in="Pactolus.Branch.1" ><?xtml-editor x=989 y=121 ?>
          <!--play tone?-->
          <results >
            <result name="Default" link="2" stubbed="1"/>
            <result name="g_bPlayTone" link="41" stubbed="0" >g_bPlayTone == true</result>
          </results>
        </action>
        <action id="40" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1928 y=581 ?>
          <!--play tone?-->
          <results >
            <result name="Default" link="12" stubbed="1"/>
            <result name="g_bPlayTone" link="42" stubbed="0" >g_bPlayTone == true</result>
          </results>
        </action>
        <action id="41" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1268 y=121 ?>
          <!--acd-play-bridge-tone-->
          <results >
            <result name="Default" link="2" stubbed="1"/>
            <result name="acd-play-bridge-tone" link="28" stubbed="0" >s_strPLAY_BRIDGE_TONE match "T"</result>
          </results>
        </action>
        <action id="42" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2147 y=582 ?>
          <!--acd-play-bridge-tone-->
          <results >
            <result name="Default" link="12" stubbed="1"/>
            <result name="acd-play-bridge-tone" link="29" stubbed="1" >s_strPLAY_BRIDGE_TONE match "T"</result>
          </results>
        </action>
        <action id="43" plug-in="Pactolus.Branch.1" ><?xtml-editor x=978 y=694 ?>
          <!--add to sub conf?-->
          <results >
            <result name="Default" link="10" stubbed="0"/>
            <result name="subconfId != blank" link="45" stubbed="1" >f_bNullString == false</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_oMS.strConferenceId = Session.g_strConfResource;
Session.g_lMSConnectTime = Server.getUTCTime();
if (Session.strSubConferenceId.length > 0)
{
	Session.f_bNullString = false;
	Server.logInfo("HAS SUB CONFERENCE ID");
}
else
{
	Session.f_bNullString = true;
	Server.logInfo("HAS NO SUB CONFERENCE ID");
}]]></script>
          </scripts>
        </action>
        <action id="44" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1701 y=848 ?>
          <!--add to sub conf?-->
          <results >
            <result name="Default" link="24" stubbed="0"/>
            <result name="subconfId != blank" link="45" stubbed="0" >f_bNullString == false</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_oMS.strConferenceId = Session.g_strConfResource;
if (Session.strSubConferenceId.length > 0)
{
	Session.f_bNullString = false;
	Server.logInfo("HAS SUB CONFERENCE ID");
}
else
{
	Session.f_bNullString = true;
	Server.logInfo("HAS NO SUB CONFERENCE ID");
}]]></script>
          </scripts>
        </action>
        <action id="45" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1960 y=964 ?>
          <!--RESPONSE SUCCESS-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strACDControllerIP" transaction="strTransactionId" message-name="s_strADD_CSR_TO_CONF" destination-port="nACDControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;returnCode&quot;" value="s_nSUCCESS"/>
            <parameter tag="&quot;reason&quot;" value="f_nReturnCode"/>
            <parameter tag="&quot;returnMsg&quot;" value="f_strReturnMsg"/>
            <parameter tag="&quot;connectionId&quot;" value="f_strUniqueId"/>
          </SOAP>
          <results >
            <result name="Default" link="46" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_nReturnCode = 0;
Session.f_strReturnMsg = "";
Server.logInfo("MEDIASERVER TYPE: " + Session.g_oMS.strType);
Server.logInfo("MEDIASERVER ENDPOINT: " + Session.g_oMS.strEndPoint);
Server.logInfo("MEDIASERVER CONNECTION Id : " + Session.g_oMS.strConnectionId);
Server.logInfo("MEDIASERVER CALL Id: " + Session.g_oMS.strCallId);
if ("PCS" == Session.g_oMS.strType)
{
	Session.f_strUniqueId = Session.g_oMS.strEndPoint;
	Server.logInfo("PCS MEDIASERVER, strUniqueId is: " + Session.f_strUniqueId);
}
else
{
	Session.f_strUniqueId = Session.g_oMS.strConnectionId;
	Server.logInfo("OTHER MEDIASERVER, strUniqueId is: " + Session.g_oMS.strConnectionId);
}]]></script>
          </scripts>
        </action>
        <action id="46" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2198 y=966 ?>
          <!--CallPartyFlag==T?-->
          <results >
            <result name="Default" link="48" stubbed="0"/>
            <result name="g_strPartyPasscodeFlag==T" link="47" stubbed="0" >g_strPartyPasscodeFlag match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_lPartyJoinTime = Server.getUTCTime();
Server.logInfo("INFO: conference.PartyJoin.2: SEND PARTY JOIN ****");
Server.logInfo("INFO: conference.PartyJoin.2:  CONF CON IP = " + Session.g_strConfControllerIP);
Server.logInfo("INFO: conference.PartyJoin.2:  CONF CON PORT = " + Session.g_nConfControllerPort);
Server.logInfo("INFO: conference.PartyJoin.2:  CONF CON TRANS Id = " + Session.g_strTransactionId);
Server.logInfo("INFO: conference.PartyJoin.2:  CONF CON MSG NAME = " + Session.s_strCONF_JOIN);
Server.logInfo("INFO: conference.PartyJoin.2:  CONF EVENT Id =  " + Session.g_strConfEventId);
Server.logInfo("INFO: conference.PartyJoin.2:  CONF SCHED Id =  " + Session.g_strConfScheduleId);
Server.logInfo("INFO: conference.PartyJoin.2:  PASSCODE = " + Session.g_strPassCode);
Server.logInfo("INFO: conference.PartyJoin.2:  MODERATOR FLAG = " + Session.g_strModeratorFlag);
Server.logInfo("INFO: conference.PartyJoin.2:  CALLING NUMBER = " + Session.g_strOrigNbr);
Server.logInfo("INFO: conference.PartyJoin.2:  CALLER FIRST NAME = " + Session.g_strCallerFirstName);
Server.logInfo("INFO: conference.PartyJoin.2:  CALLER LAST NAME = " + Session.g_strCallerLastName);
Server.logInfo("INFO: conference.PartyJoin.2:  CALLER ORG = " + Session.g_strCallerOrg);
Server.logInfo("INFO: conference.PartyJoin.2:  SOAP PORT = " + Session.s_nSoapPort);]]></script>
          </scripts>
        </action>
        <action id="47" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=2457 y=1087 ?>
          <!--PARTY JOIN CONF-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="g_strZeroTransactionId" message-name="s_strCONF_JOIN" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
            <parameter tag="&quot;callerPassCode&quot;" value="g_strConferencePasscode"/>
            <parameter tag="&quot;moderatorFlag&quot;" value="g_strModeratorFlag"/>
            <parameter tag="&quot;callingNumber&quot;" value="g_strOriginationNumber"/>
            <parameter tag="&quot;callerFirstName&quot;" value="g_strFirstName"/>
            <parameter tag="&quot;callerLastName&quot;" value="g_strLastName"/>
            <parameter tag="&quot;callerOrganization&quot;" value="g_strCallerOrg"/>
            <parameter tag="&quot;soapPort&quot;" value="s_nSoapPort"/>
            <parameter tag="&quot;muteFlag&quot;" value="strCSRMuteFlag"/>
            <parameter tag="&quot;holdFlag&quot;" value="g_strHoldFlag"/>
            <parameter tag="&quot;mediaServerEndpoint&quot;" value="g_oMS.strConferenceId"/>
            <parameter tag="&quot;moderatorRequiredFlag&quot;" value="g_strModeratorRequiredFlag"/>
            <parameter tag="&quot;nameURL&quot;" value="g_strCallerRecordedName"/>
            <parameter tag="&quot;prepaidBalance&quot;" value="g_fPrepaidBalance"/>
            <parameter tag="&quot;MSConnectTime&quot;" value="g_lPartyJoinTime"/>
            <parameter tag="&quot;totalMeteredRate&quot;" value="g_fTotalMeteredRate"/>
            <parameter tag="&quot;totalFixedRate&quot;" value="g_fTotalFixedRate"/>
            <parameter tag="&quot;operatorFlag&quot;" value="g_strOperatorFlag"/>
            <parameter tag="&quot;dialOutExtNbr&quot;" value="g_strDialOutExtNbr"/>
            <parameter tag="&quot;dialOutRequestId&quot;" value="g_lDialOutRequestId"/>
            <parameter tag="&quot;confSessionId&quot;" value="g_strConfSessionId"/>
            <parameter tag="&quot;callLegId&quot;" value="g_strCallLegId"/>
            <parameter tag="&quot;subscriberFlag&quot;" value="&quot;F&quot;"/>
            <parameter tag="&quot;attendeeId&quot;" value="0"/>
            <parameter tag="&quot;accessNumber&quot;" value="g_strAccessNumber"/>
            <parameter tag="&quot;SIPCallId&quot;" value="g_oCallLegA.strCallId"/>
            <parameter tag="&quot;msConnectionId&quot;" value="strEndpointPlusConnectionId"/>
            <parameter tag="&quot;quickStartFlag&quot;" value="&quot;F&quot;"/>
            <parameter tag="&quot;anonymousCaller&quot;" value="strAnonymousCaller"/>
            <parameter tag="&quot;CSRRequestId&quot;" value="g_lACDRequestId"/>
            <parameter tag="&quot;ConfStatus&quot;" value="g_nReleaseToConfStatus"/>
            <parameter tag="&quot;AccessNumberType&quot;" value="g_nEventDnisType"/>
            <parameter tag="&quot;PartySchedId&quot;" value="g_lPartySchedId"/>
            <parameter tag="&quot;PartyDetailString&quot;" value="g_strPartyDetail"/>
            <parameter tag="&quot;SubConferenceId&quot;" value="g_strSubConferenceId"/>
            <parameter tag="&quot;ACDUserId&quot;" value="g_lACDUserId"/>
          </SOAP>
          <results >
            <result name="Default" link="2" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
        </action>
        <action id="48" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=2447 y=934 ?>
          <!--PARTY JOIN CONF-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="g_strZeroTransactionId" message-name="s_strCONF_JOIN" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
            <parameter tag="&quot;callerPassCode&quot;" value="s_strEMPTY_STRING"/>
            <parameter tag="&quot;moderatorFlag&quot;" value="g_strModeratorFlag"/>
            <parameter tag="&quot;callingNumber&quot;" value="g_strOriginationNumber"/>
            <parameter tag="&quot;callerFirstName&quot;" value="g_strFirstName"/>
            <parameter tag="&quot;callerLastName&quot;" value="g_strLastName"/>
            <parameter tag="&quot;callerOrganization&quot;" value="g_strCallerOrg"/>
            <parameter tag="&quot;soapPort&quot;" value="s_nSoapPort"/>
            <parameter tag="&quot;muteFlag&quot;" value="strCSRMuteFlag"/>
            <parameter tag="&quot;holdFlag&quot;" value="g_strHoldFlag"/>
            <parameter tag="&quot;mediaServerEndpoint&quot;" value="g_oMS.strConferenceId"/>
            <parameter tag="&quot;moderatorRequiredFlag&quot;" value="g_strModeratorRequiredFlag"/>
            <parameter tag="&quot;nameURL&quot;" value="g_strCallerRecordedName"/>
            <parameter tag="&quot;prepaidBalance&quot;" value="g_fPrepaidBalance"/>
            <parameter tag="&quot;MSConnectTime&quot;" value="g_lPartyJoinTime"/>
            <parameter tag="&quot;totalMeteredRate&quot;" value="g_fTotalMeteredRate"/>
            <parameter tag="&quot;totalFixedRate&quot;" value="g_fTotalFixedRate"/>
            <parameter tag="&quot;operatorFlag&quot;" value="g_strOperatorFlag"/>
            <parameter tag="&quot;dialOutExtNbr&quot;" value="g_strDialOutExtNbr"/>
            <parameter tag="&quot;dialOutRequestId&quot;" value="g_lDialOutRequestId"/>
            <parameter tag="&quot;confSessionId&quot;" value="g_strConfSessionId"/>
            <parameter tag="&quot;callLegId&quot;" value="g_strCallLegId"/>
            <parameter tag="&quot;subscriberFlag&quot;" value="&quot;F&quot;"/>
            <parameter tag="&quot;attendeeId&quot;" value="0"/>
            <parameter tag="&quot;accessNumber&quot;" value="g_strAccessNumber"/>
            <parameter tag="&quot;SIPCallId&quot;" value="g_oCallLegA.strCallId"/>
            <parameter tag="&quot;msConnectionId&quot;" value="strEndpointPlusConnectionId"/>
            <parameter tag="&quot;quickStartFlag&quot;" value="&quot;F&quot;"/>
            <parameter tag="&quot;anonymousCaller&quot;" value="strAnonymousCaller"/>
            <parameter tag="&quot;CSRRequestId&quot;" value="g_lACDRequestId"/>
            <parameter tag="&quot;ConfStatus&quot;" value="g_nReleaseToConfStatus"/>
            <parameter tag="&quot;AccessNumberType&quot;" value="g_nEventDnisType"/>
            <parameter tag="&quot;PartySchedId&quot;" value="g_lPartySchedId"/>
            <parameter tag="&quot;PartyDetailString&quot;" value="g_strPartyDetail"/>
            <parameter tag="&quot;SubConferenceId&quot;" value="g_strSubConferenceId"/>
            <parameter tag="&quot;ACDUserId&quot;" value="g_lACDUserId"/>
          </SOAP>
          <results >
            <result name="Default" link="2" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
        </action>
        <action id="50" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1911 y=1115 ?>
          <!--try again?-->
          <results >
            <result name="Default" link="18" stubbed="1"/>
            <result name="&gt;= 3?" link="54" stubbed="0" >nSetResourceRetry &gt;= 3</result>
          </results>
        </action>
        <action id="51" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1692 y=1117 ?>
          <!--"DeleteConference"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DeleteConference&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="50" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.nSetResourceRetry++;
Server.logInfo("FAIL TO SET CONF RESOURCE, DELETE CONFERENCE, TRY AGAIN WITH NEW CONFERENCE");]]></script>
          </scripts>
        </action>
        <action id="52" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1889 y=456 ?>
          <!--last caller?-->
          <results >
            <result name="Default" link="7" stubbed="1"/>
            <result name="f_nReturnCode == 1" link="53" stubbed="0" >f_nReturnCode == 1</result>
          </results>
        </action>
        <action id="53" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2123 y=458 ?>
          <!--delete conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DeleteConference&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="7" stubbed="1"/>
          </results>
        </action>
        <action id="54" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2148 y=1110 ?>
          <!--"psAPISceConfCallLegCompletion"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceConfCallLegCompletion&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="7" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("FAIL TO SET CONF RESOURCE, EXCEED MAX LIMIT, NOT TRY AGAIN");
Session.f_strReturnMsg = "FAIL TO SET CONF RESOURCE, EXCEED MAX TRY AGAIN";]]></script>
          </scripts>
        </action>
        <action id="55" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1676 y=459 ?>
          <!--"psAPISceConfCallLegCompletion"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceConfCallLegCompletion&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="52" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_strReturnMsg = "FAIL TO ADD MEMBER INTO CONFERENCE";]]></script>
          </scripts>
        </action>
        <action id="56" plug-in="Pactolus.Branch.1" ><?xtml-editor x=468 y=483 ?>
          <!--in private talk-->
          <results >
            <result name="Default" link="26" stubbed="0"/>
            <result name="g_bBeginPrivateTalk" link="57" stubbed="0" >g_bBeginPrivateTalk == true
</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bSubscriberConference = true;]]></script>
          </scripts>
        </action>
        <action id="57" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=724 y=593 ?>
          <!--"RemoveMemberFromConference"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;RemoveMemberFromConference&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oPrivateTalkMS</parameter>
          </function>
          <results >
            <result name="Default" link="31" stubbed="1"/>
            <result name="SUCCESS" link="58" stubbed="0" >f_nReturnCode == s_nSUCCESS
</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (1 == Result.id)
{
	Session.f_strReturnMsg = "CSR IN PRIVATE TALK, FAIL TO REMOVE FROM CONFERENCE";
}]]></script>
          </scripts>
        </action>
        <action id="58" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=938 y=592 ?>
          <!--"DeleteConference"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DeleteConference&quot;" return="nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oPrivateTalkMS</parameter>
          </function>
          <results >
            <result name="Default" link="16" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bBeginPrivateTalk = false;]]></script>
          </scripts>
        </action>
      </actions>
    </function>
    <function name="OnRemoveCSRFromConf" start="1" event="OnRemoveCSRFromConf" returns="void" >
      <parameters >
        <parameter name="strACDControllerIP" type="string" pass="byref"/>
        <parameter name="nACDControllerPort" type="i4" pass="byref"/>
        <parameter name="strTransactionId" type="string" pass="byref"/>
      </parameters>
      <local-vars >
        <var name="f_nReturnCode" type="i4" >-1</var>
      </local-vars>
      <actions >
        <action id="1" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=205 y=322 ?>
          <!--"DisconnectFromConference"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DisconnectFromConference&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="13" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: OnRemoveCSRFromConf");
js_disable_event();
Session.g_nTerminationReason = 27;
Session.g_strConfLeaveMsg = "CSR" + Session.g_lACDUserId;]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=704 y=401 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nReturnCode"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nCurrentState = Session.s_nSTATE_REMOVE_FROM_CONF;
Session.g_oMS.strCoachingMode = "";
Session.g_oMS.strCoacheeConnection = "";
Session.g_oMS.strCoachingFlag="";
Session.g_bCSRMicOn = false;
js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="8" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=682 y=312 ?>
          <!--"SendLogoutCSRIVR"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;SendLogoutCSRIVR&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="12" stubbed="0"/>
          </results>
        </action>
        <action id="9" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=712 y=471 ?>
          <!--HangUpPartyA-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpParty&quot;" return="" external-function="1" library="lib_callcontrol.xml" >
            <parameter >g_oCallLegA</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="11" stubbed="0"/>
          </results>
        </action>
        <action id="10" plug-in="Standard.EndSession.1" ><?xtml-editor x=1169 y=457 ?></action>
        <action id="11" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=943 y=460 ?>
          <!--OutdialCSRHangup-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strACDControllerIP" transaction="g_strZeroTransactionId" message-name="&quot;OutdialCSRHangup&quot;" destination-port="g_nACDControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;acdId&quot;" value="g_lACDUserId"/>
          </SOAP>
          <results >
            <result name="Default" link="10" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
        </action>
        <action id="12" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=934 y=310 ?>
          <!--HangUpPartyA-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpParty&quot;" return="" external-function="1" library="lib_callcontrol.xml" >
            <parameter >g_oCallLegA</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="10" stubbed="1"/>
          </results>
        </action>
        <action id="13" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=426 y=321 ?>
          <!--put caller on hold-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;PutPartyOnHold&quot;" return="f_nReturnCode" external-function="1" library="lib_callcontrol.xml" >
            <parameter >g_oCallLegA</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="8" stubbed="0"/>
            <result name="SUCCESS, !OutDial CSR" link="2" stubbed="0" >f_nReturnCode == s_nSUCCESS
AND g_bOutDialCSR == false</result>
            <result name="OutDialCSR" link="9" stubbed="0" >g_bOutDialCSR == true</result>
          </results>
        </action>
      </actions>
    </function>
    <function name="OnOptions" start="1" event="OnOptions" returns="void" >
      <parameters >
        <parameter name="strAccept" type="string" pass="byref"/>
        <parameter name="strAcceptEncoding" type="string" pass="byref"/>
        <parameter name="strAcceptLanguage" type="string" pass="byref"/>
        <parameter name="strAllow" type="string" pass="byref"/>
        <parameter name="strAllowEvents" type="string" pass="byref"/>
        <parameter name="strAuthorization" type="string" pass="byref"/>
        <parameter name="strCallId" type="string" pass="byref"/>
        <parameter name="strCallInfo" type="string" pass="byref"/>
        <parameter name="strContact" type="string" pass="byref"/>
        <parameter name="strContent" type="string" pass="byref"/>
        <parameter name="strContentDisposition" type="string" pass="byref"/>
        <parameter name="strContentEncoding" type="string" pass="byref"/>
        <parameter name="strContentLanguage" type="string" pass="byref"/>
        <parameter name="strContentType" type="string" pass="byref"/>
        <parameter name="strCSeq" type="string" pass="byref"/>
        <parameter name="strDate" type="string" pass="byref"/>
        <parameter name="strEncryption" type="string" pass="byref"/>
        <parameter name="strErrorInfo" type="string" pass="byref"/>
        <parameter name="strFrom" type="string" pass="byref"/>
        <parameter name="strMaxForwards" type="string" pass="byref"/>
        <parameter name="strMIMEVersion" type="string" pass="byref"/>
        <parameter name="strOrganization" type="string" pass="byref"/>
        <parameter name="strProxyAuthorization" type="string" pass="byref"/>
        <parameter name="strProxyRequire" type="string" pass="byref"/>
        <parameter name="strRecordRoute" type="string" pass="byref"/>
        <parameter name="strRemotePartyId" type="string" pass="byref"/>
        <parameter name="strReferredBy" type="string" pass="byref"/>
        <parameter name="strRequestUri" type="string" pass="byref"/>
        <parameter name="strRequire" type="string" pass="byref"/>
        <parameter name="strResponseKey" type="string" pass="byref"/>
        <parameter name="strRoute" type="string" pass="byref"/>
        <parameter name="strSupported" type="string" pass="byref"/>
        <parameter name="strTimestamp" type="string" pass="byref"/>
        <parameter name="strTo" type="string" pass="byref"/>
        <parameter name="strUserAgent" type="string" pass="byref"/>
        <parameter name="strVia" type="string" pass="byref"/>
      </parameters>
      <actions >
        <action id="1" plug-in="Pactolus.SipResponse.1" ><?xtml-editor x=259 y=270 ?>
          <!--200 OK-->
          <sip-response xmlns="urn:www.pactolus.com:xtml:sip" remove-via="0" reliable="0" increment-cseq-first="0" increment-cseq-last="0" >
            <call-id >strCallId</call-id>
            <contact >g_strContact</contact>
            <cseq >strCSeq</cseq>
            <from >strFrom</from>
            <status >"SIP/2.0 200 OK"</status>
            <to >strTo</to>
            <via >strVia</via>
          </sip-response>
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: OnOptions");
var newCSeq = new SipCSeq(Session.strCSeq);
var oldCSeq = new SipCSeq(Session.g_oCallLegA.strCSeq);

if(newCSeq.value >= oldCSeq.value) 
{
	newCSeq.increment() ;
	Session.g_oCallLegA.strCSeq = newCSeq.encode() ;
}]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=521 y=272 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
        </action>
      </actions>
    </function>
    <function name="OnSessionEnd" start="1" event="OnSessionEnd" returns="void" >
      <parameters >
        <parameter name="nSessionEndReason" type="i2" pass="byref"/>
      </parameters>
      <actions >
        <action id="1" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=241 y=234 ?>
          <!--DeleteMSConnection-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DeleteMSConnection&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="3" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: OnEndSession");
js_disable_event();]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=745 y=230 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="3" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=486 y=231 ?>
          <!--"psAPISceConfCallLegCompletion"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceConfCallLegCompletion&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="2" stubbed="0"/>
          </results>
        </action>
      </actions>
    </function>
    <function name="OnBye" start="1" event="OnBye" returns="void" >
      <parameters >
        <parameter name="strAccept" type="string" pass="byref"/>
        <parameter name="strAcceptEncoding" type="string" pass="byref"/>
        <parameter name="strAcceptLanguage" type="string" pass="byref"/>
        <parameter name="strAllow" type="string" pass="byref"/>
        <parameter name="strAllowEvents" type="string" pass="byref"/>
        <parameter name="strAuthorization" type="string" pass="byref"/>
        <parameter name="strCallId" type="string" pass="byref"/>
        <parameter name="strCSeq" type="string" pass="byref"/>
        <parameter name="strDate" type="string" pass="byref"/>
        <parameter name="strEncryption" type="string" pass="byref"/>
        <parameter name="strErrorInfo" type="string" pass="byref"/>
        <parameter name="strFrom" type="string" pass="byref"/>
        <parameter name="strMaxForwards" type="string" pass="byref"/>
        <parameter name="strMIMEVersion" type="string" pass="byref"/>
        <parameter name="strProxyAuthorization" type="string" pass="byref"/>
        <parameter name="strProxyRequire" type="string" pass="byref"/>
        <parameter name="strRecordRoute" type="string" pass="byref"/>
        <parameter name="strReferredBy" type="string" pass="byref"/>
        <parameter name="strRequestUri" type="string" pass="byref"/>
        <parameter name="strRequire" type="string" pass="byref"/>
        <parameter name="strResponseKey" type="string" pass="byref"/>
        <parameter name="strRoute" type="string" pass="byref"/>
        <parameter name="strSupported" type="string" pass="byref"/>
        <parameter name="strTimestamp" type="string" pass="byref"/>
        <parameter name="strTo" type="string" pass="byref"/>
        <parameter name="strUserAgent" type="string" pass="byref"/>
        <parameter name="strVia" type="string" pass="byref"/>
      </parameters>
      <actions >
        <action id="1" plug-in="Pactolus.SipResponse.1" ><?xtml-editor x=197 y=203 ?>
          <!--200 OK-->
          <sip-response xmlns="urn:www.pactolus.com:xtml:sip" remove-via="0" reliable="0" increment-cseq-first="0" increment-cseq-last="0" >
            <call-id >strCallId</call-id>
            <contact >g_strContact</contact>
            <cseq >strCSeq</cseq>
            <from >strFrom</from>
            <status >"SIP/2.0 200 OK"</status>
            <to >strTo</to>
            <via >strVia</via>
          </sip-response>
          <results >
            <result name="Default" link="5" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: OnBye");
js_disable_event();]]></script>
          </scripts>
        </action>
        <action id="3" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=884 y=51 ?>
          <!--"SendLogoutCSRIVR"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;SendLogoutCSRIVR&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="4" stubbed="1"/>
          </results>
        </action>
        <action id="4" plug-in="Standard.EndSession.1" ><?xtml-editor x=704 y=213 ?></action>
        <action id="5" plug-in="Pactolus.Branch.1" ><?xtml-editor x=441 y=197 ?>
          <!--what to do?-->
          <results >
            <result name="Default" link="8" stubbed="0"/>
            <result name="Direct caller to MS" link="4" stubbed="0" >g_nCurrentState == s_nSTATE_DIRECT_TO_MS</result>
            <result name="Collect Password" link="6" stubbed="0" >g_nCurrentState == s_nSTATE_COLLECT_PASSWORD</result>
            <result name="Send Login" link="3" stubbed="1" >g_nCurrentState == s_nSTATE_SEND_LOGIN</result>
            <result name="Wait for GUI login" link="3" stubbed="1" >g_nCurrentState == s_nSTATE_WAIT_GUI_LOGIN</result>
            <result name="Wait for Assignment" link="3" stubbed="1" >g_nCurrentState == s_nSTATE_WAIT_ASSIGNMENT</result>
            <result name="AddCSRToConf" link="7" stubbed="0" >g_nCurrentState == s_nSTATE_ADD_TO_CONF</result>
          </results>
        </action>
        <action id="6" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=724 y=292 ?>
          <!--DeleteMSConnection-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DeleteMSConnection&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="4" stubbed="1"/>
          </results>
        </action>
        <action id="7" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=741 y=416 ?>
          <!--"DisconnectFromConference"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DisconnectFromConference&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="3" stubbed="1"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 1;]]></script>
          </scripts>
        </action>
        <action id="8" plug-in="Pactolus.Branch.1" ><?xtml-editor x=648 y=60 ?>
          <!--currently in private talk?-->
          <results >
            <result name="Default" link="3" stubbed="0"/>
            <result name="g_bBeginPrivateTalk" link="9" stubbed="0" >g_bBeginPrivateTalk == true</result>
          </results>
        </action>
        <action id="9" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=892 y=146 ?>
          <!--s_strCSRPrivateTalkHangup-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="g_strZeroTransactionId" message-name="s_strCSRPrivateTalkHangup" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;conferenceId&quot;" value="g_lConferenceId"/>
            <parameter tag="&quot;callerPasscode&quot;" value="g_strCCGeneratedPasscode"/>
          </SOAP>
          <results >
            <result name="Default" link="10" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("SEND CSRPrivateTalkHangup");
Server.logInfo("Conference Controller IP is: " + Session.g_strConfControllerIP);
Server.logInfo("Conference Controller port is: " + Session.g_nConfControllerPort);
Server.logInfo("Conference ID is: " + Session.g_lConferenceId);
Server.logInfo("Caller Passcode is: " + Session.g_strCCGeneratedPasscode);]]></script>
          </scripts>
        </action>
        <action id="10" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1099 y=143 ?>
          <!--"RemoveMemberFromConference"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;RemoveMemberFromConference&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oPrivateTalkMS</parameter>
          </function>
          <results >
            <result name="Default" link="11" stubbed="0"/>
          </results>
        </action>
        <action id="11" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1323 y=139 ?>
          <!--"DeleteConference"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DeleteConference&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oPrivateTalkMS</parameter>
          </function>
          <results >
            <result name="Default" link="3" stubbed="1"/>
          </results>
        </action>
      </actions>
    </function>
    <function name="OnCancel" start="1" event="OnCancel" returns="void" >
      <parameters >
        <parameter name="strAccept" type="string" pass="byref"/>
        <parameter name="strAcceptEncoding" type="string" pass="byref"/>
        <parameter name="strAcceptLanguage" type="string" pass="byref"/>
        <parameter name="strAuthorization" type="string" pass="byref"/>
        <parameter name="strCallId" type="string" pass="byref"/>
        <parameter name="strContent" type="string" pass="byref"/>
        <parameter name="strContentDisposition" type="string" pass="byref"/>
        <parameter name="strContentType" type="string" pass="byref"/>
        <parameter name="strCSeq" type="string" pass="byref"/>
        <parameter name="strDate" type="string" pass="byref"/>
        <parameter name="strEncryption" type="string" pass="byref"/>
        <parameter name="strErrorInfo" type="string" pass="byref"/>
        <parameter name="strFrom" type="string" pass="byref"/>
        <parameter name="strMaxForwards" type="string" pass="byref"/>
        <parameter name="strProxyAuthorization" type="string" pass="byref"/>
        <parameter name="strProxyRequire" type="string" pass="byref"/>
        <parameter name="strRecordRoute" type="string" pass="byref"/>
        <parameter name="strRequestUri" type="string" pass="byref"/>
        <parameter name="strRequire" type="string" pass="byref"/>
        <parameter name="strResponseKey" type="string" pass="byref"/>
        <parameter name="strRoute" type="string" pass="byref"/>
        <parameter name="strSupported" type="string" pass="byref"/>
        <parameter name="strTimestamp" type="string" pass="byref"/>
        <parameter name="strTo" type="string" pass="byref"/>
        <parameter name="strUserAgent" type="string" pass="byref"/>
        <parameter name="strVia" type="string" pass="byref"/>
      </parameters>
      <actions >
        <action id="1" plug-in="Pactolus.Branch.1" ><?xtml-editor x=192 y=213 ?>
          <!--Connected to ms?-->
          <results >
            <result name="Default" link="3" stubbed="0"/>
            <result name="bCurrentlyConnected == true" link="2" stubbed="0" >g_oMS.bCurrentlyConnected == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: OnCancel");]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Pactolus.SipResponse.1" ><?xtml-editor x=451 y=272 ?>
          <!--200 OK-->
          <sip-response xmlns="urn:www.pactolus.com:xtml:sip" remove-via="0" reliable="0" increment-cseq-first="0" increment-cseq-last="0" >
            <call-id >strCallId</call-id>
            <contact >g_strContact</contact>
            <cseq >strCSeq</cseq>
            <from >strFrom</from>
            <status >"SIP/2.0 200 OK"</status>
            <to >strTo</to>
            <via >strVia</via>
          </sip-response>
          <results >
            <result name="Default" link="6" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="3" plug-in="Pactolus.SipResponse.1" ><?xtml-editor x=448 y=127 ?>
          <!--200 OK-->
          <sip-response xmlns="urn:www.pactolus.com:xtml:sip" remove-via="0" reliable="0" increment-cseq-first="0" increment-cseq-last="0" >
            <call-id >strCallId</call-id>
            <contact >g_strContact</contact>
            <cseq >strCSeq</cseq>
            <from >strFrom</from>
            <status >"SIP/2.0 200 OK"</status>
            <to >strTo</to>
            <via >strVia</via>
          </sip-response>
          <results >
            <result name="Default" link="4" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="4" plug-in="Pactolus.SipResponse.1" ><?xtml-editor x=700 y=125 ?>
          <!--487 Request Terminated-->
          <sip-response xmlns="urn:www.pactolus.com:xtml:sip" remove-via="0" reliable="0" increment-cseq-first="0" increment-cseq-last="0" >
            <call-id >strCallId</call-id>
            <contact >g_strContact</contact>
            <cseq >strCSeq</cseq>
            <from >strFrom</from>
            <status >"SIP/2.0 487 Request Terminated"</status>
            <to >strTo</to>
            <via >strVia</via>
          </sip-response>
          <results >
            <result name="Default" link="6" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[var cseq = new SipCSeq(Session.strCSeq);
cseq.method = "INVITE";
Session.strCSeq = cseq.encode();]]></script>
          </scripts>
        </action>
        <action id="6" plug-in="Standard.EndSession.1" ><?xtml-editor x=711 y=273 ?></action>
      </actions>
    </function>
    <function name="OnLogoutCSRGUINotify" start="5" event="OnLogoutCSRGUINotify" returns="void" >
      <parameters >
        <parameter name="strACDControllerIP" type="string" pass="byref"/>
        <parameter name="nACDControllerPort" type="i4" pass="byref"/>
        <parameter name="strTransactionId" type="string" pass="byref"/>
        <parameter name="lACDUserId" type="i8" pass="byref"/>
        <parameter name="strACDUserType" type="string" pass="byref"/>
      </parameters>
      <actions >
        <action id="5" plug-in="Pactolus.Branch.1" ><?xtml-editor x=2 y=219 ?>
          <results >
            <result name="Default" link="1" stubbed="1"/>
            <result name="g_bSentConfJoin" link="4" stubbed="0" >g_bSentConfJoinEvent == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: OnLogoutCSRGUINotify");
js_disable_event();]]></script>
          </scripts>
        </action>
        <action id="1" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=498 y=210 ?>
          <!--HangUpPartyA-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpParty&quot;" return="" external-function="1" library="lib_callcontrol.xml" >
            <parameter >g_oCallLegA</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="3" stubbed="0"/>
          </results>
        </action>
        <action id="2" plug-in="Standard.EndSession.1" ><?xtml-editor x=962 y=204 ?></action>
        <action id="3" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=752 y=204 ?>
          <!--"SendLogoutCSRIVR"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;SendLogoutCSRIVR&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="2" stubbed="0"/>
          </results>
        </action>
        <action id="4" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=234 y=208 ?>
          <!--"DisconnectFromConference"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DisconnectFromConference&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="1" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 27;]]></script>
          </scripts>
        </action>
      </actions>
    </function>
    <function name="OnCSRBeginAssignment" start="1" event="OnCSRBeginAssignment" returns="void" >
      <parameters >
        <parameter name="strACDControllerIP" type="string" pass="byref"/>
        <parameter name="nACDControllerPort" type="i4" pass="byref"/>
        <parameter name="strTransactionId" type="string" pass="byref"/>
        <parameter name="lAssignmentId" type="i8" pass="byref"/>
        <parameter name="lRequestId" type="i8" pass="byref"/>
        <parameter name="lACDUserId" type="i8" pass="byref"/>
        <parameter name="lAssignmentSkillId" type="i8" pass="byref"/>
        <parameter name="strAssignmentSkillName" type="string" pass="byref"/>
        <parameter name="lAssignmentLanguageId" type="i8" pass="byref"/>
        <parameter name="strAssignmentLanguageName" type="string" pass="byref"/>
        <parameter name="lAssignmentGroupId" type="i8" pass="byref"/>
        <parameter name="strAssignmentGroupName" type="string" pass="byref"/>
        <parameter name="nRequestType" type="i4" pass="byref"/>
        <parameter name="strRequestTypeName" type="string" pass="byref"/>
        <parameter name="lServiceProviderId" type="i8" pass="byref"/>
        <parameter name="strServiceProviderName" type="string" pass="byref"/>
        <parameter name="lOfferingId" type="i8" pass="byref"/>
        <parameter name="strOfferingName" type="string" pass="byref"/>
        <parameter name="strConfEventId" type="string" pass="byref"/>
        <parameter name="strModPasscode" type="string" pass="byref"/>
        <parameter name="strSubscriberAccount" type="string" pass="byref"/>
        <parameter name="strSubscriberFirstName" type="string" pass="byref"/>
        <parameter name="strSubscriberLastName" type="string" pass="byref"/>
        <parameter name="strCSRAppServerIP" type="string" pass="byref"/>
        <parameter name="strAssignmentType" type="string" pass="byref"/>
        <parameter name="lAssignmentDuration" type="i8" pass="byref"/>
        <parameter name="strSubscriberPin" type="string" pass="byref"/>
        <parameter name="strCSRAssignmentAction" type="string" pass="byref"/>
      </parameters>
      <actions >
        <action id="1" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=192 y=160 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: OnCSRBeginAssignment");
Server.logInfo("RECEIVE CSRBeginAssignment");
Server.logInfo("Assignment Id: " + Session.lAssignmentId);
Server.logInfo("Request Id: " + Session.lRequestId);
Server.logInfo("ACD User Id: " + Session.lACDUserId);
Server.logInfo("Assignment skill Id: " + Session.lAssignmentSkillId);
Server.logInfo("Assignment skill name: " + Session.strAssignmentSkillName);
Server.logInfo("Assignment language Id: " + Session.lAssignmentLanguageId);
Server.logInfo("Assignment language name: " + Session.strAssignmentLanguageName);
Server.logInfo("Assignment group Id: " + Session.lAssignmentGroupId);
Server.logInfo("Assignment group name: " + Session.strAssignmentGroupName);
Server.logInfo("Request type: " + Session.nRequestType);
Server.logInfo("Request type name: " + Session.strRequestTypeName);
Server.logInfo("Service Provider Id: " + Session.lServiceProviderId);
Server.logInfo("Service Provider name: " + Session.strServiceProviderName);
Server.logInfo("Offering Id: " + Session.lOfferingId);
Server.logInfo("Offering name: " + Session.strOfferingName);
Server.logInfo("Conf Event Id: " + Session.strConfEventId);
Server.logInfo("Mod passcode: " + Session.strModPasscode);
Server.logInfo("Subscriber Account: " + Session.strSubscriberAccount);
Server.logInfo("Subscriber First Name: " + Session.strSubscriberFirstName);
Server.logInfo("Subscriber Last Name: " + Session.strSubscriberLastName);
Server.logInfo("strCSRAppServerIP: " + Session.strCSRAppServerIP);
Server.logInfo("strAssignmentType: " + Session.strAssignmentType);
Server.logInfo("lAssignmentDuration: " + Session.lAssignmentDuration);
// don't do anything if action code is 20
if (Session.strCSRAssignmentAction != "20")
{
	//clear out variables
	Session.g_bSubscriberConference = false;
	Session.g_strConferencePasscode = "";
	Session.g_strConfEventId = "";
	Session.g_lServiceProviderId = 0;
	Session.g_nNbrLoginAttempts = 2;
	Session.g_nTerminationReason = 0;
	Session.g_bGotCSRBeginAssignment = true;
	//initialize media server object
	if (false == Session.g_bAlreadyInitMS)
	{
		js_initMS(Session.g_oMS, Session.s_strMSType);
		Session.g_oMS.strACDType = Session.s_strACDMediaServerType;
		Session.g_oMS.strConfType = Session.s_strConf_MS_Type;
		Session.g_oMS.nPacketizationPeriod = Session.s_nPacketizationPeriod;
		//ASN
		Session.g_oMS.nMaxActiveSpeakers = Session.s_nMaxActiveSpeakers;
		Session.g_oMS.nNbrActiveSpeakers = Session.s_nNbrActiveSpeakers;
		Session.g_oMS.nReportingInterval = Session.s_nReportingInterval;
		Session.g_oMS.nDBThreshold = Session.s_nDBThreshold;
		//AGC
		Session.g_oMS.nAGCTargetLevelIn = Session.s_nAGCTargetLevelIn;
		Session.g_oMS.nAGCMaxLevelIn = Session.s_nAGCMaxLevelIn;
		Session.g_oMS.nAGCTargetLevelOut = Session.s_nAGCTargetLevelOut;
		Session.g_oMS.nAGCMaxLevelOut = Session.s_nAGCMaxLevelOut;
		Session.g_bAlreadyInitMS = true;
	}
	Session.g_oMS.strEndPoint = "";
	Session.g_oMS.strConnectionId = "";
	Session.g_oMS.strCallId = "";
	Session.g_oMS.strContent = "";
	Session.g_oMS.strConferenceId = "";	//use through out
	Session.g_oMS.strType = Session.s_strMSType;
	Session.g_oMS.bMuteFlag = false;
	Session.g_oMS.bDeafFlag = false;
	Session.g_oMS.bCurrentlyInConf = false;
	Session.g_oMS.bCurrentlyConnected = false;
	if (Session.s_strMSRetryFlag == "T")
	{
		Session.g_oMS.bRetry = true;
	}
	else
	{
		Session.g_oMS.bRetry = false;
	}
}
Server.logInfo("g_oMS.nMaxActiveSpeakers: " + Session.g_oMS.nMaxActiveSpeakers);
Server.logInfo("g_oMS.nNbrActiveSpeakers: " + Session.g_oMS.nNbrActiveSpeakers);
Server.logInfo("g_oMS.nReportingInterval: " + Session.g_oMS.nReportingInterval);
Server.logInfo("g_oMS.nDBThreshold: " + Session.g_oMS.nDBThreshold);
Server.logInfo("g_oMS.strEndPoint: " + Session.g_oMS.strEndPoint);
Server.logInfo("g_oMS.strConnectionId: " + Session.g_oMS.strConnectionId);
Server.logInfo("g_oMS.strCallId: " + Session.g_oMS.strCallId);
Server.logInfo("g_oMS.bMuteFlag: " + Session.g_oMS.bMuteFlag);
Server.logInfo("g_oMS.bDeafFlag: " + Session.g_oMS.bDeafFlag);
Server.logInfo("g_oMS.strCodec: " + Session.g_oMS.strCodec);
Server.logInfo("g_oMS.strType: " + Session.g_oMS.strType);
Server.logInfo("g_oMS.bDTMFClampFlag: " + Session.g_oMS.bDTMFClampFlag);]]></script>
          </scripts>
        </action>
      </actions>
    </function>
    <function name="OnCSREndAssignment" start="2" event="OnCSREndAssignment" returns="void" >
      <parameters >
        <parameter name="strACDControllerIP" type="string" pass="byref"/>
        <parameter name="nACDControllerPort" type="i4" pass="byref"/>
        <parameter name="strTransactionId" type="string" pass="byref"/>
        <parameter name="lAssignmentId" type="i8" pass="byref"/>
        <parameter name="lRequestId" type="i8" pass="byref"/>
        <parameter name="lACDUserId" type="i8" pass="byref"/>
        <parameter name="strActionCode" type="string" pass="byref"/>
        <parameter name="strPasscode" type="string" pass="byref"/>
        <parameter name="strPrepaidPin" type="string" pass="byref"/>
        <parameter name="strPostpaidPin" type="string" pass="byref"/>
        <parameter name="strPostpaidAccountNumber" type="string" pass="byref"/>
        <parameter name="strOutdialPhoneNumber" type="string" pass="byref"/>
        <parameter name="nCSRAvailabilityState" type="i4" pass="byref"/>
        <parameter name="strBillableFlag" type="string" pass="byref"/>
        <parameter name="nReleaseToConfStatus" type="i4" pass="byref"/>
        <parameter name="lPartySchedId" type="i8" pass="byref"/>
        <parameter name="strPartyDetail" type="string" pass="byref"/>
        <parameter name="nDefaultAudioMode" type="i4" pass="byref"/>
        <parameter name="strSubConferenceId" type="string" pass="byref"/>
        <parameter name="strRequeueFlag" type="string" pass="byref"/>
      </parameters>
      <local-vars >
        <var name="f_nReturnCode" type="i4" >-1</var>
        <var name="f_strReturnMsg" type="string" ></var>
      </local-vars>
      <actions >
        <action id="2" plug-in="Pactolus.Branch.1" ><?xtml-editor x=90 y=134 ?>
          <!--AddCSRToConf state?-->
          <results >
            <result name="Default" link="17" stubbed="0"/>
            <result name="currentState==AddCSRToConf" link="6" stubbed="1" >g_nCurrentState == s_nSTATE_ADD_TO_CONF</result>
            <result name="currentState==RemoveFromConf" link="8" stubbed="1" >g_nCurrentState == s_nSTATE_REMOVE_FROM_CONF</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: OnCSREndAssignment");
Server.logInfo("RECEIVE CSREndAssignment");
Server.logInfo("Assignment Id: " + Session.lAssignmentId);
Server.logInfo("Request Id: " + Session.lRequestId);
Server.logInfo("ACD User Id: " + Session.lACDUserId);
Server.logInfo("Default Audio Mode: " + Session.nDefaultAudioMode);
Session.g_lEndTime = Server.getUTCTime();
Session.g_bGotCSRBeginAssignment = false;
Session.g_nReleaseToConfStatus = Session.nReleaseToConfStatus;
js_disable_event();]]></script>
          </scripts>
        </action>
        <action id="6" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=83 y=420 ?>
          <!--"DisconnectFromConference"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DisconnectFromConference&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="8" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nTerminationReason = 27;]]></script>
          </scripts>
        </action>
        <action id="7" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=647 y=279 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bCSRMicOn = false;
js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="8" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=312 y=417 ?>
          <!--put caller on hold-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;PutPartyOnHold&quot;" return="f_nReturnCode" external-function="1" library="lib_callcontrol.xml" >
            <parameter >g_oCallLegA</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="20" stubbed="0"/>
            <result name="SUCCESS, !OutDial CSR" link="17" stubbed="1" >f_nReturnCode == s_nSUCCESS
AND g_bOutDialCSR == false</result>
            <result name="OutDialCSR" link="13" stubbed="0" >g_bOutDialCSR == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="12" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=834 y=397 ?>
          <!--"SendLogoutCSRIVR"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;SendLogoutCSRIVR&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="21" stubbed="0"/>
          </results>
        </action>
        <action id="13" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=598 y=567 ?>
          <!--HangUpPartyA-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpParty&quot;" return="" external-function="1" library="lib_callcontrol.xml" >
            <parameter >g_oCallLegA</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="16" stubbed="0"/>
            <result name="SUCCESS" link="22" stubbed="0" >f_nReturnCode == s_nSUCCESS</result>
          </results>
        </action>
        <action id="14" plug-in="Standard.EndSession.1" ><?xtml-editor x=656 y=903 ?></action>
        <action id="15" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=631 y=100 ?>
          <!--RESPONSE SUCCESS-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strACDControllerIP" transaction="strTransactionId" message-name="s_strEND_ASSIGNMENT_RES" destination-port="nACDControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;returnCode&quot;" value="s_nSUCCESS"/>
            <parameter tag="&quot;reason&quot;" value="f_nReturnCode"/>
            <parameter tag="&quot;returnMsg&quot;" value="f_strReturnMsg"/>
          </SOAP>
          <results >
            <result name="Default" link="7" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_nReturnCode = 0;
Session.f_strReturnMsg = "";]]></script>
          </scripts>
        </action>
        <action id="16" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=848 y=562 ?>
          <!--RESPONSE FAIL-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strACDControllerIP" transaction="strTransactionId" message-name="s_strEND_ASSIGNMENT_RES" destination-port="nACDControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;returnCode&quot;" value="s_nFAILURE"/>
            <parameter tag="&quot;reason&quot;" value="f_nReturnCode"/>
            <parameter tag="&quot;returnMsg&quot;" value="f_strReturnMsg"/>
          </SOAP>
          <results >
            <result name="Default" link="14" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logError("END ASSIGNMENT, FAIL TO SEND BY TO CSR");]]></script>
          </scripts>
        </action>
        <action id="17" plug-in="Pactolus.Branch.1" ><?xtml-editor x=318 y=129 ?>
          <!--action code 8 or 10-->
          <results >
            <result name="Default" link="15" stubbed="0"/>
            <result name="action code 8 or 10" link="7" stubbed="0" >strActionCode match "8"
OR strActionCode match "10"</result>
          </results>
        </action>
        <action id="19" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=388 y=902 ?>
          <!--OutdialCSRHangup-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strACDControllerIP" transaction="g_strZeroTransactionId" message-name="&quot;OutdialCSRHangup&quot;" destination-port="nACDControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;acdId&quot;" value="g_lACDUserId"/>
          </SOAP>
          <results >
            <result name="Default" link="14" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
        </action>
        <action id="20" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=588 y=403 ?>
          <!--RESPONSE FAIL-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strACDControllerIP" transaction="strTransactionId" message-name="s_strEND_ASSIGNMENT_RES" destination-port="nACDControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;returnCode&quot;" value="s_nFAILURE"/>
            <parameter tag="&quot;reason&quot;" value="f_nReturnCode"/>
            <parameter tag="&quot;returnMsg&quot;" value="f_strReturnMsg"/>
          </SOAP>
          <results >
            <result name="Default" link="12" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logError("END ASSIGNMENT, FAIL TO PUT CSR ON HOLD");]]></script>
          </scripts>
        </action>
        <action id="21" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1086 y=395 ?>
          <!--HangUpPartyA-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpParty&quot;" return="f_nReturnCode" external-function="1" library="lib_callcontrol.xml" >
            <parameter >g_oCallLegA</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="14" stubbed="1"/>
          </results>
        </action>
        <action id="22" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=859 y=735 ?>
          <!--RESPONSE SUCCESS-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strACDControllerIP" transaction="strTransactionId" message-name="s_strEND_ASSIGNMENT_RES" destination-port="nACDControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;returnCode&quot;" value="s_nSUCCESS"/>
            <parameter tag="&quot;reason&quot;" value="f_nReturnCode"/>
            <parameter tag="&quot;returnMsg&quot;" value="f_strReturnMsg"/>
          </SOAP>
          <results >
            <result name="Default" link="23" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_nReturnCode = 0;
Session.f_strReturnMsg = "";]]></script>
          </scripts>
        </action>
        <action id="23" plug-in="Pactolus.Sleep.1" ><?xtml-editor x=115 y=913 ?>
          <!--8 secs-->
          <sleep xmlns="urn:www.pactolus.com:xtml:application" duration="8"/>
          <results >
            <result name="Default" link="19" stubbed="0"/>
          </results>
        </action>
      </actions>
    </function>
    <function name="psAPISceGetConfPassCode" start="1" event="psAPISceGetConfPassCode" returns="i4" >
      <local-vars >
        <var name="f_nReturnCode" type="i4" >-1</var>
      </local-vars>
      <actions >
        <action id="1" plug-in="Pactolus.JavaStaticMethod.1" ><?xtml-editor x=321 y=403 ?>
          <!--psAPISceGetConfPasscodeByConfID-->
          <java xmlns="urn:www.pactolus.com:xtml:application" class="&quot;com.pactolus.conferencing.psAPISceGetConfPasscodeByConfID&quot;" method="&quot;getPasscode&quot;" timeout="s_nTIMEOUT" return="" method-return-var="f_nReturnCode" method-return-type="0" >
            <parameter type="in" var-type="string" >g_strDBName</parameter>
            <parameter type="in" var-type="string" >g_strSessionId</parameter>
            <parameter type="in" var-type="string" >g_strConfEventId</parameter>
            <parameter type="inout" var-type="string" >g_strConferencePasscode</parameter>
          </java>
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="Success" link="3" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: psAPISceGetConfPassCode");
js_disable_event();
Server.logInfo("Input Parameters");
Server.logInfo("  DB Name : " + Session.g_strDBName);
Server.logInfo("  SessionId : " + Session.g_strSessionId);
Server.logInfo("  AppName : " + Session.s_strApplicationName);
Server.logInfo("  PIN : " + Session.g_strPassword);
Server.logInfo("  Origination Number : " + Session.g_strOriginationNumber);]]></script>
            <script language="javascript" timing="last" ><![CDATA[js_enable_event();
if (2 == Result.id)
{
	Server.logInfo("*********JAVA RETURN*********");
	Server.logInfo("psAPISceGetConfPasscodeByConfID returned " + Session.f_nReturnCode);
	Server.logInfo("Output Parameter");
	Server.logInfo("  CONFERENECE PASSCODE : " + Session.g_strConferencePasscode);

	if (-99 == Session.f_nReturnCode)
		Session.g_nErrorMsgNumber = 1001; //db error
	else if (-2 == Session.f_nReturnCode)
		Session.g_nErrorMsgNumber = 4011; //conference not found
	else
		Session.g_nErrorMsgNumber = 0;
}
else
{
	Server.logError("ERROR: FAIL TO AUTHENTICATE CSR, EXIT ON: " + Result.name);
	Session.g_nErrorMsgNumber = 1000; //jvm server error
}]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=545 y=394 ?>
          <!--s_nFAILURE-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nFAILURE"/>
        </action>
        <action id="3" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=549 y=512 ?>
          <!--f_nReturnCode-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nReturnCode"/>
        </action>
      </actions>
    </function>
    <function name="PlayErrorMsg" start="1" event="PlayErrorMsg" returns="i4" >
      <local-vars >
        <var name="f_nReturnCode" type="i4" >-1</var>
      </local-vars>
      <actions >
        <action id="1" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=386 y=241 ?>
          <!--outdial from MS-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;MSOutdialParty&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oCallLegA</parameter>
            <parameter >g_oMS</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="2" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: PlayErrorMsg");]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Pactolus.Branch.1" ><?xtml-editor x=629 y=234 ?>
          <!--success?-->
          <results >
            <result name="Default" link="3" stubbed="0"/>
            <result name="f_nReturnCode == 0" link="4" stubbed="0" >f_nReturnCode == s_nSUCCESS</result>
          </results>
        </action>
        <action id="3" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=867 y=231 ?>
          <!--s_nFAILURE-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nFAILURE"/>
        </action>
        <action id="4" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=874 y=330 ?>
          <!--"PlayErrorMsgPrompt"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;PlayErrorMsgPrompt&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
            <parameter >g_strLanguage</parameter>
            <parameter >g_nErrorMsgNumber</parameter>
          </function>
          <results >
            <result name="Default" link="6" stubbed="0"/>
          </results>
        </action>
        <action id="6" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=637 y=470 ?>
          <!--DeleteMSConnection-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DeleteMSConnection&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="7" stubbed="0"/>
          </results>
        </action>
        <action id="7" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=891 y=468 ?>
          <!--s_nSUCCESS-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nSUCCESS"/>
        </action>
      </actions>
    </function>
    <function name="psAPISceAuthConfPassCode" start="6" event="psAPISceAuthConfPassCode" returns="i4" >
      <local-vars >
        <var name="f_nReturnCode" type="i4" >-1</var>
        <var name="f_nNbrPassCodeRetries" type="i4" >0</var>
        <var name="f_strLanguage" type="string" ></var>
        <var name="strSubConfType" type="string" ></var>
      </local-vars>
      <actions >
        <action id="6" plug-in="Pactolus.JavaStaticMethod.1" ><?xtml-editor x=133 y=257 ?>
          <!--validatePassCode()-->
          <java xmlns="urn:www.pactolus.com:xtml:application" class="&quot;com.pactolus.conferencing.psAPISceAuthConfPasscodeB&quot;" method="&quot;validateConfPassCode&quot;" timeout="s_nTIMEOUT" return="" method-return-var="f_nReturnCode" method-return-type="0" >
            <parameter type="in" var-type="string" >g_strDBName</parameter>
            <parameter type="in" var-type="string" >g_strSessionId</parameter>
            <parameter type="in" var-type="string" >s_strApplicationName</parameter>
            <parameter type="in" var-type="string" >g_strPassCode</parameter>
            <parameter type="in" var-type="string" >g_strOriginationNumber</parameter>
            <parameter type="in" var-type="string" >g_strDestNbr</parameter>
            <parameter type="in" var-type="i4" >g_nAccessNumberId</parameter>
            <parameter type="in" var-type="i8" >g_lServiceProviderId</parameter>
            <parameter type="in" var-type="string" >g_strRetryFlag</parameter>
            <parameter type="in" var-type="string" >g_strSoapAddress</parameter>
            <parameter type="in" var-type="i4" >s_nSoapPort</parameter>
            <parameter type="in" var-type="i4" >g_nMaxRetryAllowed</parameter>
            <parameter type="in" var-type="i4" >g_nMaxRetryAllowed</parameter>
            <parameter type="in" var-type="string" >g_strOrigDomIntlFlag</parameter>
            <parameter type="in" var-type="i4" >g_nOrigCountryId</parameter>
            <parameter type="in" var-type="string" >g_strInfoDigits</parameter>
            <parameter type="in" var-type="string" >g_oCallLegA.strFrom</parameter>
            <parameter type="in" var-type="string" >g_oCallLegA.strTo</parameter>
            <parameter type="in" var-type="string" >g_oCallLegA.strCallId</parameter>
            <parameter type="in" var-type="string" >g_strSIPStatus</parameter>
            <parameter type="in" var-type="i8" >g_lStartTime</parameter>
            <parameter type="in" var-type="string" >g_strGWIPIngress</parameter>
            <parameter type="in" var-type="i4" >g_nGWPortIngress</parameter>
            <parameter type="in" var-type="string" >g_strGWIPEgress</parameter>
            <parameter type="in" var-type="i4" >g_nGWPortEgress</parameter>
            <parameter type="in" var-type="i4" >g_nRtpEncoding</parameter>
            <parameter type="in" var-type="i4" >g_nRtpClockRate</parameter>
            <parameter type="in" var-type="i4" >g_nCallMode</parameter>
            <parameter type="in" var-type="string" >g_strOutdialFlag</parameter>
            <parameter type="in" var-type="string" >g_strOrigCallingCode</parameter>
            <parameter type="in" var-type="string" >g_strOrigAreaCode</parameter>
            <parameter type="in" var-type="string" >g_strDestDomIntlFlag</parameter>
            <parameter type="in" var-type="i4" >g_nDestCountryId</parameter>
            <parameter type="in" var-type="string" >g_strDestCallingCode</parameter>
            <parameter type="in" var-type="string" >g_strDestAreaCode</parameter>
            <parameter type="in" var-type="string" >g_strSPTimeZone</parameter>
            <parameter type="in" var-type="string" >g_strModOutdialFlag</parameter>
            <parameter type="in" var-type="string" >g_strOperatorFlag</parameter>
            <parameter type="in" var-type="i4" >g_nDialPlanId</parameter>
            <parameter type="in" var-type="string" >g_strForceModeratorFlag</parameter>
            <parameter type="in" var-type="string" >g_strForceMuteFlag</parameter>
            <parameter type="in" var-type="string" >g_strUsedDefaultANIFlag</parameter>
            <parameter type="in" var-type="i4" >s_nSiteId</parameter>
            <parameter type="in" var-type="i4" >g_nRedirectStatus</parameter>
            <parameter type="in" var-type="i8" >g_lPartySchedId</parameter>
            <parameter type="in" var-type="string" >g_strModReAuthFlag</parameter>
            <parameter type="in" var-type="string" >strSubConfType</parameter>
            <parameter type="in" var-type="i4" >g_nReleaseToConfStatus</parameter>
            <parameter type="inout" var-type="i4" >g_nScheduleDuration</parameter>
            <parameter type="inout" var-type="string" >g_strScheduleStartTime</parameter>
            <parameter type="inout" var-type="i8" >g_lTimeAvailable</parameter>
            <parameter type="inout" var-type="string" >g_strConfScheduleId</parameter>
            <parameter type="inout" var-type="string" >g_strCallLegId</parameter>
            <parameter type="inout" var-type="string" >g_strConfResource</parameter>
            <parameter type="inout" var-type="string" >g_strConfEventId</parameter>
            <parameter type="inout" var-type="string" >g_strModeratorFlag</parameter>
            <parameter type="inout" var-type="string" >g_strConfControllerIP</parameter>
            <parameter type="inout" var-type="i4" >g_nConfControllerPort</parameter>
            <parameter type="inout" var-type="string" >g_strCallerFirstName</parameter>
            <parameter type="inout" var-type="string" >g_strCallerLastName</parameter>
            <parameter type="inout" var-type="string" >g_strCallerOrg</parameter>
            <parameter type="inout" var-type="string" >g_strPartyPasscodeFlag</parameter>
            <parameter type="inout" var-type="string" >g_strMuteFlag</parameter>
            <parameter type="inout" var-type="string" >g_strModeratorMutedFlag</parameter>
            <parameter type="inout" var-type="string" >g_strConferencePasscode</parameter>
            <parameter type="inout" var-type="i4" >g_nMaxCallerHoldTime</parameter>
            <parameter type="inout" var-type="string" >g_strPostPinPromptType</parameter>
            <parameter type="inout" var-type="i4" >g_nPostPinPromptIndex</parameter>
            <parameter type="inout" var-type="string" >g_strPostPinPromptUrl</parameter>
            <parameter type="inout" var-type="i4" >g_nServiceId</parameter>
            <parameter type="inout" var-type="string" >g_strModeratorRequiredFlag</parameter>
            <parameter type="inout" var-type="string" >g_strBillingCodeFlag</parameter>
            <parameter type="inout" var-type="string" >g_strRecordNamesFlag</parameter>
            <parameter type="inout" var-type="i4" >g_nArriveDepartOption</parameter>
            <parameter type="inout" var-type="string" >f_strLanguage</parameter>
            <parameter type="inout" var-type="i4" >g_nBillingType</parameter>
            <parameter type="inout" var-type="float" >g_fPrepaidBalance</parameter>
            <parameter type="inout" var-type="i4" >g_nCurrencyId</parameter>
            <parameter type="inout" var-type="i8" >g_lSubscriberId</parameter>
            <parameter type="inout" var-type="string" >g_strExistingCallLegId</parameter>
            <parameter type="inout" var-type="string" >g_strExistingSessionId</parameter>
            <parameter type="inout" var-type="string" >g_strHoldBillingFlag</parameter>
            <parameter type="inout" var-type="i4" >g_nRoundSeconds</parameter>
            <parameter type="inout" var-type="string" >g_strRechargeFlag</parameter>
            <parameter type="inout" var-type="i4" >g_nSubExpirationType</parameter>
            <parameter type="inout" var-type="i4" >g_nOfferingId</parameter>
            <parameter type="inout" var-type="string" >g_strSubscriberAccount</parameter>
            <parameter type="inout" var-type="string" >g_strPlayPartyCountFlag</parameter>
            <parameter type="inout" var-type="i4" >g_nCurrentNbrCallegs</parameter>
            <parameter type="inout" var-type="string" >g_strIsSubscriberFlag</parameter>
            <parameter type="inout" var-type="i4" >g_nPayphoneSrchgRateId</parameter>
            <parameter type="inout" var-type="float" >g_fPayphoneSrchgRateAmt</parameter>
            <parameter type="inout" var-type="i4" >g_nAccessNumberRateId</parameter>
            <parameter type="inout" var-type="float" >g_fAccessNumberRateAmt</parameter>
            <parameter type="inout" var-type="i4" >g_nAccessNumberRateType</parameter>
            <parameter type="inout" var-type="i4" >g_nMeteredRate1Id</parameter>
            <parameter type="inout" var-type="float" >g_fMeteredRate1Amt</parameter>
            <parameter type="inout" var-type="i4" >g_nMeteredRate2Id</parameter>
            <parameter type="inout" var-type="float" >g_fMeteredRate2Amt</parameter>
            <parameter type="inout" var-type="i4" >g_nFixedRate1Id</parameter>
            <parameter type="inout" var-type="float" >g_fFixedRate1Amt</parameter>
            <parameter type="inout" var-type="i4" >g_nFixedRate2Id</parameter>
            <parameter type="inout" var-type="float" >g_fFixedRate2Amt</parameter>
            <parameter type="inout" var-type="float" >g_fTotalMeteredRate</parameter>
            <parameter type="inout" var-type="float" >g_fTotalFixedRate</parameter>
            <parameter type="inout" var-type="string" >g_strConfSessionId</parameter>
            <parameter type="inout" var-type="string" >g_strPromptOnOutdialFlag</parameter>
            <parameter type="inout" var-type="string" >g_strAutoRecordFlag</parameter>
            <parameter type="inout" var-type="string" >g_strConfRecordAllowed</parameter>
            <parameter type="inout" var-type="string" >g_strHomeCallingCode</parameter>
            <parameter type="inout" var-type="i4" >g_nHomeCountryId</parameter>
            <parameter type="inout" var-type="string" >g_strOutdialCLI</parameter>
            <parameter type="inout" var-type="i4" >g_nAttendeeId</parameter>
            <parameter type="inout" var-type="i4" >g_nOperatorAssistType</parameter>
            <parameter type="inout" var-type="string" >g_strQuickStartFlag</parameter>
            <parameter type="inout" var-type="string" >g_strMSResourceName</parameter>
            <parameter type="inout" var-type="string" >g_strAlternateSiteIP</parameter>
            <parameter type="inout" var-type="i4" >g_nAlternateSitePort</parameter>
            <parameter type="inout" var-type="string" >g_strConfSiteMovedFlag</parameter>
            <parameter type="inout" var-type="string" >g_strCCIPMovedFrom</parameter>
            <parameter type="inout" var-type="i4" >g_nCCPortMovedFrom</parameter>
            <parameter type="inout" var-type="string" >g_strCCIPMovedTo</parameter>
            <parameter type="inout" var-type="i4" >g_nCCPortMovedTo</parameter>
            <parameter type="inout" var-type="i4" >g_nMinutesTooEarly</parameter>
            <parameter type="inout" var-type="i4" >g_nOutdialOption</parameter>
            <parameter type="inout" var-type="string" >g_strMutedPartyPassCode</parameter>
            <parameter type="inout" var-type="string" >g_strReservationlessFlag</parameter>
            <parameter type="inout" var-type="i8" >g_lPartySchedId</parameter>
            <parameter type="inout" var-type="string" >g_strPartyDetail</parameter>
            <parameter type="inout" var-type="i4" >g_nDefaultAudioMode</parameter>
            <parameter type="inout" var-type="string" >g_strPlayFirstCaller</parameter>
            <parameter type="inout" var-type="i4" >g_nPasscodeScheme</parameter>
            <parameter type="inout" var-type="i4" >g_nCurrNbrMods</parameter>
            <parameter type="inout" var-type="string" >g_strGlobalMusicOnFlag</parameter>
          </java>
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="Success" link="3" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: psAPISceAuthConfPassCode");
Session.f_nReturnCode = -86;
js_disable_event();
Session.g_nDialPlanId = Number(Session.s_strOutdialDialingPlan);
Server.logInfo("INFO: ********** JAVA CALLING AuthConfPasscode *********");
Server.logInfo("INFO: BEFORE DB name = " + Session.g_strDBName);
Server.logInfo("INFO: BEFORE session id = " + Session.g_strSessionId);
Server.logInfo("INFO: BEFORE pass code = " + Session.g_strConferencePasscode);
Server.logInfo("INFO: BEFORE pass code = " + Session.g_strPassCode);
Server.logInfo("INFO: BEFORE access number = " + Session.g_strAccessNumber);
Server.logInfo("INFO: BEFORE sched duration = " + Session.g_nScheduleDuration);
Server.logInfo("INFO: BEFORE sched start time = " + Session.g_strScheduleStartTime);
Server.logInfo("INFO: BEFORE time available = " + Session.g_lTimeAvailable);
Server.logInfo("INFO: BEFORE sched Id = " + Session.g_strConfScheduleId);
Server.logInfo("INFO: BEFORE call leg Id = " + Session.g_strCallLegId);
Server.logInfo("INFO: BEFORE access number Id = " + Session.g_nAccessNumberId);
Server.logInfo("INFO: BEFORE conf resource = " + Session.g_strConfResource);
Server.logInfo("INFO: BEFORE conf event Id = " + Session.g_strConfEventId);
if (2 == Session.g_nReleaseToConfStatus)
	Session.strSubConfType = "CO";
else if (3 == Session.g_nReleaseToConfStatus)
	Session.strSubConfType = "CL";
else
	Session.strSubConfType = "";
Server.logInfo("Conf Status IS: " + Session.g_nReleaseToConfStatus);
Server.logInfo("Sub Conference Type IS: " + Session.strSubConfType);]]></script>
            <script language="javascript" timing="last" ><![CDATA[Server.logInfo("INFO: BEFORE pass code = " + Session.g_strConferencePasscode);
Server.logInfo("INFO: BEFORE pass code = " + Session.g_strPassCode);
Server.logInfo("INFO: ********** iJavaReturnCode " + Session.f_nReturnCode);
if (Result.id == 2)
{
	switch (Session.f_nReturnCode)
	{
		case 1:
			Session.g_strSetStateToGetConfRes = "T";  //first caller
			break;
		case -99:
		case -98:
		case -50:
			Session.g_nErrorMsgNumber = 1001; //db error
			break;
		case -1:
			Session.g_nErrorMsgNumber = 1010; //invalid passcode
			//Session.g_nNbrPassCodeRetries++;
			break;
		case -2:
			Session.g_nErrorMsgNumber = 4002; //too early
			break;
		case -3:
			Session.g_nErrorMsgNumber = 4003; //too late
			break;
		case -4:
			Session.g_nErrorMsgNumber = 1005; //disable subscriber
			break;
		case -5:
			Session.g_nErrorMsgNumber = 4004; //max attendees
			break;
		case -6:
			Session.g_nErrorMsgNumber = 4005; //locked conf
			break;
		case -7:
			Session.g_nErrorMsgNumber = 4006; //terminated conf
			break;
		case -8:
			Session.g_nErrorMsgNumber = 1011; //passcode in used
			break;
		case -10:
			Session.g_nErrorMsgNumber = 4008; //no conf controller
			break;
		case -12:
			Session.g_nErrorMsgNumber = 1006; //disable corp acct
			break;
		case -13:
			Session.g_nErrorMsgNumber = 4009; //disabled conf
			break;
		case -14:
			Session.g_nErrorMsgNumber = 4010; //recurring wrong day
			break;
		default:
			Session.g_nErrorMsgNumber = 1001;
			break;
	}
}
else
{
	Server.logError("ERROR: FAIL TO VALIDATE PASSCODE, EXIT ON: " + Result.name);
	Session.g_nTerminationReason = 6;
	Session.g_nErrorMsgNumber = 1000; //jvm server error
}]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=473 y=183 ?>
          <!--FAILURE-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nFAILURE"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="3" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=488 y=343 ?>
          <!--return code from java
hard code time avail-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nReturnCode"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (Session.g_strMuteFlag == "T")
{
	Session.g_oMS.bMuteFlag = true;
}
if (Session.f_strLanguage.length > 0)
{
	Session.g_strLanguage = Session.f_strLanguage;
}
Session.g_bMustWriteCDR = true;
if (3 == Session.f_nReturnCode)
{
	Server.logInfo("FIRST CALLER, BUT NO NEED TO CREATE CONFERENCE, GLOBAL MUSIC IS ON");
	Session.g_bNoCreateConfFirstCaller = true;
}
else
{
	Session.g_bNoCreateConfFirstCaller = false;
}
Session.g_bNotifyCCAudioModeChange = true;
js_enable_event();]]></script>
          </scripts>
        </action>
      </actions>
    </function>
    <function name="DisconnectFromConference" start="11" event="DisconnectFromConference" returns="i4" >
      <local-vars >
        <var name="f_nReturnCode" type="i4" >-1</var>
        <var name="strTransferedFlag" type="string" >F</var>
        <var name="strConferenceId" type="string" ></var>
        <var name="strDeleteSubConf" type="string" ></var>
      </local-vars>
      <actions >
        <action id="11" plug-in="Pactolus.Branch.1" ><?xtml-editor x=118 y=124 ?>
          <!--play tone?-->
          <results >
            <result name="Default" link="13" stubbed="1"/>
            <result name="g_bPlayTone" link="12" stubbed="0" >g_bPlayTone == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: DisconnectFromConference");]]></script>
          </scripts>
        </action>
        <action id="1" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1052 y=116 ?>
          <!--Remove member from conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;RemoveMemberFromConference&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="3" stubbed="0"/>
          </results>
        </action>
        <action id="2" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1523 y=114 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_oMS.strConferenceId = "";]]></script>
          </scripts>
        </action>
        <action id="3" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1276 y=115 ?>
          <!--subscriber conference?-->
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="subscriberConference==true" link="5" stubbed="1" >g_bSubscriberConference == true</result>
          </results>
        </action>
        <action id="4" plug-in="Pactolus.Branch.1" ><?xtml-editor x=119 y=313 ?>
          <!--CallPartyFlag==T?-->
          <results >
            <result name="Default" link="6" stubbed="0"/>
            <result name="g_strPartyPasscodeFlag==T" link="5" stubbed="0" >g_strPartyPasscodeFlag match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("Session.g_strSubConferenceId : " + Session.g_strSubConferenceId);
Server.logInfo("Session.g_strConfScheduleId : " + Session.g_strConfScheduleId);
if (Session.g_bCurrentlyInSubConf)
{
	Server.logInfo("CURRENTLY IN SUB CONFERENCE");
	if (0 == Session.g_strSubConferenceId.length)
	{
		Server.logError("ERROR: CURRENTLY IN SUB CONFERENCE, BUT SUB CONFERENCE ID IS BLANK");
		Session.strConferenceId = Session.g_strConfScheduleId;	
	}
	else
	{
		Session.strConferenceId = Session.g_strSubConferenceId;
	}
	Session.g_bCurrentlyInSubConf = false;
}
else
{
	Session.strConferenceId = Session.g_strConfScheduleId;
}]]></script>
          </scripts>
        </action>
        <action id="5" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=380 y=389 ?>
          <!--PARTY LEAVE CONF-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="g_strZeroTransactionId" message-name="s_strCONF_LEAVE" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;conferenceId&quot;" value="strConferenceId"/>
            <parameter tag="&quot;callerPassCode&quot;" value="g_strCCGeneratedPasscode"/>
            <parameter tag="&quot;disconnectTime&quot;" value="g_lEndTime"/>
            <parameter tag="&quot;reasonCode&quot;" value="g_nConfLeaveReason"/>
            <parameter tag="&quot;reasonMsg&quot;" value="g_strConfLeaveMsg"/>
            <parameter tag="&quot;transferedFlag&quot;" value="strTransferedFlag"/>
          </SOAP>
          <results >
            <result name="Default" link="15" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("Session.g_strSubConferenceId : " + Session.g_strSubConferenceId);
Server.logInfo("Session.g_strConfScheduleId : " + Session.g_strConfScheduleId);
if (Session.g_bCurrentlyInSubConf)
{
	Server.logInfo("CURRENTLY IN SUB CONFERENCE");
	if (0 == Session.g_strSubConferenceId.length)
	{
		Server.logError("ERROR: CURRENTLY IN SUB CONFERENCE, BUT SUB CONFERENCE ID IS BLANK");
		Session.strConferenceId = Session.g_strConfScheduleId;	
	}
	else
	{
		Session.strConferenceId = Session.g_strSubConferenceId;
	}
}
else
{
	Session.strConferenceId = Session.g_strConfScheduleId;
}]]></script>
          </scripts>
        </action>
        <action id="6" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=365 y=251 ?>
          <!--PARTY LEAVE CONF-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="g_strZeroTransactionId" message-name="s_strCONF_LEAVE" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;conferenceId&quot;" value="strConferenceId"/>
            <parameter tag="&quot;callerPassCode&quot;" value="s_strEMPTY_STRING"/>
            <parameter tag="&quot;disconnectTime&quot;" value="g_lEndTime"/>
            <parameter tag="&quot;reasonCode&quot;" value="g_nConfLeaveReason"/>
            <parameter tag="&quot;reasonMsg&quot;" value="g_strConfLeaveMsg"/>
            <parameter tag="&quot;transferedFlag&quot;" value="strTransferedFlag"/>
          </SOAP>
          <results >
            <result name="Default" link="15" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("Session.g_strSubConferenceId : " + Session.g_strSubConferenceId);
Server.logInfo("Session.g_strConfScheduleId : " + Session.g_strConfScheduleId);
if (Session.g_bCurrentlyInSubConf)
{
	Server.logInfo("CURRENTLY IN SUB CONFERENCE");
	if (0 == Session.g_strSubConferenceId.length)
	{
		Server.logError("ERROR: CURRENTLY IN SUB CONFERENCE, BUT SUB CONFERENCE ID IS BLANK");
		Session.strConferenceId = Session.g_strConfScheduleId;	
	}
	else
	{
		Session.strConferenceId = Session.g_strSubConferenceId;
	}
}
else
{
	Session.strConferenceId = Session.g_strConfScheduleId;
}]]></script>
          </scripts>
        </action>
        <action id="7" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=141 y=553 ?>
          <!--"psAPISceConfCallLegCompletion"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceConfCallLegCompletion&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="8" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bSentConfJoinEvent = false;
if (Session.g_bCurrentlyInSubConf)
{
	Session.g_bCurrentlyInSubConf = false;
}]]></script>
          </scripts>
        </action>
        <action id="8" plug-in="Pactolus.Branch.1" ><?xtml-editor x=375 y=548 ?>
          <!--last caller?-->
          <results >
            <result name="Default" link="2" stubbed="1"/>
            <result name="f_nReturnCode == 1" link="9" stubbed="0" >f_nReturnCode == 1</result>
          </results>
        </action>
        <action id="9" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=609 y=550 ?>
          <!--delete conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DeleteConference&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="2" stubbed="1"/>
          </results>
        </action>
        <action id="10" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=604 y=122 ?>
          <!--play depart tone to conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;PlayPromptToConference&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
            <parameter >g_strLanguage</parameter>
            <parameter >s_nPROMPT_DEPART_TONE</parameter>
          </function>
          <results >
            <result name="Default" link="13" stubbed="0"/>
          </results>
        </action>
        <action id="12" plug-in="Pactolus.Branch.1" ><?xtml-editor x=370 y=124 ?>
          <!--acd-play-bridge-tone-->
          <results >
            <result name="Default" link="13" stubbed="1"/>
            <result name="acd-play-bridge-tone" link="10" stubbed="0" >s_strPLAY_BRIDGE_TONE match "T"</result>
          </results>
        </action>
        <action id="13" plug-in="Pactolus.Branch.1" ><?xtml-editor x=838 y=121 ?>
          <!--in sub?-->
          <results >
            <result name="Default" link="1" stubbed="0"/>
            <result name="g_bCurrentlyInSub" link="14" stubbed="0" >g_bCurrentlyInSubConf == true</result>
          </results>
        </action>
        <action id="14" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1069 y=237 ?>
          <!--Remove member from sub conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;RemoveMemberFromConference&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oSubConfMS</parameter>
          </function>
          <results >
            <result name="Default" link="3" stubbed="1"/>
          </results>
        </action>
        <action id="15" plug-in="Pactolus.Branch.1" ><?xtml-editor x=608 y=248 ?>
          <!--in sub?-->
          <results >
            <result name="Default" link="7" stubbed="1"/>
            <result name="g_bCurrentlyInSub" link="18" stubbed="0" >g_bCurrentlyInSubConf == true</result>
          </results>
        </action>
        <action id="16" plug-in="Pactolus.Branch.1" ><?xtml-editor x=832 y=385 ?>
          <results >
            <result name="Default" link="7" stubbed="1"/>
            <result name="strDeleteSubConf==T" link="17" stubbed="0" >strDeleteSubConf match "T"</result>
          </results>
        </action>
        <action id="17" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1068 y=382 ?>
          <!--delete sub conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DeleteConference&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oSubConfMS</parameter>
          </function>
          <results >
            <result name="Default" link="7" stubbed="1"/>
          </results>
        </action>
        <action id="18" plug-in="Standard.WaitEvent.1" ><?xtml-editor x=618 y=382 ?>
          <!--ConfLeaveEventResponse-->
          <wait xmlns="urn:www.pactolus.com:xtml:communication" timeout="5" recv-name="g_strEventReceived" >
            <msg name="ConfLeaveEventResponse" >
              <parameter ></parameter>
              <parameter ></parameter>
              <parameter ></parameter>
              <parameter >strDeleteSubConf</parameter>
            </msg>
          </wait>
          <results >
            <result name="Default" link="7" stubbed="1"/>
            <result name="Success" link="16" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)
{
	Server.logError("NO RESPONSE FROM CC FOR CONF LEAVE EVENT FOR PARTY IN SUB CONFERENCE");
}]]></script>
          </scripts>
        </action>
      </actions>
    </function>
    <function name="psAPISceConfCallLegCompletion" start="1" event="psAPISceConfCallLegCompletion" returns="i4" >
      <local-vars >
        <var name="f_nReturnCode" type="i4" >-1</var>
        <var name="f_lCallCompletionEndTime" type="i8" >0</var>
        <var name="f_strBlankString" type="string" ></var>
      </local-vars>
      <actions >
        <action id="1" plug-in="Pactolus.Branch.1" ><?xtml-editor x=164 y=153 ?>
          <!--null string?-->
          <results >
            <result name="Default" link="3" stubbed="0"/>
            <result name="db name !blank &amp;&amp; bMustWriteCDR" link="2" stubbed="0" >g_bNullString == false
AND g_bMustWriteCDR == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: psAPISceConfCallLegCompletion");
if (Session.g_strDBName.length > 0 && Session.g_strCallLegId.length > 0)
{
	Session.g_bNullString = false;
}
else
{
	Session.g_bNullString = true;
}]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Pactolus.JavaStaticMethod.1" ><?xtml-editor x=403 y=242 ?>
          <!--CallLegCompletion()-->
          <java xmlns="urn:www.pactolus.com:xtml:application" class="&quot;com.pactolus.conferencing.psAPISceConfCallLegCompletion&quot;" method="&quot;procConfCallCompletion&quot;" timeout="s_nTIMEOUT" return="" method-return-var="f_nReturnCode" method-return-type="0" >
            <parameter type="in" var-type="string" >g_strDBName</parameter>
            <parameter type="in" var-type="string" >g_strSessionId</parameter>
            <parameter type="in" var-type="i4" >g_nTerminationReason</parameter>
            <parameter type="in" var-type="i8" >f_lCallCompletionEndTime</parameter>
            <parameter type="in" var-type="i8" >g_lMSConnectTime</parameter>
            <parameter type="in" var-type="string" >g_strConfEventId</parameter>
            <parameter type="in" var-type="string" >g_strCallLegId</parameter>
            <parameter type="in" var-type="string" >g_strModeratorFlag</parameter>
            <parameter type="in" var-type="string" >g_strSPTimeZone</parameter>
            <parameter type="in" var-type="i4" >g_nAccessNumberId</parameter>
            <parameter type="in" var-type="i4" >g_nCallMode</parameter>
            <parameter type="in" var-type="string" >g_strConfScheduleId</parameter>
            <parameter type="in" var-type="i8" >g_lServiceProviderId</parameter>
            <parameter type="in" var-type="string" >g_strInfoDigits</parameter>
            <parameter type="in" var-type="string" >g_strOrigDomIntlFlag</parameter>
            <parameter type="in" var-type="string" >g_strDestDomIntlFlag</parameter>
            <parameter type="in" var-type="i4" >g_nOrigCountryId</parameter>
            <parameter type="in" var-type="string" >g_strOriginationNumber</parameter>
            <parameter type="in" var-type="string" >g_strDestNbr</parameter>
            <parameter type="in" var-type="i4" >g_nRtpEncoding</parameter>
            <parameter type="in" var-type="i4" >g_nRtpClockRate</parameter>
            <parameter type="in" var-type="string" >g_oCallLegA.strFrom</parameter>
            <parameter type="in" var-type="string" >g_oCallLegA.strTo</parameter>
            <parameter type="in" var-type="string" >g_oCallLegA.strCallId</parameter>
            <parameter type="in" var-type="string" >g_strSIPStatus</parameter>
            <parameter type="in" var-type="i8" >g_lStartTime</parameter>
            <parameter type="in" var-type="string" >g_strGWIPIngress</parameter>
            <parameter type="in" var-type="i4" >g_nGWPortIngress</parameter>
            <parameter type="in" var-type="string" >g_strGWIPEgress</parameter>
            <parameter type="in" var-type="i4" >g_nGWPortEgress</parameter>
            <parameter type="in" var-type="string" >s_strApplicationName</parameter>
            <parameter type="in" var-type="string" >s_strSoapIP</parameter>
            <parameter type="in" var-type="i4" >s_nSoapPort</parameter>
            <parameter type="in" var-type="string" >g_strOutdialFlag</parameter>
            <parameter type="in" var-type="string" >g_strOrigCallingCode</parameter>
            <parameter type="in" var-type="string" >g_strOrigAreaCode</parameter>
            <parameter type="in" var-type="i4" >g_nDestCountryId</parameter>
            <parameter type="in" var-type="string" >g_strDestCallingCode</parameter>
            <parameter type="in" var-type="string" >g_strDestAreaCode</parameter>
            <parameter type="in" var-type="i4" >g_nBillingType</parameter>
            <parameter type="in" var-type="i4" >g_nCurrencyId</parameter>
            <parameter type="in" var-type="i8" >g_lSubscriberId</parameter>
            <parameter type="in" var-type="i4" >g_nServiceId</parameter>
            <parameter type="in" var-type="string" >g_strOperatorFlag</parameter>
            <parameter type="in" var-type="i4" >g_nRoundSeconds</parameter>
            <parameter type="in" var-type="i4" >g_nSubExpirationType</parameter>
            <parameter type="in" var-type="i4" >g_nPayphoneSrchgRateId</parameter>
            <parameter type="in" var-type="float" >g_fPayphoneSrchgRateAmt</parameter>
            <parameter type="in" var-type="i4" >g_nAccessNumberRateId</parameter>
            <parameter type="in" var-type="float" >g_fAccessNumberRateAmt</parameter>
            <parameter type="in" var-type="i4" >g_nAccessNumberRateType</parameter>
            <parameter type="in" var-type="i4" >g_nMeteredRate1Id</parameter>
            <parameter type="in" var-type="float" >g_fMeteredRate1Amt</parameter>
            <parameter type="in" var-type="i4" >g_nMeteredRate2Id</parameter>
            <parameter type="in" var-type="float" >g_fMeteredRate2Amt</parameter>
            <parameter type="in" var-type="i4" >g_nFixedRate1Id</parameter>
            <parameter type="in" var-type="float" >g_fFixedRate1Amt</parameter>
            <parameter type="in" var-type="i4" >g_nFixedRate2Id</parameter>
            <parameter type="in" var-type="float" >g_fFixedRate2Amt</parameter>
            <parameter type="in" var-type="float" >g_fTotalMeteredRate</parameter>
            <parameter type="in" var-type="float" >g_fTotalFixedRate</parameter>
            <parameter type="in" var-type="string" >g_strSetStateToGetConfRes</parameter>
            <parameter type="in" var-type="string" >g_strConfSessionId</parameter>
            <parameter type="in" var-type="i8" >g_lOutdialStartTime</parameter>
            <parameter type="in" var-type="i8" >g_lOutdialConnectTime</parameter>
            <parameter type="in" var-type="i8" >g_lHoldWFMStartTime</parameter>
            <parameter type="in" var-type="string" >g_strDestNbr</parameter>
            <parameter type="in" var-type="string" >g_oCallLegA.strOrigTrunkGroup</parameter>
            <parameter type="in" var-type="string" >f_strBlankString</parameter>
            <parameter type="in" var-type="string" >g_strCustomerConferenceId</parameter>
            <parameter type="in" var-type="i8" >g_lPrivateTalkStartTime</parameter>
            <parameter type="in" var-type="i8" >g_lPrivateTalkEndTime</parameter>
            <parameter type="in" var-type="string" >g_strMediaServerIP</parameter>
            <parameter type="in" var-type="string" >g_strTransferInOutFlag</parameter>
          </java>
          <results >
            <result name="Default" link="3" stubbed="1"/>
            <result name="Success" link="4" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: ********JAVA CALLING ConfCallLegComplettion *********");
Server.logInfo("INFO: BEFORE DB name = " + Session.g_strDBName);
Server.logInfo("INFO: BEFORE Session Id = " + Session.g_strSessionId);
Server.logInfo("INFO: BEFORE termination reason = " + Session.g_nTerminationReason);
Server.logInfo("INFO: BEFORE end time = " + Session.g_lEndTime);
Server.logInfo("INFO: BEFORE MS connect time = " + Session.g_lMSConnectTime);
Server.logInfo("INFO: BEFORE conf event Id = " + Session.g_strConfEventId);
Server.logInfo("INFO: BEFORE call leg Id = " + Session.g_strCallLegId);
Session.f_lCallCompletionEndTime = Server.getUTCTime();
Session.g_bNotifyCCAudioModeChange = false;]]></script>
            <script language="javascript" timing="last" ><![CDATA[Session.g_strSetStateToGetConfRes = "F";
Session.g_bMustWriteCDR = false;
Server.logInfo("INFO: conference.psAPISceConfCallLegCompletion.1: **** Conf Call Leg Completion returns " + Session.f_nReturnCode);
if (Result.id == 2)
{
	Server.logInfo("INFO: SUCCESS WRITE CALL LEG CALL COMPLETION.");
	Server.logInfo("INFO: BEFORE DB name = " + Session.g_strDBNAME);
	Server.logInfo("INFO: BEFORE Session Id = " + Session.g_strSessionId);
	Server.logInfo("INFO: BEFORE termination reason = " + Session.g_nTerminationReason);
	Server.logInfo("INFO: BEFORE end time = " + Session.g_lEndTime);
	Server.logInfo("INFO: BEFORE MS connect time = " + Session.g_lMSConnectTime);
	Server.logInfo("INFO: BEFORE conf event Id = " + Session.g_strConfEventId);
	Server.logInfo("INFO: BEFORE call leg Id = " + Session.g_strCallLegId);
	if (-99 == Session.f_nReturnCode)
		Session.g_nErrorMsgNumber = 1001; //db error
	else
		Session.g_nErrorMsgNumber = 0;
}
else
{
	Server.logError("ERROR: FAIL TO WRITE CALL LEG CALL COMPLETION, EXIT ON: " + Result.name);
	Session.g_nTerminationReason = 6;
	Session.g_nErrorMsgNumber = 1000; //jvm server error
}
//clear out variables
Session.g_nTerminationReason = 0;
Session.g_strConfEventId = "";
Session.g_strConfScheduleId = "";
Session.g_strConferencePasscode = "";

]]></script>
          </scripts>
        </action>
        <action id="3" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=398 y=148 ?>
          <!--FAILURE-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nFAILURE"/>
        </action>
        <action id="4" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=631 y=237 ?>
          <!--JAVA RETURN CODE-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nReturnCode"/>
        </action>
      </actions>
    </function>
    <function name="psAPISceSetConfResource" start="1" event="psAPISceSetConfResource" returns="i4" >
      <local-vars >
        <var name="f_nReturnCode" type="i4" >-50</var>
        <var name="strEmptyString" type="string" ></var>
      </local-vars>
      <actions >
        <action id="1" plug-in="Pactolus.JavaStaticMethod.1" ><?xtml-editor x=301 y=234 ?>
          <!--testSetConfResource()-->
          <java xmlns="urn:www.pactolus.com:xtml:application" class="&quot;com.pactolus.conferencing.psAPISceSetConfResource&quot;" method="&quot;setConfResource&quot;" timeout="s_nTIMEOUT" return="" method-return-var="f_nReturnCode" method-return-type="0" >
            <parameter type="in" var-type="string" >g_strDBName</parameter>
            <parameter type="in" var-type="string" >g_strSessionId</parameter>
            <parameter type="in" var-type="string" >g_strConfEventId</parameter>
            <parameter type="in" var-type="string" >g_oMS.strConferenceId</parameter>
            <parameter type="in" var-type="string" >strEmptyString</parameter>
            <parameter type="in" var-type="string" >strEmptyString</parameter>
            <parameter type="in" var-type="string" >strEmptyString</parameter>
            <parameter type="in" var-type="string" >strEmptyString</parameter>
            <parameter type="in" var-type="string" >strEmptyString</parameter>
            <parameter type="in" var-type="string" >strEmptyString</parameter>
            <parameter type="in" var-type="string" >g_strMSResourceName</parameter>
          </java>
          <results >
            <result name="Default" link="3" stubbed="0"/>
            <result name="Success" link="2" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: psAPISceSetConfResource");
Server.logInfo("INFO: *********JAVA CALLING SetConfResource *********");]]></script>
            <script language="javascript" timing="last" ><![CDATA[Server.logInfo("INFO: ********* SetConfResource returns " + Session.f_nReturnCode);
if (Result.id == 2)
{
	if (0 == Session.f_nReturnCode)
			Session.g_strSetStateToGetConfRes = "F";
	else if (-99 == Session.f_nReturnCode)
		Session.g_nErrorMsgNumber = 1001; //db error
	else if (-2 == Session.f_nReturnCode)
		Session.g_nErrorMsgNumber = 4011; //conf not found
	else
		Session.g_nErrorMsgNumber = 0;
}
else
{
	Server.logError("ERROR: FAIL TO CALL SET CONF RESOURCE, EXIT ON: " + Result.name);
	Session.g_nTerminationReason = 6;
	Session.g_nErrorMsgNumber = 1000; //jvm server error
}]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=610 y=317 ?>
          <!--return JAVA_SUCCESS-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="f_nReturnCode"/>
        </action>
        <action id="3" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=593 y=178 ?>
          <!--return FAILED_JAVA-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nFAILURE"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logError("ERROR: FAIL TO SET CONFERENCE RESOURCE");]]></script>
          </scripts>
        </action>
      </actions>
    </function>
    <function name="WaitForModerator" start="2" event="WaitForModerator" returns="i4" >
      <local-vars >
        <var name="f_nReturnCode" type="i4" >-1</var>
        <var name="strAnonymousCaller" type="string" ></var>
      </local-vars>
      <actions >
        <action id="2" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=192 y=234 ?>
          <!--"MSOutdialParty"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;MSOutdialParty&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oCallLegA</parameter>
            <parameter >g_oMS</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="1" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: WaitForModerator");]]></script>
          </scripts>
        </action>
        <action id="1" plug-in="Pactolus.Branch.1" ><?xtml-editor x=435 y=230 ?>
          <!--success?-->
          <results >
            <result name="Default" link="3" stubbed="0"/>
            <result name="success?" link="4" stubbed="0" >f_nReturnCode == s_nSUCCESS</result>
          </results>
        </action>
        <action id="3" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=672 y=226 ?>
          <!--s_nFAILURE-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nFAILURE"/>
        </action>
        <action id="4" plug-in="Pactolus.MGCPPlay.1" ><?xtml-editor x=678 y=324 ?>
          <!--WaitForModerator, Please hold-->
          <play xmlns="urn:www.pactolus.com:xtml:media" connection-id="g_oMS.strConnectionId" endpoint="g_oMS.strEndPoint" callid="g_oMS.strCallId" repeat="1" timeout="s_nTIMEOUT" ms-type="g_oMS.strType" returns="" start-play="1" interrupt="1" return-immediate="0" digit-map="" language="g_strLanguage" digits="" retry-count="" clear-digits="1" terminating-digit="" quick-collect="0" digit-timer="" >
            <audio type="index" >897</audio>
            <audio type="index" >898</audio>
          </play>
          <results >
            <result name="Default" link="5" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
        </action>
        <action id="5" plug-in="Standard.Timer.1" ><?xtml-editor x=896 y=317 ?>
          <!--play please hold every 10 secs-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lHoldTimerId" duration="s_nSLEEPTIME"/>
          <results >
            <result name="Default" link="7" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bHoldTimerFlag = true;]]></script>
          </scripts>
        </action>
        <action id="6" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1631 y=350 ?>
          <!--s_nSUCCESS-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nSUCCESS"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bSentConfJoinEvent = true;]]></script>
          </scripts>
        </action>
        <action id="7" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1145 y=311 ?>
          <!--CallPartyFlag==T?-->
          <results >
            <result name="Default" link="8" stubbed="0"/>
            <result name="g_strPartyPasscodeFlag==T" link="11" stubbed="0" >g_strPartyPasscodeFlag match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_lPartyJoinTime = Server.getUTCTime();]]></script>
          </scripts>
        </action>
        <action id="8" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1370 y=263 ?>
          <!--PARTY JOIN CONF-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="g_strZeroTransactionId" message-name="s_strCONF_JOIN" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
            <parameter tag="&quot;callerPassCode&quot;" value="s_strEMPTY_STRING"/>
            <parameter tag="&quot;moderatorFlag&quot;" value="g_strModeratorFlag"/>
            <parameter tag="&quot;callingNumber&quot;" value="g_strOriginationNumber"/>
            <parameter tag="&quot;callerFirstName&quot;" value="g_strFirstName"/>
            <parameter tag="&quot;callerLastName&quot;" value="g_strLastName"/>
            <parameter tag="&quot;callerOrganization&quot;" value="g_strCallerOrg"/>
            <parameter tag="&quot;soapPort&quot;" value="s_nSoapPort"/>
            <parameter tag="&quot;muteFlag&quot;" value="g_strMuteFlag"/>
            <parameter tag="&quot;holdFlag&quot;" value="g_strHoldFlag"/>
            <parameter tag="&quot;mediaServerEndpoint&quot;" value="g_oMS.strConferenceId"/>
            <parameter tag="&quot;moderatorRequiredFlag&quot;" value="g_strModeratorRequiredFlag"/>
            <parameter tag="&quot;nameURL&quot;" value="g_strCallerRecordedName"/>
            <parameter tag="&quot;prepaidBalance&quot;" value="g_fPrepaidBalance"/>
            <parameter tag="&quot;MSConnectTime&quot;" value="g_lPartyJoinTime"/>
            <parameter tag="&quot;totalMeteredRate&quot;" value="g_fTotalMeteredRate"/>
            <parameter tag="&quot;totalFixedRate&quot;" value="g_fTotalFixedRate"/>
            <parameter tag="&quot;operatorFlag&quot;" value="g_strOperatorFlag"/>
            <parameter tag="&quot;dialOutExtNbr&quot;" value="g_strDialOutExtNbr"/>
            <parameter tag="&quot;dialOutRequestId&quot;" value="g_lDialOutRequestId"/>
            <parameter tag="&quot;confSessionId&quot;" value="g_strConfSessionId"/>
            <parameter tag="&quot;callLegId&quot;" value="g_strCallLegId"/>
            <parameter tag="&quot;subscriberFlag&quot;" value="g_strIsSubscriberFlag"/>
            <parameter tag="&quot;attendeeId&quot;" value="0"/>
            <parameter tag="&quot;accessNumber&quot;" value="g_strAccessNumber"/>
            <parameter tag="&quot;SIPCallId&quot;" value="g_oCallLegA.strCallId"/>
            <parameter tag="&quot;msConnectionId&quot;" value="g_oMS.strConnectionId"/>
            <parameter tag="&quot;quickStartFlag&quot;" value="g_strQuickStartFlag"/>
            <parameter tag="&quot;anonymousCaller&quot;" value="strAnonymousCaller"/>
            <parameter tag="&quot;CSRRequestId&quot;" value="g_lACDRequestId"/>
            <parameter tag="&quot;ConfStatus&quot;" value="g_nReleaseToConfStatus"/>
            <parameter tag="&quot;AccessNumberType&quot;" value="g_nEventDnisType"/>
            <parameter tag="&quot;PartySchedId&quot;" value="g_lPartySchedId"/>
            <parameter tag="&quot;PartyDetailString&quot;" value="g_strPartyDetail"/>
            <parameter tag="&quot;SubConferenceId&quot;" value="g_strSubConferenceId"/>
            <parameter tag="&quot;ACDUserId&quot;" value="g_lACDUserId"/>
          </SOAP>
          <results >
            <result name="Default" link="6" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
        </action>
        <action id="11" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1383 y=415 ?>
          <!--PARTY JOIN CONF-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="g_strZeroTransactionId" message-name="s_strCONF_JOIN" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
            <parameter tag="&quot;callerPassCode&quot;" value="g_strConferencePasscode"/>
            <parameter tag="&quot;moderatorFlag&quot;" value="g_strModeratorFlag"/>
            <parameter tag="&quot;callingNumber&quot;" value="g_strOriginationNumber"/>
            <parameter tag="&quot;callerFirstName&quot;" value="g_strFirstName"/>
            <parameter tag="&quot;callerLastName&quot;" value="g_strLastName"/>
            <parameter tag="&quot;callerOrganization&quot;" value="g_strCallerOrg"/>
            <parameter tag="&quot;soapPort&quot;" value="s_nSoapPort"/>
            <parameter tag="&quot;muteFlag&quot;" value="g_strMuteFlag"/>
            <parameter tag="&quot;holdFlag&quot;" value="g_strHoldFlag"/>
            <parameter tag="&quot;mediaServerEndpoint&quot;" value="g_oMS.strConferenceId"/>
            <parameter tag="&quot;moderatorRequiredFlag&quot;" value="g_strModeratorRequiredFlag"/>
            <parameter tag="&quot;nameURL&quot;" value="g_strCallerRecordedName"/>
            <parameter tag="&quot;prepaidBalance&quot;" value="g_fPrepaidBalance"/>
            <parameter tag="&quot;MSConnectTime&quot;" value="g_lPartyJoinTime"/>
            <parameter tag="&quot;totalMeteredRate&quot;" value="g_fTotalMeteredRate"/>
            <parameter tag="&quot;totalFixedRate&quot;" value="g_fTotalFixedRate"/>
            <parameter tag="&quot;operatorFlag&quot;" value="g_strOperatorFlag"/>
            <parameter tag="&quot;dialOutExtNbr&quot;" value="g_strDialOutExtNbr"/>
            <parameter tag="&quot;dialOutRequestId&quot;" value="g_lDialOutRequestId"/>
            <parameter tag="&quot;confSessionId&quot;" value="g_strConfSessionId"/>
            <parameter tag="&quot;callLegId&quot;" value="g_strCallLegId"/>
            <parameter tag="&quot;subscriberFlag&quot;" value="g_strIsSubscriberFlag"/>
            <parameter tag="&quot;attendeeId&quot;" value="0"/>
            <parameter tag="&quot;accessNumber&quot;" value="g_strAccessNumber"/>
            <parameter tag="&quot;SIPCallId&quot;" value="g_oCallLegA.strCallId"/>
            <parameter tag="&quot;msConnectionId&quot;" value="g_oMS.strConnectionId"/>
            <parameter tag="&quot;quickStartFlag&quot;" value="g_strQuickStartFlag"/>
            <parameter tag="&quot;anonymousCaller&quot;" value="strAnonymousCaller"/>
            <parameter tag="&quot;CSRRequestId&quot;" value="g_lACDRequestId"/>
            <parameter tag="&quot;ConfStatus&quot;" value="g_nReleaseToConfStatus"/>
            <parameter tag="&quot;AccessNumberType&quot;" value="g_nEventDnisType"/>
            <parameter tag="&quot;PartySchedId&quot;" value="g_lPartySchedId"/>
            <parameter tag="&quot;PartyDetailString&quot;" value="g_strPartyDetail"/>
            <parameter tag="&quot;SubConferenceId&quot;" value="g_strSubConferenceId"/>
            <parameter tag="&quot;ACDUserId&quot;" value="g_lACDUserId"/>
          </SOAP>
          <results >
            <result name="Default" link="6" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
        </action>
      </actions>
    </function>
    <function name="OnTimer" start="1" event="OnTimer" returns="void" >
      <parameters >
        <parameter name="nTimerId" type="i4" pass="byref"/>
      </parameters>
      <local-vars >
        <var name="f_strACDControllerIP" type="string" ></var>
        <var name="f_nACDControllerPort" type="i4" >0</var>
        <var name="f_strTransactionId" type="string" ></var>
      </local-vars>
      <actions >
        <action id="1" plug-in="Pactolus.Branch.1" ><?xtml-editor x=73 y=209 ?>
          <results >
            <result name="Default" link="6" stubbed="1"/>
            <result name="hold timer?" link="2" stubbed="0" >nTimerId == g_lHoldTimerId</result>
            <result name="hearbeat timer?" link="8" stubbed="0" >nTimerId == g_lHeartbeatTimerId</result>
            <result name="wait CSR Login GUI?" link="16" stubbed="0" >nTimerId == g_lWaitCSRLoginGUITimerId</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: OnTimer");
Server.logInfo("Timer branch name : " + Result.name);
Server.logInfo("Timer branch id : " + Result.id);
js_disable_event();]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=351 y=113 ?>
          <!--"PlayOnePrompt"
904-continue to hold-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;PlayOnePrompt&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
            <parameter >g_strLanguage</parameter>
            <parameter >904</parameter>
          </function>
          <results >
            <result name="Default" link="3" stubbed="0"/>
          </results>
        </action>
        <action id="3" plug-in="Standard.Timer.1" ><?xtml-editor x=593 y=110 ?>
          <!--play please hold every 10 secs-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lHoldTimerId" duration="s_nSLEEPTIME"/>
          <results >
            <result name="Default" link="6" stubbed="1"/>
          </results>
        </action>
        <action id="5" plug-in="Standard.Timer.1" ><?xtml-editor x=825 y=262 ?>
          <!--set timer to check heartbeat with ACD controller-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="1" id="g_lHeartbeatTimerId" duration="s_nHEARTBEATTIME"/>
          <results >
            <result name="Default" link="6" stubbed="1"/>
          </results>
        </action>
        <action id="6" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=69 y=604 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="7" plug-in="Standard.WaitEvent.1" ><?xtml-editor x=573 y=262 ?>
          <!--wait for heartbeat response-->
          <wait xmlns="urn:www.pactolus.com:xtml:communication" timeout="10" recv-name="g_strEventReceived" >
            <msg name="HeartbeatResponse" >
              <parameter >f_strACDControllerIP</parameter>
              <parameter >f_nACDControllerPort</parameter>
              <parameter >f_strTransactionId</parameter>
            </msg>
          </wait>
          <results >
            <result name="Default" link="14" stubbed="1"/>
            <result name="Success" link="5" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)
{
	Server.logError("ERROR: WAIT FOR HEART BEAT RESPONSE FROM CC, EXIT ON BRANCH: " + Result.name);
}]]></script>
          </scripts>
        </action>
        <action id="8" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=351 y=263 ?>
          <!--heartbeat request-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strACDControllerIP" transaction="g_strZeroTransactionId" message-name="&quot;HeartbeatRequest&quot;" destination-port="g_nACDControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;SoapAgentPort&quot;" value="s_nSoapPort"/>
          </SOAP>
          <results >
            <result name="Default" link="7" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("SENDING HEART BEAT REQUEST TO ACD CONTROLLER");]]></script>
          </scripts>
        </action>
        <action id="9" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=831 y=433 ?>
          <!--"SendLogoutCSRIVR"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;SendLogoutCSRIVR&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="10" stubbed="0"/>
          </results>
        </action>
        <action id="10" plug-in="Standard.EndSession.1" ><?xtml-editor x=1081 y=436 ?></action>
        <action id="13" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=847 y=553 ?>
          <!--"DisconnectFromConference"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DisconnectFromConference&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="9" stubbed="1"/>
          </results>
        </action>
        <action id="14" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=596 y=437 ?>
          <!--HangUpPartyA-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpParty&quot;" return="" external-function="1" library="lib_callcontrol.xml" >
            <parameter >g_oCallLegA</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="9" stubbed="0"/>
            <result name="Wait For Assignment" link="9" stubbed="1" >g_nCurrentState == s_nSTATE_WAIT_ASSIGNMENT</result>
            <result name="Add CSR To Conf" link="13" stubbed="0" >g_nCurrentState == s_nSTATE_ADD_TO_CONF</result>
          </results>
        </action>
        <action id="16" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=366 y=443 ?>
          <!--PlayErrorMsg-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;PlayErrorMsg&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="14" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nErrorMsgNumber = 5006;]]></script>
          </scripts>
        </action>
      </actions>
    </function>
    <function name="OnModeratorJoinRequest" start="1" event="OnModeratorJoinRequest" returns="void" >
      <parameters >
        <parameter name="strConfControllerIP" type="string" pass="byref"/>
        <parameter name="nConfControllerPort" type="i4" pass="byref"/>
        <parameter name="strTransactionId" type="string" pass="byref"/>
        <parameter name="strConferenceResource" type="string" pass="byref"/>
      </parameters>
      <actions >
        <action id="1" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=113 y=218 ?>
          <!--stop timers-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;StopTimer&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="3" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: OnModeratorJoinRequest");
Server.logInfo("INFO: RECEIVE MODERATOR JOIN REQUEST FROM CONF CONTROLLER.");
Server.logInfo("INFO: Conf Controller IP: " + Session.strConfControllerIP);
Server.logInfo("INFO: Conf Controller Port: " + Session.nConfControllerPort);
Server.logInfo("INFO: TransactionId: " + Session.strTransactionId);
Server.logInfo("INFO: Conference Resource: " + Session.strConferenceResource);]]></script>
          </scripts>
        </action>
        <action id="3" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=316 y=219 ?>
          <!--Delete MS Connection-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DeleteMSConnection&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="4" stubbed="0"/>
          </results>
        </action>
        <action id="4" plug-in="Pactolus.Branch.1" ><?xtml-editor x=553 y=216 ?>
          <!--set conference resource-->
          <results >
            <result name="Default" link="5" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: Moderator joined the conference.");
Session.g_oMS.strConferenceId = Session.strConferenceResource;
Session.g_strConfResource = Session.strConferenceResource;]]></script>
          </scripts>
        </action>
        <action id="5" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=110 y=410 ?>
          <!--AddMemberAToConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;AddMemberToConference&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
            <parameter >g_oCallLegA</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="7" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_lMSConnectTime = Server.getUTCTime();]]></script>
          </scripts>
        </action>
        <action id="6" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=582 y=398 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
        </action>
        <action id="7" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=336 y=403 ?>
          <!--"ConfMSConnectionIDChangedNotify"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ConfMSConnectionIDChangedNotify&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="6" stubbed="0"/>
          </results>
        </action>
      </actions>
    </function>
    <function name="StopTimer" start="1" event="StopTimer" returns="i4" >
      <actions >
        <action id="1" plug-in="Pactolus.Branch.1" ><?xtml-editor x=458 y=233 ?>
          <!--timer started?-->
          <results >
            <result name="Default" link="3" stubbed="0"/>
            <result name="timer set == true" link="2" stubbed="0" >g_bHoldTimerFlag == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: StopTimer");]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.Timer.1" ><?xtml-editor x=738 y=348 ?>
          <!--stop Hold timer-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="0" id="g_lHoldTimerId" duration=""/>
          <results >
            <result name="Default" link="3" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bHoldTimerFlag = false;]]></script>
          </scripts>
        </action>
        <action id="3" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=991 y=310 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
        </action>
      </actions>
    </function>
    <function name="OnLoginCSRGUINotify" start="1" event="OnLoginCSRGUINotify" returns="void" >
      <parameters >
        <parameter name="strACDControllerIP" type="string" pass="byref"/>
        <parameter name="nACDControllerPort" type="i4" pass="byref"/>
        <parameter name="strTransactionId" type="string" pass="byref"/>
        <parameter name="nACDUserId" type="i4" pass="byref"/>
        <parameter name="strFirstName" type="string" pass="byref"/>
        <parameter name="strLastName" type="string" pass="byref"/>
        <parameter name="strGroupName" type="string" pass="byref"/>
        <parameter name="strPrimaryLanguage" type="string" pass="byref"/>
        <parameter name="strPrimarySkill" type="string" pass="byref"/>
        <parameter name="nInitialState" type="i4" pass="byref"/>
        <parameter name="nCurrentState" type="i4" pass="byref"/>
        <parameter name="strACDUserType" type="string" pass="byref"/>
        <parameter name="strIVRLoginFlag" type="string" pass="byref"/>
        <parameter name="strLoginTime" type="string" pass="byref"/>
        <parameter name="strStateTime" type="string" pass="byref"/>
        <parameter name="nStateDuration" type="i4" pass="byref"/>
        <parameter name="strDialType" type="string" pass="byref"/>
      </parameters>
      <actions >
        <action id="1" plug-in="Standard.Timer.1" ><?xtml-editor x=88 y=301 ?>
          <!--stop waiting for CSR login GUI-->
          <timer xmlns="urn:www.pactolus.com:xtml:application" start="0" id="g_lWaitCSRLoginGUITimerId" duration=""/>
          <results >
            <result name="Default" link="4" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: OnLoginCSRGUINotify");
js_disable_event();]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=551 y=301 ?>
          <!--send to main function-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;Main&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="3" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_nCurrentState = Session.s_nSTATE_WAIT_ASSIGNMENT;]]></script>
          </scripts>
        </action>
        <action id="3" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=794 y=304 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
        </action>
        <action id="4" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=315 y=303 ?>
          <!--"PlayOnePrompt"
 1509: You have successfully logged in.-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;PlayOnePrompt&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
            <parameter >g_strLanguage</parameter>
            <parameter >1509</parameter>
          </function>
          <results >
            <result name="Default" link="2" stubbed="0"/>
          </results>
        </action>
      </actions>
    </function>
    <function name="OnInfo" start="1" event="OnInfo" returns="void" >
      <parameters >
        <parameter name="strAccept" type="string" pass="byref"/>
        <parameter name="strAcceptEncoding" type="string" pass="byref"/>
        <parameter name="strAcceptLanguage" type="string" pass="byref"/>
        <parameter name="strAuthorization" type="string" pass="byref"/>
        <parameter name="strCallId" type="string" pass="byref"/>
        <parameter name="strContact" type="string" pass="byref"/>
        <parameter name="strContent" type="string" pass="byref"/>
        <parameter name="strContentDisposition" type="string" pass="byref"/>
        <parameter name="strContentType" type="string" pass="byref"/>
        <parameter name="strCSeq" type="string" pass="byref"/>
        <parameter name="strDate" type="string" pass="byref"/>
        <parameter name="strEncryption" type="string" pass="byref"/>
        <parameter name="strFrom" type="string" pass="byref"/>
        <parameter name="strMaxForwards" type="string" pass="byref"/>
        <parameter name="strMIMEVersion" type="string" pass="byref"/>
        <parameter name="strOrganization" type="string" pass="byref"/>
        <parameter name="strPriority" type="string" pass="byref"/>
        <parameter name="strProxyAuthorization" type="string" pass="byref"/>
        <parameter name="strProxyRequire" type="string" pass="byref"/>
        <parameter name="strRecordRoute" type="string" pass="byref"/>
        <parameter name="strRequestUri" type="string" pass="byref"/>
        <parameter name="strRequire" type="string" pass="byref"/>
        <parameter name="strResponseKey" type="string" pass="byref"/>
        <parameter name="strRoute" type="string" pass="byref"/>
        <parameter name="strSupported" type="string" pass="byref"/>
        <parameter name="strTimestamp" type="string" pass="byref"/>
        <parameter name="strTo" type="string" pass="byref"/>
        <parameter name="strUserAgent" type="string" pass="byref"/>
        <parameter name="strVia" type="string" pass="byref"/>
      </parameters>
      <actions >
        <action id="1" plug-in="Pactolus.SipResponse.1" ><?xtml-editor x=215 y=265 ?>
          <sip-response xmlns="urn:www.pactolus.com:xtml:sip" remove-via="0" reliable="0" increment-cseq-first="0" increment-cseq-last="0" >
            <call-id >strCallId</call-id>
            <contact >g_strContact</contact>
            <cseq >strCSeq</cseq>
            <from >strFrom</from>
            <status >"SIP/2.0 200 OK"</status>
            <to >strTo</to>
            <via >strVia</via>
          </sip-response>
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: OnInfo");
js_disable_event();
var newCSeq = new SipCSeq(Session.strCSeq);
var oldCSeq = new SipCSeq(Session.g_oCallLegA.strCSeq);

if(newCSeq.value >= oldCSeq.value) 
{
	newCSeq.increment() ;
	Session.g_oCallLegA.strCSeq = newCSeq.encode() ;
}]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=473 y=263 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_enable_event();]]></script>
          </scripts>
        </action>
      </actions>
    </function>
    <function name="OnPing" start="1" event="OnPing" returns="void" >
      <parameters >
        <parameter name="strACDControllerIP" type="string" pass="byref"/>
        <parameter name="nACDControllerPort" type="i4" pass="byref"/>
        <parameter name="strTransactionId" type="string" pass="byref"/>
        <parameter name="strHostIP" type="string" pass="byref"/>
        <parameter name="nHostPort" type="i4" pass="byref"/>
      </parameters>
      <actions >
        <action id="1" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=243 y=221 ?>
          <!--PingResponse-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strACDControllerIP" transaction="strTransactionId" message-name="&quot;PingResponse&quot;" destination-port="nACDControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace=""/>
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: OnPing");]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=507 y=219 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
        </action>
      </actions>
    </function>
    <function name="OnDialOutCSR" start="11" event="OnDialOutCSR" returns="void" >
      <parameters >
        <parameter name="strACDControllerIP" type="string" pass="byref"/>
        <parameter name="nACDControllerPort" type="i4" pass="byref"/>
        <parameter name="strTransactionId" type="string" pass="byref"/>
        <parameter name="strPhoneNumber" type="string" pass="byref"/>
        <parameter name="strPassCode" type="string" pass="byref"/>
        <parameter name="lACDUserId" type="i8" pass="byref"/>
        <parameter name="lACDRequestId" type="i8" pass="byref"/>
        <parameter name="strRequestorANI" type="string" pass="byref"/>
      </parameters>
      <local-vars >
        <var name="f_nReturnCode" type="i4" >0</var>
        <var name="f_strStatusCode" type="string" ></var>
        <var name="f_nACDResponseCode" type="i4" >0</var>
        <var name="f_lOutdialEndTime" type="i8" >0</var>
      </local-vars>
      <actions >
        <action id="11" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=131 y=150 ?>
          <!--Trying-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strACDControllerIP" transaction="strTransactionId" message-name="&quot;DialOutCSRResponse&quot;" destination-port="nACDControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;returnCode&quot;" value="g_nReturnCode"/>
            <parameter tag="&quot;returnMsg&quot;" value="g_strReturnMsg"/>
            <parameter tag="&quot;SOAPAgentPort&quot;" value="s_nSoapPort"/>
          </SOAP>
          <results >
            <result name="Default" link="12" stubbed="1"/>
            <result name="Success" link="10" stubbed="0"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: OnDialOutCSR");
Session.g_bSessionInUsed = true;	//this session is now in use, all invites must be reINVITE
Session.g_strSessionId = Session._sessionId;
Session.g_strSoapAddress = Server.soapAddress;
// set server contact
Session.g_strContact = "sip:" + Session.s_strLocalHost;
if( Server.sipPort != 5060 )
{
 Session.g_strContact += ":" + Server.sipPort;
}
Session.g_nReturnCode = 1;
Session.g_strReturnMsg = "TRYING";
Session.g_strResponseTransactionId = Session.strTransactionId;
Session.g_lACDRequestId = Session.lACDRequestId;
Session.g_lACDUserId = Session.lACDUserId;

if (Session.strRequestorANI.length > 0 )
{
	Session.g_strOriginationNumber = Session.strRequestorANI;
	Server.logInfo("HAS REQUESTOR ANI, USE IT");
}
else
{
	Session.g_strOriginationNumber = Session.s_strDEFAULT_ANI;
	Server.logInfo("DON'T HAVE REQUESTOR ANI, USE DEFAULT ANI");
}]]></script>
          </scripts>
        </action>
        <action id="3" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=683 y=366 ?>
          <!--DialOutCSRResponse-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strACDControllerIP" transaction="strTransactionId" message-name="&quot;DialOutCSRResponse&quot;" destination-port="nACDControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;returnCode&quot;" value="f_nACDResponseCode"/>
            <parameter tag="&quot;returnMsg&quot;" value="g_strReturnMsg"/>
            <parameter tag="&quot;SOAPAgentPort&quot;" value="s_nSoapPort"/>
          </SOAP>
          <results >
            <result name="Default" link="14" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="g_nReturnCode != 0" >g_nReturnCode != 0</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_disable_event();]]></script>
            <script language="javascript" timing="last" ><![CDATA[if(Result.id != 2) {
	Session.g_nReturnCode = -99;
}]]></script>
          </scripts>
        </action>
        <action id="4" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=651 y=198 ?>
          <!--"DeleteMSConnection"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DeleteMSConnection&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="5" stubbed="0"/>
            <result name="f_nReturnCode != 0" link="12" stubbed="1" >f_nReturnCode != 0</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (2 == Result.id)
{
	Session.g_strReturnMsg = "FAIL TO DELETE MS CONNECTION";
	Server.logError("ON DIAL OUT CSR: FAIL DELETE MS CONNECTION");
	Session.f_strStatusCode = 4;
}]]></script>
          </scripts>
        </action>
        <action id="5" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=128 y=437 ?>
          <!--PutPartyOnHold-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;PutPartyOnHold&quot;" return="g_nReturnCode" external-function="1" library="lib_callcontrol.xml" >
            <parameter >g_oCallLegA</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="9" stubbed="0"/>
            <result name="g_nReturnCode != 0" link="12" stubbed="0" >g_nReturnCode != 0</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (2 == Result.id)
{
	Session.g_strReturnMsg = "FAIL TO PUT CALLER ON HOLD";
	Server.logError("ON DIAL OUT CSR: FAIL TO PUT INVITE CSR ON HOLD");
}]]></script>
          </scripts>
        </action>
        <action id="6" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1445 y=361 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bOutDialCSR = true;
js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="7" plug-in="Standard.EndSession.1" ><?xtml-editor x=121 y=733 ?></action>
        <action id="9" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=389 y=377 ?>
          <!--psAPISceAuthCSRPin-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceAuthCSRPin&quot;" return="g_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="3" stubbed="0"/>
            <result name="g_nReturnCode != 0" link="12" stubbed="1" >g_nReturnCode != 0</result>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (2 == Result.id)
{
	Session.g_strReturnMsg = "FAIL TO AUTHENTICATE CSR PIN";
	Server.logError("ON DIAL OUT CSR: FAIL TO AUTHENTICATE CSR PIN");
}]]></script>
          </scripts>
        </action>
        <action id="10" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=408 y=203 ?>
          <!--outdial party to ms-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;OutdialPartyToMS&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oCallLegA</parameter>
            <parameter >g_oMS</parameter>
            <parameter >g_lOutdialStartTime</parameter>
            <parameter >g_lOutdialConnectTime</parameter>
            <parameter >g_strSIPStatus</parameter>
            <parameter >g_strOriginationNumber</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="12" stubbed="1"/>
            <result name="SUCCESS" link="4" stubbed="0" >f_nReturnCode == 0</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_initCallLeg(Session.g_oCallLegA);

Server.logInfo("strSessionTimerFlag: " + Session.g_oCallLegA.nSessionTimer);
Server.logInfo("nSessionTimer: " + Session.g_oCallLegA.nSessionTimer);
Server.logInfo("nRingNoAnswerTime: " + Session.g_oCallLegA.nRingNoAnswerTime);
Server.logInfo("strRequestUri: " + Session.g_oCallLegA.strRequestUri);
Server.logInfo("strBackupRequestUri: " + Session.g_oCallLegA.strBackupRequestUri);
Server.logInfo("strCallId: " + Session.g_oCallLegA.strCallId);

Session.g_oCallLegA.strOutdialDestNbr = Session.strPhoneNumber;
Session.g_oCallLegA.strCalledNumber = Session.strPhoneNumber;

Server.logInfo("strOutdialDestNbr: " + Session.g_oCallLegA.strOutdialDestNbr);
Server.logInfo("strCalledNumber: " + Session.g_oCallLegA.strCalledNumber);

Session.g_oCallLegA.strOutdialDestNbr = js_prepend_digits(Session.g_oCallLegA.strOutdialDestNbr, Session.s_strDigitPrependToOutdial);
Session.g_oCallLegA.strCalledNumber = js_prepend_digits(Session.g_oCallLegA.strCalledNumber, Session.s_strDigitPrependToOutdial);

Session.g_strPassword = Session.strPassCode;

//Session.g_strOriginationNumber = "5086160900";

if (false == Session.g_bAlreadyInitMS)
{
	js_initMS(Session.g_oMS, Session.s_strMSType);
	Session.g_oMS.strACDType = Session.s_strACDMediaServerType;
	Session.g_oMS.strConfType = Session.s_strConf_MS_Type;
	Session.g_oMS.nPacketizationPeriod = Session.s_nPacketizationPeriod;
	//ASN
	Session.g_oMS.nMaxActiveSpeakers = Session.s_nMaxActiveSpeakers;
	Session.g_oMS.nNbrActiveSpeakers = Session.s_nNbrActiveSpeakers;
	Session.g_oMS.nReportingInterval = Session.s_nReportingInterval;
	//AGC
	Session.g_oMS.nAGCTargetLevelIn = Session.s_nAGCTargetLevelIn;
	Session.g_oMS.nAGCMaxLevelIn = Session.s_nAGCMaxLevelIn;
	Session.g_oMS.nAGCTargetLevelOut = Session.s_nAGCTargetLevelOut;
	Session.g_oMS.nAGCMaxLevelOut = Session.s_nAGCMaxLevelOut;
	Session.g_oMS.nDBThreshold = Session.s_nDBThreshold;

	Session.g_bAlreadyInitMS = true;
}
Server.logInfo("g_oMS.nMaxActiveSpeakers: " + Session.g_oMS.nMaxActiveSpeakers);
Server.logInfo("g_oMS.nNbrActiveSpeakers: " + Session.g_oMS.nNbrActiveSpeakers);
Server.logInfo("g_oMS.nReportingInterval: " + Session.g_oMS.nReportingInterval);
Server.logInfo("g_oMS.nDBThreshold: " + Session.g_oMS.nDBThreshold);
Server.logInfo("g_oMS.strEndPoint: " + Session.g_oMS.strEndPoint);
Server.logInfo("g_oMS.strConnectionId: " + Session.g_oMS.strConnectionId);
Server.logInfo("g_oMS.strCallId: " + Session.g_oMS.strCallId);
Server.logInfo("g_oMS.bMuteFlag: " + Session.g_oMS.bMuteFlag);
Server.logInfo("g_oMS.bDeafFlag: " + Session.g_oMS.bDeafFlag);
Server.logInfo("g_oMS.strCodec: " + Session.g_oMS.strCodec);
Server.logInfo("g_oMS.strType: " + Session.g_oMS.strType);
Server.logInfo("g_oMS.bDTMFClampFlag: " + Session.g_oMS.bDTMFClampFlag);]]></script>
            <script language="javascript" timing="last" ><![CDATA[Session.g_lStartTime = Server.getUTCTime();
Session.f_lOutdialEndTime = Session.g_lStartTime;
Server.logInfo("INFO: CALING LIBOUTDIAL RETURN: " + Session.f_nReturnCode);
Server.logInfo("CALLING js_calculate_uri_and_route");
Server.logInfo("BEFORE contact: " + Session.g_oCallLegA.strContact);
Server.logInfo("BEFORE record route: " + Session.g_oCallLegA.strRecordRoute);
Server.logInfo("BEFORE request Uri: " + Session.g_oCallLegA.strRequestUri);
Server.logInfo("BEFORE route: " + Session.g_oCallLegA.strRoute);
var bDialIn = false;
js_calculate_uri_and_route(bDialIn, Session.s_strSIPVERSION, Session.g_oCallLegA.strFrom, Session.g_oCallLegA.strContact, Session.g_oCallLegA.strRecordRoute, Session.g_oCallLegA.strRequestUri, Session.g_oCallLegA.strRoute);
Server.logInfo("AFTER contact: " + Session.g_oCallLegA.strContact);
Server.logInfo("AFTER record route: " + Session.g_oCallLegA.strRecordRoute);
Server.logInfo("AFTER request Uri: " + Session.g_oCallLegA.strRequestUri);
Server.logInfo("AFTER route: " + Session.g_oCallLegA.strRoute);
Server.logInfo("Call leg A request Uri is: " + Session.g_oCallLegA.strRequestUri);

switch (Session.f_nReturnCode)
{
	case 0:
		Server.logInfo("OUTDIAL CSR: SUCCESS");
		Session.f_strStatusCode = "0";
		Session.f_nACDResponseCode = 0;
		Session.g_strReturnMsg = "SUCCESSFUL ADD PARTY";
		break;
	case 1:
		Server.logInfo("OUTDIAL CSR: RING NO ANSWER");
		Session.f_strStatusCode = "1";
		Session.f_nACDResponseCode = -5;
		Session.g_strReturnMsg = "RING NO ANSWER, UNABLE TO ADD PARTY";
		break;
	case 2:
		Server.logInfo("OUTDIAL CSR: BUSY");
		Session.f_strStatusCode = "3";
		Session.f_nACDResponseCode = -6;
		Session.g_strReturnMsg = "BUSY PHONE, UNABLE TO ADD PARTY";
		break;
	case 3:
		Server.logInfo("OUTDIAL CSR: DTMF INTERRUPTED");
		Session.f_strStatusCode = "4";
		Session.f_nACDResponseCode = -7;
		Session.g_strReturnMsg = "OUTDIAL FAILED, UNABLE TO ADD PARTY";
		break;
	case -2:
		Server.logInfo("OUTDIAL CSR: CALLED PARTY ERROR");
		Session.f_strStatusCode = "4";
		Session.f_nACDResponseCode = -7;
		Session.g_strReturnMsg = "OUTDIAL FAILED, UNABLE TO ADD PARTY";
		break;
	case -3:
		Server.logInfo("OUTDIAL CSR: CALLING PARTY ERROR");
		Session.f_strStatusCode = "4";
		Session.f_nACDResponseCode = -7;
		Session.g_strReturnMsg = "OUTDIAL FAILED, UNABLE TO ADD PARTY";
		break;
	case -4:
		Server.logInfo("OUTDIAL CSR: OTHER ERROR");
		Session.f_strStatusCode = "4";
		Session.f_nACDResponseCode = -7;
		Session.g_strReturnMsg = "OUTDIAL FAILED, UNABLE TO ADD PARTY";
		break;
	case -5:
		Server.logInfo("OUTDIAL CSR: RESOURCE UNAVAILABLE");
		Session.f_strStatusCode = "4";
		Session.f_nACDResponseCode = -7;
		Session.g_strReturnMsg = "OUTDIAL FAILED, UNABLE TO ADD PARTY";
		break;
	default:
		Server.logInfo("OUTDIAL CSR: UNKNOWN RESULT");
		Session.f_strStatusCode = "4";
		Session.f_nACDResponseCode = -7;
		Session.g_strReturnMsg = "OUTDIAL FAILED, UNABLE TO ADD PARTY";
		break;
}]]></script>
          </scripts>
        </action>
        <action id="12" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=405 y=534 ?>
          <!--DialOutCSRResponse Failure-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strACDControllerIP" transaction="strTransactionId" message-name="&quot;DialOutCSRResponse&quot;" destination-port="nACDControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;returnCode&quot;" value="f_nACDResponseCode"/>
            <parameter tag="&quot;returnMsg&quot;" value="g_strReturnMsg"/>
            <parameter tag="&quot;SOAPAgentPort&quot;" value="s_nSoapPort"/>
          </SOAP>
          <results >
            <result name="Default" link="16" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
        </action>
        <action id="13" plug-in="Pactolus.JavaStaticMethod.1" ><?xtml-editor x=1190 y=362 ?>
          <!--"recordOutdialAttempt"-->
          <java xmlns="urn:www.pactolus.com:xtml:application" class="&quot;com.pactolus.acd.ACDAssignment&quot;" method="&quot;recordOutdialAttempt&quot;" timeout="s_nTIMEOUT" return="f_nReturnCode" method-return-var="f_nReturnCode" method-return-type="0" >
            <parameter type="in" var-type="string" >g_strSessionId</parameter>
            <parameter type="in" var-type="i8" >g_lACDRequestId</parameter>
            <parameter type="in" var-type="i8" >g_lACDUserId</parameter>
            <parameter type="in" var-type="i8" >g_lOutdialStartTime</parameter>
            <parameter type="in" var-type="i8" >f_lOutdialEndTime</parameter>
            <parameter type="in" var-type="string" >f_strStatusCode</parameter>
            <parameter type="in" var-type="string" >g_strSIPStatus</parameter>
          </java>
          <results >
            <result name="Default" link="6" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: *********JAVA CALLING API recordOutdialAttempt *********");
Session.f_nReturnCode = 0;
Session.g_bRecordedOutdialAttempt = true;]]></script>
            <script language="javascript" timing="last" ><![CDATA[Server.logInfo("INFO: ********* iJavaReturnCode " + Session.f_nReturnCode);
if (Result.id != 2 || Session.f_nReturnCode != 0)
	Server.logError("ERROR: FAIL TO WRITE RECORD OUTDIAL ATTEMP");]]></script>
          </scripts>
        </action>
        <action id="14" plug-in="Pactolus.Branch.1" ><?xtml-editor x=913 y=366 ?>
          <!--recordedOutdialAttempt?-->
          <results >
            <result name="Default" link="6" stubbed="1"/>
            <result name="!g_bRecordedOutdialAttempt" link="13" stubbed="0" >g_bRecordedOutdialAttempt == false</result>
          </results>
        </action>
        <action id="15" plug-in="Pactolus.JavaStaticMethod.1" ><?xtml-editor x=931 y=518 ?>
          <!--"recordOutdialAttempt"-->
          <java xmlns="urn:www.pactolus.com:xtml:application" class="&quot;com.pactolus.acd.ACDAssignment&quot;" method="&quot;recordOutdialAttempt&quot;" timeout="s_nTIMEOUT" return="f_nReturnCode" method-return-var="f_nReturnCode" method-return-type="0" >
            <parameter type="in" var-type="string" >g_strSessionId</parameter>
            <parameter type="in" var-type="i8" >g_lACDRequestId</parameter>
            <parameter type="in" var-type="i8" >g_lACDUserId</parameter>
            <parameter type="in" var-type="i8" >g_lOutdialStartTime</parameter>
            <parameter type="in" var-type="i8" >f_lOutdialEndTime</parameter>
            <parameter type="in" var-type="string" >f_strStatusCode</parameter>
            <parameter type="in" var-type="string" >g_strSIPStatus</parameter>
          </java>
          <results >
            <result name="Default" link="7" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: *********JAVA CALLING API recordOutdialAttempt *********");
Session.f_nReturnCode = 0;
Session.g_bRecordedOutdialAttempt = true;]]></script>
            <script language="javascript" timing="last" ><![CDATA[Server.logInfo("INFO: ********* iJavaReturnCode " + Session.f_nReturnCode);
if (Result.id != 2 || Session.f_nReturnCode != 0)
	Server.logError("ERROR: FAIL TO WRITE RECORD OUTDIAL ATTEMP");]]></script>
          </scripts>
        </action>
        <action id="16" plug-in="Pactolus.Branch.1" ><?xtml-editor x=660 y=527 ?>
          <!--recordedOutdialAttempt?-->
          <results >
            <result name="Default" link="7" stubbed="1"/>
            <result name="!g_bRecordedOutdialAttempt" link="15" stubbed="0" >g_bRecordedOutdialAttempt == false</result>
          </results>
        </action>
      </actions>
    </function>
    <function name="OnCSRUnavailableNotify" start="1" event="OnCSRUnavailableNotify" returns="void" >
      <parameters >
        <parameter name="strACDControllerIP" type="string" pass="byref"/>
        <parameter name="nACDControllerPort" type="i4" pass="byref"/>
        <parameter name="strTransactionId" type="string" pass="byref"/>
        <parameter name="lCSRUserId" type="i8" pass="byref"/>
        <parameter name="strCSRType" type="string" pass="byref"/>
        <parameter name="strStateTime" type="string" pass="byref"/>
        <parameter name="nResultCode" type="i4" pass="byref"/>
        <parameter name="strResultMsg" type="string" pass="byref"/>
      </parameters>
      <actions >
        <action id="1" plug-in="Pactolus.Branch.1" ><?xtml-editor x=86 y=175 ?>
          <results >
            <result name="Default" link="4" stubbed="0"/>
            <result name="g_bOutdialCSR" link="2" stubbed="0" >g_bOutDialCSR == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: OnCSRUnavailable");]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=176 y=326 ?>
          <!--HangUpPartyA-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpParty&quot;" return="" external-function="1" library="lib_callcontrol.xml" >
            <parameter >g_oCallLegA</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="6" stubbed="0"/>
          </results>
        </action>
        <action id="3" plug-in="Standard.EndSession.1" ><?xtml-editor x=618 y=311 ?></action>
        <action id="4" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=296 y=150 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
        </action>
        <action id="5" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=548 y=442 ?>
          <!--OutdialCSRHangup-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strACDControllerIP" transaction="g_strZeroTransactionId" message-name="&quot;OutdialCSRHangup&quot;" destination-port="nACDControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;acdId&quot;" value="g_lACDUserId"/>
          </SOAP>
          <results >
            <result name="Default" link="3" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
        </action>
        <action id="6" plug-in="Pactolus.Sleep.1" ><?xtml-editor x=322 y=468 ?>
          <!--8 secs-->
          <sleep xmlns="urn:www.pactolus.com:xtml:application" duration="8"/>
          <results >
            <result name="Default" link="5" stubbed="0"/>
          </results>
        </action>
      </actions>
    </function>
    <function name="OnCancelDialOutCSRRequest" start="1" event="OnCancelDialOutCSRRequest" returns="void" >
      <parameters >
        <parameter name="strACDControllerIP" type="string" pass="byref"/>
        <parameter name="nACDControllerPort" type="i4" pass="byref"/>
        <parameter name="strTransactionId" type="string" pass="byref"/>
      </parameters>
      <local-vars >
        <var name="f_strCSeq" type="string" ></var>
        <var name="f_nReturnCode" type="i4" >0</var>
        <var name="f_bSendMoreCancel" type="boolean" >0</var>
        <var name="f_strStatusCode" type="string" >2</var>
        <var name="f_lOutdialEndTime" type="i8" >0</var>
      </local-vars>
      <actions >
        <action id="1" plug-in="Pactolus.Branch.1" ><?xtml-editor x=143 y=388 ?>
          <!--already got the cancel?-->
          <results >
            <result name="Default" link="3" stubbed="0"/>
            <result name="g_bGotCSRCancelOutdial" link="2" stubbed="0" >g_bGotCSRCancelOutdial == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: OnCancelDialOutCSRRequest");
js_disable_event();
Session.f_lOutdialEndTime = Server.getUTCTime();]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (2 == Result.id)
{
	Server.logInfo("ALREADY GOT THE CANCEL, CAN'T CANCEL AGAIN");
}]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=451 y=616 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="3" plug-in="Pactolus.Branch.1" ><?xtml-editor x=436 y=282 ?>
          <!--dialing out-->
          <results >
            <result name="Default" link="4" stubbed="1"/>
            <result name="currently dialing out == true" link="5" stubbed="0" >g_oCallLegA.bCurrentlyDialing == true</result>
            <result name="currently in MS== true" link="4" stubbed="1" >g_oMS.bCurrentlyConnected == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bGotCSRCancelOutdial = true;
Session.f_strCSeq = Session.g_oCallLegA.strCSeq;
Server.logInfo("CSEQ BEFORE CANCEL: " + Session.f_strCSeq);]]></script>
          </scripts>
        </action>
        <action id="4" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=696 y=445 ?>
          <!--Hang Up Party-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpParty&quot;" return="f_nReturnCode" external-function="1" library="lib_callcontrol.xml" >
            <parameter >g_oCallLegA</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="8" stubbed="0"/>
          </results>
        </action>
        <action id="5" plug-in="Pactolus.SipCancel.1" ><?xtml-editor x=679 y=251 ?>
          <!--B Leg-->
          <sip-bye xmlns="urn:www.pactolus.com:xtml:sip" add-record-route="0" add-via="1" handle-responses="0" increment-cseq-first="0" increment-cseq-last="0" >
            <call-id >g_oCallLegA.strCallId</call-id>
            <contact >g_strContact</contact>
            <cseq >f_strCSeq</cseq>
            <from >g_oCallLegA.strFrom</from>
            <record-route >g_oCallLegA.strRecordRoute</record-route>
            <request-uri >g_oCallLegA.strRequestUri</request-uri>
            <route >g_oCallLegA.strRoute</route>
            <to >g_oCallLegA.strTo</to>
          </sip-bye>
          <results >
            <result name="Default" link="6" stubbed="0"/>
            <result name="Success"/>
            <result name="Timeout"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[//work around Cisco2, it added the tag to the To field in the non final response
Session.g_oCallLegA.strTo = js_strip_tag(Session.g_oCallLegA.strTo);]]></script>
            <script language="javascript" timing="last" ><![CDATA[Session.g_oCallLegA.bConnected = false;
Session.g_oCallLegA.bCurrentlyDialing = false;
if (Result.id != 2)
{
	Server.logError("CANCEL PARTY B FAILS, EXIT ON: " + Result.name);
}]]></script>
          </scripts>
        </action>
        <action id="6" plug-in="Pactolus.Branch.1" ><?xtml-editor x=948 y=243 ?>
          <!--send more cancel?-->
          <results >
            <result name="Default" link="8" stubbed="1"/>
            <result name="f_bSendMoreCancel" link="5" stubbed="1" >f_bSendMoreCancel == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[var myCSeq = new SipCSeq(Session.f_strCSeq);
if (myCSeq.value > 1100)
{
	myCSeq.value--;
	Session.f_strCSeq = myCSeq.encode();
	Session.f_bSendMoreCancel = true;
	Server.logInfo("MORE CANCEL TO SEND, CSEQ: " + Session.f_strCSeq);
}
else
{
	//don't want to try to send another CANCEL
	Session.f_bSendMoreCancel = false;
}]]></script>
          </scripts>
        </action>
        <action id="7" plug-in="Standard.EndSession.1" ><?xtml-editor x=1921 y=427 ?></action>
        <action id="8" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=933 y=440 ?>
          <!--OutdialCSRHangup-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strACDControllerIP" transaction="g_strZeroTransactionId" message-name="&quot;OutdialCSRHangup&quot;" destination-port="nACDControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;acdId&quot;" value="g_lACDUserId"/>
          </SOAP>
          <results >
            <result name="Default" link="9" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
        </action>
        <action id="9" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1166 y=435 ?>
          <!--DialOutCSRResponse Failure-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strACDControllerIP" transaction="g_strResponseTransactionId" message-name="&quot;DialOutCSRResponse&quot;" destination-port="nACDControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;returnCode&quot;" value="2"/>
            <parameter tag="&quot;returnMsg&quot;" value="g_strReturnMsg"/>
            <parameter tag="&quot;SOAPAgentPort&quot;" value="s_nSoapPort"/>
          </SOAP>
          <results >
            <result name="Default" link="11" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "Dialout CSR canceled";]]></script>
          </scripts>
        </action>
        <action id="10" plug-in="Pactolus.JavaStaticMethod.1" ><?xtml-editor x=1682 y=428 ?>
          <!--"recordOutdialAttempt"-->
          <java xmlns="urn:www.pactolus.com:xtml:application" class="&quot;com.pactolus.acd.ACDAssignment&quot;" method="&quot;recordOutdialAttempt&quot;" timeout="s_nTIMEOUT" return="f_nReturnCode" method-return-var="f_nReturnCode" method-return-type="0" >
            <parameter type="in" var-type="string" >g_strSessionId</parameter>
            <parameter type="in" var-type="i8" >g_lACDRequestId</parameter>
            <parameter type="in" var-type="i8" >g_lACDUserId</parameter>
            <parameter type="in" var-type="i8" >g_lOutdialStartTime</parameter>
            <parameter type="in" var-type="i8" >f_lOutdialEndTime</parameter>
            <parameter type="in" var-type="string" >f_strStatusCode</parameter>
            <parameter type="in" var-type="string" >g_strSIPStatus</parameter>
          </java>
          <results >
            <result name="Default" link="7" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: *********JAVA CALLING API recordOutdialAttempt *********");
Session.f_nReturnCode = 0;
Session.g_bRecordedOutdialAttempt = true;]]></script>
            <script language="javascript" timing="last" ><![CDATA[Server.logInfo("INFO: ********* iJavaReturnCode " + Session.f_nReturnCode);
if (Result.id != 2 || Session.f_nReturnCode != 0)
	Server.logError("ERROR: FAIL TO WRITE RECORD OUTDIAL ATTEMP");]]></script>
          </scripts>
        </action>
        <action id="11" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1411 y=437 ?>
          <!--recordedOutdialAttempt?-->
          <results >
            <result name="Default" link="7" stubbed="1"/>
            <result name="!g_bRecordedOutdialAttempt" link="10" stubbed="0" >g_bRecordedOutdialAttempt == false</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("OUTDIAL CSR: CALLER HUNG UP");]]></script>
          </scripts>
        </action>
      </actions>
    </function>
    <function name="OnConfJoinEventResponse" start="1" event="OnConfJoinEventResponse" returns="void" >
      <parameters >
        <parameter name="strConfControllerIP" type="string" pass="byref"/>
        <parameter name="nConfControllerPort" type="i4" pass="byref"/>
        <parameter name="strTransactionId" type="string" pass="byref"/>
        <parameter name="strWFM" type="string" pass="byref"/>
        <parameter name="strMediaServerEndPoint" type="string" pass="byref"/>
        <parameter name="strCustomerConferenceId" type="string" pass="byref"/>
        <parameter name="strCCGeneratedPassCode" type="string" pass="byref"/>
        <parameter name="strFirstCallerFlag" type="string" pass="byref"/>
      </parameters>
      <actions >
        <action id="1" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=268 y=165 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: OnConfJoinEventResponse");
Server.logInfo("RECEIVE CONF JOIN EVENT RESPONSE");
Server.logInfo("strCustomerConferenceId IS: " + Session.strCustomerConferenceId);
Server.logInfo("strCCGeneratedPassCode IS: " + Session.strCCGeneratedPassCode);
Server.logInfo("strMediaServerEndPoint IS" + Session.strMediaServerEndPoint);

if ( 0 == Clib.strcmp(Session.g_strConferencePasscode, Session.strCCGeneratedPassCode) )
{
	Session.g_bConfControllerGeneratedPCode = false;
}
else
{
	Session.g_bConfControllerGeneratedPCode = true;
	Server.logInfo("g_bConfControllerGeneratedPCode IS: " + Session.g_bConfControllerGeneratedPCode);	
}
Session.g_strCCGeneratedPasscode = Session.strCCGeneratedPassCode;]]></script>
          </scripts>
        </action>
      </actions>
    </function>
    <function name="OnBeginCSRConsultNotify" start="1" event="OnBeginCSRConsultNotify" returns="void" >
      <parameters >
        <parameter name="strACDControllerIP" type="string" pass="byref"/>
        <parameter name="nACDControllerPort" type="i4" pass="byref"/>
        <parameter name="strTransactionId" type="string" pass="byref"/>
        <parameter name="strCSRName" type="string" pass="byref"/>
      </parameters>
      <actions >
        <action id="1" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=79 y=69 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: OnBeginCSRConsultNotify");]]></script>
          </scripts>
        </action>
      </actions>
    </function>
    <function name="OnEndCSRConsultNotify" start="12" event="OnEndCSRConsultNotify" returns="void" >
      <parameters >
        <parameter name="strACDControllerIP" type="string" pass="byref"/>
        <parameter name="nACDControllerPort" type="i4" pass="byref"/>
        <parameter name="strTransactionId" type="string" pass="byref"/>
        <parameter name="strHangupNow" type="string" pass="byref"/>
      </parameters>
      <local-vars >
        <var name="f_nReturnCode" type="i4" >-1</var>
      </local-vars>
      <actions >
        <action id="12" plug-in="Pactolus.Branch.1" ><?xtml-editor x=87 y=150 ?>
          <!--HangUp or Transfer-->
          <results >
            <result name="Default" link="11" stubbed="0"/>
            <result name="HangUp Now" link="3" stubbed="0" >strHangupNow match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: OnEndCSRConsultNotify");
Server.logInfo("RECEIVE EndCSRConsultNotify");
Server.logInfo("strACDControllerIP: " + Session.strACDControllerIP);
Server.logInfo("nACDControllerPort: " + Session.nACDControllerPort);
Server.logInfo("strTransactionId: " + Session.strTransactionId);
Server.logInfo("strHangupNow: " + Session.strHangupNow);
Session.g_lEndTime = Server.getUTCTime();
]]></script>
          </scripts>
        </action>
        <action id="3" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=318 y=322 ?>
          <!--HangUpPartyA-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpParty&quot;" return="" external-function="1" library="lib_callcontrol.xml" >
            <parameter >g_oCallLegA</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="8" stubbed="1"/>
            <result name="SUCCESS" link="9" stubbed="0" >f_nReturnCode == s_nSUCCESS</result>
          </results>
        </action>
        <action id="6" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=305 y=203 ?>
          <!--"SendLogoutCSRIVR"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;SendLogoutCSRIVR&quot;" return="f_nReturnCode" external-function="0" library=""/>
          <results >
            <result name="Default" link="3" stubbed="1"/>
          </results>
        </action>
        <action id="8" plug-in="Standard.EndSession.1" ><?xtml-editor x=968 y=310 ?></action>
        <action id="9" plug-in="Pactolus.Sleep.1" ><?xtml-editor x=546 y=320 ?>
          <!--8 secs-->
          <sleep xmlns="urn:www.pactolus.com:xtml:application" duration="8"/>
          <results >
            <result name="Default" link="10" stubbed="0"/>
          </results>
        </action>
        <action id="10" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=766 y=313 ?>
          <!--OutdialCSRHangup-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strACDControllerIP" transaction="g_strZeroTransactionId" message-name="&quot;OutdialCSRHangup&quot;" destination-port="nACDControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;acdId&quot;" value="g_lACDUserId"/>
          </SOAP>
          <results >
            <result name="Default" link="8" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
        </action>
        <action id="11" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=301 y=114 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
        </action>
      </actions>
    </function>
    <function name="OnCSRChangeCoachingModeRequest" start="1" event="OnCSRChangeCoachingModeRequest" returns="void" >
      <parameters >
        <parameter name="strACDControllerIP" type="string" pass="byref"/>
        <parameter name="nACDControllerPort" type="i4" pass="byref"/>
        <parameter name="strTransactionId" type="string" pass="byref"/>
        <parameter name="strCoachingMode" type="string" pass="byref"/>
        <parameter name="strCoacheeConnection" type="string" pass="byref"/>
      </parameters>
      <local-vars >
        <var name="f_nReturnCode" type="i4" >0</var>
        <var name="f_strResultMessage" type="string" >""</var>
        <var name="bPlayDepartTone" type="boolean" >0</var>
      </local-vars>
      <actions >
        <action id="1" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=160 y=289 ?>
          <!--"ModifyConferenceMember"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ModifyConferenceMember&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="8" stubbed="0"/>
            <result name="f_nReturnCode != 0" link="4" stubbed="0" >f_nReturnCode != 0</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: OnCSRChangeCoachingModeRequest");
Server.logInfo("**** Before Change Coaching Mode  ****");

Server.logInfo("oCallLeg.strFrom: " + Session.g_oCallLegA.strFrom);
Server.logInfo("oCallLeg.strTo: " + Session.g_oCallLegA.strTo);
Server.logInfo("oCallLeg.strContent: " + Session.g_oCallLegA.strContent);
Server.logInfo("oCallLeg.strCSeq: " + Session.g_oCallLegA.strCSeq);
Server.logInfo("oCallLeg.strCallId: " + Session.g_oCallLegA.strCallId);
Server.logInfo("oCallLeg.strRequestUri: " + Session.g_oCallLegA.strRequestUri);
Server.logInfo("oCallLeg.strRoute: " + Session.g_oCallLegA.strRoute);
Server.logInfo("oCallLeg.strRecordRoute: " + Session.g_oCallLegA.strRecordRoute);

Server.logInfo("oMS.strConferenceId: " + Session.g_oMS.strConferenceId);
Server.logInfo("oMS.strEndPoint: " + Session.g_oMS.strEndPoint);
Server.logInfo("oMS.strContent: " + Session.g_oMS.strContent);
Server.logInfo("oMS.strConnectionId: " + Session.g_oMS.strConnectionId);
Server.logInfo("oMS.strCallId: " + Session.g_oMS.strCallId);
Server.logInfo("oMS.strType: " + Session.g_oMS.strType);
Server.logInfo("oMS.bMuteFlag: " + Session.g_oMS.bMuteFlag);
Server.logInfo("oMS.bDeafFlag: " + Session.g_oMS.bDeafFlag);
Server.logInfo("oMS.bCurrentlyInConf: " + Session.g_oMS.bCurrentlyInConf);
Server.logInfo("oMS.bCurrentlyConnected: " + Session.g_oMS.bCurrentlyConnected);
Server.logInfo("oMS.bRetry: " + Session.g_oMS.bRetry);
Server.logInfo("oMS.bDTMFClampFlag: " + Session.g_oMS.bDTMFClampFlag);

Server.logInfo("oMS.strCoachingMode WAS : " + Session.g_oMS.strCoachingMode);
if ("SR" == Session.g_oMS.strCoachingMode)
	Session.bPlayDepartTone = true;
else
	Session.bPlayDepartTone = false;

Session.g_oMS.strCoachingMode = Session.strCoachingMode;
Session.g_oMS.strCoacheeConnection = Session.strCoacheeConnection;
Session.g_oMS.strCoachingFlag="T";

Server.logInfo("oMS.strCoachingMode: " + Session.g_oMS.strCoachingMode);
if ("SR" == Session.strCoachingMode)
	Session.g_bPlayTone = true;
else
	Session.g_bPlayTone = false;]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1150 y=253 ?>
          <!--Return SUCCESS-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nSUCCESS"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("**** Success After Change Coaching Mode  ****");
]]></script>
          </scripts>
        </action>
        <action id="3" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=698 y=426 ?>
          <!--Return FAILURE-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nFAILURE"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("**** Failure After Change Coaching Mode  ****");
Server.logInfo("Change Coaching Mode Return code " + Session.f_nReturnCode);
Server.logInfo("Change Coaching Mode Return message " + Session.f_strResultMessage);]]></script>
          </scripts>
        </action>
        <action id="4" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=435 y=432 ?>
          <!--"CoachingModeResponse"-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strACDControllerIP" transaction="strTransactionId" message-name="&quot;CSRChangeCoachingModeResponse&quot;" destination-port="nACDControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;ResultCode&quot;" value="f_nReturnCode"/>
            <parameter tag="&quot;ResultMessage&quot;" value="f_strResultMessage"/>
          </SOAP>
          <results >
            <result name="Default" link="3" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.f_strResultMessage = "MediaServer causing coaching mode error"; ]]></script>
          </scripts>
        </action>
        <action id="5" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=899 y=261 ?>
          <!--"CoachingModeResponse"-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strACDControllerIP" transaction="strTransactionId" message-name="&quot;CSRChangeCoachingModeResponse&quot;" destination-port="nACDControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;ResultCode&quot;" value="f_nReturnCode"/>
            <parameter tag="&quot;ResultMessage&quot;" value="f_strResultMessage"/>
          </SOAP>
          <results >
            <result name="Default" link="3" stubbed="1"/>
            <result name="Success" link="2" stubbed="0"/>
            <result name="Error"/>
          </results>
        </action>
        <action id="6" plug-in="Pactolus.Branch.1" ><?xtml-editor x=635 y=155 ?>
          <!--play tone?-->
          <results >
            <result name="Default" link="5" stubbed="1"/>
            <result name="g_bPlayTone" link="7" stubbed="0" >g_bPlayTone == true</result>
          </results>
        </action>
        <action id="7" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=872 y=155 ?>
          <!--Play Join Tone to conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;PlayPromptToConference&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
            <parameter >g_strLanguage</parameter>
            <parameter >s_nPROMPT_JOIN_TONE</parameter>
          </function>
          <results >
            <result name="Default" link="5" stubbed="1"/>
          </results>
        </action>
        <action id="8" plug-in="Pactolus.Branch.1" ><?xtml-editor x=418 y=186 ?>
          <!--play depart tone?-->
          <results >
            <result name="Default" link="6" stubbed="0"/>
            <result name="bPlayDepartTone" link="9" stubbed="0" >bPlayDepartTone == true</result>
          </results>
        </action>
        <action id="9" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=650 y=263 ?>
          <!--play depart tone to conference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;PlayPromptToConference&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
            <parameter >g_strLanguage</parameter>
            <parameter >s_nPROMPT_DEPART_TONE</parameter>
          </function>
          <results >
            <result name="Default" link="5" stubbed="0"/>
          </results>
        </action>
      </actions>
    </function>
    <function name="OnCSRBeginPrivateTalkRequest" start="1" event="OnCSRBeginPrivateTalkRequest" returns="void" >
      <parameters >
        <parameter name="strCCIP" type="string" pass="byref"/>
        <parameter name="nCCPort" type="i4" pass="byref"/>
        <parameter name="strTransactionId" type="string" pass="byref"/>
        <parameter name="lConferenceId" type="i8" pass="byref"/>
        <parameter name="strCCGeneratedPasscode" type="string" pass="byref"/>
      </parameters>
      <local-vars >
        <var name="nReturnCode" type="i4" >-1</var>
        <var name="strReturnMsg" type="string" ></var>
      </local-vars>
      <actions >
        <action id="1" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=63 y=129 ?>
          <!--CreateConference-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;CreateConference&quot;" return="nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oPrivateTalkMS</parameter>
          </function>
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="SUCCESS" link="4" stubbed="0" >nReturnCode == s_nSUCCESS</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_disable_event();
Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: OnCSRBeginPrivateTalk");
Server.logInfo("Conference Controller IP is: " + Session.strCCIP);
Server.logInfo("Conference Controller port is: " + Session.nCCPort);
Server.logInfo("Conference ID is: " + Session.lConferenceId);
Server.logInfo("Caller Passcode is: " + Session.strCCGeneratedPasscode);
Session.g_strConfControllerIP = Session.strCCIP;
Session.g_nConfControllerPort = Session.nCCPort;
Session.g_lConferenceId = Session.lConferenceId;
Session.g_strCCGeneratedPasscode = Session.strCCGeneratedPasscode;
js_initMS(Session.g_oPrivateTalkMS, Session.s_strMSType);
//ASN
Session.g_oPrivateTalkMS.nMaxActiveSpeakers = Session.s_nMaxActiveSpeakers;
Session.g_oPrivateTalkMS.nNbrActiveSpeakers = Session.s_nNbrActiveSpeakers;
Session.g_oPrivateTalkMS.nReportingInterval = Session.s_nReportingInterval;
Session.g_oPrivateTalkMS.nDBThreshold = Session.s_nDBThreshold;
//AGC
Session.g_oPrivateTalkMS.nAGCTargetLevelIn = Session.s_nAGCTargetLevelIn;
Session.g_oPrivateTalkMS.nAGCMaxLevelIn = Session.s_nAGCMaxLevelIn;
Session.g_oPrivateTalkMS.nAGCTargetLevelOut = Session.s_nAGCTargetLevelOut;
Session.g_oPrivateTalkMS.nAGCMaxLevelOut = Session.s_nAGCMaxLevelOut;

Session.g_oPrivateTalkMS.strACDType = Session.s_strACDMediaServerType;
Session.g_oPrivateTalkMS.strConfType = Session.s_strConf_MS_Type;
Session.g_oPrivateTalkMS.bUseForConf = true;
Session.g_oPrivateTalkMS.nPacketizationPeriod = Session.s_nPacketizationPeriod;
Session.g_oPrivateTalkMS.bDTMFClampFlag = false;
Session.g_oPrivateTalkMS.bPersistentFlag = true;
Session.g_oPrivateTalkMS.strConferenceId = "";
if (Session.s_strMSRetryFlag == "T")
{
	Session.g_oPrivateTalkMS.bRetry = true;
}
else
{
	Session.g_oPrivateTalkMS.bRetry = false;
}]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=308 y=101 ?>
          <!--RESPONSE FAILURE-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strCCIP" transaction="strTransactionId" message-name="s_strCSRBeginPrivateTalkResponse" destination-port="nCCPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;returnCode&quot;" value="s_nFAILURE"/>
            <parameter tag="&quot;ConferenceEndpoint&quot;" value="g_oPrivateTalkMS.strConferenceId"/>
          </SOAP>
          <results >
            <result name="Default" link="3" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
        </action>
        <action id="3" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=553 y=101 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="4" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=323 y=257 ?>
          <!--"AddMemberToConference"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;AddMemberToConference&quot;" return="nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oPrivateTalkMS</parameter>
            <parameter >g_oCallLegA</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="7" stubbed="0"/>
            <result name="SUCCESS" link="5" stubbed="0" >nReturnCode == s_nSUCCESS</result>
          </results>
        </action>
        <action id="5" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=560 y=359 ?>
          <!--RESPONSE SUCCESS-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strCCIP" transaction="strTransactionId" message-name="s_strCSRBeginPrivateTalkResponse" destination-port="nCCPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;returnCode&quot;" value="s_nSUCCESS"/>
            <parameter tag="&quot;returnMsg&quot;" value="strReturnMsg"/>
            <parameter tag="&quot;ConferenceEndpoint&quot;" value="g_oPrivateTalkMS.strConferenceId"/>
          </SOAP>
          <results >
            <result name="Default" link="3" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[Session.g_bBeginPrivateTalk = true;]]></script>
          </scripts>
        </action>
        <action id="7" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=545 y=251 ?>
          <!--"DeleteConference"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DeleteConference&quot;" return="nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oPrivateTalkMS</parameter>
          </function>
          <results >
            <result name="Default" link="2" stubbed="1"/>
          </results>
        </action>
      </actions>
      <text-objects >
        <text-object x-coord="54" y-coord="19" width="276" height="54" text="save CC ip and port, conferenceId, passcode.  Need to notify CC if CSR hangup" font-name="Times New Roman" size="-16" red="0" green="0" blue="0" weight="0" underline="0" strikeout="0" point-size="12" italic="0"/>
      </text-objects>
    </function>
    <function name="OnCSREndPrivateTalkRequest" start="4" event="OnCSREndPrivateTalkRequest" returns="void" >
      <parameters >
        <parameter name="strCCIP" type="string" pass="byref"/>
        <parameter name="nCCPort" type="i4" pass="byref"/>
        <parameter name="strTransactionId" type="string" pass="byref"/>
        <parameter name="nActionCode" type="i4" pass="byref"/>
        <parameter name="strSendResponseBackFlag" type="string" pass="byref"/>
        <parameter name="nConfStatus" type="i4" pass="byref"/>
        <parameter name="lPartySchedId" type="i8" pass="byref"/>
        <parameter name="strPartyDetail" type="string" pass="byref"/>
        <parameter name="p_nAudioMode" type="i4" pass="byref"/>
        <parameter name="strSubConferenceId" type="string" pass="byref"/>
      </parameters>
      <local-vars >
        <var name="nReturnCode" type="i4" >-1</var>
        <var name="strReturnMsg" type="string" ></var>
      </local-vars>
      <actions >
        <action id="4" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=137 y=225 ?>
          <!--"RemoveMemberFromConference"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;RemoveMemberFromConference&quot;" return="nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oPrivateTalkMS</parameter>
          </function>
          <results >
            <result name="Default" link="6" stubbed="0"/>
            <result name="SUCCESS" link="5" stubbed="0" >nReturnCode == s_nSUCCESS</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_disable_event();
Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: OnCSREndPrivateTalk");]]></script>
          </scripts>
        </action>
        <action id="1" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=881 y=185 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bCSRMicOn = false;
js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=636 y=185 ?>
          <!--RESPONSE FAILURE-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strCCIP" transaction="strTransactionId" message-name="s_strCSREndPrivateTalkResponse" destination-port="nCCPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;returnCode&quot;" value="s_nFAILURE"/>
            <parameter tag="&quot;returnMsg&quot;" value="strReturnMsg"/>
          </SOAP>
          <results >
            <result name="Default" link="1" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.strReturnMsg = "ERROR remove memeber from conference";]]></script>
          </scripts>
        </action>
        <action id="3" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=875 y=347 ?>
          <!--RESPONSE SUCCESS-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strCCIP" transaction="strTransactionId" message-name="s_strCSREndPrivateTalkResponse" destination-port="nCCPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;returnCode&quot;" value="s_nSUCCESS"/>
            <parameter tag="&quot;returnMsg&quot;" value="strReturnMsg"/>
          </SOAP>
          <results >
            <result name="Default" link="18" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.strReturnMsg = "SUCCESS";]]></script>
          </scripts>
        </action>
        <action id="5" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=400 y=350 ?>
          <!--"DeleteConference"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DeleteConference&quot;" return="nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oPrivateTalkMS</parameter>
          </function>
          <results >
            <result name="Default" link="7" stubbed="0"/>
          </results>
        </action>
        <action id="6" plug-in="Pactolus.Branch.1" ><?xtml-editor x=384 y=210 ?>
          <!--sendResponseBack?-->
          <results >
            <result name="Default" link="1" stubbed="1"/>
            <result name="sendResponseBack==T" link="2" stubbed="0" >strSendResponseBackFlag match "T"</result>
          </results>
        </action>
        <action id="7" plug-in="Pactolus.Branch.1" ><?xtml-editor x=640 y=348 ?>
          <!--sendResponseBack?-->
          <results >
            <result name="Default" link="18" stubbed="1"/>
            <result name="sendResponseBack==T" link="3" stubbed="0" >strSendResponseBackFlag match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_bBeginPrivateTalk = false;]]></script>
          </scripts>
        </action>
        <action id="9" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=382 y=519 ?>
          <!--"SendLogoutCSRIVR"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;SendLogoutCSRIVR&quot;" return="" external-function="0" library=""/>
          <results >
            <result name="Default" link="15" stubbed="0"/>
          </results>
        </action>
        <action id="10" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=412 y=678 ?>
          <!--HangUpPartyA-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpParty&quot;" return="" external-function="1" library="lib_callcontrol.xml" >
            <parameter >g_oCallLegA</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="13" stubbed="0"/>
          </results>
        </action>
        <action id="11" plug-in="Standard.EndSession.1" ><?xtml-editor x=869 y=664 ?></action>
        <action id="13" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=643 y=667 ?>
          <!--OutdialCSRHangup-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strACDControllerIP" transaction="g_strZeroTransactionId" message-name="&quot;OutdialCSRHangup&quot;" destination-port="g_nACDControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;acdId&quot;" value="g_lACDUserId"/>
          </SOAP>
          <results >
            <result name="Default" link="11" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
        </action>
        <action id="15" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=634 y=517 ?>
          <!--HangUpPartyA-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpParty&quot;" return="" external-function="1" library="lib_callcontrol.xml" >
            <parameter >g_oCallLegA</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="11" stubbed="1"/>
          </results>
        </action>
        <action id="18" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=126 y=528 ?>
          <!--put caller on hold-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;PutPartyOnHold&quot;" return="nReturnCode" external-function="1" library="lib_callcontrol.xml" >
            <parameter >g_oCallLegA</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="9" stubbed="0"/>
            <result name="SUCCESS, !OutDial CSR" link="1" stubbed="1" >nReturnCode == s_nSUCCESS
AND g_bOutDialCSR == false</result>
            <result name="OutDialCSR" link="10" stubbed="0" >g_bOutDialCSR == true</result>
          </results>
        </action>
      </actions>
    </function>
    <function name="OnConfAddToSubConfRequest" start="1" event="OnConfAddToSubConfRequest" returns="void" >
      <parameters >
        <parameter name="p_strConfControllerIP" type="string" pass="byref"/>
        <parameter name="p_nConfControllerPort" type="i4" pass="byref"/>
        <parameter name="p_strTransactionId" type="string" pass="byref"/>
        <parameter name="p_strCallerPassCode" type="string" pass="byref"/>
        <parameter name="p_strSubConfId" type="string" pass="byref"/>
        <parameter name="p_strSubConfModeratorFlag" type="string" pass="byref"/>
        <parameter name="p_strSubConferenceEndPoint" type="string" pass="byref"/>
        <parameter name="p_nAudioMode" type="i4" pass="byref"/>
      </parameters>
      <local-vars >
        <var name="f_nReturnCode" type="i4" >-1</var>
        <var name="f_bCreateSubConference" type="boolean" >0</var>
        <var name="bNullString" type="boolean" >0</var>
        <var name="f_strDeleteSubConf" type="string" ></var>
        <var name="strTransferedFlag" type="string" ></var>
      </local-vars>
      <actions >
        <action id="1" plug-in="Pactolus.Branch.1" ><?xtml-editor x=128 y=277 ?>
          <results >
            <result name="Default" link="4" stubbed="0"/>
            <result name="NotFirstCaller but no endpoint" link="2" stubbed="0" >bNullString == true</result>
            <result name="AudioMode == 1 (hold)" link="19" stubbed="0" >p_nAudioMode == 1</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: OnConfAddToSubConfRequest");

js_disable_event();

Server.logInfo("CONF ADD PARTY TO SUB CONFERENCE");

Server.logInfo("p_strSubConfId  : " + Session.p_strSubConfId);

Server.logInfo("p_strFirstParticipantFlag  : " + Session.p_strFirstParticipantFlag);

Server.logInfo("p_strSubConfModeratorFlag  : " + Session.p_strSubConfModeratorFlag);

Server.logInfo("p_strSubConferenceEndPoint  : " + Session.p_strSubConferenceEndPoint);
Server.logInfo("p_nAudioMode  : " + Session.p_nAudioMode);

Session.g_strSubConferenceId = Session.p_strSubConfId;

Session.g_strSubConfModeratorFlag = Session.p_strSubConfModeratorFlag;

Server.logInfo("INIT SUB CONFERENCE OBJECT");

js_initMS(Session.g_oSubConfMS, Session.s_strMSType);
//ASN
Session.g_oSubConfMS.nMaxActiveSpeakers = Session.s_nMaxActiveSpeakers;
Session.g_oSubConfMS.nNbrActiveSpeakers = Session.s_nNbrActiveSpeakers;
Session.g_oSubConfMS.nReportingInterval = Session.s_nReportingInterval;
Session.g_oSubConfMS.nDBThreshold = Session.s_nDBThreshold;
//AGC
Session.g_oSubConfMS.nAGCTargetLevelIn = Session.s_nAGCTargetLevelIn;
Session.g_oSubConfMS.nAGCMaxLevelIn = Session.s_nAGCMaxLevelIn;
Session.g_oSubConfMS.nAGCTargetLevelOut = Session.s_nAGCTargetLevelOut;
Session.g_oSubConfMS.nAGCMaxLevelOut = Session.s_nAGCMaxLevelOut;
if (0 == Session.p_strSubConferenceEndPoint.length)

{

	Session.bNullString = true;

}

else

{

	Session.g_oSubConfMS.strConferenceId = Session.p_strSubConferenceEndPoint;

	Session.bNullString = false;

}

]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=404 y=354 ?>
          <!--fail to add to sub conf-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="p_strConfControllerIP" transaction="p_strTransactionId" message-name="&quot;ConfAddToSubConfResponse&quot;" destination-port="p_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;Status&quot;" value="s_nFAILURE"/>
            <parameter tag="&quot;StatusMessage&quot;" value="g_strReturnMsg"/>
            <parameter tag="&quot;Endpoint&quot;" value="p_strSubConferenceEndPoint"/>
            <parameter tag="&quot;CallerPassCode&quot;" value="p_strCallerPassCode"/>
            <parameter tag="&quot;ConnectionId&quot;" value="g_oSubConfMS.strConnectionId"/>
          </SOAP>
          <results >
            <result name="Default" link="3" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "NOT FIRST PARTICIPANT, BUT THERE IS NO ENDPOINT";]]></script>
          </scripts>
        </action>
        <action id="3" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=629 y=422 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="4" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=386 y=214 ?>
          <!--"MoveFromMainConfToSubConf"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;MoveFromMainConfToSubConf&quot;" return="f_nReturnCode" external-function="1" library="lib_utils.xml" >
            <parameter >f_bCreateSubConference</parameter>
            <parameter >g_oMS</parameter>
            <parameter >g_oSubConfMS</parameter>
            <parameter >g_oCallLegA</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="5" stubbed="0"/>
            <result name="CALLER HUNGUP" link="9" stubbed="0" >f_nReturnCode == s_nCALLERHUNGUP</result>
            <result name="SUCCESS" link="8" stubbed="0" >f_nReturnCode == s_nSUCCESS</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if ("T" == Session.p_strFirstParticipantFlag)
{
	Session.f_bCreateSubConference = true;
}
else
{
	Session.f_bCreateSubConference = false;
}
Session.g_oSubConfMS.bDeafFlag = false;
if (2 == Session.p_nAudioMode)
{
	Server.logInfo("ADD CSR TO SUB CONFERENCE MUTED");
	Session.g_oSubConfMS.bMuteFlag = true;
}
else
{
	Server.logInfo("ADD CSR TO SUB CONFERENCE UNMUTED");
	Session.g_oSubConfMS.bMuteFlag = false;
}]]></script>
          </scripts>
        </action>
        <action id="5" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=611 y=46 ?>
          <!--fail to add to sub conf-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="p_strConfControllerIP" transaction="p_strTransactionId" message-name="&quot;ConfAddToSubConfResponse&quot;" destination-port="p_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;Status&quot;" value="s_nFAILURE"/>
            <parameter tag="&quot;StatusMessage&quot;" value="g_strReturnMsg"/>
            <parameter tag="&quot;Endpoint&quot;" value="p_strSubConferenceEndPoint"/>
            <parameter tag="&quot;CallerPassCode&quot;" value="p_strCallerPassCode"/>
            <parameter tag="&quot;ConnectionId&quot;" value="g_oMS.strConnectionId"/>
          </SOAP>
          <results >
            <result name="Default" link="3" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "UNABLE TO ADD PARTICIPANT INTO SUB CONFERENCE";]]></script>
          </scripts>
        </action>
        <action id="8" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=665 y=304 ?>
          <!--success to add to sub conf-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="p_strConfControllerIP" transaction="p_strTransactionId" message-name="&quot;ConfAddToSubConfResponse&quot;" destination-port="p_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;Status&quot;" value="s_nSUCCESS"/>
            <parameter tag="&quot;StatusMessage&quot;" value="g_strReturnMsg"/>
            <parameter tag="&quot;Endpoint&quot;" value="g_oSubConfMS.strConferenceId"/>
            <parameter tag="&quot;CallerPassCode&quot;" value="p_strCallerPassCode"/>
            <parameter tag="&quot;ConnectionId&quot;" value="g_oSubConfMS.strConnectionId"/>
          </SOAP>
          <results >
            <result name="Default" link="3" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "SUCCESS ADD CSR INTO SUB CONFERENCE";
Session.g_bCurrentlyInSubConf = true;
Session.g_lSubConferenceJoinTime = Server.getUTCTime();]]></script>
          </scripts>
        </action>
        <action id="9" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=651 y=172 ?>
          <!--fail to add to sub conf-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="p_strConfControllerIP" transaction="p_strTransactionId" message-name="&quot;ConfAddToSubConfResponse&quot;" destination-port="p_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;Status&quot;" value="s_nFAILURE"/>
            <parameter tag="&quot;StatusMessage&quot;" value="g_strReturnMsg"/>
            <parameter tag="&quot;Endpoint&quot;" value="p_strSubConferenceEndPoint"/>
            <parameter tag="&quot;CallerPassCode&quot;" value="p_strCallerPassCode"/>
            <parameter tag="&quot;ConnectionId&quot;" value="g_oMS.strConnectionId"/>
          </SOAP>
          <results >
            <result name="Default" link="14" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "UNABLE TO ADD PARTICIPANT INTO SUB CONFERENCE, CALLER HUNG UP";]]></script>
          </scripts>
        </action>
        <action id="11" plug-in="Standard.EndSession.1" ><?xtml-editor x=1102 y=167 ?></action>
        <action id="12" plug-in="Pactolus.Branch.1" ><?xtml-editor x=897 y=312 ?>
          <!--CallPartyFlag==T?-->
          <results >
            <result name="Default" link="13" stubbed="0"/>
            <result name="g_strPartyPasscodeFlag==T" link="14" stubbed="0" >g_strPartyPasscodeFlag match "T"</result>
          </results>
        </action>
        <action id="13" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1112 y=265 ?>
          <!--PARTY LEAVE CONF-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="g_strZeroTransactionId" message-name="s_strCONF_LEAVE" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
            <parameter tag="&quot;callerPassCode&quot;" value="s_strEMPTY_STRING"/>
            <parameter tag="&quot;disconnectTime&quot;" value="g_lEndTime"/>
            <parameter tag="&quot;reasonCode&quot;" value="g_nConfLeaveReason"/>
            <parameter tag="&quot;reasonMsg&quot;" value="g_strConfLeaveMsg"/>
            <parameter tag="&quot;transferedFlag&quot;" value="strTransferedFlag"/>
          </SOAP>
          <results >
            <result name="Default" link="15" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
        </action>
        <action id="14" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1129 y=402 ?>
          <!--PARTY LEAVE CONF-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="g_strZeroTransactionId" message-name="s_strCONF_LEAVE" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
            <parameter tag="&quot;callerPassCode&quot;" value="g_strCCGeneratedPasscode"/>
            <parameter tag="&quot;disconnectTime&quot;" value="g_lEndTime"/>
            <parameter tag="&quot;reasonCode&quot;" value="g_nConfLeaveReason"/>
            <parameter tag="&quot;reasonMsg&quot;" value="g_strConfLeaveMsg"/>
            <parameter tag="&quot;transferedFlag&quot;" value="strTransferedFlag"/>
          </SOAP>
          <results >
            <result name="Default" link="15" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
        </action>
        <action id="15" plug-in="Standard.WaitEvent.1" ><?xtml-editor x=1365 y=263 ?>
          <!--ConfLeaveEventResponse-->
          <wait xmlns="urn:www.pactolus.com:xtml:communication" timeout="5" recv-name="g_strEventReceived" >
            <msg name="ConfLeaveEventResponse" >
              <parameter ></parameter>
              <parameter ></parameter>
              <parameter ></parameter>
              <parameter >f_strDeleteSubConf</parameter>
            </msg>
          </wait>
          <results >
            <result name="Default" link="18" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)
{
	Server.logError("NO RESPONSE FROM CC FOR CONF LEAVE EVENT FOR PARTY IN SUB CONFERENCE");
}]]></script>
          </scripts>
        </action>
        <action id="16" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=2057 y=241 ?>
          <!--delete sub conf-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;DeleteConference&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oSubConfMS</parameter>
          </function>
          <results >
            <result name="Default" link="11" stubbed="1"/>
          </results>
        </action>
        <action id="17" plug-in="Pactolus.Branch.1" ><?xtml-editor x=1818 y=251 ?>
          <!--delete sub conf-->
          <results >
            <result name="Default" link="11" stubbed="1"/>
            <result name="f_strDeleteSubConf==&quot;T&quot;" link="16" stubbed="0" >f_strDeleteSubConf match "T"</result>
          </results>
        </action>
        <action id="18" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1595 y=257 ?>
          <!--Remove from sub conf-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;RemoveMemberFromConference&quot;" return="" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oSubConfMS</parameter>
          </function>
          <results >
            <result name="Default" link="17" stubbed="0"/>
          </results>
        </action>
        <action id="19" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=363 y=496 ?>
          <!--fail to add to sub conf-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="p_strConfControllerIP" transaction="p_strTransactionId" message-name="&quot;ConfAddToSubConfResponse&quot;" destination-port="p_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;Status&quot;" value="s_nFAILURE"/>
            <parameter tag="&quot;StatusMessage&quot;" value="g_strReturnMsg"/>
            <parameter tag="&quot;Endpoint&quot;" value="p_strSubConferenceEndPoint"/>
            <parameter tag="&quot;CallerPassCode&quot;" value="p_strCallerPassCode"/>
            <parameter tag="&quot;ConnectionId&quot;" value="g_oSubConfMS.strConnectionId"/>
          </SOAP>
          <results >
            <result name="Default" link="3" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "CSR SHOULD NOT BE IN SUB CONF WITH MUTED OR HOLD";]]></script>
          </scripts>
        </action>
      </actions>
    </function>
    <function name="OnConfRemoveFromSubConfRequest" start="1" event="OnConfRemoveFromSubConfRequest" returns="void" >
      <parameters >
        <parameter name="p_strConfControllerIP" type="string" pass="byref"/>
        <parameter name="p_nConfControllerPort" type="i4" pass="byref"/>
        <parameter name="p_strTransactionId" type="string" pass="byref"/>
        <parameter name="p_strCallerPassCode" type="string" pass="byref"/>
        <parameter name="p_strDeleteSubConferenceFlag" type="string" pass="byref"/>
        <parameter name="p_nAudioMode" type="i4" pass="byref"/>
      </parameters>
      <local-vars >
        <var name="f_nReturnCode" type="i4" >-1</var>
      </local-vars>
      <actions >
        <action id="1" plug-in="Pactolus.Branch.1" ><?xtml-editor x=98 y=261 ?>
          <!--in sub?-->
          <results >
            <result name="Default" link="14" stubbed="0"/>
            <result name="g_bCurrentlyInSub" link="2" stubbed="0" >g_bCurrentlyInSubConf == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: OnConfRemoveSubConfRequest");]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Pactolus.Branch.1" ><?xtml-editor x=373 y=433 ?>
          <!--Dial In?-->
          <results >
            <result name="Default" link="3" stubbed="0"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_disable_event();

// bring back to main conf but always muted

Server.logInfo("ADD PARTY FROM SUB BACK TO MAIN CONFERENCE, BUT MUTED");

Session.g_oMS.bMuteFlag = true;]]></script>
          </scripts>
        </action>
        <action id="3" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=632 y=429 ?>
          <!--"MoveFromSubConfToMainConf"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;MoveFromSubConfToMainConf&quot;" return="f_nReturnCode" external-function="1" library="lib_utils.xml" >
            <parameter >g_oSubConfMS</parameter>
            <parameter >g_oMS</parameter>
            <parameter >g_oCallLegA</parameter>
            <parameter >g_strContact</parameter>
            <parameter >p_strDeleteSubConferenceFlag</parameter>
          </function>
          <results >
            <result name="Default" link="6" stubbed="0"/>
            <result name="FAILURE" link="5" stubbed="0" >f_nReturnCode == s_nFAILURE</result>
            <result name="CALLER HUNGUP" link="10" stubbed="0" >f_nReturnCode == s_nCALLERHUNGUP</result>
          </results>
        </action>
        <action id="4" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1531 y=403 ?>
          <!--SUCCESS-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nSUCCESS"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="5" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=867 y=580 ?>
          <!--fail to add to sub main-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="p_strConfControllerIP" transaction="p_strTransactionId" message-name="&quot;ConfRemoveFromSubConfResponse&quot;" destination-port="p_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;Status&quot;" value="s_nFAILURE"/>
            <parameter tag="&quot;StatusMessage&quot;" value="g_strReturnMsg"/>
            <parameter tag="&quot;CallerPassCode&quot;" value="p_strCallerPassCode"/>
            <parameter tag="&quot;ConnectionId&quot;" value="g_oMS.strConnectionId"/>
          </SOAP>
          <results >
            <result name="Default" link="7" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "FAIL TO MOVE PARTICIPANT FROM SUB INTO MAIN CONFERENCE";]]></script>
          </scripts>
        </action>
        <action id="6" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=852 y=426 ?>
          <!--success to add to main-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="p_strConfControllerIP" transaction="p_strTransactionId" message-name="&quot;ConfRemoveFromSubConfResponse&quot;" destination-port="p_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;Status&quot;" value="s_nSUCCESS"/>
            <parameter tag="&quot;StatusMessage&quot;" value="g_strReturnMsg"/>
            <parameter tag="&quot;CallerPassCode&quot;" value="p_strCallerPassCode"/>
            <parameter tag="&quot;ConnectionId&quot;" value="g_oMS.strConnectionId"/>
          </SOAP>
          <results >
            <result name="Default" link="22" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "SUCCESS MOVE PARTICIPANT FROM SUB INTO MAIN CONFERENCE";

Session.g_bCurrentlyInSubConf = false;

Session.g_strSubConferenceId = "";

Session.g_strSubConfModeratorFlag = "";

Session.g_bMutedState = true;]]></script>
          </scripts>
        </action>
        <action id="7" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1104 y=574 ?>
          <!--"HangUpCaller"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;HangUpParty&quot;" return="f_nReturnCode" external-function="1" library="lib_callcontrol.xml" >
            <parameter >g_oCallLegA</parameter>
            <parameter >g_strContact</parameter>
          </function>
          <results >
            <result name="Default" link="8" stubbed="0"/>
          </results>
        </action>
        <action id="8" plug-in="Standard.EndSession.1" ><?xtml-editor x=1325 y=572 ?></action>
        <action id="10" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=862 y=718 ?>
          <!--fail to add to sub main-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="p_strConfControllerIP" transaction="p_strTransactionId" message-name="&quot;ConfRemoveFromSubConfResponse&quot;" destination-port="p_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;Status&quot;" value="s_nFAILURE"/>
            <parameter tag="&quot;StatusMessage&quot;" value="g_strReturnMsg"/>
            <parameter tag="&quot;CallerPassCode&quot;" value="p_strCallerPassCode"/>
            <parameter tag="&quot;ConnectionId&quot;" value="g_oMS.strConnectionId"/>
          </SOAP>
          <results >
            <result name="Default" link="8" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "FAIL TO MOVE PARTICIPANT FROM SUB INTO MAIN CONFERENCE";]]></script>
          </scripts>
        </action>
        <action id="13" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=610 y=171 ?>
          <!--s_nFAILURE-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nFAILURE"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="14" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=360 y=175 ?>
          <!--fail to add to sub main, not in sub conf-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="p_strConfControllerIP" transaction="p_strTransactionId" message-name="&quot;ConfRemoveFromSubConfResponse&quot;" destination-port="p_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;Status&quot;" value="s_nFAILURE"/>
            <parameter tag="&quot;StatusMessage&quot;" value="g_strReturnMsg"/>
            <parameter tag="&quot;CallerPassCode&quot;" value="p_strCallerPassCode"/>
            <parameter tag="&quot;ConnectionId&quot;" value="g_oMS.strConnectionId"/>
          </SOAP>
          <results >
            <result name="Default" link="13" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "NOT CURRENTLY IN SUB CONFERENCE, CAN'T MOVE TO MAIN CONFERENCE";]]></script>
          </scripts>
        </action>
        <action id="22" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1103 y=410 ?>
          <!--ConfMSConnectionIDChangedNotify-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="g_strZeroTransactionId" message-name="&quot;ConfMSConnectionIDChangedNotify&quot;" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
            <parameter tag="&quot;callerPassCode&quot;" value="g_strCCGeneratedPasscode"/>
            <parameter tag="&quot;msConnectionId&quot;" value="g_oMS.strConnectionId"/>
          </SOAP>
          <results >
            <result name="Default" link="23" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
        </action>
        <action id="23" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1319 y=405 ?>
          <!--clear sub conf type-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;psAPISceSetSubConfType&quot;" return="" external-function="0" library="" >
            <parameter >0</parameter>
          </function>
          <results >
            <result name="Default" link="4" stubbed="0"/>
          </results>
        </action>
      </actions>
    </function>
    <function name="OnCSRMicOffRequest" start="1" event="CSRMicOffRequest" returns="void" >
      <parameters >
        <parameter name="strAcdControllerIP" type="string" pass="byref"/>
        <parameter name="nAcdControllerPort" type="i4" pass="byref"/>
        <parameter name="strTransactionId" type="string" pass="byref"/>
      </parameters>
      <local-vars >
        <var name="nReturnCode" type="i4" >-1</var>
        <var name="strReturnMsg" type="string" ></var>
        <var name="strConferenceId" type="string" ></var>
      </local-vars>
      <actions >
        <action id="1" plug-in="Pactolus.Branch.1" ><?xtml-editor x=188 y=234 ?>
          <!--sub conf, private talk?-->
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="subConf" link="4" stubbed="0" >g_bCurrentlyInSubConf == true</result>
            <result name="privateTalk" link="5" stubbed="0" >g_bBeginPrivateTalk == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_disable_event();
Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: OnCSRMicOffRequest");]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=466 y=168 ?>
          <!--"ChangeToMutedMode"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ChangeToMutedMode&quot;" return="nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="7" stubbed="1"/>
            <result name="!nSUCCESS" link="3" stubbed="0" >nReturnCode != s_nSUCCESS</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_oMS.bMuteFlag = true;]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (2 == Result.id)
{
	Session.g_oMS.bMuteFlag = false;
}]]></script>
          </scripts>
        </action>
        <action id="3" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=729 y=157 ?>
          <!--CSRMicOffResponse-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strAcdControllerIP" transaction="strTransactionId" message-name="&quot;CSRMicOffResponse&quot;" destination-port="nAcdControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;ResultCode&quot;" value="nReturnCode"/>
            <parameter tag="&quot;ResultMessage&quot;" value="strReturnMsg"/>
          </SOAP>
          <results >
            <result name="Default" link="6" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.strReturnMsg = "FAIL TO MODIFY CONFERENCE MEMBER TO MUTED"; ]]></script>
          </scripts>
        </action>
        <action id="4" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=472 y=293 ?>
          <!--"ChangeToMutedMode"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ChangeToMutedMode&quot;" return="nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oSubConfMS</parameter>
          </function>
          <results >
            <result name="Default" link="7" stubbed="0"/>
            <result name="!nSUCCESS" link="3" stubbed="1" >nReturnCode != s_nSUCCESS</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_oSubConfMS.bMuteFlag = true;]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (2 == Result.id)
{
	Session.g_oSubConfMS.bMuteFlag = false;
}]]></script>
          </scripts>
        </action>
        <action id="5" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=475 y=412 ?>
          <!--"ChangeToMutedMode"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ChangeToMutedMode&quot;" return="nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oPrivateTalkMS</parameter>
          </function>
          <results >
            <result name="Default" link="7" stubbed="1"/>
            <result name="!nSUCCESS" link="3" stubbed="1" >nReturnCode != s_nSUCCESS</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_oPrivateTalkMS.bMuteFlag = true;]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (2 == Result.id)
{
	Session.g_oPrivateTalkMS.bMuteFlag = false;
}]]></script>
          </scripts>
        </action>
        <action id="6" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=1012 y=162 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="7" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=730 y=286 ?>
          <!--CSRMicOffResponse-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strAcdControllerIP" transaction="strTransactionId" message-name="&quot;CSRMicOffResponse&quot;" destination-port="nAcdControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;ResultCode&quot;" value="nReturnCode"/>
            <parameter tag="&quot;ResultMessage&quot;" value="strReturnMsg"/>
          </SOAP>
          <results >
            <result name="Default" link="9" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.strReturnMsg = "SUCCESS TO MODIFY CONFERENCE MEMBER TO MUTED";
Session.g_bCSRMicOn = false;]]></script>
          </scripts>
        </action>
        <action id="8" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1217 y=285 ?>
          <!--CallflowAudioModeChangeNotify-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="g_strZeroTransactionId" message-name="&quot;CallflowAudioModeChangeNotify&quot;" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;callerPassCode&quot;" value="g_strCCGeneratedPasscode"/>
            <parameter tag="&quot;conferenceId&quot;" value="strConferenceId"/>
            <parameter tag="&quot;audioMode&quot;" value="2"/>
          </SOAP>
          <results >
            <result name="Default" link="6" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (Session.g_bCurrentlyInSubConf)
{
	Server.logInfo("CSR CURRENTLY IN SUB CONFERENCE, SEND AUDIO MODE CHANGE WITH SUB CONFERENCE ID");
	Session.strConferenceId = Session.g_strSubConferenceId;
}
else
{
	Server.logInfo("CSR CURRENTLY NOT IN SUB CONFERENCE, SEND AUDIO MODE CHANGE WITH MAIN CONFERENCE ID");
	Session.strConferenceId = Session.g_strConfScheduleId;
}
Server.logInfo("CONFERENCE ID: " + Session.strConferenceId);]]></script>
          </scripts>
        </action>
        <action id="9" plug-in="Pactolus.Branch.1" ><?xtml-editor x=977 y=289 ?>
          <results >
            <result name="Default" link="6" stubbed="1"/>
            <result name="NotifyCC" link="8" stubbed="0" >g_bNotifyCCAudioModeChange == true</result>
          </results>
        </action>
      </actions>
    </function>
    <function name="OnCSRMicOnRequest" start="1" event="CSRMicOnRequest" returns="void" >
      <parameters >
        <parameter name="strAcdControllerIP" type="string" pass="byref"/>
        <parameter name="nAcdControllerPort" type="i4" pass="byref"/>
        <parameter name="strTransactionId" type="string" pass="byref"/>
      </parameters>
      <local-vars >
        <var name="nReturnCode" type="i4" >-1</var>
        <var name="strReturnMsg" type="string" ></var>
        <var name="strConferenceId" type="string" ></var>
      </local-vars>
      <actions >
        <action id="1" plug-in="Pactolus.Branch.1" ><?xtml-editor x=181 y=246 ?>
          <!--sub conf, private talk?-->
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="subConf" link="4" stubbed="0" >g_bCurrentlyInSubConf == true</result>
            <result name="privateTalk" link="5" stubbed="0" >g_bBeginPrivateTalk == true</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_disable_event();
Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: OnCSRMicOnRequest");]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=440 y=191 ?>
          <!--"ChangeToConferenceMode"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ChangeToConferenceMode&quot;" return="nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="7" stubbed="1"/>
            <result name="!nSUCCESS" link="3" stubbed="0" >nReturnCode != s_nSUCCESS</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_oMS.bMuteFlag = false;]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (2 == Result.id)
{
	Session.g_oMS.bMuteFlag = true;
}]]></script>
          </scripts>
        </action>
        <action id="3" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=722 y=169 ?>
          <!--CSRMicOnResponse-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strAcdControllerIP" transaction="strTransactionId" message-name="&quot;CSRMicOnResponse&quot;" destination-port="nAcdControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;ResultCode&quot;" value="nReturnCode"/>
            <parameter tag="&quot;ResultMessage&quot;" value="strReturnMsg"/>
          </SOAP>
          <results >
            <result name="Default" link="6" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.strReturnMsg = "FAIL TO MODIFY CONFERENCE MEMBER TO UNMUTED"; ]]></script>
          </scripts>
        </action>
        <action id="4" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=465 y=305 ?>
          <!--"ChangeToConferenceMode"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ChangeToConferenceMode&quot;" return="nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oSubConfMS</parameter>
          </function>
          <results >
            <result name="Default" link="7" stubbed="0"/>
            <result name="!nSUCCESS" link="3" stubbed="1" >nReturnCode != s_nSUCCESS</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_oSubConfMS.bMuteFlag = false;]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (2 == Result.id)
{
	Session.g_oSubConfMS.bMuteFlag = true;
}]]></script>
          </scripts>
        </action>
        <action id="5" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=468 y=427 ?>
          <!--"ChangeToConferenceMode"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ChangeToConferenceMode&quot;" return="nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oPrivateTalkMS</parameter>
          </function>
          <results >
            <result name="Default" link="7" stubbed="1"/>
            <result name="!nSUCCESS" link="3" stubbed="1" >nReturnCode != s_nSUCCESS</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_oPrivateTalkMS.bMuteFlag = false;]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (2 == Result.id)
{
	Session.g_oPrivateTalkMS.bMuteFlag = true;
}]]></script>
          </scripts>
        </action>
        <action id="6" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=976 y=164 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="7" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=723 y=298 ?>
          <!--CSRMicOnResponse-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strAcdControllerIP" transaction="strTransactionId" message-name="&quot;CSRMicOnResponse&quot;" destination-port="nAcdControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;ResultCode&quot;" value="nReturnCode"/>
            <parameter tag="&quot;ResultMessage&quot;" value="strReturnMsg"/>
          </SOAP>
          <results >
            <result name="Default" link="8" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.strReturnMsg = "SUCCESS TO MODIFY CONFERENCE MEMBER TO UNMUTED";
Session.g_bCSRMicOn = true;]]></script>
          </scripts>
        </action>
        <action id="8" plug-in="Pactolus.Branch.1" ><?xtml-editor x=949 y=298 ?>
          <results >
            <result name="Default" link="6" stubbed="1"/>
            <result name="NotifyCC" link="9" stubbed="0" >g_bNotifyCCAudioModeChange == true</result>
          </results>
        </action>
        <action id="9" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1189 y=294 ?>
          <!--CallflowAudioModeChangeNotify-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="g_strZeroTransactionId" message-name="&quot;CallflowAudioModeChangeNotify&quot;" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;callerPassCode&quot;" value="g_strCCGeneratedPasscode"/>
            <parameter tag="&quot;conferenceId&quot;" value="strConferenceId"/>
            <parameter tag="&quot;audioMode&quot;" value="0"/>
          </SOAP>
          <results >
            <result name="Default" link="6" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[if (Session.g_bCurrentlyInSubConf)
{
	Server.logInfo("CSR CURRENTLY IN SUB CONFERENCE, SEND AUDIO MODE CHANGE WITH SUB CONFERENCE ID");
	Session.strConferenceId = Session.g_strSubConferenceId;
}
else
{
	Server.logInfo("CSR CURRENTLY NOT IN SUB CONFERENCE, SEND AUDIO MODE CHANGE WITH MAIN CONFERENCE ID");
	Session.strConferenceId = Session.g_strConfScheduleId;
}
Server.logInfo("CONFERENCE ID: " + Session.strConferenceId);]]></script>
          </scripts>
        </action>
      </actions>
    </function>
    <function name="ConfMSConnectionIDChangedNotify" start="1" event="ConfMSConnectionIDChangedNotify" returns="i4" >
      <local-vars >
        <var name="strEndpointPlusConnectionId" type="string" ></var>
      </local-vars>
      <actions >
        <action id="1" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=208 y=178 ?>
          <!--ConfMSConnectionIDChangedNotify-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="g_strConfControllerIP" transaction="g_strZeroTransactionId" message-name="&quot;ConfMSConnectionIDChangedNotify&quot;" destination-port="g_nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;conferenceId&quot;" value="g_strConfScheduleId"/>
            <parameter tag="&quot;callerPassCode&quot;" value="g_strCCGeneratedPasscode"/>
            <parameter tag="&quot;msConnectionId&quot;" value="strEndpointPlusConnectionId"/>
          </SOAP>
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="Success" link="3" stubbed="0"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: ConfMSConnectionIDChangedNotify");
Session.strEndpointPlusConnectionId = Session.g_oMS.strEndPoint + "#" + Session.g_oMS.strConnectionId;]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=441 y=177 ?>
          <!--s_nFAILURE-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nFAILURE"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("FAIL TO SEND ConfMSConnectionIDChangedNotify TO CC");]]></script>
          </scripts>
        </action>
        <action id="3" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=454 y=254 ?>
          <!--s_nSUCCESS-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nSUCCESS"/>
        </action>
      </actions>
    </function>
    <function name="OnConfAudioModeChangeRequest" start="75" event="ConfAudioModeChangeRequest" returns="void" >
      <parameters >
        <parameter name="strConfControllerIP" type="string" pass="byref"/>
        <parameter name="nConfControllerPort" type="i4" pass="byref"/>
        <parameter name="strTransactionId" type="string" pass="byref"/>
        <parameter name="nFromMode" type="i4" pass="byref"/>
        <parameter name="nToMode" type="i4" pass="byref"/>
        <parameter name="strNotifyMS" type="string" pass="byref"/>
      </parameters>
      <local-vars >
        <var name="f_nReturnCode" type="i4" >0</var>
      </local-vars>
      <actions >
        <action id="75" plug-in="Pactolus.Branch.1" ><?xtml-editor x=125 y=209 ?>
          <results >
            <result name="Default" link="76" stubbed="0"/>
            <result name="strNotifyMS == &quot;T&quot;" link="1" stubbed="0" >strNotifyMS match "T"</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_disable_event();
Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: OnConfAudioModeChangeRequest");
Server.logInfo("From Mode: " + Session.nFromMode);
Server.logInfo("To Mode: " + Session.nToMode);
Server.logInfo("Notify MS: " + Session.strNotifyMS);]]></script>
          </scripts>
        </action>
        <action id="1" plug-in="Pactolus.Branch.1" ><?xtml-editor x=387 y=289 ?>
          <!--speak, mute, hold?-->
          <results >
            <result name="Default" link="72" stubbed="0"/>
            <result name="Mute" link="77" stubbed="0" >nToMode == 2</result>
            <result name="Hold" link="72" stubbed="1" >nToMode == 1</result>
            <result name="Speak" link="82" stubbed="0" >nToMode == 0</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: OnConfAudioModeChangeRequest");
Server.logInfo("From Mode: " + Session.nFromMode);
Server.logInfo("To Mode: " + Session.nToMode);]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (1 == Result.id)
{
	Session.g_strReturnMsg = "FAILURE TO CHANGE AUDIO MODE, UNKNOWN AUDIO MODE.";
}
else (3 == Result.id)
{
	Session.g_strReturnMsg = "FAILURE TO CHANGE AUDIO MODE, CSR SHOULD NOT BE ON MOH.";
}]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=862 y=283 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[js_enable_event();]]></script>
          </scripts>
        </action>
        <action id="72" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=635 y=287 ?>
          <!--"ConfAudioModeChangeResponse"
FAILURE-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strConfControllerIP" transaction="strTransactionId" message-name="&quot;ConfAudioModeChangeResponse&quot;" destination-port="nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="s_nFAILURE"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
          </SOAP>
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
        </action>
        <action id="76" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=370 y=150 ?>
          <!--"ConfAudioModeChangeResponse"-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strConfControllerIP" transaction="strTransactionId" message-name="&quot;ConfAudioModeChangeResponse&quot;" destination-port="nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="s_nSUCCESS"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
          </SOAP>
          <results >
            <result name="Default" link="2" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo("INFO: NO NEED TO NOTIFY MS");
if (0 == Session.nToMode)
{
	Session.g_strReturnMsg = "SUCCESSFUL UNMUTE PARTY";
}
else if (2 == Session.nToMode)
{
	Session.g_strReturnMsg = "SUCCESSFUL MUTE PARTY";
}
else
{
	Session.g_strReturnMsg = "SUCCESSFUL HOLD PARTY";
}]]></script>
          </scripts>
        </action>
        <action id="77" plug-in="Pactolus.Branch.1" ><?xtml-editor x=652 y=440 ?>
          <!--sub conf, private talk?-->
          <results >
            <result name="Default" link="86" stubbed="0"/>
            <result name="subConf" link="80" stubbed="0" >g_bCurrentlyInSubConf == true</result>
            <result name="privateTalk" link="78" stubbed="0" >g_bBeginPrivateTalk == true</result>
          </results>
        </action>
        <action id="78" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=926 y=678 ?>
          <!--"ChangeToMuteMode"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ChangeToMutedMode&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oPrivateTalkMS</parameter>
          </function>
          <results >
            <result name="Default" link="72" stubbed="1"/>
            <result name="SUCCESS" link="81" stubbed="1" >f_nReturnCode == s_nSUCCESS</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_oTempConf.bMuteFlag = true;]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (1 == Result.id)
{
	Session.g_strReturnMsg = "FAILURE TO CHANGE AUDIO MODE, ChangeToMuteMode returns failure.";
}]]></script>
          </scripts>
        </action>
        <action id="79" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1134 y=433 ?>
          <!--"ChangeToMuteMode"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ChangeToMutedMode&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="72" stubbed="1"/>
            <result name="SUCCESS" link="81" stubbed="0" >f_nReturnCode == s_nSUCCESS</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_oMS.bMuteFlag = true;]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (1 == Result.id)
{
	Session.g_strReturnMsg = "FAILURE TO CHANGE AUDIO MODE, ChangeToMuteMode returns failure.";
}]]></script>
          </scripts>
        </action>
        <action id="80" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=922 y=557 ?>
          <!--"ChangeToMuteMode"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ChangeToMutedMode&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oSubConfMS</parameter>
          </function>
          <results >
            <result name="Default" link="72" stubbed="1"/>
            <result name="SUCCESS" link="81" stubbed="1" >f_nReturnCode == s_nSUCCESS</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_oSubConfMS.bMuteFlag = true;]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (1 == Result.id)
{
	Session.g_strReturnMsg = "FAILURE TO CHANGE AUDIO MODE, ChangeToMuteMode returns failure.";
}]]></script>
          </scripts>
        </action>
        <action id="81" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=1429 y=423 ?>
          <!--"ConfAudioModeChangeResponse"-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strConfControllerIP" transaction="strTransactionId" message-name="&quot;ConfAudioModeChangeResponse&quot;" destination-port="nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="s_nSUCCESS"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
          </SOAP>
          <results >
            <result name="Default" link="2" stubbed="1"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_strReturnMsg = "SUCCESSFUL CHANGE AUDIO MODE";]]></script>
          </scripts>
        </action>
        <action id="82" plug-in="Pactolus.Branch.1" ><?xtml-editor x=639 y=857 ?>
          <!--sub conf, private talk?-->
          <results >
            <result name="Default" link="87" stubbed="0"/>
            <result name="subConf" link="84" stubbed="0" >g_bCurrentlyInSubConf == true</result>
            <result name="privateTalk" link="85" stubbed="0" >g_bBeginPrivateTalk == true</result>
          </results>
        </action>
        <action id="83" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=1155 y=806 ?>
          <!--"ChangeToConferenceMode"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ChangeToConferenceMode&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oMS</parameter>
          </function>
          <results >
            <result name="Default" link="72" stubbed="1"/>
            <result name="SUCCESS" link="81" stubbed="1" >f_nReturnCode == s_nSUCCESS</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_oMS.bMuteFlag = false;]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (1 == Result.id)
{
	Session.g_strReturnMsg = "FAILURE TO CHANGE AUDIO MODE, ChangeToConferenceMode returns failure.";
}]]></script>
          </scripts>
        </action>
        <action id="84" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=941 y=918 ?>
          <!--"ChangeToConferenceMode"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ChangeToConferenceMode&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oSubConfMS</parameter>
          </function>
          <results >
            <result name="Default" link="72" stubbed="1"/>
            <result name="SUCCESS" link="81" stubbed="1" >f_nReturnCode == s_nSUCCESS</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_oSubConfMS.bMuteFlag = false;]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (1 == Result.id)
{
	Session.g_strReturnMsg = "FAILURE TO CHANGE AUDIO MODE, ChangeToConferenceMode returns failure.";
}]]></script>
          </scripts>
        </action>
        <action id="85" plug-in="Standard.FunctionCall.1" ><?xtml-editor x=952 y=1040 ?>
          <!--"ChangeToConferenceMode"-->
          <function xmlns="urn:www.pactolus.com:xtml:application" name="&quot;ChangeToConferenceMode&quot;" return="f_nReturnCode" external-function="1" library="lib_mediaserver.xml" >
            <parameter >g_oPrivateTalkMS</parameter>
          </function>
          <results >
            <result name="Default" link="72" stubbed="1"/>
            <result name="SUCCESS" link="81" stubbed="1" >f_nReturnCode == s_nSUCCESS</result>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Session.g_oTempConf.bMuteFlag = false;]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (1 == Result.id)
{
	Session.g_strReturnMsg = "FAILURE TO CHANGE AUDIO MODE, ChangeToConferenceMode returns failure.";
}]]></script>
          </scripts>
        </action>
        <action id="86" plug-in="Pactolus.Branch.1" ><?xtml-editor x=911 y=435 ?>
          <!--Mic On?-->
          <results >
            <result name="Default" link="79" stubbed="0"/>
            <result name="g_bCSRMicOn" link="83" stubbed="1" >g_bCSRMicOn == true</result>
          </results>
        </action>
        <action id="87" plug-in="Pactolus.Branch.1" ><?xtml-editor x=915 y=808 ?>
          <!--Mic Off?-->
          <results >
            <result name="Default" link="83" stubbed="0"/>
            <result name="!g_bCSRMicOn" link="79" stubbed="1" >g_bCSRMicOn == false</result>
          </results>
        </action>
      </actions>
      <text-objects >
        <text-object x-coord="80" y-coord="22" width="234" height="101" text="nToMode:
0 - Speak (off hold, unmute)
1 - Hold
2 - Mute" font-name="Times New Roman" size="-16" red="0" green="0" blue="0" weight="0" underline="0" strikeout="0" point-size="12" italic="0"/>
        <text-object x-coord="364" y-coord="419" width="168" height="25" text="check for CSR mic" font-name="Times New Roman" size="-16" red="0" green="0" blue="0" weight="0" underline="0" strikeout="0" point-size="12" italic="0"/>
      </text-objects>
    </function>
    <function name="psAPISceSetSubConfType" start="1" event="" returns="i4" >
      <parameters >
        <parameter name="p_nSubConfType" type="i4"/>
      </parameters>
      <local-vars >
        <var name="nReturnCode" type="i4" >-1</var>
        <var name="strSubConfType" type="string" ></var>
      </local-vars>
      <actions >
        <action id="1" plug-in="Pactolus.JavaStaticMethod.1" ><?xtml-editor x=304 y=247 ?>
          <!--"setSubConfType"-->
          <java xmlns="urn:www.pactolus.com:xtml:application" class="&quot;com.pactolus.conferencing.psAPISceConfSetSubConfType&quot;" method="&quot;setSubConfType&quot;" timeout="s_nTIMEOUT" return="" method-return-var="nReturnCode" method-return-type="0" >
            <parameter type="in" var-type="string" >g_strSessionId</parameter>
            <parameter type="in" var-type="string" >g_strCallLegId</parameter>
            <parameter type="in" var-type="string" >strSubConfType</parameter>
          </java>
          <results >
            <result name="Default" link="2" stubbed="0"/>
            <result name="Success" link="3" stubbed="0"/>
            <result name="Error"/>
            <result name="Timeout"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: psAPISceSetSubConfType");
Server.logInfo("INFO: *********JAVA CALLING SetSubConfType *********");
if (2 == Session.p_nSubConfType)
	Session.strSubConfType = "CO";
else if (3 == Session.p_nSubConfType)
	Session.strSubConfType = "CL";
else
	Session.strSubConfType = "";
Server.logInfo("INFO: BEFORE Session Id = " + Session.g_strSessionId);
Server.logInfo("INFO: BEFORE call leg Id = " + Session.g_strCallLegId);
Server.logInfo("INFO: BEFORE sub conferrence type = " + Session.strSubConfType);]]></script>
            <script language="javascript" timing="last" ><![CDATA[Server.logInfo("INFO: ********* Set Sub Conf Type returns " + Session.nReturnCode);
if (Result.id != 2)
{
	Server.logError("ERROR: FAIL TO CALL SET SUB CONF TYPE, EXIT ON: " + Result.name);
}]]></script>
          </scripts>
        </action>
        <action id="2" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=580 y=237 ?>
          <!--return FAILED_JAVA-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="s_nFAILURE"/>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logError("ERROR: FAIL TO SET SUB CONF TYPE");]]></script>
          </scripts>
        </action>
        <action id="3" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=585 y=327 ?>
          <!--return JAVA_SUCCESS-->
          <return xmlns="urn:www.pactolus.com:xtml:application" value="nReturnCode"/>
        </action>
      </actions>
    </function>
    <function name="OnConfPartyStatusChangeRequest" start="2" event="ConfPartyStatusChangeRequest" returns="void" >
      <parameters >
        <parameter name="strConfControllerIP" type="string" pass="byref"/>
        <parameter name="nConfControllerPort" type="i4" pass="byref"/>
        <parameter name="strTransactionId" type="string" pass="byref"/>
        <parameter name="nStatus" type="i4" pass="byref"/>
      </parameters>
      <actions >
        <action id="2" plug-in="Pactolus.SOAPMessage.1" ><?xtml-editor x=192 y=143 ?>
          <!--response SUCCESS-->
          <SOAP xmlns="urn:www.pactolus.com:xtml:communication" destination-ip="strConfControllerIP" transaction="strTransactionId" message-name="s_strConfPartyStatusChangeRs" destination-port="nConfControllerPort" destination-type="4" destination-session="" waiting-session-selected="" xml-namespace="" >
            <parameter tag="&quot;resultCode&quot;" value="s_nSUCCESS"/>
            <parameter tag="&quot;resultMessage&quot;" value="g_strReturnMsg"/>
          </SOAP>
          <results >
            <result name="Default" link="1" stubbed="0"/>
            <result name="Success"/>
            <result name="Error"/>
          </results>
          <scripts >
            <script language="javascript" timing="first" ><![CDATA[Server.logInfo(Session._sessionId + "     CURRENTLY IN FUNCTION: OnConfPartyStatusChangeRequest");
Server.logInfo("NEW STATUS: " + Session.nStatus);
Server.logInfo("OLD STATUS: " + Session.g_nReleaseToConfStatus);
Session.g_nReleaseToConfStatus = Session.nStatus;
Session.g_strReturnMsg = "SUCCESS CHANGE CONF PARTY STATUS";]]></script>
            <script language="javascript" timing="last" ><![CDATA[if (Result.id != 2)
{
	Server.logError("ERROR RESPONSE TO CONF PARTY STATUS CHANGE REQUEST, EXIT ON: " + Result.name);
}]]></script>
          </scripts>
        </action>
        <action id="1" plug-in="Standard.FunctionReturn.1" ><?xtml-editor x=465 y=140 ?>
          <return xmlns="urn:www.pactolus.com:xtml:application" value=""/>
        </action>
      </actions>
    </function>
  </functions>
  <script language="javascript" ><![CDATA[#include <javascript_utils.jsh>]]></script>
  <properties >
    <property key="default" value="D:/Prompts/pactolus/english/vox/pcs_english.vox"/>
    <property key="disable-logging" value="0"/>
    <property key="js-include-path" value="../Libs"/>
    <property key="library-modules" value="lib_callcontrol.xml; lib_mediaserver.xml;lib_utils.xml;lib_APISce.xml"/>
    <property key="library-path" value="../Libs"/>
  </properties>
  <application-version >
    <revision >$Id: csr.xml,v 1.259 2008/04/10 22:36:00 hlam Exp $</revision>
    <label >$Name: PCS-A-4-1-1-1-4-c6 $</label>
  </application-version>
</xtml>